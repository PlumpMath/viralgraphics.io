/*****************************************************************

typeface.js, version 0.15 | typefacejs.neocracy.org

Copyright (c) 2008 - 2009, David Chester davidchester@gmx.net 

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

*****************************************************************/

_typeface_js = {

	faces: {},

	loadFace: function(typefaceData) {

		//var familyName = typefaceData.familyName.toLowerCase();
		var familyName = typefaceData.original_font_information.full_font_name;//familyName.toLowerCase();
		
		if (!this.faces[familyName]) {
			this.faces[familyName] = {};
		}
		if (!this.faces[familyName][typefaceData.cssFontWeight]) {
			this.faces[familyName][typefaceData.cssFontWeight] = {};
		}

		var face = this.faces[familyName][typefaceData.cssFontWeight][typefaceData.cssFontStyle] = typefaceData;

		face.loaded = true;
	},
};

if (_typeface_js && _typeface_js.loadFace) _typeface_js.loadFace({"glyphs":{"ợ":{"x_min":69.21875,"x_max":946.546875,"ha":895,"o":"m 779 376 q 685 89 779 192 q 422 -14 591 -14 q 236 33 317 -14 q 112 169 156 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 565 739 500 764 q 676 669 629 715 q 748 728 724 683 q 772 864 772 772 l 936 864 l 946 848 q 872 666 921 727 q 737 580 823 605 q 779 376 779 489 m 233 376 q 278 182 233 247 q 425 116 324 116 q 570 182 525 116 q 615 376 615 247 q 570 568 615 503 q 424 633 524 633 q 278 568 323 633 q 233 376 233 503 m 333 -177 q 357 -112 333 -135 q 424 -89 380 -89 q 490 -112 467 -89 q 512 -177 512 -135 q 489 -241 512 -217 q 424 -265 466 -265 q 357 -241 380 -265 q 333 -177 333 -218 "},"¦":{"x_min":320.78125,"x_max":442.859375,"ha":765,"o":"m 320 1053 l 442 1053 l 442 514 l 320 514 l 320 1053 m 320 214 l 442 214 l 442 -326 l 320 -326 l 320 214 "},"Ẩ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 683 1071 l 597 1071 q 454 1183 521 1121 q 310 1071 376 1115 l 223 1071 l 223 1087 q 370 1271 329 1210 l 537 1271 q 683 1087 597 1184 l 683 1071 m 808 1339 q 723 1248 808 1266 l 719 1200 l 648 1200 l 641 1282 q 704 1299 685 1287 q 723 1331 723 1310 q 662 1369 723 1369 q 613 1363 637 1369 l 613 1434 q 671 1439 630 1439 q 808 1339 808 1439 "},"Ỷ":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 570 1240 q 459 1114 570 1140 l 452 1051 l 358 1051 l 345 1160 q 421 1185 396 1169 q 445 1231 445 1202 q 371 1281 445 1281 q 293 1271 331 1281 l 293 1363 q 388 1375 339 1375 q 524 1341 477 1375 q 570 1240 570 1307 "},"Ő":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 333 1071 l 333 1087 q 459 1293 404 1185 l 625 1293 l 625 1278 q 539 1178 605 1245 q 421 1071 474 1111 l 333 1071 m 588 1071 l 588 1087 q 656 1187 617 1126 q 715 1293 694 1249 l 880 1293 l 880 1278 q 794 1178 860 1245 q 676 1071 729 1111 l 588 1071 "},"Ổ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 772 1071 l 686 1071 q 543 1183 610 1121 q 399 1071 465 1115 l 312 1071 l 312 1087 q 459 1271 418 1210 l 626 1271 q 772 1087 686 1184 l 772 1071 m 897 1339 q 812 1248 897 1266 l 808 1200 l 737 1200 l 730 1282 q 793 1299 774 1287 q 812 1331 812 1310 q 751 1369 812 1369 q 702 1363 726 1369 l 702 1434 q 760 1439 719 1439 q 897 1339 897 1439 "},"Ừ":{"x_min":122.125,"x_max":1183.953125,"ha":1148,"o":"m 908 992 l 908 860 q 986 919 961 872 q 1011 1056 1011 966 l 1174 1056 l 1183 1041 q 1132 890 1165 944 q 1044 803 1099 837 q 908 756 989 769 l 908 349 q 805 82 908 179 q 515 -14 702 -14 q 225 83 328 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 355 q 519 124 284 124 q 746 356 746 124 l 746 992 l 908 992 m 504 1071 q 386 1172 458 1106 q 282 1278 315 1239 l 282 1293 l 467 1293 q 537 1184 493 1245 q 612 1087 582 1122 l 612 1071 l 504 1071 "},"Ž":{"x_min":44.765625,"x_max":754.234375,"ha":799,"o":"m 754 0 l 44 0 l 44 112 l 544 852 l 58 852 l 58 992 l 740 992 l 740 878 l 238 139 l 754 139 l 754 0 m 664 1293 l 664 1274 q 543 1144 578 1186 q 490 1071 508 1102 l 314 1071 q 141 1274 270 1142 l 141 1293 l 249 1293 q 401 1169 342 1232 q 556 1293 467 1236 l 664 1293 "},"Á":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 360 1071 l 360 1087 q 440 1193 399 1135 q 504 1293 481 1251 l 690 1293 l 690 1278 q 584 1172 654 1237 q 466 1071 514 1106 l 360 1071 "},"ĥ":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 573 367 633 q 273 372 273 513 l 273 0 l 113 0 l 113 1055 l 273 1055 l 273 787 q 265 650 273 723 l 275 650 q 366 734 307 704 q 501 764 424 764 q 774 489 774 764 l 774 0 m 596 1109 q 441 1230 512 1158 q 289 1109 371 1161 l 181 1109 l 181 1125 q 354 1331 311 1259 l 530 1331 q 704 1125 573 1256 l 704 1109 l 596 1109 "},"Î":{"x_min":-51.078125,"x_max":471.046875,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 363 1071 q 208 1192 279 1120 q 56 1071 138 1123 l -51 1071 l -51 1087 q 121 1293 78 1221 l 297 1293 q 471 1087 340 1218 l 471 1071 l 363 1071 "},"e":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 "},"»":{"x_min":54.296875,"x_max":717.34375,"ha":773,"o":"m 717 362 l 473 70 l 359 135 l 551 371 l 359 609 l 473 673 l 717 379 l 717 362 m 411 362 l 168 70 l 54 135 l 245 371 l 54 609 l 168 673 l 411 379 l 411 362 "},"Ề":{"x_min":13.84375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 186 1087 q 288 1209 262 1176 q 333 1271 314 1243 l 500 1271 q 645 1087 559 1184 l 645 1071 l 559 1071 q 416 1183 494 1115 q 273 1071 344 1118 l 186 1071 l 186 1087 m 243 1203 l 159 1203 q 13 1342 65 1274 l 13 1357 l 154 1357 q 243 1219 190 1282 l 243 1203 "},"ļ":{"x_min":62.984375,"x_max":273.25,"ha":387,"o":"m 273 0 l 113 0 l 113 1055 l 273 1055 l 273 0 m 62 -290 q 93 -188 78 -246 q 113 -85 107 -129 l 265 -85 l 265 -98 q 214 -210 246 -152 q 155 -307 183 -269 l 62 -307 l 62 -290 "},"Ĕ":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 409 1071 q 242 1125 303 1071 q 175 1277 180 1179 l 268 1277 q 286 1224 271 1244 q 328 1197 301 1205 q 412 1189 356 1189 q 518 1211 483 1189 q 557 1277 552 1234 l 651 1277 q 578 1126 643 1181 q 409 1071 513 1071 "},"ị":{"x_min":102.90625,"x_max":283.421875,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 104 949 q 127 1014 104 991 q 194 1038 151 1038 q 260 1014 236 1038 q 283 949 283 991 q 260 885 283 908 q 194 862 236 862 q 127 885 151 862 q 104 949 104 908 m 102 -177 q 126 -112 102 -135 q 193 -89 149 -89 q 259 -112 236 -89 q 281 -177 281 -135 q 258 -241 281 -217 q 193 -265 235 -265 q 126 -241 149 -265 q 102 -177 102 -218 "}," ":{"x_min":0,"x_max":0,"ha":695},"ỹ":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 475 841 q 419 853 446 841 q 365 879 391 865 q 313 906 338 894 q 265 918 288 918 q 191 840 210 918 l 109 840 q 161 984 117 934 q 275 1034 205 1034 q 332 1021 304 1034 q 386 995 359 1009 q 437 968 412 980 q 485 956 462 956 q 557 1035 538 956 l 642 1035 q 589 892 633 943 q 475 841 545 841 "},"ò":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 420 842 q 302 943 374 877 q 198 1049 231 1010 l 198 1064 l 383 1064 q 453 955 409 1016 q 528 858 498 893 l 528 842 l 420 842 "},"ţ":{"x_min":26.453125,"x_max":510.046875,"ha":546,"o":"m 393 114 q 510 133 451 114 l 510 13 q 441 -6 483 1 q 355 -14 400 -14 q 128 224 128 -14 l 128 629 l 26 629 l 26 699 l 136 758 l 190 917 l 288 917 l 288 750 l 502 750 l 502 629 l 288 629 l 288 227 q 317 142 288 169 q 393 114 346 114 m 456 -183 q 249 -334 456 -334 q 167 -323 204 -334 l 167 -230 q 250 -240 203 -240 q 308 -229 287 -240 q 330 -187 330 -218 q 208 -112 330 -129 l 265 0 l 368 0 l 340 -60 q 425 -106 395 -74 q 456 -183 456 -138 "},"^":{"x_min":19.671875,"x_max":726.328125,"ha":746,"o":"m 19 363 l 315 997 l 397 997 l 726 363 l 594 363 l 358 833 l 149 363 l 19 363 "},"«":{"x_min":55.65625,"x_max":717.34375,"ha":773,"o":"m 55 379 l 297 673 l 411 609 l 219 371 l 411 135 l 297 70 l 55 362 l 55 379 m 361 379 l 603 673 l 717 609 l 525 371 l 717 135 l 603 70 l 361 362 l 361 379 "},"ử":{"x_min":107.171875,"x_max":1044.625,"ha":989,"o":"m 643 0 l 620 97 l 611 97 q 517 15 577 45 q 379 -14 457 -14 q 174 53 242 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 669 q 847 729 822 681 q 872 865 872 776 l 1035 865 l 1044 849 q 992 696 1025 751 q 903 608 959 641 q 768 565 848 574 l 768 0 l 643 0 m 600 1011 q 489 885 600 911 l 482 822 l 388 822 l 375 931 q 451 956 426 940 q 475 1002 475 973 q 401 1052 475 1052 q 323 1042 361 1052 l 323 1134 q 418 1146 369 1146 q 554 1112 507 1146 q 600 1011 600 1078 "},"í":{"x_min":105.515625,"x_max":435.125,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 105 842 l 105 858 q 185 964 144 906 q 249 1064 226 1022 l 435 1064 l 435 1049 q 329 943 399 1008 q 211 842 259 877 l 105 842 "},"ˆ":{"x_min":153.921875,"x_max":676.046875,"ha":832,"o":"m 568 842 q 413 963 484 891 q 261 842 343 894 l 153 842 l 153 858 q 326 1064 283 992 l 502 1064 q 676 858 545 989 l 676 842 l 568 842 "},"ū":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 221 960 l 654 960 l 654 842 l 221 842 l 221 960 "},"Ẅ":{"x_min":8.140625,"x_max":1304.5,"ha":1314,"o":"m 1046 0 l 869 0 l 701 591 q 674 703 690 630 q 654 804 658 776 q 632 692 647 761 q 607 588 617 622 l 442 0 l 266 0 l 138 496 l 8 992 l 173 992 l 315 413 q 362 168 348 274 q 385 297 370 225 q 412 412 400 368 l 573 992 l 734 992 l 900 409 q 950 168 923 329 q 999 415 960 265 l 1140 992 l 1304 992 l 1046 0 m 442 1177 q 465 1238 442 1219 q 520 1257 488 1257 q 578 1235 556 1257 q 599 1177 599 1214 q 577 1119 599 1141 q 520 1098 555 1098 q 465 1117 488 1098 q 442 1177 442 1137 m 709 1177 q 731 1238 709 1219 q 787 1257 754 1257 q 844 1235 823 1257 q 866 1177 866 1214 q 844 1119 866 1140 q 787 1098 821 1098 q 731 1117 754 1098 q 709 1177 709 1137 "},"ņ":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 574 367 633 q 273 373 273 514 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 365 734 303 705 q 504 764 428 764 q 774 489 774 764 l 774 0 m 310 -290 q 341 -188 326 -246 q 361 -85 355 -129 l 513 -85 l 513 -98 q 462 -210 494 -152 q 403 -307 431 -269 l 310 -307 l 310 -290 "},"µ":{"x_min":113.96875,"x_max":774.03125,"ha":888,"o":"m 273 285 q 421 114 273 114 q 567 174 520 114 q 613 376 613 234 l 613 750 l 774 750 l 774 0 l 649 0 l 626 99 l 618 99 q 536 14 585 43 q 417 -14 488 -14 q 269 47 322 -14 l 266 47 q 270 -32 268 28 q 273 -117 273 -92 l 273 -334 l 113 -334 l 113 750 l 273 750 l 273 285 "},"ỳ":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 356 842 q 238 943 310 877 q 134 1049 167 1010 l 134 1064 l 319 1064 q 389 955 345 1016 q 464 858 434 893 l 464 842 l 356 842 "},"č":{"x_min":69.203125,"x_max":673.046875,"ha":688,"o":"m 416 -14 q 157 85 246 -14 q 69 370 69 184 q 161 662 69 560 q 429 764 254 764 q 643 719 548 764 l 595 591 q 428 631 493 631 q 233 372 233 631 q 281 182 233 245 q 424 118 330 118 q 625 171 530 118 l 625 32 q 534 -3 582 7 q 416 -14 485 -14 m 673 1064 l 673 1045 q 552 915 587 957 q 499 842 517 873 l 323 842 q 150 1045 279 913 l 150 1064 l 258 1064 q 410 940 351 1003 q 565 1064 476 1007 l 673 1064 "},"’":{"x_min":16.96875,"x_max":251.65625,"ha":268,"o":"m 241 992 l 251 977 q 132 652 215 835 l 16 652 q 84 992 63 848 l 241 992 "},"-":{"x_min":48.84375,"x_max":397.484375,"ha":447,"o":"m 48 304 l 48 440 l 397 440 l 397 304 l 48 304 "},"Q":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 942 192 1010 316 q 741 19 873 69 l 979 -236 l 760 -236 l 573 -14 l 547 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 "},"M":{"x_min":130.90625,"x_max":1151.765625,"ha":1282,"o":"m 559 0 l 271 828 l 266 828 q 278 482 278 643 l 278 0 l 130 0 l 130 992 l 359 992 l 634 202 l 638 202 l 922 992 l 1151 992 l 1151 0 l 995 0 l 995 490 q 999 683 995 564 q 1005 827 1003 802 l 1000 827 l 702 0 l 559 0 "},"œ":{"x_min":69.15625,"x_max":1266.546875,"ha":1333,"o":"m 975 -14 q 690 117 784 -14 q 419 -14 600 -14 q 164 91 259 -14 q 69 376 69 196 q 162 662 69 561 q 421 764 254 764 q 572 730 503 764 q 686 632 641 697 q 943 764 775 764 q 1179 673 1092 764 q 1266 424 1266 582 l 1266 338 l 766 338 q 824 169 773 227 q 979 112 874 112 q 1105 124 1048 112 q 1228 166 1163 137 l 1228 36 q 1112 -2 1171 9 q 975 -14 1052 -14 m 233 376 q 277 182 233 247 q 421 116 322 116 q 561 181 516 116 q 605 373 605 245 q 560 568 605 504 q 417 633 516 633 q 277 569 320 633 q 233 376 233 504 m 944 643 q 824 595 869 643 q 770 454 778 548 l 1107 454 q 1065 594 1107 545 q 944 643 1022 643 "},"ě":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 675 1064 l 675 1045 q 554 915 589 957 q 501 842 519 873 l 325 842 q 152 1045 281 913 l 152 1064 l 260 1064 q 412 940 353 1003 q 567 1064 478 1007 l 675 1064 "},"Ộ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 456 -177 q 480 -112 456 -135 q 547 -89 503 -89 q 613 -112 590 -89 q 635 -177 635 -135 q 612 -241 635 -217 q 547 -265 589 -265 q 480 -241 503 -265 q 456 -177 456 -218 m 699 1071 q 544 1192 615 1120 q 392 1071 474 1123 l 284 1071 l 284 1087 q 457 1293 414 1221 l 633 1293 q 807 1087 676 1218 l 807 1071 l 699 1071 "},"ũ":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 538 841 q 482 853 509 841 q 428 879 454 865 q 376 906 401 894 q 328 918 351 918 q 254 840 273 918 l 172 840 q 224 984 180 934 q 338 1034 268 1034 q 395 1021 367 1034 q 449 995 422 1009 q 500 968 475 980 q 548 956 525 956 q 620 1035 601 956 l 705 1035 q 652 892 696 943 q 538 841 608 841 "},"Ậ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 369 -177 q 393 -112 369 -135 q 460 -89 416 -89 q 526 -112 503 -89 q 548 -177 548 -135 q 525 -241 548 -217 q 460 -265 502 -265 q 393 -241 416 -265 q 369 -177 369 -218 m 613 1071 q 458 1192 529 1120 q 306 1071 388 1123 l 198 1071 l 198 1087 q 371 1293 328 1221 l 547 1293 q 721 1087 590 1218 l 721 1071 l 613 1071 "},"ŭ":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 432 842 q 265 896 326 842 q 198 1048 203 950 l 291 1048 q 309 995 294 1015 q 351 968 324 976 q 435 960 379 960 q 541 982 506 960 q 580 1048 575 1005 l 674 1048 q 601 897 666 952 q 432 842 536 842 "},"―":{"x_min":55.609375,"x_max":1333.390625,"ha":1389,"o":"m 55 308 l 55 437 l 1333 437 l 1333 308 l 55 308 "},"{":{"x_min":30.5,"x_max":504.828125,"ha":536,"o":"m 210 194 q 30 320 210 320 l 30 450 q 166 480 121 450 q 210 574 210 511 l 210 786 q 284 942 210 892 q 504 992 357 992 l 504 868 q 392 836 427 865 q 357 753 357 808 l 357 551 q 202 389 357 416 l 202 381 q 357 220 357 357 l 357 18 q 392 -66 357 -37 q 504 -95 426 -94 l 504 -220 q 279 -166 348 -218 q 210 1 210 -114 l 210 194 "},"¼":{"x_min":40.984375,"x_max":1074.796875,"ha":1153,"o":"m 903 992 l 323 0 l 193 0 l 774 992 l 903 992 m 344 397 l 218 397 l 218 744 l 220 814 l 224 876 q 196 849 212 864 q 100 773 180 834 l 40 850 l 231 992 l 344 992 l 344 397 m 1074 120 l 989 120 l 989 0 l 859 0 l 859 120 l 593 120 l 593 206 l 862 599 l 989 599 l 989 217 l 1074 217 l 1074 120 m 859 217 l 859 337 q 863 471 859 403 q 804 364 828 400 l 703 217 l 859 217 "},"#":{"x_min":31.828125,"x_max":863.8125,"ha":897,"o":"m 670 590 l 633 397 l 816 397 l 816 283 l 610 283 l 556 0 l 435 0 l 490 283 l 322 283 l 267 0 l 149 0 l 201 283 l 31 283 l 31 397 l 223 397 l 262 590 l 83 590 l 83 704 l 282 704 l 336 990 l 458 990 l 404 704 l 574 704 l 629 990 l 747 990 l 692 704 l 863 704 l 863 590 l 670 590 m 343 397 l 512 397 l 551 590 l 381 590 l 343 397 "},"Ḿ":{"x_min":130.90625,"x_max":1151.765625,"ha":1282,"o":"m 559 0 l 271 828 l 266 828 q 278 482 278 643 l 278 0 l 130 0 l 130 992 l 359 992 l 634 202 l 638 202 l 922 992 l 1151 992 l 1151 0 l 995 0 l 995 490 q 999 683 995 564 q 1005 827 1003 802 l 1000 827 l 702 0 l 559 0 m 537 1073 l 537 1089 q 617 1195 576 1137 q 681 1295 658 1253 l 867 1295 l 867 1280 q 761 1174 831 1239 q 643 1073 691 1108 l 537 1073 "},"Ĳ":{"x_min":130.9375,"x_max":712.890625,"ha":839,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 429 -277 q 318 -260 362 -277 l 318 -123 q 417 -137 375 -137 q 550 30 550 -137 l 550 992 l 712 992 l 712 35 q 640 -196 712 -116 q 429 -277 568 -277 "},"Ê":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 563 1071 q 408 1192 479 1120 q 256 1071 338 1123 l 148 1071 l 148 1087 q 321 1293 278 1221 l 497 1293 q 671 1087 540 1218 l 671 1071 l 563 1071 "},")":{"x_min":41.359375,"x_max":384.40625,"ha":440,"o":"m 384 380 q 331 48 384 202 q 180 -220 279 -106 l 42 -220 q 186 61 136 -93 q 235 381 235 216 q 185 705 235 548 q 41 992 135 863 l 180 992 q 332 716 280 873 q 384 380 384 559 "},"Å":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 619 1069 q 574 956 619 999 q 456 913 530 913 q 340 956 383 913 q 296 1067 296 998 q 339 1178 296 1136 q 456 1220 383 1220 q 573 1178 527 1220 q 619 1069 619 1136 m 528 1067 q 508 1120 528 1101 q 456 1140 488 1140 q 404 1120 425 1140 q 384 1067 384 1101 q 456 996 384 996 q 508 1014 488 996 q 528 1067 528 1033 "},"¸":{"x_min":0,"x_max":289.140625,"ha":300,"o":"m 289 -183 q 82 -334 289 -334 q 0 -323 37 -334 l 0 -230 q 83 -240 36 -240 q 141 -229 120 -240 q 163 -187 163 -218 q 41 -112 163 -129 l 98 0 l 201 0 l 173 -60 q 258 -106 228 -74 q 289 -183 289 -138 "},"a":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 "},"Ę":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 538 -157 q 598 -218 538 -218 q 668 -206 627 -218 l 668 -304 q 574 -318 622 -318 q 458 -279 498 -318 q 419 -176 419 -241 q 445 -90 419 -132 q 534 0 470 -48 l 635 0 q 563 -81 588 -44 q 538 -157 538 -118 "},"=":{"x_min":69.1875,"x_max":722.453125,"ha":793,"o":"m 69 563 l 69 685 l 722 685 l 722 563 l 69 563 m 69 293 l 69 413 l 722 413 l 722 293 l 69 293 "},"ạ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 288 -177 q 312 -112 288 -135 q 379 -89 335 -89 q 445 -112 422 -89 q 467 -177 467 -135 q 444 -241 467 -217 q 379 -265 421 -265 q 312 -241 335 -265 q 288 -177 288 -218 "},"˚":{"x_min":238.828125,"x_max":561.125,"ha":802,"o":"m 561 995 q 516 883 561 926 q 398 840 472 840 q 282 882 325 840 q 238 993 238 924 q 281 1104 238 1062 q 398 1147 325 1147 q 515 1104 469 1147 q 561 995 561 1062 m 470 993 q 450 1047 470 1027 q 398 1066 430 1066 q 346 1047 367 1066 q 326 993 326 1027 q 398 922 326 922 q 450 940 430 922 q 470 993 470 959 "},"ú":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 339 842 l 339 858 q 419 964 378 906 q 483 1064 460 1022 l 669 1064 l 669 1049 q 563 943 633 1008 q 445 842 493 877 l 339 842 "},"¯":{"x_min":-4.0625,"x_max":699.0625,"ha":695,"o":"m 699 1055 l -4 1055 l -4 1167 l 699 1167 l 699 1055 "},"Z":{"x_min":44.765625,"x_max":754.234375,"ha":799,"o":"m 754 0 l 44 0 l 44 112 l 544 852 l 58 852 l 58 992 l 740 992 l 740 878 l 238 139 l 754 139 l 754 0 "}," ":{"x_min":0,"x_max":0,"ha":232},"u":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 "},"k":{"x_min":113.90625,"x_max":787.21875,"ha":794,"o":"m 267 396 l 358 508 l 584 750 l 768 750 l 466 427 l 787 0 l 600 0 l 359 328 l 271 257 l 271 0 l 113 0 l 113 1055 l 271 1055 l 271 540 l 263 396 l 267 396 "},"Ù":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 504 1071 q 386 1172 458 1106 q 282 1278 315 1239 l 282 1293 l 467 1293 q 537 1184 493 1245 q 612 1087 582 1122 l 612 1071 l 504 1071 "},"ẻ":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 581 1011 q 470 885 581 911 l 463 822 l 369 822 l 356 931 q 432 956 407 940 q 456 1002 456 973 q 382 1052 456 1052 q 304 1042 342 1052 l 304 1134 q 399 1146 350 1146 q 535 1112 488 1146 q 581 1011 581 1078 "},"ẵ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 500 1077 q 451 1086 476 1077 q 403 1106 427 1095 q 357 1127 380 1117 q 316 1136 335 1136 q 275 1123 289 1136 q 251 1076 260 1109 l 182 1076 q 222 1183 188 1142 q 313 1224 256 1224 q 364 1214 338 1224 q 413 1193 389 1205 q 458 1172 437 1182 q 498 1163 480 1163 q 539 1177 525 1163 q 563 1225 553 1192 l 631 1225 q 590 1115 624 1154 q 500 1077 555 1077 m 401 842 q 240 892 297 842 q 177 1031 182 942 l 264 1031 q 300 964 269 985 q 401 943 332 943 q 499 964 468 943 q 536 1031 530 985 l 623 1031 q 558 889 615 937 q 401 842 501 842 "},"Ů":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 676 1224 q 631 1112 676 1155 q 513 1069 587 1069 q 397 1111 440 1069 q 353 1222 353 1153 q 396 1333 353 1291 q 513 1376 440 1376 q 630 1333 584 1376 q 676 1224 676 1291 m 585 1222 q 565 1276 585 1256 q 513 1295 545 1295 q 461 1276 482 1295 q 441 1222 441 1256 q 513 1151 441 1151 q 565 1169 545 1151 q 585 1222 585 1188 "},"¢":{"x_min":112.609375,"x_max":687.859375,"ha":793,"o":"m 669 161 q 494 118 588 121 l 494 -14 l 388 -14 l 388 122 q 180 238 248 143 q 112 502 112 333 q 180 771 112 674 q 388 890 248 868 l 388 1006 l 495 1006 l 495 896 q 687 851 598 892 l 640 723 q 470 763 541 763 q 324 699 371 763 q 276 503 276 634 q 325 311 276 372 q 468 251 374 251 q 564 261 518 251 q 669 297 610 271 l 669 161 "},"ữ":{"x_min":107.171875,"x_max":1044.625,"ha":989,"o":"m 643 0 l 620 97 l 611 97 q 517 15 577 45 q 379 -14 457 -14 q 174 53 242 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 669 q 847 729 822 681 q 872 865 872 776 l 1035 865 l 1044 849 q 992 696 1025 751 q 903 608 959 641 q 768 565 848 574 l 768 0 l 643 0 m 543 841 q 487 853 514 841 q 433 879 459 865 q 381 906 406 894 q 333 918 356 918 q 259 840 278 918 l 177 840 q 229 984 185 934 q 343 1034 273 1034 q 400 1021 372 1034 q 454 995 427 1009 q 505 968 480 980 q 553 956 530 956 q 625 1035 606 956 l 710 1035 q 657 892 701 943 q 543 841 613 841 "},"Ş":{"x_min":67.84375,"x_max":702.9375,"ha":764,"o":"m 702 269 q 607 61 702 136 q 343 -14 511 -14 q 67 38 175 -14 l 67 191 q 212 141 135 159 q 354 123 288 123 q 496 159 450 123 q 542 258 542 196 q 500 352 542 313 q 326 444 458 391 q 135 569 190 499 q 79 739 79 640 q 167 934 79 863 q 404 1006 255 1006 q 688 943 546 1006 l 636 811 q 400 866 504 866 q 280 832 321 866 q 240 742 240 798 q 256 675 240 703 q 310 623 272 648 q 444 559 347 599 q 604 474 553 513 q 679 385 655 435 q 702 269 702 336 m 509 -183 q 302 -334 509 -334 q 220 -323 257 -334 l 220 -230 q 303 -240 256 -240 q 361 -229 340 -240 q 383 -187 383 -218 q 261 -112 383 -129 l 318 0 l 421 0 l 393 -60 q 478 -106 448 -74 q 509 -183 509 -138 "},"é":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 310 842 l 310 858 q 390 964 349 906 q 454 1064 431 1022 l 640 1064 l 640 1049 q 534 943 604 1008 q 416 842 464 877 l 310 842 "},"B":{"x_min":130.90625,"x_max":841.71875,"ha":917,"o":"m 130 992 l 425 992 q 721 932 630 992 q 812 743 812 872 q 767 599 812 656 q 638 526 723 541 l 638 519 q 792 441 743 499 q 841 284 841 383 q 748 75 841 151 q 489 0 655 0 l 130 0 l 130 992 m 293 582 l 449 582 q 597 614 550 582 q 644 723 644 646 q 593 825 644 793 q 433 856 543 856 l 293 856 l 293 582 m 293 450 l 293 136 l 465 136 q 618 175 567 136 q 670 298 670 214 q 617 413 670 375 q 457 450 565 450 l 293 450 "},"…":{"x_min":90.171875,"x_max":1046.890625,"ha":1137,"o":"m 90 84 q 115 160 90 133 q 190 186 141 186 q 265 159 240 186 q 291 84 291 131 q 265 8 291 36 q 190 -20 239 -20 q 115 7 141 -20 q 90 84 90 35 m 467 84 q 493 160 467 133 q 568 186 519 186 q 643 159 617 186 q 669 84 669 131 q 643 8 669 36 q 568 -20 617 -20 q 493 7 519 -20 q 467 84 467 35 m 845 84 q 871 160 845 133 q 945 186 897 186 q 1021 159 995 186 q 1046 84 1046 131 q 1020 8 1046 36 q 945 -20 994 -20 q 871 7 897 -20 q 845 84 845 35 "},"Ủ":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 673 1240 q 562 1114 673 1140 l 555 1051 l 461 1051 l 448 1160 q 524 1185 499 1169 q 548 1231 548 1202 q 474 1281 548 1281 q 396 1271 434 1281 l 396 1363 q 491 1375 442 1375 q 627 1341 580 1375 q 673 1240 673 1307 "},"ē":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 198 960 l 631 960 l 631 842 l 198 842 l 198 960 "},"H":{"x_min":130.890625,"x_max":912.796875,"ha":1043,"o":"m 912 0 l 750 0 l 750 446 l 293 446 l 293 0 l 130 0 l 130 992 l 293 992 l 293 586 l 750 586 l 750 992 l 912 992 l 912 0 "},"î":{"x_min":-68.078125,"x_max":454.046875,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 346 842 q 191 963 262 891 q 39 842 121 894 l -68 842 l -68 858 q 104 1064 61 992 l 280 1064 q 454 858 323 989 l 454 842 l 346 842 "},"Ẹ":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 319 -177 q 343 -112 319 -135 q 410 -89 366 -89 q 476 -112 453 -89 q 498 -177 498 -135 q 475 -241 498 -217 q 410 -265 452 -265 q 343 -241 366 -265 q 319 -177 319 -218 "},"‼":{"x_min":90.15625,"x_max":675.59375,"ha":765,"o":"m 251 301 l 133 301 l 98 992 l 286 992 l 251 301 m 90 84 q 116 160 90 134 q 191 186 143 186 q 265 159 240 186 q 291 84 291 132 q 265 8 291 36 q 191 -20 239 -20 q 116 7 143 -20 q 90 84 90 34 m 635 301 l 517 301 l 482 992 l 670 992 l 635 301 m 474 84 q 500 160 474 134 q 575 186 527 186 q 649 159 624 186 q 675 84 675 132 q 649 8 675 36 q 575 -20 623 -20 q 500 7 527 -20 q 474 84 474 34 "},"¥":{"x_min":12.203125,"x_max":779.4375,"ha":793,"o":"m 396 540 l 613 992 l 779 992 l 508 476 l 662 476 l 662 373 l 472 373 l 472 269 l 662 269 l 662 165 l 472 165 l 472 0 l 319 0 l 319 165 l 127 165 l 127 269 l 319 269 l 319 373 l 127 373 l 127 476 l 279 476 l 12 992 l 179 992 l 396 540 "},"Ĥ":{"x_min":130.890625,"x_max":912.796875,"ha":1043,"o":"m 912 0 l 750 0 l 750 446 l 293 446 l 293 0 l 130 0 l 130 992 l 293 992 l 293 586 l 750 586 l 750 992 l 912 992 l 912 0 m 672 1071 q 517 1192 588 1120 q 365 1071 447 1123 l 257 1071 l 257 1087 q 430 1293 387 1221 l 606 1293 q 780 1087 649 1218 l 780 1071 l 672 1071 "},"U":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 "},"Ñ":{"x_min":130.90625,"x_max":957.09375,"ha":1088,"o":"m 957 0 l 758 0 l 270 790 l 265 790 l 268 746 q 278 515 278 620 l 278 0 l 130 0 l 130 992 l 327 992 l 814 205 l 818 205 q 812 319 816 221 q 808 472 808 417 l 808 992 l 957 992 l 957 0 m 647 1070 q 591 1082 618 1070 q 537 1108 563 1094 q 485 1135 510 1123 q 437 1147 460 1147 q 363 1069 382 1147 l 281 1069 q 333 1213 289 1163 q 447 1263 377 1263 q 504 1250 476 1263 q 558 1224 531 1238 q 609 1197 584 1209 q 657 1185 634 1185 q 729 1264 710 1185 l 814 1264 q 761 1121 805 1172 q 647 1070 717 1070 "},"F":{"x_min":130.84375,"x_max":690.1875,"ha":739,"o":"m 291 0 l 130 0 l 130 992 l 690 992 l 690 855 l 291 855 l 291 545 l 665 545 l 665 407 l 291 407 l 291 0 "},"ả":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 564 1011 q 453 885 564 911 l 446 822 l 352 822 l 339 931 q 415 956 390 940 q 439 1002 439 973 q 365 1052 439 1052 q 287 1042 325 1052 l 287 1134 q 382 1146 333 1146 q 518 1112 471 1146 q 564 1011 564 1078 "},"ĵ":{"x_min":-82.140625,"x_max":452.046875,"ha":387,"o":"m 37 -334 q -82 -317 -34 -334 l -82 -190 q 12 -203 -36 -203 q 113 -87 113 -203 l 113 750 l 273 750 l 273 -98 q 212 -274 273 -214 q 37 -334 151 -334 m 344 842 q 189 963 260 891 q 37 842 119 894 l -70 842 l -70 858 q 102 1064 59 992 l 278 1064 q 452 858 321 989 l 452 842 l 344 842 "},"ā":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 197 960 l 630 960 l 630 842 l 197 842 l 197 960 "},"Ĩ":{"x_min":-52.96875,"x_max":480,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 313 1070 q 257 1082 284 1070 q 203 1108 229 1094 q 151 1135 176 1123 q 103 1147 126 1147 q 29 1069 48 1147 l -52 1069 q 0 1213 -44 1163 q 113 1263 43 1263 q 170 1250 142 1263 q 224 1224 197 1238 q 275 1197 250 1209 q 323 1185 300 1185 q 395 1264 376 1185 l 480 1264 q 427 1121 471 1172 q 313 1070 383 1070 "},"ă":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 405 842 q 238 896 299 842 q 171 1048 176 950 l 264 1048 q 282 995 267 1015 q 324 968 297 976 q 408 960 352 960 q 514 982 479 960 q 553 1048 548 1005 l 647 1048 q 574 897 639 952 q 405 842 509 842 "},"*":{"x_min":50.1875,"x_max":708.09375,"ha":761,"o":"m 455 1055 l 427 795 l 689 869 l 708 722 l 463 702 l 624 491 l 489 419 l 376 648 l 275 419 l 136 491 l 293 702 l 50 722 l 73 869 l 328 795 l 301 1055 l 455 1055 "},"†":{"x_min":83.453125,"x_max":624.21875,"ha":707,"o":"m 624 653 l 392 673 l 426 0 l 265 0 l 301 673 l 83 653 l 83 793 l 301 772 l 265 1055 l 426 1055 l 392 772 l 624 793 l 624 653 "},"ờ":{"x_min":69.21875,"x_max":946.546875,"ha":895,"o":"m 779 376 q 685 89 779 192 q 422 -14 591 -14 q 236 33 317 -14 q 112 169 156 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 565 739 500 764 q 676 669 629 715 q 748 728 724 683 q 772 864 772 772 l 936 864 l 946 848 q 872 666 921 727 q 737 580 823 605 q 779 376 779 489 m 233 376 q 278 182 233 247 q 425 116 324 116 q 570 182 525 116 q 615 376 615 247 q 570 568 615 503 q 424 633 524 633 q 278 568 323 633 q 233 376 233 503 m 422 842 q 304 943 376 877 q 200 1049 233 1010 l 200 1064 l 385 1064 q 455 955 411 1016 q 530 858 500 893 l 530 842 l 422 842 "},"°":{"x_min":73.953125,"x_max":519.6875,"ha":595,"o":"m 73 782 q 138 939 73 873 q 297 1006 202 1006 q 455 940 390 1006 q 519 782 519 875 q 454 624 519 688 q 297 560 389 560 q 185 589 237 560 q 103 670 133 618 q 73 782 73 722 m 177 782 q 212 699 177 734 q 297 664 246 664 q 381 699 347 664 q 416 782 416 734 q 381 868 416 833 q 297 902 346 902 q 213 867 248 902 q 177 782 177 832 "},"å":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 571 995 q 526 883 571 926 q 408 840 482 840 q 292 882 335 840 q 248 993 248 924 q 291 1104 248 1062 q 408 1147 335 1147 q 525 1104 479 1147 q 571 995 571 1062 m 480 993 q 460 1047 480 1027 q 408 1066 440 1066 q 356 1047 377 1066 q 336 993 336 1027 q 408 922 336 922 q 460 940 440 922 q 480 993 480 959 "},"ồ":{"x_min":22.84375,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 195 858 q 297 980 271 947 q 342 1042 323 1014 l 509 1042 q 654 858 568 955 l 654 842 l 568 842 q 425 954 503 886 q 282 842 353 889 l 195 842 l 195 858 m 252 974 l 168 974 q 22 1113 74 1045 l 22 1128 l 163 1128 q 252 990 199 1053 l 252 974 "},"0":{"x_min":59.703125,"x_max":733.296875,"ha":793,"o":"m 733 495 q 650 111 733 237 q 396 -14 567 -14 q 145 115 230 -14 q 59 495 59 245 q 142 882 59 758 q 396 1007 225 1007 q 647 876 562 1007 q 733 495 733 746 m 221 495 q 262 205 221 292 q 396 118 304 118 q 530 207 487 118 q 572 495 572 295 q 530 784 572 694 q 396 873 487 873 q 262 785 304 873 q 221 495 221 698 "},"ō":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 207 960 l 640 960 l 640 842 l 207 842 l 207 960 "},"”":{"x_min":16.9375,"x_max":534.171875,"ha":551,"o":"m 251 977 q 132 652 215 835 l 16 652 q 84 992 63 848 l 241 992 l 251 977 m 534 977 q 414 652 498 835 l 298 652 q 368 992 344 835 l 524 992 l 534 977 "},"ŵ":{"x_min":13.5625,"x_max":1120.078125,"ha":1135,"o":"m 729 0 l 632 349 q 568 608 614 405 l 562 608 q 499 348 523 425 l 400 0 l 223 0 l 13 750 l 176 750 l 272 380 q 318 145 304 243 l 322 145 q 342 259 329 195 q 367 355 356 323 l 481 750 l 656 750 l 766 355 q 792 253 776 322 q 810 147 807 185 l 815 147 q 862 380 825 230 l 960 750 l 1120 750 l 908 0 l 729 0 m 719 842 q 564 963 635 891 q 412 842 494 894 l 304 842 l 304 858 q 477 1064 434 992 l 653 1064 q 827 858 696 989 l 827 842 l 719 842 "},"Ķ":{"x_min":130.921875,"x_max":888,"ha":888,"o":"m 888 0 l 700 0 l 388 449 l 293 371 l 293 0 l 130 0 l 130 992 l 293 992 l 293 518 q 425 675 359 599 l 693 992 l 877 992 q 505 557 618 686 l 888 0 m 340 -290 q 371 -188 356 -246 q 391 -85 385 -129 l 543 -85 l 543 -98 q 492 -210 524 -152 q 433 -307 461 -269 l 340 -307 l 340 -290 "},"ö":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 210 948 q 233 1009 210 990 q 288 1028 256 1028 q 346 1006 324 1028 q 367 948 367 985 q 345 890 367 912 q 288 869 323 869 q 233 888 256 869 q 210 948 210 908 m 477 948 q 499 1009 477 990 q 555 1028 522 1028 q 612 1006 591 1028 q 634 948 634 985 q 612 890 634 911 q 555 869 589 869 q 499 888 522 869 q 477 948 477 908 "},"Ļ":{"x_min":130.921875,"x_max":712.96875,"ha":753,"o":"m 130 0 l 130 992 l 293 992 l 293 139 l 712 139 l 712 0 l 130 0 m 283 -290 q 314 -188 299 -246 q 334 -85 328 -129 l 486 -85 l 486 -98 q 435 -210 467 -152 q 376 -307 404 -269 l 283 -307 l 283 -290 "},"Õ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 644 1070 q 588 1082 615 1070 q 534 1108 560 1094 q 482 1135 507 1123 q 434 1147 457 1147 q 360 1069 379 1147 l 278 1069 q 330 1213 286 1163 q 444 1263 374 1263 q 501 1250 473 1263 q 555 1224 528 1238 q 606 1197 581 1209 q 654 1185 631 1185 q 726 1264 707 1185 l 811 1264 q 758 1121 802 1172 q 644 1070 714 1070 "},"ć":{"x_min":69.203125,"x_max":643.21875,"ha":688,"o":"m 416 -14 q 157 85 246 -14 q 69 370 69 184 q 161 662 69 560 q 429 764 254 764 q 643 719 548 764 l 595 591 q 428 631 493 631 q 233 372 233 631 q 281 182 233 245 q 424 118 330 118 q 625 171 530 118 l 625 32 q 534 -3 582 7 q 416 -14 485 -14 m 305 842 l 305 858 q 385 964 344 906 q 449 1064 426 1022 l 635 1064 l 635 1049 q 529 943 599 1008 q 411 842 459 877 l 305 842 "},"þ":{"x_min":113.890625,"x_max":793.828125,"ha":865,"o":"m 273 651 q 369 737 314 710 q 496 764 425 764 q 715 661 636 764 q 793 376 793 558 q 714 88 793 191 q 496 -14 635 -14 q 273 87 348 -14 l 263 87 l 269 38 l 273 -24 l 273 -334 l 113 -334 l 113 1055 l 273 1055 l 273 763 l 268 670 l 266 651 l 273 651 m 456 633 q 316 578 360 633 q 273 401 273 522 l 273 376 q 316 177 273 239 q 458 116 360 116 q 630 377 630 116 q 588 570 630 506 q 456 633 547 633 "},"]":{"x_min":34.546875,"x_max":352.3125,"ha":458,"o":"m 34 -99 l 207 -99 l 207 872 l 34 872 l 34 992 l 352 992 l 352 -220 l 34 -220 l 34 -99 "},"′":{"x_min":90.265625,"x_max":247.609375,"ha":338,"o":"m 247 992 l 219 634 l 118 634 l 90 992 l 247 992 "},"ẁ":{"x_min":13.5625,"x_max":1120.078125,"ha":1135,"o":"m 729 0 l 632 349 q 568 608 614 405 l 562 608 q 499 348 523 425 l 400 0 l 223 0 l 13 750 l 176 750 l 272 380 q 318 145 304 243 l 322 145 q 342 259 329 195 q 367 355 356 323 l 481 750 l 656 750 l 766 355 q 792 253 776 322 q 810 147 807 185 l 815 147 q 862 380 825 230 l 960 750 l 1120 750 l 908 0 l 729 0 m 552 842 q 434 943 506 877 q 330 1049 363 1010 l 330 1064 l 515 1064 q 585 955 541 1016 q 660 858 630 893 l 660 842 l 552 842 "},"ệ":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 314 -177 q 338 -112 314 -135 q 405 -89 361 -89 q 471 -112 448 -89 q 493 -177 493 -135 q 470 -241 493 -217 q 405 -265 447 -265 q 338 -241 361 -265 q 314 -177 314 -218 m 559 842 q 404 963 475 891 q 252 842 334 894 l 144 842 l 144 858 q 317 1064 274 992 l 493 1064 q 667 858 536 989 l 667 842 l 559 842 "},"ĭ":{"x_min":-45.703125,"x_max":430.984375,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 188 842 q 21 896 82 842 q -45 1048 -40 950 l 47 1048 q 65 995 50 1015 q 107 968 80 976 q 191 960 135 960 q 297 982 262 960 q 336 1048 331 1005 l 430 1048 q 357 897 422 952 q 188 842 292 842 "},"8":{"x_min":59.703125,"x_max":733.296875,"ha":793,"o":"m 396 1004 q 619 939 537 1004 q 701 765 701 874 q 518 522 701 613 q 684 400 634 464 q 733 256 733 335 q 643 59 733 133 q 398 -14 552 -14 q 148 55 237 -14 q 59 251 59 124 q 106 399 59 333 q 258 517 152 465 q 128 632 167 571 q 90 767 90 692 q 175 939 90 875 q 396 1004 259 1004 m 212 256 q 261 147 212 186 q 396 108 311 108 q 532 148 483 108 q 580 257 580 188 q 535 358 580 312 q 400 442 491 403 l 380 451 q 251 364 291 411 q 212 256 212 317 m 394 881 q 285 847 326 881 q 244 756 244 814 q 259 693 244 721 q 302 642 274 665 q 398 588 331 619 q 513 663 480 623 q 547 756 547 703 q 505 847 547 814 q 394 881 463 881 "},"Ữ":{"x_min":122.125,"x_max":1183.953125,"ha":1148,"o":"m 908 992 l 908 860 q 986 919 961 872 q 1011 1056 1011 966 l 1174 1056 l 1183 1041 q 1132 890 1165 944 q 1044 803 1099 837 q 908 756 989 769 l 908 349 q 805 82 908 179 q 515 -14 702 -14 q 225 83 328 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 355 q 519 124 284 124 q 746 356 746 124 l 746 992 l 908 992 m 620 1070 q 564 1082 591 1070 q 510 1108 536 1094 q 458 1135 483 1123 q 410 1147 433 1147 q 336 1069 355 1147 l 254 1069 q 306 1213 262 1163 q 420 1263 350 1263 q 477 1250 449 1263 q 531 1224 504 1238 q 582 1197 557 1209 q 630 1185 607 1185 q 702 1264 683 1185 l 787 1264 q 734 1121 778 1172 q 620 1070 690 1070 "},"R":{"x_min":130.921875,"x_max":875.109375,"ha":888,"o":"m 293 531 l 405 531 q 569 573 518 531 q 620 697 620 615 q 565 818 620 781 q 400 855 510 855 l 293 855 l 293 531 m 293 396 l 293 0 l 130 0 l 130 992 l 411 992 q 695 920 603 992 q 787 703 787 848 q 594 439 787 518 l 875 0 l 690 0 l 453 396 l 293 396 "},"ť":{"x_min":26.453125,"x_max":574.203125,"ha":546,"o":"m 393 114 q 510 133 451 114 l 510 13 q 441 -6 483 1 q 355 -14 400 -14 q 128 224 128 -14 l 128 629 l 26 629 l 26 699 l 136 758 l 190 917 l 288 917 l 288 750 l 502 750 l 502 629 l 288 629 l 288 227 q 317 142 288 169 q 393 114 346 114 m 376 856 q 420 1062 408 963 l 574 1062 l 574 1048 q 528 945 558 1006 q 468 840 497 884 l 376 840 l 376 856 "},"Ľ":{"x_min":130.921875,"x_max":712.96875,"ha":753,"o":"m 130 0 l 130 992 l 293 992 l 293 139 l 712 139 l 712 0 l 130 0 m 473 786 q 517 992 505 893 l 671 992 l 671 978 q 625 875 655 936 q 565 770 594 814 l 473 770 l 473 786 "},"Ż":{"x_min":44.765625,"x_max":754.234375,"ha":799,"o":"m 754 0 l 44 0 l 44 112 l 544 852 l 58 852 l 58 992 l 740 992 l 740 878 l 238 139 l 754 139 l 754 0 m 308 1177 q 331 1242 308 1219 q 398 1266 355 1266 q 464 1242 440 1266 q 487 1177 487 1219 q 464 1113 487 1136 q 398 1090 440 1090 q 331 1113 355 1090 q 308 1177 308 1136 "},"o":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 "},"5":{"x_min":79.375,"x_max":722.453125,"ha":793,"o":"m 397 619 q 634 539 547 619 q 722 323 722 460 q 623 75 722 164 q 340 -14 523 -14 q 79 39 174 -14 l 79 184 q 205 135 134 152 q 337 118 276 118 q 502 167 445 118 q 558 308 558 215 q 331 486 558 486 q 253 479 299 486 q 170 465 206 473 l 99 507 l 137 992 l 653 992 l 653 850 l 278 850 l 255 604 q 313 613 279 608 q 397 619 347 619 "},"ħ":{"x_min":8.140625,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 427 q 579 556 614 513 q 468 599 544 599 q 320 539 367 599 q 273 338 273 479 l 273 0 l 113 0 l 113 826 l 8 826 l 8 937 l 113 937 l 113 1055 l 273 1055 l 273 937 l 531 937 l 531 826 l 273 826 l 273 753 q 272 706 273 734 q 265 616 270 679 l 275 616 q 371 702 312 675 q 502 730 430 730 q 774 455 774 730 l 774 0 "},"õ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 525 841 q 469 853 496 841 q 415 879 441 865 q 363 906 388 894 q 315 918 338 918 q 241 840 260 918 l 159 840 q 211 984 167 934 q 325 1034 255 1034 q 382 1021 354 1034 q 436 995 409 1009 q 487 968 462 980 q 535 956 512 956 q 607 1035 588 956 l 692 1035 q 639 892 683 943 q 525 841 595 841 "},"ẫ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 495 1070 q 446 1079 471 1070 q 398 1099 422 1088 q 352 1120 375 1111 q 311 1130 330 1130 q 270 1116 284 1130 q 246 1069 255 1102 l 177 1069 q 218 1182 183 1139 q 308 1226 253 1226 q 359 1216 333 1226 q 408 1195 384 1206 q 453 1173 432 1183 q 493 1164 475 1164 q 534 1178 520 1164 q 558 1227 548 1193 l 626 1227 q 584 1111 619 1153 q 495 1070 549 1070 m 630 842 l 551 842 q 401 949 468 889 q 251 842 339 894 l 171 842 l 171 859 q 325 1036 285 978 l 478 1036 q 630 859 523 970 l 630 842 "},",":{"x_min":42.734375,"x_max":279.4375,"ha":371,"o":"m 279 145 q 160 -179 246 19 l 42 -179 q 112 161 89 3 l 269 161 l 279 145 "},"d":{"x_min":69.140625,"x_max":751.109375,"ha":865,"o":"m 366 -14 q 147 87 226 -14 q 69 373 69 189 q 148 661 69 558 q 369 764 228 764 q 594 654 517 764 l 602 654 q 591 782 591 735 l 591 1055 l 751 1055 l 751 0 l 626 0 l 598 98 l 591 98 q 366 -14 514 -14 m 409 114 q 552 170 507 114 q 598 349 597 225 l 598 372 q 552 574 598 514 q 408 633 506 633 q 278 565 324 633 q 233 370 233 497 q 277 180 233 245 q 409 114 321 114 "},"\"":{"x_min":90.25,"x_max":515.75,"ha":606,"o":"m 247 992 l 219 634 l 118 634 l 90 992 l 247 992 m 515 992 l 487 634 l 386 634 l 358 992 l 515 992 "},"˙":{"x_min":104.375,"x_max":283.421875,"ha":387,"o":"m 104 948 q 127 1013 104 990 q 194 1037 151 1037 q 260 1013 236 1037 q 283 948 283 990 q 260 884 283 907 q 194 861 236 861 q 127 884 151 861 q 104 948 104 907 "},"ê":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 568 842 q 413 963 484 891 q 261 842 343 894 l 153 842 l 153 858 q 326 1064 283 992 l 502 1064 q 676 858 545 989 l 676 842 l 568 842 "},"″":{"x_min":90.25,"x_max":515.75,"ha":606,"o":"m 247 992 l 219 634 l 118 634 l 90 992 l 247 992 m 515 992 l 487 634 l 386 634 l 358 992 l 515 992 "},"„":{"x_min":29.15625,"x_max":548.53125,"ha":640,"o":"m 265 145 q 145 -179 227 0 l 29 -179 q 98 161 73 -2 l 255 161 l 265 145 m 548 145 q 429 -179 515 19 l 312 -179 q 381 161 357 -2 l 539 161 l 548 145 "},"ľ":{"x_min":113.859375,"x_max":534.203125,"ha":387,"o":"m 273 0 l 113 0 l 113 1055 l 273 1055 l 273 0 m 336 849 q 380 1055 368 956 l 534 1055 l 534 1041 q 488 938 518 999 q 428 833 457 877 l 336 833 l 336 849 "},"Â":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 608 1071 q 453 1192 524 1120 q 301 1071 383 1123 l 193 1071 l 193 1087 q 366 1293 323 1221 l 542 1293 q 716 1087 585 1218 l 716 1071 l 608 1071 "},"Į":{"x_min":51.578125,"x_max":300.78125,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 170 -157 q 230 -218 170 -218 q 300 -206 259 -218 l 300 -304 q 206 -318 254 -318 q 90 -279 130 -318 q 51 -176 51 -241 q 77 -90 51 -132 q 166 0 102 -48 l 267 0 q 195 -81 220 -44 q 170 -157 170 -118 "},"ė":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 328 948 q 351 1013 328 990 q 418 1037 375 1037 q 484 1013 460 1037 q 507 948 507 990 q 484 884 507 907 q 418 861 460 861 q 351 884 375 861 q 328 948 328 907 "},"ề":{"x_min":13.84375,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 186 858 q 288 980 262 947 q 333 1042 314 1014 l 500 1042 q 645 858 559 955 l 645 842 l 559 842 q 416 954 494 886 q 273 842 344 889 l 186 842 l 186 858 m 243 974 l 159 974 q 13 1113 65 1045 l 13 1128 l 154 1128 q 243 990 190 1053 l 243 974 "},"Ţ":{"x_min":19.671875,"x_max":764.984375,"ha":786,"o":"m 473 0 l 311 0 l 311 852 l 19 852 l 19 992 l 764 992 l 764 852 l 473 852 l 473 0 m 530 -183 q 323 -334 530 -334 q 241 -323 278 -334 l 241 -230 q 324 -240 277 -240 q 382 -229 361 -240 q 404 -187 404 -218 q 282 -112 404 -129 l 339 0 l 442 0 l 414 -60 q 499 -106 469 -74 q 530 -183 530 -138 "},"Í":{"x_min":121.515625,"x_max":451.125,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 121 1071 l 121 1087 q 201 1193 160 1135 q 265 1293 242 1251 l 451 1293 l 451 1278 q 345 1172 415 1237 q 227 1071 275 1106 l 121 1071 "},"´":{"x_min":245.515625,"x_max":575.125,"ha":822,"o":"m 245 842 l 245 858 q 325 964 284 906 q 389 1064 366 1022 l 575 1064 l 575 1049 q 469 943 539 1008 q 351 842 399 877 l 245 842 "},"Ú":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 406 1071 l 406 1087 q 486 1193 445 1135 q 550 1293 527 1251 l 736 1293 l 736 1278 q 630 1172 700 1237 q 512 1071 560 1106 l 406 1071 "}," ":{"x_min":0,"x_max":0,"ha":278},"Ŷ":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 565 1071 q 410 1192 481 1120 q 258 1071 340 1123 l 150 1071 l 150 1087 q 323 1293 280 1221 l 499 1293 q 673 1087 542 1218 l 673 1071 l 565 1071 "},"ỏ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 587 1011 q 476 885 587 911 l 469 822 l 375 822 l 362 931 q 438 956 413 940 q 462 1002 462 973 q 388 1052 462 1052 q 310 1042 348 1052 l 310 1134 q 405 1146 356 1146 q 541 1112 494 1146 q 587 1011 587 1078 "},"Ự":{"x_min":122.125,"x_max":1183.953125,"ha":1148,"o":"m 908 992 l 908 860 q 986 919 961 872 q 1011 1056 1011 966 l 1174 1056 l 1183 1041 q 1132 890 1165 944 q 1044 803 1099 837 q 908 756 989 769 l 908 349 q 805 82 908 179 q 515 -14 702 -14 q 225 83 328 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 355 q 519 124 284 124 q 746 356 746 124 l 746 992 l 908 992 m 421 -177 q 445 -112 421 -135 q 512 -89 468 -89 q 578 -112 555 -89 q 600 -177 600 -135 q 577 -241 600 -217 q 512 -265 554 -265 q 445 -241 468 -265 q 421 -177 421 -218 "},"ŝ":{"x_min":66.453125,"x_max":617.6875,"ha":676,"o":"m 617 213 q 537 44 617 103 q 308 -14 457 -14 q 67 31 158 -14 l 67 169 q 313 108 200 108 q 461 197 461 108 q 444 244 461 225 q 391 284 428 263 q 287 330 353 304 q 112 430 157 380 q 66 561 66 480 q 144 710 66 657 q 355 764 221 764 q 605 710 487 764 l 553 590 q 349 640 432 640 q 223 568 223 640 q 256 508 223 533 q 400 441 289 484 q 534 375 492 405 q 597 306 577 345 q 617 213 617 267 m 501 842 q 346 963 417 891 q 194 842 276 894 l 86 842 l 86 858 q 259 1064 216 992 l 435 1064 q 609 858 478 989 l 609 842 l 501 842 "},"Ý":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 305 1071 l 305 1087 q 385 1193 344 1135 q 449 1293 426 1251 l 635 1293 l 635 1278 q 529 1172 599 1237 q 411 1071 459 1106 l 305 1071 "},"Ĉ":{"x_min":82.03125,"x_max":834.578125,"ha":880,"o":"m 552 866 q 332 767 412 866 q 252 494 252 668 q 329 218 252 311 q 552 124 406 124 q 674 136 615 124 q 797 169 733 149 l 797 30 q 532 -14 680 -14 q 198 117 315 -14 q 82 495 82 249 q 138 766 82 650 q 302 944 195 882 q 553 1006 409 1006 q 834 942 705 1006 l 776 807 q 670 849 726 831 q 552 866 614 866 m 683 1071 q 528 1192 599 1120 q 376 1071 458 1123 l 268 1071 l 268 1087 q 441 1293 398 1221 l 617 1293 q 791 1087 660 1218 l 791 1071 l 683 1071 "}," ":{"x_min":0,"x_max":0,"ha":1389},"ą":{"x_min":61.0625,"x_max":718.78125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 588 -157 q 648 -218 588 -218 q 718 -206 677 -218 l 718 -304 q 624 -318 672 -318 q 508 -279 548 -318 q 469 -176 469 -241 q 495 -90 469 -132 q 584 0 520 -48 l 685 0 q 613 -81 638 -44 q 588 -157 588 -118 "},"Ờ":{"x_min":82.09375,"x_max":1149.265625,"ha":1114,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 897 865 776 1007 q 956 926 937 880 q 975 1055 975 971 l 1139 1055 l 1149 1040 q 1081 863 1127 926 q 957 770 1034 800 q 1010 496 1010 652 m 254 496 q 328 217 254 311 q 547 124 402 124 q 838 496 838 124 q 548 867 838 867 q 328 774 402 867 q 254 496 254 681 m 546 1071 q 428 1172 500 1106 q 324 1278 357 1239 l 324 1293 l 509 1293 q 579 1184 535 1245 q 654 1087 624 1122 l 654 1071 l 546 1071 "},"​":{"x_min":0,"x_max":0,"ha":0},"Ö":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 336 1177 q 359 1238 336 1219 q 414 1257 382 1257 q 472 1235 450 1257 q 493 1177 493 1214 q 471 1119 493 1141 q 414 1098 449 1098 q 359 1117 382 1098 q 336 1177 336 1137 m 603 1177 q 625 1238 603 1219 q 681 1257 648 1257 q 738 1235 717 1257 q 760 1177 760 1214 q 738 1119 760 1140 q 681 1098 715 1098 q 625 1117 648 1098 q 603 1177 603 1137 "},"z":{"x_min":46.125,"x_max":615.171875,"ha":664,"o":"m 615 0 l 46 0 l 46 98 l 425 627 l 69 627 l 69 750 l 604 750 l 604 638 l 233 122 l 615 122 l 615 0 "},"ặ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 395 842 q 228 896 289 842 q 161 1048 166 950 l 254 1048 q 272 995 257 1015 q 314 968 287 976 q 398 960 342 960 q 504 982 469 960 q 543 1048 538 1005 l 637 1048 q 564 897 629 952 q 395 842 499 842 m 288 -177 q 312 -112 288 -135 q 379 -89 335 -89 q 445 -112 422 -89 q 467 -177 467 -135 q 444 -241 467 -217 q 379 -265 421 -265 q 312 -241 335 -265 q 288 -177 288 -218 "},"Ř":{"x_min":130.921875,"x_max":875.109375,"ha":888,"o":"m 293 531 l 405 531 q 569 573 518 531 q 620 697 620 615 q 565 818 620 781 q 400 855 510 855 l 293 855 l 293 531 m 293 396 l 293 0 l 130 0 l 130 992 l 411 992 q 695 920 603 992 q 787 703 787 848 q 594 439 787 518 l 875 0 l 690 0 l 453 396 l 293 396 m 702 1293 l 702 1274 q 581 1144 616 1186 q 528 1071 546 1102 l 352 1071 q 179 1274 308 1142 l 179 1293 l 287 1293 q 439 1169 380 1232 q 594 1293 505 1236 l 702 1293 "},"Ắ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 404 1264 q 487 1402 454 1332 l 620 1402 l 620 1387 q 481 1247 559 1308 l 404 1247 l 404 1264 m 458 1071 q 299 1122 356 1071 q 237 1274 242 1174 l 323 1274 q 359 1197 328 1222 q 459 1172 391 1172 q 554 1198 518 1172 q 595 1274 589 1223 l 683 1274 q 616 1124 676 1177 q 458 1071 557 1071 "},"ã":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 507 841 q 451 853 478 841 q 397 879 423 865 q 345 906 370 894 q 297 918 320 918 q 223 840 242 918 l 141 840 q 193 984 149 934 q 307 1034 237 1034 q 364 1021 336 1034 q 418 995 391 1009 q 469 968 444 980 q 517 956 494 956 q 589 1035 570 956 l 674 1035 q 621 892 665 943 q 507 841 577 841 "},"Ň":{"x_min":130.90625,"x_max":957.09375,"ha":1088,"o":"m 957 0 l 758 0 l 270 790 l 265 790 l 268 746 q 278 515 278 620 l 278 0 l 130 0 l 130 992 l 327 992 l 814 205 l 818 205 q 812 319 816 221 q 808 472 808 417 l 808 992 l 957 992 l 957 0 m 812 1293 l 812 1274 q 691 1144 726 1186 q 638 1071 656 1102 l 462 1071 q 289 1274 418 1142 l 289 1293 l 397 1293 q 549 1169 490 1232 q 704 1293 615 1236 l 812 1293 "},"æ":{"x_min":61.03125,"x_max":1166.234375,"ha":1232,"o":"m 61 215 q 143 390 61 331 q 394 454 225 449 l 522 459 l 522 510 q 385 641 522 641 q 177 586 290 641 l 127 698 q 258 747 187 730 q 396 764 328 764 q 626 658 559 764 q 861 764 707 764 q 1083 672 1000 764 q 1166 426 1166 581 l 1166 340 l 683 340 q 887 112 690 112 q 1128 166 1012 112 l 1128 36 q 1012 -2 1070 9 q 880 -14 954 -14 q 711 23 785 -14 q 592 134 638 60 q 463 17 528 49 q 299 -14 398 -14 q 124 47 187 -14 q 61 215 61 108 m 226 213 q 339 108 226 108 q 471 157 423 108 q 520 293 520 206 l 520 358 l 429 354 q 275 317 324 350 q 226 213 226 284 m 858 643 q 738 595 782 643 q 687 454 693 548 l 1008 454 q 968 592 1008 542 q 858 643 928 643 "},"ừ":{"x_min":107.171875,"x_max":1044.625,"ha":989,"o":"m 643 0 l 620 97 l 611 97 q 517 15 577 45 q 379 -14 457 -14 q 174 53 242 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 669 q 847 729 822 681 q 872 865 872 776 l 1035 865 l 1044 849 q 992 696 1025 751 q 903 608 959 641 q 768 565 848 574 l 768 0 l 643 0 m 412 842 q 294 943 366 877 q 190 1049 223 1010 l 190 1064 l 375 1064 q 445 955 401 1016 q 520 858 490 893 l 520 842 l 412 842 "},"Ợ":{"x_min":82.09375,"x_max":1149.265625,"ha":1114,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 897 865 776 1007 q 956 926 937 880 q 975 1055 975 971 l 1139 1055 l 1149 1040 q 1081 863 1127 926 q 957 770 1034 800 q 1010 496 1010 652 m 254 496 q 328 217 254 311 q 547 124 402 124 q 838 496 838 124 q 548 867 838 867 q 328 774 402 867 q 254 496 254 681 m 455 -177 q 479 -112 455 -135 q 546 -89 502 -89 q 612 -112 589 -89 q 634 -177 634 -135 q 611 -241 634 -217 q 546 -265 588 -265 q 479 -241 502 -265 q 455 -177 455 -218 "},"ĩ":{"x_min":-70.96875,"x_max":462,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 295 841 q 239 853 266 841 q 185 879 211 865 q 133 906 158 894 q 85 918 108 918 q 11 840 30 918 l -70 840 q -18 984 -62 934 q 95 1034 25 1034 q 152 1021 124 1034 q 206 995 179 1009 q 257 968 232 980 q 305 956 282 956 q 377 1035 358 956 l 462 1035 q 409 892 453 943 q 295 841 365 841 "},"É":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 298 1071 l 298 1087 q 378 1193 337 1135 q 442 1293 419 1251 l 628 1293 l 628 1278 q 522 1172 592 1237 q 404 1071 452 1106 l 298 1071 "},"ŀ":{"x_min":113.859375,"x_max":541.421875,"ha":515,"o":"m 273 0 l 113 0 l 113 1055 l 273 1055 l 273 0 m 362 465 q 385 530 362 507 q 452 554 409 554 q 518 530 494 554 q 541 465 541 507 q 518 401 541 424 q 452 378 494 378 q 385 401 409 378 q 362 465 362 424 "},"~":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 223 469 q 148 448 189 469 q 65 387 106 428 l 65 516 q 234 590 132 590 q 319 581 279 590 q 419 547 359 572 q 568 509 508 509 q 646 530 603 509 q 727 591 688 551 l 727 462 q 558 387 656 387 q 471 397 514 387 q 372 431 429 408 q 223 469 286 469 "},"Ċ":{"x_min":82.03125,"x_max":834.578125,"ha":880,"o":"m 552 866 q 332 767 412 866 q 252 494 252 668 q 329 218 252 311 q 552 124 406 124 q 674 136 615 124 q 797 169 733 149 l 797 30 q 532 -14 680 -14 q 198 117 315 -14 q 82 495 82 249 q 138 766 82 650 q 302 944 195 882 q 553 1006 409 1006 q 834 942 705 1006 l 776 807 q 670 849 726 831 q 552 866 614 866 m 447 1177 q 470 1242 447 1219 q 537 1266 494 1266 q 603 1242 579 1266 q 626 1177 626 1219 q 603 1113 626 1136 q 537 1090 579 1090 q 470 1113 494 1090 q 447 1177 447 1136 "},"³":{"x_min":30.53125,"x_max":457.1875,"ha":504,"o":"m 437 848 q 410 764 437 797 q 328 706 382 732 q 424 654 392 692 q 457 565 457 617 q 394 432 457 479 q 213 386 331 386 q 30 428 113 386 l 30 534 q 213 480 128 480 q 335 572 335 480 q 200 656 335 656 l 122 656 l 122 747 l 193 747 q 318 834 318 747 q 294 888 318 869 q 233 907 271 907 q 161 894 194 907 q 90 855 128 880 l 33 932 q 124 983 74 963 q 240 1004 173 1004 q 384 962 331 1004 q 437 848 437 920 "},"¡":{"x_min":90.15625,"x_max":291.59375,"ha":383,"o":"m 130 437 l 248 437 l 283 -252 l 95 -252 l 130 437 m 291 654 q 266 577 291 604 q 190 551 240 551 q 115 577 141 551 q 90 654 90 604 q 115 729 90 701 q 190 758 141 758 q 265 730 239 758 q 291 654 291 703 "},"ẅ":{"x_min":13.5625,"x_max":1120.078125,"ha":1135,"o":"m 729 0 l 632 349 q 568 608 614 405 l 562 608 q 499 348 523 425 l 400 0 l 223 0 l 13 750 l 176 750 l 272 380 q 318 145 304 243 l 322 145 q 342 259 329 195 q 367 355 356 323 l 481 750 l 656 750 l 766 355 q 792 253 776 322 q 810 147 807 185 l 815 147 q 862 380 825 230 l 960 750 l 1120 750 l 908 0 l 729 0 m 353 948 q 376 1009 353 990 q 431 1028 399 1028 q 489 1006 467 1028 q 510 948 510 985 q 488 890 510 912 q 431 869 466 869 q 376 888 399 869 q 353 948 353 908 m 620 948 q 642 1009 620 990 q 698 1028 665 1028 q 755 1006 734 1028 q 777 948 777 985 q 755 890 777 911 q 698 869 732 869 q 642 888 665 869 q 620 948 620 908 "},"ậ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 292 -177 q 316 -112 292 -135 q 383 -89 339 -89 q 449 -112 426 -89 q 471 -177 471 -135 q 448 -241 471 -217 q 383 -265 425 -265 q 316 -241 339 -265 q 292 -177 292 -218 m 552 842 q 397 963 468 891 q 245 842 327 894 l 137 842 l 137 858 q 310 1064 267 992 l 486 1064 q 660 858 529 989 l 660 842 l 552 842 "},"[":{"x_min":104.34375,"x_max":423.453125,"ha":458,"o":"m 423 -220 l 104 -220 l 104 992 l 423 992 l 423 872 l 250 872 l 250 -99 l 423 -99 l 423 -220 "},"Ử":{"x_min":122.125,"x_max":1183.953125,"ha":1148,"o":"m 908 992 l 908 860 q 986 919 961 872 q 1011 1056 1011 966 l 1174 1056 l 1183 1041 q 1132 890 1165 944 q 1044 803 1099 837 q 908 756 989 769 l 908 349 q 805 82 908 179 q 515 -14 702 -14 q 225 83 328 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 355 q 519 124 284 124 q 746 356 746 124 l 746 992 l 908 992 m 680 1240 q 569 1114 680 1140 l 562 1051 l 468 1051 l 455 1160 q 531 1185 506 1169 q 555 1231 555 1202 q 481 1281 555 1281 q 403 1271 441 1281 l 403 1363 q 498 1375 449 1375 q 634 1341 587 1375 q 680 1240 680 1307 "},"%":{"x_min":56.96875,"x_max":1140.03125,"ha":1197,"o":"m 189 694 q 208 543 189 593 q 273 494 228 494 q 362 694 362 494 q 273 894 362 894 q 208 845 228 894 q 189 694 189 795 m 494 695 q 438 461 494 539 q 273 383 382 383 q 113 464 170 383 q 56 695 56 545 q 273 1006 56 1006 q 437 925 379 1006 q 494 695 494 845 m 834 298 q 854 146 834 197 q 919 96 874 96 q 1008 298 1008 96 q 919 497 1008 497 q 854 448 874 497 q 834 298 834 399 m 1140 298 q 1083 64 1140 142 q 919 -14 1027 -14 q 759 66 816 -14 q 702 298 702 147 q 919 609 702 609 q 1082 528 1024 609 q 1140 298 1140 448 m 938 992 l 388 0 l 257 0 l 807 992 l 938 992 "},"P":{"x_min":130.96875,"x_max":787.828125,"ha":855,"o":"m 787 692 q 686 454 787 537 q 396 371 584 371 l 293 371 l 293 0 l 130 0 l 130 992 l 416 992 q 695 916 602 992 q 787 692 787 840 m 293 508 l 379 508 q 562 551 504 508 q 620 686 620 594 q 568 814 620 772 q 405 856 516 856 l 293 856 l 293 508 "},"_":{"x_min":-2.71875,"x_max":598.71875,"ha":596,"o":"m 598 -216 l -2 -216 l -2 -125 l 598 -125 l 598 -216 "},"Ŕ":{"x_min":130.921875,"x_max":875.109375,"ha":888,"o":"m 293 531 l 405 531 q 569 573 518 531 q 620 697 620 615 q 565 818 620 781 q 400 855 510 855 l 293 855 l 293 531 m 293 396 l 293 0 l 130 0 l 130 992 l 411 992 q 695 920 603 992 q 787 703 787 848 q 594 439 787 518 l 875 0 l 690 0 l 453 396 l 293 396 m 335 1071 l 335 1087 q 415 1193 374 1135 q 479 1293 456 1251 l 665 1293 l 665 1278 q 559 1172 629 1237 q 441 1071 489 1106 l 335 1071 "},"ñ":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 574 367 633 q 273 373 273 514 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 365 734 303 705 q 504 764 428 764 q 774 489 774 764 l 774 0 m 548 841 q 492 853 519 841 q 438 879 464 865 q 386 906 411 894 q 338 918 361 918 q 264 840 283 918 l 182 840 q 234 984 190 934 q 348 1034 278 1034 q 405 1021 377 1034 q 459 995 432 1009 q 510 968 485 980 q 558 956 535 956 q 630 1035 611 956 l 715 1035 q 662 892 706 943 q 548 841 618 841 "},"‚":{"x_min":42.6875,"x_max":279.328125,"ha":372,"o":"m 279 145 q 159 -179 246 19 l 42 -179 q 112 161 89 3 l 269 161 l 279 145 "},"Æ":{"x_min":-1.359375,"x_max":1184.9375,"ha":1267,"o":"m 1184 0 l 634 0 l 634 275 l 293 275 l 165 0 l -1 0 l 458 992 l 1184 992 l 1184 855 l 797 855 l 797 585 l 1158 585 l 1158 449 l 797 449 l 797 137 l 1184 137 l 1184 0 m 354 415 l 634 415 l 634 850 l 551 850 l 354 415 "},"ğ":{"x_min":15.609375,"x_max":747.890625,"ha":773,"o":"m 747 750 l 747 662 l 619 638 q 648 580 637 615 q 660 507 660 545 q 580 324 660 391 q 359 258 500 258 q 294 263 323 258 q 242 189 242 231 q 266 150 242 163 q 355 138 291 138 l 486 138 q 675 85 610 138 q 739 -67 739 32 q 634 -264 739 -195 q 330 -334 529 -334 q 96 -279 177 -334 q 15 -124 15 -225 q 59 -8 15 -55 q 181 57 103 38 q 129 100 149 70 q 108 164 108 131 q 132 235 108 206 q 202 292 156 264 q 108 374 144 317 q 71 507 71 431 q 148 696 71 629 q 368 764 226 764 q 435 759 400 764 q 487 750 470 754 l 747 750 m 158 -116 q 204 -196 158 -168 q 335 -224 251 -224 q 529 -186 465 -224 q 593 -87 593 -149 q 558 -17 593 -38 q 428 3 523 3 l 307 3 q 198 -29 238 3 q 158 -116 158 -61 m 226 507 q 262 398 226 436 q 367 360 299 360 q 505 508 505 360 q 471 621 505 582 q 367 661 437 661 q 262 622 297 661 q 226 507 226 582 m 383 842 q 216 896 277 842 q 149 1048 154 950 l 242 1048 q 260 995 245 1015 q 302 968 275 976 q 386 960 330 960 q 492 982 457 960 q 531 1048 526 1005 l 625 1048 q 552 897 617 952 q 383 842 487 842 "},"Ở":{"x_min":82.09375,"x_max":1149.265625,"ha":1114,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 897 865 776 1007 q 956 926 937 880 q 975 1055 975 971 l 1139 1055 l 1149 1040 q 1081 863 1127 926 q 957 770 1034 800 q 1010 496 1010 652 m 254 496 q 328 217 254 311 q 547 124 402 124 q 838 496 838 124 q 548 867 838 867 q 328 774 402 867 q 254 496 254 681 m 718 1240 q 607 1114 718 1140 l 600 1051 l 506 1051 l 493 1160 q 569 1185 544 1169 q 593 1231 593 1202 q 519 1281 593 1281 q 441 1271 479 1281 l 441 1363 q 536 1375 487 1375 q 672 1341 625 1375 q 718 1240 718 1307 "},"Ū":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 299 1189 l 732 1189 l 732 1071 l 299 1071 l 299 1189 "},"ª":{"x_min":38.625,"x_max":446.609375,"ha":511,"o":"m 370 530 l 350 595 q 279 540 319 558 q 191 522 239 522 q 76 557 115 522 q 38 665 38 593 q 95 773 38 735 q 266 815 152 811 l 338 818 q 315 891 338 866 q 245 915 292 915 q 103 877 184 915 l 66 955 q 259 1003 164 1003 q 399 960 353 1003 q 446 833 446 918 l 446 530 l 370 530 m 271 744 q 186 721 223 743 q 149 666 149 699 q 214 606 149 606 q 307 634 276 606 q 338 718 338 662 l 338 747 l 271 744 "},"Œ":{"x_min":82.0625,"x_max":1233.578125,"ha":1317,"o":"m 1233 0 l 677 0 q 534 -14 608 -14 q 199 119 317 -14 q 82 498 82 252 q 198 874 82 742 q 531 1007 315 1007 q 673 992 609 1007 l 1233 992 l 1233 855 l 842 855 l 842 585 l 1208 585 l 1208 449 l 842 449 l 842 137 l 1233 137 l 1233 0 m 537 867 q 324 773 396 867 q 251 496 251 679 q 323 219 251 314 q 536 124 395 124 q 680 148 623 124 l 680 842 q 537 867 626 867 "},"Ạ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 369 -177 q 393 -112 369 -135 q 460 -89 416 -89 q 526 -112 503 -89 q 548 -177 548 -135 q 525 -241 548 -217 q 460 -265 502 -265 q 393 -241 416 -265 q 369 -177 369 -218 "},"Ą":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 751 -157 q 811 -218 751 -218 q 881 -206 840 -218 l 881 -304 q 787 -318 835 -318 q 671 -279 711 -318 q 632 -176 632 -241 q 658 -90 632 -132 q 747 0 683 -48 l 848 0 q 776 -81 801 -44 q 751 -157 751 -118 "},"T":{"x_min":19.671875,"x_max":764.984375,"ha":786,"o":"m 473 0 l 311 0 l 311 852 l 19 852 l 19 992 l 764 992 l 764 852 l 473 852 l 473 0 "},"š":{"x_min":66.453125,"x_max":617.6875,"ha":676,"o":"m 617 213 q 537 44 617 103 q 308 -14 457 -14 q 67 31 158 -14 l 67 169 q 313 108 200 108 q 461 197 461 108 q 444 244 461 225 q 391 284 428 263 q 287 330 353 304 q 112 430 157 380 q 66 561 66 480 q 144 710 66 657 q 355 764 221 764 q 605 710 487 764 l 553 590 q 349 640 432 640 q 223 568 223 640 q 256 508 223 533 q 400 441 289 484 q 534 375 492 405 q 597 306 577 345 q 617 213 617 267 m 613 1064 l 613 1045 q 492 915 527 957 q 439 842 457 873 l 263 842 q 90 1045 219 913 l 90 1064 l 198 1064 q 350 940 291 1003 q 505 1064 416 1007 l 613 1064 "},"ỷ":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 530 1011 q 419 885 530 911 l 412 822 l 318 822 l 305 931 q 381 956 356 940 q 405 1002 405 973 q 331 1052 405 1052 q 253 1042 291 1052 l 253 1134 q 348 1146 299 1146 q 484 1112 437 1146 q 530 1011 530 1078 "},"Þ":{"x_min":130.90625,"x_max":792.859375,"ha":860,"o":"m 792 526 q 693 289 792 372 q 406 207 594 207 l 293 207 l 293 0 l 130 0 l 130 992 l 293 992 l 293 827 l 426 827 q 700 751 608 827 q 792 526 792 675 m 293 342 l 383 342 q 568 384 510 342 q 626 522 626 427 q 573 650 626 608 q 404 692 520 692 l 293 692 l 293 342 "},"j":{"x_min":-82.140625,"x_max":283.421875,"ha":387,"o":"m 37 -334 q -82 -317 -34 -334 l -82 -190 q 12 -203 -36 -203 q 113 -87 113 -203 l 113 750 l 273 750 l 273 -98 q 212 -274 273 -214 q 37 -334 151 -334 m 104 949 q 127 1014 104 991 q 194 1038 151 1038 q 260 1014 236 1038 q 283 949 283 991 q 260 885 283 908 q 194 862 236 862 q 127 885 151 862 q 104 949 104 908 "},"1":{"x_min":104.53125,"x_max":529.09375,"ha":793,"o":"m 529 0 l 369 0 l 369 640 q 375 822 369 755 q 336 786 359 806 q 184 661 314 766 l 104 762 l 396 992 l 529 992 l 529 0 "},"›":{"x_min":54.296875,"x_max":411.34375,"ha":467,"o":"m 411 362 l 168 70 l 54 135 l 245 371 l 54 609 l 168 673 l 411 379 l 411 362 "},"<":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 727 150 l 65 441 l 65 523 l 727 855 l 727 722 l 230 489 l 727 283 l 727 150 "},"t":{"x_min":26.453125,"x_max":510.046875,"ha":546,"o":"m 393 114 q 510 133 451 114 l 510 13 q 441 -6 483 1 q 355 -14 400 -14 q 128 224 128 -14 l 128 629 l 26 629 l 26 699 l 136 758 l 190 917 l 288 917 l 288 750 l 502 750 l 502 629 l 288 629 l 288 227 q 317 142 288 169 q 393 114 346 114 "},"¬":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 727 174 l 607 174 l 607 429 l 65 429 l 65 550 l 727 550 l 727 174 "},"ù":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 417 842 q 299 943 371 877 q 195 1049 228 1010 l 195 1064 l 380 1064 q 450 955 406 1016 q 525 858 495 893 l 525 842 l 417 842 "},"ĉ":{"x_min":69.203125,"x_max":656.046875,"ha":688,"o":"m 416 -14 q 157 85 246 -14 q 69 370 69 184 q 161 662 69 560 q 429 764 254 764 q 643 719 548 764 l 595 591 q 428 631 493 631 q 233 372 233 631 q 281 182 233 245 q 424 118 330 118 q 625 171 530 118 l 625 32 q 534 -3 582 7 q 416 -14 485 -14 m 548 842 q 393 963 464 891 q 241 842 323 894 l 133 842 l 133 858 q 306 1064 263 992 l 482 1064 q 656 858 525 989 l 656 842 l 548 842 "},"ï":{"x_min":-17.28125,"x_max":406.609375,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m -17 948 q 5 1009 -17 990 q 60 1028 28 1028 q 118 1006 96 1028 q 139 948 139 985 q 117 890 139 912 q 60 869 95 869 q 5 888 28 869 q -17 948 -17 908 m 249 948 q 271 1009 249 990 q 327 1028 294 1028 q 384 1006 363 1028 q 406 948 406 985 q 384 890 406 911 q 327 869 361 869 q 271 888 294 869 q 249 948 249 908 "},"ī":{"x_min":-21.75,"x_max":411.390625,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m -21 960 l 411 960 l 411 842 l -21 842 l -21 960 "},"Ò":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 548 1071 q 430 1172 502 1106 q 326 1278 359 1239 l 326 1293 l 511 1293 q 581 1184 537 1245 q 656 1087 626 1122 l 656 1071 l 548 1071 "},"ầ":{"x_min":-0.15625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 172 858 q 274 980 248 947 q 319 1042 300 1014 l 486 1042 q 631 858 545 955 l 631 842 l 545 842 q 402 954 480 886 q 259 842 330 889 l 172 842 l 172 858 m 229 974 l 145 974 q 0 1113 51 1045 l 0 1128 l 140 1128 q 229 990 176 1053 l 229 974 "},"Ď":{"x_min":130.84375,"x_max":936.96875,"ha":1019,"o":"m 936 505 q 800 129 936 259 q 408 0 664 0 l 130 0 l 130 992 l 437 992 q 805 864 673 992 q 936 505 936 736 m 766 500 q 433 856 766 856 l 292 856 l 292 136 l 408 136 q 766 500 766 136 m 741 1293 l 741 1274 q 620 1144 655 1186 q 567 1071 585 1102 l 391 1071 q 218 1274 347 1142 l 218 1293 l 326 1293 q 478 1169 419 1232 q 633 1293 544 1236 l 741 1293 "},"&":{"x_min":65.09375,"x_max":1025.96875,"ha":1028,"o":"m 305 778 q 328 697 305 735 q 391 616 351 659 q 499 697 468 659 q 530 782 530 735 q 500 852 530 826 q 422 879 471 879 q 337 851 368 879 q 305 778 305 824 m 406 123 q 619 196 531 123 l 359 451 q 260 365 287 405 q 233 273 233 324 q 280 164 233 206 q 406 123 327 123 m 65 262 q 108 417 65 351 q 265 548 151 483 q 177 675 200 624 q 153 783 153 727 q 227 946 153 886 q 425 1006 301 1006 q 613 947 545 1006 q 682 791 682 889 q 636 651 682 714 q 483 524 590 588 l 718 298 q 809 511 773 371 l 973 511 q 821 197 926 318 l 1025 0 l 820 0 l 719 98 q 571 14 650 42 q 398 -14 493 -14 q 153 59 242 -14 q 65 262 65 133 "},"Ồ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 317 1087 q 419 1209 393 1176 q 464 1271 445 1243 l 631 1271 q 776 1087 690 1184 l 776 1071 l 690 1071 q 547 1183 625 1115 q 404 1071 475 1118 l 317 1071 l 317 1087 m 374 1203 l 290 1203 q 144 1342 196 1274 l 144 1357 l 285 1357 q 374 1219 321 1282 l 374 1203 "},"˝":{"x_min":130.828125,"x_max":677.171875,"ha":808,"o":"m 130 842 l 130 858 q 256 1064 201 956 l 422 1064 l 422 1049 q 336 949 402 1016 q 218 842 271 882 l 130 842 m 385 842 l 385 858 q 453 958 414 897 q 512 1064 491 1020 l 677 1064 l 677 1049 q 591 949 657 1016 q 473 842 526 882 l 385 842 "},"I":{"x_min":130.9375,"x_max":293.046875,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 "},"G":{"x_min":82.109375,"x_max":901.796875,"ha":1009,"o":"m 536 538 l 901 538 l 901 39 q 729 -1 812 10 q 551 -14 647 -14 q 204 119 326 -14 q 82 495 82 252 q 219 870 82 735 q 599 1006 357 1006 q 893 946 754 1006 l 836 811 q 595 866 715 866 q 343 767 436 866 q 251 494 251 667 q 334 217 251 312 q 574 123 417 123 q 742 142 652 123 l 742 398 l 536 398 l 536 538 "},"`":{"x_min":245.515625,"x_max":575.125,"ha":822,"o":"m 467 842 q 349 943 421 877 q 245 1049 278 1010 l 245 1064 l 430 1064 q 500 955 456 1016 q 575 858 545 893 l 575 842 l 467 842 "},"·":{"x_min":90.234375,"x_max":291.671875,"ha":382,"o":"m 90 490 q 116 566 90 540 q 190 593 141 593 q 265 565 240 593 q 291 490 291 538 q 265 414 291 442 q 190 386 239 386 q 116 413 141 386 q 90 490 90 441 "},"ỗ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 519 1070 q 470 1079 495 1070 q 422 1099 446 1088 q 376 1120 399 1111 q 335 1130 354 1130 q 294 1116 308 1130 q 270 1069 279 1102 l 201 1069 q 242 1182 207 1139 q 332 1226 277 1226 q 383 1216 357 1226 q 432 1195 408 1206 q 477 1173 456 1183 q 517 1164 499 1164 q 558 1178 544 1164 q 582 1227 572 1193 l 650 1227 q 608 1111 643 1153 q 519 1070 573 1070 m 654 842 l 575 842 q 425 949 492 889 q 275 842 363 894 l 195 842 l 195 859 q 349 1036 309 978 l 502 1036 q 654 859 547 970 l 654 842 "},"Ễ":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 506 1299 q 457 1308 482 1299 q 409 1328 433 1317 q 363 1349 386 1340 q 322 1359 341 1359 q 281 1345 295 1359 q 257 1298 266 1331 l 188 1298 q 229 1411 194 1368 q 319 1455 264 1455 q 370 1445 344 1455 q 419 1424 395 1435 q 464 1402 443 1412 q 504 1393 486 1393 q 545 1407 531 1393 q 569 1456 559 1422 l 637 1456 q 595 1340 630 1382 q 506 1299 560 1299 m 641 1071 l 562 1071 q 412 1178 479 1118 q 262 1071 350 1123 l 182 1071 l 182 1088 q 336 1265 296 1207 l 489 1265 q 641 1088 534 1199 l 641 1071 "},"ằ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 449 1018 l 373 1018 q 234 1158 295 1079 l 234 1173 l 368 1173 q 449 1035 401 1100 l 449 1018 m 400 842 q 240 895 297 842 q 176 1045 182 948 l 263 1045 q 400 943 274 943 q 535 1045 523 943 l 622 1045 q 557 893 614 944 q 400 842 501 842 "},"ŏ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 418 842 q 251 896 312 842 q 184 1048 189 950 l 277 1048 q 295 995 280 1015 q 337 968 310 976 q 421 960 365 960 q 527 982 492 960 q 566 1048 561 1005 l 660 1048 q 587 897 652 952 q 418 842 522 842 "},"¿":{"x_min":37.28125,"x_max":622.59375,"ha":629,"o":"m 441 437 l 441 394 q 413 271 441 322 q 316 166 385 220 q 211 66 232 99 q 190 -17 190 33 q 227 -102 190 -70 q 336 -134 263 -134 q 454 -115 397 -134 q 566 -70 511 -96 l 622 -192 q 335 -267 473 -267 q 115 -202 194 -267 q 37 -22 37 -137 q 51 65 37 26 q 94 139 65 103 q 201 235 124 174 q 286 320 265 287 q 307 406 307 352 l 307 437 l 441 437 m 469 654 q 443 577 469 604 q 368 551 418 551 q 293 577 319 551 q 267 654 267 604 q 293 729 267 701 q 368 758 319 758 q 443 730 416 758 q 469 654 469 703 "},"Ả":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 623 1240 q 512 1114 623 1140 l 505 1051 l 411 1051 l 398 1160 q 474 1185 449 1169 q 498 1231 498 1202 q 424 1281 498 1281 q 346 1271 384 1281 l 346 1363 q 441 1375 392 1375 q 577 1341 530 1375 q 623 1240 623 1307 "},"ý":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 271 842 l 271 858 q 351 964 310 906 q 415 1064 392 1022 l 601 1064 l 601 1049 q 495 943 565 1008 q 377 842 425 877 l 271 842 "},"Ứ":{"x_min":122.125,"x_max":1183.953125,"ha":1148,"o":"m 908 992 l 908 860 q 986 919 961 872 q 1011 1056 1011 966 l 1174 1056 l 1183 1041 q 1132 890 1165 944 q 1044 803 1099 837 q 908 756 989 769 l 908 349 q 805 82 908 179 q 515 -14 702 -14 q 225 83 328 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 355 q 519 124 284 124 q 746 356 746 124 l 746 992 l 908 992 m 420 1071 l 420 1087 q 500 1193 459 1135 q 564 1293 541 1251 l 750 1293 l 750 1278 q 644 1172 714 1237 q 526 1071 574 1106 l 420 1071 "},"ſ":{"x_min":114.03125,"x_max":529.109375,"ha":488,"o":"m 379 933 q 273 803 273 933 l 273 0 l 114 0 l 114 807 q 175 999 114 936 q 368 1063 236 1063 q 529 1033 457 1063 l 490 913 q 379 933 427 933 "},"º":{"x_min":41.375,"x_max":487.625,"ha":529,"o":"m 487 762 q 428 586 487 650 q 262 522 368 522 q 101 586 160 522 q 41 762 41 651 q 101 939 41 876 q 265 1003 161 1003 q 427 938 368 1003 q 487 762 487 874 m 151 762 q 177 649 151 686 q 263 612 204 612 q 349 649 323 612 q 376 762 376 686 q 349 875 376 838 q 263 912 323 912 q 177 875 204 912 q 151 762 151 838 "},"ź":{"x_min":46.125,"x_max":615.171875,"ha":664,"o":"m 615 0 l 46 0 l 46 98 l 425 627 l 69 627 l 69 750 l 604 750 l 604 638 l 233 122 l 615 122 l 615 0 m 244 842 l 244 858 q 324 964 283 906 q 388 1064 365 1022 l 574 1064 l 574 1049 q 468 943 538 1008 q 350 842 398 877 l 244 842 "},"ű":{"x_min":107.203125,"x_max":775.171875,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 228 842 l 228 858 q 354 1064 299 956 l 520 1064 l 520 1049 q 434 949 500 1016 q 316 842 369 882 l 228 842 m 483 842 l 483 858 q 551 958 512 897 q 610 1064 589 1020 l 775 1064 l 775 1049 q 689 949 755 1016 q 571 842 624 882 l 483 842 "},"ń":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 574 367 633 q 273 373 273 514 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 365 734 303 705 q 504 764 428 764 q 774 489 774 764 l 774 0 m 343 842 l 343 858 q 423 964 382 906 q 487 1064 464 1022 l 673 1064 l 673 1049 q 567 943 637 1008 q 449 842 497 877 l 343 842 "},";":{"x_min":42.734375,"x_max":290.3125,"ha":386,"o":"m 269 161 l 279 145 q 160 -179 246 19 l 42 -179 q 112 161 89 3 l 269 161 m 88 663 q 189 766 88 766 q 265 738 240 766 q 290 663 290 711 q 264 587 290 615 q 189 559 238 559 q 114 586 140 559 q 88 663 88 614 "}," ":{"x_min":0,"x_max":0,"ha":347},"Ġ":{"x_min":82.109375,"x_max":901.796875,"ha":1009,"o":"m 536 538 l 901 538 l 901 39 q 729 -1 812 10 q 551 -14 647 -14 q 204 119 326 -14 q 82 495 82 252 q 219 870 82 735 q 599 1006 357 1006 q 893 946 754 1006 l 836 811 q 595 866 715 866 q 343 767 436 866 q 251 494 251 667 q 334 217 251 312 q 574 123 417 123 q 742 142 652 123 l 742 398 l 536 398 l 536 538 m 483 1177 q 506 1242 483 1219 q 573 1266 530 1266 q 639 1242 615 1266 q 662 1177 662 1219 q 639 1113 662 1136 q 573 1090 615 1090 q 506 1113 530 1090 q 483 1177 483 1136 "},"6":{"x_min":63.765625,"x_max":737.375,"ha":793,"o":"m 63 422 q 537 1004 63 1004 q 664 992 612 1004 l 664 859 q 544 874 612 874 q 305 788 385 874 q 218 514 225 703 l 226 514 q 316 599 258 569 q 451 630 373 630 q 662 547 586 630 q 737 322 737 464 q 650 76 737 167 q 412 -14 563 -14 q 227 37 305 -14 q 106 186 148 88 q 63 422 63 284 m 409 117 q 536 170 491 117 q 580 321 580 223 q 538 455 580 406 q 413 504 497 504 q 318 482 362 504 q 250 422 275 460 q 225 343 225 383 q 277 182 225 248 q 409 117 329 117 "},"n":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 574 367 633 q 273 373 273 514 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 365 734 303 705 q 504 764 428 764 q 774 489 774 764 l 774 0 "},"﻿":{"x_min":0,"x_max":0,"ha":0},"ụ":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 340 -177 q 364 -112 340 -135 q 431 -89 387 -89 q 497 -112 474 -89 q 519 -177 519 -135 q 496 -241 519 -217 q 431 -265 473 -265 q 364 -241 387 -265 q 340 -177 340 -218 "},"ģ":{"x_min":15.609375,"x_max":747.890625,"ha":773,"o":"m 747 750 l 747 662 l 619 638 q 648 580 637 615 q 660 507 660 545 q 580 324 660 391 q 359 258 500 258 q 294 263 323 258 q 242 189 242 231 q 266 150 242 163 q 355 138 291 138 l 486 138 q 675 85 610 138 q 739 -67 739 32 q 634 -264 739 -195 q 330 -334 529 -334 q 96 -279 177 -334 q 15 -124 15 -225 q 59 -8 15 -55 q 181 57 103 38 q 129 100 149 70 q 108 164 108 131 q 132 235 108 206 q 202 292 156 264 q 108 374 144 317 q 71 507 71 431 q 148 696 71 629 q 368 764 226 764 q 435 759 400 764 q 487 750 470 754 l 747 750 m 158 -116 q 204 -196 158 -168 q 335 -224 251 -224 q 529 -186 465 -224 q 593 -87 593 -149 q 558 -17 593 -38 q 428 3 523 3 l 307 3 q 198 -29 238 3 q 158 -116 158 -61 m 226 507 q 262 398 226 436 q 367 360 299 360 q 505 508 505 360 q 471 621 505 582 q 367 661 437 661 q 262 622 297 661 q 226 507 226 582 m 498 1045 q 470 949 486 1009 q 449 842 455 890 l 296 842 l 296 854 q 346 965 315 906 q 407 1064 378 1024 l 498 1064 l 498 1045 "},"Ẵ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 556 1306 q 507 1315 532 1306 q 459 1335 483 1324 q 413 1356 436 1346 q 372 1365 391 1365 q 331 1352 345 1365 q 307 1305 316 1338 l 238 1305 q 278 1412 244 1371 q 369 1453 312 1453 q 420 1443 394 1453 q 469 1422 445 1434 q 514 1401 493 1411 q 554 1392 536 1392 q 595 1406 581 1392 q 619 1454 609 1421 l 687 1454 q 646 1344 680 1383 q 556 1306 611 1306 m 457 1071 q 296 1121 353 1071 q 233 1260 238 1171 l 320 1260 q 356 1193 325 1214 q 457 1172 388 1172 q 555 1193 524 1172 q 592 1260 586 1214 l 679 1260 q 614 1118 671 1166 q 457 1071 557 1071 "},"¤":{"x_min":79.390625,"x_max":712.9375,"ha":793,"o":"m 126 490 q 169 634 126 564 l 79 725 l 161 805 l 250 718 q 396 761 318 761 q 540 716 474 761 l 630 805 l 712 726 l 624 636 q 666 490 666 568 q 624 343 666 409 l 711 255 l 630 174 l 540 262 q 396 221 473 221 q 250 262 310 221 l 161 176 l 80 256 l 169 344 q 126 490 126 411 m 240 490 q 286 378 240 423 q 396 333 332 333 q 508 378 461 333 q 554 490 554 423 q 508 602 554 556 q 396 648 461 648 q 286 602 333 648 q 240 490 240 556 "},"Ĝ":{"x_min":82.109375,"x_max":901.796875,"ha":1009,"o":"m 536 538 l 901 538 l 901 39 q 729 -1 812 10 q 551 -14 647 -14 q 204 119 326 -14 q 82 495 82 252 q 219 870 82 735 q 599 1006 357 1006 q 893 946 754 1006 l 836 811 q 595 866 715 866 q 343 767 436 866 q 251 494 251 667 q 334 217 251 312 q 574 123 417 123 q 742 142 652 123 l 742 398 l 536 398 l 536 538 m 710 1071 q 555 1192 626 1120 q 403 1071 485 1123 l 295 1071 l 295 1087 q 468 1293 425 1221 l 644 1293 q 818 1087 687 1218 l 818 1071 l 710 1071 "},"p":{"x_min":113.890625,"x_max":793.828125,"ha":865,"o":"m 494 -14 q 273 88 351 -14 l 263 88 q 273 -26 273 -6 l 273 -334 l 113 -334 l 113 750 l 242 750 q 265 649 248 729 l 273 649 q 496 764 347 764 q 715 662 637 764 q 793 376 793 560 q 714 89 793 192 q 494 -14 634 -14 m 455 633 q 316 578 360 633 q 273 400 273 522 l 273 376 q 316 177 273 239 q 458 116 360 116 q 585 184 540 116 q 630 377 630 252 q 585 568 630 504 q 455 633 541 633 "},"‡":{"x_min":83.46875,"x_max":636.53125,"ha":720,"o":"m 404 354 l 636 375 l 636 236 l 404 255 l 438 0 l 278 0 l 312 255 l 83 236 l 83 375 l 312 354 l 282 532 l 312 700 l 83 680 l 83 819 l 312 798 l 278 1055 l 438 1055 l 404 798 l 636 819 l 636 680 l 404 700 l 434 532 l 404 354 "},"ň":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 574 367 633 q 273 373 273 514 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 365 734 303 705 q 504 764 428 764 q 774 489 774 764 l 774 0 m 712 1064 l 712 1045 q 591 915 626 957 q 538 842 556 873 l 362 842 q 189 1045 318 913 l 189 1064 l 297 1064 q 449 940 390 1003 q 604 1064 515 1007 l 712 1064 "},"ę":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 537 -140 q 597 -201 537 -201 q 667 -189 626 -201 l 667 -287 q 573 -301 621 -301 q 457 -262 497 -301 q 418 -159 418 -224 q 444 -73 418 -115 q 533 17 469 -31 l 634 17 q 562 -64 587 -27 q 537 -140 537 -101 "},"ố":{"x_min":69.140625,"x_max":823.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 650 842 l 564 842 q 421 954 488 892 q 277 842 343 886 l 190 842 l 190 858 q 337 1042 296 981 l 504 1042 q 650 858 564 955 l 650 842 m 593 990 q 683 1128 649 1057 l 823 1128 l 823 1113 q 678 974 777 1051 l 593 974 l 593 990 "},"Ặ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 455 1077 q 288 1131 349 1077 q 221 1283 226 1185 l 314 1283 q 332 1230 317 1250 q 374 1203 347 1211 q 458 1195 402 1195 q 564 1217 529 1195 q 603 1283 598 1240 l 697 1283 q 624 1132 689 1187 q 455 1077 559 1077 m 369 -177 q 393 -112 369 -135 q 460 -89 416 -89 q 526 -112 503 -89 q 548 -177 548 -135 q 525 -241 548 -217 q 460 -265 502 -265 q 393 -241 416 -265 q 369 -177 369 -218 "},"S":{"x_min":67.84375,"x_max":702.9375,"ha":764,"o":"m 702 269 q 607 61 702 136 q 343 -14 511 -14 q 67 38 175 -14 l 67 191 q 212 141 135 159 q 354 123 288 123 q 496 159 450 123 q 542 258 542 196 q 500 352 542 313 q 326 444 458 391 q 135 569 190 499 q 79 739 79 640 q 167 934 79 863 q 404 1006 255 1006 q 688 943 546 1006 l 636 811 q 400 866 504 866 q 280 832 321 866 q 240 742 240 798 q 256 675 240 703 q 310 623 272 648 q 444 559 347 599 q 604 474 553 513 q 679 385 655 435 q 702 269 702 336 "},"ễ":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 503 1070 q 454 1079 479 1070 q 406 1099 430 1088 q 360 1120 383 1111 q 319 1130 338 1130 q 278 1116 292 1130 q 254 1069 263 1102 l 185 1069 q 226 1182 191 1139 q 316 1226 261 1226 q 367 1216 341 1226 q 416 1195 392 1206 q 461 1173 440 1183 q 501 1164 483 1164 q 542 1178 528 1164 q 566 1227 556 1193 l 634 1227 q 592 1111 627 1153 q 503 1070 557 1070 m 638 842 l 559 842 q 409 949 476 889 q 259 842 347 894 l 179 842 l 179 859 q 333 1036 293 978 l 486 1036 q 638 859 531 970 l 638 842 "},"/":{"x_min":10.859375,"x_max":530.46875,"ha":542,"o":"m 530 992 l 161 0 l 10 0 l 380 992 l 530 992 "},"į":{"x_min":32.578125,"x_max":283.421875,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 104 949 q 127 1014 104 991 q 194 1038 151 1038 q 260 1014 236 1038 q 283 949 283 991 q 260 885 283 908 q 194 862 236 862 q 127 885 151 862 q 104 949 104 908 m 151 -157 q 211 -218 151 -218 q 281 -206 240 -218 l 281 -304 q 187 -318 235 -318 q 71 -279 111 -318 q 32 -176 32 -241 q 58 -90 32 -132 q 147 0 83 -48 l 248 0 q 176 -81 201 -44 q 151 -157 151 -118 "},"Ế":{"x_min":130.859375,"x_max":814.859375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 641 1071 l 555 1071 q 412 1183 479 1121 q 268 1071 334 1115 l 181 1071 l 181 1087 q 328 1271 287 1210 l 495 1271 q 641 1087 555 1184 l 641 1071 m 584 1219 q 674 1357 640 1286 l 814 1357 l 814 1342 q 669 1203 768 1280 l 584 1203 l 584 1219 "},"Ọ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 456 -177 q 480 -112 456 -135 q 547 -89 503 -89 q 613 -112 590 -89 q 635 -177 635 -135 q 612 -241 635 -217 q 547 -265 589 -265 q 480 -241 503 -265 q 456 -177 456 -218 "},"ắ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 344 1035 q 427 1173 394 1103 l 560 1173 l 560 1158 q 421 1018 499 1079 l 344 1018 l 344 1035 m 398 842 q 239 893 296 842 q 177 1045 182 945 l 263 1045 q 299 968 268 993 q 399 943 331 943 q 494 969 458 943 q 535 1045 529 994 l 623 1045 q 556 895 616 948 q 398 842 497 842 "},"Ŧ":{"x_min":19.671875,"x_max":764.984375,"ha":786,"o":"m 473 0 l 311 0 l 311 431 l 120 431 l 120 564 l 311 564 l 311 852 l 19 852 l 19 992 l 764 992 l 764 852 l 473 852 l 473 564 l 662 564 l 662 431 l 473 431 l 473 0 "},"y":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 "},"‗":{"x_min":-2.71875,"x_max":573.71875,"ha":571,"o":"m 573 -315 l -2 -315 l -2 -220 l 573 -220 l 573 -315 m 573 -125 l -2 -125 l -2 -31 l 573 -31 l 573 -125 "},"g":{"x_min":15.609375,"x_max":747.890625,"ha":773,"o":"m 747 750 l 747 662 l 619 638 q 648 580 637 615 q 660 507 660 545 q 580 324 660 391 q 359 258 500 258 q 294 263 323 258 q 242 189 242 231 q 266 150 242 163 q 355 138 291 138 l 486 138 q 675 85 610 138 q 739 -67 739 32 q 634 -264 739 -195 q 330 -334 529 -334 q 96 -279 177 -334 q 15 -124 15 -225 q 59 -8 15 -55 q 181 57 103 38 q 129 100 149 70 q 108 164 108 131 q 132 235 108 206 q 202 292 156 264 q 108 374 144 317 q 71 507 71 431 q 148 696 71 629 q 368 764 226 764 q 435 759 400 764 q 487 750 470 754 l 747 750 m 158 -116 q 204 -196 158 -168 q 335 -224 251 -224 q 529 -186 465 -224 q 593 -87 593 -149 q 558 -17 593 -38 q 428 3 523 3 l 307 3 q 198 -29 238 3 q 158 -116 158 -61 m 226 507 q 262 398 226 436 q 367 360 299 360 q 505 508 505 360 q 471 621 505 582 q 367 661 437 661 q 262 622 297 661 q 226 507 226 582 "},"ĸ":{"x_min":113.921875,"x_max":785.9375,"ha":790,"o":"m 270 377 l 587 750 l 768 750 l 478 412 l 785 0 l 600 0 l 372 315 l 278 245 l 278 0 l 113 0 l 113 750 l 278 750 l 278 554 q 270 377 278 467 "},"́":{"x_min":-533.484375,"x_max":-203.875,"ha":0,"o":"m -533 842 l -533 858 q -453 964 -494 906 q -389 1064 -412 1022 l -203 1064 l -203 1049 q -309 943 -239 1008 q -427 842 -379 877 l -533 842 "},"²":{"x_min":34.59375,"x_max":459.90625,"ha":504,"o":"m 459 397 l 34 397 l 34 488 l 190 641 q 292 753 269 717 q 314 829 314 789 q 292 882 314 864 q 236 900 270 900 q 99 841 172 900 l 35 923 q 245 1004 130 1004 q 389 959 337 1004 q 440 837 440 914 q 409 729 440 780 q 284 592 377 678 l 190 504 l 459 504 l 459 397 "},"–":{"x_min":55.65625,"x_max":639.34375,"ha":695,"o":"m 55 308 l 55 437 l 639 437 l 639 308 l 55 308 "},"ë":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 208 948 q 231 1009 208 990 q 286 1028 254 1028 q 344 1006 322 1028 q 365 948 365 985 q 343 890 365 912 q 286 869 321 869 q 231 888 254 869 q 208 948 208 908 m 475 948 q 497 1009 475 990 q 553 1028 520 1028 q 610 1006 589 1028 q 632 948 632 985 q 610 890 632 911 q 553 869 587 869 q 497 888 520 869 q 475 948 475 908 "},"J":{"x_min":-105.828125,"x_max":288.890625,"ha":415,"o":"m 5 -277 q -105 -260 -61 -277 l -105 -123 q -6 -137 -48 -137 q 126 30 126 -137 l 126 992 l 288 992 l 288 35 q 216 -196 288 -116 q 5 -277 144 -277 "},"Ã":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 557 1070 q 501 1082 528 1070 q 447 1108 473 1094 q 395 1135 420 1123 q 347 1147 370 1147 q 273 1069 292 1147 l 191 1069 q 243 1213 199 1163 q 357 1263 287 1263 q 414 1250 386 1263 q 468 1224 441 1238 q 519 1197 494 1209 q 567 1185 544 1185 q 639 1264 620 1185 l 724 1264 q 671 1121 715 1172 q 557 1070 627 1070 "},"ŷ":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 529 842 q 374 963 445 891 q 222 842 304 894 l 114 842 l 114 858 q 287 1064 244 992 l 463 1064 q 637 858 506 989 l 637 842 l 529 842 "},"ŕ":{"x_min":113.96875,"x_max":573.90625,"ha":599,"o":"m 494 764 q 573 757 542 764 l 558 608 q 487 616 524 616 q 332 554 392 616 q 273 392 273 491 l 273 0 l 113 0 l 113 750 l 238 750 l 259 618 l 267 618 q 365 724 305 685 q 494 764 425 764 m 236 842 l 236 858 q 316 964 275 906 q 380 1064 357 1022 l 566 1064 l 566 1049 q 460 943 530 1008 q 342 842 390 877 l 236 842 "},"©":{"x_min":67.84375,"x_max":1088.15625,"ha":1156,"o":"m 605 701 q 489 647 530 701 q 449 495 449 592 q 485 341 449 395 q 605 288 522 288 q 685 298 643 288 q 759 322 728 308 l 759 215 q 600 181 681 181 q 393 262 466 181 q 319 495 319 344 q 394 725 319 641 q 601 809 468 809 q 787 761 695 809 l 743 664 q 605 701 671 701 m 67 495 q 135 750 67 631 q 322 937 203 868 q 578 1006 440 1006 q 832 938 713 1006 q 1019 751 951 870 q 1088 495 1088 632 q 1022 244 1088 361 q 837 56 956 127 q 578 -14 719 -14 q 318 56 437 -14 q 133 243 200 126 q 67 495 67 361 m 151 495 q 208 281 151 380 q 364 125 265 182 q 578 68 464 68 q 792 126 693 68 q 948 282 891 184 q 1004 495 1004 380 q 947 709 1004 609 q 790 865 890 808 q 578 922 691 922 q 365 866 464 922 q 209 710 267 809 q 151 495 151 611 "},"˘":{"x_min":176.296875,"x_max":652.984375,"ha":832,"o":"m 410 842 q 243 896 304 842 q 176 1048 181 950 l 269 1048 q 287 995 272 1015 q 329 968 302 976 q 413 960 357 960 q 519 982 484 960 q 558 1048 553 1005 l 652 1048 q 579 897 644 952 q 410 842 514 842 "},"Ă":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 453 1071 q 286 1125 347 1071 q 219 1277 224 1179 l 312 1277 q 330 1224 315 1244 q 372 1197 345 1205 q 456 1189 400 1189 q 562 1211 527 1189 q 601 1277 596 1234 l 695 1277 q 622 1126 687 1181 q 453 1071 557 1071 "},"D":{"x_min":130.84375,"x_max":936.96875,"ha":1019,"o":"m 936 505 q 800 129 936 259 q 408 0 664 0 l 130 0 l 130 992 l 437 992 q 805 864 673 992 q 936 505 936 736 m 766 500 q 433 856 766 856 l 292 856 l 292 136 l 408 136 q 766 500 766 136 "},"ł":{"x_min":-1.359375,"x_max":415.4375,"ha":410,"o":"m 282 608 l 351 655 l 415 550 l 282 464 l 282 0 l 122 0 l 122 364 l 59 325 l -1 429 l 122 509 l 122 1055 l 282 1055 l 282 608 "},"ÿ":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 161 948 q 184 1009 161 990 q 239 1028 207 1028 q 297 1006 275 1028 q 318 948 318 985 q 296 890 318 912 q 239 869 274 869 q 184 888 207 869 q 161 948 161 908 m 428 948 q 450 1009 428 990 q 506 1028 473 1028 q 563 1006 542 1028 q 585 948 585 985 q 563 890 585 911 q 506 869 540 869 q 450 888 473 869 q 428 948 428 908 "},"ĺ":{"x_min":113.859375,"x_max":445.125,"ha":387,"o":"m 273 0 l 113 0 l 113 1055 l 273 1055 l 273 0 m 115 1110 l 115 1126 q 195 1232 154 1174 q 259 1332 236 1290 l 445 1332 l 445 1317 q 339 1211 409 1276 q 221 1110 269 1145 l 115 1110 "},"Ł":{"x_min":9.5,"x_max":713.25,"ha":756,"o":"m 130 0 l 130 338 l 70 304 l 9 409 l 130 481 l 130 992 l 293 992 l 293 579 l 441 668 l 504 560 l 293 435 l 293 139 l 713 139 l 713 0 l 130 0 "}," ":{"x_min":0,"x_max":0,"ha":382},"$":{"x_min":75.296875,"x_max":721.09375,"ha":793,"o":"m 721 306 q 649 144 721 208 q 441 66 577 81 l 441 -81 l 351 -81 l 351 62 q 75 113 183 64 l 75 256 q 211 208 133 228 q 351 188 289 189 l 351 442 l 294 463 q 131 565 183 506 q 80 712 80 625 q 153 866 80 806 q 351 939 226 927 l 351 1054 l 441 1054 l 441 942 q 702 886 579 937 l 653 762 q 441 812 546 804 l 441 565 l 493 545 q 671 441 622 496 q 721 306 721 386 m 561 296 q 533 361 561 336 q 441 410 506 387 l 441 194 q 561 296 561 212 m 240 714 q 264 649 240 675 q 351 598 288 623 l 351 809 q 268 776 297 801 q 240 714 240 751 "},"w":{"x_min":13.5625,"x_max":1120.078125,"ha":1135,"o":"m 729 0 l 632 349 q 568 608 614 405 l 562 608 q 499 348 523 425 l 400 0 l 223 0 l 13 750 l 176 750 l 272 380 q 318 145 304 243 l 322 145 q 342 259 329 195 q 367 355 356 323 l 481 750 l 656 750 l 766 355 q 792 253 776 322 q 810 147 807 185 l 815 147 q 862 380 825 230 l 960 750 l 1120 750 l 908 0 l 729 0 "},"\\":{"x_min":10.859375,"x_max":530.46875,"ha":542,"o":"m 161 992 l 530 0 l 380 0 l 10 992 l 161 992 "},"Ì":{"x_min":-4.484375,"x_max":325.125,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 217 1071 q 99 1172 171 1106 q -4 1278 28 1239 l -4 1293 l 180 1293 q 250 1184 206 1245 q 325 1087 295 1122 l 325 1071 l 217 1071 "},"Ç":{"x_min":82.03125,"x_max":834.578125,"ha":880,"o":"m 552 866 q 332 767 412 866 q 252 494 252 668 q 329 218 252 311 q 552 124 406 124 q 674 136 615 124 q 797 169 733 149 l 797 30 q 532 -14 680 -14 q 198 117 315 -14 q 82 495 82 249 q 138 766 82 650 q 302 944 195 882 q 553 1006 409 1006 q 834 942 705 1006 l 776 807 q 670 849 726 831 q 552 866 614 866 m 646 -183 q 439 -334 646 -334 q 357 -323 394 -334 l 357 -230 q 440 -240 393 -240 q 498 -229 477 -240 q 520 -187 520 -218 q 398 -112 520 -129 l 455 0 l 558 0 l 530 -60 q 615 -106 585 -74 q 646 -183 646 -138 "},"Ŝ":{"x_min":67.84375,"x_max":702.9375,"ha":764,"o":"m 702 269 q 607 61 702 136 q 343 -14 511 -14 q 67 38 175 -14 l 67 191 q 212 141 135 159 q 354 123 288 123 q 496 159 450 123 q 542 258 542 196 q 500 352 542 313 q 326 444 458 391 q 135 569 190 499 q 79 739 79 640 q 167 934 79 863 q 404 1006 255 1006 q 688 943 546 1006 l 636 811 q 400 866 504 866 q 280 832 321 866 q 240 742 240 798 q 256 675 240 703 q 310 623 272 648 q 444 559 347 599 q 604 474 553 513 q 679 385 655 435 q 702 269 702 336 m 553 1071 q 398 1192 469 1120 q 246 1071 328 1123 l 138 1071 l 138 1087 q 311 1293 268 1221 l 487 1293 q 661 1087 530 1218 l 661 1071 l 553 1071 "},"C":{"x_min":82.03125,"x_max":834.578125,"ha":880,"o":"m 552 866 q 332 767 412 866 q 252 494 252 668 q 329 218 252 311 q 552 124 406 124 q 674 136 615 124 q 797 169 733 149 l 797 30 q 532 -14 680 -14 q 198 117 315 -14 q 82 495 82 249 q 138 766 82 650 q 302 944 195 882 q 553 1006 409 1006 q 834 942 705 1006 l 776 807 q 670 849 726 831 q 552 866 614 866 "},"Ḁ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 623 -237 q 577 -349 623 -307 q 459 -392 531 -392 q 343 -350 387 -392 q 300 -238 300 -309 q 343 -126 300 -168 q 459 -85 387 -85 q 577 -128 532 -85 q 623 -237 623 -171 m 531 -238 q 510 -185 531 -204 q 459 -167 490 -167 q 406 -185 427 -167 q 386 -238 386 -204 q 404 -291 386 -272 q 459 -311 423 -311 q 511 -291 491 -311 q 531 -238 531 -272 "},"̉":{"x_min":-531.734375,"x_max":-254.328125,"ha":0,"o":"m -254 1011 q -365 885 -254 911 l -372 822 l -466 822 l -479 931 q -403 956 -428 940 q -379 1002 -379 973 q -453 1052 -379 1052 q -531 1042 -493 1052 l -531 1134 q -436 1146 -485 1146 q -300 1112 -347 1146 q -254 1011 -254 1078 "},"Ē":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 200 1189 l 633 1189 l 633 1071 l 200 1071 l 200 1189 "},"!":{"x_min":90.15625,"x_max":291.59375,"ha":383,"o":"m 251 301 l 133 301 l 98 992 l 286 992 l 251 301 m 90 84 q 116 160 90 134 q 191 186 143 186 q 265 159 240 186 q 291 84 291 132 q 265 8 291 36 q 191 -20 239 -20 q 116 7 143 -20 q 90 84 90 34 "},"ç":{"x_min":69.203125,"x_max":643.21875,"ha":688,"o":"m 416 -14 q 157 85 246 -14 q 69 370 69 184 q 161 662 69 560 q 429 764 254 764 q 643 719 548 764 l 595 591 q 428 631 493 631 q 233 372 233 631 q 281 182 233 245 q 424 118 330 118 q 625 171 530 118 l 625 32 q 534 -3 582 7 q 416 -14 485 -14 m 530 -183 q 323 -334 530 -334 q 241 -323 278 -334 l 241 -230 q 324 -240 277 -240 q 382 -229 361 -240 q 404 -187 404 -218 q 282 -112 404 -129 l 339 0 l 442 0 l 414 -60 q 499 -106 469 -74 q 530 -183 530 -138 "},"Ĵ":{"x_min":-105.828125,"x_max":471.046875,"ha":415,"o":"m 5 -277 q -105 -260 -61 -277 l -105 -123 q -6 -137 -48 -137 q 126 30 126 -137 l 126 992 l 288 992 l 288 35 q 216 -196 288 -116 q 5 -277 144 -277 m 363 1071 q 208 1192 279 1120 q 56 1071 138 1123 l -51 1071 l -51 1087 q 121 1293 78 1221 l 297 1293 q 471 1087 340 1218 l 471 1071 l 363 1071 "},"Ẻ":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 577 1240 q 466 1114 577 1140 l 459 1051 l 365 1051 l 352 1160 q 428 1185 403 1169 q 452 1231 452 1202 q 378 1281 452 1281 q 300 1271 338 1281 l 300 1363 q 395 1375 346 1375 q 531 1341 484 1375 q 577 1240 577 1307 "},"È":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 417 1071 q 299 1172 371 1106 q 195 1278 228 1239 l 195 1293 l 380 1293 q 450 1184 406 1245 q 525 1087 495 1122 l 525 1071 l 417 1071 "},"X":{"x_min":2.71875,"x_max":861.28125,"ha":864,"o":"m 861 0 l 674 0 l 426 405 l 176 0 l 2 0 l 331 514 l 23 992 l 204 992 l 433 616 l 662 992 l 837 992 l 527 511 l 861 0 "},"ô":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 576 842 q 421 963 492 891 q 269 842 351 894 l 161 842 l 161 858 q 334 1064 291 992 l 510 1064 q 684 858 553 989 l 684 842 l 576 842 "},"̣":{"x_min":-514.09375,"x_max":-335.046875,"ha":0,"o":"m -514 -177 q -490 -112 -514 -135 q -423 -89 -467 -89 q -357 -112 -380 -89 q -335 -177 -335 -135 q -358 -241 -335 -217 q -423 -265 -381 -265 q -490 -241 -467 -265 q -514 -177 -514 -218 "},"Ė":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 331 1158 q 354 1223 331 1200 q 421 1247 378 1247 q 487 1223 463 1247 q 510 1158 510 1200 q 487 1094 510 1117 q 421 1071 463 1071 q 354 1094 378 1071 q 331 1158 331 1117 "},"Ā":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 249 1189 l 682 1189 l 682 1071 l 249 1071 l 249 1189 "},"ċ":{"x_min":69.203125,"x_max":643.21875,"ha":688,"o":"m 416 -14 q 157 85 246 -14 q 69 370 69 184 q 161 662 69 560 q 429 764 254 764 q 643 719 548 764 l 595 591 q 428 631 493 631 q 233 372 233 631 q 281 182 233 245 q 424 118 330 118 q 625 171 530 118 l 625 32 q 534 -3 582 7 q 416 -14 485 -14 m 325 948 q 348 1013 325 990 q 415 1037 372 1037 q 481 1013 457 1037 q 504 948 504 990 q 481 884 504 907 q 415 861 457 861 q 348 884 372 861 q 325 948 325 907 "},"đ":{"x_min":69.15625,"x_max":857.015625,"ha":876,"o":"m 364 -14 q 146 86 224 -14 q 69 362 69 186 q 144 646 69 550 q 366 743 218 743 q 594 633 517 743 l 602 633 q 595 686 600 639 q 591 763 591 733 l 591 826 l 331 826 l 331 937 l 591 937 l 591 1055 l 751 1055 l 751 937 l 857 937 l 857 826 l 751 826 l 751 0 l 620 0 l 591 97 l 584 97 q 364 -14 511 -14 m 413 114 q 554 168 509 114 q 598 340 598 222 l 598 362 q 554 556 598 500 q 408 612 511 612 q 281 552 323 612 q 240 360 240 492 q 413 114 240 114 "},"ấ":{"x_min":61.0625,"x_max":802.859375,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 629 842 l 543 842 q 400 954 467 892 q 256 842 322 886 l 169 842 l 169 858 q 316 1042 275 981 l 483 1042 q 629 858 543 955 l 629 842 m 572 990 q 662 1128 628 1057 l 802 1128 l 802 1113 q 657 974 756 1051 l 572 974 l 572 990 "},"Ẃ":{"x_min":8.140625,"x_max":1304.5,"ha":1314,"o":"m 1046 0 l 869 0 l 701 591 q 674 703 690 630 q 654 804 658 776 q 632 692 647 761 q 607 588 617 622 l 442 0 l 266 0 l 138 496 l 8 992 l 173 992 l 315 413 q 362 168 348 274 q 385 297 370 225 q 412 412 400 368 l 573 992 l 734 992 l 900 409 q 950 168 923 329 q 999 415 960 265 l 1140 992 l 1304 992 l 1046 0 m 541 1071 l 541 1087 q 621 1193 580 1135 q 685 1293 662 1251 l 871 1293 l 871 1278 q 765 1172 835 1237 q 647 1071 695 1106 l 541 1071 "},"Ŀ":{"x_min":130.921875,"x_max":712.96875,"ha":753,"o":"m 130 0 l 130 992 l 293 992 l 293 139 l 712 139 l 712 0 l 130 0 m 468 500 q 491 565 468 542 q 558 589 515 589 q 624 565 600 589 q 647 500 647 542 q 624 436 647 459 q 558 413 600 413 q 491 436 515 413 q 468 500 468 459 "},"ŋ":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 554 -334 q 443 -317 487 -334 l 443 -190 q 525 -203 482 -203 q 614 -87 614 -203 l 614 469 q 578 593 614 552 q 468 633 542 633 q 320 574 367 633 q 273 373 273 514 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 270 652 q 364 734 303 705 q 502 764 425 764 q 707 695 640 764 q 774 489 774 626 l 774 -98 q 717 -273 774 -213 q 554 -334 661 -334 "},"}":{"x_min":30.5,"x_max":484.5,"ha":515,"o":"m 313 -13 q 246 -169 313 -119 q 30 -220 178 -218 l 30 -95 q 130 -69 94 -95 q 166 18 166 -44 l 166 195 q 202 322 166 277 q 321 381 238 367 l 321 389 q 166 551 166 416 l 166 753 q 135 836 166 808 q 30 868 104 865 l 30 992 q 247 940 181 992 q 313 769 313 888 l 313 574 q 356 478 313 507 q 484 450 399 450 l 484 320 q 357 291 401 320 q 313 194 313 262 l 313 -13 "},"â":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 552 842 q 397 963 468 891 q 245 842 327 894 l 137 842 l 137 858 q 310 1064 267 992 l 486 1064 q 660 858 529 989 l 660 842 l 552 842 "},"ø":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 252 24 324 -14 l 201 -49 l 109 11 l 165 91 q 69 376 69 196 q 162 661 69 558 q 426 764 256 764 q 601 721 523 764 l 648 789 l 740 726 l 687 653 q 778 376 778 550 m 233 376 q 258 227 233 284 l 523 607 q 423 633 482 633 q 278 567 323 633 q 233 376 233 500 m 614 376 q 592 514 614 458 l 330 138 q 425 116 366 116 q 614 376 614 116 "},"‰":{"x_min":55.609375,"x_max":1669.75,"ha":1724,"o":"m 185 694 q 207 543 185 593 q 278 494 229 494 q 349 543 326 494 q 372 694 372 592 q 278 894 372 894 q 207 845 229 894 q 185 694 185 795 m 503 695 q 446 461 503 539 q 278 383 388 383 q 113 463 172 383 q 55 695 55 543 q 278 1006 55 1006 q 445 925 386 1006 q 503 695 503 845 m 946 992 l 396 0 l 265 0 l 815 992 l 946 992 m 1351 298 q 1373 146 1351 197 q 1443 96 1395 96 q 1514 146 1491 96 q 1537 298 1537 195 q 1443 497 1537 497 q 1373 448 1395 497 q 1351 298 1351 399 m 1669 298 q 1612 64 1669 142 q 1443 -14 1554 -14 q 1279 66 1337 -14 q 1220 298 1220 147 q 1443 609 1220 609 q 1610 528 1551 609 q 1669 298 1669 448 m 840 298 q 861 146 840 197 q 930 96 882 96 q 1001 146 978 96 q 1024 298 1024 195 q 930 497 1024 497 q 861 448 882 497 q 840 298 840 399 m 1157 298 q 1099 64 1157 142 q 930 -14 1041 -14 q 766 66 824 -14 q 708 298 708 147 q 930 609 708 609 q 1097 528 1038 609 q 1157 298 1157 448 "},"Ä":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 245 1177 q 268 1238 245 1219 q 323 1257 291 1257 q 381 1235 359 1257 q 402 1177 402 1214 q 380 1119 402 1141 q 323 1098 358 1098 q 268 1117 291 1098 q 245 1177 245 1137 m 512 1177 q 534 1238 512 1219 q 590 1257 557 1257 q 647 1235 626 1257 q 669 1177 669 1214 q 647 1119 669 1140 q 590 1098 624 1098 q 534 1117 557 1098 q 512 1177 512 1137 "},"Ỵ":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 319 -177 q 343 -112 319 -135 q 410 -89 366 -89 q 476 -112 453 -89 q 498 -177 498 -135 q 475 -241 498 -217 q 410 -265 452 -265 q 343 -241 366 -265 q 319 -177 319 -218 "},"ř":{"x_min":72.921875,"x_max":595.046875,"ha":599,"o":"m 494 764 q 573 757 542 764 l 558 608 q 487 616 524 616 q 332 554 392 616 q 273 392 273 491 l 273 0 l 113 0 l 113 750 l 238 750 l 259 618 l 267 618 q 365 724 305 685 q 494 764 425 764 m 595 1064 l 595 1045 q 474 915 509 957 q 421 842 439 873 l 245 842 q 72 1045 201 913 l 72 1064 l 180 1064 q 332 940 273 1003 q 487 1064 398 1007 l 595 1064 "},"—":{"x_min":55.609375,"x_max":1333.390625,"ha":1389,"o":"m 55 308 l 55 437 l 1333 437 l 1333 308 l 55 308 "},"N":{"x_min":130.90625,"x_max":957.09375,"ha":1088,"o":"m 957 0 l 758 0 l 270 790 l 265 790 l 268 746 q 278 515 278 620 l 278 0 l 130 0 l 130 992 l 327 992 l 814 205 l 818 205 q 812 319 816 221 q 808 472 808 417 l 808 992 l 957 992 l 957 0 "},"⁄":{"x_min":-266.546875,"x_max":443.828125,"ha":180,"o":"m 443 992 l -136 0 l -266 0 l 314 992 l 443 992 "},"2":{"x_min":61.046875,"x_max":733.296875,"ha":793,"o":"m 733 0 l 61 0 l 61 120 l 316 377 q 467 542 430 493 q 521 633 504 590 q 537 725 537 676 q 497 831 537 792 q 386 869 457 869 q 275 848 329 869 q 152 772 222 827 l 66 877 q 227 976 149 947 q 393 1006 305 1006 q 615 933 531 1006 q 698 739 698 861 q 674 611 698 672 q 600 487 650 551 q 434 314 550 423 l 262 147 l 262 140 l 733 140 l 733 0 "},"ü":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 224 948 q 247 1009 224 990 q 302 1028 270 1028 q 360 1006 338 1028 q 381 948 381 985 q 359 890 381 912 q 302 869 337 869 q 247 888 270 869 q 224 948 224 908 m 491 948 q 513 1009 491 990 q 569 1028 536 1028 q 626 1006 605 1028 q 648 948 648 985 q 626 890 648 911 q 569 869 603 869 q 513 888 536 869 q 491 948 491 908 "},"˜":{"x_min":160.03125,"x_max":693,"ha":832,"o":"m 526 841 q 470 853 497 841 q 416 879 442 865 q 364 906 389 894 q 316 918 339 918 q 242 840 261 918 l 160 840 q 212 984 168 934 q 326 1034 256 1034 q 383 1021 355 1034 q 437 995 410 1009 q 488 968 463 980 q 536 956 513 956 q 608 1035 589 956 l 693 1035 q 640 892 684 943 q 526 841 596 841 "},"Ó":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 445 1071 l 445 1087 q 525 1193 484 1135 q 589 1293 566 1251 l 775 1293 l 775 1278 q 669 1172 739 1237 q 551 1071 599 1106 l 445 1071 "}," ":{"x_min":0,"x_max":0,"ha":695},"ˇ":{"x_min":153.921875,"x_max":676.046875,"ha":832,"o":"m 676 1064 l 676 1045 q 555 915 590 957 q 502 842 520 873 l 326 842 q 153 1045 282 913 l 153 1064 l 261 1064 q 413 940 354 1003 q 568 1064 479 1007 l 676 1064 "},"Ÿ":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 198 1177 q 221 1238 198 1219 q 276 1257 244 1257 q 334 1235 312 1257 q 355 1177 355 1214 q 333 1119 355 1141 q 276 1098 311 1098 q 221 1117 244 1098 q 198 1177 198 1137 m 465 1177 q 487 1238 465 1219 q 543 1257 510 1257 q 600 1235 579 1257 q 622 1177 622 1214 q 600 1119 622 1140 q 543 1098 577 1098 q 487 1117 510 1098 q 465 1177 465 1137 "},"ų":{"x_min":107.203125,"x_max":778.78125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 648 -157 q 708 -218 648 -218 q 778 -206 737 -218 l 778 -304 q 684 -318 732 -318 q 568 -279 608 -318 q 529 -176 529 -241 q 555 -90 529 -132 q 644 0 580 -48 l 745 0 q 673 -81 698 -44 q 648 -157 648 -118 "},"Ŭ":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 508 1071 q 341 1125 402 1071 q 274 1277 279 1179 l 367 1277 q 385 1224 370 1244 q 427 1197 400 1205 q 511 1189 455 1189 q 617 1211 582 1189 q 656 1277 651 1234 l 750 1277 q 677 1126 742 1181 q 508 1071 612 1071 "},"ĝ":{"x_min":15.609375,"x_max":747.890625,"ha":773,"o":"m 747 750 l 747 662 l 619 638 q 648 580 637 615 q 660 507 660 545 q 580 324 660 391 q 359 258 500 258 q 294 263 323 258 q 242 189 242 231 q 266 150 242 163 q 355 138 291 138 l 486 138 q 675 85 610 138 q 739 -67 739 32 q 634 -264 739 -195 q 330 -334 529 -334 q 96 -279 177 -334 q 15 -124 15 -225 q 59 -8 15 -55 q 181 57 103 38 q 129 100 149 70 q 108 164 108 131 q 132 235 108 206 q 202 292 156 264 q 108 374 144 317 q 71 507 71 431 q 148 696 71 629 q 368 764 226 764 q 435 759 400 764 q 487 750 470 754 l 747 750 m 158 -116 q 204 -196 158 -168 q 335 -224 251 -224 q 529 -186 465 -224 q 593 -87 593 -149 q 558 -17 593 -38 q 428 3 523 3 l 307 3 q 198 -29 238 3 q 158 -116 158 -61 m 226 507 q 262 398 226 436 q 367 360 299 360 q 505 508 505 360 q 471 621 505 582 q 367 661 437 661 q 262 622 297 661 q 226 507 226 582 m 538 842 q 383 963 454 891 q 231 842 313 894 l 123 842 l 123 858 q 296 1064 253 992 l 472 1064 q 646 858 515 989 l 646 842 l 538 842 "},"ß":{"x_min":113.921875,"x_max":869.390625,"ha":925,"o":"m 779 849 q 753 754 779 799 q 682 674 726 709 q 602 608 621 628 q 584 569 584 588 q 599 531 584 549 q 653 488 615 514 l 718 445 q 810 371 780 403 q 854 300 839 338 q 869 214 869 262 q 796 44 869 102 q 585 -14 724 -14 q 383 30 457 -14 l 383 165 q 477 123 422 139 q 577 106 532 106 q 707 209 707 106 q 684 280 707 250 q 579 360 661 310 q 463 452 498 410 q 427 551 427 494 q 450 629 427 594 q 522 701 474 665 q 594 767 573 738 q 616 830 616 796 q 570 907 616 879 q 450 934 525 934 q 318 898 364 934 q 273 790 273 861 l 273 0 l 113 0 l 113 793 q 201 993 113 923 q 450 1063 288 1063 q 691 1005 602 1063 q 779 849 779 948 "},"Ể":{"x_min":130.859375,"x_max":765.03125,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 640 1071 l 554 1071 q 411 1183 478 1121 q 267 1071 333 1115 l 180 1071 l 180 1087 q 327 1271 286 1210 l 494 1271 q 640 1087 554 1184 l 640 1071 m 765 1339 q 680 1248 765 1266 l 676 1200 l 605 1200 l 598 1282 q 661 1299 642 1287 q 680 1331 680 1310 q 619 1369 680 1369 q 570 1363 594 1369 l 570 1434 q 628 1439 587 1439 q 765 1339 765 1439 "},"̀":{"x_min":-659.484375,"x_max":-329.875,"ha":0,"o":"m -437 842 q -555 943 -483 877 q -659 1049 -626 1010 l -659 1064 l -474 1064 q -404 955 -448 1016 q -329 858 -359 893 l -329 842 l -437 842 "},"s":{"x_min":66.453125,"x_max":617.6875,"ha":676,"o":"m 617 213 q 537 44 617 103 q 308 -14 457 -14 q 67 31 158 -14 l 67 169 q 313 108 200 108 q 461 197 461 108 q 444 244 461 225 q 391 284 428 263 q 287 330 353 304 q 112 430 157 380 q 66 561 66 480 q 144 710 66 657 q 355 764 221 764 q 605 710 487 764 l 553 590 q 349 640 432 640 q 223 568 223 640 q 256 508 223 533 q 400 441 289 484 q 534 375 492 405 q 597 306 577 345 q 617 213 617 267 "},"ẳ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 503 1125 q 424 1036 503 1056 l 420 1009 l 356 1009 l 350 1076 q 405 1093 388 1082 q 421 1123 421 1103 q 367 1157 421 1157 q 315 1153 339 1157 l 315 1214 q 375 1220 328 1220 q 469 1196 435 1220 q 503 1125 503 1173 m 404 842 q 244 895 301 842 q 180 1045 186 948 l 267 1045 q 404 943 278 943 q 539 1045 527 943 l 626 1045 q 561 893 618 944 q 404 842 505 842 "},"Ű":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 302 1071 l 302 1087 q 428 1293 373 1185 l 594 1293 l 594 1278 q 508 1178 574 1245 q 390 1071 443 1111 l 302 1071 m 557 1071 l 557 1087 q 625 1187 586 1126 q 684 1293 663 1249 l 849 1293 l 849 1278 q 763 1178 829 1245 q 645 1071 698 1111 l 557 1071 "},"?":{"x_min":10.84375,"x_max":594.4375,"ha":629,"o":"m 191 301 l 191 344 q 218 468 191 419 q 313 571 246 518 q 417 670 394 634 q 441 754 441 705 q 403 841 441 811 q 294 872 365 872 q 174 854 229 872 q 67 810 119 835 l 10 929 q 305 1006 148 1006 q 516 940 438 1006 q 594 761 594 875 q 579 670 594 710 q 534 594 564 630 q 430 501 504 558 q 346 419 367 451 q 324 331 324 386 l 324 301 l 191 301 m 164 84 q 263 186 164 186 q 338 160 312 186 q 364 84 364 133 q 338 8 364 36 q 263 -20 311 -20 q 189 7 215 -20 q 164 84 164 34 "},"ỡ":{"x_min":69.21875,"x_max":946.546875,"ha":895,"o":"m 779 376 q 685 89 779 192 q 422 -14 591 -14 q 236 33 317 -14 q 112 169 156 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 565 739 500 764 q 676 669 629 715 q 748 728 724 683 q 772 864 772 772 l 936 864 l 946 848 q 872 666 921 727 q 737 580 823 605 q 779 376 779 489 m 233 376 q 278 182 233 247 q 425 116 324 116 q 570 182 525 116 q 615 376 615 247 q 570 568 615 503 q 424 633 524 633 q 278 568 323 633 q 233 376 233 503 m 529 841 q 473 853 500 841 q 419 879 445 865 q 367 906 392 894 q 319 918 342 918 q 245 840 264 918 l 163 840 q 215 984 171 934 q 329 1034 259 1034 q 386 1021 358 1034 q 440 995 413 1009 q 491 968 466 980 q 539 956 516 956 q 611 1035 592 956 l 696 1035 q 643 892 687 943 q 529 841 599 841 "},"Ņ":{"x_min":130.90625,"x_max":957.09375,"ha":1088,"o":"m 957 0 l 758 0 l 270 790 l 265 790 l 268 746 q 278 515 278 620 l 278 0 l 130 0 l 130 992 l 327 992 l 814 205 l 818 205 q 812 319 816 221 q 808 472 808 417 l 808 992 l 957 992 l 957 0 m 395 -290 q 426 -188 411 -246 q 446 -85 440 -129 l 598 -85 l 598 -98 q 547 -210 579 -152 q 488 -307 516 -269 l 395 -307 l 395 -290 "},"c":{"x_min":69.203125,"x_max":643.21875,"ha":688,"o":"m 416 -14 q 157 85 246 -14 q 69 370 69 184 q 161 662 69 560 q 429 764 254 764 q 643 719 548 764 l 595 591 q 428 631 493 631 q 233 372 233 631 q 281 182 233 245 q 424 118 330 118 q 625 171 530 118 l 625 32 q 534 -3 582 7 q 416 -14 485 -14 "},"¶":{"x_min":76.6875,"x_max":775.640625,"ha":910,"o":"m 775 -176 l 682 -176 l 682 951 l 553 951 l 553 -176 l 460 -176 l 460 379 q 361 367 418 367 q 145 451 214 367 q 76 706 76 536 q 150 968 76 882 q 382 1055 224 1055 l 775 1055 l 775 -176 "},"Ī":{"x_min":-3.75,"x_max":429.390625,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m -3 1189 l 429 1189 l 429 1071 l -3 1071 l -3 1189 "},"•":{"x_min":88.8125,"x_max":433.359375,"ha":522,"o":"m 88 507 q 133 650 88 601 q 261 699 178 699 q 388 649 343 699 q 433 507 433 600 q 387 366 433 416 q 261 316 342 316 q 134 365 179 316 q 88 507 88 414 "},"Ὅ":{"x_min":-234.375,"x_max":1045.953125,"ha":1129,"o":"m 1045 496 q 924 120 1045 254 q 582 -14 803 -14 q 237 119 357 -14 q 117 498 117 252 q 238 875 117 743 q 583 1007 359 1007 q 925 873 804 1007 q 1045 496 1045 739 m 289 496 q 363 219 289 313 q 582 124 437 124 q 800 217 726 124 q 873 496 873 311 q 800 773 873 679 q 583 867 727 867 q 363 773 437 867 q 289 496 289 679 m -21 787 q 39 992 24 924 l 192 992 l 192 978 q 52 770 151 892 l -21 770 l -21 787 m -234 854 q -186 947 -234 909 q -53 1002 -139 985 l -53 953 q -120 923 -98 938 q -142 890 -142 909 q -131 871 -142 877 q -105 860 -119 865 q -80 845 -91 854 q -68 817 -68 836 q -88 778 -68 792 q -144 765 -107 765 q -209 788 -184 765 q -234 854 -234 812 "},"(":{"x_min":55.59375,"x_max":398.640625,"ha":440,"o":"m 55 380 q 108 717 55 560 q 259 992 160 873 l 398 992 q 254 705 304 864 q 204 381 204 547 q 254 60 204 216 q 397 -220 304 -94 l 259 -220 q 107 49 159 -104 q 55 380 55 203 "},"Ụ":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 424 -177 q 448 -112 424 -135 q 515 -89 471 -89 q 581 -112 558 -89 q 603 -177 603 -135 q 580 -241 603 -217 q 515 -265 557 -265 q 448 -241 471 -265 q 424 -177 424 -218 "},"◊":{"x_min":66.484375,"x_max":742.15625,"ha":810,"o":"m 66 498 l 372 999 l 436 999 l 742 498 l 436 0 l 372 0 l 66 498 m 594 498 l 404 817 l 213 498 l 404 179 l 594 498 "},"Ỗ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 639 1299 q 590 1308 615 1299 q 542 1328 566 1317 q 496 1349 519 1340 q 455 1359 474 1359 q 414 1345 428 1359 q 390 1298 399 1331 l 321 1298 q 362 1411 327 1368 q 452 1455 397 1455 q 503 1445 477 1455 q 552 1424 528 1435 q 597 1402 576 1412 q 637 1393 619 1393 q 678 1407 664 1393 q 702 1456 692 1422 l 770 1456 q 728 1340 763 1382 q 639 1299 693 1299 m 774 1071 l 695 1071 q 545 1178 612 1118 q 395 1071 483 1123 l 315 1071 l 315 1088 q 469 1265 429 1207 l 622 1265 q 774 1088 667 1199 l 774 1071 "},"­":{"x_min":48.84375,"x_max":397.484375,"ha":447,"o":"m 48 304 l 48 440 l 397 440 l 397 304 l 48 304 "},"Ħ":{"x_min":0,"x_max":1043,"ha":1043,"o":"m 912 842 l 1043 842 l 1043 726 l 912 726 l 912 0 l 750 0 l 750 446 l 293 446 l 293 0 l 130 0 l 130 726 l 0 726 l 0 842 l 130 842 l 130 992 l 293 992 l 293 842 l 750 842 l 750 992 l 912 992 l 912 842 m 750 586 l 750 726 l 293 726 l 293 586 l 750 586 "},":":{"x_min":90.234375,"x_max":291.671875,"ha":382,"o":"m 90 84 q 116 160 90 133 q 190 186 141 186 q 265 159 240 186 q 291 84 291 131 q 265 8 291 36 q 190 -20 239 -20 q 116 7 141 -20 q 90 84 90 35 m 90 663 q 190 766 90 766 q 266 738 241 766 q 291 663 291 711 q 265 587 291 615 q 190 559 239 559 q 116 586 141 559 q 90 663 90 614 "},"Û":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 662 1071 q 507 1192 578 1120 q 355 1071 437 1123 l 247 1071 l 247 1087 q 420 1293 377 1221 l 596 1293 q 770 1087 639 1218 l 770 1071 l 662 1071 "},"Ầ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 228 1087 q 330 1209 304 1176 q 375 1271 356 1243 l 542 1271 q 687 1087 601 1184 l 687 1071 l 601 1071 q 458 1183 536 1115 q 315 1071 386 1118 l 228 1071 l 228 1087 m 285 1203 l 201 1203 q 55 1342 107 1274 l 55 1357 l 196 1357 q 285 1219 232 1282 l 285 1203 "},"ś":{"x_min":66.453125,"x_max":617.6875,"ha":676,"o":"m 617 213 q 537 44 617 103 q 308 -14 457 -14 q 67 31 158 -14 l 67 169 q 313 108 200 108 q 461 197 461 108 q 444 244 461 225 q 391 284 428 263 q 287 330 353 304 q 112 430 157 380 q 66 561 66 480 q 144 710 66 657 q 355 764 221 764 q 605 710 487 764 l 553 590 q 349 640 432 640 q 223 568 223 640 q 256 508 223 533 q 400 441 289 484 q 534 375 492 405 q 597 306 577 345 q 617 213 617 267 m 242 842 l 242 858 q 322 964 281 906 q 386 1064 363 1022 l 572 1064 l 572 1049 q 466 943 536 1008 q 348 842 396 877 l 242 842 "},"V":{"x_min":0,"x_max":864,"ha":864,"o":"m 695 992 l 864 992 l 516 0 l 345 0 l 0 992 l 166 992 l 373 375 q 408 261 389 331 q 432 158 426 192 q 459 277 440 209 q 488 377 477 345 l 695 992 "},"Ŗ":{"x_min":130.921875,"x_max":875.109375,"ha":888,"o":"m 293 531 l 405 531 q 569 573 518 531 q 620 697 620 615 q 565 818 620 781 q 400 855 510 855 l 293 855 l 293 531 m 293 396 l 293 0 l 130 0 l 130 992 l 411 992 q 695 920 603 992 q 787 703 787 848 q 594 439 787 518 l 875 0 l 690 0 l 453 396 l 293 396 m 345 -290 q 376 -188 361 -246 q 396 -85 390 -129 l 548 -85 l 548 -98 q 497 -210 529 -152 q 438 -307 466 -269 l 345 -307 l 345 -290 "}," ":{"x_min":0,"x_max":0,"ha":361},"Ỹ":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 511 1070 q 455 1082 482 1070 q 401 1108 427 1094 q 349 1135 374 1123 q 301 1147 324 1147 q 227 1069 246 1147 l 145 1069 q 197 1213 153 1163 q 311 1263 241 1263 q 368 1250 340 1263 q 422 1224 395 1238 q 473 1197 448 1209 q 521 1185 498 1185 q 593 1264 574 1185 l 678 1264 q 625 1121 669 1172 q 511 1070 581 1070 "},"ʼ":{"x_min":10.96875,"x_max":245.65625,"ha":267,"o":"m 235 992 l 245 977 q 126 652 209 835 l 10 652 q 78 992 57 848 l 235 992 "},"@":{"x_min":75.265625,"x_max":1170.375,"ha":1247,"o":"m 1170 501 q 1139 323 1170 404 q 1054 198 1109 243 q 926 154 998 154 q 833 182 872 154 q 780 259 794 210 l 772 259 q 690 180 739 206 q 580 154 641 154 q 406 225 469 154 q 343 417 343 296 q 427 644 343 557 q 653 732 511 732 q 767 722 704 732 q 878 697 829 713 l 863 381 l 863 365 q 934 257 863 257 q 1019 326 987 257 q 1051 502 1051 395 q 1003 706 1051 618 q 868 841 956 794 q 667 889 781 889 q 416 829 523 889 q 253 658 309 769 q 197 401 197 548 q 302 99 197 205 q 604 -6 407 -6 q 916 54 754 -6 l 916 -56 q 606 -115 774 -115 q 215 20 355 -115 q 75 397 75 155 q 151 712 75 574 q 361 923 227 850 q 666 997 496 997 q 928 935 813 997 q 1106 762 1043 874 q 1170 501 1170 649 m 473 415 q 597 257 473 257 q 740 455 728 257 l 748 618 q 657 629 705 629 q 521 571 570 629 q 473 415 473 514 "},"¾":{"x_min":37.53125,"x_max":1112.796875,"ha":1153,"o":"m 958 992 l 378 0 l 248 0 l 829 992 l 958 992 m 1112 120 l 1027 120 l 1027 0 l 897 0 l 897 120 l 631 120 l 631 206 l 900 599 l 1027 599 l 1027 217 l 1112 217 l 1112 120 m 897 217 l 897 337 q 901 471 897 403 q 842 364 866 400 l 741 217 l 897 217 m 444 848 q 417 764 444 797 q 335 706 389 732 q 431 654 399 692 q 464 565 464 617 q 401 432 464 479 q 220 386 338 386 q 37 428 120 386 l 37 534 q 220 480 135 480 q 342 572 342 480 q 207 656 342 656 l 129 656 l 129 747 l 200 747 q 325 834 325 747 q 301 888 325 869 q 240 907 278 907 q 168 894 201 907 q 97 855 135 880 l 40 932 q 131 983 81 963 q 247 1004 180 1004 q 391 962 338 1004 q 444 848 444 920 "},"ŉ":{"x_min":1.96875,"x_max":905.125,"ha":1014,"o":"m 905 0 l 745 0 l 745 461 q 710 591 745 548 q 599 633 675 633 q 451 574 498 633 q 404 373 404 514 l 404 0 l 244 0 l 244 750 l 369 750 l 392 652 l 400 652 q 496 734 434 705 q 635 764 559 764 q 905 489 905 764 l 905 0 m 226 992 l 236 977 q 117 652 200 835 l 1 652 q 69 992 48 848 l 226 992 "},"i":{"x_min":104.375,"x_max":283.421875,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 104 949 q 127 1014 104 991 q 194 1038 151 1038 q 260 1014 236 1038 q 283 949 283 991 q 260 885 283 908 q 194 862 236 862 q 127 885 151 862 q 104 949 104 908 "},"ẽ":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 508 841 q 452 853 479 841 q 398 879 424 865 q 346 906 371 894 q 298 918 321 918 q 224 840 243 918 l 142 840 q 194 984 150 934 q 308 1034 238 1034 q 365 1021 337 1034 q 419 995 392 1009 q 470 968 445 980 q 518 956 495 956 q 590 1035 571 956 l 675 1035 q 622 892 666 943 q 508 841 578 841 "},"Ģ":{"x_min":82.109375,"x_max":901.796875,"ha":1009,"o":"m 536 538 l 901 538 l 901 39 q 729 -1 812 10 q 551 -14 647 -14 q 204 119 326 -14 q 82 495 82 252 q 219 870 82 735 q 599 1006 357 1006 q 893 946 754 1006 l 836 811 q 595 866 715 866 q 343 767 436 866 q 251 494 251 667 q 334 217 251 312 q 574 123 417 123 q 742 142 652 123 l 742 398 l 536 398 l 536 538 m 437 -290 q 468 -188 453 -246 q 488 -85 482 -129 l 640 -85 l 640 -98 q 589 -210 621 -152 q 530 -307 558 -269 l 437 -307 l 437 -290 "},"m":{"x_min":113.9375,"x_max":1219.484375,"ha":1328,"o":"m 746 0 l 586 0 l 586 462 q 553 591 586 548 q 451 633 520 633 q 316 573 359 633 q 273 373 273 513 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 359 734 300 705 q 490 764 419 764 q 719 645 663 764 l 730 645 q 824 732 763 701 q 962 764 884 764 q 1158 696 1096 764 q 1219 489 1219 628 l 1219 0 l 1060 0 l 1060 462 q 1027 591 1060 548 q 925 633 994 633 q 789 575 832 633 q 746 397 746 517 l 746 0 "},"ĕ":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 409 842 q 242 896 303 842 q 175 1048 180 950 l 268 1048 q 286 995 271 1015 q 328 968 301 976 q 412 960 356 960 q 518 982 483 960 q 557 1048 552 1005 l 651 1048 q 578 897 643 952 q 409 842 513 842 "},"Ỉ":{"x_min":99.265625,"x_max":376.671875,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 376 1240 q 265 1114 376 1140 l 258 1051 l 164 1051 l 151 1160 q 227 1185 202 1169 q 251 1231 251 1202 q 177 1281 251 1281 q 99 1271 137 1281 l 99 1363 q 194 1375 145 1375 q 330 1341 283 1375 q 376 1240 376 1307 "},"ż":{"x_min":46.125,"x_max":615.171875,"ha":664,"o":"m 615 0 l 46 0 l 46 98 l 425 627 l 69 627 l 69 750 l 604 750 l 604 638 l 233 122 l 615 122 l 615 0 m 242 948 q 265 1013 242 990 q 332 1037 289 1037 q 398 1013 374 1037 q 421 948 421 990 q 398 884 421 907 q 332 861 374 861 q 265 884 289 861 q 242 948 242 907 "},"Ị":{"x_min":120.90625,"x_max":299.953125,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 120 -177 q 144 -112 120 -135 q 211 -89 167 -89 q 277 -112 254 -89 q 299 -177 299 -135 q 276 -241 299 -217 q 211 -265 253 -265 q 144 -241 167 -265 q 120 -177 120 -218 "},"ő":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 202 842 l 202 858 q 328 1064 273 956 l 494 1064 l 494 1049 q 408 949 474 1016 q 290 842 343 882 l 202 842 m 457 842 l 457 858 q 525 958 486 897 q 584 1064 563 1020 l 749 1064 l 749 1049 q 663 949 729 1016 q 545 842 598 882 l 457 842 "},"ž":{"x_min":46.125,"x_max":615.171875,"ha":664,"o":"m 615 0 l 46 0 l 46 98 l 425 627 l 69 627 l 69 750 l 604 750 l 604 638 l 233 122 l 615 122 l 615 0 m 600 1064 l 600 1045 q 479 915 514 957 q 426 842 444 873 l 250 842 q 77 1045 206 913 l 77 1064 l 185 1064 q 337 940 278 1003 q 492 1064 403 1007 l 600 1064 "},"ự":{"x_min":107.171875,"x_max":1044.625,"ha":989,"o":"m 643 0 l 620 97 l 611 97 q 517 15 577 45 q 379 -14 457 -14 q 174 53 242 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 669 q 847 729 822 681 q 872 865 872 776 l 1035 865 l 1044 849 q 992 696 1025 751 q 903 608 959 641 q 768 565 848 574 l 768 0 l 643 0 m 333 -177 q 357 -112 333 -135 q 424 -89 380 -89 q 490 -112 467 -89 q 512 -177 512 -135 q 489 -241 512 -217 q 424 -265 466 -265 q 357 -241 380 -265 q 333 -177 333 -218 "},"ớ":{"x_min":69.21875,"x_max":946.546875,"ha":895,"o":"m 779 376 q 685 89 779 192 q 422 -14 591 -14 q 236 33 317 -14 q 112 169 156 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 565 739 500 764 q 676 669 629 715 q 748 728 724 683 q 772 864 772 772 l 936 864 l 946 848 q 872 666 921 727 q 737 580 823 605 q 779 376 779 489 m 233 376 q 278 182 233 247 q 425 116 324 116 q 570 182 525 116 q 615 376 615 247 q 570 568 615 503 q 424 633 524 633 q 278 568 323 633 q 233 376 233 503 m 324 842 l 324 858 q 404 964 363 906 q 468 1064 445 1022 l 654 1064 l 654 1049 q 548 943 618 1008 q 430 842 478 877 l 324 842 "},"Ŏ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 542 1071 q 375 1125 436 1071 q 308 1277 313 1179 l 401 1277 q 419 1224 404 1244 q 461 1197 434 1205 q 545 1189 489 1189 q 651 1211 616 1189 q 690 1277 685 1234 l 784 1277 q 711 1126 776 1181 q 542 1071 646 1071 "},"á":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 297 842 l 297 858 q 377 964 336 906 q 441 1064 418 1022 l 627 1064 l 627 1049 q 521 943 591 1008 q 403 842 451 877 l 297 842 "},"×":{"x_min":88.859375,"x_max":704.140625,"ha":793,"o":"m 309 490 l 88 711 l 173 797 l 396 576 l 619 797 l 704 714 l 481 490 l 701 268 l 617 183 l 394 404 l 175 183 l 90 268 l 309 490 "},"ẩ":{"x_min":61.0625,"x_max":758.03125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 633 842 l 547 842 q 404 954 471 892 q 260 842 326 886 l 173 842 l 173 858 q 320 1042 279 981 l 487 1042 q 633 858 547 955 l 633 842 m 758 1110 q 673 1019 758 1037 l 669 971 l 598 971 l 591 1053 q 654 1070 635 1058 q 673 1102 673 1081 q 612 1140 673 1140 q 563 1134 587 1140 l 563 1205 q 621 1210 580 1210 q 758 1110 758 1210 "},"İ":{"x_min":121.375,"x_max":300.421875,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 121 1177 q 144 1242 121 1219 q 211 1266 168 1266 q 277 1242 253 1266 q 300 1177 300 1219 q 277 1113 300 1136 q 211 1090 253 1090 q 144 1113 168 1090 q 121 1177 121 1136 "},"̏":{"x_min":-747.40625,"x_max":-206.859375,"ha":0,"o":"m -294 842 q -405 946 -340 878 q -491 1049 -471 1015 l -491 1064 l -326 1064 q -273 963 -307 1022 q -206 858 -240 904 l -206 842 l -294 842 m -550 842 q -661 946 -596 878 q -747 1049 -727 1015 l -747 1064 l -581 1064 q -529 963 -562 1022 q -462 858 -495 904 l -462 842 l -550 842 "},"Ě":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 677 1293 l 677 1274 q 556 1144 591 1186 q 503 1071 521 1102 l 327 1071 q 154 1274 283 1142 l 154 1293 l 262 1293 q 414 1169 355 1232 q 569 1293 480 1236 l 677 1293 "},"Ố":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 774 1071 l 688 1071 q 545 1183 612 1121 q 401 1071 467 1115 l 314 1071 l 314 1087 q 461 1271 420 1210 l 628 1271 q 774 1087 688 1184 l 774 1071 m 717 1219 q 807 1357 773 1286 l 947 1357 l 947 1342 q 802 1203 901 1280 l 717 1203 l 717 1219 "},"K":{"x_min":130.921875,"x_max":888,"ha":888,"o":"m 888 0 l 700 0 l 388 449 l 293 371 l 293 0 l 130 0 l 130 992 l 293 992 l 293 518 q 425 675 359 599 l 693 992 l 877 992 q 505 557 618 686 l 888 0 "},"7":{"x_min":50.203125,"x_max":736.015625,"ha":793,"o":"m 173 0 l 565 849 l 50 849 l 50 990 l 736 990 l 736 878 l 345 0 l 173 0 "},"¨":{"x_min":198.71875,"x_max":622.609375,"ha":822,"o":"m 198 948 q 221 1009 198 990 q 276 1028 244 1028 q 334 1006 312 1028 q 355 948 355 985 q 333 890 355 912 q 276 869 311 869 q 221 888 244 869 q 198 948 198 908 m 465 948 q 487 1009 465 990 q 543 1028 510 1028 q 600 1006 579 1028 q 622 948 622 985 q 600 890 622 911 q 543 869 577 869 q 487 888 510 869 q 465 948 465 908 "},"Y":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 "},"E":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 "},"Ô":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 694 1071 q 539 1192 610 1120 q 387 1071 469 1123 l 279 1071 l 279 1087 q 452 1293 409 1221 l 628 1293 q 802 1087 671 1218 l 802 1071 l 694 1071 "},"‹":{"x_min":55.65625,"x_max":411.34375,"ha":467,"o":"m 55 379 l 297 673 l 411 609 l 219 371 l 411 135 l 297 70 l 55 362 l 55 379 "},"ổ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 650 842 l 564 842 q 421 954 488 892 q 277 842 343 886 l 190 842 l 190 858 q 337 1042 296 981 l 504 1042 q 650 858 564 955 l 650 842 m 775 1110 q 690 1019 775 1037 l 686 971 l 615 971 l 608 1053 q 671 1070 652 1058 q 690 1102 690 1081 q 629 1140 690 1140 q 580 1134 604 1140 l 580 1205 q 638 1210 597 1210 q 775 1110 775 1210 "},"Ï":{"x_min":0.71875,"x_max":424.609375,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 0 1177 q 23 1238 0 1219 q 78 1257 46 1257 q 136 1235 114 1257 q 157 1177 157 1214 q 135 1119 157 1141 q 78 1098 113 1098 q 23 1117 46 1098 q 0 1177 0 1137 m 267 1177 q 289 1238 267 1219 q 345 1257 312 1257 q 402 1235 381 1257 q 424 1177 424 1214 q 402 1119 424 1140 q 345 1098 379 1098 q 289 1117 312 1098 q 267 1177 267 1137 "},"ġ":{"x_min":15.609375,"x_max":747.890625,"ha":773,"o":"m 747 750 l 747 662 l 619 638 q 648 580 637 615 q 660 507 660 545 q 580 324 660 391 q 359 258 500 258 q 294 263 323 258 q 242 189 242 231 q 266 150 242 163 q 355 138 291 138 l 486 138 q 675 85 610 138 q 739 -67 739 32 q 634 -264 739 -195 q 330 -334 529 -334 q 96 -279 177 -334 q 15 -124 15 -225 q 59 -8 15 -55 q 181 57 103 38 q 129 100 149 70 q 108 164 108 131 q 132 235 108 206 q 202 292 156 264 q 108 374 144 317 q 71 507 71 431 q 148 696 71 629 q 368 764 226 764 q 435 759 400 764 q 487 750 470 754 l 747 750 m 158 -116 q 204 -196 158 -168 q 335 -224 251 -224 q 529 -186 465 -224 q 593 -87 593 -149 q 558 -17 593 -38 q 428 3 523 3 l 307 3 q 198 -29 238 3 q 158 -116 158 -61 m 226 507 q 262 398 226 436 q 367 360 299 360 q 505 508 505 360 q 471 621 505 582 q 367 661 437 661 q 262 622 297 661 q 226 507 226 582 m 290 948 q 313 1013 290 990 q 380 1037 337 1037 q 446 1013 422 1037 q 469 948 469 990 q 446 884 469 907 q 380 861 422 861 q 313 884 337 861 q 290 948 290 907 "},"Ẳ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 559 1354 q 480 1265 559 1285 l 476 1238 l 412 1238 l 406 1305 q 461 1322 444 1311 q 477 1352 477 1332 q 423 1386 477 1386 q 371 1382 395 1386 l 371 1443 q 431 1449 384 1449 q 525 1425 491 1449 q 559 1354 559 1402 m 460 1071 q 300 1124 357 1071 q 236 1274 242 1177 l 323 1274 q 460 1172 334 1172 q 595 1274 583 1172 l 682 1274 q 617 1122 674 1173 q 460 1071 561 1071 "},"ứ":{"x_min":107.171875,"x_max":1044.625,"ha":989,"o":"m 643 0 l 620 97 l 611 97 q 517 15 577 45 q 379 -14 457 -14 q 174 53 242 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 669 q 847 729 822 681 q 872 865 872 776 l 1035 865 l 1044 849 q 992 696 1025 751 q 903 608 959 641 q 768 565 848 574 l 768 0 l 643 0 m 343 842 l 343 858 q 423 964 382 906 q 487 1064 464 1022 l 673 1064 l 673 1049 q 567 943 637 1008 q 449 842 497 877 l 343 842 "},"ủ":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 595 1011 q 484 885 595 911 l 477 822 l 383 822 l 370 931 q 446 956 421 940 q 470 1002 470 973 q 396 1052 470 1052 q 318 1042 356 1052 l 318 1134 q 413 1146 364 1146 q 549 1112 502 1146 q 595 1011 595 1078 "},"Ằ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 509 1247 l 433 1247 q 294 1387 355 1308 l 294 1402 l 428 1402 q 509 1264 461 1329 l 509 1247 m 460 1071 q 300 1124 357 1071 q 236 1274 242 1177 l 323 1274 q 460 1172 334 1172 q 595 1274 583 1172 l 682 1274 q 617 1122 674 1173 q 460 1071 561 1071 "},"ķ":{"x_min":113.90625,"x_max":787.21875,"ha":794,"o":"m 267 396 l 358 508 l 584 750 l 768 750 l 466 427 l 787 0 l 600 0 l 359 328 l 271 257 l 271 0 l 113 0 l 113 1055 l 271 1055 l 271 540 l 263 396 l 267 396 m 296 -290 q 327 -188 312 -246 q 347 -85 341 -129 l 499 -85 l 499 -98 q 448 -210 480 -152 q 389 -307 417 -269 l 296 -307 l 296 -290 "},"Ấ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 687 1071 l 601 1071 q 458 1183 525 1121 q 314 1071 380 1115 l 227 1071 l 227 1087 q 374 1271 333 1210 l 541 1271 q 687 1087 601 1184 l 687 1071 m 630 1219 q 720 1357 686 1286 l 860 1357 l 860 1342 q 715 1203 814 1280 l 630 1203 l 630 1219 "}," ":{"x_min":0,"x_max":0,"ha":463},"ể":{"x_min":69.15625,"x_max":761.03125,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 636 842 l 550 842 q 407 954 474 892 q 263 842 329 886 l 176 842 l 176 858 q 323 1042 282 981 l 490 1042 q 636 858 550 955 l 636 842 m 761 1110 q 676 1019 761 1037 l 672 971 l 601 971 l 594 1053 q 657 1070 638 1058 q 676 1102 676 1081 q 615 1140 676 1140 q 566 1134 590 1140 l 566 1205 q 624 1210 583 1210 q 761 1110 761 1210 "},"±":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 335 450 l 65 450 l 65 571 l 335 571 l 335 847 l 457 847 l 457 571 l 727 571 l 727 450 l 457 450 l 457 174 l 335 174 l 335 450 m 65 0 l 65 120 l 727 120 l 727 0 l 65 0 "},"ì":{"x_min":-46.484375,"x_max":283.125,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 175 842 q 57 943 129 877 q -46 1049 -13 1010 l -46 1064 l 138 1064 q 208 955 164 1016 q 283 858 253 893 l 283 842 l 175 842 "},"|":{"x_min":320.78125,"x_max":442.859375,"ha":765,"o":"m 320 1053 l 442 1053 l 442 -326 l 320 -326 l 320 1053 "},"§":{"x_min":78.015625,"x_max":613.921875,"ha":696,"o":"m 87 546 q 113 645 87 601 q 189 719 139 689 q 90 878 90 775 q 164 1015 90 965 q 364 1065 238 1065 q 482 1053 426 1065 q 605 1013 538 1041 l 559 903 q 440 946 480 937 q 358 955 399 955 q 226 881 226 955 q 263 817 226 844 q 393 756 301 791 q 563 657 512 710 q 613 529 613 603 q 519 349 613 409 q 613 198 613 295 q 533 45 613 101 q 312 -10 453 -10 q 78 38 168 -10 l 78 159 q 195 115 130 132 q 315 97 260 97 q 474 186 474 97 q 460 234 474 215 q 412 270 446 252 q 312 314 378 289 q 172 383 217 352 q 108 454 128 415 q 87 546 87 494 m 212 560 q 228 506 212 529 q 281 459 244 482 q 413 398 318 436 q 487 512 487 442 q 445 598 487 563 q 295 668 403 632 q 235 627 259 658 q 212 560 212 596 "},"˳":{"x_min":69.25,"x_max":392.390625,"ha":463,"o":"m 392 -237 q 346 -349 392 -307 q 228 -392 300 -392 q 112 -350 156 -392 q 69 -238 69 -309 q 112 -126 69 -168 q 228 -85 156 -85 q 346 -128 301 -85 q 392 -237 392 -171 m 300 -238 q 279 -185 300 -204 q 228 -167 259 -167 q 175 -185 196 -167 q 155 -238 155 -204 q 173 -291 155 -272 q 228 -311 192 -311 q 280 -291 260 -311 q 300 -238 300 -272 "},"q":{"x_min":69.140625,"x_max":751.109375,"ha":865,"o":"m 410 113 q 554 171 511 113 q 598 347 598 229 l 598 372 q 553 572 598 511 q 408 633 508 633 q 278 565 322 633 q 233 370 233 497 q 410 113 233 113 m 365 -14 q 147 88 226 -14 q 69 373 69 190 q 149 660 69 556 q 369 764 229 764 q 495 737 439 764 q 595 651 551 711 l 601 651 l 618 750 l 751 750 l 751 -334 l 591 -334 l 591 -15 q 593 47 591 13 q 598 98 596 80 l 589 98 q 365 -14 519 -14 "},"b":{"x_min":113.890625,"x_max":793.828125,"ha":865,"o":"m 496 764 q 715 662 637 764 q 793 376 793 560 q 714 88 793 191 q 494 -14 635 -14 q 273 88 351 -14 l 262 88 l 233 0 l 113 0 l 113 1055 l 273 1055 l 273 804 q 270 721 273 776 q 266 651 267 666 l 273 651 q 496 764 349 764 m 455 633 q 316 577 359 633 q 273 387 274 520 l 273 376 q 316 177 273 239 q 458 116 360 116 q 586 183 542 116 q 630 377 630 250 q 455 633 630 633 "},"̃":{"x_min":-696.96875,"x_max":-164,"ha":0,"o":"m -330 841 q -386 853 -359 841 q -440 879 -414 865 q -492 906 -467 894 q -540 918 -517 918 q -614 840 -595 918 l -696 840 q -644 984 -688 934 q -530 1034 -600 1034 q -473 1021 -501 1034 q -419 995 -446 1009 q -368 968 -393 980 q -320 956 -343 956 q -248 1035 -267 956 l -164 1035 q -216 892 -172 943 q -330 841 -260 841 "},"ộ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 333 -177 q 357 -112 333 -135 q 424 -89 380 -89 q 490 -112 467 -89 q 512 -177 512 -135 q 489 -241 512 -217 q 424 -265 466 -265 q 357 -241 380 -265 q 333 -177 333 -218 m 576 842 q 421 963 492 891 q 269 842 351 894 l 161 842 l 161 858 q 334 1064 291 992 l 510 1064 q 684 858 553 989 l 684 842 l 576 842 "},"®":{"x_min":67.84375,"x_max":1088.15625,"ha":1156,"o":"m 507 522 l 554 522 q 630 545 604 522 q 656 613 656 569 q 631 682 656 662 q 552 701 606 701 l 507 701 l 507 522 m 784 616 q 681 458 784 500 l 841 189 l 698 189 l 568 423 l 507 423 l 507 189 l 379 189 l 379 802 l 556 802 q 729 755 675 802 q 784 616 784 709 m 67 495 q 135 750 67 631 q 322 937 203 868 q 578 1006 440 1006 q 832 938 713 1006 q 1019 751 951 870 q 1088 495 1088 632 q 1022 244 1088 361 q 837 56 956 127 q 578 -14 719 -14 q 318 56 437 -14 q 133 243 200 126 q 67 495 67 361 m 151 495 q 208 281 151 380 q 364 125 265 182 q 578 68 464 68 q 792 126 693 68 q 948 282 891 184 q 1004 495 1004 380 q 947 709 1004 609 q 790 865 890 808 q 578 922 691 922 q 365 866 464 922 q 209 710 267 809 q 151 495 151 611 "},"Ŋ":{"x_min":130.90625,"x_max":957.09375,"ha":1088,"o":"m 672 -277 q 554 -260 601 -277 l 554 -122 q 662 -136 604 -136 q 772 -100 734 -136 q 814 1 810 -64 l 270 790 l 265 790 l 268 748 q 278 505 278 617 l 278 0 l 130 0 l 130 992 l 327 992 l 814 282 l 818 282 q 808 657 808 365 l 808 992 l 957 992 l 957 3 q 883 -204 957 -132 q 672 -277 809 -277 "},"ọ":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 331 -177 q 355 -112 331 -135 q 422 -89 378 -89 q 488 -112 465 -89 q 510 -177 510 -135 q 487 -241 510 -217 q 422 -265 464 -265 q 355 -241 378 -265 q 331 -177 331 -218 "},"Ũ":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 616 1070 q 560 1082 587 1070 q 506 1108 532 1094 q 454 1135 479 1123 q 406 1147 429 1147 q 332 1069 351 1147 l 250 1069 q 302 1213 258 1163 q 416 1263 346 1263 q 473 1250 445 1263 q 527 1224 500 1238 q 578 1197 553 1209 q 626 1185 603 1185 q 698 1264 679 1185 l 783 1264 q 730 1121 774 1172 q 616 1070 686 1070 "},"L":{"x_min":130.921875,"x_max":712.96875,"ha":753,"o":"m 130 0 l 130 992 l 293 992 l 293 139 l 712 139 l 712 0 l 130 0 "},"ế":{"x_min":69.15625,"x_max":813.859375,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 640 842 l 554 842 q 411 954 478 892 q 267 842 333 886 l 180 842 l 180 858 q 327 1042 286 981 l 494 1042 q 640 858 554 955 l 640 842 m 583 990 q 673 1128 639 1057 l 813 1128 l 813 1113 q 668 974 767 1051 l 583 974 l 583 990 "},"ď":{"x_min":69.140625,"x_max":1011.203125,"ha":865,"o":"m 366 -14 q 147 87 226 -14 q 69 373 69 189 q 148 661 69 558 q 369 764 228 764 q 594 654 517 764 l 602 654 q 591 782 591 735 l 591 1055 l 751 1055 l 751 0 l 626 0 l 598 98 l 591 98 q 366 -14 514 -14 m 409 114 q 552 170 507 114 q 598 349 597 225 l 598 372 q 552 574 598 514 q 408 633 506 633 q 278 565 324 633 q 233 370 233 497 q 277 180 233 245 q 409 114 321 114 m 813 849 q 857 1055 845 956 l 1011 1055 l 1011 1041 q 965 938 995 999 q 905 833 934 877 l 813 833 l 813 849 "}," ":{"x_min":0,"x_max":0,"ha":361},"Ĭ":{"x_min":-25.703125,"x_max":450.984375,"ha":424,"o":"m 130 0 l 130 992 l 293 992 l 293 0 l 130 0 m 208 1071 q 41 1125 102 1071 q -25 1277 -20 1179 l 67 1277 q 85 1224 70 1244 q 127 1197 100 1205 q 211 1189 155 1189 q 317 1211 282 1189 q 356 1277 351 1234 l 450 1277 q 377 1126 442 1181 q 208 1071 312 1071 "},"ŧ":{"x_min":26.453125,"x_max":510.046875,"ha":546,"o":"m 394 114 q 510 133 446 114 l 510 13 q 441 -6 484 1 q 355 -14 399 -14 q 184 46 239 -14 q 128 229 128 106 l 128 365 l 37 365 l 37 476 l 128 476 l 128 629 l 26 629 l 26 699 l 136 758 l 190 917 l 288 917 l 288 750 l 502 750 l 502 629 l 288 629 l 288 476 l 484 476 l 484 365 l 288 365 l 288 233 q 394 114 288 114 "},"À":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 448 1071 q 330 1172 402 1106 q 226 1278 259 1239 l 226 1293 l 411 1293 q 481 1184 437 1245 q 556 1087 526 1122 l 556 1071 l 448 1071 "},"ẃ":{"x_min":13.5625,"x_max":1120.078125,"ha":1135,"o":"m 729 0 l 632 349 q 568 608 614 405 l 562 608 q 499 348 523 425 l 400 0 l 223 0 l 13 750 l 176 750 l 272 380 q 318 145 304 243 l 322 145 q 342 259 329 195 q 367 355 356 323 l 481 750 l 656 750 l 766 355 q 792 253 776 322 q 810 147 807 185 l 815 147 q 862 380 825 230 l 960 750 l 1120 750 l 908 0 l 729 0 m 461 842 l 461 858 q 541 964 500 906 q 605 1064 582 1022 l 791 1064 l 791 1049 q 685 943 755 1008 q 567 842 615 877 l 461 842 "},"+":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 335 429 l 65 429 l 65 550 l 335 550 l 335 826 l 457 826 l 457 550 l 727 550 l 727 429 l 457 429 l 457 153 l 335 153 l 335 429 "},"ḁ":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 546 -237 q 500 -349 546 -307 q 382 -392 454 -392 q 266 -350 310 -392 q 223 -238 223 -309 q 266 -126 223 -168 q 382 -85 310 -85 q 500 -128 455 -85 q 546 -237 546 -171 m 454 -238 q 433 -185 454 -204 q 382 -167 413 -167 q 329 -185 350 -167 q 309 -238 309 -204 q 327 -291 309 -272 q 382 -311 346 -311 q 434 -291 414 -311 q 454 -238 454 -272 "},"½":{"x_min":30.984375,"x_max":1090.90625,"ha":1153,"o":"m 879 992 l 299 0 l 169 0 l 750 992 l 879 992 m 334 397 l 208 397 l 208 744 l 210 814 l 214 876 q 186 849 202 864 q 90 773 170 834 l 30 850 l 221 992 l 334 992 l 334 397 m 1090 0 l 665 0 l 665 91 l 821 244 q 923 356 900 320 q 945 432 945 392 q 923 485 945 467 q 867 503 901 503 q 730 444 803 503 l 666 526 q 876 607 761 607 q 1020 562 968 607 q 1071 440 1071 517 q 1040 332 1071 383 q 915 195 1008 281 l 821 107 l 1090 107 l 1090 0 "},"Ë":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 201 1177 q 224 1238 201 1219 q 279 1257 247 1257 q 337 1235 315 1257 q 358 1177 358 1214 q 336 1119 358 1141 q 279 1098 314 1098 q 224 1117 247 1098 q 201 1177 201 1137 m 468 1177 q 490 1238 468 1219 q 546 1257 513 1257 q 603 1235 582 1257 q 625 1177 625 1214 q 603 1119 625 1140 q 546 1098 580 1098 q 490 1117 513 1098 q 468 1177 468 1137 "},"'":{"x_min":90.265625,"x_max":247.609375,"ha":338,"o":"m 247 992 l 219 634 l 118 634 l 90 992 l 247 992 "},"Š":{"x_min":67.84375,"x_max":702.9375,"ha":764,"o":"m 702 269 q 607 61 702 136 q 343 -14 511 -14 q 67 38 175 -14 l 67 191 q 212 141 135 159 q 354 123 288 123 q 496 159 450 123 q 542 258 542 196 q 500 352 542 313 q 326 444 458 391 q 135 569 190 499 q 79 739 79 640 q 167 934 79 863 q 404 1006 255 1006 q 688 943 546 1006 l 636 811 q 400 866 504 866 q 280 832 321 866 q 240 742 240 798 q 256 675 240 703 q 310 623 272 648 q 444 559 347 599 q 604 474 553 513 q 679 385 655 435 q 702 269 702 336 m 660 1293 l 660 1274 q 539 1144 574 1186 q 486 1071 504 1102 l 310 1071 q 137 1274 266 1142 l 137 1293 l 245 1293 q 397 1169 338 1232 q 552 1293 463 1236 l 660 1293 "},"ĳ":{"x_min":104.375,"x_max":657.421875,"ha":761,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 104 949 q 127 1014 104 991 q 194 1038 151 1038 q 260 1014 236 1038 q 283 949 283 991 q 260 885 283 908 q 194 862 236 862 q 127 885 151 862 q 104 949 104 908 m 411 -334 q 291 -317 339 -334 l 291 -190 q 386 -203 337 -203 q 487 -87 487 -203 l 487 750 l 647 750 l 647 -98 q 586 -274 647 -214 q 411 -334 525 -334 m 478 949 q 501 1014 478 991 q 568 1038 525 1038 q 634 1014 610 1038 q 657 949 657 991 q 634 885 657 908 q 568 862 610 862 q 501 885 525 862 q 478 949 478 908 "}," ":{"x_min":0,"x_max":0,"ha":1389},"˛":{"x_min":15.578125,"x_max":264.78125,"ha":279,"o":"m 134 -157 q 194 -218 134 -218 q 264 -206 223 -218 l 264 -304 q 170 -318 218 -318 q 54 -279 94 -318 q 15 -176 15 -241 q 41 -90 15 -132 q 130 0 66 -48 l 231 0 q 159 -81 184 -44 q 134 -157 134 -118 "},"ở":{"x_min":69.21875,"x_max":946.546875,"ha":895,"o":"m 779 376 q 685 89 779 192 q 422 -14 591 -14 q 236 33 317 -14 q 112 169 156 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 565 739 500 764 q 676 669 629 715 q 748 728 724 683 q 772 864 772 772 l 936 864 l 946 848 q 872 666 921 727 q 737 580 823 605 q 779 376 779 489 m 233 376 q 278 182 233 247 q 425 116 324 116 q 570 182 525 116 q 615 376 615 247 q 570 568 615 503 q 424 633 524 633 q 278 568 323 633 q 233 376 233 503 m 591 1011 q 480 885 591 911 l 473 822 l 379 822 l 366 931 q 442 956 417 940 q 466 1002 466 973 q 392 1052 466 1052 q 314 1042 352 1052 l 314 1134 q 409 1146 360 1146 q 545 1112 498 1146 q 591 1011 591 1078 "},"ð":{"x_min":69.171875,"x_max":779.25,"ha":843,"o":"m 779 384 q 686 90 779 194 q 422 -14 592 -14 q 166 78 263 -14 q 69 325 69 170 q 158 573 69 482 q 396 665 246 665 q 600 589 541 665 l 605 592 q 451 826 563 720 l 282 725 l 222 815 l 360 895 q 247 965 302 935 l 304 1064 q 479 966 399 1021 l 636 1060 l 695 972 l 568 895 q 725 671 671 800 q 779 384 779 543 m 616 353 q 565 490 616 439 q 425 541 514 541 q 277 485 322 541 q 231 323 231 430 q 282 164 231 219 q 425 109 332 109 q 571 171 525 109 q 616 353 616 232 "},"ş":{"x_min":66.453125,"x_max":617.6875,"ha":676,"o":"m 617 213 q 537 44 617 103 q 308 -14 457 -14 q 67 31 158 -14 l 67 169 q 313 108 200 108 q 461 197 461 108 q 444 244 461 225 q 391 284 428 263 q 287 330 353 304 q 112 430 157 380 q 66 561 66 480 q 144 710 66 657 q 355 764 221 764 q 605 710 487 764 l 553 590 q 349 640 432 640 q 223 568 223 640 q 256 508 223 533 q 400 441 289 484 q 534 375 492 405 q 597 306 577 345 q 617 213 617 267 m 463 -183 q 256 -334 463 -334 q 174 -323 211 -334 l 174 -230 q 257 -240 210 -240 q 315 -229 294 -240 q 337 -187 337 -218 q 215 -112 337 -129 l 272 0 l 375 0 l 347 -60 q 432 -106 402 -74 q 463 -183 463 -138 "},"Ỡ":{"x_min":82.09375,"x_max":1149.265625,"ha":1114,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 897 865 776 1007 q 956 926 937 880 q 975 1055 975 971 l 1139 1055 l 1149 1040 q 1081 863 1127 926 q 957 770 1034 800 q 1010 496 1010 652 m 254 496 q 328 217 254 311 q 547 124 402 124 q 838 496 838 124 q 548 867 838 867 q 328 774 402 867 q 254 496 254 681 m 648 1070 q 592 1082 619 1070 q 538 1108 564 1094 q 486 1135 511 1123 q 438 1147 461 1147 q 364 1069 383 1147 l 282 1069 q 334 1213 290 1163 q 448 1263 378 1263 q 505 1250 477 1263 q 559 1224 532 1238 q 610 1197 585 1209 q 658 1185 635 1185 q 730 1264 711 1185 l 815 1264 q 762 1121 806 1172 q 648 1070 718 1070 "}," ":{"x_min":0,"x_max":0,"ha":777},"ı":{"x_min":113.859375,"x_max":273.25,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 "},"Ć":{"x_min":82.03125,"x_max":834.578125,"ha":880,"o":"m 552 866 q 332 767 412 866 q 252 494 252 668 q 329 218 252 311 q 552 124 406 124 q 674 136 615 124 q 797 169 733 149 l 797 30 q 532 -14 680 -14 q 198 117 315 -14 q 82 495 82 249 q 138 766 82 650 q 302 944 195 882 q 553 1006 409 1006 q 834 942 705 1006 l 776 807 q 670 849 726 831 q 552 866 614 866 m 424 1071 l 424 1087 q 504 1193 463 1135 q 568 1293 545 1251 l 754 1293 l 754 1278 q 648 1172 718 1237 q 530 1071 578 1106 l 424 1071 "},"ä":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 191 948 q 214 1009 191 990 q 269 1028 237 1028 q 327 1006 305 1028 q 348 948 348 985 q 326 890 348 912 q 269 869 304 869 q 214 888 237 869 q 191 948 191 908 m 458 948 q 480 1009 458 990 q 536 1028 503 1028 q 593 1006 572 1028 q 615 948 615 985 q 593 890 615 911 q 536 869 570 869 q 480 888 503 869 q 458 948 458 908 "},"¹":{"x_min":56.984375,"x_max":360.84375,"ha":504,"o":"m 360 397 l 234 397 l 234 744 l 236 814 l 240 876 q 212 849 228 864 q 116 773 196 834 l 56 850 l 247 992 l 360 992 l 360 397 "},"£":{"x_min":48.84375,"x_max":752.984375,"ha":793,"o":"m 468 1004 q 722 948 599 1004 l 670 824 q 478 873 561 873 q 339 724 339 873 l 339 559 l 608 559 l 608 442 l 339 442 l 339 319 q 316 214 339 257 q 240 140 294 170 l 752 140 l 752 0 l 48 0 l 48 132 q 147 197 115 152 q 179 317 179 241 l 179 442 l 51 442 l 51 559 l 179 559 l 179 732 q 256 932 179 860 q 468 1004 333 1004 "},"ẹ":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 317 -177 q 341 -112 317 -135 q 408 -89 364 -89 q 474 -112 451 -89 q 496 -177 496 -135 q 473 -241 496 -217 q 408 -265 450 -265 q 341 -241 364 -265 q 317 -177 317 -218 "},"ů":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 598 995 q 553 883 598 926 q 435 840 509 840 q 319 882 362 840 q 275 993 275 924 q 318 1104 275 1062 q 435 1147 362 1147 q 552 1104 506 1147 q 598 995 598 1062 m 507 993 q 487 1047 507 1027 q 435 1066 467 1066 q 383 1047 404 1066 q 363 993 363 1027 q 435 922 363 922 q 487 940 467 922 q 507 993 507 959 "},"Ō":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 331 1189 l 764 1189 l 764 1071 l 331 1071 l 331 1189 "},"W":{"x_min":8.140625,"x_max":1304.5,"ha":1314,"o":"m 1046 0 l 869 0 l 701 591 q 674 703 690 630 q 654 804 658 776 q 632 692 647 761 q 607 588 617 622 l 442 0 l 266 0 l 138 496 l 8 992 l 173 992 l 315 413 q 362 168 348 274 q 385 297 370 225 q 412 412 400 368 l 573 992 l 734 992 l 900 409 q 950 168 923 329 q 999 415 960 265 l 1140 992 l 1304 992 l 1046 0 "},"ỉ":{"x_min":80.265625,"x_max":357.671875,"ha":387,"o":"m 273 0 l 113 0 l 113 750 l 273 750 l 273 0 m 357 1011 q 246 885 357 911 l 239 822 l 145 822 l 132 931 q 208 956 183 940 q 232 1002 232 973 q 158 1052 232 1052 q 80 1042 118 1052 l 80 1134 q 175 1146 126 1146 q 311 1112 264 1146 q 357 1011 357 1078 "},"Ğ":{"x_min":82.109375,"x_max":901.796875,"ha":1009,"o":"m 536 538 l 901 538 l 901 39 q 729 -1 812 10 q 551 -14 647 -14 q 204 119 326 -14 q 82 495 82 252 q 219 870 82 735 q 599 1006 357 1006 q 893 946 754 1006 l 836 811 q 595 866 715 866 q 343 767 436 866 q 251 494 251 667 q 334 217 251 312 q 574 123 417 123 q 742 142 652 123 l 742 398 l 536 398 l 536 538 m 561 1071 q 394 1125 455 1071 q 327 1277 332 1179 l 420 1277 q 438 1224 423 1244 q 480 1197 453 1205 q 564 1189 508 1189 q 670 1211 635 1189 q 709 1277 704 1234 l 803 1277 q 730 1126 795 1181 q 561 1071 665 1071 "},"v":{"x_min":0,"x_max":743,"ha":743,"o":"m 284 0 l 0 750 l 168 750 l 320 313 q 368 136 359 204 l 373 136 q 420 313 379 185 l 573 750 l 743 750 l 456 0 l 284 0 "},">":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 65 283 l 562 489 l 65 722 l 65 855 l 727 523 l 727 441 l 65 150 l 65 283 "},"Ệ":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 319 -177 q 343 -112 319 -135 q 410 -89 366 -89 q 476 -112 453 -89 q 498 -177 498 -135 q 475 -241 498 -217 q 410 -265 452 -265 q 343 -241 366 -265 q 319 -177 319 -218 m 565 1071 q 410 1192 481 1120 q 258 1071 340 1123 l 150 1071 l 150 1087 q 323 1293 280 1221 l 499 1293 q 673 1087 542 1218 l 673 1071 l 565 1071 "},"û":{"x_min":107.203125,"x_max":768.703125,"ha":882,"o":"m 643 0 l 620 97 l 612 97 q 518 15 579 45 q 377 -14 456 -14 q 174 53 241 -14 q 107 259 107 121 l 107 750 l 267 750 l 267 287 q 303 157 267 201 q 413 114 338 114 q 561 174 514 114 q 608 376 608 234 l 608 750 l 768 750 l 768 0 l 643 0 m 590 842 q 435 963 506 891 q 283 842 365 894 l 175 842 l 175 858 q 348 1064 305 992 l 524 1064 q 698 858 567 989 l 698 842 l 590 842 "},"Ź":{"x_min":44.765625,"x_max":754.234375,"ha":799,"o":"m 754 0 l 44 0 l 44 112 l 544 852 l 58 852 l 58 992 l 740 992 l 740 878 l 238 139 l 754 139 l 754 0 m 294 1071 l 294 1087 q 374 1193 333 1135 q 438 1293 415 1251 l 624 1293 l 624 1278 q 518 1172 588 1237 q 400 1071 448 1106 l 294 1071 "},"Ų":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 516 -157 q 576 -218 516 -218 q 646 -206 605 -218 l 646 -304 q 552 -318 600 -318 q 436 -279 476 -318 q 397 -176 397 -241 q 423 -90 397 -132 q 512 0 448 -48 l 613 0 q 541 -81 566 -44 q 516 -157 516 -118 "},"Ŵ":{"x_min":8.140625,"x_max":1304.5,"ha":1314,"o":"m 1046 0 l 869 0 l 701 591 q 674 703 690 630 q 654 804 658 776 q 632 692 647 761 q 607 588 617 622 l 442 0 l 266 0 l 138 496 l 8 992 l 173 992 l 315 413 q 362 168 348 274 q 385 297 370 225 q 412 412 400 368 l 573 992 l 734 992 l 900 409 q 950 168 923 329 q 999 415 960 265 l 1140 992 l 1304 992 l 1046 0 m 808 1071 q 653 1192 724 1120 q 501 1071 583 1123 l 393 1071 l 393 1087 q 566 1293 523 1221 l 742 1293 q 916 1087 785 1218 l 916 1071 l 808 1071 "},"‛":{"x_min":17.015625,"x_max":253.078125,"ha":268,"o":"m 183 992 q 253 652 206 835 l 136 652 q 66 821 100 728 q 17 977 31 914 l 26 992 l 183 992 "},"Ð":{"x_min":31.859375,"x_max":931.609375,"ha":1015,"o":"m 931 505 q 795 130 931 261 q 402 0 659 0 l 130 0 l 130 422 l 31 422 l 31 558 l 130 558 l 130 992 l 433 992 q 800 864 668 992 q 931 505 931 736 m 760 500 q 676 766 760 676 q 426 856 591 856 l 292 856 l 292 558 l 501 558 l 501 422 l 292 422 l 292 136 l 401 136 q 760 500 760 136 "},"ˉ":{"x_min":197.25,"x_max":630.390625,"ha":829,"o":"m 197 960 l 630 960 l 630 842 l 197 842 l 197 960 "},"Ĺ":{"x_min":130.921875,"x_max":712.96875,"ha":753,"o":"m 130 0 l 130 992 l 293 992 l 293 139 l 712 139 l 712 0 l 130 0 m 170 1071 l 170 1087 q 250 1193 209 1135 q 314 1293 291 1251 l 500 1293 l 500 1278 q 394 1172 464 1237 q 276 1071 324 1106 l 170 1071 "},"ỵ":{"x_min":0,"x_max":745,"ha":745,"o":"m 0 750 l 173 750 l 326 324 q 372 153 360 233 l 377 153 q 400 244 384 191 q 572 750 416 297 l 745 750 l 424 -99 q 132 -334 336 -334 q 29 -322 79 -334 l 29 -196 q 111 -204 65 -204 q 273 -70 226 -204 l 301 0 l 0 750 m 523 -178 q 547 -113 523 -136 q 614 -90 570 -90 q 680 -113 657 -90 q 702 -178 702 -136 q 679 -242 702 -218 q 614 -266 656 -266 q 547 -242 570 -266 q 523 -178 523 -219 "},"r":{"x_min":113.96875,"x_max":573.90625,"ha":599,"o":"m 494 764 q 573 757 542 764 l 558 608 q 487 616 524 616 q 332 554 392 616 q 273 392 273 491 l 273 0 l 113 0 l 113 750 l 238 750 l 259 618 l 267 618 q 365 724 305 685 q 494 764 425 764 "},"Č":{"x_min":82.03125,"x_max":834.578125,"ha":880,"o":"m 552 866 q 332 767 412 866 q 252 494 252 668 q 329 218 252 311 q 552 124 406 124 q 674 136 615 124 q 797 169 733 149 l 797 30 q 532 -14 680 -14 q 198 117 315 -14 q 82 495 82 249 q 138 766 82 650 q 302 944 195 882 q 553 1006 409 1006 q 834 942 705 1006 l 776 807 q 670 849 726 831 q 552 866 614 866 m 799 1293 l 799 1274 q 678 1144 713 1186 q 625 1071 643 1102 l 449 1071 q 276 1274 405 1142 l 276 1293 l 384 1293 q 536 1169 477 1232 q 691 1293 602 1236 l 799 1293 "},"x":{"x_min":16.953125,"x_max":747.359375,"ha":765,"o":"m 280 383 l 29 750 l 210 750 l 381 487 l 554 750 l 734 750 l 482 383 l 747 0 l 566 0 l 381 280 l 197 0 l 16 0 l 280 383 "},"è":{"x_min":69.15625,"x_max":732.875,"ha":800,"o":"m 441 -14 q 167 88 266 -14 q 69 369 69 190 q 160 658 69 553 q 412 764 252 764 q 646 673 560 764 q 732 424 732 583 l 732 338 l 233 338 q 292 170 236 229 q 448 112 347 112 q 572 124 515 112 q 695 166 629 137 l 695 36 q 577 -2 637 9 q 441 -14 517 -14 m 412 643 q 290 594 336 643 q 236 454 244 546 l 576 454 q 531 595 574 547 q 412 643 488 643 m 412 842 q 294 943 366 877 q 190 1049 223 1010 l 190 1064 l 375 1064 q 445 955 401 1016 q 520 858 490 893 l 520 842 l 412 842 "},"Ń":{"x_min":130.90625,"x_max":957.09375,"ha":1088,"o":"m 957 0 l 758 0 l 270 790 l 265 790 l 268 746 q 278 515 278 620 l 278 0 l 130 0 l 130 992 l 327 992 l 814 205 l 818 205 q 812 319 816 221 q 808 472 808 417 l 808 992 l 957 992 l 957 0 m 442 1071 l 442 1087 q 522 1193 481 1135 q 586 1293 563 1251 l 772 1293 l 772 1278 q 666 1172 736 1237 q 548 1071 596 1106 l 442 1071 "},"Ø":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 302 40 402 -14 l 238 -51 l 143 11 l 209 109 q 82 498 82 242 q 203 875 82 743 q 548 1007 324 1007 q 788 951 683 1007 l 849 1038 l 945 976 l 878 881 q 1010 496 1010 746 m 838 496 q 784 741 838 649 l 387 165 q 547 124 452 124 q 765 217 691 124 q 838 496 838 311 m 254 496 q 307 251 254 340 l 705 827 q 548 867 642 867 q 328 773 402 867 q 254 496 254 679 "},"Ỳ":{"x_min":0,"x_max":822,"ha":822,"o":"m 411 539 l 645 992 l 822 992 l 491 384 l 491 0 l 328 0 l 328 379 l 0 992 l 176 992 l 411 539 m 386 1071 q 268 1172 340 1106 q 164 1278 197 1239 l 164 1293 l 349 1293 q 419 1184 375 1245 q 494 1087 464 1122 l 494 1071 l 386 1071 "},"Ẽ":{"x_min":130.859375,"x_max":691.59375,"ha":775,"o":"m 691 0 l 130 0 l 130 992 l 691 992 l 691 855 l 292 855 l 292 585 l 666 585 l 666 449 l 292 449 l 292 137 l 691 137 l 691 0 m 511 1070 q 455 1082 482 1070 q 401 1108 427 1094 q 349 1135 374 1123 q 301 1147 324 1147 q 227 1069 246 1147 l 145 1069 q 197 1213 153 1163 q 311 1263 241 1263 q 368 1250 340 1263 q 422 1224 395 1238 q 473 1197 448 1209 q 521 1185 498 1185 q 593 1264 574 1185 l 678 1264 q 625 1121 669 1172 q 511 1070 581 1070 "},"ḿ":{"x_min":113.9375,"x_max":1219.484375,"ha":1328,"o":"m 746 0 l 586 0 l 586 462 q 553 591 586 548 q 451 633 520 633 q 316 573 359 633 q 273 373 273 513 l 273 0 l 113 0 l 113 750 l 238 750 l 261 652 l 269 652 q 359 734 300 705 q 490 764 419 764 q 719 645 663 764 l 730 645 q 824 732 763 701 q 962 764 884 764 q 1158 696 1096 764 q 1219 489 1219 628 l 1219 0 l 1060 0 l 1060 462 q 1027 591 1060 548 q 925 633 994 633 q 789 575 832 633 q 746 397 746 517 l 746 0 m 569 842 l 569 858 q 649 964 608 906 q 713 1064 690 1022 l 899 1064 l 899 1049 q 793 943 863 1008 q 675 842 723 877 l 569 842 "},"÷":{"x_min":65.125,"x_max":727.875,"ha":793,"o":"m 65 429 l 65 550 l 727 550 l 727 429 l 65 429 m 310 252 q 331 320 310 296 q 396 344 352 344 q 459 320 437 344 q 480 252 480 295 q 457 185 480 210 q 396 160 434 160 q 332 184 355 160 q 310 252 310 208 m 310 726 q 331 793 310 769 q 396 818 352 818 q 459 793 437 818 q 480 726 480 769 q 457 658 480 683 q 396 633 434 633 q 332 657 355 633 q 310 726 310 681 "},"h":{"x_min":113.984375,"x_max":774.125,"ha":882,"o":"m 774 0 l 614 0 l 614 461 q 579 591 614 548 q 468 633 544 633 q 320 573 367 633 q 273 372 273 513 l 273 0 l 113 0 l 113 1055 l 273 1055 l 273 787 q 265 650 273 723 l 275 650 q 366 734 307 704 q 501 764 424 764 q 774 489 774 764 l 774 0 "},".":{"x_min":90.234375,"x_max":291.671875,"ha":382,"o":"m 90 84 q 116 160 90 133 q 190 186 141 186 q 265 159 240 186 q 291 84 291 131 q 265 8 291 36 q 190 -20 239 -20 q 116 7 141 -20 q 90 84 90 35 "},"f":{"x_min":23.734375,"x_max":565.671875,"ha":504,"o":"m 490 629 l 307 629 l 307 0 l 147 0 l 147 629 l 23 629 l 23 703 l 147 752 l 147 801 q 209 998 147 934 q 400 1063 272 1063 q 565 1035 484 1063 l 523 914 q 411 933 464 933 q 332 899 356 933 q 307 798 307 866 l 307 750 l 490 750 l 490 629 "},"“":{"x_min":16.8125,"x_max":534.0625,"ha":551,"o":"m 298 666 q 418 992 334 804 l 534 992 q 466 652 487 791 l 308 652 l 298 666 m 16 666 q 64 818 30 723 q 136 992 99 914 l 251 992 q 182 652 208 818 l 24 652 l 16 666 "},"A":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 "},"‘":{"x_min":17.015625,"x_max":251.71875,"ha":268,"o":"m 25 652 l 17 666 q 65 818 30 723 q 136 992 99 914 l 251 992 q 183 652 208 818 l 25 652 "},"O":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 "},"Ỏ":{"x_min":82.046875,"x_max":1010.953125,"ha":1093,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 890 873 769 1007 q 1010 496 1010 739 m 254 496 q 328 219 254 313 q 547 124 402 124 q 765 217 691 124 q 838 496 838 311 q 765 773 838 679 q 548 867 692 867 q 328 773 402 867 q 254 496 254 679 m 710 1240 q 599 1114 710 1140 l 592 1051 l 498 1051 l 485 1160 q 561 1185 536 1169 q 585 1231 585 1202 q 511 1281 585 1281 q 433 1271 471 1281 l 433 1363 q 528 1375 479 1375 q 664 1341 617 1375 q 710 1240 710 1307 "},"Đ":{"x_min":31.859375,"x_max":931.609375,"ha":1015,"o":"m 931 505 q 795 130 931 261 q 402 0 659 0 l 130 0 l 130 422 l 31 422 l 31 558 l 130 558 l 130 992 l 433 992 q 800 864 668 992 q 931 505 931 736 m 760 500 q 676 766 760 676 q 426 856 591 856 l 292 856 l 292 558 l 501 558 l 501 422 l 292 422 l 292 136 l 401 136 q 760 500 760 136 "},"Ớ":{"x_min":82.09375,"x_max":1149.265625,"ha":1114,"o":"m 1010 496 q 889 120 1010 254 q 547 -14 768 -14 q 202 119 322 -14 q 82 498 82 252 q 203 875 82 743 q 548 1007 324 1007 q 897 865 776 1007 q 956 926 937 880 q 975 1055 975 971 l 1139 1055 l 1149 1040 q 1081 863 1127 926 q 957 770 1034 800 q 1010 496 1010 652 m 254 496 q 328 217 254 311 q 547 124 402 124 q 838 496 838 124 q 548 867 838 867 q 328 774 402 867 q 254 496 254 681 m 441 1071 l 441 1087 q 521 1193 480 1135 q 585 1293 562 1251 l 771 1293 l 771 1278 q 665 1172 735 1237 q 547 1071 595 1106 l 441 1071 "},"3":{"x_min":58.34375,"x_max":725.171875,"ha":793,"o":"m 696 763 q 641 606 696 669 q 486 522 586 543 l 486 516 q 665 442 605 501 q 725 284 725 382 q 624 63 725 141 q 336 -14 523 -14 q 58 39 171 -14 l 58 181 q 191 133 121 150 q 327 116 262 116 q 500 158 443 116 q 556 291 556 201 q 493 408 556 370 q 295 445 430 445 l 209 445 l 209 575 l 297 575 q 534 739 534 575 q 493 837 534 803 q 371 872 451 872 q 262 856 314 872 q 139 794 210 840 l 61 905 q 377 1006 197 1006 q 611 941 527 1006 q 696 763 696 877 "},"9":{"x_min":58.34375,"x_max":731.953125,"ha":793,"o":"m 731 567 q 613 130 731 274 q 258 -14 495 -14 q 128 -3 168 -14 l 128 130 q 250 113 189 113 q 491 200 411 113 q 578 473 570 287 l 569 473 q 473 385 529 412 q 340 358 416 358 q 133 440 208 358 q 58 665 58 522 q 145 912 58 820 q 383 1004 232 1004 q 567 952 489 1004 q 689 802 646 900 q 731 567 731 704 m 386 871 q 259 817 303 871 q 215 666 215 764 q 256 533 215 581 q 380 484 297 484 q 516 532 461 484 q 571 645 571 581 q 547 758 571 705 q 482 841 524 810 q 386 871 440 871 "},"l":{"x_min":113.859375,"x_max":273.25,"ha":387,"o":"m 273 0 l 113 0 l 113 1055 l 273 1055 l 273 0 "},"Ẫ":{"x_min":0,"x_max":918,"ha":918,"o":"m 745 0 l 646 275 l 267 275 l 170 0 l 0 0 l 370 996 l 547 996 l 918 0 l 745 0 m 604 415 l 511 685 q 483 770 501 712 q 458 856 465 829 q 404 673 440 772 l 315 415 l 604 415 m 553 1299 q 504 1308 529 1299 q 456 1328 480 1317 q 410 1349 433 1340 q 369 1359 388 1359 q 328 1345 342 1359 q 304 1298 313 1331 l 235 1298 q 276 1411 241 1368 q 366 1455 311 1455 q 417 1445 391 1455 q 466 1424 442 1435 q 511 1402 490 1412 q 551 1393 533 1393 q 592 1407 578 1393 q 616 1456 606 1422 l 684 1456 q 642 1340 677 1382 q 553 1299 607 1299 m 688 1071 l 609 1071 q 459 1178 526 1118 q 309 1071 397 1123 l 229 1071 l 229 1088 q 383 1265 343 1207 l 536 1265 q 688 1088 581 1199 l 688 1071 "},"4":{"x_min":26.453125,"x_max":768.578125,"ha":793,"o":"m 768 216 l 634 216 l 634 0 l 479 0 l 479 216 l 26 216 l 26 339 l 479 994 l 634 994 l 634 349 l 768 349 l 768 216 m 479 349 l 479 597 q 486 814 479 730 l 480 814 q 421 706 461 770 l 174 349 l 479 349 "},"Ẁ":{"x_min":8.140625,"x_max":1304.5,"ha":1314,"o":"m 1046 0 l 869 0 l 701 591 q 674 703 690 630 q 654 804 658 776 q 632 692 647 761 q 607 588 617 622 l 442 0 l 266 0 l 138 496 l 8 992 l 173 992 l 315 413 q 362 168 348 274 q 385 297 370 225 q 412 412 400 368 l 573 992 l 734 992 l 900 409 q 950 168 923 329 q 999 415 960 265 l 1140 992 l 1304 992 l 1046 0 m 646 1071 q 528 1172 600 1106 q 424 1278 457 1239 l 424 1293 l 609 1293 q 679 1184 635 1245 q 754 1087 724 1122 l 754 1071 l 646 1071 "}," ":{"x_min":0,"x_max":0,"ha":139},"Ť":{"x_min":19.671875,"x_max":764.984375,"ha":786,"o":"m 473 0 l 311 0 l 311 852 l 19 852 l 19 992 l 764 992 l 764 852 l 473 852 l 473 0 m 656 1293 l 656 1274 q 535 1144 570 1186 q 482 1071 500 1102 l 306 1071 q 133 1274 262 1142 l 133 1293 l 241 1293 q 393 1169 334 1232 q 548 1293 459 1236 l 656 1293 "},"Ś":{"x_min":67.84375,"x_max":702.9375,"ha":764,"o":"m 702 269 q 607 61 702 136 q 343 -14 511 -14 q 67 38 175 -14 l 67 191 q 212 141 135 159 q 354 123 288 123 q 496 159 450 123 q 542 258 542 196 q 500 352 542 313 q 326 444 458 391 q 135 569 190 499 q 79 739 79 640 q 167 934 79 863 q 404 1006 255 1006 q 688 943 546 1006 l 636 811 q 400 866 504 866 q 280 832 321 866 q 240 742 240 798 q 256 675 240 703 q 310 623 272 648 q 444 559 347 599 q 604 474 553 513 q 679 385 655 435 q 702 269 702 336 m 298 1071 l 298 1087 q 378 1193 337 1135 q 442 1293 419 1251 l 628 1293 l 628 1278 q 522 1172 592 1237 q 404 1071 452 1106 l 298 1071 "},"Ü":{"x_min":122.09375,"x_max":908.234375,"ha":1031,"o":"m 908 992 l 908 349 q 861 157 908 239 q 724 30 813 74 q 511 -14 635 -14 q 224 83 326 -14 q 122 352 122 181 l 122 992 l 284 992 l 284 364 q 341 182 284 241 q 516 124 398 124 q 746 365 746 124 l 746 992 l 908 992 m 301 1177 q 324 1238 301 1219 q 379 1257 347 1257 q 437 1235 415 1257 q 458 1177 458 1214 q 436 1119 458 1141 q 379 1098 414 1098 q 324 1117 347 1098 q 301 1177 301 1137 m 568 1177 q 590 1238 568 1219 q 646 1257 613 1257 q 703 1235 682 1257 q 725 1177 725 1214 q 703 1119 725 1140 q 646 1098 680 1098 q 590 1117 613 1098 q 568 1177 568 1137 "},"à":{"x_min":61.0625,"x_max":697.453125,"ha":806,"o":"m 583 0 l 551 104 l 546 104 q 436 10 491 35 q 295 -14 382 -14 q 123 45 185 -14 q 61 215 61 105 q 147 390 61 331 q 409 454 233 449 l 539 459 l 539 498 q 505 606 539 570 q 401 641 472 641 q 291 624 344 641 q 189 584 238 608 l 137 698 q 271 747 198 730 q 408 764 343 764 q 624 701 551 764 q 697 505 697 639 l 697 0 l 583 0 m 346 108 q 485 156 432 108 q 538 293 538 205 l 538 358 l 441 354 q 277 316 329 350 q 226 213 226 283 q 256 135 226 163 q 346 108 286 108 m 397 842 q 279 943 351 877 q 175 1049 208 1010 l 175 1064 l 360 1064 q 430 955 386 1016 q 505 858 475 893 l 505 842 l 397 842 "},"ó":{"x_min":69.140625,"x_max":778.859375,"ha":848,"o":"m 778 376 q 684 89 778 192 q 422 -14 590 -14 q 236 33 317 -14 q 112 169 155 81 q 69 376 69 258 q 162 661 69 558 q 426 764 256 764 q 683 659 589 764 q 778 376 778 554 m 233 376 q 425 116 233 116 q 614 376 614 116 q 423 633 614 633 q 278 567 323 633 q 233 376 233 500 m 320 842 l 320 858 q 400 964 359 906 q 464 1064 441 1022 l 650 1064 l 650 1049 q 544 943 614 1008 q 426 842 474 877 l 320 842 "},"ŗ":{"x_min":65.984375,"x_max":573.90625,"ha":599,"o":"m 494 764 q 573 757 542 764 l 558 608 q 487 616 524 616 q 332 554 392 616 q 273 392 273 491 l 273 0 l 113 0 l 113 750 l 238 750 l 259 618 l 267 618 q 365 724 305 685 q 494 764 425 764 m 65 -290 q 96 -188 81 -246 q 116 -85 110 -129 l 268 -85 l 268 -98 q 217 -210 249 -152 q 158 -307 186 -269 l 65 -307 l 65 -290 "}},"cssFontWeight":"normal","ascender":1485,"underlinePosition":-154,"cssFontStyle":"normal","boundingBox":{"yMin":-392,"xMin":-747.40625,"yMax":1456,"xMax":1669.75},"resolution":1000,"original_font_information":{"postscript_name":"OpenSans-Semibold","version_string":"Version 1.10","vendor_url":"http://www.ascendercorp.com/","full_font_name":"Open Sans Semibold","font_family_name":"Open Sans Semibold","copyright":"Digitized data copyright © 2011, Google Corporation.","description":"","trademark":"Open Sans is a trademark of Google and may be registered in certain jurisdictions.","designer":"","designer_url":"http://www.ascendercorp.com/typedesigners.html","unique_font_identifier":"Ascender - Open Sans Semibold Build 100","license_url":"http://www.apache.org/licenses/LICENSE-2.0","license_description":"Licensed under the Apache License, Version 2.0","manufacturer_name":"Ascender Corporation","font_sub_family_name":"Regular"},"descender":-407,"familyName":"Open Sans","lineHeight":1891,"underlineThickness":102});
if (_typeface_js && _typeface_js.loadFace) _typeface_js.loadFace({"glyphs":{"ợ":{"x_min":63.75,"x_max":965.109375,"ha":836,"o":"m 450 762 q 673 663 598 762 q 751 728 721 682 q 797 864 781 775 l 959 864 l 965 848 q 879 679 937 741 q 715 577 822 616 q 731 469 731 529 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 222 -192 q 248 -117 222 -145 q 322 -89 274 -89 q 380 -106 359 -89 q 402 -161 402 -124 q 375 -237 402 -209 q 304 -265 348 -265 q 245 -247 269 -265 q 222 -192 222 -230 "},"¦":{"x_min":337.75,"x_max":458.484375,"ha":765,"o":"m 337 1053 l 458 1053 l 458 514 l 337 514 l 337 1053 m 337 214 l 458 214 l 458 -326 l 337 -326 l 337 214 "},"Ẩ":{"x_min":-82.0625,"x_max":933.390625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 497 1271 l 664 1271 q 771 1086 694 1190 l 767 1071 l 686 1071 q 569 1180 624 1113 q 405 1071 482 1111 l 312 1071 l 315 1087 q 497 1271 457 1220 m 751 1206 l 758 1277 q 827 1295 805 1282 q 848 1332 848 1308 q 800 1362 848 1362 q 747 1354 769 1362 l 747 1422 q 816 1429 769 1429 q 901 1406 870 1429 q 933 1341 933 1384 q 829 1237 933 1261 l 819 1206 l 751 1206 "},"ǻ":{"x_min":63.75,"x_max":790.125,"ha":802,"o":"m 454 1181 q 532 1255 486 1209 q 602 1331 577 1301 l 790 1331 l 790 1321 q 696 1249 761 1293 q 567 1169 631 1204 l 454 1169 l 454 1181 m 657 965 q 613 854 657 896 q 495 813 569 813 q 380 854 423 813 q 337 964 337 895 q 381 1076 337 1034 q 495 1118 425 1118 q 611 1076 566 1118 q 657 965 657 1035 m 568 964 q 548 1017 568 998 q 495 1037 527 1037 q 444 1017 464 1037 q 425 964 425 998 q 442 912 425 931 q 495 893 460 893 q 548 912 527 893 q 568 964 568 931 m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 "},"Ỷ":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 671 1257 q 534 1112 671 1148 l 519 1051 l 421 1051 l 433 1163 q 520 1192 494 1174 q 545 1240 545 1211 q 484 1281 545 1281 q 409 1272 456 1281 l 409 1361 q 508 1374 450 1374 q 628 1343 585 1374 q 671 1257 671 1313 "},"Ő":{"x_min":91.5625,"x_max":1005.59375,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 437 1087 q 527 1198 482 1138 q 592 1293 572 1259 l 755 1293 l 755 1280 q 651 1174 728 1245 q 526 1071 574 1104 l 437 1071 l 437 1087 m 687 1087 q 844 1293 768 1177 l 1005 1293 l 1005 1280 q 898 1171 970 1236 q 777 1071 825 1105 l 687 1071 l 687 1087 "},"Ổ":{"x_min":91.5625,"x_max":1005.390625,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 569 1271 l 736 1271 q 843 1086 766 1190 l 839 1071 l 758 1071 q 641 1180 696 1113 q 477 1071 554 1111 l 384 1071 l 387 1087 q 569 1271 529 1220 m 823 1206 l 830 1277 q 899 1295 877 1282 q 920 1332 920 1308 q 872 1362 920 1362 q 819 1354 841 1362 l 819 1422 q 888 1429 841 1429 q 973 1406 942 1429 q 1005 1341 1005 1384 q 901 1237 1005 1261 l 891 1206 l 823 1206 "},"Ừ":{"x_min":103.09375,"x_max":1239.109375,"ha":1039,"o":"m 962 992 l 934 862 q 1022 925 991 877 q 1066 1056 1053 972 l 1232 1056 l 1239 1039 q 1123 846 1207 920 q 912 757 1039 773 l 825 343 q 683 73 786 160 q 412 -14 581 -14 q 183 59 264 -14 q 103 266 103 132 q 116 380 103 315 l 247 992 l 408 992 l 278 376 q 263 276 263 315 q 426 124 263 124 q 583 181 526 124 q 666 356 641 237 l 801 992 l 962 992 m 665 1071 l 567 1071 q 478 1173 523 1113 q 409 1278 432 1233 l 409 1293 l 576 1293 q 665 1087 607 1188 l 665 1071 "},"Ž":{"x_min":-26.453125,"x_max":804.375,"ha":741,"o":"m 611 0 l -26 0 l -4 113 l 572 851 l 166 851 l 196 992 l 804 992 l 780 875 l 202 139 l 640 139 l 611 0 m 302 1293 l 403 1293 q 513 1172 450 1253 q 674 1293 597 1243 l 784 1293 l 784 1274 q 669 1164 730 1226 q 587 1071 609 1102 l 418 1071 q 302 1274 389 1145 l 302 1293 "},"Á":{"x_min":-82.0625,"x_max":811.1875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 479 1087 q 632 1293 545 1161 l 811 1293 l 811 1280 q 704 1170 774 1235 q 585 1071 633 1106 l 479 1071 l 479 1087 "},"ĥ":{"x_min":31.875,"x_max":770.65625,"ha":819,"o":"m 476 0 l 572 456 q 584 542 584 517 q 497 633 584 633 q 355 548 421 633 q 258 316 288 464 l 191 0 l 31 0 l 255 1055 l 415 1055 l 376 877 q 326 679 358 792 l 314 628 l 319 628 q 433 732 376 700 q 554 764 491 764 q 695 711 646 764 q 744 561 744 658 q 729 443 744 509 l 634 0 l 476 0 m 770 1109 l 667 1109 q 558 1229 616 1151 q 398 1109 469 1154 l 287 1109 l 287 1125 q 423 1258 380 1212 q 484 1331 466 1303 l 652 1331 q 770 1125 678 1264 l 770 1109 "},"Î":{"x_min":47.46875,"x_max":591.65625,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 591 1071 l 488 1071 q 379 1191 437 1113 q 219 1071 290 1116 l 108 1071 l 108 1087 q 244 1220 201 1174 q 305 1293 287 1265 l 473 1293 q 591 1087 499 1226 l 591 1071 "},"e":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 "},"»":{"x_min":6.78125,"x_max":661.265625,"ha":716,"o":"m 661 345 l 392 62 l 301 142 l 495 366 l 392 617 l 514 669 l 661 360 l 661 345 m 362 359 l 101 66 l 6 142 l 197 378 l 98 617 l 219 669 l 362 376 l 362 359 "},"Ề":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 477 1271 l 644 1271 q 751 1086 674 1190 l 747 1071 l 666 1071 q 549 1180 604 1113 q 385 1071 462 1111 l 292 1071 l 295 1087 q 477 1271 437 1220 m 296 1203 q 228 1276 262 1234 q 177 1344 193 1319 l 177 1357 l 302 1357 q 335 1284 313 1326 q 371 1216 356 1241 l 371 1203 l 296 1203 "},"ļ":{"x_min":-66.734375,"x_max":415.078125,"ha":382,"o":"m 190 0 l 31 0 l 255 1055 l 415 1055 l 190 0 m -66 -288 q 24 -85 -7 -183 l 175 -85 l 175 -98 q 112 -201 155 -142 q 24 -307 68 -260 l -66 -307 l -66 -288 "},"Ĕ":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 775 1277 q 694 1121 754 1171 q 530 1071 633 1071 q 389 1115 440 1071 q 338 1239 338 1160 q 340 1277 338 1264 l 432 1277 q 457 1212 432 1234 q 541 1191 482 1191 q 632 1212 600 1191 q 675 1277 665 1234 l 775 1277 "},"ị":{"x_min":-13.9375,"x_max":405.578125,"ha":382,"o":"m 223 935 q 250 1009 223 981 q 324 1038 276 1038 q 383 1020 360 1038 q 405 965 405 1002 q 378 889 405 917 q 307 862 351 862 q 247 879 271 862 q 223 935 223 897 m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m -13 -192 q 12 -117 -13 -145 q 86 -89 38 -89 q 144 -106 123 -89 q 166 -161 166 -124 q 139 -237 166 -209 q 68 -265 112 -265 q 9 -247 33 -265 q -13 -192 -13 -230 "}," ":{"x_min":0,"x_max":0,"ha":695},"ỹ":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 517 841 q 461 852 487 841 q 413 878 436 864 q 368 904 390 892 q 325 915 347 915 q 283 897 300 915 q 254 840 266 878 l 161 840 q 334 1034 199 1034 q 392 1021 365 1034 q 441 995 418 1009 q 484 969 464 981 q 524 957 504 957 q 568 975 551 957 q 601 1035 585 993 l 694 1035 q 517 841 649 841 "},"ò":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 556 842 l 458 842 q 369 944 414 884 q 300 1049 323 1004 l 300 1064 l 467 1064 q 556 858 498 959 l 556 842 "},"ţ":{"x_min":62.390625,"x_max":545.96875,"ha":510,"o":"m 308 114 q 411 135 354 114 l 411 15 q 346 -5 387 3 q 265 -14 305 -14 q 79 153 79 -14 q 90 242 79 192 l 172 629 l 62 629 l 76 703 l 205 759 l 293 917 l 392 917 l 356 750 l 545 750 l 519 629 l 331 629 l 248 241 q 240 178 240 203 q 257 132 240 149 q 308 114 274 114 m 352 -179 q 296 -292 352 -251 q 144 -334 240 -334 q 64 -323 101 -334 l 64 -232 q 129 -241 96 -241 q 222 -176 222 -241 q 198 -134 222 -149 q 128 -113 175 -119 l 194 0 l 293 0 l 259 -65 q 330 -110 308 -81 q 352 -179 352 -139 "},"^":{"x_min":25.09375,"x_max":708.0625,"ha":725,"o":"m 25 364 l 437 997 l 523 997 l 708 364 l 583 364 l 455 832 l 161 364 l 25 364 "},"«":{"x_min":54.265625,"x_max":706.703125,"ha":716,"o":"m 54 390 l 322 675 l 413 594 l 218 369 l 322 119 l 201 68 l 54 375 l 54 390 m 352 376 l 613 670 l 706 594 l 516 356 l 616 119 l 494 68 l 352 359 l 352 376 "},"ử":{"x_min":73.921875,"x_max":1073.625,"ha":922,"o":"m 343 750 l 245 292 q 234 207 234 241 q 320 114 234 114 q 463 201 396 114 q 560 431 530 287 l 628 750 l 786 750 l 769 669 q 856 728 824 681 q 902 864 888 774 l 1068 864 l 1073 847 q 959 655 1043 728 q 747 565 875 582 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 73 186 73 89 q 91 316 73 231 l 183 750 l 343 750 m 687 1028 q 550 883 687 919 l 535 822 l 437 822 l 449 934 q 536 963 510 945 q 561 1011 561 982 q 500 1052 561 1052 q 425 1043 472 1052 l 425 1132 q 524 1145 466 1145 q 644 1114 601 1145 q 687 1028 687 1084 "},"í":{"x_min":31.875,"x_max":540.1875,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 208 858 q 361 1064 274 932 l 540 1064 l 540 1051 q 433 941 503 1006 q 314 842 362 877 l 208 842 l 208 858 "},"ˆ":{"x_min":240.09375,"x_max":723.65625,"ha":770,"o":"m 723 842 l 620 842 q 511 962 569 884 q 351 842 422 887 l 240 842 l 240 858 q 376 991 333 945 q 437 1064 419 1036 l 605 1064 q 723 858 631 997 l 723 842 "},"ū":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 328 961 l 722 961 l 697 842 l 302 842 l 328 961 "},"Ẅ":{"x_min":137.671875,"x_max":1337.453125,"ha":1213,"o":"m 893 0 l 718 0 l 693 571 l 689 696 l 691 768 l 687 768 q 608 571 655 671 l 347 0 l 173 0 l 137 992 l 293 992 l 305 415 q 297 180 305 322 l 301 180 q 397 421 357 330 l 659 992 l 812 992 l 833 422 l 835 308 l 833 180 l 838 180 q 886 314 857 240 q 927 417 914 388 l 1170 992 l 1337 992 l 893 0 m 541 1164 q 565 1231 541 1205 q 632 1257 589 1257 q 684 1241 664 1257 q 703 1192 703 1225 q 679 1123 703 1148 q 615 1098 655 1098 q 562 1113 583 1098 q 541 1164 541 1129 m 801 1164 q 825 1231 801 1205 q 891 1257 849 1257 q 943 1241 924 1257 q 963 1192 963 1225 q 939 1123 963 1148 q 875 1098 914 1098 q 822 1113 843 1098 q 801 1164 801 1129 "},"ȷ":{"x_min":-176.34375,"x_max":351.3125,"ha":382,"o":"m -76 -334 q -176 -318 -139 -334 l -176 -189 q -96 -203 -134 -203 q 18 -76 -8 -203 l 193 750 l 351 750 l 172 -95 q 85 -276 146 -219 q -76 -334 23 -334 "},"ņ":{"x_min":31.875,"x_max":744.6875,"ha":819,"o":"m 476 0 l 572 456 q 584 544 584 517 q 497 633 584 633 q 400 595 448 633 q 315 483 353 556 q 258 318 277 410 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 424 727 364 691 q 554 764 484 764 q 694 712 644 764 q 744 565 744 660 q 729 443 744 519 l 636 0 l 476 0 m 162 -288 q 253 -85 221 -183 l 404 -85 l 404 -98 q 341 -201 384 -142 q 253 -307 297 -260 l 162 -307 l 162 -288 "},"µ":{"x_min":-37.296875,"x_max":794.203125,"ha":828,"o":"m 242 207 q 265 139 242 163 q 330 114 287 114 q 472 200 406 114 q 568 429 537 285 l 637 750 l 794 750 l 634 0 l 510 0 l 524 128 l 518 128 q 414 19 467 53 q 302 -14 361 -14 q 197 41 229 -14 l 191 41 q 165 -118 185 -8 l 120 -334 l -37 -334 l 191 750 l 351 750 l 255 295 q 242 207 242 238 "},"ỳ":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 478 842 l 380 842 q 291 944 336 884 q 222 1049 245 1004 l 222 1064 l 389 1064 q 478 858 420 959 l 478 842 "},"č":{"x_min":63.75,"x_max":723.421875,"ha":647,"o":"m 343 -14 q 137 57 210 -14 q 63 263 63 129 q 113 519 63 404 q 253 699 163 634 q 458 764 343 764 q 659 722 569 764 l 612 597 q 462 633 529 633 q 292 529 360 633 q 225 271 225 425 q 263 155 225 196 q 368 114 301 114 q 462 129 418 114 q 550 166 505 144 l 550 34 q 343 -14 455 -14 m 241 1064 l 342 1064 q 452 943 389 1024 q 613 1064 536 1014 l 723 1064 l 723 1045 q 608 935 669 997 q 526 842 548 873 l 357 842 q 241 1045 328 916 l 241 1064 "},"’":{"x_min":78,"x_max":379.125,"ha":267,"o":"m 373 992 l 379 977 q 304 829 354 920 q 198 652 254 738 l 78 652 q 149 825 107 716 q 212 992 192 933 l 373 992 "},"-":{"x_min":31.875,"x_max":402.859375,"ha":440,"o":"m 31 302 l 62 440 l 402 440 l 372 302 l 31 302 "},"Q":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 875 243 963 406 q 634 17 787 79 l 813 -236 l 617 -236 l 480 -14 l 459 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 188 562 124 q 754 366 712 251 q 796 623 796 481 q 742 803 796 739 q 591 867 689 867 "},"M":{"x_min":46.125,"x_max":1197.0625,"ha":1192,"o":"m 438 0 l 360 823 l 356 823 q 319 593 350 743 l 194 0 l 46 0 l 255 992 l 474 992 l 548 212 l 552 212 l 963 992 l 1197 992 l 990 0 l 836 0 l 959 591 q 1018 823 986 717 l 1013 823 l 577 0 l 438 0 "},"œ":{"x_min":63.75,"x_max":1174,"ha":1213,"o":"m 830 -13 q 686 17 749 -13 q 591 111 623 49 q 337 -12 498 -12 q 137 66 211 -12 q 63 278 63 144 q 113 530 63 417 q 249 702 163 643 q 448 762 336 762 q 676 631 609 762 q 794 728 725 693 q 947 763 862 763 q 1114 712 1055 763 q 1174 574 1174 662 q 1061 381 1174 450 q 741 312 949 312 l 710 312 l 708 271 q 746 154 708 196 q 861 111 784 111 q 952 123 908 111 q 1072 168 996 135 l 1072 40 q 953 -1 1010 11 q 830 -13 896 -13 m 438 630 q 331 587 379 630 q 254 460 284 543 q 225 279 225 377 q 258 159 225 200 q 352 118 290 118 q 508 217 449 118 q 567 475 567 316 q 533 590 567 551 q 438 630 499 630 m 940 641 q 809 583 868 641 q 727 429 750 525 l 748 429 q 948 465 876 429 q 1019 570 1019 502 q 999 622 1019 603 q 940 641 978 641 "},"ě":{"x_min":63.75,"x_max":742.421875,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 260 1064 l 361 1064 q 471 943 408 1024 q 632 1064 555 1014 l 742 1064 l 742 1045 q 627 935 688 997 q 545 842 567 873 l 376 842 q 260 1045 347 916 l 260 1064 "},"Ộ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 310 -192 q 336 -117 310 -145 q 410 -89 362 -89 q 468 -106 447 -89 q 490 -161 490 -124 q 463 -237 490 -209 q 392 -265 436 -265 q 333 -247 357 -265 q 310 -192 310 -230 m 857 1071 l 754 1071 q 645 1191 703 1113 q 485 1071 556 1116 l 374 1071 l 374 1087 q 510 1220 467 1174 q 571 1293 553 1265 l 739 1293 q 857 1087 765 1226 l 857 1071 "},"ũ":{"x_min":75.28125,"x_max":787.1875,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 610 841 q 554 852 580 841 q 506 878 529 864 q 461 904 483 892 q 418 915 440 915 q 376 897 393 915 q 347 840 359 878 l 254 840 q 427 1034 292 1034 q 485 1021 458 1034 q 534 995 511 1009 q 577 969 557 981 q 617 957 597 957 q 661 975 644 957 q 694 1035 678 993 l 787 1035 q 610 841 742 841 "},"Ậ":{"x_min":-82.0625,"x_max":784.65625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 229 -192 q 255 -117 229 -145 q 329 -89 281 -89 q 387 -106 366 -89 q 409 -161 409 -124 q 382 -237 409 -209 q 311 -265 355 -265 q 252 -247 276 -265 q 229 -192 229 -230 m 784 1071 l 681 1071 q 572 1191 630 1113 q 412 1071 483 1116 l 301 1071 l 301 1087 q 437 1220 394 1174 q 498 1293 480 1265 l 666 1293 q 784 1087 692 1226 l 784 1071 "},"ŭ":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 744 1048 q 663 892 723 942 q 499 842 602 842 q 358 886 409 842 q 307 1010 307 931 q 309 1048 307 1035 l 401 1048 q 426 983 401 1005 q 510 962 451 962 q 601 983 569 962 q 644 1048 634 1005 l 744 1048 "},"―":{"x_min":31.875,"x_max":1296.078125,"ha":1333,"o":"m 31 307 l 61 439 l 1296 439 l 1266 307 l 31 307 "},"{":{"x_min":5.421875,"x_max":571.0625,"ha":489,"o":"m 309 -220 q 95 -59 95 -220 q 107 30 95 -18 l 137 166 q 147 233 147 211 q 5 329 147 329 l 31 456 q 161 484 113 456 q 225 582 210 513 l 265 768 q 314 905 284 859 q 396 971 345 951 q 530 992 446 992 l 571 992 l 543 867 q 448 844 478 867 q 406 765 419 821 l 359 555 q 300 440 343 482 q 179 386 257 397 l 179 382 q 287 236 287 351 q 276 153 287 210 l 247 22 q 240 -27 240 -10 q 262 -78 240 -62 q 336 -94 284 -94 l 336 -220 l 309 -220 "},"¼":{"x_min":101.109375,"x_max":1001.59375,"ha":1127,"o":"m 969 992 l 234 0 l 101 0 l 836 992 l 969 992 m 332 992 l 442 992 l 316 397 l 187 397 l 254 710 q 292 857 265 763 q 259 828 278 844 q 155 758 239 812 l 102 845 l 332 992 m 981 120 l 899 120 l 872 0 l 748 0 l 775 120 l 525 120 l 543 212 l 866 599 l 1000 599 l 918 217 l 1001 217 l 981 120 m 794 217 l 830 367 l 853 454 q 786 365 831 419 l 659 217 l 794 217 "},"#":{"x_min":34.59375,"x_max":905.421875,"ha":897,"o":"m 702 592 l 645 398 l 829 398 l 819 284 l 613 284 l 531 0 l 409 0 l 493 284 l 324 284 l 242 0 l 124 0 l 204 284 l 34 284 l 46 398 l 236 398 l 293 592 l 113 592 l 124 706 l 324 706 l 406 992 l 527 992 l 445 706 l 616 706 l 698 992 l 816 992 l 734 706 l 905 706 l 895 592 l 702 592 m 356 398 l 526 398 l 581 592 l 412 592 l 356 398 "},"Ḿ":{"x_min":46.125,"x_max":1197.0625,"ha":1192,"o":"m 438 0 l 360 823 l 356 823 q 319 593 350 743 l 194 0 l 46 0 l 255 992 l 474 992 l 548 212 l 552 212 l 963 992 l 1197 992 l 990 0 l 836 0 l 959 591 q 1018 823 986 717 l 1013 823 l 577 0 l 438 0 m 646 1089 q 799 1295 712 1163 l 978 1295 l 978 1282 q 871 1172 941 1237 q 752 1073 800 1108 l 646 1073 l 646 1089 "},"Ĳ":{"x_min":47.46875,"x_max":837.25,"ha":828,"o":"m 308 -277 q 193 -260 238 -277 l 197 -123 q 300 -137 253 -137 q 473 31 437 -137 l 675 992 l 837 992 l 630 10 q 520 -206 599 -136 q 308 -277 442 -277 m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 "},"Ê":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 766 1071 l 663 1071 q 554 1191 612 1113 q 394 1071 465 1116 l 283 1071 l 283 1087 q 419 1220 376 1174 q 480 1293 462 1265 l 648 1293 q 766 1087 674 1226 l 766 1071 "},")":{"x_min":-104.453125,"x_max":379.125,"ha":433,"o":"m 379 583 q 295 156 379 351 q 37 -220 212 -38 l -104 -220 q 233 587 233 151 q 155 992 233 809 l 279 992 q 379 583 379 812 "},"ș":{"x_min":9.5,"x_max":597.515625,"ha":625,"o":"m 530 230 q 450 49 530 112 q 227 -14 370 -14 q 9 31 99 -14 l 9 169 q 221 108 113 108 q 327 135 286 108 q 368 209 368 162 q 344 268 368 243 q 248 334 321 293 q 129 427 164 380 q 94 539 94 474 q 166 704 94 644 q 362 764 239 764 q 597 707 495 764 l 545 587 q 365 639 451 639 q 285 616 316 639 q 254 554 254 594 q 276 499 254 523 q 368 438 299 476 q 469 370 439 398 q 514 308 499 341 q 530 230 530 274 m 68 -288 q 159 -85 127 -183 l 310 -85 l 310 -98 q 247 -201 290 -142 q 159 -307 203 -260 l 68 -307 l 68 -288 "},"Å":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 704 1067 q 659 955 704 997 q 542 913 614 913 q 427 955 471 913 q 384 1066 384 996 q 429 1178 384 1136 q 542 1219 473 1219 q 658 1178 613 1219 q 704 1067 704 1137 m 615 1066 q 595 1119 615 1100 q 542 1139 574 1139 q 492 1119 512 1139 q 472 1066 472 1100 q 490 1014 472 1033 q 542 996 508 996 q 595 1014 574 996 q 615 1066 615 1033 "},"¸":{"x_min":-127.5,"x_max":160.0625,"ha":285,"o":"m 160 -179 q 104 -292 160 -251 q -47 -334 48 -334 q -127 -323 -90 -334 l -127 -232 q -62 -241 -95 -241 q 30 -176 30 -241 q 6 -134 30 -149 q -63 -113 -16 -119 l 2 0 l 101 0 l 67 -65 q 138 -110 116 -81 q 160 -179 160 -139 "},"a":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 "},"Ę":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 523 0 q 421 -98 448 -59 q 394 -172 394 -137 q 406 -205 394 -194 q 437 -216 417 -216 q 499 -207 463 -216 l 499 -302 q 406 -317 455 -317 q 307 -285 345 -317 q 270 -196 270 -253 q 302 -95 270 -141 q 416 0 334 -50 l 523 0 "},"=":{"x_min":79.359375,"x_max":714.171875,"ha":765,"o":"m 79 563 l 79 685 l 714 685 l 714 563 l 79 563 m 79 292 l 79 414 l 714 414 l 714 292 l 79 292 "},"ạ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 215 -192 q 241 -117 215 -145 q 315 -89 267 -89 q 373 -106 352 -89 q 395 -161 395 -124 q 368 -237 395 -209 q 297 -265 341 -265 q 238 -247 262 -265 q 215 -192 215 -230 "},"˚":{"x_min":366.921875,"x_max":686.359375,"ha":802,"o":"m 686 994 q 641 881 686 923 q 524 840 596 840 q 409 881 453 840 q 366 992 366 922 q 411 1104 366 1062 q 524 1146 455 1146 q 640 1104 595 1146 q 686 994 686 1063 m 597 992 q 577 1045 597 1026 q 524 1065 556 1065 q 474 1045 494 1065 q 454 992 454 1026 q 472 940 454 959 q 524 922 490 922 q 577 940 556 922 q 597 992 597 959 "},"ú":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 422 858 q 575 1064 488 932 l 754 1064 l 754 1051 q 647 941 717 1006 q 528 842 576 877 l 422 842 l 422 858 "},"¯":{"x_min":75.28125,"x_max":719.59375,"ha":612,"o":"m 691 1055 l 75 1055 l 101 1168 l 719 1168 l 691 1055 "},"Z":{"x_min":-26.453125,"x_max":804.375,"ha":741,"o":"m 611 0 l -26 0 l -4 113 l 572 851 l 166 851 l 196 992 l 804 992 l 780 875 l 202 139 l 640 139 l 611 0 "}," ":{"x_min":0,"x_max":0,"ha":232},"u":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 "},"k":{"x_min":31.875,"x_max":786.0625,"ha":733,"o":"m 601 750 l 786 750 l 458 421 l 655 0 l 478 0 l 336 319 l 244 254 l 191 0 l 31 0 l 255 1055 l 415 1055 q 306 560 323 629 q 266 406 290 490 l 269 406 l 601 750 "},"Ù":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 675 1071 l 577 1071 q 488 1173 533 1113 q 419 1278 442 1233 l 419 1293 l 586 1293 q 675 1087 617 1188 l 675 1071 "},"ẻ":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 650 1028 q 513 883 650 919 l 498 822 l 400 822 l 412 934 q 499 963 473 945 q 524 1011 524 982 q 463 1052 524 1052 q 388 1043 435 1052 l 388 1132 q 487 1145 429 1145 q 607 1114 564 1145 q 650 1028 650 1084 "},"ẵ":{"x_min":63.75,"x_max":786.484375,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 633 1076 q 583 1085 608 1076 q 534 1105 557 1094 q 488 1125 510 1116 q 447 1134 466 1134 q 378 1076 398 1134 l 298 1076 q 451 1226 332 1226 q 501 1216 475 1226 q 551 1195 527 1206 q 598 1174 576 1183 q 639 1164 621 1164 q 680 1180 665 1164 q 708 1227 694 1195 l 786 1227 q 633 1076 747 1076 m 496 842 q 350 890 401 842 q 300 1030 300 938 l 384 1030 q 417 965 388 985 q 505 945 447 945 q 598 966 564 945 q 651 1030 632 987 l 740 1030 q 655 890 717 939 q 496 842 593 842 "},"Ů":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 789 1223 q 744 1110 789 1152 q 627 1069 699 1069 q 512 1110 556 1069 q 469 1221 469 1151 q 514 1333 469 1291 q 627 1375 558 1375 q 743 1333 698 1375 q 789 1223 789 1292 m 700 1221 q 680 1274 700 1255 q 627 1294 659 1294 q 577 1274 597 1294 q 557 1221 557 1255 q 575 1169 557 1188 q 627 1151 593 1151 q 680 1169 659 1151 q 700 1221 700 1188 "},"¢":{"x_min":132.25,"x_max":727.734375,"ha":765,"o":"m 392 -14 l 286 -14 l 316 130 q 179 222 227 153 q 132 397 132 290 q 175 635 132 526 q 296 812 218 745 q 473 895 373 880 l 497 1006 l 602 1006 l 577 895 q 727 856 661 886 l 680 730 q 530 766 596 766 q 408 718 463 766 q 323 586 353 669 q 293 405 293 502 q 330 289 293 330 q 436 248 368 248 q 530 263 486 248 q 617 299 573 278 l 617 168 q 419 118 527 121 l 392 -14 "},"ữ":{"x_min":73.921875,"x_max":1073.625,"ha":922,"o":"m 343 750 l 245 292 q 234 207 234 241 q 320 114 234 114 q 463 201 396 114 q 560 431 530 287 l 628 750 l 786 750 l 769 669 q 856 728 824 681 q 902 864 888 774 l 1068 864 l 1073 847 q 959 655 1043 728 q 747 565 875 582 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 73 186 73 89 q 91 316 73 231 l 183 750 l 343 750 m 610 841 q 554 852 580 841 q 506 878 529 864 q 461 904 483 892 q 418 915 440 915 q 376 897 393 915 q 347 840 359 878 l 254 840 q 427 1034 292 1034 q 485 1021 458 1034 q 534 995 511 1009 q 577 969 557 981 q 617 957 597 957 q 661 975 644 957 q 694 1035 678 993 l 787 1035 q 610 841 742 841 "},"Ş":{"x_min":26.453125,"x_max":734.515625,"ha":717,"o":"m 630 290 q 532 66 630 147 q 262 -14 434 -14 q 26 36 120 -14 l 26 188 q 263 123 143 123 q 410 162 356 123 q 463 273 463 202 q 436 356 463 319 q 319 448 408 392 q 214 531 248 494 q 162 613 180 568 q 144 711 144 657 q 186 865 144 798 q 304 969 227 932 q 476 1006 380 1006 q 734 943 615 1006 l 676 814 q 476 866 567 866 q 357 827 402 866 q 312 723 312 787 q 322 667 312 691 q 354 622 333 643 q 445 558 375 602 q 590 430 550 492 q 630 290 630 369 m 391 -179 q 335 -292 391 -251 q 183 -334 279 -334 q 103 -323 140 -334 l 103 -232 q 168 -241 135 -241 q 261 -176 261 -241 q 237 -134 261 -149 q 167 -113 214 -119 l 233 0 l 332 0 l 298 -65 q 369 -110 347 -81 q 391 -179 391 -139 "},"é":{"x_min":63.75,"x_max":709.1875,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 377 858 q 530 1064 443 932 l 709 1064 l 709 1051 q 602 941 672 1006 q 483 842 531 877 l 377 842 l 377 858 "},"B":{"x_min":47.46875,"x_max":832.171875,"ha":846,"o":"m 527 992 q 755 934 678 992 q 832 766 832 877 q 773 601 832 667 q 611 515 714 535 l 611 510 q 724 439 684 491 q 765 315 765 388 q 663 84 765 168 q 380 0 561 0 l 47 0 l 257 992 l 527 992 m 331 582 l 466 582 q 612 623 560 582 q 663 739 663 664 q 512 856 663 856 l 389 856 l 331 582 m 236 136 l 387 136 q 543 182 486 136 q 600 314 600 228 q 559 415 600 380 q 440 450 518 450 l 304 450 l 236 136 "},"…":{"x_min":198.375,"x_max":769.53125,"ha":1108,"o":"m 565 63 q 597 153 565 119 q 686 186 629 186 q 746 165 724 186 q 769 102 769 144 q 737 14 769 49 q 652 -20 705 -20 q 586 4 608 -20 q 565 63 565 28 m 402 63 q 434 153 402 119 q 523 186 466 186 q 583 165 561 186 q 606 102 606 144 q 574 14 606 49 q 489 -20 542 -20 q 423 4 445 -20 q 402 63 402 28 m 198 63 q 230 153 198 119 q 319 186 262 186 q 379 165 357 186 q 402 102 402 144 q 370 14 402 49 q 285 -20 338 -20 q 219 4 241 -20 q 198 63 198 28 "},"Ủ":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 797 1257 q 660 1112 797 1148 l 645 1051 l 547 1051 l 559 1163 q 646 1192 620 1174 q 671 1240 671 1211 q 610 1281 671 1281 q 535 1272 582 1281 l 535 1361 q 634 1374 576 1374 q 754 1343 711 1374 q 797 1257 797 1313 "},"ē":{"x_min":63.75,"x_max":690.71875,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 296 961 l 690 961 l 665 842 l 270 842 l 296 961 "},"H":{"x_min":47.46875,"x_max":962.390625,"ha":957,"o":"m 752 0 l 591 0 l 686 446 l 302 446 l 208 0 l 47 0 l 257 992 l 417 992 l 331 586 l 715 586 l 801 992 l 962 992 l 752 0 "},"î":{"x_min":31.875,"x_max":526.65625,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 526 842 l 423 842 q 314 962 372 884 q 154 842 225 887 l 43 842 l 43 858 q 179 991 136 945 q 240 1064 222 1036 l 408 1064 q 526 858 434 997 l 526 842 "},"ư":{"x_min":73.921875,"x_max":1073.625,"ha":922,"o":"m 343 750 l 245 292 q 234 207 234 241 q 320 114 234 114 q 463 201 396 114 q 560 431 530 287 l 628 750 l 786 750 l 769 669 q 856 728 824 681 q 902 864 888 774 l 1068 864 l 1073 847 q 959 655 1043 728 q 747 565 875 582 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 73 186 73 89 q 91 316 73 231 l 183 750 l 343 750 "},"Ẹ":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 195 -192 q 221 -117 195 -145 q 295 -89 247 -89 q 353 -106 332 -89 q 375 -161 375 -124 q 348 -237 375 -209 q 277 -265 321 -265 q 218 -247 242 -265 q 195 -192 195 -230 "},"‼":{"x_min":-0.625,"x_max":774.9375,"ha":722,"o":"m 595 301 l 476 301 l 590 992 l 774 992 l 595 301 m 390 65 q 421 153 390 119 q 509 187 452 187 q 571 165 548 187 q 594 102 594 143 q 562 15 594 48 q 479 -18 530 -18 q 413 4 437 -18 q 390 65 390 27 m 204 301 l 85 301 l 199 992 l 383 992 l 204 301 m 0 65 q 30 153 0 119 q 118 187 61 187 q 180 165 157 187 q 203 102 203 143 q 171 15 203 48 q 88 -18 139 -18 q 22 4 46 -18 q 0 65 0 27 "},"ǰ":{"x_min":-176.34375,"x_max":567.421875,"ha":382,"o":"m -76 -334 q -176 -318 -139 -334 l -176 -189 q -96 -203 -134 -203 q 18 -76 -8 -203 l 193 750 l 351 750 l 172 -95 q 85 -276 146 -219 q -76 -334 23 -334 m 85 1064 l 186 1064 q 296 943 233 1024 q 457 1064 380 1014 l 567 1064 l 567 1045 q 452 935 513 997 q 370 842 392 873 l 201 842 q 85 1045 172 916 l 85 1064 "},"¥":{"x_min":71.890625,"x_max":864.0625,"ha":765,"o":"m 402 537 l 695 992 l 864 992 l 512 476 l 659 476 l 636 370 l 450 370 l 429 271 l 615 271 l 592 165 l 408 165 l 372 0 l 222 0 l 257 165 l 71 165 l 94 271 l 279 271 l 299 370 l 115 370 l 139 476 l 282 476 l 147 992 l 304 992 l 402 537 "},"Ĥ":{"x_min":47.46875,"x_max":962.390625,"ha":957,"o":"m 752 0 l 591 0 l 686 446 l 302 446 l 208 0 l 47 0 l 257 992 l 417 992 l 331 586 l 715 586 l 801 992 l 962 992 l 752 0 m 848 1071 l 745 1071 q 636 1191 694 1113 q 476 1071 547 1116 l 365 1071 l 365 1087 q 501 1220 458 1174 q 562 1293 544 1265 l 730 1293 q 848 1087 756 1226 l 848 1071 "},"U":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 "},"Ñ":{"x_min":46.125,"x_max":1018.015625,"ha":1011,"o":"m 808 0 l 632 0 l 354 789 l 349 789 l 343 742 q 319 598 326 641 q 194 0 311 555 l 46 0 l 255 992 l 437 992 l 708 212 l 712 212 q 733 342 716 249 q 760 481 750 436 l 869 992 l 1018 992 l 808 0 m 751 1070 q 695 1081 721 1070 q 647 1107 670 1093 q 602 1133 624 1121 q 559 1144 581 1144 q 517 1126 534 1144 q 488 1069 500 1107 l 395 1069 q 568 1263 433 1263 q 626 1250 599 1263 q 675 1224 652 1238 q 718 1198 698 1210 q 758 1186 738 1186 q 802 1204 785 1186 q 835 1264 819 1222 l 928 1264 q 751 1070 883 1070 "},"F":{"x_min":47.46875,"x_max":781.984375,"ha":696,"o":"m 208 0 l 47 0 l 257 992 l 781 992 l 752 852 l 388 852 l 323 545 l 663 545 l 633 407 l 294 407 l 208 0 "},"ả":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 681 1028 q 544 883 681 919 l 529 822 l 431 822 l 443 934 q 530 963 504 945 q 555 1011 555 982 q 494 1052 555 1052 q 419 1043 466 1052 l 419 1132 q 518 1145 460 1145 q 638 1114 595 1145 q 681 1028 681 1084 "},"ĵ":{"x_min":-176.34375,"x_max":521.65625,"ha":382,"o":"m -76 -334 q -176 -318 -139 -334 l -176 -189 q -96 -203 -134 -203 q 18 -76 -8 -203 l 193 750 l 351 750 l 172 -95 q 85 -276 146 -219 q -76 -334 23 -334 m 521 842 l 418 842 q 309 962 367 884 q 149 842 220 887 l 38 842 l 38 858 q 174 991 131 945 q 235 1064 217 1036 l 403 1064 q 521 858 429 997 l 521 842 "},"ā":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 317 961 l 711 961 l 686 842 l 291 842 l 317 961 "},"Ĩ":{"x_min":47.46875,"x_max":631.1875,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 454 1070 q 398 1081 424 1070 q 350 1107 373 1093 q 305 1133 327 1121 q 262 1144 284 1144 q 220 1126 237 1144 q 191 1069 203 1107 l 98 1069 q 271 1263 136 1263 q 329 1250 302 1263 q 378 1224 355 1238 q 421 1198 401 1210 q 461 1186 441 1186 q 505 1204 488 1186 q 538 1264 522 1222 l 631 1264 q 454 1070 586 1070 "},"ă":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 739 1048 q 658 892 718 942 q 494 842 597 842 q 353 886 404 842 q 302 1010 302 931 q 304 1048 302 1035 l 396 1048 q 421 983 396 1005 q 505 962 446 962 q 596 983 564 962 q 639 1048 629 1005 l 739 1048 "},"*":{"x_min":130.890625,"x_max":783.34375,"ha":761,"o":"m 588 1033 l 510 785 l 783 800 l 775 661 l 526 692 l 641 447 l 502 406 l 433 657 l 279 446 l 169 543 l 368 723 l 130 791 l 179 924 l 419 803 l 444 1063 l 588 1033 "},"†":{"x_min":137.671875,"x_max":680.9375,"ha":675,"o":"m 651 651 l 438 671 l 331 0 l 165 0 l 344 671 l 137 651 l 166 792 l 366 772 l 389 1055 l 556 1055 l 459 772 l 680 792 l 651 651 "},"ờ":{"x_min":63.75,"x_max":965.109375,"ha":836,"o":"m 450 762 q 673 663 598 762 q 751 728 721 682 q 797 864 781 775 l 959 864 l 965 848 q 879 679 937 741 q 715 577 822 616 q 731 469 731 529 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 547 842 l 449 842 q 360 944 405 884 q 291 1049 314 1004 l 291 1064 l 458 1064 q 547 858 489 959 l 547 842 "},"°":{"x_min":127.5,"x_max":573.78125,"ha":595,"o":"m 127 782 q 193 940 127 874 q 351 1006 259 1006 q 508 940 443 1006 q 573 782 573 874 q 508 625 573 689 q 351 561 443 561 q 239 590 291 561 q 157 671 187 620 q 127 782 127 722 m 230 782 q 265 699 230 734 q 351 664 301 664 q 435 699 400 664 q 470 782 470 734 q 435 867 470 832 q 351 902 400 902 q 265 867 301 902 q 230 782 230 833 "},"å":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 670 994 q 625 881 670 923 q 508 840 580 840 q 393 881 437 840 q 350 992 350 922 q 395 1104 350 1062 q 508 1146 439 1146 q 624 1104 579 1146 q 670 994 670 1063 m 581 992 q 561 1045 581 1026 q 508 1065 540 1065 q 458 1045 478 1065 q 438 992 438 1026 q 456 940 438 959 q 508 922 474 922 q 561 940 540 922 q 581 992 581 959 "},"ồ":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 424 1042 l 591 1042 q 698 857 621 961 l 694 842 l 613 842 q 496 951 551 884 q 332 842 409 882 l 239 842 l 242 858 q 424 1042 384 991 m 243 974 q 175 1047 209 1005 q 124 1115 140 1090 l 124 1128 l 249 1128 q 282 1055 260 1097 q 318 987 303 1012 l 318 974 l 243 974 "},"0":{"x_min":62.390625,"x_max":746.046875,"ha":765,"o":"m 746 686 q 692 315 746 478 q 543 69 638 152 q 323 -14 448 -14 q 127 72 191 -14 q 62 319 62 159 q 118 675 62 511 q 269 923 174 840 q 487 1007 364 1007 q 680 926 614 1007 q 746 686 746 846 m 474 873 q 352 797 408 873 q 260 585 296 721 q 223 317 223 449 q 250 169 223 220 q 337 118 276 118 q 461 195 405 118 q 551 410 517 272 q 584 691 584 548 q 474 873 584 873 "},"ō":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 298 961 l 692 961 l 667 842 l 272 842 l 298 961 "},"”":{"x_min":78,"x_max":655.84375,"ha":545,"o":"m 373 992 l 379 977 q 304 829 354 920 q 198 652 254 738 l 78 652 q 149 825 107 716 q 212 992 192 933 l 373 992 m 649 992 l 655 977 q 473 652 589 827 l 354 652 q 427 829 388 729 q 489 992 467 928 l 649 992 "},"ŵ":{"x_min":82.0625,"x_max":1105.5,"ha":1044,"o":"m 572 0 l 559 425 l 558 472 l 560 608 q 525 523 543 566 q 291 0 507 480 l 113 0 l 82 750 l 231 750 l 240 311 q 233 145 239 252 l 237 145 q 311 330 282 265 l 499 750 l 672 750 l 685 340 l 685 304 l 683 145 l 687 145 q 726 253 699 179 q 769 364 753 326 q 940 750 785 401 l 1105 750 l 754 0 l 572 0 m 833 842 l 730 842 q 621 962 679 884 q 461 842 532 887 l 350 842 l 350 858 q 486 991 443 945 q 547 1064 529 1036 l 715 1064 q 833 858 741 997 l 833 842 "},"Ķ":{"x_min":47.46875,"x_max":937.296875,"ha":813,"o":"m 737 0 l 559 0 l 388 444 l 287 376 l 208 0 l 47 0 l 257 992 l 417 992 l 315 512 l 411 625 l 744 992 l 937 992 l 519 538 l 737 0 m 204 -288 q 295 -85 263 -183 l 446 -85 l 446 -98 q 383 -201 426 -142 q 295 -307 339 -260 l 204 -307 l 204 -288 "},"ö":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 276 935 q 300 1002 276 976 q 367 1028 324 1028 q 419 1012 399 1028 q 438 963 438 996 q 414 894 438 919 q 350 869 390 869 q 297 884 318 869 q 276 935 276 900 m 536 935 q 560 1002 536 976 q 626 1028 584 1028 q 678 1012 659 1028 q 698 963 698 996 q 674 894 698 919 q 610 869 649 869 q 557 884 578 869 q 536 935 536 900 "},"ǽ":{"x_min":63.75,"x_max":1138.734375,"ha":1171,"o":"m 804 -14 q 597 79 653 -14 l 581 0 l 479 0 l 493 119 l 487 119 q 375 16 430 47 q 257 -14 320 -14 q 114 55 166 -14 q 63 248 63 125 q 110 505 63 385 q 238 694 157 625 q 415 764 319 764 q 518 734 474 764 q 591 643 561 704 l 597 643 l 640 750 l 740 750 l 723 671 q 812 738 758 713 q 934 764 866 764 q 1084 712 1029 764 q 1138 575 1138 660 q 1025 381 1138 451 q 704 312 912 312 l 673 312 l 670 271 q 711 151 670 192 q 830 110 752 110 q 1037 167 915 110 l 1037 39 q 804 -14 918 -14 m 315 114 q 425 169 373 114 q 510 315 478 224 q 543 497 543 407 q 517 596 543 559 q 440 633 491 633 q 331 579 382 633 q 253 436 281 525 q 225 252 225 347 q 250 148 225 181 q 315 114 275 114 m 904 641 q 776 583 834 641 q 693 429 718 524 l 714 429 q 912 465 841 429 q 984 567 984 501 q 961 624 984 606 q 904 641 938 641 m 633 858 q 786 1064 699 932 l 965 1064 l 965 1051 q 858 941 928 1006 q 739 842 787 877 l 633 842 l 633 858 "},"Ļ":{"x_min":47.46875,"x_max":602.9375,"ha":689,"o":"m 47 0 l 257 992 l 417 992 l 237 139 l 602 139 l 573 0 l 47 0 m 169 -288 q 260 -85 228 -183 l 411 -85 l 411 -98 q 348 -201 391 -142 q 260 -307 304 -260 l 169 -307 l 169 -288 "},"Õ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 724 1070 q 668 1081 694 1070 q 620 1107 643 1093 q 575 1133 597 1121 q 532 1144 554 1144 q 490 1126 507 1144 q 461 1069 473 1107 l 368 1069 q 541 1263 406 1263 q 599 1250 572 1263 q 648 1224 625 1238 q 691 1198 671 1210 q 731 1186 711 1186 q 775 1204 758 1186 q 808 1264 792 1222 l 901 1264 q 724 1070 856 1070 "},"ć":{"x_min":63.75,"x_max":708.1875,"ha":647,"o":"m 343 -14 q 137 57 210 -14 q 63 263 63 129 q 113 519 63 404 q 253 699 163 634 q 458 764 343 764 q 659 722 569 764 l 612 597 q 462 633 529 633 q 292 529 360 633 q 225 271 225 425 q 263 155 225 196 q 368 114 301 114 q 462 129 418 114 q 550 166 505 144 l 550 34 q 343 -14 455 -14 m 376 858 q 529 1064 442 932 l 708 1064 l 708 1051 q 601 941 671 1006 q 482 842 530 877 l 376 842 l 376 858 "},"þ":{"x_min":-37.296875,"x_max":748.765625,"ha":814,"o":"m 397 -14 q 285 16 333 -14 q 208 105 237 47 l 202 105 q 185 -19 198 43 l 120 -334 l -37 -334 l 255 1055 l 415 1055 q 365 825 382 903 q 314 628 348 746 l 319 628 q 541 764 424 764 q 694 694 639 764 q 748 499 748 625 q 702 240 748 361 q 577 53 656 120 q 397 -14 498 -14 m 479 633 q 368 578 422 633 q 282 433 315 523 q 250 252 250 343 q 281 150 250 186 q 370 114 312 114 q 479 167 429 114 q 558 309 529 219 q 587 497 587 398 q 559 599 587 565 q 479 633 531 633 "},"]":{"x_min":-96.984375,"x_max":451.703125,"ha":428,"o":"m -71 -99 l 76 -99 l 283 872 l 133 872 l 160 992 l 451 992 l 193 -220 l -96 -220 l -71 -99 "},"′":{"x_min":144.46875,"x_max":349.96875,"ha":328,"o":"m 349 992 l 247 634 l 144 634 l 193 992 l 349 992 "},"ẁ":{"x_min":82.0625,"x_max":1105.5,"ha":1044,"o":"m 572 0 l 559 425 l 558 472 l 560 608 q 525 523 543 566 q 291 0 507 480 l 113 0 l 82 750 l 231 750 l 240 311 q 233 145 239 252 l 237 145 q 311 330 282 265 l 499 750 l 672 750 l 685 340 l 685 304 l 683 145 l 687 145 q 726 253 699 179 q 769 364 753 326 q 940 750 785 401 l 1105 750 l 754 0 l 572 0 m 669 842 l 571 842 q 482 944 527 884 q 413 1049 436 1004 l 413 1064 l 580 1064 q 669 858 611 959 l 669 842 "},"ệ":{"x_min":63.75,"x_max":699.65625,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 193 -192 q 219 -117 193 -145 q 293 -89 245 -89 q 351 -106 330 -89 q 373 -161 373 -124 q 346 -237 373 -209 q 275 -265 319 -265 q 216 -247 240 -265 q 193 -192 193 -230 m 699 842 l 596 842 q 487 962 545 884 q 327 842 398 887 l 216 842 l 216 858 q 352 991 309 945 q 413 1064 395 1036 l 581 1064 q 699 858 607 997 l 699 842 "},"ĭ":{"x_min":31.875,"x_max":535.6875,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 535 1048 q 454 892 514 942 q 290 842 393 842 q 149 886 200 842 q 98 1010 98 931 q 100 1048 98 1035 l 192 1048 q 217 983 192 1005 q 301 962 242 962 q 392 983 360 962 q 435 1048 425 1005 l 535 1048 "},"8":{"x_min":51.546875,"x_max":758.25,"ha":765,"o":"m 495 1007 q 687 946 617 1007 q 758 784 758 886 q 704 628 758 694 q 536 517 651 562 q 653 405 617 464 q 689 268 689 346 q 647 122 689 186 q 528 21 605 57 q 344 -14 451 -14 q 129 53 206 -14 q 51 235 51 121 q 301 528 51 437 q 212 627 239 576 q 185 736 185 677 q 271 932 185 858 q 495 1007 358 1007 m 402 455 q 256 369 301 418 q 210 249 210 320 q 250 148 210 186 q 358 110 290 110 q 483 154 436 110 q 530 267 530 197 q 497 374 530 329 q 402 455 464 419 m 482 881 q 380 843 419 881 q 341 743 341 805 q 368 650 341 686 q 438 587 394 613 q 559 658 516 616 q 601 764 601 700 q 569 850 601 819 q 482 881 536 881 "},"Ữ":{"x_min":103.09375,"x_max":1239.109375,"ha":1039,"o":"m 962 992 l 934 862 q 1022 925 991 877 q 1066 1056 1053 972 l 1232 1056 l 1239 1039 q 1123 846 1207 920 q 912 757 1039 773 l 825 343 q 683 73 786 160 q 412 -14 581 -14 q 183 59 264 -14 q 103 266 103 132 q 116 380 103 315 l 247 992 l 408 992 l 278 376 q 263 276 263 315 q 426 124 263 124 q 583 181 526 124 q 666 356 641 237 l 801 992 l 962 992 m 717 1070 q 661 1081 687 1070 q 613 1107 636 1093 q 568 1133 590 1121 q 525 1144 547 1144 q 483 1126 500 1144 q 454 1069 466 1107 l 361 1069 q 534 1263 399 1263 q 592 1250 565 1263 q 641 1224 618 1238 q 684 1198 664 1210 q 724 1186 704 1186 q 768 1204 751 1186 q 801 1264 785 1222 l 894 1264 q 717 1070 849 1070 "},"R":{"x_min":47.46875,"x_max":798.953125,"ha":818,"o":"m 291 396 l 208 0 l 47 0 l 257 992 l 486 992 q 718 927 637 992 q 798 730 798 863 q 740 542 798 619 q 565 429 681 465 l 734 0 l 558 0 l 417 396 l 291 396 m 320 531 l 404 531 q 576 581 519 531 q 633 721 633 632 q 593 823 633 792 q 469 855 553 855 l 388 855 l 320 531 "},"ť":{"x_min":62.390625,"x_max":717.984375,"ha":510,"o":"m 308 114 q 411 135 354 114 l 411 15 q 346 -5 387 3 q 265 -14 305 -14 q 79 153 79 -14 q 90 242 79 192 l 172 629 l 62 629 l 76 703 l 205 759 l 293 917 l 392 917 l 356 750 l 545 750 l 519 629 l 331 629 l 248 241 q 240 178 240 203 q 257 132 240 149 q 308 114 274 114 m 475 856 q 568 1061 529 954 l 717 1061 l 717 1047 q 649 937 695 1000 q 566 839 603 874 l 475 839 l 475 856 "},"Ľ":{"x_min":47.46875,"x_max":761.984375,"ha":689,"o":"m 47 0 l 257 992 l 417 992 l 237 139 l 602 139 l 573 0 l 47 0 m 519 788 q 612 993 573 886 l 761 993 l 761 979 q 693 869 739 932 q 610 771 647 806 l 519 771 l 519 788 "},"Ż":{"x_min":-26.453125,"x_max":804.375,"ha":741,"o":"m 611 0 l -26 0 l -4 113 l 572 851 l 166 851 l 196 992 l 804 992 l 780 875 l 202 139 l 640 139 l 611 0 m 425 1163 q 451 1237 425 1209 q 526 1266 478 1266 q 584 1248 562 1266 q 607 1193 607 1230 q 579 1117 607 1145 q 508 1090 552 1090 q 449 1107 472 1090 q 425 1163 425 1125 "},"o":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 "},"5":{"x_min":35.953125,"x_max":754.1875,"ha":765,"o":"m 413 615 q 609 544 536 615 q 682 351 682 474 q 634 159 682 241 q 496 31 587 76 q 276 -14 405 -14 q 35 39 131 -14 l 35 186 q 267 118 149 118 q 451 175 385 118 q 516 331 516 231 q 474 445 516 402 q 347 488 432 488 q 194 465 282 488 l 134 511 l 270 992 l 754 992 l 723 850 l 380 850 l 308 602 q 413 615 371 615 "},"ħ":{"x_min":31.875,"x_max":737.234375,"ha":819,"o":"m 476 0 l 568 430 q 579 516 579 478 q 497 605 579 605 q 397 566 447 605 q 309 456 347 527 q 252 292 271 385 l 191 0 l 31 0 l 208 826 l 101 826 l 126 937 l 230 937 l 255 1055 l 415 1055 l 389 937 l 609 937 l 585 826 l 366 826 l 309 604 l 315 604 q 428 707 371 675 q 548 739 485 739 q 737 526 737 739 q 723 417 737 488 l 634 0 l 476 0 "},"õ":{"x_min":63.75,"x_max":755.1875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 578 841 q 522 852 548 841 q 474 878 497 864 q 429 904 451 892 q 386 915 408 915 q 344 897 361 915 q 315 840 327 878 l 222 840 q 395 1034 260 1034 q 453 1021 426 1034 q 502 995 479 1009 q 545 969 525 981 q 585 957 565 957 q 629 975 612 957 q 662 1035 646 993 l 755 1035 q 578 841 710 841 "},"ẫ":{"x_min":63.75,"x_max":786.546875,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 632 1070 q 579 1079 604 1070 q 531 1099 554 1088 q 486 1120 507 1111 q 444 1130 465 1130 q 402 1113 416 1130 q 376 1069 387 1096 l 296 1069 q 352 1186 313 1147 q 450 1226 392 1226 q 501 1216 476 1226 q 550 1195 526 1206 q 595 1173 573 1183 q 638 1164 617 1164 q 679 1179 663 1164 q 708 1227 694 1194 l 786 1227 q 632 1070 747 1070 m 436 1037 l 603 1037 q 713 857 626 974 l 709 842 l 628 842 q 508 945 568 882 q 349 842 423 882 l 254 842 l 257 858 l 300 899 q 436 1037 396 985 "},",":{"x_min":-69.171875,"x_max":231.953125,"ha":359,"o":"m 226 161 l 231 145 q 51 -179 147 -30 l -69 -179 q 66 161 2 -17 l 226 161 "},"d":{"x_min":63.75,"x_max":844.390625,"ha":813,"o":"m 422 764 q 604 643 543 764 l 609 643 q 634 812 618 742 l 686 1055 l 844 1055 l 620 0 l 495 0 l 508 119 l 503 119 q 388 16 444 47 q 270 -14 333 -14 q 118 54 173 -14 q 63 250 63 123 q 112 510 63 389 q 242 697 160 630 q 422 764 323 764 m 331 114 q 441 170 387 114 q 529 315 496 226 q 562 497 562 405 q 532 596 562 559 q 442 633 503 633 q 335 581 385 633 q 255 438 284 529 q 225 252 225 347 q 331 114 225 114 "},"\"":{"x_min":144.46875,"x_max":605.65625,"ha":582,"o":"m 349 992 l 247 634 l 144 634 l 193 992 l 349 992 m 605 992 l 502 634 l 398 634 l 448 992 l 605 992 "},"˙":{"x_min":218.390625,"x_max":400.15625,"ha":375,"o":"m 218 934 q 244 1008 218 980 q 319 1037 271 1037 q 377 1019 355 1037 q 400 964 400 1001 q 372 888 400 916 q 301 861 345 861 q 242 878 265 861 q 218 934 218 896 "},"ê":{"x_min":63.75,"x_max":700.65625,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 700 842 l 597 842 q 488 962 546 884 q 328 842 399 887 l 217 842 l 217 858 q 353 991 310 945 q 414 1064 396 1036 l 582 1064 q 700 858 608 997 l 700 842 "},"″":{"x_min":144.46875,"x_max":605.65625,"ha":582,"o":"m 349 992 l 247 634 l 144 634 l 193 992 l 349 992 m 605 992 l 502 634 l 398 634 l 448 992 l 605 992 "},"„":{"x_min":-69.171875,"x_max":508.671875,"ha":636,"o":"m 226 161 l 231 145 q 51 -179 158 -12 l -69 -179 q 66 161 2 -17 l 226 161 m 502 161 l 508 145 q 327 -179 446 5 l 208 -179 q 343 161 289 11 l 502 161 "},"ľ":{"x_min":31.875,"x_max":674.984375,"ha":382,"o":"m 190 0 l 31 0 l 255 1055 l 415 1055 l 190 0 m 432 851 q 525 1056 486 949 l 674 1056 l 674 1042 q 606 932 652 995 q 523 834 560 869 l 432 834 l 432 851 "},"Â":{"x_min":-82.0625,"x_max":784.65625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 784 1071 l 681 1071 q 572 1191 630 1113 q 412 1071 483 1116 l 301 1071 l 301 1087 q 437 1220 394 1174 q 498 1293 480 1265 l 666 1293 q 784 1087 692 1226 l 784 1071 "},"Į":{"x_min":-51.515625,"x_max":417.78125,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 201 0 q 99 -98 126 -59 q 72 -172 72 -137 q 84 -205 72 -194 q 115 -216 95 -216 q 177 -207 141 -216 l 177 -302 q 84 -317 133 -317 q -14 -285 23 -317 q -51 -196 -51 -253 q -19 -95 -51 -141 q 94 0 12 -50 l 201 0 "},"ė":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 390 934 q 416 1008 390 980 q 491 1037 443 1037 q 549 1019 527 1037 q 572 964 572 1001 q 544 888 572 916 q 473 861 517 861 q 414 878 437 861 q 390 934 390 896 "},"ề":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 415 1042 l 582 1042 q 689 857 612 961 l 685 842 l 604 842 q 487 951 542 884 q 323 842 400 882 l 230 842 l 233 858 q 415 1042 375 991 m 234 974 q 166 1047 200 1005 q 115 1115 131 1090 l 115 1128 l 240 1128 q 273 1055 251 1097 q 309 987 294 1012 l 309 974 l 234 974 "},"Ţ":{"x_min":99.5,"x_max":826.75,"ha":714,"o":"m 358 0 l 197 0 l 376 852 l 119 852 l 149 992 l 826 992 l 797 852 l 539 852 l 358 0 m 387 -179 q 331 -292 387 -251 q 179 -334 275 -334 q 99 -323 136 -334 l 99 -232 q 164 -241 131 -241 q 257 -176 257 -241 q 233 -134 257 -149 q 163 -113 210 -119 l 229 0 l 328 0 l 294 -65 q 365 -110 343 -81 q 387 -179 387 -139 "},"Í":{"x_min":47.46875,"x_max":613.1875,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 281 1087 q 434 1293 347 1161 l 613 1293 l 613 1280 q 506 1170 576 1235 q 387 1071 435 1106 l 281 1071 l 281 1087 "},"´":{"x_min":344.53125,"x_max":676.1875,"ha":770,"o":"m 344 858 q 497 1064 410 932 l 676 1064 l 676 1051 q 569 941 639 1006 q 450 842 498 877 l 344 842 l 344 858 "},"Ơ":{"x_min":91.5625,"x_max":1186.21875,"ha":1032,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 902 862 809 1007 q 977 935 951 887 q 1013 1055 1003 983 l 1180 1055 l 1186 1038 q 1098 872 1158 935 q 942 770 1038 808 q 963 625 963 701 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 "},"Ú":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 536 1087 q 689 1293 602 1161 l 868 1293 l 868 1280 q 761 1170 831 1235 q 642 1071 690 1106 l 536 1071 l 536 1087 "}," ":{"x_min":0,"x_max":0,"ha":278},"Ŷ":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 724 1071 l 621 1071 q 512 1191 570 1113 q 352 1071 423 1116 l 241 1071 l 241 1087 q 377 1220 334 1174 q 438 1293 420 1265 l 606 1293 q 724 1087 632 1226 l 724 1071 "},"ỏ":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 662 1028 q 525 883 662 919 l 510 822 l 412 822 l 424 934 q 511 963 485 945 q 536 1011 536 982 q 475 1052 536 1052 q 400 1043 447 1052 l 400 1132 q 499 1145 441 1145 q 619 1114 576 1145 q 662 1028 662 1084 "},"Ự":{"x_min":103.09375,"x_max":1239.109375,"ha":1039,"o":"m 962 992 l 934 862 q 1022 925 991 877 q 1066 1056 1053 972 l 1232 1056 l 1239 1039 q 1123 846 1207 920 q 912 757 1039 773 l 825 343 q 683 73 786 160 q 412 -14 581 -14 q 183 59 264 -14 q 103 266 103 132 q 116 380 103 315 l 247 992 l 408 992 l 278 376 q 263 276 263 315 q 426 124 263 124 q 583 181 526 124 q 666 356 641 237 l 801 992 l 962 992 m 290 -192 q 316 -117 290 -145 q 390 -89 342 -89 q 448 -106 427 -89 q 470 -161 470 -124 q 443 -237 470 -209 q 372 -265 416 -265 q 313 -247 337 -265 q 290 -192 290 -230 "},"ŝ":{"x_min":9.5,"x_max":621.65625,"ha":625,"o":"m 530 230 q 450 49 530 112 q 227 -14 370 -14 q 9 31 99 -14 l 9 169 q 221 108 113 108 q 327 135 286 108 q 368 209 368 162 q 344 268 368 243 q 248 334 321 293 q 129 427 164 380 q 94 539 94 474 q 166 704 94 644 q 362 764 239 764 q 597 707 495 764 l 545 587 q 365 639 451 639 q 285 616 316 639 q 254 554 254 594 q 276 499 254 523 q 368 438 299 476 q 469 370 439 398 q 514 308 499 341 q 530 230 530 274 m 621 842 l 518 842 q 409 962 467 884 q 249 842 320 887 l 138 842 l 138 858 q 274 991 231 945 q 335 1064 317 1036 l 503 1064 q 621 858 529 997 l 621 842 "},"Ý":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 413 1087 q 566 1293 479 1161 l 745 1293 l 745 1280 q 638 1170 708 1235 q 519 1071 567 1106 l 413 1071 l 413 1087 "},"Ĉ":{"x_min":91.5625,"x_max":890.5,"ha":831,"o":"m 626 866 q 440 806 522 866 q 308 630 358 746 q 259 376 259 514 q 315 189 259 254 q 480 124 371 124 q 704 170 576 124 l 704 31 q 450 -14 581 -14 q 186 86 282 -14 q 91 369 91 187 q 163 697 91 545 q 354 927 234 848 q 626 1006 473 1006 q 890 943 773 1006 l 826 811 q 735 850 784 834 q 626 866 687 866 m 854 1071 l 751 1071 q 642 1191 700 1113 q 482 1071 553 1116 l 371 1071 l 371 1087 q 507 1220 464 1174 q 568 1293 550 1265 l 736 1293 q 854 1087 762 1226 l 854 1071 "}," ":{"x_min":0,"x_max":0,"ha":1389},"ą":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 602 0 q 500 -98 527 -59 q 473 -172 473 -137 q 485 -205 473 -194 q 516 -216 496 -216 q 578 -207 542 -216 l 578 -302 q 485 -317 534 -317 q 386 -285 424 -317 q 349 -196 349 -253 q 381 -95 349 -141 q 495 0 413 -50 l 602 0 "},"Ờ":{"x_min":91.5625,"x_max":1186.21875,"ha":1032,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 902 862 809 1007 q 977 935 951 887 q 1013 1055 1003 983 l 1180 1055 l 1186 1038 q 1098 872 1158 935 q 942 770 1038 808 q 963 625 963 701 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 697 1071 l 599 1071 q 510 1173 555 1113 q 441 1278 464 1233 l 441 1293 l 608 1293 q 697 1087 639 1188 l 697 1071 "},"​":{"x_min":0,"x_max":0,"ha":0},"Ö":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 422 1164 q 446 1231 422 1205 q 513 1257 470 1257 q 565 1241 545 1257 q 584 1192 584 1225 q 560 1123 584 1148 q 496 1098 536 1098 q 443 1113 464 1098 q 422 1164 422 1129 m 682 1164 q 706 1231 682 1205 q 772 1257 730 1257 q 824 1241 805 1257 q 844 1192 844 1225 q 820 1123 844 1148 q 756 1098 795 1098 q 703 1113 724 1098 q 682 1164 682 1129 "},"z":{"x_min":-26.453125,"x_max":630.75,"ha":624,"o":"m 487 0 l -26 0 l -6 99 l 423 629 l 126 629 l 152 750 l 630 750 l 605 634 l 183 120 l 512 120 l 487 0 "},"ặ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 747 1048 q 666 892 726 942 q 502 842 605 842 q 361 886 412 842 q 310 1010 310 931 q 312 1048 310 1035 l 404 1048 q 429 983 404 1005 q 513 962 454 962 q 604 983 572 962 q 647 1048 637 1005 l 747 1048 m 215 -192 q 241 -117 215 -145 q 315 -89 267 -89 q 373 -106 352 -89 q 395 -161 395 -124 q 368 -237 395 -209 q 297 -265 341 -265 q 238 -247 262 -265 q 215 -192 215 -230 "},"Ř":{"x_min":47.46875,"x_max":807.421875,"ha":818,"o":"m 291 396 l 208 0 l 47 0 l 257 992 l 486 992 q 718 927 637 992 q 798 730 798 863 q 740 542 798 619 q 565 429 681 465 l 734 0 l 558 0 l 417 396 l 291 396 m 320 531 l 404 531 q 576 581 519 531 q 633 721 633 632 q 593 823 633 792 q 469 855 553 855 l 388 855 l 320 531 m 325 1293 l 426 1293 q 536 1172 473 1253 q 697 1293 620 1243 l 807 1293 l 807 1274 q 692 1164 753 1226 q 610 1071 632 1102 l 441 1071 q 325 1274 412 1145 l 325 1293 "},"Ắ":{"x_min":-82.0625,"x_max":815.078125,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 568 1071 q 425 1121 476 1071 q 373 1259 373 1171 l 374 1272 l 459 1272 q 495 1197 466 1220 q 577 1174 525 1174 q 726 1272 684 1174 l 815 1272 q 728 1123 791 1175 q 568 1071 666 1071 m 536 1261 q 651 1402 600 1321 l 783 1402 l 783 1390 q 704 1320 762 1367 q 604 1247 647 1273 l 536 1247 l 536 1261 "},"ã":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 589 841 q 533 852 559 841 q 485 878 508 864 q 440 904 462 892 q 397 915 419 915 q 355 897 372 915 q 326 840 338 878 l 233 840 q 406 1034 271 1034 q 464 1021 437 1034 q 513 995 490 1009 q 556 969 536 981 q 596 957 576 957 q 640 975 623 957 q 673 1035 657 993 l 766 1035 q 589 841 721 841 "},"Ň":{"x_min":46.125,"x_max":1018.015625,"ha":1011,"o":"m 808 0 l 632 0 l 354 789 l 349 789 l 343 742 q 319 598 326 641 q 194 0 311 555 l 46 0 l 255 992 l 437 992 l 708 212 l 712 212 q 733 342 716 249 q 760 481 750 436 l 869 992 l 1018 992 l 808 0 m 430 1293 l 531 1293 q 641 1172 578 1253 q 802 1293 725 1243 l 912 1293 l 912 1274 q 797 1164 858 1226 q 715 1071 737 1102 l 546 1071 q 430 1274 517 1145 l 430 1293 "},"æ":{"x_min":63.75,"x_max":1138.734375,"ha":1171,"o":"m 804 -14 q 597 79 653 -14 l 581 0 l 479 0 l 493 119 l 487 119 q 375 16 430 47 q 257 -14 320 -14 q 114 55 166 -14 q 63 248 63 125 q 110 505 63 385 q 238 694 157 625 q 415 764 319 764 q 518 734 474 764 q 591 643 561 704 l 597 643 l 640 750 l 740 750 l 723 671 q 812 738 758 713 q 934 764 866 764 q 1084 712 1029 764 q 1138 575 1138 660 q 1025 381 1138 451 q 704 312 912 312 l 673 312 l 670 271 q 711 151 670 192 q 830 110 752 110 q 1037 167 915 110 l 1037 39 q 804 -14 918 -14 m 315 114 q 425 169 373 114 q 510 315 478 224 q 543 497 543 407 q 517 596 543 559 q 440 633 491 633 q 331 579 382 633 q 253 436 281 525 q 225 252 225 347 q 250 148 225 181 q 315 114 275 114 m 904 641 q 776 583 834 641 q 693 429 718 524 l 714 429 q 912 465 841 429 q 984 567 984 501 q 961 624 984 606 q 904 641 938 641 "},"ừ":{"x_min":73.921875,"x_max":1073.625,"ha":922,"o":"m 343 750 l 245 292 q 234 207 234 241 q 320 114 234 114 q 463 201 396 114 q 560 431 530 287 l 628 750 l 786 750 l 769 669 q 856 728 824 681 q 902 864 888 774 l 1068 864 l 1073 847 q 959 655 1043 728 q 747 565 875 582 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 73 186 73 89 q 91 316 73 231 l 183 750 l 343 750 m 554 842 l 456 842 q 367 944 412 884 q 298 1049 321 1004 l 298 1064 l 465 1064 q 554 858 496 959 l 554 842 "},"Ợ":{"x_min":91.5625,"x_max":1186.21875,"ha":1032,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 902 862 809 1007 q 977 935 951 887 q 1013 1055 1003 983 l 1180 1055 l 1186 1038 q 1098 872 1158 935 q 942 770 1038 808 q 963 625 963 701 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 310 -192 q 336 -117 310 -145 q 410 -89 362 -89 q 468 -106 447 -89 q 490 -161 490 -124 q 463 -237 490 -209 q 392 -265 436 -265 q 333 -247 357 -265 q 310 -192 310 -230 "},"ĩ":{"x_min":31.875,"x_max":573.1875,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 396 841 q 340 852 366 841 q 292 878 315 864 q 247 904 269 892 q 204 915 226 915 q 162 897 179 915 q 133 840 145 878 l 40 840 q 213 1034 78 1034 q 271 1021 244 1034 q 320 995 297 1009 q 363 969 343 981 q 403 957 383 957 q 447 975 430 957 q 480 1035 464 993 l 573 1035 q 396 841 528 841 "},"É":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 429 1087 q 582 1293 495 1161 l 761 1293 l 761 1280 q 654 1170 724 1235 q 535 1071 583 1106 l 429 1071 l 429 1087 "},"ŀ":{"x_min":31.875,"x_max":555.15625,"ha":497,"o":"m 190 0 l 31 0 l 255 1055 l 415 1055 l 190 0 m 373 476 q 399 550 373 522 q 474 579 426 579 q 532 561 510 579 q 555 506 555 543 q 527 430 555 458 q 456 403 500 403 q 397 420 420 403 q 373 476 373 438 "},"~":{"x_min":75.28125,"x_max":723.65625,"ha":765,"o":"m 233 469 q 157 448 198 469 q 75 387 115 427 l 75 516 q 244 590 143 590 q 324 581 287 590 q 423 547 361 573 q 501 518 471 526 q 565 509 532 509 q 641 530 599 509 q 723 591 684 551 l 723 462 q 554 387 653 387 q 470 398 511 387 q 376 431 428 409 q 295 461 324 453 q 233 469 265 469 "},"Ċ":{"x_min":91.5625,"x_max":890.5,"ha":831,"o":"m 626 866 q 440 806 522 866 q 308 630 358 746 q 259 376 259 514 q 315 189 259 254 q 480 124 371 124 q 704 170 576 124 l 704 31 q 450 -14 581 -14 q 186 86 282 -14 q 91 369 91 187 q 163 697 91 545 q 354 927 234 848 q 626 1006 473 1006 q 890 943 773 1006 l 826 811 q 735 850 784 834 q 626 866 687 866 m 540 1163 q 566 1237 540 1209 q 641 1266 593 1266 q 699 1248 677 1266 q 722 1193 722 1230 q 694 1117 722 1145 q 623 1090 667 1090 q 564 1107 587 1090 q 540 1163 540 1125 "},"³":{"x_min":70.53125,"x_max":531.734375,"ha":505,"o":"m 531 862 q 494 761 531 801 q 387 703 457 721 l 387 700 q 465 655 440 688 q 490 577 490 622 q 422 438 490 490 q 240 386 355 386 q 70 423 146 386 l 70 531 q 238 483 155 483 q 333 508 299 483 q 366 580 366 533 q 267 656 366 656 l 194 656 l 213 747 l 276 747 q 373 770 337 747 q 409 837 409 793 q 330 904 409 904 q 202 860 267 904 l 156 942 q 354 1004 242 1004 q 484 966 438 1004 q 531 862 531 928 "},"¡":{"x_min":-30.515625,"x_max":354.03125,"ha":378,"o":"m 149 437 l 267 437 l 155 -253 l -30 -253 l 149 437 m 354 673 q 322 585 354 618 q 236 551 290 551 q 172 572 196 551 q 149 634 149 593 q 183 724 149 690 q 269 758 216 758 q 333 733 313 758 q 354 673 354 709 "},"ẅ":{"x_min":82.0625,"x_max":1105.5,"ha":1044,"o":"m 572 0 l 559 425 l 558 472 l 560 608 q 525 523 543 566 q 291 0 507 480 l 113 0 l 82 750 l 231 750 l 240 311 q 233 145 239 252 l 237 145 q 311 330 282 265 l 499 750 l 672 750 l 685 340 l 685 304 l 683 145 l 687 145 q 726 253 699 179 q 769 364 753 326 q 940 750 785 401 l 1105 750 l 754 0 l 572 0 m 394 935 q 418 1002 394 976 q 485 1028 442 1028 q 537 1012 517 1028 q 556 963 556 996 q 532 894 556 919 q 468 869 508 869 q 415 884 436 869 q 394 935 394 900 m 654 935 q 678 1002 654 976 q 744 1028 702 1028 q 796 1012 777 1028 q 816 963 816 996 q 792 894 816 919 q 728 869 767 869 q 675 884 696 869 q 654 935 654 900 "},"ậ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 215 -192 q 241 -117 215 -145 q 315 -89 267 -89 q 373 -106 352 -89 q 395 -161 395 -124 q 368 -237 395 -209 q 297 -265 341 -265 q 238 -247 262 -265 q 215 -192 215 -230 m 718 842 l 615 842 q 506 962 564 884 q 346 842 417 887 l 235 842 l 235 858 q 371 991 328 945 q 432 1064 414 1036 l 600 1064 q 718 858 626 997 l 718 842 "},"[":{"x_min":-18.3125,"x_max":531.734375,"ha":428,"o":"m 273 -220 l -18 -220 l 240 992 l 531 992 l 505 872 l 355 872 l 149 -99 l 299 -99 l 273 -220 "},"Ử":{"x_min":103.09375,"x_max":1239.109375,"ha":1039,"o":"m 962 992 l 934 862 q 1022 925 991 877 q 1066 1056 1053 972 l 1232 1056 l 1239 1039 q 1123 846 1207 920 q 912 757 1039 773 l 825 343 q 683 73 786 160 q 412 -14 581 -14 q 183 59 264 -14 q 103 266 103 132 q 116 380 103 315 l 247 992 l 408 992 l 278 376 q 263 276 263 315 q 426 124 263 124 q 583 181 526 124 q 666 356 641 237 l 801 992 l 962 992 m 799 1257 q 662 1112 799 1148 l 647 1051 l 549 1051 l 561 1163 q 648 1192 622 1174 q 673 1240 673 1211 q 612 1281 673 1281 q 537 1272 584 1281 l 537 1361 q 636 1374 578 1374 q 756 1343 713 1374 q 799 1257 799 1313 "},"%":{"x_min":95.625,"x_max":1089.21875,"ha":1145,"o":"m 359 892 q 292 850 322 892 q 244 733 262 809 q 226 587 226 657 q 280 495 226 495 q 345 534 316 495 q 395 654 375 574 q 415 803 415 733 q 359 892 415 892 m 545 804 q 508 591 545 695 q 408 435 470 487 q 269 383 347 383 q 140 436 185 383 q 95 591 95 490 q 131 804 95 704 q 228 955 167 904 q 369 1006 288 1006 q 500 954 455 1006 q 545 804 545 902 m 1024 992 l 288 0 l 156 0 l 893 992 l 1024 992 m 901 496 q 836 457 866 496 q 787 341 807 418 q 768 190 768 263 q 823 99 768 99 q 888 139 858 99 q 938 257 918 178 q 958 407 958 336 q 901 496 958 496 m 1089 409 q 1051 195 1089 300 q 952 38 1013 90 q 813 -14 890 -14 q 682 37 727 -14 q 637 189 637 89 q 673 406 637 305 q 770 558 709 507 q 910 609 830 609 q 1043 558 996 609 q 1089 409 1089 507 "},"P":{"x_min":47.46875,"x_max":796.234375,"ha":796,"o":"m 315 507 l 379 507 q 565 561 499 507 q 632 714 632 615 q 592 822 632 788 q 470 856 552 856 l 389 856 l 315 507 m 796 719 q 681 461 796 551 q 360 371 566 371 l 286 371 l 208 0 l 47 0 l 257 992 l 483 992 q 717 923 638 992 q 796 719 796 855 "},"_":{"x_min":-127.5,"x_max":446.953125,"ha":551,"o":"m 426 -219 l -127 -219 l -107 -125 l 446 -125 l 426 -219 "},"Ŕ":{"x_min":47.46875,"x_max":798.953125,"ha":818,"o":"m 291 396 l 208 0 l 47 0 l 257 992 l 486 992 q 718 927 637 992 q 798 730 798 863 q 740 542 798 619 q 565 429 681 465 l 734 0 l 558 0 l 417 396 l 291 396 m 320 531 l 404 531 q 576 581 519 531 q 633 721 633 632 q 593 823 633 792 q 469 855 553 855 l 388 855 l 320 531 m 448 1087 q 601 1293 514 1161 l 780 1293 l 780 1280 q 673 1170 743 1235 q 554 1071 602 1106 l 448 1071 l 448 1087 "},"ñ":{"x_min":31.875,"x_max":779.1875,"ha":819,"o":"m 476 0 l 572 456 q 584 544 584 517 q 497 633 584 633 q 400 595 448 633 q 315 483 353 556 q 258 318 277 410 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 424 727 364 691 q 554 764 484 764 q 694 712 644 764 q 744 565 744 660 q 729 443 744 519 l 636 0 l 476 0 m 602 841 q 546 852 572 841 q 498 878 521 864 q 453 904 475 892 q 410 915 432 915 q 368 897 385 915 q 339 840 351 878 l 246 840 q 419 1034 284 1034 q 477 1021 450 1034 q 526 995 503 1009 q 569 969 549 981 q 609 957 589 957 q 653 975 636 957 q 686 1035 670 993 l 779 1035 q 602 841 734 841 "},"‚":{"x_min":-69.171875,"x_max":231.953125,"ha":359,"o":"m 226 161 l 231 145 q 51 -179 158 -12 l -69 -179 q 66 161 2 -17 l 226 161 "},"Æ":{"x_min":-82.0625,"x_max":1240.46875,"ha":1189,"o":"m 1030 0 l 503 0 l 562 275 l 269 275 l 95 0 l -82 0 l 548 992 l 1240 992 l 1211 852 l 845 852 l 788 585 l 1130 585 l 1101 449 l 760 449 l 694 137 l 1060 137 l 1030 0 m 591 417 l 685 852 l 629 852 l 358 417 l 591 417 "},"ğ":{"x_min":-82.0625,"x_max":775.203125,"ha":724,"o":"m 775 750 l 754 657 l 623 634 q 642 542 642 595 q 562 334 642 411 q 345 257 481 257 q 283 262 310 257 q 208 191 208 235 q 229 156 208 166 q 291 141 250 146 l 377 130 q 548 71 497 115 q 600 -55 600 26 q 497 -261 600 -188 q 206 -334 395 -334 q -6 -283 69 -334 q -82 -143 -82 -232 q -34 -22 -82 -73 q 116 63 12 28 q 65 149 65 94 q 96 230 65 196 q 196 297 128 265 q 104 468 104 352 q 187 682 104 601 q 406 764 270 764 q 515 750 461 764 l 775 750 m 219 12 q 103 -36 143 0 q 62 -125 62 -72 q 100 -195 62 -169 q 215 -221 137 -221 q 387 -184 325 -221 q 450 -79 450 -148 q 419 -25 450 -45 q 312 2 389 -5 l 219 12 m 402 657 q 325 631 358 657 q 274 560 292 605 q 255 461 255 514 q 279 386 255 413 q 348 360 303 360 q 424 387 392 360 q 475 459 457 413 q 493 561 493 506 q 402 657 493 657 m 721 1048 q 640 892 700 942 q 476 842 579 842 q 335 886 386 842 q 284 1010 284 931 q 286 1048 284 1035 l 378 1048 q 403 983 378 1005 q 487 962 428 962 q 578 983 546 962 q 621 1048 611 1005 l 721 1048 "},"Ở":{"x_min":91.5625,"x_max":1186.21875,"ha":1032,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 902 862 809 1007 q 977 935 951 887 q 1013 1055 1003 983 l 1180 1055 l 1186 1038 q 1098 872 1158 935 q 942 770 1038 808 q 963 625 963 701 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 828 1257 q 691 1112 828 1148 l 676 1051 l 578 1051 l 590 1163 q 677 1192 651 1174 q 702 1240 702 1211 q 641 1281 702 1281 q 566 1272 613 1281 l 566 1361 q 665 1374 607 1374 q 785 1343 742 1374 q 828 1257 828 1313 "},"Ū":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 442 1190 l 836 1190 l 811 1071 l 416 1071 l 442 1190 "},"ª":{"x_min":108.515625,"x_max":560.890625,"ha":494,"o":"m 337 1003 q 450 933 414 1003 l 454 933 l 480 994 l 560 994 l 461 530 l 377 530 l 384 601 l 381 601 q 315 540 347 559 q 241 522 282 522 q 144 566 179 522 q 108 688 108 611 q 140 850 108 775 q 223 964 172 925 q 337 1003 274 1003 m 279 608 q 345 640 313 608 q 397 727 377 673 q 417 834 417 781 q 348 915 417 915 q 254 849 293 915 q 216 692 216 783 q 279 608 216 608 "},"Œ":{"x_min":91.5625,"x_max":1270.984375,"ha":1219,"o":"m 1061 0 l 575 0 q 459 -14 518 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 755 992 702 1007 l 1270 992 l 1241 852 l 876 852 l 819 585 l 1161 585 l 1131 449 l 790 449 l 725 137 l 1090 137 l 1061 0 m 469 124 q 563 142 519 124 l 714 846 q 591 867 668 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 "},"Ạ":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 229 -192 q 255 -117 229 -145 q 329 -89 281 -89 q 387 -106 366 -89 q 409 -161 409 -124 q 382 -237 409 -209 q 311 -265 355 -265 q 252 -247 276 -265 q 229 -192 229 -230 "},"Ą":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 698 0 q 596 -98 623 -59 q 569 -172 569 -137 q 581 -205 569 -194 q 612 -216 592 -216 q 674 -207 638 -216 l 674 -302 q 581 -317 630 -317 q 482 -285 520 -317 q 445 -196 445 -253 q 477 -95 445 -141 q 591 0 509 -50 l 698 0 "},"T":{"x_min":119.375,"x_max":826.75,"ha":714,"o":"m 358 0 l 197 0 l 376 852 l 119 852 l 149 992 l 826 992 l 797 852 l 539 852 l 358 0 "},"š":{"x_min":9.5,"x_max":663.421875,"ha":625,"o":"m 530 230 q 450 49 530 112 q 227 -14 370 -14 q 9 31 99 -14 l 9 169 q 221 108 113 108 q 327 135 286 108 q 368 209 368 162 q 344 268 368 243 q 248 334 321 293 q 129 427 164 380 q 94 539 94 474 q 166 704 94 644 q 362 764 239 764 q 597 707 495 764 l 545 587 q 365 639 451 639 q 285 616 316 639 q 254 554 254 594 q 276 499 254 523 q 368 438 299 476 q 469 370 439 398 q 514 308 499 341 q 530 230 530 274 m 181 1064 l 282 1064 q 392 943 329 1024 q 553 1064 476 1014 l 663 1064 l 663 1045 q 548 935 609 997 q 466 842 488 873 l 297 842 q 181 1045 268 916 l 181 1064 "},"ỷ":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 595 1028 q 458 883 595 919 l 443 822 l 345 822 l 357 934 q 444 963 418 945 q 469 1011 469 982 q 408 1052 469 1052 q 333 1043 380 1052 l 333 1132 q 432 1145 374 1145 q 552 1114 509 1145 q 595 1028 595 1084 "},"Þ":{"x_min":47.46875,"x_max":762.328125,"ha":796,"o":"m 762 554 q 649 297 762 389 q 326 206 536 206 l 252 206 l 208 0 l 47 0 l 257 992 l 417 992 l 383 827 l 448 827 q 682 758 602 827 q 762 554 762 689 m 280 343 l 345 343 q 532 396 465 343 q 598 550 598 449 q 558 657 598 624 q 436 690 518 690 l 354 690 l 280 343 "},"j":{"x_min":-177.6875,"x_max":405.578125,"ha":382,"o":"m -76 -334 q -177 -318 -137 -334 l -177 -189 q -98 -203 -134 -203 q 16 -76 -9 -203 l 193 750 l 351 750 l 170 -95 q 84 -276 145 -218 q -76 -334 23 -334 m 225 935 q 250 1009 225 981 q 324 1038 276 1038 q 383 1020 361 1038 q 405 965 405 1002 q 378 889 405 917 q 307 862 351 862 q 248 879 271 862 q 225 935 225 896 "},"1":{"x_min":164.125,"x_max":642.953125,"ha":765,"o":"m 432 0 l 270 0 l 398 590 q 454 810 417 692 q 362 740 415 772 l 236 661 l 164 776 l 508 992 l 642 992 l 432 0 "},"›":{"x_min":6.78125,"x_max":366.921875,"ha":421,"o":"m 366 348 l 98 62 l 6 142 l 202 369 l 98 617 l 219 669 l 366 365 l 366 348 "},"<":{"x_min":78,"x_max":712.8125,"ha":765,"o":"m 712 150 l 78 441 l 78 523 l 712 855 l 712 722 l 240 489 l 712 283 l 712 150 "},"t":{"x_min":62.390625,"x_max":545.96875,"ha":510,"o":"m 308 114 q 411 135 354 114 l 411 15 q 346 -5 387 3 q 265 -14 305 -14 q 79 153 79 -14 q 90 242 79 192 l 172 629 l 62 629 l 76 703 l 205 759 l 293 917 l 392 917 l 356 750 l 545 750 l 519 629 l 331 629 l 248 241 q 240 178 240 203 q 257 132 240 149 q 308 114 274 114 "},"¬":{"x_min":79.359375,"x_max":714.171875,"ha":765,"o":"m 714 550 l 714 174 l 592 174 l 592 427 l 79 427 l 79 550 l 714 550 "},"ù":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 558 842 l 460 842 q 371 944 416 884 q 302 1049 325 1004 l 302 1064 l 469 1064 q 558 858 500 959 l 558 842 "},"ĉ":{"x_min":63.75,"x_max":686.65625,"ha":647,"o":"m 343 -14 q 137 57 210 -14 q 63 263 63 129 q 113 519 63 404 q 253 699 163 634 q 458 764 343 764 q 659 722 569 764 l 612 597 q 462 633 529 633 q 292 529 360 633 q 225 271 225 425 q 263 155 225 196 q 368 114 301 114 q 462 129 418 114 q 550 166 505 144 l 550 34 q 343 -14 455 -14 m 686 842 l 583 842 q 474 962 532 884 q 314 842 385 887 l 203 842 l 203 858 q 339 991 296 945 q 400 1064 382 1036 l 568 1064 q 686 858 594 997 l 686 842 "},"ï":{"x_min":31.875,"x_max":517.09375,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 95 935 q 119 1002 95 976 q 186 1028 143 1028 q 238 1012 218 1028 q 257 963 257 996 q 233 894 257 919 q 169 869 209 869 q 116 884 137 869 q 95 935 95 900 m 355 935 q 379 1002 355 976 q 445 1028 403 1028 q 497 1012 478 1028 q 517 963 517 996 q 493 894 517 919 q 429 869 468 869 q 376 884 397 869 q 355 935 355 900 "},"ī":{"x_min":31.875,"x_max":506.71875,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 112 961 l 506 961 l 481 842 l 86 842 l 112 961 "},"Ò":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 697 1071 l 599 1071 q 510 1173 555 1113 q 441 1278 464 1233 l 441 1293 l 608 1293 q 697 1087 639 1188 l 697 1071 "},"ầ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 441 1042 l 608 1042 q 715 857 638 961 l 711 842 l 630 842 q 513 951 568 884 q 349 842 426 882 l 256 842 l 259 858 q 441 1042 401 991 m 260 974 q 192 1047 226 1005 q 141 1115 157 1090 l 141 1128 l 266 1128 q 299 1055 277 1097 q 335 987 320 1012 l 335 974 l 260 974 "},"Ď":{"x_min":47.46875,"x_max":889.15625,"ha":932,"o":"m 889 605 q 821 284 889 422 q 623 73 753 147 q 319 0 494 0 l 47 0 l 257 992 l 507 992 q 790 893 691 992 q 889 605 889 795 m 327 136 q 537 194 447 136 q 674 358 626 253 q 722 600 722 464 q 662 790 722 725 q 489 856 602 856 l 389 856 l 236 136 l 327 136 m 348 1293 l 449 1293 q 559 1172 496 1253 q 720 1293 643 1243 l 830 1293 l 830 1274 q 715 1164 776 1226 q 633 1071 655 1102 l 464 1071 q 348 1274 435 1145 l 348 1293 "},"&":{"x_min":44.765625,"x_max":929.171875,"ha":957,"o":"m 507 880 q 416 843 448 880 q 384 747 384 806 q 426 610 384 673 q 561 701 526 661 q 597 787 597 741 q 573 856 597 832 q 507 880 548 880 m 344 118 q 444 137 396 118 q 541 193 491 155 l 362 451 q 239 355 272 401 q 206 251 206 309 q 244 155 206 192 q 344 118 282 118 m 44 237 q 102 409 44 336 q 297 548 160 481 q 237 740 237 650 q 313 934 237 862 q 515 1007 389 1007 q 686 952 623 1007 q 748 804 748 897 q 688 648 748 716 q 489 517 627 579 l 648 297 q 771 497 722 372 l 929 497 q 727 189 852 313 l 866 0 l 678 0 l 615 88 q 472 10 543 34 q 316 -14 400 -14 q 116 52 187 -14 q 44 237 44 118 "},"Ồ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 569 1271 l 736 1271 q 843 1086 766 1190 l 839 1071 l 758 1071 q 641 1180 696 1113 q 477 1071 554 1111 l 384 1071 l 387 1087 q 569 1271 529 1220 m 388 1203 q 320 1276 354 1234 q 269 1344 285 1319 l 269 1357 l 394 1357 q 427 1284 405 1326 q 463 1216 448 1241 l 463 1203 l 388 1203 "},"˝":{"x_min":229.234375,"x_max":797.59375,"ha":770,"o":"m 229 858 q 319 969 274 909 q 384 1064 364 1030 l 547 1064 l 547 1051 q 443 945 520 1016 q 318 842 366 875 l 229 842 l 229 858 m 479 858 q 636 1064 560 948 l 797 1064 l 797 1051 q 690 942 762 1007 q 569 842 617 876 l 479 842 l 479 858 "},"I":{"x_min":47.46875,"x_max":417.78125,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 "},"G":{"x_min":91.5625,"x_max":930.515625,"ha":949,"o":"m 533 538 l 880 538 l 773 38 q 625 -1 697 11 q 463 -14 553 -14 q 189 85 286 -14 q 91 365 91 184 q 161 693 91 544 q 357 923 230 841 q 647 1006 484 1006 q 791 992 722 1006 q 930 944 860 978 l 869 807 q 642 865 751 865 q 448 804 535 865 q 310 629 360 742 q 259 376 259 515 q 320 188 259 251 q 491 124 380 124 q 637 146 565 124 l 691 398 l 503 398 l 533 538 "},"`":{"x_min":366.921875,"x_max":622.609375,"ha":770,"o":"m 622 842 l 524 842 q 435 944 480 884 q 366 1049 389 1004 l 366 1064 l 533 1064 q 622 858 564 959 l 622 842 "},"·":{"x_min":101.375,"x_max":305.53125,"ha":374,"o":"m 101 469 q 133 559 101 525 q 222 592 165 592 q 282 571 260 592 q 305 508 305 550 q 273 420 305 455 q 188 386 241 386 q 122 410 144 386 q 101 469 101 434 "},"ỗ":{"x_min":63.75,"x_max":771.546875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 617 1070 q 564 1079 589 1070 q 516 1099 539 1088 q 471 1120 492 1111 q 429 1130 450 1130 q 387 1113 401 1130 q 361 1069 372 1096 l 281 1069 q 337 1186 298 1147 q 435 1226 377 1226 q 486 1216 461 1226 q 535 1195 511 1206 q 580 1173 558 1183 q 623 1164 602 1164 q 664 1179 648 1164 q 693 1227 679 1194 l 771 1227 q 617 1070 732 1070 m 421 1037 l 588 1037 q 698 857 611 974 l 694 842 l 613 842 q 493 945 553 882 q 334 842 408 882 l 239 842 l 242 858 l 285 899 q 421 1037 381 985 "},"Ễ":{"x_min":47.46875,"x_max":824.546875,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 670 1299 q 617 1308 642 1299 q 569 1328 592 1317 q 524 1349 545 1340 q 482 1359 503 1359 q 440 1342 454 1359 q 414 1298 425 1325 l 334 1298 q 390 1415 351 1376 q 488 1455 430 1455 q 539 1445 514 1455 q 588 1424 564 1435 q 633 1402 611 1412 q 676 1393 655 1393 q 717 1408 701 1393 q 746 1456 732 1423 l 824 1456 q 670 1299 785 1299 m 474 1266 l 641 1266 q 751 1086 664 1203 l 747 1071 l 666 1071 q 546 1174 606 1111 q 387 1071 461 1111 l 292 1071 l 295 1087 l 338 1128 q 474 1266 434 1214 "},"ằ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 507 1018 q 435 1092 471 1051 q 384 1160 400 1133 l 385 1173 l 504 1173 q 574 1032 524 1114 l 571 1018 l 507 1018 m 498 842 q 355 892 406 842 q 303 1030 303 942 l 304 1043 l 389 1043 q 425 968 396 991 q 507 945 455 945 q 656 1043 614 945 l 745 1043 q 658 894 721 946 q 498 842 596 842 "},"ŏ":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 717 1048 q 636 892 696 942 q 472 842 575 842 q 331 886 382 842 q 280 1010 280 931 q 282 1048 280 1035 l 374 1048 q 399 983 374 1005 q 483 962 424 962 q 574 983 542 962 q 617 1048 607 1005 l 717 1048 "},"¿":{"x_min":-23.734375,"x_max":519.515625,"ha":615,"o":"m 453 436 q 399 279 436 336 q 283 165 362 221 q 184 85 210 111 q 146 31 158 58 q 133 -27 133 4 q 162 -105 133 -76 q 245 -135 190 -135 q 346 -116 297 -135 q 450 -71 396 -97 l 501 -192 q 223 -268 362 -268 q 41 -210 105 -268 q -23 -46 -23 -152 q 19 102 -23 35 q 176 248 63 169 q 271 331 239 292 q 319 436 304 371 l 453 436 m 519 673 q 486 582 519 616 q 398 549 454 549 q 338 571 360 549 q 315 633 315 593 q 346 721 315 686 q 432 756 378 756 q 498 732 476 756 q 519 673 519 709 "},"Ả":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 738 1257 q 601 1112 738 1148 l 586 1051 l 488 1051 l 500 1163 q 587 1192 561 1174 q 612 1240 612 1211 q 551 1281 612 1281 q 476 1272 523 1281 l 476 1361 q 575 1374 517 1374 q 695 1343 652 1374 q 738 1257 738 1313 "},"ý":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 339 858 q 492 1064 405 932 l 671 1064 l 671 1051 q 564 941 634 1006 q 445 842 493 877 l 339 842 l 339 858 "},"Ứ":{"x_min":103.09375,"x_max":1239.109375,"ha":1039,"o":"m 962 992 l 934 862 q 1022 925 991 877 q 1066 1056 1053 972 l 1232 1056 l 1239 1039 q 1123 846 1207 920 q 912 757 1039 773 l 825 343 q 683 73 786 160 q 412 -14 581 -14 q 183 59 264 -14 q 103 266 103 132 q 116 380 103 315 l 247 992 l 408 992 l 278 376 q 263 276 263 315 q 426 124 263 124 q 583 181 526 124 q 666 356 641 237 l 801 992 l 962 992 m 531 1087 q 684 1293 597 1161 l 863 1293 l 863 1280 q 756 1170 826 1235 q 637 1071 685 1106 l 531 1071 l 531 1087 "},"ſ":{"x_min":-172.265625,"x_max":619.21875,"ha":439,"o":"m -70 -334 q -172 -318 -132 -334 l -172 -189 q -94 -203 -128 -203 q -21 -169 -52 -203 q 25 -64 10 -135 l 210 815 q 299 1004 238 945 q 474 1063 360 1063 q 619 1033 554 1063 l 577 914 q 486 933 527 933 q 411 904 439 933 q 368 808 382 875 l 179 -84 q 90 -274 151 -214 q -70 -334 29 -334 "},"º":{"x_min":111.234375,"x_max":526.296875,"ha":489,"o":"m 526 817 q 497 665 526 732 q 415 559 469 597 q 287 522 362 522 q 158 571 204 522 q 111 709 111 621 q 141 860 111 792 q 226 965 170 927 q 354 1003 281 1003 q 482 954 438 1003 q 526 817 526 905 m 345 912 q 256 853 290 912 q 221 706 221 794 q 297 610 221 610 q 383 670 349 610 q 417 819 417 729 q 345 912 417 912 "},"ź":{"x_min":-26.453125,"x_max":671.1875,"ha":624,"o":"m 487 0 l -26 0 l -6 99 l 423 629 l 126 629 l 152 750 l 630 750 l 605 634 l 183 120 l 512 120 l 487 0 m 339 858 q 492 1064 405 932 l 671 1064 l 671 1051 q 564 941 634 1006 q 445 842 493 877 l 339 842 l 339 858 "},"ű":{"x_min":75.28125,"x_max":868.59375,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 300 858 q 390 969 345 909 q 455 1064 435 1030 l 618 1064 l 618 1051 q 514 945 591 1016 q 389 842 437 875 l 300 842 l 300 858 m 550 858 q 707 1064 631 948 l 868 1064 l 868 1051 q 761 942 833 1007 q 640 842 688 876 l 550 842 l 550 858 "},"Ư":{"x_min":103.09375,"x_max":1239.109375,"ha":1039,"o":"m 962 992 l 934 862 q 1022 925 991 877 q 1066 1056 1053 972 l 1232 1056 l 1239 1039 q 1123 846 1207 920 q 912 757 1039 773 l 825 343 q 683 73 786 160 q 412 -14 581 -14 q 183 59 264 -14 q 103 266 103 132 q 116 380 103 315 l 247 992 l 408 992 l 278 376 q 263 276 263 315 q 426 124 263 124 q 583 181 526 124 q 666 356 641 237 l 801 992 l 962 992 "},"Ǽ":{"x_min":-82.0625,"x_max":1240.46875,"ha":1189,"o":"m 1030 0 l 503 0 l 562 275 l 269 275 l 95 0 l -82 0 l 548 992 l 1240 992 l 1211 852 l 845 852 l 788 585 l 1130 585 l 1101 449 l 760 449 l 694 137 l 1060 137 l 1030 0 m 591 417 l 685 852 l 629 852 l 358 417 l 591 417 m 765 1087 q 918 1293 831 1161 l 1097 1293 l 1097 1280 q 990 1170 1060 1235 q 871 1071 919 1106 l 765 1071 l 765 1087 "},"ń":{"x_min":31.875,"x_max":753.1875,"ha":819,"o":"m 476 0 l 572 456 q 584 544 584 517 q 497 633 584 633 q 400 595 448 633 q 315 483 353 556 q 258 318 277 410 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 424 727 364 691 q 554 764 484 764 q 694 712 644 764 q 744 565 744 660 q 729 443 744 519 l 636 0 l 476 0 m 421 858 q 574 1064 487 932 l 753 1064 l 753 1051 q 646 941 716 1006 q 527 842 575 877 l 421 842 l 421 858 "},"Ș":{"x_min":26.453125,"x_max":734.515625,"ha":717,"o":"m 630 290 q 532 66 630 147 q 262 -14 434 -14 q 26 36 120 -14 l 26 188 q 263 123 143 123 q 410 162 356 123 q 463 273 463 202 q 436 356 463 319 q 319 448 408 392 q 214 531 248 494 q 162 613 180 568 q 144 711 144 657 q 186 865 144 798 q 304 969 227 932 q 476 1006 380 1006 q 734 943 615 1006 l 676 814 q 476 866 567 866 q 357 827 402 866 q 312 723 312 787 q 322 667 312 691 q 354 622 333 643 q 445 558 375 602 q 590 430 550 492 q 630 290 630 369 m 112 -288 q 203 -85 171 -183 l 354 -85 l 354 -98 q 291 -201 334 -142 q 203 -307 247 -260 l 112 -307 l 112 -288 "},";":{"x_min":-67.828125,"x_max":343.1875,"ha":374,"o":"m 226 161 l 231 145 q 51 -179 147 -30 l -67 -179 q 66 161 -3 -34 l 226 161 m 139 642 q 170 732 139 698 q 259 766 202 766 q 320 744 297 766 q 343 681 343 723 q 310 593 343 628 q 225 559 277 559 q 159 583 180 559 q 139 642 139 607 "}," ":{"x_min":0,"x_max":0,"ha":347},"Ġ":{"x_min":91.5625,"x_max":930.515625,"ha":949,"o":"m 533 538 l 880 538 l 773 38 q 625 -1 697 11 q 463 -14 553 -14 q 189 85 286 -14 q 91 365 91 184 q 161 693 91 544 q 357 923 230 841 q 647 1006 484 1006 q 791 992 722 1006 q 930 944 860 978 l 869 807 q 642 865 751 865 q 448 804 535 865 q 310 629 360 742 q 259 376 259 515 q 320 188 259 251 q 491 124 380 124 q 637 146 565 124 l 691 398 l 503 398 l 533 538 m 546 1163 q 572 1237 546 1209 q 647 1266 599 1266 q 705 1248 683 1266 q 728 1193 728 1230 q 700 1117 728 1145 q 629 1090 673 1090 q 570 1107 593 1090 q 546 1163 546 1125 "},"6":{"x_min":75.28125,"x_max":768.421875,"ha":765,"o":"m 75 302 q 116 577 75 441 q 228 810 157 714 q 398 956 299 906 q 630 1006 497 1006 q 768 989 710 1006 l 739 857 q 616 872 690 872 q 387 784 477 872 q 254 517 298 696 l 258 517 q 479 633 343 633 q 644 565 585 633 q 704 381 704 498 q 657 177 704 271 q 531 34 611 82 q 348 -14 452 -14 q 146 67 217 -14 q 75 302 75 148 m 359 117 q 456 150 414 117 q 521 241 498 183 q 544 369 544 300 q 423 504 544 504 q 359 491 389 504 q 305 459 328 479 q 265 415 282 439 q 239 360 249 391 q 230 283 229 328 q 264 163 230 208 q 359 117 297 117 "},"n":{"x_min":31.875,"x_max":744.6875,"ha":819,"o":"m 476 0 l 572 456 q 584 544 584 517 q 497 633 584 633 q 400 595 448 633 q 315 483 353 556 q 258 318 277 410 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 424 727 364 691 q 554 764 484 764 q 694 712 644 764 q 744 565 744 660 q 729 443 744 519 l 636 0 l 476 0 "},"﻿":{"x_min":0,"x_max":0,"ha":0},"ụ":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 237 -192 q 263 -117 237 -145 q 337 -89 289 -89 q 395 -106 374 -89 q 417 -161 417 -124 q 390 -237 417 -209 q 319 -265 363 -265 q 260 -247 284 -265 q 237 -192 237 -230 "},"ģ":{"x_min":-82.0625,"x_max":775.203125,"ha":724,"o":"m 775 750 l 754 657 l 623 634 q 642 542 642 595 q 562 334 642 411 q 345 257 481 257 q 283 262 310 257 q 208 191 208 235 q 229 156 208 166 q 291 141 250 146 l 377 130 q 548 71 497 115 q 600 -55 600 26 q 497 -261 600 -188 q 206 -334 395 -334 q -6 -283 69 -334 q -82 -143 -82 -232 q -34 -22 -82 -73 q 116 63 12 28 q 65 149 65 94 q 96 230 65 196 q 196 297 128 265 q 104 468 104 352 q 187 682 104 601 q 406 764 270 764 q 515 750 461 764 l 775 750 m 219 12 q 103 -36 143 0 q 62 -125 62 -72 q 100 -195 62 -169 q 215 -221 137 -221 q 387 -184 325 -221 q 450 -79 450 -148 q 419 -25 450 -45 q 312 2 389 -5 l 219 12 m 402 657 q 325 631 358 657 q 274 560 292 605 q 255 461 255 514 q 279 386 255 413 q 348 360 303 360 q 424 387 392 360 q 475 459 457 413 q 493 561 493 506 q 402 657 493 657 m 651 1045 q 558 842 585 923 l 407 842 l 407 856 q 472 958 428 898 q 558 1064 515 1017 l 651 1064 l 651 1045 "},"Ẵ":{"x_min":-82.0625,"x_max":836.484375,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 683 1305 q 633 1314 658 1305 q 584 1334 607 1323 q 538 1354 560 1345 q 497 1363 516 1363 q 428 1305 448 1363 l 348 1305 q 501 1455 382 1455 q 551 1445 525 1455 q 601 1424 577 1435 q 648 1403 626 1412 q 689 1393 671 1393 q 730 1409 715 1393 q 758 1456 744 1424 l 836 1456 q 683 1305 797 1305 m 546 1071 q 400 1119 451 1071 q 350 1259 350 1167 l 434 1259 q 467 1194 438 1214 q 555 1174 497 1174 q 648 1195 614 1174 q 701 1259 682 1216 l 790 1259 q 705 1119 767 1168 q 546 1071 643 1071 "},"¤":{"x_min":95.625,"x_max":711.453125,"ha":765,"o":"m 141 490 q 183 629 141 564 l 95 717 l 176 797 l 262 711 q 402 753 331 753 q 543 710 476 753 l 629 797 l 711 718 l 623 630 q 665 490 665 563 q 623 348 665 412 l 710 263 l 629 182 l 543 269 q 402 229 478 229 q 262 269 321 229 l 176 184 l 96 264 l 183 349 q 141 490 141 414 m 255 490 q 298 385 255 428 q 402 342 340 342 q 508 385 464 342 q 552 490 552 427 q 508 596 552 553 q 402 639 464 639 q 298 595 340 639 q 255 490 255 552 "},"Ĝ":{"x_min":91.5625,"x_max":930.515625,"ha":949,"o":"m 533 538 l 880 538 l 773 38 q 625 -1 697 11 q 463 -14 553 -14 q 189 85 286 -14 q 91 365 91 184 q 161 693 91 544 q 357 923 230 841 q 647 1006 484 1006 q 791 992 722 1006 q 930 944 860 978 l 869 807 q 642 865 751 865 q 448 804 535 865 q 310 629 360 742 q 259 376 259 515 q 320 188 259 251 q 491 124 380 124 q 637 146 565 124 l 691 398 l 503 398 l 533 538 m 857 1071 l 754 1071 q 645 1191 703 1113 q 485 1071 556 1116 l 374 1071 l 374 1087 q 510 1220 467 1174 q 571 1293 553 1265 l 739 1293 q 857 1087 765 1226 l 857 1071 "},"p":{"x_min":-37.296875,"x_max":748.765625,"ha":814,"o":"m 392 -14 q 209 105 269 -14 l 202 105 q 185 -19 198 39 l 120 -334 l -37 -334 l 191 750 l 316 750 l 302 622 l 308 622 q 541 764 415 764 q 693 694 638 764 q 748 499 748 624 q 701 240 748 361 q 572 53 653 120 q 392 -14 490 -14 m 482 633 q 373 579 427 633 q 284 436 318 525 q 250 252 250 347 q 281 151 250 187 q 370 114 313 114 q 478 168 428 114 q 558 310 529 221 q 587 497 587 400 q 482 633 587 633 "},"‡":{"x_min":46.125,"x_max":697.21875,"ha":689,"o":"m 381 353 l 602 374 l 572 234 l 359 254 l 341 0 l 174 0 l 265 254 l 46 234 l 76 374 l 287 353 l 294 532 l 359 699 l 140 678 l 170 820 l 381 800 l 400 1055 l 567 1055 l 476 800 l 697 820 l 666 678 l 455 699 l 450 532 l 381 353 "},"ň":{"x_min":31.875,"x_max":768.421875,"ha":819,"o":"m 476 0 l 572 456 q 584 544 584 517 q 497 633 584 633 q 400 595 448 633 q 315 483 353 556 q 258 318 277 410 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 424 727 364 691 q 554 764 484 764 q 694 712 644 764 q 744 565 744 660 q 729 443 744 519 l 636 0 l 476 0 m 286 1064 l 387 1064 q 497 943 434 1024 q 658 1064 581 1014 l 768 1064 l 768 1045 q 653 935 714 997 q 571 842 593 873 l 402 842 q 286 1045 373 916 l 286 1064 "},"ę":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 480 17 q 378 -81 405 -42 q 351 -155 351 -120 q 363 -188 351 -177 q 394 -199 374 -199 q 456 -190 420 -199 l 456 -285 q 363 -300 412 -300 q 264 -268 302 -300 q 227 -179 227 -236 q 259 -78 227 -124 q 373 17 291 -33 l 480 17 "},"ố":{"x_min":63.75,"x_max":921.4375,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 424 1042 l 591 1042 q 698 857 621 961 l 694 842 l 613 842 q 496 951 551 884 q 332 842 409 882 l 239 842 l 242 858 q 424 1042 384 991 m 663 987 q 779 1128 734 1062 l 921 1128 l 921 1115 q 845 1046 897 1089 q 747 974 793 1003 l 663 974 l 663 987 "},"Ặ":{"x_min":-82.0625,"x_max":793.6875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 793 1277 q 712 1121 772 1171 q 548 1071 651 1071 q 407 1115 458 1071 q 356 1239 356 1160 q 358 1277 356 1264 l 450 1277 q 475 1212 450 1234 q 559 1191 500 1191 q 650 1212 618 1191 q 693 1277 683 1234 l 793 1277 m 229 -192 q 255 -117 229 -145 q 329 -89 281 -89 q 387 -106 366 -89 q 409 -161 409 -124 q 382 -237 409 -209 q 311 -265 355 -265 q 252 -247 276 -265 q 229 -192 229 -230 "},"S":{"x_min":26.453125,"x_max":734.515625,"ha":717,"o":"m 630 290 q 532 66 630 147 q 262 -14 434 -14 q 26 36 120 -14 l 26 188 q 263 123 143 123 q 410 162 356 123 q 463 273 463 202 q 436 356 463 319 q 319 448 408 392 q 214 531 248 494 q 162 613 180 568 q 144 711 144 657 q 186 865 144 798 q 304 969 227 932 q 476 1006 380 1006 q 734 943 615 1006 l 676 814 q 476 866 567 866 q 357 827 402 866 q 312 723 312 787 q 322 667 312 691 q 354 622 333 643 q 445 558 375 602 q 590 430 550 492 q 630 290 630 369 "},"ễ":{"x_min":63.75,"x_max":762.546875,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 608 1070 q 555 1079 580 1070 q 507 1099 530 1088 q 462 1120 483 1111 q 420 1130 441 1130 q 378 1113 392 1130 q 352 1069 363 1096 l 272 1069 q 328 1186 289 1147 q 426 1226 368 1226 q 477 1216 452 1226 q 526 1195 502 1206 q 571 1173 549 1183 q 614 1164 593 1164 q 655 1179 639 1164 q 684 1227 670 1194 l 762 1227 q 608 1070 723 1070 m 412 1037 l 579 1037 q 689 857 602 974 l 685 842 l 604 842 q 484 945 544 882 q 325 842 399 882 l 230 842 l 233 858 l 276 899 q 412 1037 372 985 "},"/":{"x_min":-62.390625,"x_max":645.671875,"ha":534,"o":"m 645 992 l 95 0 l -62 0 l 487 992 l 645 992 "},"į":{"x_min":-61.515625,"x_max":405.578125,"ha":382,"o":"m 223 935 q 250 1009 223 981 q 324 1038 276 1038 q 383 1020 360 1038 q 405 965 405 1002 q 378 889 405 917 q 307 862 351 862 q 247 879 271 862 q 223 935 223 897 m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 191 0 q 89 -98 116 -59 q 62 -172 62 -137 q 74 -205 62 -194 q 105 -216 85 -216 q 167 -207 131 -216 l 167 -302 q 74 -317 123 -317 q -24 -285 13 -317 q -61 -196 -61 -253 q -29 -95 -61 -141 q 84 0 2 -50 l 191 0 "},"Ế":{"x_min":47.46875,"x_max":974.4375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 477 1271 l 644 1271 q 751 1086 674 1190 l 747 1071 l 666 1071 q 549 1180 604 1113 q 385 1071 462 1111 l 292 1071 l 295 1087 q 477 1271 437 1220 m 716 1216 q 832 1357 787 1291 l 974 1357 l 974 1344 q 898 1275 950 1318 q 800 1203 846 1232 l 716 1203 l 716 1216 "},"Ọ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 310 -192 q 336 -117 310 -145 q 410 -89 362 -89 q 468 -106 447 -89 q 490 -161 490 -124 q 463 -237 490 -209 q 392 -265 436 -265 q 333 -247 357 -265 q 310 -192 310 -230 "},"ắ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 498 842 q 355 892 406 842 q 303 1030 303 942 l 304 1043 l 389 1043 q 425 968 396 991 q 507 945 455 945 q 656 1043 614 945 l 745 1043 q 658 894 721 946 q 498 842 596 842 m 466 1032 q 581 1173 530 1092 l 713 1173 l 713 1161 q 634 1091 692 1138 q 534 1018 577 1044 l 466 1018 l 466 1032 "},"Ŧ":{"x_min":113.9375,"x_max":826.75,"ha":714,"o":"m 478 564 l 657 564 l 629 432 l 450 432 l 358 0 l 197 0 l 287 432 l 113 432 l 143 564 l 315 564 l 376 852 l 119 852 l 149 992 l 826 992 l 797 852 l 539 852 l 478 564 "},"y":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 "},"‗":{"x_min":-143.5,"x_max":467.953125,"ha":551,"o":"m 410 -313 l -143 -313 l -123 -219 l 430 -219 l 410 -313 m 447 -125 l -106 -125 l -86 -31 l 467 -31 l 447 -125 "},"ǿ":{"x_min":34.59375,"x_max":755.546875,"ha":796,"o":"m 730 474 q 680 219 730 333 q 544 46 630 105 q 348 -12 458 -12 q 189 27 255 -12 l 118 -60 l 34 4 l 112 99 q 65 276 65 170 q 112 524 65 412 q 248 698 160 635 q 450 762 335 762 q 612 720 542 762 l 670 793 l 755 728 l 687 649 q 730 474 730 581 m 442 634 q 283 535 347 634 q 219 288 219 437 q 225 238 219 262 l 524 610 q 442 634 494 634 m 358 114 q 468 159 418 114 q 547 283 518 204 q 576 458 576 363 q 572 503 576 488 l 276 136 q 358 114 304 114 m 387 858 q 540 1064 453 932 l 719 1064 l 719 1051 q 612 941 682 1006 q 493 842 541 877 l 387 842 l 387 858 "},"g":{"x_min":-82.0625,"x_max":775.203125,"ha":724,"o":"m 775 750 l 754 657 l 623 634 q 642 542 642 595 q 562 334 642 411 q 345 257 481 257 q 283 262 310 257 q 208 191 208 235 q 229 156 208 166 q 291 141 250 146 l 377 130 q 548 71 497 115 q 600 -55 600 26 q 497 -261 600 -188 q 206 -334 395 -334 q -6 -283 69 -334 q -82 -143 -82 -232 q -34 -22 -82 -73 q 116 63 12 28 q 65 149 65 94 q 96 230 65 196 q 196 297 128 265 q 104 468 104 352 q 187 682 104 601 q 406 764 270 764 q 515 750 461 764 l 775 750 m 219 12 q 103 -36 143 0 q 62 -125 62 -72 q 100 -195 62 -169 q 215 -221 137 -221 q 387 -184 325 -221 q 450 -79 450 -148 q 419 -25 450 -45 q 312 2 389 -5 l 219 12 m 402 657 q 325 631 358 657 q 274 560 292 605 q 255 461 255 514 q 279 386 255 413 q 348 360 303 360 q 424 387 392 360 q 475 459 457 413 q 493 561 493 506 q 402 657 493 657 "},"ĸ":{"x_min":31.875,"x_max":786.0625,"ha":733,"o":"m 267 405 l 601 750 l 786 750 l 458 421 l 655 0 l 478 0 l 336 319 l 244 254 l 191 0 l 31 0 l 190 750 l 349 750 l 311 572 q 265 405 302 536 l 267 405 "},"́":{"x_min":-382.46875,"x_max":-50.8125,"ha":0,"o":"m -382 858 q -229 1064 -316 932 l -50 1064 l -50 1051 q -157 941 -87 1006 q -276 842 -228 877 l -382 842 l -382 858 "},"²":{"x_min":52.90625,"x_max":531.734375,"ha":505,"o":"m 462 397 l 52 397 l 71 488 l 254 639 q 355 732 329 704 q 392 784 380 759 q 404 834 404 808 q 385 883 404 865 q 333 900 366 900 q 204 846 271 900 l 149 930 q 246 985 196 966 q 360 1004 297 1004 q 485 963 438 1004 q 531 858 531 922 q 515 773 531 811 q 465 698 499 736 q 351 599 431 661 l 233 503 l 484 503 l 462 397 "},"–":{"x_min":31.875,"x_max":629.390625,"ha":667,"o":"m 31 307 l 61 439 l 629 439 l 600 307 l 31 307 "},"ë":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 262 935 q 286 1002 262 976 q 353 1028 310 1028 q 405 1012 385 1028 q 424 963 424 996 q 400 894 424 919 q 336 869 376 869 q 283 884 304 869 q 262 935 262 900 m 522 935 q 546 1002 522 976 q 612 1028 570 1028 q 664 1012 645 1028 q 684 963 684 996 q 660 894 684 919 q 596 869 635 869 q 543 884 564 869 q 522 935 522 900 "},"ƒ":{"x_min":-9.5,"x_max":769.78125,"ha":765,"o":"m 91 -334 q -9 -318 30 -334 l -9 -189 q 67 -203 33 -203 q 141 -169 109 -203 q 187 -64 172 -135 l 318 556 l 197 556 l 210 630 l 344 678 l 359 757 q 447 945 384 886 q 625 1005 510 1005 q 769 975 703 1005 l 727 856 q 636 875 677 875 q 559 846 588 875 q 518 750 531 817 l 502 677 l 657 677 l 632 556 l 478 556 l 341 -85 q 251 -274 312 -215 q 91 -334 189 -334 "},"J":{"x_min":-218.390625,"x_max":425.25,"ha":415,"o":"m -103 -277 q -218 -260 -173 -277 l -215 -123 q -111 -137 -158 -137 q 61 31 25 -137 l 263 992 l 425 992 l 218 10 q 108 -206 187 -136 q -103 -277 30 -277 "},"Ã":{"x_min":-82.0625,"x_max":832.1875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 655 1070 q 599 1081 625 1070 q 551 1107 574 1093 q 506 1133 528 1121 q 463 1144 485 1144 q 421 1126 438 1144 q 392 1069 404 1107 l 299 1069 q 472 1263 337 1263 q 530 1250 503 1263 q 579 1224 556 1238 q 622 1198 602 1210 q 662 1186 642 1186 q 706 1204 689 1186 q 739 1264 723 1222 l 832 1264 q 655 1070 787 1070 "},"ŷ":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 644 842 l 541 842 q 432 962 490 884 q 272 842 343 887 l 161 842 l 161 858 q 297 991 254 945 q 358 1064 340 1036 l 526 1064 q 644 858 552 997 l 644 842 "},"ŕ":{"x_min":31.875,"x_max":658.1875,"ha":567,"o":"m 540 764 q 613 755 582 764 l 579 607 q 510 616 542 616 q 357 540 424 616 q 263 339 290 463 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 421 728 364 692 q 540 764 477 764 m 326 858 q 479 1064 392 932 l 658 1064 l 658 1051 q 551 941 621 1006 q 432 842 480 877 l 326 842 l 326 858 "},"©":{"x_min":88.84375,"x_max":1108.21875,"ha":1156,"o":"m 630 701 q 511 650 554 701 q 469 492 469 598 q 630 288 469 288 q 706 299 662 288 q 780 322 750 309 l 780 215 q 617 181 701 181 q 412 264 484 181 q 340 492 340 348 q 417 724 340 639 q 629 809 494 809 q 809 764 722 809 l 763 664 q 630 701 691 701 m 88 495 q 156 750 88 631 q 343 937 224 868 q 598 1006 461 1006 q 852 938 733 1006 q 1039 751 970 871 q 1108 495 1108 632 q 1041 242 1108 360 q 856 55 974 124 q 598 -14 738 -14 q 339 56 458 -14 q 154 243 221 126 q 88 495 88 361 m 172 495 q 228 283 172 381 q 383 127 284 185 q 598 68 482 68 q 815 127 716 68 q 969 284 914 186 q 1024 495 1024 383 q 969 706 1024 607 q 814 863 913 805 q 598 922 716 922 q 385 865 484 922 q 229 708 286 807 q 172 495 172 609 "},"˘":{"x_min":307.234375,"x_max":744.6875,"ha":770,"o":"m 744 1048 q 663 892 723 942 q 499 842 602 842 q 358 886 409 842 q 307 1010 307 931 q 309 1048 307 1035 l 401 1048 q 426 983 401 1005 q 510 962 451 962 q 601 983 569 962 q 644 1048 634 1005 l 744 1048 "},"Ă":{"x_min":-82.0625,"x_max":793.6875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 793 1277 q 712 1121 772 1171 q 548 1071 651 1071 q 407 1115 458 1071 q 356 1239 356 1160 q 358 1277 356 1264 l 450 1277 q 475 1212 450 1234 q 559 1191 500 1191 q 650 1212 618 1191 q 693 1277 683 1234 l 793 1277 "},"D":{"x_min":47.46875,"x_max":889.15625,"ha":932,"o":"m 889 605 q 821 284 889 422 q 623 73 753 147 q 319 0 494 0 l 47 0 l 257 992 l 507 992 q 790 893 691 992 q 889 605 889 795 m 327 136 q 537 194 447 136 q 674 358 626 253 q 722 600 722 464 q 662 790 722 725 q 489 856 602 856 l 389 856 l 236 136 l 327 136 "},"ł":{"x_min":1.359375,"x_max":445.59375,"ha":400,"o":"m 327 612 l 392 650 l 445 546 l 294 460 l 197 0 l 38 0 l 115 359 l 55 325 l 1 429 l 147 512 l 263 1055 l 421 1055 l 327 612 "},"ÿ":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 218 935 q 242 1002 218 976 q 309 1028 266 1028 q 361 1012 341 1028 q 380 963 380 996 q 356 894 380 919 q 292 869 332 869 q 239 884 260 869 q 218 935 218 900 m 478 935 q 502 1002 478 976 q 568 1028 526 1028 q 620 1012 601 1028 q 640 963 640 996 q 616 894 640 919 q 552 869 591 869 q 499 884 520 869 q 478 935 478 900 "},"ĺ":{"x_min":31.875,"x_max":600.1875,"ha":382,"o":"m 190 0 l 31 0 l 255 1055 l 415 1055 l 190 0 m 268 1126 q 421 1332 334 1200 l 600 1332 l 600 1319 q 493 1209 563 1274 q 374 1110 422 1145 l 268 1110 l 268 1126 "},"Ł":{"x_min":6.78125,"x_max":602.9375,"ha":689,"o":"m 47 0 l 119 335 l 62 303 l 6 408 l 151 488 l 257 992 l 417 992 l 333 589 l 461 662 l 518 556 l 299 435 l 237 139 l 602 139 l 573 0 l 47 0 "}," ":{"x_min":0,"x_max":0,"ha":382},"$":{"x_min":41.375,"x_max":743.328125,"ha":765,"o":"m 669 334 q 588 146 669 217 q 359 62 507 75 l 328 -81 l 237 -81 l 267 62 q 41 116 134 70 l 41 258 q 163 210 94 229 q 294 190 231 191 l 351 452 q 199 546 245 490 q 153 681 153 602 q 234 863 153 795 q 454 943 314 931 l 479 1054 l 571 1054 l 547 941 q 743 886 656 930 l 685 760 q 519 810 594 805 l 465 559 q 591 494 552 524 q 650 426 631 464 q 669 334 669 387 m 387 192 q 479 233 445 200 q 514 319 514 266 q 436 417 514 387 l 387 192 m 426 810 q 336 771 366 803 q 305 688 305 740 q 380 594 305 622 l 426 810 "},"w":{"x_min":82.0625,"x_max":1105.5,"ha":1044,"o":"m 572 0 l 559 425 l 558 472 l 560 608 q 525 523 543 566 q 291 0 507 480 l 113 0 l 82 750 l 231 750 l 240 311 q 233 145 239 252 l 237 145 q 311 330 282 265 l 499 750 l 672 750 l 685 340 l 685 304 l 683 145 l 687 145 q 726 253 699 179 q 769 364 753 326 q 940 750 785 401 l 1105 750 l 754 0 l 572 0 "},"\\":{"x_min":149.890625,"x_max":438.8125,"ha":534,"o":"m 290 992 l 438 0 l 297 0 l 149 992 l 290 992 "},"Ì":{"x_min":47.46875,"x_max":427.609375,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 427 1071 l 329 1071 q 240 1173 285 1113 q 171 1278 194 1233 l 171 1293 l 338 1293 q 427 1087 369 1188 l 427 1071 "},"Ç":{"x_min":91.5625,"x_max":890.5,"ha":831,"o":"m 626 866 q 440 806 522 866 q 308 630 358 746 q 259 376 259 514 q 315 189 259 254 q 480 124 371 124 q 704 170 576 124 l 704 31 q 450 -14 581 -14 q 186 86 282 -14 q 91 369 91 187 q 163 697 91 545 q 354 927 234 848 q 626 1006 473 1006 q 890 943 773 1006 l 826 811 q 735 850 784 834 q 626 866 687 866 m 536 -179 q 480 -292 536 -251 q 328 -334 424 -334 q 248 -323 285 -334 l 248 -232 q 313 -241 280 -241 q 406 -176 406 -241 q 382 -134 406 -149 q 312 -113 359 -119 l 378 0 l 477 0 l 443 -65 q 514 -110 492 -81 q 536 -179 536 -139 "},"Ŝ":{"x_min":26.453125,"x_max":734.515625,"ha":717,"o":"m 630 290 q 532 66 630 147 q 262 -14 434 -14 q 26 36 120 -14 l 26 188 q 263 123 143 123 q 410 162 356 123 q 463 273 463 202 q 436 356 463 319 q 319 448 408 392 q 214 531 248 494 q 162 613 180 568 q 144 711 144 657 q 186 865 144 798 q 304 969 227 932 q 476 1006 380 1006 q 734 943 615 1006 l 676 814 q 476 866 567 866 q 357 827 402 866 q 312 723 312 787 q 322 667 312 691 q 354 622 333 643 q 445 558 375 602 q 590 430 550 492 q 630 290 630 369 m 724 1071 l 621 1071 q 512 1191 570 1113 q 352 1071 423 1116 l 241 1071 l 241 1087 q 377 1220 334 1174 q 438 1293 420 1265 l 606 1293 q 724 1087 632 1226 l 724 1071 "},"C":{"x_min":91.5625,"x_max":890.5,"ha":831,"o":"m 626 866 q 440 806 522 866 q 308 630 358 746 q 259 376 259 514 q 315 189 259 254 q 480 124 371 124 q 704 170 576 124 l 704 31 q 450 -14 581 -14 q 186 86 282 -14 q 91 369 91 187 q 163 697 91 545 q 354 927 234 848 q 626 1006 473 1006 q 890 943 773 1006 l 826 811 q 735 850 784 834 q 626 866 687 866 "},"Ḁ":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 476 -236 q 432 -346 476 -303 q 313 -390 388 -390 q 198 -348 240 -390 q 155 -237 155 -307 q 198 -126 155 -167 q 313 -85 241 -85 q 430 -126 384 -85 q 476 -236 476 -167 m 384 -237 q 365 -185 384 -204 q 313 -167 345 -167 q 262 -185 282 -167 q 241 -237 241 -204 q 260 -290 241 -271 q 313 -309 278 -309 q 365 -290 345 -309 q 384 -237 384 -271 "},"̉":{"x_min":-401.515625,"x_max":-139.03125,"ha":0,"o":"m -139 1028 q -276 883 -139 919 l -291 822 l -389 822 l -377 934 q -290 963 -316 945 q -265 1011 -265 982 q -326 1052 -265 1052 q -401 1043 -354 1052 l -401 1132 q -302 1145 -360 1145 q -182 1114 -225 1145 q -139 1028 -139 1084 "},"Ē":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 353 1190 l 747 1190 l 722 1071 l 327 1071 l 353 1190 "},"!":{"x_min":22.375,"x_max":406.9375,"ha":378,"o":"m 227 301 l 108 301 l 222 992 l 406 992 l 227 301 m 22 65 q 53 153 22 119 q 141 187 84 187 q 203 165 180 187 q 226 102 226 143 q 194 15 226 48 q 111 -18 162 -18 q 45 4 69 -18 q 22 65 22 27 "},"ç":{"x_min":63.75,"x_max":659.90625,"ha":647,"o":"m 343 -14 q 137 57 210 -14 q 63 263 63 129 q 113 519 63 404 q 253 699 163 634 q 458 764 343 764 q 659 722 569 764 l 612 597 q 462 633 529 633 q 292 529 360 633 q 225 271 225 425 q 263 155 225 196 q 368 114 301 114 q 462 129 418 114 q 550 166 505 144 l 550 34 q 343 -14 455 -14 m 421 -179 q 365 -292 421 -251 q 213 -334 309 -334 q 133 -323 170 -334 l 133 -232 q 198 -241 165 -241 q 291 -176 291 -241 q 267 -134 291 -149 q 197 -113 244 -119 l 263 0 l 362 0 l 328 -65 q 399 -110 377 -81 q 421 -179 421 -139 "},"Ĵ":{"x_min":-218.390625,"x_max":591.65625,"ha":415,"o":"m -103 -277 q -218 -260 -173 -277 l -215 -123 q -111 -137 -158 -137 q 61 31 25 -137 l 263 992 l 425 992 l 218 10 q 108 -206 187 -136 q -103 -277 30 -277 m 591 1071 l 488 1071 q 379 1191 437 1113 q 219 1071 290 1116 l 108 1071 l 108 1087 q 244 1220 201 1174 q 305 1293 287 1265 l 473 1293 q 591 1087 499 1226 l 591 1071 "},"Ẻ":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 707 1257 q 570 1112 707 1148 l 555 1051 l 457 1051 l 469 1163 q 556 1192 530 1174 q 581 1240 581 1211 q 520 1281 581 1281 q 445 1272 492 1281 l 445 1361 q 544 1374 486 1374 q 664 1343 621 1374 q 707 1257 707 1313 "},"È":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 612 1071 l 514 1071 q 425 1173 470 1113 q 356 1278 379 1233 l 356 1293 l 523 1293 q 612 1087 554 1188 l 612 1071 "},"X":{"x_min":-75.28125,"x_max":893.21875,"ha":781,"o":"m 705 0 l 531 0 l 401 401 l 104 0 l -75 0 l 322 522 l 152 992 l 319 992 l 440 625 l 712 992 l 893 992 l 519 510 l 705 0 "},"ô":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 714 842 l 611 842 q 502 962 560 884 q 342 842 413 887 l 231 842 l 231 858 q 367 991 324 945 q 428 1064 410 1036 l 596 1064 q 714 858 622 997 l 714 842 "},"̣":{"x_min":-602.9375,"x_max":-422.53125,"ha":0,"o":"m -602 -192 q -576 -117 -602 -145 q -502 -89 -550 -89 q -444 -106 -465 -89 q -422 -161 -422 -124 q -449 -237 -422 -209 q -520 -265 -476 -265 q -579 -247 -555 -265 q -602 -192 -602 -230 "},"Ė":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 438 1144 q 464 1218 438 1190 q 539 1247 491 1247 q 597 1229 575 1247 q 620 1174 620 1211 q 592 1098 620 1126 q 521 1071 565 1071 q 462 1088 485 1071 q 438 1144 438 1106 "},"Ā":{"x_min":-82.0625,"x_max":770.71875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 376 1190 l 770 1190 l 745 1071 l 350 1071 l 376 1190 "},"ċ":{"x_min":63.75,"x_max":659.90625,"ha":647,"o":"m 343 -14 q 137 57 210 -14 q 63 263 63 129 q 113 519 63 404 q 253 699 163 634 q 458 764 343 764 q 659 722 569 764 l 612 597 q 462 633 529 633 q 292 529 360 633 q 225 271 225 425 q 263 155 225 196 q 368 114 301 114 q 462 129 418 114 q 550 166 505 144 l 550 34 q 343 -14 455 -14 m 383 934 q 409 1008 383 980 q 484 1037 436 1037 q 542 1019 520 1037 q 565 964 565 1001 q 537 888 565 916 q 466 861 510 861 q 407 878 430 861 q 383 934 383 896 "},"đ":{"x_min":63.75,"x_max":922.390625,"ha":813,"o":"m 416 746 q 601 630 540 746 l 607 630 q 622 752 610 681 l 637 826 l 411 826 l 433 937 l 661 937 l 686 1055 l 844 1055 l 819 937 l 922 937 l 898 826 l 796 826 l 620 0 l 495 0 l 508 119 l 503 119 q 392 17 448 49 q 273 -14 336 -14 q 119 56 174 -14 q 63 249 63 127 q 109 496 63 380 q 234 679 154 613 q 416 746 314 746 m 333 114 q 440 167 387 114 q 526 306 493 219 q 560 483 560 393 q 532 578 560 542 q 441 615 503 615 q 332 565 382 615 q 253 430 282 515 q 225 252 225 345 q 333 114 225 114 "},"ấ":{"x_min":63.75,"x_max":931.4375,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 434 1042 l 601 1042 q 708 857 631 961 l 704 842 l 623 842 q 506 951 561 884 q 342 842 419 882 l 249 842 l 252 858 q 434 1042 394 991 m 673 987 q 789 1128 744 1062 l 931 1128 l 931 1115 q 855 1046 907 1089 q 757 974 803 1003 l 673 974 l 673 987 "},"Ẃ":{"x_min":137.671875,"x_max":1337.453125,"ha":1213,"o":"m 893 0 l 718 0 l 693 571 l 689 696 l 691 768 l 687 768 q 608 571 655 671 l 347 0 l 173 0 l 137 992 l 293 992 l 305 415 q 297 180 305 322 l 301 180 q 397 421 357 330 l 659 992 l 812 992 l 833 422 l 835 308 l 833 180 l 838 180 q 886 314 857 240 q 927 417 914 388 l 1170 992 l 1337 992 l 893 0 m 666 1087 q 819 1293 732 1161 l 998 1293 l 998 1280 q 891 1170 961 1235 q 772 1071 820 1106 l 666 1071 l 666 1087 "},"Ŀ":{"x_min":47.46875,"x_max":649.15625,"ha":689,"o":"m 47 0 l 257 992 l 417 992 l 237 139 l 602 139 l 573 0 l 47 0 m 467 486 q 493 560 467 532 q 568 589 520 589 q 626 571 604 589 q 649 516 649 553 q 621 440 649 468 q 550 413 594 413 q 491 430 514 413 q 467 486 467 448 "},"ț":{"x_min":39.265625,"x_max":545.96875,"ha":510,"o":"m 308 114 q 411 135 354 114 l 411 15 q 346 -5 387 3 q 265 -14 305 -14 q 79 153 79 -14 q 90 242 79 192 l 172 629 l 62 629 l 76 703 l 205 759 l 293 917 l 392 917 l 356 750 l 545 750 l 519 629 l 331 629 l 248 241 q 240 178 240 203 q 257 132 240 149 q 308 114 274 114 m 39 -288 q 130 -85 98 -183 l 281 -85 l 281 -98 q 218 -201 261 -142 q 130 -307 174 -260 l 39 -307 l 39 -288 "},"ŋ":{"x_min":31.875,"x_max":744.6875,"ha":819,"o":"m 366 -334 q 266 -318 315 -334 l 266 -187 q 345 -203 307 -203 q 459 -75 433 -203 l 572 455 q 584 544 584 517 q 497 633 584 633 q 400 595 448 633 q 315 483 353 556 q 258 318 277 410 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 424 727 364 691 q 554 764 484 764 q 694 712 644 764 q 744 565 744 660 q 729 443 744 526 l 623 -59 q 569 -222 600 -167 q 489 -305 538 -277 q 366 -334 439 -334 "},"}":{"x_min":-59.6875,"x_max":489,"ha":489,"o":"m 183 992 q 398 832 398 992 q 387 742 398 791 l 356 604 q 347 538 347 560 q 489 442 347 442 l 462 315 q 332 287 380 315 q 269 190 284 258 l 226 -16 q 142 -174 203 -129 q -40 -220 82 -220 l -59 -220 l -59 -95 q 43 -71 12 -94 q 87 6 75 -47 l 134 216 q 193 332 151 290 q 315 385 236 373 l 315 389 q 208 534 208 421 q 219 616 208 572 l 248 750 q 255 800 255 780 q 226 853 255 840 q 144 867 197 867 l 168 992 l 183 992 "},"â":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 721 842 l 618 842 q 509 962 567 884 q 349 842 420 887 l 238 842 l 238 858 q 374 991 331 945 q 435 1064 417 1036 l 603 1064 q 721 858 629 997 l 721 842 "},"ø":{"x_min":34.59375,"x_max":755.546875,"ha":796,"o":"m 730 474 q 680 219 730 333 q 544 46 630 105 q 348 -12 458 -12 q 189 27 255 -12 l 118 -60 l 34 4 l 112 99 q 65 276 65 170 q 112 524 65 412 q 248 698 160 635 q 450 762 335 762 q 612 720 542 762 l 670 793 l 755 728 l 687 649 q 730 474 730 581 m 442 634 q 283 535 347 634 q 219 288 219 437 q 225 238 219 262 l 524 610 q 442 634 494 634 m 358 114 q 468 159 418 114 q 547 283 518 204 q 576 458 576 363 q 572 503 576 488 l 276 136 q 358 114 304 114 "},"‰":{"x_min":95.625,"x_max":1565.34375,"ha":1621,"o":"m 359 892 q 292 850 322 892 q 244 733 262 809 q 226 587 226 657 q 280 495 226 495 q 345 534 316 495 q 395 654 375 574 q 415 803 415 733 q 359 892 415 892 m 545 804 q 508 591 545 695 q 408 435 470 487 q 269 383 347 383 q 140 436 185 383 q 95 591 95 490 q 131 804 95 704 q 228 955 167 904 q 369 1006 288 1006 q 500 954 455 1006 q 545 804 545 902 m 1024 992 l 288 0 l 156 0 l 893 992 l 1024 992 m 1378 496 q 1313 457 1342 496 q 1264 342 1283 418 q 1244 190 1244 266 q 1300 99 1244 99 q 1366 140 1336 99 q 1415 261 1396 182 q 1435 407 1435 340 q 1378 496 1435 496 m 1565 409 q 1527 195 1565 300 q 1429 38 1490 90 q 1290 -14 1368 -14 q 1159 37 1204 -14 q 1113 189 1113 89 q 1149 406 1113 306 q 1246 558 1185 507 q 1387 609 1307 609 q 1519 558 1473 609 q 1565 409 1565 507 m 901 496 q 836 457 866 496 q 787 341 807 418 q 768 190 768 263 q 823 99 768 99 q 888 139 858 99 q 938 257 918 178 q 958 407 958 336 q 901 496 958 496 m 1089 409 q 1051 195 1089 300 q 952 38 1013 90 q 813 -14 890 -14 q 682 37 727 -14 q 637 189 637 89 q 673 406 637 305 q 770 558 709 507 q 910 609 830 609 q 1043 558 996 609 q 1089 409 1089 507 "},"Ä":{"x_min":-82.0625,"x_max":772.09375,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 350 1164 q 374 1231 350 1205 q 441 1257 398 1257 q 493 1241 473 1257 q 512 1192 512 1225 q 488 1123 512 1148 q 424 1098 464 1098 q 371 1113 392 1098 q 350 1164 350 1129 m 610 1164 q 634 1231 610 1205 q 700 1257 658 1257 q 752 1241 733 1257 q 772 1192 772 1225 q 748 1123 772 1148 q 684 1098 723 1098 q 631 1113 652 1098 q 610 1164 610 1129 "},"Ỵ":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 163 -192 q 189 -117 163 -145 q 263 -89 215 -89 q 321 -106 300 -89 q 343 -161 343 -124 q 316 -237 343 -209 q 245 -265 289 -265 q 186 -247 210 -265 q 163 -192 163 -230 "},"ř":{"x_min":31.875,"x_max":683.421875,"ha":567,"o":"m 540 764 q 613 755 582 764 l 579 607 q 510 616 542 616 q 357 540 424 616 q 263 339 290 463 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 421 728 364 692 q 540 764 477 764 m 201 1064 l 302 1064 q 412 943 349 1024 q 573 1064 496 1014 l 683 1064 l 683 1045 q 568 935 629 997 q 486 842 508 873 l 317 842 q 201 1045 288 916 l 201 1064 "},"—":{"x_min":31.875,"x_max":1296.078125,"ha":1333,"o":"m 31 307 l 61 439 l 1296 439 l 1266 307 l 31 307 "},"N":{"x_min":46.125,"x_max":1018.015625,"ha":1011,"o":"m 808 0 l 632 0 l 354 789 l 349 789 l 343 742 q 319 598 326 641 q 194 0 311 555 l 46 0 l 255 992 l 437 992 l 708 212 l 712 212 q 733 342 716 249 q 760 481 750 436 l 869 992 l 1018 992 l 808 0 "},"⁄":{"x_min":-345.890625,"x_max":522.234375,"ha":178,"o":"m 522 992 l -212 0 l -345 0 l 389 992 l 522 992 "},"2":{"x_min":-12.203125,"x_max":737.234375,"ha":765,"o":"m 617 0 l -12 0 l 12 122 l 331 408 q 493 565 451 516 q 554 655 535 613 q 573 744 573 697 q 540 836 573 802 q 445 869 506 869 q 351 849 398 869 q 236 775 304 828 l 158 883 q 314 977 239 949 q 469 1006 389 1006 q 664 942 592 1006 q 737 772 737 879 q 710 636 737 699 q 627 507 684 573 q 434 324 570 440 l 223 145 l 223 140 l 645 140 l 617 0 "},"ü":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 292 935 q 316 1002 292 976 q 383 1028 340 1028 q 435 1012 415 1028 q 454 963 454 996 q 430 894 454 919 q 366 869 406 869 q 313 884 334 869 q 292 935 292 900 m 552 935 q 576 1002 552 976 q 642 1028 600 1028 q 694 1012 675 1028 q 714 963 714 996 q 690 894 714 919 q 626 869 665 869 q 573 884 594 869 q 552 935 552 900 "},"˜":{"x_min":221.09375,"x_max":754.1875,"ha":770,"o":"m 577 841 q 521 852 547 841 q 473 878 496 864 q 428 904 450 892 q 385 915 407 915 q 343 897 360 915 q 314 840 326 878 l 221 840 q 394 1034 259 1034 q 452 1021 425 1034 q 501 995 478 1009 q 544 969 524 981 q 584 957 564 957 q 628 975 611 957 q 661 1035 645 993 l 754 1035 q 577 841 709 841 "},"Ó":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 533 1087 q 686 1293 599 1161 l 865 1293 l 865 1280 q 758 1170 828 1235 q 639 1071 687 1106 l 533 1071 l 533 1087 "}," ":{"x_min":0,"x_max":0,"ha":695},"ˇ":{"x_min":286.203125,"x_max":768.421875,"ha":770,"o":"m 286 1064 l 387 1064 q 497 943 434 1024 q 658 1064 581 1014 l 768 1064 l 768 1045 q 653 935 714 997 q 571 842 593 873 l 402 842 q 286 1045 373 916 l 286 1064 "},"Ÿ":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 298 1164 q 322 1231 298 1205 q 389 1257 346 1257 q 441 1241 421 1257 q 460 1192 460 1225 q 436 1123 460 1148 q 372 1098 412 1098 q 319 1113 340 1098 q 298 1164 298 1129 m 558 1164 q 582 1231 558 1205 q 648 1257 606 1257 q 700 1241 681 1257 q 720 1192 720 1225 q 696 1123 720 1148 q 632 1098 671 1098 q 579 1113 600 1098 q 558 1164 558 1129 "},"ų":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 609 0 q 507 -98 534 -59 q 480 -172 480 -137 q 492 -205 480 -194 q 523 -216 503 -216 q 585 -207 549 -216 l 585 -302 q 492 -317 541 -317 q 393 -285 431 -317 q 356 -196 356 -253 q 388 -95 356 -141 q 502 0 420 -50 l 609 0 "},"Ŭ":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 857 1277 q 776 1121 836 1171 q 612 1071 715 1071 q 471 1115 522 1071 q 420 1239 420 1160 q 422 1277 420 1264 l 514 1277 q 539 1212 514 1234 q 623 1191 564 1191 q 714 1212 682 1191 q 757 1277 747 1234 l 857 1277 "},"ĝ":{"x_min":-82.0625,"x_max":775.203125,"ha":724,"o":"m 775 750 l 754 657 l 623 634 q 642 542 642 595 q 562 334 642 411 q 345 257 481 257 q 283 262 310 257 q 208 191 208 235 q 229 156 208 166 q 291 141 250 146 l 377 130 q 548 71 497 115 q 600 -55 600 26 q 497 -261 600 -188 q 206 -334 395 -334 q -6 -283 69 -334 q -82 -143 -82 -232 q -34 -22 -82 -73 q 116 63 12 28 q 65 149 65 94 q 96 230 65 196 q 196 297 128 265 q 104 468 104 352 q 187 682 104 601 q 406 764 270 764 q 515 750 461 764 l 775 750 m 219 12 q 103 -36 143 0 q 62 -125 62 -72 q 100 -195 62 -169 q 215 -221 137 -221 q 387 -184 325 -221 q 450 -79 450 -148 q 419 -25 450 -45 q 312 2 389 -5 l 219 12 m 402 657 q 325 631 358 657 q 274 560 292 605 q 255 461 255 514 q 279 386 255 413 q 348 360 303 360 q 424 387 392 360 q 475 459 457 413 q 493 561 493 506 q 402 657 493 657 m 724 842 l 621 842 q 512 962 570 884 q 352 842 423 887 l 241 842 l 241 858 q 377 991 334 945 q 438 1064 420 1036 l 606 1064 q 724 858 632 997 l 724 842 "},"ß":{"x_min":-174.984375,"x_max":817.9375,"ha":859,"o":"m -79 -334 q -174 -318 -126 -334 l -174 -187 q -98 -201 -133 -201 q -26 -172 -54 -201 q 16 -72 2 -142 l 194 764 q 311 990 227 921 q 548 1060 396 1060 q 747 1005 676 1060 q 817 859 817 951 q 696 657 817 745 q 595 575 616 597 q 575 530 575 553 q 625 461 575 500 q 722 375 697 404 q 759 312 746 346 q 772 238 772 279 q 693 53 772 121 q 480 -14 615 -14 q 288 30 357 -14 l 288 166 q 459 108 374 108 q 571 137 531 108 q 611 222 611 167 q 595 279 611 254 q 519 352 579 304 q 437 434 463 395 q 411 520 411 473 q 441 614 411 571 q 533 699 471 658 q 627 775 599 743 q 654 841 654 806 q 622 910 654 885 q 533 934 590 934 q 355 772 390 934 l 176 -82 q 85 -274 147 -215 q -79 -334 22 -334 "},"Ể":{"x_min":47.46875,"x_max":913.390625,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 477 1271 l 644 1271 q 751 1086 674 1190 l 747 1071 l 666 1071 q 549 1180 604 1113 q 385 1071 462 1111 l 292 1071 l 295 1087 q 477 1271 437 1220 m 731 1206 l 738 1277 q 807 1295 785 1282 q 828 1332 828 1308 q 780 1362 828 1362 q 727 1354 749 1362 l 727 1422 q 796 1429 749 1429 q 881 1406 850 1429 q 913 1341 913 1384 q 809 1237 913 1261 l 799 1206 l 731 1206 "},"̀":{"x_min":-511.078125,"x_max":-255.390625,"ha":0,"o":"m -255 842 l -353 842 q -442 944 -397 884 q -511 1049 -488 1004 l -511 1064 l -344 1064 q -255 858 -313 959 l -255 842 "},"s":{"x_min":9.5,"x_max":597.515625,"ha":625,"o":"m 530 230 q 450 49 530 112 q 227 -14 370 -14 q 9 31 99 -14 l 9 169 q 221 108 113 108 q 327 135 286 108 q 368 209 368 162 q 344 268 368 243 q 248 334 321 293 q 129 427 164 380 q 94 539 94 474 q 166 704 94 644 q 362 764 239 764 q 597 707 495 764 l 545 587 q 365 639 451 639 q 285 616 316 639 q 254 554 254 594 q 276 499 254 523 q 368 438 299 476 q 469 370 439 398 q 514 308 499 341 q 530 230 530 274 "},"ẳ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 466 1008 l 472 1077 q 534 1095 514 1083 q 555 1131 555 1107 q 510 1157 555 1157 q 461 1150 481 1157 l 461 1211 q 526 1220 485 1220 q 606 1199 577 1220 q 636 1140 636 1178 q 611 1073 636 1101 q 538 1035 586 1045 l 529 1008 l 466 1008 m 497 842 q 354 892 405 842 q 302 1031 302 942 l 303 1044 l 388 1044 q 424 968 395 991 q 506 945 454 945 q 655 1044 613 945 l 744 1044 q 657 894 720 946 q 497 842 595 842 "},"Ű":{"x_min":103.09375,"x_max":996.59375,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 428 1087 q 518 1198 473 1138 q 583 1293 563 1259 l 746 1293 l 746 1280 q 642 1174 719 1245 q 517 1071 565 1104 l 428 1071 l 428 1087 m 678 1087 q 835 1293 759 1177 l 996 1293 l 996 1280 q 889 1171 961 1236 q 768 1071 816 1105 l 678 1071 l 678 1087 "},"?":{"x_min":109.875,"x_max":653.125,"ha":615,"o":"m 176 301 q 224 450 188 391 q 344 571 261 509 q 443 650 417 623 q 483 705 470 677 q 495 765 495 732 q 466 842 495 812 q 383 872 438 872 q 281 853 330 872 q 179 810 231 835 l 126 929 q 404 1006 266 1006 q 586 947 520 1006 q 653 783 653 889 q 610 635 653 702 q 453 488 567 569 q 351 398 382 438 q 309 301 320 358 l 176 301 m 109 64 q 141 153 109 120 q 230 187 173 187 q 291 166 268 187 q 314 103 314 144 q 280 15 314 49 q 196 -18 247 -18 q 130 5 151 -18 q 109 64 109 28 "},"ỡ":{"x_min":63.75,"x_max":965.109375,"ha":836,"o":"m 450 762 q 673 663 598 762 q 751 728 721 682 q 797 864 781 775 l 959 864 l 965 848 q 879 679 937 741 q 715 577 822 616 q 731 469 731 529 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 576 841 q 520 852 546 841 q 472 878 495 864 q 427 904 449 892 q 384 915 406 915 q 342 897 359 915 q 313 840 325 878 l 220 840 q 393 1034 258 1034 q 451 1021 424 1034 q 500 995 477 1009 q 543 969 523 981 q 583 957 563 957 q 627 975 610 957 q 660 1035 644 993 l 753 1035 q 576 841 708 841 "},"Ņ":{"x_min":46.125,"x_max":1018.015625,"ha":1011,"o":"m 808 0 l 632 0 l 354 789 l 349 789 l 343 742 q 319 598 326 641 q 194 0 311 555 l 46 0 l 255 992 l 437 992 l 708 212 l 712 212 q 733 342 716 249 q 760 481 750 436 l 869 992 l 1018 992 l 808 0 m 258 -288 q 349 -85 317 -183 l 500 -85 l 500 -98 q 437 -201 480 -142 q 349 -307 393 -260 l 258 -307 l 258 -288 "},"c":{"x_min":63.75,"x_max":659.90625,"ha":647,"o":"m 343 -14 q 137 57 210 -14 q 63 263 63 129 q 113 519 63 404 q 253 699 163 634 q 458 764 343 764 q 659 722 569 764 l 612 597 q 462 633 529 633 q 292 529 360 633 q 225 271 225 425 q 263 155 225 196 q 368 114 301 114 q 462 129 418 114 q 550 166 505 144 l 550 34 q 343 -14 455 -14 "},"¶":{"x_min":116.65625,"x_max":816.578125,"ha":910,"o":"m 816 -176 l 722 -176 l 722 934 l 594 934 l 594 -176 l 499 -176 l 499 379 q 401 367 457 367 q 185 451 255 367 q 116 706 116 536 q 190 968 116 882 q 422 1055 264 1055 l 816 1055 l 816 -176 "},"Ī":{"x_min":47.46875,"x_max":572.71875,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 178 1190 l 572 1190 l 547 1071 l 152 1071 l 178 1190 "},"•":{"x_min":103.09375,"x_max":458.484375,"ha":513,"o":"m 103 464 q 159 634 103 569 q 311 700 216 700 q 418 663 379 700 q 458 548 458 626 q 402 378 458 443 q 248 313 347 313 q 141 351 179 313 q 103 464 103 390 "},"Ὅ":{"x_min":-139.96875,"x_max":1038.75,"ha":1082,"o":"m 1038 625 q 974 287 1038 435 q 796 63 909 140 q 534 -14 684 -14 q 262 87 359 -14 q 166 367 166 188 q 233 698 166 549 q 416 927 300 848 q 679 1007 532 1007 q 944 905 849 1007 q 1038 625 1038 804 m 666 867 q 496 802 572 867 q 377 622 420 737 q 334 369 334 506 q 390 188 334 251 q 544 124 445 124 q 712 189 637 124 q 829 368 787 253 q 871 623 871 483 q 817 803 871 739 q 666 867 764 867 m 48 785 q 148 992 106 891 l 300 992 l 300 975 q 123 767 221 867 l 48 767 l 48 785 m -139 838 q 58 1004 -139 964 l 52 949 q -16 921 7 936 q -40 886 -40 907 q -32 869 -40 875 q -14 857 -23 863 q 3 843 -5 851 q 11 818 11 834 q -7 777 11 793 q -59 762 -26 762 q -117 782 -95 762 q -139 838 -139 802 "},"(":{"x_min":52.90625,"x_max":536.46875,"ha":433,"o":"m 52 187 q 137 616 52 419 q 394 992 221 812 l 536 992 q 198 184 198 620 q 276 -220 198 -38 l 152 -220 q 52 187 52 -42 "},"Ụ":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 290 -192 q 316 -117 290 -145 q 390 -89 342 -89 q 448 -106 427 -89 q 470 -161 470 -124 q 443 -237 470 -209 q 372 -265 416 -265 q 313 -247 337 -265 q 290 -192 290 -230 "},"◊":{"x_min":88.84375,"x_max":763.671875,"ha":810,"o":"m 763 498 l 458 0 l 394 0 l 88 498 l 394 999 l 458 999 l 763 498 m 615 498 l 426 815 l 237 498 l 426 181 l 615 498 "},"Ỗ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 762 1299 q 709 1308 734 1299 q 661 1328 684 1317 q 616 1349 637 1340 q 574 1359 595 1359 q 532 1342 546 1359 q 506 1298 517 1325 l 426 1298 q 482 1415 443 1376 q 580 1455 522 1455 q 631 1445 606 1455 q 680 1424 656 1435 q 725 1402 703 1412 q 768 1393 747 1393 q 809 1408 793 1393 q 838 1456 824 1423 l 916 1456 q 762 1299 877 1299 m 566 1266 l 733 1266 q 843 1086 756 1203 l 839 1071 l 758 1071 q 638 1174 698 1111 q 479 1071 553 1111 l 384 1071 l 387 1087 l 430 1128 q 566 1266 526 1214 "},"­":{"x_min":31.875,"x_max":402.859375,"ha":440,"o":"m 31 302 l 62 440 l 402 440 l 372 302 l 31 302 "},"Ħ":{"x_min":47.46875,"x_max":1055.3125,"ha":957,"o":"m 931 841 l 1055 841 l 1032 725 l 906 725 l 754 0 l 591 0 l 686 446 l 302 446 l 208 0 l 47 0 l 200 725 l 76 725 l 101 841 l 225 841 l 257 992 l 417 992 l 385 841 l 769 841 l 801 992 l 963 992 l 931 841 m 715 586 l 744 725 l 360 725 l 331 586 l 715 586 "},":":{"x_min":22.375,"x_max":343.1875,"ha":374,"o":"m 139 642 q 170 732 139 698 q 259 766 202 766 q 320 744 297 766 q 343 681 343 723 q 310 593 343 628 q 225 559 277 559 q 159 583 180 559 q 139 642 139 607 m 22 63 q 54 153 22 119 q 143 186 86 186 q 203 165 181 186 q 226 102 226 144 q 194 14 226 49 q 109 -20 162 -20 q 43 4 65 -20 q 22 63 22 28 "},"Û":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 846 1071 l 743 1071 q 634 1191 692 1113 q 474 1071 545 1116 l 363 1071 l 363 1087 q 499 1220 456 1174 q 560 1293 542 1265 l 728 1293 q 846 1087 754 1226 l 846 1071 "},"Ầ":{"x_min":-82.0625,"x_max":771.296875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 497 1271 l 664 1271 q 771 1086 694 1190 l 767 1071 l 686 1071 q 569 1180 624 1113 q 405 1071 482 1111 l 312 1071 l 315 1087 q 497 1271 457 1220 m 316 1203 q 248 1276 282 1234 q 197 1344 213 1319 l 197 1357 l 322 1357 q 355 1284 333 1326 q 391 1216 376 1241 l 391 1203 l 316 1203 "},"ś":{"x_min":9.5,"x_max":648.1875,"ha":625,"o":"m 530 230 q 450 49 530 112 q 227 -14 370 -14 q 9 31 99 -14 l 9 169 q 221 108 113 108 q 327 135 286 108 q 368 209 368 162 q 344 268 368 243 q 248 334 321 293 q 129 427 164 380 q 94 539 94 474 q 166 704 94 644 q 362 764 239 764 q 597 707 495 764 l 545 587 q 365 639 451 639 q 285 616 316 639 q 254 554 254 594 q 276 499 254 523 q 368 438 299 476 q 469 370 439 398 q 514 308 499 341 q 530 230 530 274 m 316 858 q 469 1064 382 932 l 648 1064 l 648 1051 q 541 941 611 1006 q 422 842 470 877 l 316 842 l 316 858 "},"V":{"x_min":126.15625,"x_max":916.953125,"ha":790,"o":"m 343 168 q 436 377 390 289 l 744 992 l 916 992 l 398 0 l 223 0 l 126 992 l 283 992 l 333 377 q 341 219 339 308 l 340 168 l 343 168 "},"Ŗ":{"x_min":47.46875,"x_max":798.953125,"ha":818,"o":"m 291 396 l 208 0 l 47 0 l 257 992 l 486 992 q 718 927 637 992 q 798 730 798 863 q 740 542 798 619 q 565 429 681 465 l 734 0 l 558 0 l 417 396 l 291 396 m 320 531 l 404 531 q 576 581 519 531 q 633 721 633 632 q 593 823 633 792 q 469 855 553 855 l 388 855 l 320 531 m 207 -288 q 298 -85 266 -183 l 449 -85 l 449 -98 q 386 -201 429 -142 q 298 -307 342 -260 l 207 -307 l 207 -288 "}," ":{"x_min":0,"x_max":0,"ha":361},"Ỹ":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 598 1070 q 542 1081 568 1070 q 494 1107 517 1093 q 449 1133 471 1121 q 406 1144 428 1144 q 364 1126 381 1144 q 335 1069 347 1107 l 242 1069 q 415 1263 280 1263 q 473 1250 446 1263 q 522 1224 499 1238 q 565 1198 545 1210 q 605 1186 585 1186 q 649 1204 632 1186 q 682 1264 666 1222 l 775 1264 q 598 1070 730 1070 "},"ʼ":{"x_min":78,"x_max":379.125,"ha":267,"o":"m 373 992 l 379 977 q 304 829 354 920 q 198 652 254 738 l 78 652 q 149 825 107 716 q 212 992 192 933 l 373 992 "},"@":{"x_min":67.828125,"x_max":1157.046875,"ha":1182,"o":"m 1157 573 q 1116 354 1157 454 q 1003 199 1076 255 q 841 143 931 143 q 739 174 775 143 q 695 255 704 205 l 691 255 q 503 143 623 143 q 375 196 420 143 q 330 344 330 249 q 376 533 330 446 q 503 671 421 620 q 682 722 585 722 q 746 718 717 722 q 800 709 775 715 q 887 683 825 704 l 819 417 q 798 309 798 340 q 852 247 798 247 q 943 292 901 247 q 1009 410 985 337 q 1033 566 1033 484 q 946 802 1033 721 q 699 883 859 883 q 438 816 554 883 q 258 625 322 748 q 193 349 193 501 q 288 78 193 174 q 554 -18 383 -18 q 845 40 689 -18 l 845 -64 q 537 -126 697 -126 q 288 -69 395 -126 q 125 93 182 -12 q 67 340 67 198 q 150 672 67 523 q 383 905 233 820 q 718 990 533 990 q 952 939 853 990 q 1104 794 1051 888 q 1157 573 1157 699 m 670 618 q 563 582 612 618 q 486 485 514 546 q 458 353 458 423 q 534 247 458 247 q 630 296 590 247 q 698 445 670 345 l 741 608 q 670 618 706 618 "},"¾":{"x_min":73.53125,"x_max":1073.59375,"ha":1141,"o":"m 1065 992 l 330 0 l 197 0 l 932 992 l 1065 992 m 1053 120 l 971 120 l 944 0 l 820 0 l 847 120 l 597 120 l 615 212 l 938 599 l 1072 599 l 990 217 l 1073 217 l 1053 120 m 866 217 l 902 367 l 925 454 q 858 365 903 419 l 731 217 l 866 217 m 534 862 q 497 761 534 801 q 390 703 460 721 l 390 700 q 468 655 443 688 q 493 577 493 622 q 425 438 493 490 q 243 386 358 386 q 73 423 149 386 l 73 531 q 241 483 158 483 q 336 508 302 483 q 369 580 369 533 q 270 656 369 656 l 197 656 l 216 747 l 279 747 q 376 770 340 747 q 412 837 412 793 q 333 904 412 904 q 205 860 270 904 l 159 942 q 357 1004 245 1004 q 487 966 441 1004 q 534 862 534 928 "},"ŉ":{"x_min":31,"x_max":844.6875,"ha":921,"o":"m 576 0 l 672 456 q 684 544 684 517 q 597 633 684 633 q 500 595 548 633 q 415 483 453 556 q 358 318 377 410 l 291 0 l 131 0 l 291 750 l 416 750 l 402 611 l 408 611 q 524 727 464 691 q 654 764 584 764 q 794 712 744 764 q 844 565 844 660 q 829 443 844 519 l 736 0 l 576 0 m 326 992 l 332 977 q 257 829 307 920 q 151 652 207 738 l 31 652 q 102 825 60 716 q 165 992 145 933 l 326 992 "},"i":{"x_min":31.875,"x_max":405.578125,"ha":382,"o":"m 223 935 q 250 1009 223 981 q 324 1038 276 1038 q 383 1020 360 1038 q 405 965 405 1002 q 378 889 405 917 q 307 862 351 862 q 247 879 271 862 q 223 935 223 897 m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 "},"ẽ":{"x_min":63.75,"x_max":745.1875,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 568 841 q 512 852 538 841 q 464 878 487 864 q 419 904 441 892 q 376 915 398 915 q 334 897 351 915 q 305 840 317 878 l 212 840 q 385 1034 250 1034 q 443 1021 416 1034 q 492 995 469 1009 q 535 969 515 981 q 575 957 555 957 q 619 975 602 957 q 652 1035 636 993 l 745 1035 q 568 841 700 841 "},"Ģ":{"x_min":91.5625,"x_max":930.515625,"ha":949,"o":"m 533 538 l 880 538 l 773 38 q 625 -1 697 11 q 463 -14 553 -14 q 189 85 286 -14 q 91 365 91 184 q 161 693 91 544 q 357 923 230 841 q 647 1006 484 1006 q 791 992 722 1006 q 930 944 860 978 l 869 807 q 642 865 751 865 q 448 804 535 865 q 310 629 360 742 q 259 376 259 515 q 320 188 259 251 q 491 124 380 124 q 637 146 565 124 l 691 398 l 503 398 l 533 538 m 291 -288 q 382 -85 350 -183 l 533 -85 l 533 -98 q 470 -201 513 -142 q 382 -307 426 -260 l 291 -307 l 291 -288 "},"m":{"x_min":31.875,"x_max":1159.765625,"ha":1234,"o":"m 547 764 q 719 604 696 764 l 725 604 q 840 723 775 683 q 975 764 905 764 q 1112 712 1065 764 q 1159 565 1159 660 q 1144 443 1159 522 l 1049 0 l 890 0 l 987 456 q 1000 546 1000 520 q 918 633 1000 633 q 781 549 845 633 q 689 326 718 465 l 620 0 l 461 0 l 558 456 q 569 542 569 511 q 490 633 569 633 q 352 547 415 633 q 258 318 288 461 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 547 764 408 764 "},"ĕ":{"x_min":63.75,"x_max":721.6875,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 721 1048 q 640 892 700 942 q 476 842 579 842 q 335 886 386 842 q 284 1010 284 931 q 286 1048 284 1035 l 378 1048 q 403 983 378 1005 q 487 962 428 962 q 578 983 546 962 q 621 1048 611 1005 l 721 1048 "},"Ỉ":{"x_min":47.46875,"x_max":542.96875,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 542 1257 q 405 1112 542 1148 l 390 1051 l 292 1051 l 304 1163 q 391 1192 365 1174 q 416 1240 416 1211 q 355 1281 416 1281 q 280 1272 327 1281 l 280 1361 q 379 1374 321 1374 q 499 1343 456 1374 q 542 1257 542 1313 "},"ż":{"x_min":-26.453125,"x_max":630.75,"ha":624,"o":"m 487 0 l -26 0 l -6 99 l 423 629 l 126 629 l 152 750 l 630 750 l 605 634 l 183 120 l 512 120 l 487 0 m 322 934 q 348 1008 322 980 q 423 1037 375 1037 q 481 1019 459 1037 q 504 964 504 1001 q 476 888 504 916 q 405 861 449 861 q 346 878 369 861 q 322 934 322 896 "},"Ị":{"x_min":1.0625,"x_max":417.78125,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 1 -192 q 27 -117 1 -145 q 101 -89 53 -89 q 159 -106 138 -89 q 181 -161 181 -124 q 154 -237 181 -209 q 83 -265 127 -265 q 24 -247 48 -265 q 1 -192 1 -230 "},"ő":{"x_min":63.75,"x_max":837.59375,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 269 858 q 359 969 314 909 q 424 1064 404 1030 l 587 1064 l 587 1051 q 483 945 560 1016 q 358 842 406 875 l 269 842 l 269 858 m 519 858 q 676 1064 600 948 l 837 1064 l 837 1051 q 730 942 802 1007 q 609 842 657 876 l 519 842 l 519 858 "},"ž":{"x_min":-26.453125,"x_max":684.421875,"ha":624,"o":"m 487 0 l -26 0 l -6 99 l 423 629 l 126 629 l 152 750 l 630 750 l 605 634 l 183 120 l 512 120 l 487 0 m 202 1064 l 303 1064 q 413 943 350 1024 q 574 1064 497 1014 l 684 1064 l 684 1045 q 569 935 630 997 q 487 842 509 873 l 318 842 q 202 1045 289 916 l 202 1064 "},"ự":{"x_min":73.921875,"x_max":1073.625,"ha":922,"o":"m 343 750 l 245 292 q 234 207 234 241 q 320 114 234 114 q 463 201 396 114 q 560 431 530 287 l 628 750 l 786 750 l 769 669 q 856 728 824 681 q 902 864 888 774 l 1068 864 l 1073 847 q 959 655 1043 728 q 747 565 875 582 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 73 186 73 89 q 91 316 73 231 l 183 750 l 343 750 m 237 -192 q 263 -117 237 -145 q 337 -89 289 -89 q 395 -106 374 -89 q 417 -161 417 -124 q 390 -237 417 -209 q 319 -265 363 -265 q 260 -247 284 -265 q 237 -192 237 -230 "},"ớ":{"x_min":63.75,"x_max":965.109375,"ha":836,"o":"m 450 762 q 673 663 598 762 q 751 728 721 682 q 797 864 781 775 l 959 864 l 965 848 q 879 679 937 741 q 715 577 822 616 q 731 469 731 529 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 387 858 q 540 1064 453 932 l 719 1064 l 719 1051 q 612 941 682 1006 q 493 842 541 877 l 387 842 l 387 858 "},"Ŏ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 859 1277 q 778 1121 838 1171 q 614 1071 717 1071 q 473 1115 524 1071 q 422 1239 422 1160 q 424 1277 422 1264 l 516 1277 q 541 1212 516 1234 q 625 1191 566 1191 q 716 1212 684 1191 q 759 1277 749 1234 l 859 1277 "},"á":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 405 858 q 558 1064 471 932 l 737 1064 l 737 1051 q 630 941 700 1006 q 511 842 559 877 l 405 842 l 405 858 "},"×":{"x_min":99.703125,"x_max":694.5,"ha":765,"o":"m 309 490 l 99 701 l 184 786 l 396 576 l 608 786 l 694 702 l 480 490 l 691 278 l 608 195 l 396 404 l 184 196 l 101 279 l 309 490 "},"ẩ":{"x_min":63.75,"x_max":876.390625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 440 1042 l 607 1042 q 714 857 637 961 l 710 842 l 629 842 q 512 951 567 884 q 348 842 425 882 l 255 842 l 258 858 q 440 1042 400 991 m 694 977 l 701 1048 q 770 1066 748 1053 q 791 1103 791 1079 q 743 1133 791 1133 q 690 1125 712 1133 l 690 1193 q 759 1200 712 1200 q 844 1177 813 1200 q 876 1112 876 1155 q 772 1008 876 1032 l 762 977 l 694 977 "},"İ":{"x_min":47.46875,"x_max":464.15625,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 282 1163 q 308 1237 282 1209 q 383 1266 335 1266 q 441 1248 419 1266 q 464 1193 464 1230 q 436 1117 464 1145 q 365 1090 409 1090 q 306 1107 329 1090 q 282 1163 282 1125 "},"̏":{"x_min":-659.90625,"x_max":-165.484375,"ha":0,"o":"m -412 842 l -502 842 q -590 943 -543 882 q -659 1049 -636 1003 l -659 1064 l -501 1064 q -412 858 -472 962 l -412 842 m -165 842 l -255 842 q -344 945 -299 885 q -412 1049 -390 1006 l -412 1064 l -254 1064 q -165 858 -225 962 l -165 842 "},"Ě":{"x_min":47.46875,"x_max":799.421875,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 317 1293 l 418 1293 q 528 1172 465 1253 q 689 1293 612 1243 l 799 1293 l 799 1274 q 684 1164 745 1226 q 602 1071 624 1102 l 433 1071 q 317 1274 404 1145 l 317 1293 "},"Ố":{"x_min":91.5625,"x_max":1068.4375,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 571 1271 l 738 1271 q 845 1086 768 1190 l 841 1071 l 760 1071 q 643 1180 698 1113 q 479 1071 556 1111 l 386 1071 l 389 1087 q 571 1271 531 1220 m 810 1216 q 926 1357 881 1291 l 1068 1357 l 1068 1344 q 992 1275 1044 1318 q 894 1203 940 1232 l 810 1203 l 810 1216 "},"Ǻ":{"x_min":-80.703125,"x_max":828.109375,"ha":821,"o":"m 698 980 q 641 858 698 903 l 747 0 l 588 0 l 559 269 l 231 269 l 90 0 l -80 0 l 402 891 q 379 979 379 924 q 423 1090 379 1049 q 537 1132 467 1132 q 653 1090 608 1132 q 698 980 698 1049 m 491 1180 q 567 1252 520 1205 q 640 1331 614 1299 l 828 1331 l 828 1321 q 727 1244 792 1288 q 604 1168 662 1200 l 491 1168 l 491 1180 m 608 979 q 588 1031 608 1012 q 537 1051 569 1051 q 485 1031 505 1051 q 465 979 465 1012 q 483 926 465 945 q 537 908 501 908 q 588 926 569 908 q 608 979 608 945 m 499 798 q 468 729 484 764 q 305 410 451 693 l 548 410 q 519 703 522 655 q 514 798 516 750 l 499 798 "},"K":{"x_min":47.46875,"x_max":937.296875,"ha":813,"o":"m 737 0 l 559 0 l 388 444 l 287 376 l 208 0 l 47 0 l 257 992 l 417 992 l 315 512 l 411 625 l 744 992 l 937 992 l 519 538 l 737 0 "},"7":{"x_min":84.78125,"x_max":800.296875,"ha":765,"o":"m 84 0 l 596 852 l 139 852 l 168 992 l 800 992 l 777 878 l 263 0 l 84 0 "},"¨":{"x_min":288.921875,"x_max":710.09375,"ha":770,"o":"m 288 935 q 312 1002 288 976 q 379 1028 336 1028 q 431 1012 411 1028 q 450 963 450 996 q 426 894 450 919 q 362 869 402 869 q 309 884 330 869 q 288 935 288 900 m 548 935 q 572 1002 548 976 q 638 1028 596 1028 q 690 1012 671 1028 q 710 963 710 996 q 686 894 710 919 q 622 869 661 869 q 569 884 590 869 q 548 935 548 900 "},"Y":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 "},"E":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 "},"Ô":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 859 1071 l 756 1071 q 647 1191 705 1113 q 487 1071 558 1116 l 376 1071 l 376 1087 q 512 1220 469 1174 q 573 1293 555 1265 l 741 1293 q 859 1087 767 1226 l 859 1071 "},"Ț":{"x_min":92.265625,"x_max":826.75,"ha":714,"o":"m 358 0 l 197 0 l 376 852 l 119 852 l 149 992 l 826 992 l 797 852 l 539 852 l 358 0 m 92 -288 q 183 -85 151 -183 l 334 -85 l 334 -98 q 271 -201 314 -142 q 183 -307 227 -260 l 92 -307 l 92 -288 "},"‹":{"x_min":54.265625,"x_max":413.71875,"ha":421,"o":"m 54 388 l 322 675 l 413 594 l 218 368 l 322 119 l 201 68 l 54 372 l 54 388 "},"ổ":{"x_min":63.75,"x_max":860.390625,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 424 1042 l 591 1042 q 698 857 621 961 l 694 842 l 613 842 q 496 951 551 884 q 332 842 409 882 l 239 842 l 242 858 q 424 1042 384 991 m 678 977 l 685 1048 q 754 1066 732 1053 q 775 1103 775 1079 q 727 1133 775 1133 q 674 1125 696 1133 l 674 1193 q 743 1200 696 1200 q 828 1177 797 1200 q 860 1112 860 1155 q 756 1008 860 1032 l 746 977 l 678 977 "},"Ï":{"x_min":47.46875,"x_max":586.09375,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 164 1164 q 188 1231 164 1205 q 255 1257 212 1257 q 307 1241 287 1257 q 326 1192 326 1225 q 302 1123 326 1148 q 238 1098 278 1098 q 185 1113 206 1098 q 164 1164 164 1129 m 424 1164 q 448 1231 424 1205 q 514 1257 472 1257 q 566 1241 547 1257 q 586 1192 586 1225 q 562 1123 586 1148 q 498 1098 537 1098 q 445 1113 466 1098 q 424 1164 424 1129 "},"ġ":{"x_min":-82.0625,"x_max":775.203125,"ha":724,"o":"m 775 750 l 754 657 l 623 634 q 642 542 642 595 q 562 334 642 411 q 345 257 481 257 q 283 262 310 257 q 208 191 208 235 q 229 156 208 166 q 291 141 250 146 l 377 130 q 548 71 497 115 q 600 -55 600 26 q 497 -261 600 -188 q 206 -334 395 -334 q -6 -283 69 -334 q -82 -143 -82 -232 q -34 -22 -82 -73 q 116 63 12 28 q 65 149 65 94 q 96 230 65 196 q 196 297 128 265 q 104 468 104 352 q 187 682 104 601 q 406 764 270 764 q 515 750 461 764 l 775 750 m 219 12 q 103 -36 143 0 q 62 -125 62 -72 q 100 -195 62 -169 q 215 -221 137 -221 q 387 -184 325 -221 q 450 -79 450 -148 q 419 -25 450 -45 q 312 2 389 -5 l 219 12 m 402 657 q 325 631 358 657 q 274 560 292 605 q 255 461 255 514 q 279 386 255 413 q 348 360 303 360 q 424 387 392 360 q 475 459 457 413 q 493 561 493 506 q 402 657 493 657 m 414 934 q 440 1008 414 980 q 515 1037 467 1037 q 573 1019 551 1037 q 596 964 596 1001 q 568 888 596 916 q 497 861 541 861 q 438 878 461 861 q 414 934 414 896 "},"Ẳ":{"x_min":-82.0625,"x_max":793.078125,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 515 1237 l 521 1306 q 583 1324 563 1312 q 604 1360 604 1336 q 559 1386 604 1386 q 510 1379 530 1386 l 510 1440 q 575 1449 534 1449 q 655 1428 626 1449 q 685 1369 685 1407 q 660 1302 685 1330 q 587 1264 635 1274 l 578 1237 l 515 1237 m 546 1071 q 403 1121 454 1071 q 351 1260 351 1171 l 352 1273 l 437 1273 q 473 1197 444 1220 q 555 1174 503 1174 q 704 1273 662 1174 l 793 1273 q 706 1123 769 1175 q 546 1071 644 1071 "},"ứ":{"x_min":73.921875,"x_max":1073.625,"ha":922,"o":"m 343 750 l 245 292 q 234 207 234 241 q 320 114 234 114 q 463 201 396 114 q 560 431 530 287 l 628 750 l 786 750 l 769 669 q 856 728 824 681 q 902 864 888 774 l 1068 864 l 1073 847 q 959 655 1043 728 q 747 565 875 582 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 73 186 73 89 q 91 316 73 231 l 183 750 l 343 750 m 410 858 q 563 1064 476 932 l 742 1064 l 742 1051 q 635 941 705 1006 q 516 842 564 877 l 410 842 l 410 858 "},"ủ":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 683 1028 q 546 883 683 919 l 531 822 l 433 822 l 445 934 q 532 963 506 945 q 557 1011 557 982 q 496 1052 557 1052 q 421 1043 468 1052 l 421 1132 q 520 1145 462 1145 q 640 1114 597 1145 q 683 1028 683 1084 "},"Ằ":{"x_min":-82.0625,"x_max":795.078125,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 557 1247 q 485 1321 521 1280 q 434 1389 450 1362 l 435 1402 l 554 1402 q 624 1261 574 1343 l 621 1247 l 557 1247 m 548 1071 q 405 1121 456 1071 q 353 1259 353 1171 l 354 1272 l 439 1272 q 475 1197 446 1220 q 557 1174 505 1174 q 706 1272 664 1174 l 795 1272 q 708 1123 771 1175 q 548 1071 646 1071 "},"ķ":{"x_min":31.875,"x_max":786.0625,"ha":733,"o":"m 601 750 l 786 750 l 458 421 l 655 0 l 478 0 l 336 319 l 244 254 l 191 0 l 31 0 l 255 1055 l 415 1055 q 306 560 323 629 q 266 406 290 490 l 269 406 l 601 750 m 159 -288 q 250 -85 218 -183 l 401 -85 l 401 -98 q 338 -201 381 -142 q 250 -307 294 -260 l 159 -307 l 159 -288 "},"Ấ":{"x_min":-82.0625,"x_max":994.4375,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 497 1271 l 664 1271 q 771 1086 694 1190 l 767 1071 l 686 1071 q 569 1180 624 1113 q 405 1071 482 1111 l 312 1071 l 315 1087 q 497 1271 457 1220 m 736 1216 q 852 1357 807 1291 l 994 1357 l 994 1344 q 918 1275 970 1318 q 820 1203 866 1232 l 736 1203 l 736 1216 "}," ":{"x_min":0,"x_max":0,"ha":463},"ể":{"x_min":63.75,"x_max":851.390625,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 415 1042 l 582 1042 q 689 857 612 961 l 685 842 l 604 842 q 487 951 542 884 q 323 842 400 882 l 230 842 l 233 858 q 415 1042 375 991 m 669 977 l 676 1048 q 745 1066 723 1053 q 766 1103 766 1079 q 718 1133 766 1133 q 665 1125 687 1133 l 665 1193 q 734 1200 687 1200 q 819 1177 788 1200 q 851 1112 851 1155 q 747 1008 851 1032 l 737 977 l 669 977 "},"±":{"x_min":79.359375,"x_max":714.171875,"ha":765,"o":"m 336 445 l 79 445 l 79 568 l 336 568 l 336 826 l 458 826 l 458 568 l 714 568 l 714 445 l 458 445 l 458 191 l 336 191 l 336 445 m 79 0 l 79 122 l 714 122 l 714 0 l 79 0 "},"ì":{"x_min":31.875,"x_max":363.609375,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 363 842 l 265 842 q 176 944 221 884 q 107 1049 130 1004 l 107 1064 l 274 1064 q 363 858 305 959 l 363 842 "},"|":{"x_min":337.75,"x_max":458.484375,"ha":765,"o":"m 337 1053 l 458 1053 l 458 -326 l 337 -326 l 337 1053 "},"§":{"x_min":26.453125,"x_max":686.359375,"ha":675,"o":"m 109 517 q 258 725 109 645 q 205 781 226 747 q 184 859 184 815 q 260 1009 184 953 q 461 1065 335 1065 q 686 1012 581 1065 l 640 904 q 552 939 598 924 q 454 953 506 953 q 363 930 396 953 q 330 866 330 906 q 355 814 330 837 q 455 757 379 791 q 582 671 541 719 q 622 557 622 622 q 587 441 622 495 q 478 346 551 388 q 547 215 547 295 q 463 49 547 109 q 240 -10 380 -10 q 26 35 112 -10 l 26 162 q 242 99 129 99 q 360 126 321 99 q 400 202 400 154 q 373 256 400 231 q 278 313 347 280 q 149 402 189 354 q 109 517 109 451 m 345 668 q 270 615 299 651 q 242 537 242 579 q 274 466 242 495 q 392 398 305 436 q 459 459 434 422 q 484 537 484 496 q 451 608 484 578 q 345 668 417 638 "},"˳":{"x_min":-58.328125,"x_max":262.46875,"ha":463,"o":"m 262 -236 q 218 -346 262 -303 q 99 -390 174 -390 q -15 -348 26 -390 q -58 -237 -58 -307 q -15 -126 -58 -167 q 99 -85 27 -85 q 216 -126 170 -85 q 262 -236 262 -167 m 170 -237 q 151 -185 170 -204 q 99 -167 131 -167 q 48 -185 68 -167 q 27 -237 27 -204 q 46 -290 27 -271 q 99 -309 64 -309 q 151 -290 131 -309 q 170 -237 170 -271 "},"q":{"x_min":63.75,"x_max":780.640625,"ha":813,"o":"m 423 764 q 609 643 548 764 l 616 643 l 659 750 l 780 750 l 550 -334 l 392 -334 l 442 -97 q 472 24 451 -59 q 498 120 493 108 l 493 120 q 381 16 436 47 q 266 -14 327 -14 q 118 55 172 -14 q 63 248 63 125 q 113 511 63 389 q 243 698 162 632 q 423 764 324 764 m 333 114 q 441 169 387 114 q 528 314 495 224 q 560 497 560 404 q 530 597 560 561 q 444 633 499 633 q 335 581 385 633 q 255 438 285 528 q 225 252 225 349 q 333 114 225 114 "},"b":{"x_min":31.875,"x_max":748.765625,"ha":814,"o":"m 392 -14 q 277 16 325 -14 q 202 105 229 47 l 196 105 l 152 0 l 31 0 l 255 1055 l 415 1055 l 366 829 q 341 723 358 786 q 314 628 324 660 l 319 628 q 431 734 380 704 q 540 764 482 764 q 693 693 638 764 q 748 499 748 623 q 701 242 748 362 q 572 53 654 121 q 392 -14 490 -14 m 482 633 q 372 579 427 633 q 283 436 317 525 q 250 252 250 347 q 281 151 250 187 q 370 114 313 114 q 478 168 428 114 q 558 310 529 221 q 587 497 587 400 q 482 633 587 633 "},"̃":{"x_min":-588.90625,"x_max":-55.8125,"ha":0,"o":"m -232 841 q -288 852 -262 841 q -336 878 -313 864 q -381 904 -359 892 q -424 915 -402 915 q -466 897 -449 915 q -495 840 -483 878 l -588 840 q -415 1034 -550 1034 q -357 1021 -384 1034 q -308 995 -331 1009 q -265 969 -285 981 q -225 957 -245 957 q -181 975 -198 957 q -148 1035 -164 993 l -55 1035 q -232 841 -100 841 "},"ộ":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 222 -192 q 248 -117 222 -145 q 322 -89 274 -89 q 380 -106 359 -89 q 402 -161 402 -124 q 375 -237 402 -209 q 304 -265 348 -265 q 245 -247 269 -265 q 222 -192 222 -230 m 714 842 l 611 842 q 502 962 560 884 q 342 842 413 887 l 231 842 l 231 858 q 367 991 324 945 q 428 1064 410 1036 l 596 1064 q 714 858 622 997 l 714 842 "},"®":{"x_min":88.84375,"x_max":1108.21875,"ha":1156,"o":"m 88 495 q 156 750 88 631 q 343 937 224 868 q 598 1006 461 1006 q 852 938 733 1006 q 1039 751 970 871 q 1108 495 1108 632 q 1041 242 1108 360 q 856 55 974 124 q 598 -14 738 -14 q 339 56 458 -14 q 154 243 221 126 q 88 495 88 361 m 172 495 q 228 283 172 381 q 383 127 284 185 q 598 68 482 68 q 815 127 716 68 q 969 284 914 186 q 1024 495 1024 383 q 969 706 1024 607 q 814 863 913 805 q 598 922 716 922 q 385 865 484 922 q 229 708 286 807 q 172 495 172 609 m 823 615 q 792 516 823 558 q 704 450 761 474 l 847 197 l 711 197 l 594 417 l 533 417 l 533 197 l 412 197 l 412 793 l 594 793 q 823 615 823 793 m 533 515 l 581 515 q 669 539 638 515 q 699 606 699 564 q 669 675 699 656 q 581 694 638 694 l 533 694 l 533 515 "},"Ŋ":{"x_min":46.125,"x_max":1018.015625,"ha":1011,"o":"m 489 -275 q 372 -258 415 -275 l 375 -120 q 479 -135 434 -135 q 655 0 619 -135 l 354 789 l 349 789 q 301 505 319 590 l 194 0 l 46 0 l 255 992 l 429 992 l 712 245 l 716 245 q 768 512 734 360 l 869 992 l 1018 992 l 808 0 q 699 -205 779 -135 q 489 -275 619 -275 "},"ọ":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 222 -192 q 248 -117 222 -145 q 322 -89 274 -89 q 380 -106 359 -89 q 402 -161 402 -124 q 375 -237 402 -209 q 304 -265 348 -265 q 245 -247 269 -265 q 222 -192 222 -230 "},"Ũ":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 721 1070 q 665 1081 691 1070 q 617 1107 640 1093 q 572 1133 594 1121 q 529 1144 551 1144 q 487 1126 504 1144 q 458 1069 470 1107 l 365 1069 q 538 1263 403 1263 q 596 1250 569 1263 q 645 1224 622 1238 q 688 1198 668 1210 q 728 1186 708 1186 q 772 1204 755 1186 q 805 1264 789 1222 l 898 1264 q 721 1070 853 1070 "},"L":{"x_min":47.46875,"x_max":602.9375,"ha":689,"o":"m 47 0 l 257 992 l 417 992 l 237 139 l 602 139 l 573 0 l 47 0 "},"ế":{"x_min":63.75,"x_max":912.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 415 1042 l 582 1042 q 689 857 612 961 l 685 842 l 604 842 q 487 951 542 884 q 323 842 400 882 l 230 842 l 233 858 q 415 1042 375 991 m 654 987 q 770 1128 725 1062 l 912 1128 l 912 1115 q 836 1046 888 1089 q 738 974 784 1003 l 654 974 l 654 987 "},"ď":{"x_min":63.75,"x_max":1105.984375,"ha":813,"o":"m 422 764 q 604 643 543 764 l 609 643 q 634 812 618 742 l 686 1055 l 844 1055 l 620 0 l 495 0 l 508 119 l 503 119 q 388 16 444 47 q 270 -14 333 -14 q 118 54 173 -14 q 63 250 63 123 q 112 510 63 389 q 242 697 160 630 q 422 764 323 764 m 331 114 q 441 170 387 114 q 529 315 496 226 q 562 497 562 405 q 532 596 562 559 q 442 633 503 633 q 335 581 385 633 q 255 438 284 529 q 225 252 225 347 q 331 114 225 114 m 863 851 q 956 1056 917 949 l 1105 1056 l 1105 1042 q 1037 932 1083 995 q 954 834 991 869 l 863 834 l 863 851 "}," ":{"x_min":0,"x_max":0,"ha":361},"Ĭ":{"x_min":47.46875,"x_max":602.6875,"ha":412,"o":"m 47 0 l 258 992 l 417 992 l 206 0 l 47 0 m 602 1277 q 521 1121 581 1171 q 357 1071 460 1071 q 216 1115 267 1071 q 165 1239 165 1160 q 167 1277 165 1264 l 259 1277 q 284 1212 259 1234 q 368 1191 309 1191 q 459 1212 427 1191 q 502 1277 492 1234 l 602 1277 "},"ŧ":{"x_min":25.09375,"x_max":545.96875,"ha":510,"o":"m 308 114 q 411 135 354 114 l 411 15 q 346 -5 387 3 q 265 -14 305 -14 q 79 153 79 -14 q 82 195 79 172 q 116 366 84 217 l 25 366 l 47 478 l 139 478 l 172 629 l 62 629 l 76 703 l 205 759 l 293 917 l 392 917 l 356 750 l 545 750 l 519 629 l 331 629 l 298 478 l 461 478 l 437 366 l 275 366 l 248 241 q 240 178 240 203 q 257 132 240 149 q 308 114 274 114 "},"À":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 620 1071 l 522 1071 q 433 1173 478 1113 q 364 1278 387 1233 l 364 1293 l 531 1293 q 620 1087 562 1188 l 620 1071 "},"ẃ":{"x_min":82.0625,"x_max":1105.5,"ha":1044,"o":"m 572 0 l 559 425 l 558 472 l 560 608 q 525 523 543 566 q 291 0 507 480 l 113 0 l 82 750 l 231 750 l 240 311 q 233 145 239 252 l 237 145 q 311 330 282 265 l 499 750 l 672 750 l 685 340 l 685 304 l 683 145 l 687 145 q 726 253 699 179 q 769 364 753 326 q 940 750 785 401 l 1105 750 l 754 0 l 572 0 m 531 858 q 684 1064 597 932 l 863 1064 l 863 1051 q 756 941 826 1006 q 637 842 685 877 l 531 842 l 531 858 "},"+":{"x_min":79.359375,"x_max":714.171875,"ha":765,"o":"m 336 427 l 79 427 l 79 550 l 336 550 l 336 808 l 458 808 l 458 550 l 714 550 l 714 427 l 458 427 l 458 173 l 336 173 l 336 427 "},"ḁ":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 473 -236 q 429 -346 473 -303 q 310 -390 385 -390 q 195 -348 237 -390 q 152 -237 152 -307 q 195 -126 152 -167 q 310 -85 238 -85 q 427 -126 381 -85 q 473 -236 473 -167 m 381 -237 q 362 -185 381 -204 q 310 -167 342 -167 q 259 -185 279 -167 q 238 -237 238 -204 q 257 -290 238 -271 q 310 -309 275 -309 q 362 -290 342 -309 q 381 -237 381 -271 "},"½":{"x_min":82.109375,"x_max":1061.734375,"ha":1127,"o":"m 950 992 l 215 0 l 82 0 l 817 992 l 950 992 m 312 992 l 422 992 l 296 397 l 167 397 l 234 710 q 272 857 245 763 q 239 828 258 844 q 135 758 219 812 l 82 845 l 312 992 m 992 0 l 582 0 l 601 91 l 784 242 q 885 335 859 307 q 922 387 910 362 q 934 437 934 411 q 915 486 934 468 q 863 503 896 503 q 734 449 801 503 l 679 533 q 776 588 726 569 q 890 607 827 607 q 1015 566 968 607 q 1061 461 1061 525 q 1045 376 1061 414 q 995 301 1029 339 q 881 202 961 264 l 763 106 l 1014 106 l 992 0 "},"Ë":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 324 1164 q 348 1231 324 1205 q 415 1257 372 1257 q 467 1241 447 1257 q 486 1192 486 1225 q 462 1123 486 1148 q 398 1098 438 1098 q 345 1113 366 1098 q 324 1164 324 1129 m 584 1164 q 608 1231 584 1205 q 674 1257 632 1257 q 726 1241 707 1257 q 746 1192 746 1225 q 722 1123 746 1148 q 658 1098 697 1098 q 605 1113 626 1098 q 584 1164 584 1129 "},"'":{"x_min":144.46875,"x_max":349.96875,"ha":328,"o":"m 349 992 l 247 634 l 144 634 l 193 992 l 349 992 "},"Š":{"x_min":26.453125,"x_max":748.421875,"ha":717,"o":"m 630 290 q 532 66 630 147 q 262 -14 434 -14 q 26 36 120 -14 l 26 188 q 263 123 143 123 q 410 162 356 123 q 463 273 463 202 q 436 356 463 319 q 319 448 408 392 q 214 531 248 494 q 162 613 180 568 q 144 711 144 657 q 186 865 144 798 q 304 969 227 932 q 476 1006 380 1006 q 734 943 615 1006 l 676 814 q 476 866 567 866 q 357 827 402 866 q 312 723 312 787 q 322 667 312 691 q 354 622 333 643 q 445 558 375 602 q 590 430 550 492 q 630 290 630 369 m 266 1293 l 367 1293 q 477 1172 414 1253 q 638 1293 561 1243 l 748 1293 l 748 1274 q 633 1164 694 1226 q 551 1071 573 1102 l 382 1071 q 266 1274 353 1145 l 266 1293 "},"ĳ":{"x_min":31.875,"x_max":787.578125,"ha":765,"o":"m 223 935 q 250 1009 223 981 q 324 1038 276 1038 q 383 1020 360 1038 q 405 965 405 1002 q 378 889 405 917 q 307 862 351 862 q 247 879 271 862 q 223 935 223 897 m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 305 -334 q 204 -318 244 -334 l 204 -189 q 283 -203 247 -203 q 398 -76 372 -203 l 575 750 l 733 750 l 552 -95 q 466 -276 527 -218 q 305 -334 405 -334 m 607 935 q 632 1009 607 981 q 706 1038 658 1038 q 765 1020 743 1038 q 787 965 787 1002 q 760 889 787 917 q 689 862 733 862 q 630 879 653 862 q 607 935 607 896 "}," ":{"x_min":0,"x_max":0,"ha":1389},"˛":{"x_min":-108.515625,"x_max":144.46875,"ha":269,"o":"m 144 0 q 42 -98 69 -59 q 15 -172 15 -137 q 27 -205 15 -194 q 58 -216 38 -216 q 120 -207 84 -216 l 120 -302 q 27 -317 76 -317 q -71 -285 -33 -317 q -108 -196 -108 -253 q -76 -95 -108 -141 q 37 0 -44 -50 l 144 0 "},"ở":{"x_min":63.75,"x_max":965.109375,"ha":836,"o":"m 450 762 q 673 663 598 762 q 751 728 721 682 q 797 864 781 775 l 959 864 l 965 848 q 879 679 937 741 q 715 577 822 616 q 731 469 731 529 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 662 1028 q 525 883 662 919 l 510 822 l 412 822 l 424 934 q 511 963 485 945 q 536 1011 536 982 q 475 1052 536 1052 q 400 1043 447 1052 l 400 1132 q 499 1145 441 1145 q 619 1114 576 1145 q 662 1028 662 1084 "},"ð":{"x_min":54.265625,"x_max":777.921875,"ha":796,"o":"m 438 898 q 347 963 408 926 l 419 1067 q 560 967 506 1018 l 730 1061 l 777 975 l 630 893 q 735 545 735 754 q 686 244 735 372 q 548 50 636 115 q 336 -14 459 -14 q 128 58 202 -14 q 54 263 54 131 q 98 466 54 373 q 223 612 143 559 q 404 665 304 665 q 518 638 469 665 q 594 565 567 612 l 598 565 q 508 825 592 730 l 339 729 l 290 816 l 438 898 m 344 109 q 454 149 406 109 q 527 257 501 190 q 554 397 554 325 q 518 502 554 462 q 421 541 483 541 q 312 503 359 541 q 240 399 265 465 q 215 255 215 333 q 248 147 215 184 q 344 109 281 109 "},"ş":{"x_min":9.5,"x_max":597.515625,"ha":625,"o":"m 530 230 q 450 49 530 112 q 227 -14 370 -14 q 9 31 99 -14 l 9 169 q 221 108 113 108 q 327 135 286 108 q 368 209 368 162 q 344 268 368 243 q 248 334 321 293 q 129 427 164 380 q 94 539 94 474 q 166 704 94 644 q 362 764 239 764 q 597 707 495 764 l 545 587 q 365 639 451 639 q 285 616 316 639 q 254 554 254 594 q 276 499 254 523 q 368 438 299 476 q 469 370 439 398 q 514 308 499 341 q 530 230 530 274 m 349 -179 q 293 -292 349 -251 q 141 -334 237 -334 q 61 -323 98 -334 l 61 -232 q 126 -241 93 -241 q 219 -176 219 -241 q 195 -134 219 -149 q 125 -113 172 -119 l 191 0 l 290 0 l 256 -65 q 327 -110 305 -81 q 349 -179 349 -139 "},"Ỡ":{"x_min":91.5625,"x_max":1186.21875,"ha":1032,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 902 862 809 1007 q 977 935 951 887 q 1013 1055 1003 983 l 1180 1055 l 1186 1038 q 1098 872 1158 935 q 942 770 1038 808 q 963 625 963 701 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 724 1070 q 668 1081 694 1070 q 620 1107 643 1093 q 575 1133 597 1121 q 532 1144 554 1144 q 490 1126 507 1144 q 461 1069 473 1107 l 368 1069 q 541 1263 406 1263 q 599 1250 572 1263 q 648 1224 625 1238 q 691 1198 671 1210 q 731 1186 711 1186 q 775 1204 758 1186 q 808 1264 792 1222 l 901 1264 q 724 1070 856 1070 "}," ":{"x_min":0,"x_max":0,"ha":777},"ı":{"x_min":31.875,"x_max":351.3125,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 "},"Ć":{"x_min":91.5625,"x_max":890.5,"ha":831,"o":"m 626 866 q 440 806 522 866 q 308 630 358 746 q 259 376 259 514 q 315 189 259 254 q 480 124 371 124 q 704 170 576 124 l 704 31 q 450 -14 581 -14 q 186 86 282 -14 q 91 369 91 187 q 163 697 91 545 q 354 927 234 848 q 626 1006 473 1006 q 890 943 773 1006 l 826 811 q 735 850 784 834 q 626 866 687 866 m 536 1087 q 689 1293 602 1161 l 868 1293 l 868 1280 q 761 1170 831 1235 q 642 1071 690 1106 l 536 1071 l 536 1087 "},"ä":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 287 935 q 311 1002 287 976 q 378 1028 335 1028 q 430 1012 410 1028 q 449 963 449 996 q 425 894 449 919 q 361 869 401 869 q 308 884 329 869 q 287 935 287 900 m 547 935 q 571 1002 547 976 q 637 1028 595 1028 q 689 1012 670 1028 q 709 963 709 996 q 685 894 709 919 q 621 869 660 869 q 568 884 589 869 q 547 935 547 900 "},"¹":{"x_min":130.890625,"x_max":470.6875,"ha":505,"o":"m 360 992 l 470 992 l 344 397 l 215 397 l 282 710 q 320 857 293 763 q 287 828 306 844 q 183 758 267 812 l 130 845 l 360 992 "},"£":{"x_min":-12.203125,"x_max":819.296875,"ha":765,"o":"m 580 1006 q 819 947 708 1006 l 759 823 q 584 873 662 873 q 430 734 459 873 l 392 546 l 617 546 l 594 429 l 366 429 l 344 326 q 298 214 330 259 q 209 140 265 168 l 677 140 l 647 0 l -12 0 l 13 130 q 183 318 149 161 l 206 429 l 73 429 l 98 546 l 231 546 l 273 748 q 377 940 299 874 q 580 1006 455 1006 "},"ẹ":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 193 -192 q 219 -117 193 -145 q 293 -89 245 -89 q 351 -106 330 -89 q 373 -161 373 -124 q 346 -237 373 -209 q 275 -265 319 -265 q 216 -247 240 -265 q 193 -192 193 -230 "},"ů":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 674 994 q 629 881 674 923 q 512 840 584 840 q 397 881 441 840 q 354 992 354 922 q 399 1104 354 1062 q 512 1146 443 1146 q 628 1104 583 1146 q 674 994 674 1063 m 585 992 q 565 1045 585 1026 q 512 1065 544 1065 q 462 1045 482 1065 q 442 992 442 1026 q 460 940 442 959 q 512 922 478 922 q 565 940 544 922 q 585 992 585 959 "},"Ō":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 451 1190 l 845 1190 l 820 1071 l 425 1071 l 451 1190 "},"W":{"x_min":137.671875,"x_max":1337.453125,"ha":1213,"o":"m 893 0 l 718 0 l 693 571 l 689 696 l 691 768 l 687 768 q 608 571 655 671 l 347 0 l 173 0 l 137 992 l 293 992 l 305 415 q 297 180 305 322 l 301 180 q 397 421 357 330 l 659 992 l 812 992 l 833 422 l 835 308 l 833 180 l 838 180 q 886 314 857 240 q 927 417 914 388 l 1170 992 l 1337 992 l 893 0 "},"ỉ":{"x_min":31.875,"x_max":479.96875,"ha":382,"o":"m 191 0 l 31 0 l 191 750 l 351 750 l 191 0 m 479 1028 q 342 883 479 919 l 327 822 l 229 822 l 241 934 q 328 963 302 945 q 353 1011 353 982 q 292 1052 353 1052 q 217 1043 264 1052 l 217 1132 q 316 1145 258 1145 q 436 1114 393 1145 q 479 1028 479 1084 "},"Ğ":{"x_min":91.5625,"x_max":930.515625,"ha":949,"o":"m 533 538 l 880 538 l 773 38 q 625 -1 697 11 q 463 -14 553 -14 q 189 85 286 -14 q 91 365 91 184 q 161 693 91 544 q 357 923 230 841 q 647 1006 484 1006 q 791 992 722 1006 q 930 944 860 978 l 869 807 q 642 865 751 865 q 448 804 535 865 q 310 629 360 742 q 259 376 259 515 q 320 188 259 251 q 491 124 380 124 q 637 146 565 124 l 691 398 l 503 398 l 533 538 m 859 1277 q 778 1121 838 1171 q 614 1071 717 1071 q 473 1115 524 1071 q 422 1239 422 1160 q 424 1277 422 1264 l 516 1277 q 541 1212 516 1234 q 625 1191 566 1191 q 716 1212 684 1191 q 759 1277 749 1234 l 859 1277 "},"v":{"x_min":67.828125,"x_max":748.765625,"ha":676,"o":"m 156 0 l 67 750 l 225 750 l 262 344 q 271 143 271 236 l 276 143 q 324 254 295 193 q 368 344 352 316 l 579 750 l 748 750 l 343 0 l 156 0 "},">":{"x_min":78,"x_max":712.8125,"ha":765,"o":"m 78 283 l 548 489 l 78 722 l 78 855 l 712 523 l 712 441 l 78 150 l 78 283 "},"Ệ":{"x_min":47.46875,"x_max":783.34375,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 195 -192 q 221 -117 195 -145 q 295 -89 247 -89 q 353 -106 332 -89 q 375 -161 375 -124 q 348 -237 375 -209 q 277 -265 321 -265 q 218 -247 242 -265 q 195 -192 195 -230 m 766 1071 l 663 1071 q 554 1191 612 1113 q 394 1071 465 1116 l 283 1071 l 283 1087 q 419 1220 376 1174 q 480 1293 462 1265 l 648 1293 q 766 1087 674 1226 l 766 1071 "},"û":{"x_min":75.28125,"x_max":786.0625,"ha":819,"o":"m 343 750 l 255 336 q 234 205 234 240 q 320 114 234 114 q 417 153 369 114 q 503 263 465 192 q 560 431 540 335 l 628 750 l 786 750 l 628 0 l 502 0 l 516 138 l 511 138 q 395 22 455 59 q 265 -14 335 -14 q 124 37 174 -14 q 75 185 75 89 q 83 269 75 228 q 99 353 91 311 l 183 750 l 343 750 m 734 842 l 631 842 q 522 962 580 884 q 362 842 433 887 l 251 842 l 251 858 q 387 991 344 945 q 448 1064 430 1036 l 616 1064 q 734 858 642 997 l 734 842 "},"Ź":{"x_min":-26.453125,"x_max":804.375,"ha":741,"o":"m 611 0 l -26 0 l -4 113 l 572 851 l 166 851 l 196 992 l 804 992 l 780 875 l 202 139 l 640 139 l 611 0 m 430 1087 q 583 1293 496 1161 l 762 1293 l 762 1280 q 655 1170 725 1235 q 536 1071 584 1106 l 430 1071 l 430 1087 "},"Ų":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 568 0 q 466 -98 493 -59 q 439 -172 439 -137 q 451 -205 439 -194 q 482 -216 462 -216 q 544 -207 508 -216 l 544 -302 q 451 -317 500 -317 q 352 -285 390 -317 q 315 -196 315 -253 q 347 -95 315 -141 q 461 0 379 -50 l 568 0 "},"Ŵ":{"x_min":137.671875,"x_max":1337.453125,"ha":1213,"o":"m 893 0 l 718 0 l 693 571 l 689 696 l 691 768 l 687 768 q 608 571 655 671 l 347 0 l 173 0 l 137 992 l 293 992 l 305 415 q 297 180 305 322 l 301 180 q 397 421 357 330 l 659 992 l 812 992 l 833 422 l 835 308 l 833 180 l 838 180 q 886 314 857 240 q 927 417 914 388 l 1170 992 l 1337 992 l 893 0 m 981 1071 l 878 1071 q 769 1191 827 1113 q 609 1071 680 1116 l 498 1071 l 498 1087 q 634 1220 591 1174 q 695 1293 677 1265 l 863 1293 q 981 1087 889 1226 l 981 1071 "},"‛":{"x_min":152.59375,"x_max":318.09375,"ha":267,"o":"m 309 992 l 309 916 q 318 652 309 768 l 206 652 q 174 803 189 713 q 152 977 158 892 l 162 992 l 309 992 "},"Ð":{"x_min":35.953125,"x_max":889.15625,"ha":932,"o":"m 889 605 q 821 284 889 422 q 623 73 753 147 q 319 0 494 0 l 47 0 l 134 422 l 35 422 l 66 558 l 164 558 l 257 992 l 507 992 q 790 893 691 992 q 889 605 889 795 m 327 136 q 537 194 447 136 q 674 358 626 253 q 722 600 722 464 q 662 790 722 725 q 489 856 602 856 l 389 856 l 326 558 l 519 558 l 489 422 l 297 422 l 236 136 l 327 136 "},"ˉ":{"x_min":267.890625,"x_max":687.71875,"ha":743,"o":"m 293 961 l 687 961 l 662 842 l 267 842 l 293 961 "},"Ĺ":{"x_min":47.46875,"x_max":617.1875,"ha":689,"o":"m 47 0 l 257 992 l 417 992 l 237 139 l 602 139 l 573 0 l 47 0 m 285 1087 q 438 1293 351 1161 l 617 1293 l 617 1280 q 510 1170 580 1235 q 391 1071 439 1106 l 285 1071 l 285 1087 "},"ỵ":{"x_min":-115.296875,"x_max":750.109375,"ha":681,"o":"m 67 750 l 225 750 l 267 389 q 278 271 274 347 q 283 148 283 195 l 287 148 q 379 360 345 294 l 577 750 l 750 750 l 283 -118 q 150 -282 222 -230 q -18 -334 78 -334 q -115 -321 -69 -334 l -115 -193 q -30 -204 -64 -204 q 60 -174 19 -204 q 144 -69 101 -145 l 179 -7 l 67 750 m 382 -192 q 408 -117 382 -145 q 482 -89 434 -89 q 540 -106 519 -89 q 562 -161 562 -124 q 535 -237 562 -209 q 464 -265 508 -265 q 405 -247 429 -265 q 382 -192 382 -230 "},"r":{"x_min":31.875,"x_max":613.796875,"ha":567,"o":"m 540 764 q 613 755 582 764 l 579 607 q 510 616 542 616 q 357 540 424 616 q 263 339 290 463 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 421 728 364 692 q 540 764 477 764 "},"Č":{"x_min":91.5625,"x_max":890.5,"ha":831,"o":"m 626 866 q 440 806 522 866 q 308 630 358 746 q 259 376 259 514 q 315 189 259 254 q 480 124 371 124 q 704 170 576 124 l 704 31 q 450 -14 581 -14 q 186 86 282 -14 q 91 369 91 187 q 163 697 91 545 q 354 927 234 848 q 626 1006 473 1006 q 890 943 773 1006 l 826 811 q 735 850 784 834 q 626 866 687 866 m 389 1293 l 490 1293 q 600 1172 537 1253 q 761 1293 684 1243 l 871 1293 l 871 1274 q 756 1164 817 1226 q 674 1071 696 1102 l 505 1071 q 389 1274 476 1145 l 389 1293 "},"x":{"x_min":-58.328125,"x_max":751.46875,"ha":700,"o":"m 331 262 l 124 0 l -58 0 l 263 385 l 107 750 l 273 750 l 370 497 l 565 750 l 751 750 l 438 377 l 607 0 l 440 0 l 331 262 "},"è":{"x_min":63.75,"x_max":690.4375,"ha":729,"o":"m 450 641 q 327 583 385 641 q 245 429 270 524 l 265 429 q 464 465 392 429 q 536 568 536 501 q 514 622 536 603 q 450 641 493 641 m 347 -14 q 138 61 213 -14 q 63 271 63 136 q 116 521 63 406 q 258 700 168 637 q 459 764 348 764 q 629 714 569 764 q 690 575 690 665 q 577 381 690 451 q 255 312 464 312 l 226 312 l 225 291 l 225 271 q 263 153 225 196 q 377 110 301 110 q 474 123 426 110 q 588 167 522 136 l 588 40 q 468 -1 523 11 q 347 -14 414 -14 m 551 842 l 453 842 q 364 944 409 884 q 295 1049 318 1004 l 295 1064 l 462 1064 q 551 858 493 959 l 551 842 "},"Ń":{"x_min":46.125,"x_max":1018.015625,"ha":1011,"o":"m 808 0 l 632 0 l 354 789 l 349 789 l 343 742 q 319 598 326 641 q 194 0 311 555 l 46 0 l 255 992 l 437 992 l 708 212 l 712 212 q 733 342 716 249 q 760 481 750 436 l 869 992 l 1018 992 l 808 0 m 572 1087 q 725 1293 638 1161 l 904 1293 l 904 1280 q 797 1170 867 1235 q 678 1071 726 1106 l 572 1071 l 572 1087 "},"Ø":{"x_min":73.921875,"x_max":990.203125,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 244 42 328 -14 l 164 -58 l 73 11 l 161 120 q 91 367 91 213 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 819 943 732 1007 l 900 1044 l 990 973 l 900 861 q 963 625 963 772 m 591 869 q 419 806 495 869 q 299 626 343 743 q 255 369 255 509 q 271 258 255 309 l 725 825 q 591 869 670 869 m 800 623 q 787 720 800 683 l 339 161 q 470 123 389 123 q 640 187 564 123 q 758 367 716 252 q 800 623 800 481 "},"Ỳ":{"x_min":126.15625,"x_max":868.125,"ha":741,"o":"m 394 538 l 687 992 l 868 992 l 445 372 l 368 0 l 206 0 l 287 375 l 126 992 l 290 992 l 394 538 m 554 1071 l 456 1071 q 367 1173 412 1113 q 298 1278 321 1233 l 298 1293 l 465 1293 q 554 1087 496 1188 l 554 1071 "},"Ẽ":{"x_min":47.46875,"x_max":808.1875,"ha":730,"o":"m 573 0 l 47 0 l 257 992 l 783 992 l 754 852 l 388 852 l 331 585 l 672 585 l 644 447 l 302 447 l 237 137 l 602 137 l 573 0 m 631 1070 q 575 1081 601 1070 q 527 1107 550 1093 q 482 1133 504 1121 q 439 1144 461 1144 q 397 1126 414 1144 q 368 1069 380 1107 l 275 1069 q 448 1263 313 1263 q 506 1250 479 1263 q 555 1224 532 1238 q 598 1198 578 1210 q 638 1186 618 1186 q 682 1204 665 1186 q 715 1264 699 1222 l 808 1264 q 631 1070 763 1070 "},"ḿ":{"x_min":31.875,"x_max":1159.765625,"ha":1234,"o":"m 547 764 q 719 604 696 764 l 725 604 q 840 723 775 683 q 975 764 905 764 q 1112 712 1065 764 q 1159 565 1159 660 q 1144 443 1159 522 l 1049 0 l 890 0 l 987 456 q 1000 546 1000 520 q 918 633 1000 633 q 781 549 845 633 q 689 326 718 465 l 620 0 l 461 0 l 558 456 q 569 542 569 511 q 490 633 569 633 q 352 547 415 633 q 258 318 288 461 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 547 764 408 764 m 638 858 q 791 1064 704 932 l 970 1064 l 970 1051 q 863 941 933 1006 q 744 842 792 877 l 638 842 l 638 858 "},"÷":{"x_min":79.359375,"x_max":714.171875,"ha":765,"o":"m 79 427 l 79 550 l 714 550 l 714 427 l 79 427 m 311 252 q 332 320 311 296 q 396 344 354 344 q 460 320 438 344 q 482 252 482 295 q 458 184 482 209 q 396 160 435 160 q 334 184 356 160 q 311 252 311 208 m 311 726 q 332 793 311 769 q 396 818 354 818 q 460 793 438 818 q 482 726 482 769 q 458 658 482 683 q 396 633 435 633 q 334 657 356 633 q 311 726 311 681 "},"h":{"x_min":31.875,"x_max":744.6875,"ha":819,"o":"m 476 0 l 572 456 q 584 542 584 517 q 497 633 584 633 q 355 548 421 633 q 258 316 288 464 l 191 0 l 31 0 l 255 1055 l 415 1055 l 376 877 q 326 679 358 792 l 314 628 l 319 628 q 433 732 376 700 q 554 764 491 764 q 695 711 646 764 q 744 561 744 658 q 729 443 744 509 l 634 0 l 476 0 "},".":{"x_min":22.375,"x_max":226.53125,"ha":374,"o":"m 22 63 q 54 153 22 119 q 143 186 86 186 q 203 165 181 186 q 226 102 226 144 q 194 14 226 49 q 109 -20 162 -20 q 43 4 65 -20 q 22 63 22 28 "},"f":{"x_min":-152.59375,"x_max":638.890625,"ha":476,"o":"m -51 -334 q -152 -318 -112 -334 l -152 -189 q -75 -203 -109 -203 q 44 -64 15 -203 l 191 629 l 70 629 l 84 701 l 216 752 l 230 815 q 321 1006 260 949 q 495 1063 383 1063 q 638 1033 573 1063 l 597 914 q 505 933 547 933 q 430 904 458 933 q 387 808 402 875 l 375 750 l 530 750 l 505 629 l 349 629 l 198 -85 q 109 -273 171 -213 q -51 -334 48 -334 "},"“":{"x_min":80.703125,"x_max":657.203125,"ha":545,"o":"m 362 652 l 356 666 q 537 992 413 795 l 657 992 q 522 652 574 797 l 362 652 m 84 652 l 80 666 q 152 808 103 718 q 261 992 202 899 l 380 992 q 245 652 297 797 l 84 652 "},"A":{"x_min":-82.0625,"x_max":747.40625,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 "},"‘":{"x_min":80.703125,"x_max":380.484375,"ha":267,"o":"m 84 652 l 80 666 q 152 808 103 718 q 261 992 202 899 l 380 992 q 245 652 297 797 l 84 652 "},"O":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 "},"Ỏ":{"x_min":91.5625,"x_max":963.75,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 869 905 774 1007 q 963 625 963 804 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 828 1257 q 691 1112 828 1148 l 676 1051 l 578 1051 l 590 1163 q 677 1192 651 1174 q 702 1240 702 1211 q 641 1281 702 1281 q 566 1272 613 1281 l 566 1361 q 665 1374 607 1374 q 785 1343 742 1374 q 828 1257 828 1313 "},"Đ":{"x_min":35.953125,"x_max":889.15625,"ha":932,"o":"m 889 605 q 821 284 889 422 q 623 73 753 147 q 319 0 494 0 l 47 0 l 134 422 l 35 422 l 66 558 l 164 558 l 257 992 l 507 992 q 790 893 691 992 q 889 605 889 795 m 327 136 q 537 194 447 136 q 674 358 626 253 q 722 600 722 464 q 662 790 722 725 q 489 856 602 856 l 389 856 l 326 558 l 519 558 l 489 422 l 297 422 l 236 136 l 327 136 "},"Ớ":{"x_min":91.5625,"x_max":1186.21875,"ha":1032,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 187 87 284 -14 q 91 367 91 188 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 902 862 809 1007 q 977 935 951 887 q 1013 1055 1003 983 l 1180 1055 l 1186 1038 q 1098 872 1158 935 q 942 770 1038 808 q 963 625 963 701 m 591 867 q 421 802 497 867 q 302 622 345 737 q 259 369 259 506 q 315 188 259 251 q 469 124 370 124 q 637 189 562 124 q 754 368 712 253 q 796 623 796 483 q 742 803 796 739 q 591 867 689 867 m 530 1087 q 683 1293 596 1161 l 862 1293 l 862 1280 q 755 1170 825 1235 q 636 1071 684 1106 l 530 1071 l 530 1087 "},"3":{"x_min":21.03125,"x_max":737.234375,"ha":765,"o":"m 737 782 q 670 602 737 674 q 487 509 602 531 l 487 505 q 620 433 573 488 q 668 294 668 377 q 621 133 668 203 q 488 24 575 63 q 282 -14 401 -14 q 21 39 129 -14 l 21 185 q 146 134 78 152 q 279 116 215 116 q 445 164 385 116 q 505 298 505 213 q 316 446 505 446 l 226 446 l 251 571 l 323 571 q 504 621 434 571 q 575 757 575 672 q 541 841 575 810 q 446 872 507 872 q 347 855 398 872 q 237 797 297 837 l 166 906 q 319 983 248 961 q 473 1006 391 1006 q 667 945 597 1006 q 737 782 737 885 "},"9":{"x_min":62.390625,"x_max":731.796875,"ha":765,"o":"m 731 690 q 692 409 731 551 q 589 172 653 266 q 435 31 524 77 q 225 -14 346 -14 q 62 7 134 -14 l 62 148 q 222 118 144 118 q 430 202 349 118 q 550 466 510 285 l 545 466 q 339 358 469 358 q 165 427 227 358 q 104 622 104 496 q 149 818 104 728 q 276 957 195 908 q 462 1006 357 1006 q 662 924 592 1006 q 731 690 731 843 m 450 873 q 351 841 394 873 q 285 753 308 809 q 262 632 262 697 q 293 523 262 560 q 384 486 324 486 q 518 549 463 486 q 573 712 573 613 q 541 829 573 786 q 450 873 508 873 "},"Ǿ":{"x_min":73.921875,"x_max":990.203125,"ha":1007,"o":"m 963 625 q 899 287 963 435 q 721 63 834 140 q 459 -14 609 -14 q 244 42 328 -14 l 164 -58 l 73 11 l 161 120 q 91 367 91 213 q 158 698 91 549 q 341 927 225 848 q 604 1007 457 1007 q 819 943 732 1007 l 900 1044 l 990 973 l 900 861 q 963 625 963 772 m 591 869 q 419 806 495 869 q 299 626 343 743 q 255 369 255 509 q 271 258 255 309 l 725 825 q 591 869 670 869 m 800 623 q 787 720 800 683 l 339 161 q 470 123 389 123 q 640 187 564 123 q 758 367 716 252 q 800 623 800 481 m 530 1087 q 683 1293 596 1161 l 862 1293 l 862 1280 q 755 1170 825 1235 q 636 1071 684 1106 l 530 1071 l 530 1087 "},"l":{"x_min":31.875,"x_max":415.078125,"ha":382,"o":"m 190 0 l 31 0 l 255 1055 l 415 1055 l 190 0 "},"Ẫ":{"x_min":-82.0625,"x_max":844.546875,"ha":821,"o":"m 560 274 l 231 274 l 90 0 l -82 0 l 448 993 l 634 993 l 747 0 l 588 0 l 560 274 m 550 416 q 519 757 522 698 q 515 852 515 817 q 419 644 478 758 l 302 416 l 550 416 m 690 1299 q 637 1308 662 1299 q 589 1328 612 1317 q 544 1349 565 1340 q 502 1359 523 1359 q 460 1342 474 1359 q 434 1298 445 1325 l 354 1298 q 410 1415 371 1376 q 508 1455 450 1455 q 559 1445 534 1455 q 608 1424 584 1435 q 653 1402 631 1412 q 696 1393 675 1393 q 737 1408 721 1393 q 766 1456 752 1423 l 844 1456 q 690 1299 805 1299 m 494 1266 l 661 1266 q 771 1086 684 1203 l 767 1071 l 686 1071 q 566 1174 626 1111 q 407 1071 481 1111 l 312 1071 l 315 1087 l 358 1128 q 494 1266 454 1214 "},"4":{"x_min":-2.71875,"x_max":739.265625,"ha":765,"o":"m 710 215 l 573 215 l 527 0 l 372 0 l 419 215 l -2 215 l 22 348 l 567 994 l 739 994 l 602 349 l 739 349 l 710 215 m 446 349 l 493 558 q 560 813 514 650 l 555 813 q 463 687 520 755 l 177 349 l 446 349 "},"Ẁ":{"x_min":137.671875,"x_max":1337.453125,"ha":1213,"o":"m 893 0 l 718 0 l 693 571 l 689 696 l 691 768 l 687 768 q 608 571 655 671 l 347 0 l 173 0 l 137 992 l 293 992 l 305 415 q 297 180 305 322 l 301 180 q 397 421 357 330 l 659 992 l 812 992 l 833 422 l 835 308 l 833 180 l 838 180 q 886 314 857 240 q 927 417 914 388 l 1170 992 l 1337 992 l 893 0 m 808 1071 l 710 1071 q 621 1173 666 1113 q 552 1278 575 1233 l 552 1293 l 719 1293 q 808 1087 750 1188 l 808 1071 "}," ":{"x_min":0,"x_max":0,"ha":139},"Ť":{"x_min":119.375,"x_max":826.75,"ha":714,"o":"m 358 0 l 197 0 l 376 852 l 119 852 l 149 992 l 826 992 l 797 852 l 539 852 l 358 0 m 293 1293 l 394 1293 q 504 1172 441 1253 q 665 1293 588 1243 l 775 1293 l 775 1274 q 660 1164 721 1226 q 578 1071 600 1102 l 409 1071 q 293 1274 380 1145 l 293 1293 "},"Ś":{"x_min":26.453125,"x_max":748.1875,"ha":717,"o":"m 630 290 q 532 66 630 147 q 262 -14 434 -14 q 26 36 120 -14 l 26 188 q 263 123 143 123 q 410 162 356 123 q 463 273 463 202 q 436 356 463 319 q 319 448 408 392 q 214 531 248 494 q 162 613 180 568 q 144 711 144 657 q 186 865 144 798 q 304 969 227 932 q 476 1006 380 1006 q 734 943 615 1006 l 676 814 q 476 866 567 866 q 357 827 402 866 q 312 723 312 787 q 322 667 312 691 q 354 622 333 643 q 445 558 375 602 q 590 430 550 492 q 630 290 630 369 m 416 1087 q 569 1293 482 1161 l 748 1293 l 748 1280 q 641 1170 711 1235 q 522 1071 570 1106 l 416 1071 l 416 1087 "},"Ü":{"x_min":103.09375,"x_max":962.390625,"ha":949,"o":"m 962 992 l 825 343 q 684 73 787 161 q 411 -14 581 -14 q 183 57 263 -14 q 103 264 103 129 q 116 380 103 321 l 247 992 l 408 992 l 278 377 q 263 270 263 317 q 304 162 263 201 q 426 124 344 124 q 582 179 524 124 q 666 356 640 233 l 801 992 l 962 992 m 407 1164 q 431 1231 407 1205 q 498 1257 455 1257 q 550 1241 530 1257 q 569 1192 569 1225 q 545 1123 569 1148 q 481 1098 521 1098 q 428 1113 449 1098 q 407 1164 407 1129 m 667 1164 q 691 1231 667 1205 q 757 1257 715 1257 q 809 1241 790 1257 q 829 1192 829 1225 q 805 1123 829 1148 q 741 1098 780 1098 q 688 1113 709 1098 q 667 1164 667 1129 "},"à":{"x_min":63.75,"x_max":780.640625,"ha":804,"o":"m 270 -14 q 119 54 174 -14 q 63 248 63 123 q 110 505 63 385 q 240 694 158 624 q 422 764 323 764 q 535 733 488 764 q 609 643 583 702 l 616 643 l 658 750 l 780 750 l 620 0 l 497 0 l 511 119 l 507 119 q 270 -14 400 -14 m 328 114 q 438 167 384 114 q 526 308 491 220 q 560 501 560 396 q 529 597 560 561 q 445 633 497 633 q 337 581 387 633 q 255 439 286 529 q 225 252 225 349 q 252 149 225 183 q 328 114 280 114 m 574 842 l 476 842 q 387 944 432 884 q 318 1049 341 1004 l 318 1064 l 485 1064 q 574 858 516 959 l 574 842 "},"ơ":{"x_min":63.75,"x_max":965.109375,"ha":836,"o":"m 450 762 q 673 663 598 762 q 751 728 721 682 q 797 864 781 775 l 959 864 l 965 848 q 879 679 937 741 q 715 577 822 616 q 731 469 731 529 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 "},"ó":{"x_min":63.75,"x_max":731.796875,"ha":796,"o":"m 571 475 q 537 589 571 548 q 442 630 504 630 q 329 581 379 630 q 252 450 280 533 q 225 273 225 367 q 258 158 225 198 q 358 118 292 118 q 467 164 419 118 q 543 293 516 210 q 571 475 571 376 m 731 469 q 682 220 731 332 q 546 47 632 107 q 347 -12 459 -12 q 140 65 217 -12 q 63 276 63 143 q 112 524 63 411 q 248 699 160 636 q 450 762 335 762 q 657 683 582 762 q 731 469 731 604 m 393 858 q 546 1064 459 932 l 725 1064 l 725 1051 q 618 941 688 1006 q 499 842 547 877 l 393 842 l 393 858 "},"ŗ":{"x_min":-67.734375,"x_max":613.796875,"ha":567,"o":"m 540 764 q 613 755 582 764 l 579 607 q 510 616 542 616 q 357 540 424 616 q 263 339 290 463 l 191 0 l 31 0 l 191 750 l 316 750 l 302 611 l 308 611 q 421 728 364 692 q 540 764 477 764 m -67 -288 q 23 -85 -8 -183 l 174 -85 l 174 -98 q 111 -201 154 -142 q 23 -307 67 -260 l -67 -307 l -67 -288 "}},"cssFontWeight":"normal","ascender":1485,"underlinePosition":-154,"cssFontStyle":"italic","boundingBox":{"yMin":-390,"xMin":-659.90625,"yMax":1456,"xMax":1565.34375},"resolution":1000,"original_font_information":{"postscript_name":"OpenSans-SemiboldItalic","version_string":"Version 1.10","vendor_url":"http://www.ascendercorp.com/","full_font_name":"Open Sans Semibold Italic","font_family_name":"Open Sans Semibold","copyright":"Digitized data copyright © 2010-2011, Google Corporation.","description":"","trademark":"Open Sans is a trademark of Google and may be registered in certain jurisdictions.","designer":"","designer_url":"http://www.ascendercorp.com/typedesigners.html","unique_font_identifier":"Ascender - Open Sans Semibold Italic Build 100","license_url":"http://www.apache.org/licenses/LICENSE-2.0","license_description":"Licensed under the Apache License, Version 2.0","manufacturer_name":"Ascender Corporation","font_sub_family_name":"Italic"},"descender":-407,"familyName":"Open Sans","lineHeight":1891,"underlineThickness":102});
if (_typeface_js && _typeface_js.loadFace) _typeface_js.loadFace({"glyphs":{"ợ":{"x_min":62.390625,"x_max":1007.171875,"ha":943,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 575 749 508 773 q 691 679 643 726 q 792 873 792 709 l 997 873 l 1007 858 q 959 713 988 767 q 881 624 929 660 q 762 570 833 587 q 797 380 797 485 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 860 0 l 860 0 m 319 -190 q 432 -89 319 -89 q 544 -190 544 -89 q 516 -265 544 -238 q 432 -291 487 -291 q 319 -190 319 -291 "},"¦":{"x_min":308.578125,"x_max":457.109375,"ha":765,"o":"m 308 1051 l 457 1051 l 457 499 l 308 499 l 308 1051 m 308 238 l 457 238 l 457 -315 l 308 -315 l 308 238 "},"Ẩ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 868 1335 q 783 1241 868 1258 l 779 1200 l 693 1200 l 686 1278 q 746 1290 724 1280 q 768 1320 768 1301 q 756 1345 768 1335 q 714 1355 743 1355 q 665 1348 690 1355 l 665 1434 q 728 1439 680 1439 q 830 1414 791 1439 q 868 1335 868 1390 m 732 1071 l 623 1071 q 480 1183 547 1121 q 336 1071 402 1115 l 227 1071 l 227 1089 q 372 1279 302 1177 l 586 1279 q 668 1168 622 1226 q 732 1089 713 1110 l 732 1071 "},"ǻ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 319 1189 l 319 1199 q 386 1269 350 1228 q 437 1331 422 1309 l 669 1331 l 669 1322 q 599 1270 655 1306 q 457 1189 543 1235 l 319 1189 m 597 975 q 549 857 597 901 q 425 812 501 812 q 303 855 349 812 q 257 973 257 899 q 302 1090 257 1047 q 425 1134 348 1134 q 548 1089 499 1134 q 597 975 597 1045 m 490 973 q 472 1021 490 1004 q 425 1039 453 1039 q 378 1021 396 1039 q 359 973 359 1004 q 376 925 359 943 q 425 908 392 908 q 472 925 453 908 q 490 973 490 943 "},"Ỷ":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 603 1237 q 493 1104 603 1131 l 486 1056 l 368 1056 l 353 1155 q 422 1180 403 1163 q 440 1223 440 1198 q 426 1256 440 1245 q 388 1268 412 1268 q 294 1252 344 1268 l 294 1366 q 350 1377 315 1373 q 414 1382 386 1382 q 556 1344 509 1382 q 603 1237 603 1306 "},"Ő":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 323 1071 l 323 1089 q 403 1206 365 1146 q 455 1293 441 1265 l 659 1293 l 659 1278 q 560 1175 637 1242 q 433 1071 483 1107 l 323 1071 m 592 1071 l 592 1089 q 725 1293 687 1219 l 929 1293 l 929 1278 q 844 1187 912 1249 q 702 1071 775 1125 l 592 1071 "},"Ổ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 935 1335 q 850 1241 935 1258 l 846 1200 l 760 1200 l 753 1278 q 813 1290 791 1280 q 835 1320 835 1301 q 823 1345 835 1335 q 781 1355 810 1355 q 732 1348 757 1355 l 732 1434 q 795 1439 747 1439 q 897 1414 858 1439 q 935 1335 935 1390 m 799 1071 l 690 1071 q 547 1183 614 1121 q 403 1071 469 1115 l 294 1071 l 294 1089 q 439 1279 369 1177 l 653 1279 q 735 1168 689 1226 q 799 1089 780 1110 l 799 1071 "},"Ừ":{"x_min":118.015625,"x_max":1243.296875,"ha":1229,"o":"m 931 992 l 931 864 q 1005 932 982 881 q 1029 1056 1029 983 l 1233 1056 l 1243 1041 q 1185 879 1221 936 q 1087 787 1149 822 q 931 739 1025 752 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 368 q 375 212 327 262 q 526 162 423 162 q 675 214 629 162 q 722 369 722 266 l 722 992 l 931 992 m 1050 0 l 1050 0 m 493 1071 q 368 1167 450 1100 q 239 1278 285 1234 l 239 1293 l 471 1293 q 630 1089 513 1224 l 630 1071 l 493 1071 "},"Ž":{"x_min":33.21875,"x_max":770.78125,"ha":804,"o":"m 770 0 l 33 0 l 33 136 l 508 818 l 46 818 l 46 992 l 757 992 l 757 856 l 283 173 l 770 173 l 770 0 m 705 1293 l 705 1274 q 600 1161 648 1217 q 531 1071 552 1104 l 289 1071 q 233 1147 270 1102 q 116 1274 196 1191 l 116 1293 l 253 1293 q 409 1174 353 1230 q 567 1293 466 1232 l 705 1293 "},"Á":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 367 1071 l 367 1089 q 526 1293 483 1224 l 758 1293 l 758 1278 q 638 1174 723 1243 q 504 1071 552 1104 l 367 1071 "},"ĥ":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 479 607 601 607 q 354 548 392 607 q 315 357 315 489 l 315 0 l 108 0 l 108 1055 l 315 1055 l 315 840 q 310 722 315 815 l 305 661 l 316 661 q 536 773 385 773 q 739 701 670 773 q 808 494 808 629 l 808 0 m 613 1109 q 455 1227 507 1171 q 299 1109 402 1173 l 162 1109 l 162 1127 q 335 1331 290 1255 l 577 1331 q 650 1235 598 1295 q 751 1127 702 1174 l 751 1109 l 613 1109 "},"Î":{"x_min":-64.859375,"x_max":524.515625,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 386 1071 q 228 1189 280 1133 q 72 1071 175 1135 l -64 1071 l -64 1089 q 108 1293 63 1217 l 350 1293 q 423 1197 371 1257 q 524 1089 475 1136 l 524 1071 l 386 1071 "},"e":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 "},"»":{"x_min":55.609375,"x_max":798.765625,"ha":855,"o":"m 798 371 l 547 64 l 398 144 l 587 380 l 398 616 l 547 697 l 798 388 l 798 371 m 455 371 l 204 64 l 55 144 l 244 380 l 55 616 l 204 697 l 455 388 l 455 371 "},"Ề":{"x_min":-34.984375,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 162 1089 q 308 1279 238 1177 l 522 1279 q 598 1174 555 1230 q 668 1089 641 1119 l 668 1071 l 558 1071 q 415 1183 492 1115 q 272 1071 343 1118 l 162 1071 l 162 1089 m 222 1203 l 119 1203 q -34 1342 8 1283 l -34 1357 l 129 1357 q 222 1220 165 1281 l 222 1203 "},"ļ":{"x_min":67.546875,"x_max":315.375,"ha":424,"o":"m 315 0 l 108 0 l 108 1055 l 315 1055 l 315 0 m 67 -288 q 90 -191 77 -255 q 109 -85 104 -128 l 300 -85 l 300 -98 q 188 -307 250 -212 l 67 -307 l 67 -288 "},"Ĕ":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 672 1300 q 589 1133 664 1195 q 402 1071 515 1071 q 214 1132 284 1071 q 138 1300 144 1194 l 254 1300 q 272 1249 256 1268 q 317 1223 288 1231 q 404 1215 346 1215 q 554 1300 543 1215 l 672 1300 "},"ị":{"x_min":98.671875,"x_max":324.875,"ha":424,"o":"m 99 953 q 212 1055 99 1055 q 324 953 324 1055 q 296 879 324 905 q 212 852 268 852 q 99 953 99 852 m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 98 -190 q 211 -89 98 -89 q 323 -190 323 -89 q 295 -265 323 -238 q 211 -291 266 -291 q 98 -190 98 -291 "}," ":{"x_min":0,"x_max":0,"ha":695},"ỹ":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 287 913 q 247 894 266 913 q 219 840 228 876 l 118 840 q 174 994 125 938 q 302 1050 222 1050 q 357 1038 330 1050 q 410 1014 384 1027 q 461 989 436 1000 q 511 978 486 978 q 551 996 532 978 q 579 1051 570 1014 l 680 1051 q 624 896 673 952 q 496 841 574 841 q 441 852 468 841 q 388 877 414 863 q 337 901 362 890 q 287 913 312 913 "},"ò":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 415 842 q 290 938 372 871 q 161 1049 207 1005 l 161 1064 l 393 1064 q 552 860 435 995 l 552 842 l 415 842 "},"ţ":{"x_min":31.890625,"x_max":558.234375,"ha":603,"o":"m 427 150 q 558 174 482 150 l 558 20 q 368 -14 480 -14 q 187 48 244 -14 q 130 237 130 111 l 130 602 l 31 602 l 31 690 l 145 759 l 205 919 l 337 919 l 337 758 l 550 758 l 550 602 l 337 602 l 337 236 q 362 171 337 192 q 427 150 387 150 m 501 -170 q 450 -295 501 -256 q 291 -334 399 -334 q 192 -319 239 -334 l 192 -205 q 242 -215 211 -210 q 289 -220 273 -220 q 338 -177 338 -220 q 226 -104 338 -121 l 279 0 l 410 0 l 391 -42 q 471 -92 441 -58 q 501 -170 501 -126 "},"^":{"x_min":5.421875,"x_max":735.609375,"ha":739,"o":"m 5 353 l 302 997 l 400 997 l 735 353 l 573 353 l 355 788 l 165 353 l 5 353 "},"«":{"x_min":55.546875,"x_max":799.390625,"ha":855,"o":"m 55 388 l 307 697 l 455 616 l 266 380 l 455 144 l 307 64 l 55 371 l 55 388 m 399 388 l 650 697 l 799 616 l 610 380 l 799 144 l 650 64 l 399 371 l 399 388 "},"ử":{"x_min":104.453125,"x_max":1119.875,"ha":1055,"o":"m 645 0 l 617 96 l 605 96 q 512 15 573 44 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 679 q 879 743 852 693 q 905 872 905 793 l 1109 872 l 1119 857 q 1061 694 1098 751 q 962 602 1024 637 q 804 554 900 568 l 804 0 l 645 0 m 913 0 l 913 0 m 628 1008 q 518 875 628 902 l 511 827 l 393 827 l 378 926 q 447 951 428 934 q 465 994 465 969 q 451 1027 465 1016 q 413 1039 437 1039 q 319 1023 369 1039 l 319 1137 q 375 1148 340 1144 q 439 1153 411 1153 q 581 1115 534 1153 q 628 1008 628 1077 "},"í":{"x_min":98.15625,"x_max":489.484375,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 98 842 l 98 860 q 257 1064 214 995 l 489 1064 l 489 1049 q 369 945 454 1014 q 235 842 283 875 l 98 842 "},"ˆ":{"x_min":126.140625,"x_max":715.515625,"ha":843,"o":"m 577 842 q 419 960 471 904 q 263 842 366 906 l 126 842 l 126 860 q 299 1064 254 988 l 541 1064 q 614 968 562 1028 q 715 860 666 907 l 715 842 l 577 842 "},"ū":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 223 985 l 683 985 l 683 842 l 223 842 l 223 985 "},"Ẅ":{"x_min":0,"x_max":1343,"ha":1343,"o":"m 1090 0 l 851 0 l 716 521 q 691 636 709 549 q 670 753 673 723 q 650 635 666 716 q 625 519 634 554 l 491 0 l 253 0 l 0 992 l 206 992 l 333 450 q 381 190 366 300 q 400 310 385 229 q 427 436 415 391 l 572 992 l 771 992 l 915 436 q 939 322 925 398 q 961 190 953 245 q 982 322 967 243 q 1009 450 997 401 l 1136 992 l 1343 992 l 1090 0 m 438 1182 q 463 1250 438 1226 q 532 1273 489 1273 q 602 1248 577 1273 q 628 1182 628 1223 q 602 1116 628 1141 q 532 1092 576 1092 q 463 1115 489 1092 q 438 1182 438 1139 m 711 1182 q 738 1251 711 1229 q 806 1273 766 1273 q 877 1249 850 1273 q 903 1182 903 1224 q 876 1116 903 1140 q 806 1092 850 1092 q 738 1114 766 1092 q 711 1182 711 1136 "},"ȷ":{"x_min":-88.84375,"x_max":315.375,"ha":424,"o":"m 47 -334 q -88 -317 -31 -334 l -88 -154 q 8 -167 -41 -167 q 84 -137 60 -167 q 108 -51 108 -108 l 108 758 l 315 758 l 315 -82 q 245 -268 315 -203 q 47 -334 175 -334 "},"ņ":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 572 566 601 525 q 479 607 543 607 q 354 549 392 607 q 315 357 315 491 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 401 744 340 716 q 539 773 461 773 q 740 701 671 773 q 808 494 808 629 l 808 0 m 316 -288 q 339 -191 326 -255 q 358 -85 353 -128 l 549 -85 l 549 -98 q 437 -307 499 -212 l 316 -307 l 316 -288 "},"µ":{"x_min":108.515625,"x_max":808.484375,"ha":917,"o":"m 315 314 q 345 191 315 232 q 438 150 375 150 q 562 209 524 150 q 601 401 601 268 l 601 758 l 808 758 l 808 0 l 651 0 l 622 101 l 612 101 q 543 14 583 43 q 442 -14 502 -14 q 365 1 400 -14 q 308 47 330 17 l 311 -10 l 315 -117 l 315 -334 l 108 -334 l 108 758 l 315 758 l 315 314 "},"ỳ":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 366 842 q 241 938 323 871 q 112 1049 158 1005 l 112 1064 l 344 1064 q 503 860 386 995 l 503 842 l 366 842 "},"č":{"x_min":62.390625,"x_max":715.515625,"ha":714,"o":"m 416 -14 q 62 375 62 -14 q 158 670 62 568 q 434 773 254 773 q 670 721 566 773 l 609 561 q 518 593 560 581 q 434 606 476 606 q 273 376 273 606 q 434 153 273 153 q 545 169 494 153 q 646 219 596 185 l 646 42 q 545 -1 596 10 q 416 -14 494 -14 m 715 1064 l 715 1045 q 610 932 658 988 q 541 842 562 875 l 299 842 q 243 918 280 873 q 126 1045 206 962 l 126 1064 l 263 1064 q 419 945 363 1001 q 577 1064 476 1003 l 715 1064 "},"’":{"x_min":16.953125,"x_max":284.859375,"ha":301,"o":"m 275 992 l 284 977 q 165 652 250 843 l 16 652 q 84 992 63 852 l 275 992 "},"-":{"x_min":41.375,"x_max":405.625,"ha":447,"o":"m 41 287 l 41 457 l 405 457 l 405 287 l 41 287 "},"Q":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 963 203 1025 321 q 781 30 901 85 l 1019 -236 l 750 -236 l 568 -14 l 553 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 "},"M":{"x_min":124.796875,"x_max":1185.21875,"ha":1310,"o":"m 544 0 l 305 778 l 299 778 q 312 461 312 540 l 312 0 l 124 0 l 124 992 l 411 992 l 645 233 l 649 233 l 898 992 l 1185 992 l 1185 0 l 989 0 l 989 469 q 990 546 989 502 q 999 776 991 589 l 993 776 l 737 0 l 544 0 "},"œ":{"x_min":62.390625,"x_max":1298.3125,"ha":1358,"o":"m 980 -14 q 695 91 796 -14 q 430 -14 600 -14 q 236 33 320 -14 q 107 170 152 81 q 62 380 62 260 q 158 670 62 568 q 429 773 254 773 q 572 746 505 773 q 688 667 640 719 q 948 773 786 773 q 1206 681 1113 773 q 1298 427 1298 589 l 1298 327 l 792 327 l 792 321 q 847 187 797 235 q 988 139 898 139 q 1124 154 1061 139 q 1254 199 1187 168 l 1254 39 q 1135 0 1200 13 q 980 -14 1071 -14 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 585 380 585 267 q 549 549 585 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 952 625 q 846 586 888 625 q 798 465 804 547 l 1103 465 q 1062 583 1102 540 q 952 625 1023 625 "},"ě":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 716 1064 l 716 1045 q 611 932 659 988 q 542 842 563 875 l 300 842 q 244 918 281 873 q 127 1045 207 962 l 127 1064 l 264 1064 q 420 945 364 1001 q 578 1064 477 1003 l 716 1064 "},"Ộ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 440 -190 q 553 -89 440 -89 q 665 -190 665 -89 q 637 -265 665 -238 q 553 -291 608 -291 q 440 -190 440 -291 m 708 1071 q 550 1189 602 1133 q 394 1071 497 1135 l 257 1071 l 257 1089 q 430 1293 385 1217 l 672 1293 q 745 1197 693 1257 q 846 1089 797 1136 l 846 1071 l 708 1071 "},"ũ":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 342 913 q 302 894 321 913 q 274 840 283 876 l 173 840 q 229 994 180 938 q 357 1050 277 1050 q 412 1038 385 1050 q 465 1014 439 1027 q 516 989 491 1000 q 566 978 541 978 q 606 996 587 978 q 634 1051 625 1014 l 735 1051 q 679 896 728 952 q 551 841 629 841 q 496 852 523 841 q 443 877 469 863 q 392 901 417 890 q 342 913 367 913 "},"Ậ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 637 1071 q 479 1189 531 1133 q 323 1071 426 1135 l 186 1071 l 186 1089 q 359 1293 314 1217 l 601 1293 q 674 1197 622 1257 q 775 1089 726 1136 l 775 1071 l 637 1071 m 366 -190 q 479 -89 366 -89 q 591 -190 591 -89 q 563 -265 591 -238 q 479 -291 534 -291 q 366 -190 366 -291 "},"ŭ":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 720 1071 q 637 904 712 966 q 450 842 563 842 q 262 903 332 842 q 186 1071 192 965 l 302 1071 q 320 1020 304 1039 q 365 994 336 1002 q 452 986 394 986 q 602 1071 591 986 l 720 1071 "},"―":{"x_min":55.609375,"x_max":1333.390625,"ha":1389,"o":"m 55 296 l 55 452 l 1333 452 l 1333 296 l 55 296 "},"{":{"x_min":21,"x_max":491.390625,"ha":547,"o":"m 194 183 q 150 273 194 242 q 21 304 105 304 l 21 466 q 150 496 106 466 q 194 582 194 526 l 194 587 l 194 803 q 260 949 194 907 q 491 992 325 992 l 491 839 q 398 813 424 837 q 373 743 373 789 l 373 540 q 214 390 369 413 l 214 381 q 373 238 373 358 l 373 231 l 373 28 q 398 -40 373 -17 q 491 -66 423 -64 l 491 -220 q 260 -177 325 -220 q 194 -30 194 -135 l 194 183 "},"¼":{"x_min":31.25,"x_max":1140.84375,"ha":1224,"o":"m 364 397 l 203 397 l 203 700 l 205 776 l 208 840 q 158 787 190 816 l 105 746 l 31 832 l 235 992 l 364 992 l 364 397 m 929 992 l 379 0 l 217 0 l 767 992 l 929 992 m 1140 103 l 1056 103 l 1056 0 l 894 0 l 894 103 l 635 103 l 635 207 l 896 599 l 1056 599 l 1056 217 l 1140 217 l 1140 103 m 894 217 l 894 328 q 898 453 894 386 q 874 398 892 435 q 846 346 856 362 l 760 217 l 894 217 "},"#":{"x_min":30.4375,"x_max":866.546875,"ha":897,"o":"m 677 572 l 645 415 l 820 415 l 820 275 l 619 275 l 566 0 l 417 0 l 470 275 l 339 275 l 287 0 l 141 0 l 191 275 l 30 275 l 30 415 l 218 415 l 250 572 l 79 572 l 79 714 l 275 714 l 327 990 l 475 990 l 423 714 l 557 714 l 610 990 l 756 990 l 703 714 l 866 714 l 866 572 l 677 572 m 365 415 l 498 415 l 530 572 l 397 572 l 365 415 "},"Ḿ":{"x_min":124.796875,"x_max":1185.21875,"ha":1310,"o":"m 544 0 l 305 778 l 299 778 q 312 461 312 540 l 312 0 l 124 0 l 124 992 l 411 992 l 645 233 l 649 233 l 898 992 l 1185 992 l 1185 0 l 989 0 l 989 469 q 990 546 989 502 q 999 776 991 589 l 993 776 l 737 0 l 544 0 m 531 1073 l 531 1091 q 690 1295 647 1226 l 922 1295 l 922 1280 q 802 1176 887 1245 q 668 1073 716 1106 l 531 1073 "},"Ĳ":{"x_min":124.84375,"x_max":876.046875,"ha":1000,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 562 -291 q 437 -276 490 -291 l 437 -101 q 536 -114 492 -114 q 635 -71 606 -114 q 665 63 665 -28 l 665 992 l 876 992 l 876 64 q 796 -200 876 -109 q 562 -291 717 -291 "},"Ê":{"x_min":119.140625,"x_max":708.515625,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 570 1071 q 412 1189 464 1133 q 256 1071 359 1135 l 119 1071 l 119 1089 q 292 1293 247 1217 l 534 1293 q 607 1197 555 1257 q 708 1089 659 1136 l 708 1071 l 570 1071 "},")":{"x_min":41.375,"x_max":415.078125,"ha":471,"o":"m 415 380 q 362 48 415 202 q 210 -220 309 -106 l 42 -220 q 184 59 134 -95 q 234 381 234 214 q 185 704 234 547 q 41 992 137 861 l 210 992 q 362 716 310 873 q 415 380 415 559 "},"ș":{"x_min":62.390625,"x_max":637.09375,"ha":690,"o":"m 637 224 q 556 47 637 108 q 313 -14 475 -14 q 172 -2 231 -14 q 63 30 114 8 l 63 201 q 193 155 121 173 q 320 137 265 137 q 432 202 432 137 q 418 242 432 226 q 366 276 403 257 q 269 322 329 296 q 140 390 181 358 q 81 461 99 421 q 62 561 62 502 q 140 717 62 662 q 362 773 218 773 q 628 713 499 773 l 566 564 q 460 604 509 588 q 359 619 410 619 q 267 570 267 619 q 297 521 267 542 q 426 461 326 501 q 556 394 515 425 q 617 322 597 362 q 637 224 637 281 m 199 -288 q 222 -191 209 -255 q 241 -85 236 -128 l 432 -85 l 432 -98 q 320 -307 382 -212 l 199 -307 l 199 -288 "},"Å":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 650 1063 q 602 945 650 989 q 477 900 553 900 q 355 943 401 900 q 309 1061 309 987 q 355 1178 309 1134 q 477 1222 401 1222 q 601 1177 552 1222 q 650 1063 650 1132 m 543 1061 q 524 1109 543 1092 q 477 1126 506 1126 q 431 1109 449 1126 q 412 1061 412 1092 q 429 1013 412 1031 q 477 996 445 996 q 524 1013 506 996 q 543 1061 543 1031 "},"¸":{"x_min":-25.03125,"x_max":283.5625,"ha":285,"o":"m 283 -170 q 232 -295 283 -256 q 73 -334 181 -334 q -25 -319 21 -334 l -25 -205 q 24 -215 -6 -210 q 71 -220 55 -220 q 120 -177 120 -220 q 8 -104 120 -121 l 61 0 l 192 0 l 173 -42 q 253 -92 223 -58 q 283 -170 283 -126 "},"a":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 "},"Ę":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 532 -154 q 548 -196 532 -182 q 587 -209 563 -209 q 664 -197 624 -209 l 664 -318 q 559 -334 609 -334 q 436 -290 482 -334 q 389 -177 389 -247 q 415 -92 389 -132 q 511 0 441 -52 l 633 0 q 559 -81 585 -44 q 532 -154 532 -118 "},"=":{"x_min":59.6875,"x_max":733.3125,"ha":793,"o":"m 59 546 l 59 695 l 733 695 l 733 546 l 59 546 m 59 284 l 59 432 l 733 432 l 733 284 l 59 284 "},"ạ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 281 -190 q 394 -89 281 -89 q 506 -190 506 -89 q 478 -265 506 -238 q 394 -291 449 -291 q 281 -190 281 -291 "},"˚":{"x_min":230.734375,"x_max":571.203125,"ha":802,"o":"m 571 1002 q 523 884 571 929 q 398 840 474 840 q 276 883 322 840 q 230 1001 230 926 q 276 1118 230 1074 q 398 1162 322 1162 q 522 1117 473 1162 q 571 1002 571 1072 m 464 1001 q 445 1049 464 1031 q 398 1066 427 1066 q 352 1049 370 1066 q 333 1001 333 1031 q 350 953 333 970 q 398 935 366 935 q 445 953 427 935 q 464 1001 464 970 "},"ú":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 338 842 l 338 860 q 497 1064 454 995 l 729 1064 l 729 1049 q 609 945 694 1014 q 475 842 523 875 l 338 842 "},"¯":{"x_min":-4.0625,"x_max":699.0625,"ha":695,"o":"m 699 1055 l -4 1055 l -4 1191 l 699 1191 l 699 1055 "},"Z":{"x_min":33.21875,"x_max":770.78125,"ha":804,"o":"m 770 0 l 33 0 l 33 136 l 508 818 l 46 818 l 46 992 l 757 992 l 757 856 l 283 173 l 770 173 l 770 0 "}," ":{"x_min":0,"x_max":0,"ha":232},"u":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 "},"k":{"x_min":108.515625,"x_max":861,"ha":861,"o":"m 307 412 l 397 527 l 609 758 l 842 758 l 541 429 l 861 0 l 622 0 l 404 307 l 315 235 l 315 0 l 108 0 l 108 1055 l 315 1055 l 315 584 l 304 412 l 307 412 "},"Ù":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 508 1071 q 383 1167 465 1100 q 254 1278 300 1234 l 254 1293 l 486 1293 q 645 1089 528 1224 l 645 1071 l 508 1071 "},"ẻ":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 604 1008 q 494 875 604 902 l 487 827 l 369 827 l 354 926 q 423 951 404 934 q 441 994 441 969 q 427 1027 441 1016 q 389 1039 413 1039 q 295 1023 345 1039 l 295 1137 q 351 1148 316 1144 q 415 1153 387 1153 q 557 1115 510 1153 q 604 1008 604 1077 "},"ẵ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 277 1043 q 317 979 281 1003 q 420 955 353 955 q 563 1043 553 955 l 664 1043 q 595 893 658 944 q 421 842 533 842 q 245 895 311 842 q 172 1043 180 949 l 277 1043 m 524 1076 q 474 1084 499 1076 q 424 1103 448 1093 q 377 1122 399 1113 q 335 1130 354 1130 q 292 1118 306 1130 q 270 1075 279 1106 l 193 1075 q 233 1183 199 1142 q 328 1225 266 1225 q 379 1216 353 1225 q 430 1196 406 1207 q 477 1177 454 1186 q 517 1168 499 1168 q 558 1181 545 1168 q 582 1226 572 1193 l 659 1226 q 616 1114 651 1152 q 524 1076 581 1076 "},"Ů":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 696 1231 q 648 1113 696 1158 q 523 1069 599 1069 q 401 1112 447 1069 q 355 1230 355 1155 q 401 1347 355 1303 q 523 1391 447 1391 q 647 1346 598 1391 q 696 1231 696 1301 m 589 1230 q 570 1278 589 1260 q 523 1295 552 1295 q 477 1278 495 1295 q 458 1230 458 1260 q 475 1182 458 1199 q 523 1164 491 1164 q 570 1182 552 1164 q 589 1230 589 1199 "},"¢":{"x_min":97,"x_max":705.484375,"ha":793,"o":"m 381 119 q 97 502 97 159 q 167 776 97 679 q 381 893 238 872 l 381 1006 l 502 1006 l 502 899 q 705 848 615 892 l 644 689 q 553 721 595 709 q 469 733 511 733 q 347 676 387 733 q 308 504 308 620 q 469 282 308 282 q 569 292 525 282 q 682 333 614 303 l 682 161 q 502 114 596 120 l 502 -14 l 381 -14 l 381 119 "},"ữ":{"x_min":104.453125,"x_max":1119.875,"ha":1055,"o":"m 645 0 l 617 96 l 605 96 q 512 15 573 44 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 679 q 879 743 852 693 q 905 872 905 793 l 1109 872 l 1119 857 q 1061 694 1098 751 q 962 602 1024 637 q 804 554 900 568 l 804 0 l 645 0 m 913 0 l 913 0 m 344 913 q 304 894 323 913 q 276 840 285 876 l 175 840 q 231 994 182 938 q 359 1050 279 1050 q 414 1038 387 1050 q 467 1014 441 1027 q 518 989 493 1000 q 568 978 543 978 q 608 996 589 978 q 636 1051 627 1014 l 737 1051 q 681 896 730 952 q 553 841 631 841 q 498 852 525 841 q 445 877 471 863 q 394 901 419 890 q 344 913 369 913 "},"Ş":{"x_min":63.75,"x_max":710.0625,"ha":765,"o":"m 710 275 q 613 63 710 140 q 344 -14 516 -14 q 63 45 185 -14 l 63 241 q 233 177 164 196 q 360 159 303 159 q 466 186 429 159 q 503 264 503 212 q 487 316 503 294 q 439 360 471 339 q 311 427 408 381 q 174 509 220 470 q 102 601 129 549 q 75 723 75 653 q 164 930 75 855 q 410 1006 253 1006 q 558 987 488 1006 q 705 936 628 969 l 637 772 q 506 818 558 805 q 404 831 454 831 q 312 803 344 831 q 280 730 280 775 q 293 682 280 702 q 334 641 306 661 q 467 572 362 622 q 658 438 606 505 q 710 275 710 372 m 523 -170 q 472 -295 523 -256 q 313 -334 421 -334 q 214 -319 261 -334 l 214 -205 q 264 -215 233 -210 q 311 -220 295 -220 q 360 -177 360 -220 q 248 -104 360 -121 l 301 0 l 432 0 l 413 -42 q 493 -92 463 -58 q 523 -170 523 -126 "},"é":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 303 842 l 303 860 q 462 1064 419 995 l 694 1064 l 694 1049 q 574 945 659 1014 q 440 842 488 875 l 303 842 "},"B":{"x_min":124.796875,"x_max":859.75,"ha":933,"o":"m 124 992 l 433 992 q 739 931 644 992 q 834 740 834 871 q 792 594 834 651 q 682 526 751 537 l 682 519 q 818 440 776 498 q 859 287 859 383 q 761 75 859 151 q 495 0 663 0 l 124 0 l 124 992 m 335 599 l 457 599 q 580 625 542 599 q 619 713 619 651 q 577 794 619 770 q 445 819 535 819 l 335 819 l 335 599 m 335 432 l 335 173 l 471 173 q 600 206 558 173 q 641 308 641 240 q 465 432 641 432 l 335 432 "},"…":{"x_min":79.359375,"x_max":1107.734375,"ha":1188,"o":"m 79 97 q 109 183 79 154 q 198 212 140 212 q 285 182 255 212 q 316 97 316 152 q 285 12 316 43 q 198 -18 254 -18 q 110 12 141 -18 q 79 97 79 42 m 474 97 q 504 183 474 154 q 594 212 535 212 q 681 182 650 212 q 712 97 712 152 q 681 12 712 43 q 594 -18 650 -18 q 505 12 536 -18 q 474 97 474 42 m 870 97 q 900 183 870 154 q 989 212 931 212 q 1076 182 1046 212 q 1107 97 1107 152 q 1076 12 1107 43 q 989 -18 1045 -18 q 901 12 932 -18 q 870 97 870 42 "},"Ủ":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 693 1237 q 583 1104 693 1131 l 576 1056 l 458 1056 l 443 1155 q 512 1180 493 1163 q 530 1223 530 1198 q 516 1256 530 1245 q 478 1268 502 1268 q 384 1252 434 1268 l 384 1366 q 440 1377 405 1373 q 504 1382 476 1382 q 646 1344 599 1382 q 693 1237 693 1306 "},"ē":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 188 985 l 648 985 l 648 842 l 188 842 l 188 985 "},"H":{"x_min":124.796875,"x_max":937.515625,"ha":1063,"o":"m 937 0 l 727 0 l 727 428 l 335 428 l 335 0 l 124 0 l 124 992 l 335 992 l 335 603 l 727 603 l 727 992 l 937 992 l 937 0 "},"î":{"x_min":-82.859375,"x_max":506.515625,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 368 842 q 210 960 262 904 q 54 842 157 906 l -82 842 l -82 860 q 90 1064 45 988 l 332 1064 q 405 968 353 1028 q 506 860 457 907 l 506 842 l 368 842 "},"ư":{"x_min":104.453125,"x_max":1119.875,"ha":1055,"o":"m 645 0 l 617 96 l 605 96 q 512 15 573 44 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 679 q 879 743 852 693 q 905 872 905 793 l 1109 872 l 1119 857 q 1061 694 1098 751 q 962 602 1024 637 q 804 554 900 568 l 804 0 l 645 0 m 913 0 l 913 0 "},"Ẹ":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 295 -190 q 408 -89 295 -89 q 520 -190 520 -89 q 492 -265 520 -238 q 408 -291 463 -291 q 295 -190 295 -291 "},"‼":{"x_min":79.265625,"x_max":712.640625,"ha":791,"o":"m 678 329 l 512 329 l 477 992 l 712 992 l 678 329 m 475 97 q 505 183 475 154 q 594 212 536 212 q 681 182 650 212 q 712 97 712 152 q 681 12 712 43 q 594 -18 650 -18 q 506 12 537 -18 q 475 97 475 42 m 282 329 l 116 329 l 81 992 l 316 992 l 282 329 m 79 97 q 109 183 79 154 q 198 212 140 212 q 285 182 254 212 q 316 97 316 152 q 285 12 316 43 q 198 -18 254 -18 q 110 12 141 -18 q 79 97 79 42 "},"ǰ":{"x_min":-88.84375,"x_max":505.515625,"ha":424,"o":"m 47 -334 q -88 -317 -31 -334 l -88 -154 q 8 -167 -41 -167 q 84 -137 60 -167 q 108 -51 108 -108 l 108 758 l 315 758 l 315 -82 q 245 -268 315 -203 q 47 -334 175 -334 m 505 1064 l 505 1045 q 400 932 448 988 q 331 842 352 875 l 89 842 q 33 918 70 873 q -83 1045 -3 962 l -83 1064 l 53 1064 q 209 945 153 1001 q 367 1064 266 1003 l 505 1064 "},"¥":{"x_min":4.0625,"x_max":787.578125,"ha":793,"o":"m 396 583 l 575 992 l 787 992 l 527 485 l 660 485 l 660 364 l 493 364 l 493 271 l 660 271 l 660 150 l 493 150 l 493 0 l 298 0 l 298 150 l 130 150 l 130 271 l 298 271 l 298 364 l 130 364 l 130 485 l 259 485 l 4 992 l 218 992 l 396 583 "},"Ĥ":{"x_min":124.796875,"x_max":937.515625,"ha":1063,"o":"m 937 0 l 727 0 l 727 428 l 335 428 l 335 0 l 124 0 l 124 992 l 335 992 l 335 603 l 727 603 l 727 992 l 937 992 l 937 0 m 686 1071 q 528 1189 580 1133 q 372 1071 475 1135 l 235 1071 l 235 1089 q 408 1293 363 1217 l 650 1293 q 723 1197 671 1257 q 824 1089 775 1136 l 824 1071 l 686 1071 "},"U":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 "},"Ñ":{"x_min":124.796875,"x_max":1004.21875,"ha":1129,"o":"m 1004 0 l 737 0 l 305 750 l 299 750 q 312 466 312 551 l 312 0 l 124 0 l 124 992 l 389 992 l 820 249 l 825 249 q 814 522 814 442 l 814 992 l 1004 992 l 1004 0 m 452 1142 q 412 1123 431 1142 q 384 1069 393 1105 l 283 1069 q 339 1223 290 1167 q 467 1279 387 1279 q 522 1267 495 1279 q 575 1243 549 1256 q 626 1218 601 1229 q 676 1207 651 1207 q 716 1225 697 1207 q 744 1280 735 1243 l 845 1280 q 789 1125 838 1181 q 661 1070 739 1070 q 606 1081 633 1070 q 553 1106 579 1092 q 502 1130 527 1119 q 452 1142 477 1142 "},"F":{"x_min":124.796875,"x_max":692.8125,"ha":762,"o":"m 331 0 l 124 0 l 124 992 l 692 992 l 692 819 l 331 819 l 331 564 l 667 564 l 667 392 l 331 392 l 331 0 "},"ả":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 593 1008 q 483 875 593 902 l 476 827 l 358 827 l 343 926 q 412 951 393 934 q 430 994 430 969 q 416 1027 430 1016 q 378 1039 402 1039 q 284 1023 334 1039 l 284 1137 q 340 1148 305 1144 q 404 1153 376 1153 q 546 1115 499 1153 q 593 1008 593 1077 "},"ĵ":{"x_min":-88.84375,"x_max":503.515625,"ha":424,"o":"m 47 -334 q -88 -317 -31 -334 l -88 -154 q 8 -167 -41 -167 q 84 -137 60 -167 q 108 -51 108 -108 l 108 758 l 315 758 l 315 -82 q 245 -268 315 -203 q 47 -334 175 -334 m 365 842 q 207 960 259 904 q 51 842 154 906 l -85 842 l -85 860 q 87 1064 42 988 l 329 1064 q 402 968 350 1028 q 503 860 454 907 l 503 842 l 365 842 "},"ā":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 198 985 l 658 985 l 658 842 l 198 842 l 198 985 "},"Ĩ":{"x_min":-50.625,"x_max":511.640625,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 118 1142 q 78 1123 97 1142 q 50 1069 59 1105 l -50 1069 q 5 1223 -43 1167 q 133 1279 53 1279 q 188 1267 161 1279 q 241 1243 215 1256 q 292 1218 267 1229 q 342 1207 317 1207 q 382 1225 363 1207 q 410 1280 401 1243 l 511 1280 q 455 1125 504 1181 q 327 1070 405 1070 q 272 1081 299 1070 q 219 1106 245 1092 q 168 1130 193 1119 q 118 1142 143 1142 "},"ă":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 695 1071 q 612 904 687 966 q 425 842 538 842 q 237 903 307 842 q 161 1071 167 965 l 277 1071 q 295 1020 279 1039 q 340 994 311 1002 q 427 986 369 986 q 577 1071 566 986 l 695 1071 "},"*":{"x_min":42.78125,"x_max":714.21875,"ha":757,"o":"m 466 1055 l 438 805 l 691 876 l 714 705 l 483 688 l 634 487 l 480 405 l 375 617 l 282 407 l 122 487 l 272 688 l 42 706 l 69 876 l 316 805 l 288 1055 l 466 1055 "},"†":{"x_min":83.421875,"x_max":633.578125,"ha":717,"o":"m 633 629 l 408 649 l 445 0 l 257 0 l 294 649 l 83 629 l 83 793 l 294 772 l 257 1055 l 445 1055 l 408 772 l 633 793 l 633 629 "},"ờ":{"x_min":62.390625,"x_max":1007.171875,"ha":943,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 575 749 508 773 q 691 679 643 726 q 792 873 792 709 l 997 873 l 1007 858 q 959 713 988 767 q 881 624 929 660 q 762 570 833 587 q 797 380 797 485 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 860 0 l 860 0 m 417 842 q 292 938 374 871 q 163 1049 209 1005 l 163 1064 l 395 1064 q 554 860 437 995 l 554 842 l 417 842 "},"°":{"x_min":62.453125,"x_max":531.796875,"ha":595,"o":"m 62 771 q 93 887 62 833 q 179 974 124 942 q 297 1006 233 1006 q 414 974 359 1006 q 500 888 468 943 q 531 771 531 833 q 500 653 531 708 q 414 568 468 599 q 297 538 360 538 q 130 605 198 538 q 62 771 62 672 m 192 771 q 222 697 192 727 q 297 666 252 666 q 372 698 341 666 q 402 771 402 729 q 372 845 402 814 q 297 877 341 877 q 222 846 253 877 q 192 771 192 815 "},"å":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 599 1002 q 551 884 599 929 q 426 840 502 840 q 304 883 350 840 q 258 1001 258 926 q 304 1118 258 1074 q 426 1162 350 1162 q 550 1117 501 1162 q 599 1002 599 1072 m 492 1001 q 473 1049 492 1031 q 426 1066 455 1066 q 380 1049 398 1066 q 361 1001 361 1031 q 378 953 361 970 q 426 935 394 935 q 473 953 455 935 q 492 1001 492 970 "},"ồ":{"x_min":-21.984375,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 175 860 q 321 1050 251 948 l 535 1050 q 611 945 568 1001 q 681 860 654 890 l 681 842 l 571 842 q 428 954 505 886 q 285 842 356 889 l 175 842 l 175 860 m 235 974 l 132 974 q -21 1113 21 1054 l -21 1128 l 142 1128 q 235 991 178 1052 l 235 974 "},"0":{"x_min":50.203125,"x_max":743.484375,"ha":793,"o":"m 743 495 q 658 110 743 235 q 396 -14 573 -14 q 137 114 224 -14 q 50 495 50 243 q 135 882 50 758 q 396 1007 219 1007 q 655 876 567 1007 q 743 495 743 746 m 258 495 q 289 233 258 312 q 396 154 321 154 q 502 234 469 154 q 534 495 534 315 q 501 757 534 677 q 396 837 468 837 q 290 757 322 837 q 258 495 258 677 "},"ō":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 199 985 l 659 985 l 659 842 l 199 842 l 199 985 "},"”":{"x_min":16.953125,"x_max":601.84375,"ha":618,"o":"m 284 977 q 165 652 250 843 l 16 652 q 84 992 63 852 l 275 992 l 284 977 m 601 977 q 482 652 567 843 l 333 652 q 401 992 380 852 l 591 992 l 601 977 "},"ŵ":{"x_min":13.5625,"x_max":1175.4375,"ha":1189,"o":"m 731 0 l 673 265 l 594 600 l 590 600 l 451 0 l 229 0 l 13 758 l 219 758 l 307 422 q 349 173 328 332 l 354 173 q 377 336 356 225 l 388 394 l 482 758 l 710 758 l 799 394 q 807 350 801 379 q 818 288 813 321 q 828 224 824 255 q 833 173 832 192 l 837 173 q 859 307 843 222 q 881 422 874 392 l 972 758 l 1175 758 l 957 0 l 731 0 m 751 842 q 593 960 645 904 q 437 842 540 906 l 300 842 l 300 860 q 473 1064 428 988 l 715 1064 q 788 968 736 1028 q 889 860 840 907 l 889 842 l 751 842 "},"Ķ":{"x_min":124.796875,"x_max":922,"ha":922,"o":"m 922 0 l 683 0 l 423 418 l 335 354 l 335 0 l 124 0 l 124 992 l 335 992 l 335 538 l 417 654 l 685 992 l 919 992 l 573 553 l 922 0 m 343 -288 q 366 -191 353 -255 q 385 -85 380 -128 l 576 -85 l 576 -98 q 464 -307 526 -212 l 343 -307 l 343 -288 "},"ö":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 197 953 q 222 1021 197 997 q 291 1044 248 1044 q 361 1019 336 1044 q 387 953 387 994 q 361 887 387 912 q 291 863 335 863 q 222 886 248 863 q 197 953 197 910 m 470 953 q 497 1022 470 1000 q 565 1044 525 1044 q 636 1020 609 1044 q 662 953 662 995 q 635 887 662 911 q 565 863 609 863 q 497 885 525 863 q 470 953 470 907 "},"ǽ":{"x_min":58.328125,"x_max":1214.3125,"ha":1274,"o":"m 901 -14 q 732 20 808 -14 q 607 125 656 54 q 473 16 540 46 q 299 -14 407 -14 q 124 50 190 -14 q 58 226 58 114 q 140 404 58 347 q 386 467 222 461 l 515 472 l 515 529 q 485 598 515 575 q 402 620 455 620 q 196 568 308 620 l 128 705 q 415 774 257 774 q 647 685 569 774 q 750 750 691 728 q 890 773 809 773 q 1127 679 1040 773 q 1214 427 1214 586 l 1214 327 l 723 327 q 776 189 727 239 q 913 139 824 139 q 1170 199 1046 139 l 1170 39 q 1054 0 1117 13 q 901 -14 992 -14 m 515 351 l 438 348 q 312 316 354 345 q 270 224 270 286 q 365 137 270 137 q 474 178 434 137 q 515 288 515 220 l 515 351 m 886 625 q 727 465 739 625 l 1019 465 q 982 583 1018 541 q 886 625 946 625 m 540 842 l 540 860 q 699 1064 656 995 l 931 1064 l 931 1049 q 811 945 896 1014 q 677 842 725 875 l 540 842 "},"Ļ":{"x_min":124.796875,"x_max":737.53125,"ha":785,"o":"m 124 0 l 124 992 l 335 992 l 335 173 l 737 173 l 737 0 l 124 0 m 287 -288 q 310 -191 297 -255 q 329 -85 324 -128 l 520 -85 l 520 -98 q 408 -307 470 -212 l 287 -307 l 287 -288 "},"Õ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 441 1142 q 401 1123 420 1142 q 373 1069 382 1105 l 272 1069 q 328 1223 279 1167 q 456 1279 376 1279 q 511 1267 484 1279 q 564 1243 538 1256 q 615 1218 590 1229 q 665 1207 640 1207 q 705 1225 686 1207 q 733 1280 724 1243 l 834 1280 q 778 1125 827 1181 q 650 1070 728 1070 q 595 1081 622 1070 q 542 1106 568 1092 q 491 1130 516 1119 q 441 1142 466 1142 "},"ć":{"x_min":62.390625,"x_max":691.484375,"ha":714,"o":"m 416 -14 q 62 375 62 -14 q 158 670 62 568 q 434 773 254 773 q 670 721 566 773 l 609 561 q 518 593 560 581 q 434 606 476 606 q 273 376 273 606 q 434 153 273 153 q 545 169 494 153 q 646 219 596 185 l 646 42 q 545 -1 596 10 q 416 -14 494 -14 m 300 842 l 300 860 q 459 1064 416 995 l 691 1064 l 691 1049 q 571 945 656 1014 q 437 842 485 875 l 300 842 "},"þ":{"x_min":108.515625,"x_max":816.59375,"ha":879,"o":"m 315 660 q 404 744 349 715 q 530 773 459 773 q 740 668 664 773 q 816 380 816 563 q 740 90 816 195 q 530 -14 665 -14 q 315 79 385 -14 l 305 79 l 310 36 l 315 -26 l 315 -334 l 108 -334 l 108 1055 l 315 1055 l 315 790 l 310 709 l 305 660 l 315 660 m 463 607 q 352 560 387 607 q 315 404 316 513 l 315 381 q 351 206 315 259 q 466 153 387 153 q 605 383 605 153 q 571 551 605 495 q 463 607 537 607 "},"]":{"x_min":34.59375,"x_max":362.984375,"ha":460,"o":"m 34 -76 l 185 -76 l 185 848 l 34 848 l 34 992 l 362 992 l 362 -220 l 34 -220 l 34 -76 "},"′":{"x_min":90.203125,"x_max":279.421875,"ha":370,"o":"m 279 992 l 251 634 l 118 634 l 90 992 l 279 992 "},"ẁ":{"x_min":13.5625,"x_max":1175.4375,"ha":1189,"o":"m 731 0 l 673 265 l 594 600 l 590 600 l 451 0 l 229 0 l 13 758 l 219 758 l 307 422 q 349 173 328 332 l 354 173 q 377 336 356 225 l 388 394 l 482 758 l 710 758 l 799 394 q 807 350 801 379 q 818 288 813 321 q 828 224 824 255 q 833 173 832 192 l 837 173 q 859 307 843 222 q 881 422 874 392 l 972 758 l 1175 758 l 957 0 l 731 0 m 571 842 q 446 938 528 871 q 317 1049 363 1005 l 317 1064 l 549 1064 q 708 860 591 995 l 708 842 l 571 842 "},"ệ":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 568 842 q 410 960 462 904 q 254 842 357 906 l 117 842 l 117 860 q 290 1064 245 988 l 532 1064 q 605 968 553 1028 q 706 860 657 907 l 706 842 l 568 842 m 296 -189 q 409 -88 296 -88 q 521 -189 521 -88 q 493 -264 521 -237 q 409 -290 464 -290 q 296 -189 296 -290 "},"ĭ":{"x_min":-55.046875,"x_max":478.71875,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 478 1071 q 395 904 470 966 q 208 842 321 842 q 20 903 90 842 q -55 1071 -49 965 l 60 1071 q 78 1020 62 1039 q 123 994 94 1002 q 210 986 152 986 q 360 1071 349 986 l 478 1071 "},"8":{"x_min":48.84375,"x_max":744.84375,"ha":793,"o":"m 397 1004 q 627 939 539 1004 q 714 764 714 874 q 672 629 714 688 q 536 523 630 569 q 696 398 647 463 q 744 256 744 333 q 649 60 744 134 q 397 -14 553 -14 q 141 55 234 -14 q 48 251 48 124 q 93 401 48 335 q 238 517 139 467 q 116 632 153 571 q 79 765 79 693 q 167 938 79 872 q 397 1004 255 1004 m 242 263 q 283 172 242 205 q 394 139 324 139 q 511 173 472 139 q 550 262 550 207 q 511 347 550 307 q 387 431 473 386 q 242 263 242 365 m 396 850 q 309 823 342 850 q 276 749 276 795 q 302 676 276 708 q 397 610 328 644 q 490 674 464 641 q 516 749 516 706 q 483 823 516 796 q 396 850 449 850 "},"Ữ":{"x_min":118.015625,"x_max":1243.296875,"ha":1229,"o":"m 931 992 l 931 864 q 1005 932 982 881 q 1029 1056 1029 983 l 1233 1056 l 1243 1041 q 1185 879 1221 936 q 1087 787 1149 822 q 931 739 1025 752 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 368 q 375 212 327 262 q 526 162 423 162 q 675 214 629 162 q 722 369 722 266 l 722 992 l 931 992 m 1050 0 l 1050 0 m 413 1142 q 373 1123 392 1142 q 345 1069 354 1105 l 244 1069 q 300 1223 251 1167 q 428 1279 348 1279 q 483 1267 456 1279 q 536 1243 510 1256 q 587 1218 562 1229 q 637 1207 612 1207 q 677 1225 658 1207 q 705 1280 696 1243 l 806 1280 q 750 1125 799 1181 q 622 1070 700 1070 q 567 1081 594 1070 q 514 1106 540 1092 q 463 1130 488 1119 q 413 1142 438 1142 "},"R":{"x_min":124.796875,"x_max":917,"ha":917,"o":"m 335 552 l 402 552 q 550 585 502 552 q 597 689 597 618 q 549 789 597 760 q 398 819 500 819 l 335 819 l 335 552 m 335 381 l 335 0 l 124 0 l 124 992 l 413 992 q 712 918 615 992 q 809 695 809 844 q 761 539 809 607 q 625 432 713 471 q 917 0 849 97 l 683 0 l 446 381 l 335 381 "},"ť":{"x_min":31.890625,"x_max":653.859375,"ha":603,"o":"m 427 150 q 558 174 482 150 l 558 20 q 368 -14 480 -14 q 187 48 244 -14 q 130 237 130 111 l 130 602 l 31 602 l 31 690 l 145 759 l 205 919 l 337 919 l 337 758 l 550 758 l 550 602 l 337 602 l 337 236 q 362 171 337 192 q 427 150 387 150 m 420 864 q 443 961 430 898 q 462 1069 457 1025 l 653 1069 l 653 1055 q 541 847 599 936 l 420 847 l 420 864 "},"Ľ":{"x_min":124.796875,"x_max":737.53125,"ha":785,"o":"m 124 0 l 124 992 l 335 992 l 335 173 l 737 173 l 737 0 l 124 0 m 490 787 q 513 884 500 821 q 532 992 527 948 l 723 992 l 723 978 q 611 770 669 859 l 490 770 l 490 787 "},"Ż":{"x_min":33.21875,"x_max":770.78125,"ha":804,"o":"m 770 0 l 33 0 l 33 136 l 508 818 l 46 818 l 46 992 l 757 992 l 757 856 l 283 173 l 770 173 l 770 0 m 288 1183 q 401 1284 288 1284 q 513 1183 513 1284 q 485 1108 513 1135 q 401 1082 457 1082 q 288 1183 288 1082 "},"o":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 "},"5":{"x_min":67.828125,"x_max":730.59375,"ha":793,"o":"m 416 634 q 645 553 560 634 q 730 331 730 472 q 628 75 730 165 q 335 -14 525 -14 q 67 39 169 -14 l 67 220 q 192 174 121 192 q 327 156 263 156 q 519 314 519 156 q 320 464 519 464 q 241 457 284 464 q 170 441 198 450 l 87 486 l 124 992 l 662 992 l 662 814 l 308 814 l 290 619 l 314 624 q 416 634 355 634 "},"ħ":{"x_min":2.71875,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 401 q 479 565 601 565 q 354 505 393 565 q 315 315 315 446 l 315 0 l 108 0 l 108 811 l 2 811 l 2 946 l 108 946 l 108 1055 l 315 1055 l 315 946 l 529 946 l 529 811 l 315 811 l 315 798 q 305 618 315 742 l 318 618 q 537 730 387 730 q 740 658 671 730 q 808 452 808 587 l 808 0 "},"õ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 317 913 q 277 894 296 913 q 249 840 258 876 l 148 840 q 204 994 155 938 q 332 1050 252 1050 q 387 1038 360 1050 q 440 1014 414 1027 q 491 989 466 1000 q 541 978 516 978 q 581 996 562 978 q 609 1051 600 1014 l 710 1051 q 654 896 703 952 q 526 841 604 841 q 471 852 498 841 q 418 877 444 863 q 367 901 392 890 q 317 913 342 913 "},"ẫ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 518 1063 q 468 1071 493 1063 q 418 1090 442 1080 q 371 1109 393 1100 q 329 1118 348 1118 q 287 1106 302 1118 q 264 1062 273 1095 l 187 1062 q 230 1181 193 1137 q 322 1226 266 1226 q 373 1217 347 1226 q 424 1197 400 1208 q 471 1178 448 1187 q 511 1169 493 1169 q 552 1181 539 1169 q 576 1227 566 1194 l 653 1227 q 608 1105 644 1148 q 518 1063 572 1063 m 672 842 l 576 842 q 419 945 480 890 q 262 842 363 895 l 166 842 l 166 860 q 326 1037 282 971 l 512 1037 q 588 945 545 990 q 672 860 632 900 l 672 842 "},",":{"x_min":42.734375,"x_max":311.296875,"ha":403,"o":"m 311 145 q 191 -179 276 8 l 42 -179 q 111 161 86 1 l 301 161 l 311 145 "},"d":{"x_min":62.390625,"x_max":771.15625,"ha":879,"o":"m 348 -14 q 138 89 215 -14 q 62 377 62 193 q 140 668 62 564 q 354 773 217 773 q 572 661 497 773 l 579 661 q 563 812 563 746 l 563 1055 l 771 1055 l 771 0 l 612 0 l 572 98 l 563 98 q 348 -14 493 -14 m 421 150 q 537 197 500 150 q 577 354 574 243 l 577 376 q 540 551 577 498 q 417 604 502 604 q 310 546 348 604 q 271 375 271 487 q 310 206 271 262 q 421 150 349 150 "},"\"":{"x_min":90.203125,"x_max":565.4375,"ha":656,"o":"m 279 992 l 251 634 l 118 634 l 90 992 l 279 992 m 565 992 l 537 634 l 404 634 l 376 992 l 565 992 "},"˙":{"x_min":99.71875,"x_max":324.890625,"ha":424,"o":"m 99 954 q 212 1055 99 1055 q 324 954 324 1055 q 296 879 324 906 q 212 853 268 853 q 99 954 99 853 "},"ê":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 582 842 q 424 960 476 904 q 268 842 371 906 l 131 842 l 131 860 q 304 1064 259 988 l 546 1064 q 619 968 567 1028 q 720 860 671 907 l 720 842 l 582 842 "},"″":{"x_min":90.203125,"x_max":565.4375,"ha":656,"o":"m 279 992 l 251 634 l 118 634 l 90 992 l 279 992 m 565 992 l 537 634 l 404 634 l 376 992 l 565 992 "},"„":{"x_min":42.734375,"x_max":628.3125,"ha":720,"o":"m 311 145 q 191 -179 276 8 l 42 -179 q 111 161 86 1 l 301 161 l 311 145 m 628 145 q 508 -179 593 8 l 359 -179 q 428 161 403 1 l 618 161 l 628 145 "},"ľ":{"x_min":108.515625,"x_max":610.859375,"ha":424,"o":"m 315 0 l 108 0 l 108 1055 l 315 1055 l 315 0 m 377 850 q 400 947 387 884 q 419 1055 414 1011 l 610 1055 l 610 1041 q 498 833 556 922 l 377 833 l 377 850 "},"Â":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 635 1071 q 477 1189 529 1133 q 321 1071 424 1135 l 184 1071 l 184 1089 q 357 1293 312 1217 l 599 1293 q 672 1197 620 1257 q 773 1089 724 1136 l 773 1071 l 635 1071 "},"Į":{"x_min":74.78125,"x_max":349.9375,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 217 -154 q 233 -196 217 -182 q 272 -209 248 -209 q 349 -197 309 -209 l 349 -318 q 244 -334 294 -334 q 121 -290 167 -334 q 74 -177 74 -247 q 100 -92 74 -132 q 196 0 126 -52 l 318 0 q 244 -81 270 -44 q 217 -154 217 -118 "},"ė":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 315 954 q 428 1055 315 1055 q 540 954 540 1055 q 512 879 540 906 q 428 853 484 853 q 315 954 315 853 "},"ề":{"x_min":-21.984375,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 175 860 q 321 1050 251 948 l 535 1050 q 611 945 568 1001 q 681 860 654 890 l 681 842 l 571 842 q 428 954 505 886 q 285 842 356 889 l 175 842 l 175 860 m 235 974 l 132 974 q -21 1113 21 1054 l -21 1128 l 142 1128 q 235 991 178 1052 l 235 974 "},"Ţ":{"x_min":27.671875,"x_max":776.421875,"ha":804,"o":"m 507 0 l 296 0 l 296 817 l 27 817 l 27 992 l 776 992 l 776 817 l 507 817 l 507 0 m 562 -170 q 511 -295 562 -256 q 352 -334 460 -334 q 253 -319 300 -334 l 253 -205 q 303 -215 272 -210 q 350 -220 334 -220 q 399 -177 399 -220 q 287 -104 399 -121 l 340 0 l 471 0 l 452 -42 q 532 -92 502 -58 q 562 -170 562 -126 "},"Í":{"x_min":113.15625,"x_max":504.484375,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 113 1071 l 113 1089 q 272 1293 229 1224 l 504 1293 l 504 1278 q 384 1174 469 1243 q 250 1071 298 1104 l 113 1071 "},"´":{"x_min":225.15625,"x_max":616.484375,"ha":843,"o":"m 225 842 l 225 860 q 384 1064 341 995 l 616 1064 l 616 1049 q 496 945 581 1014 q 362 842 410 875 l 225 842 "},"Ơ":{"x_min":80.703125,"x_max":1188.078125,"ha":1146,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 875 80 744 q 555 1007 326 1007 q 911 869 790 1007 q 974 1055 974 910 l 1178 1055 l 1188 1040 q 1115 851 1163 920 q 983 749 1067 783 q 1025 496 1025 642 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 1106 0 l 1106 0 "},"Ú":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 408 1071 l 408 1089 q 567 1293 524 1224 l 799 1293 l 799 1278 q 679 1174 764 1243 q 545 1071 593 1104 l 408 1071 "}," ":{"x_min":0,"x_max":0,"ha":278},"Ŷ":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 591 1071 q 433 1189 485 1133 q 277 1071 380 1135 l 140 1071 l 140 1089 q 313 1293 268 1217 l 555 1293 q 628 1197 576 1257 q 729 1089 680 1136 l 729 1071 l 591 1071 "},"ỏ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 604 1008 q 494 875 604 902 l 487 827 l 369 827 l 354 926 q 423 951 404 934 q 441 994 441 969 q 427 1027 441 1016 q 389 1039 413 1039 q 295 1023 345 1039 l 295 1137 q 351 1148 316 1144 q 415 1153 387 1153 q 557 1115 510 1153 q 604 1008 604 1077 "},"Ự":{"x_min":118.015625,"x_max":1243.296875,"ha":1229,"o":"m 931 992 l 931 864 q 1005 932 982 881 q 1029 1056 1029 983 l 1233 1056 l 1243 1041 q 1185 879 1221 936 q 1087 787 1149 822 q 931 739 1025 752 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 368 q 375 212 327 262 q 526 162 423 162 q 675 214 629 162 q 722 369 722 266 l 722 992 l 931 992 m 1050 0 l 1050 0 m 405 -190 q 518 -89 405 -89 q 630 -190 630 -89 q 602 -265 630 -238 q 518 -291 573 -291 q 405 -190 405 -291 "},"ŝ":{"x_min":62.390625,"x_max":652.515625,"ha":690,"o":"m 637 224 q 556 47 637 108 q 313 -14 475 -14 q 172 -2 231 -14 q 63 30 114 8 l 63 201 q 193 155 121 173 q 320 137 265 137 q 432 202 432 137 q 418 242 432 226 q 366 276 403 257 q 269 322 329 296 q 140 390 181 358 q 81 461 99 421 q 62 561 62 502 q 140 717 62 662 q 362 773 218 773 q 628 713 499 773 l 566 564 q 460 604 509 588 q 359 619 410 619 q 267 570 267 619 q 297 521 267 542 q 426 461 326 501 q 556 394 515 425 q 617 322 597 362 q 637 224 637 281 m 514 842 q 356 960 408 904 q 200 842 303 906 l 63 842 l 63 860 q 236 1064 191 988 l 478 1064 q 551 968 499 1028 q 652 860 603 907 l 652 842 l 514 842 "},"Ý":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 312 1071 l 312 1089 q 471 1293 428 1224 l 703 1293 l 703 1278 q 583 1174 668 1243 q 449 1071 497 1104 l 312 1071 "},"Ĉ":{"x_min":80.703125,"x_max":836.171875,"ha":885,"o":"m 545 831 q 362 741 427 831 q 297 492 297 652 q 545 160 297 160 q 798 213 650 160 l 798 36 q 526 -14 676 -14 q 195 117 309 -14 q 80 494 80 248 q 136 765 80 649 q 298 943 193 881 q 545 1006 404 1006 q 836 936 690 1006 l 768 765 q 656 811 712 791 q 545 831 600 831 m 692 1071 q 534 1189 586 1133 q 378 1071 481 1135 l 241 1071 l 241 1089 q 414 1293 369 1217 l 656 1293 q 729 1197 677 1257 q 830 1089 781 1136 l 830 1071 l 692 1071 "}," ":{"x_min":0,"x_max":0,"ha":1389},"ą":{"x_min":58.328125,"x_max":745.9375,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 613 -154 q 629 -196 613 -182 q 668 -209 644 -209 q 745 -197 705 -209 l 745 -318 q 640 -334 690 -334 q 517 -290 563 -334 q 470 -177 470 -247 q 496 -92 470 -132 q 592 0 522 -52 l 714 0 q 640 -81 666 -44 q 613 -154 613 -118 "},"Ờ":{"x_min":80.703125,"x_max":1188.078125,"ha":1146,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 875 80 744 q 555 1007 326 1007 q 911 869 790 1007 q 974 1055 974 910 l 1178 1055 l 1188 1040 q 1115 851 1163 920 q 983 749 1067 783 q 1025 496 1025 642 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 1106 0 l 1106 0 m 547 1071 q 422 1167 504 1100 q 293 1278 339 1234 l 293 1293 l 525 1293 q 684 1089 567 1224 l 684 1071 l 547 1071 "},"​":{"x_min":0,"x_max":0,"ha":0},"Ö":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 321 1182 q 346 1250 321 1226 q 415 1273 372 1273 q 485 1248 460 1273 q 511 1182 511 1223 q 485 1116 511 1141 q 415 1092 459 1092 q 346 1115 372 1092 q 321 1182 321 1139 m 594 1182 q 621 1251 594 1229 q 689 1273 649 1273 q 760 1249 733 1273 q 786 1182 786 1224 q 759 1116 786 1140 q 689 1092 733 1092 q 621 1114 649 1092 q 594 1182 594 1136 "},"z":{"x_min":37.296875,"x_max":636.625,"ha":678,"o":"m 636 0 l 37 0 l 37 122 l 389 599 l 58 599 l 58 758 l 624 758 l 624 623 l 282 158 l 636 158 l 636 0 "},"ặ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 283 -190 q 396 -89 283 -89 q 508 -190 508 -89 q 480 -265 508 -238 q 396 -291 451 -291 q 283 -190 283 -291 m 684 1071 q 601 904 676 966 q 414 842 527 842 q 226 903 296 842 q 150 1071 156 965 l 266 1071 q 284 1020 268 1039 q 329 994 300 1002 q 416 986 358 986 q 566 1071 555 986 l 684 1071 "},"Ř":{"x_min":124.796875,"x_max":917,"ha":917,"o":"m 335 552 l 402 552 q 550 585 502 552 q 597 689 597 618 q 549 789 597 760 q 398 819 500 819 l 335 819 l 335 552 m 335 381 l 335 0 l 124 0 l 124 992 l 413 992 q 712 918 615 992 q 809 695 809 844 q 761 539 809 607 q 625 432 713 471 q 917 0 849 97 l 683 0 l 446 381 l 335 381 m 750 1293 l 750 1274 q 645 1161 693 1217 q 576 1071 597 1104 l 334 1071 q 278 1147 315 1102 q 161 1274 241 1191 l 161 1293 l 298 1293 q 454 1174 398 1230 q 612 1293 511 1232 l 750 1293 "},"Ắ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 412 1265 q 491 1402 459 1336 l 641 1402 l 641 1387 q 501 1247 579 1313 l 412 1247 l 412 1265 m 726 1300 q 652 1131 718 1192 q 478 1071 586 1071 q 303 1129 366 1071 q 234 1300 240 1187 l 336 1300 q 380 1213 341 1241 q 479 1184 419 1184 q 577 1216 539 1184 q 622 1300 616 1248 l 726 1300 "},"ã":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 316 913 q 276 894 295 913 q 248 840 257 876 l 147 840 q 203 994 154 938 q 331 1050 251 1050 q 386 1038 359 1050 q 439 1014 413 1027 q 490 989 465 1000 q 540 978 515 978 q 580 996 561 978 q 608 1051 599 1014 l 709 1051 q 653 896 702 952 q 525 841 603 841 q 470 852 497 841 q 417 877 443 863 q 366 901 391 890 q 316 913 341 913 "},"Ň":{"x_min":124.796875,"x_max":1004.21875,"ha":1129,"o":"m 1004 0 l 737 0 l 305 750 l 299 750 q 312 466 312 551 l 312 0 l 124 0 l 124 992 l 389 992 l 820 249 l 825 249 q 814 522 814 442 l 814 992 l 1004 992 l 1004 0 m 876 1293 l 876 1274 q 771 1161 819 1217 q 702 1071 723 1104 l 460 1071 q 404 1147 441 1102 q 287 1274 367 1191 l 287 1293 l 424 1293 q 580 1174 524 1230 q 738 1293 637 1232 l 876 1293 "},"æ":{"x_min":58.328125,"x_max":1214.3125,"ha":1274,"o":"m 901 -14 q 732 20 808 -14 q 607 125 656 54 q 473 16 540 46 q 299 -14 407 -14 q 124 50 190 -14 q 58 226 58 114 q 140 404 58 347 q 386 467 222 461 l 515 472 l 515 529 q 485 598 515 575 q 402 620 455 620 q 196 568 308 620 l 128 705 q 415 774 257 774 q 647 685 569 774 q 750 750 691 728 q 890 773 809 773 q 1127 679 1040 773 q 1214 427 1214 586 l 1214 327 l 723 327 q 776 189 727 239 q 913 139 824 139 q 1170 199 1046 139 l 1170 39 q 1054 0 1117 13 q 901 -14 992 -14 m 515 351 l 438 348 q 312 316 354 345 q 270 224 270 286 q 365 137 270 137 q 474 178 434 137 q 515 288 515 220 l 515 351 m 886 625 q 727 465 739 625 l 1019 465 q 982 583 1018 541 q 886 625 946 625 "},"ừ":{"x_min":104.453125,"x_max":1119.875,"ha":1055,"o":"m 645 0 l 617 96 l 605 96 q 512 15 573 44 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 679 q 879 743 852 693 q 905 872 905 793 l 1109 872 l 1119 857 q 1061 694 1098 751 q 962 602 1024 637 q 804 554 900 568 l 804 0 l 645 0 m 913 0 l 913 0 m 416 842 q 291 938 373 871 q 162 1049 208 1005 l 162 1064 l 394 1064 q 553 860 436 995 l 553 842 l 416 842 "},"Ợ":{"x_min":80.703125,"x_max":1188.078125,"ha":1146,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 875 80 744 q 555 1007 326 1007 q 911 869 790 1007 q 974 1055 974 910 l 1178 1055 l 1188 1040 q 1115 851 1163 920 q 983 749 1067 783 q 1025 496 1025 642 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 1106 0 l 1106 0 m 441 -190 q 554 -89 441 -89 q 666 -190 666 -89 q 638 -265 666 -238 q 554 -291 609 -291 q 441 -190 441 -291 "},"ĩ":{"x_min":-68.625,"x_max":493.640625,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 100 913 q 60 894 79 913 q 32 840 41 876 l -68 840 q -12 994 -61 938 q 115 1050 35 1050 q 170 1038 143 1050 q 223 1014 197 1027 q 274 989 249 1000 q 324 978 299 978 q 364 996 345 978 q 392 1051 383 1014 l 493 1051 q 437 896 486 952 q 309 841 387 841 q 254 852 281 841 q 201 877 227 863 q 150 901 175 890 q 100 913 125 913 "},"É":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 287 1071 l 287 1089 q 446 1293 403 1224 l 678 1293 l 678 1278 q 558 1174 643 1243 q 424 1071 472 1104 l 287 1071 "},"ŀ":{"x_min":108.515625,"x_max":622.890625,"ha":595,"o":"m 315 0 l 108 0 l 108 1055 l 315 1055 l 315 0 m 397 471 q 510 572 397 572 q 622 471 622 572 q 594 396 622 423 q 510 370 566 370 q 397 471 397 370 "},"~":{"x_min":59.6875,"x_max":733.3125,"ha":793,"o":"m 218 455 q 138 432 181 455 q 59 372 96 409 l 59 529 q 233 604 129 604 q 326 593 282 604 q 421 560 370 582 q 575 522 508 522 q 653 544 611 522 q 733 605 696 566 l 733 448 q 559 374 664 374 q 474 382 514 374 q 372 417 433 391 q 218 455 283 455 "},"Ċ":{"x_min":80.703125,"x_max":836.171875,"ha":885,"o":"m 545 831 q 362 741 427 831 q 297 492 297 652 q 545 160 297 160 q 798 213 650 160 l 798 36 q 526 -14 676 -14 q 195 117 309 -14 q 80 494 80 248 q 136 765 80 649 q 298 943 193 881 q 545 1006 404 1006 q 836 936 690 1006 l 768 765 q 656 811 712 791 q 545 831 600 831 m 420 1183 q 533 1284 420 1284 q 645 1183 645 1284 q 617 1108 645 1135 q 533 1082 589 1082 q 420 1183 420 1082 "},"³":{"x_min":40,"x_max":470.421875,"ha":526,"o":"m 451 846 q 336 712 451 749 l 336 703 q 435 652 399 690 q 470 562 470 615 q 410 433 470 480 q 225 386 351 386 q 40 433 128 386 l 40 562 q 223 501 140 501 q 320 573 320 501 q 290 627 320 609 q 208 645 260 645 l 132 645 l 132 754 l 194 754 q 278 771 250 754 q 305 827 305 789 q 288 870 305 853 q 237 887 271 887 q 176 874 205 887 q 109 834 148 861 l 41 930 q 134 982 83 961 q 255 1004 185 1004 q 396 960 341 1004 q 451 846 451 917 "},"¡":{"x_min":79,"x_max":316.375,"ha":397,"o":"m 113 410 l 279 410 l 313 -250 l 79 -250 l 113 410 m 316 642 q 285 556 316 585 q 197 527 255 527 q 109 557 140 527 q 79 642 79 587 q 110 727 79 697 q 197 758 142 758 q 285 728 253 758 q 316 642 316 698 "},"ẅ":{"x_min":13.5625,"x_max":1175.4375,"ha":1189,"o":"m 731 0 l 673 265 l 594 600 l 590 600 l 451 0 l 229 0 l 13 758 l 219 758 l 307 422 q 349 173 328 332 l 354 173 q 377 336 356 225 l 388 394 l 482 758 l 710 758 l 799 394 q 807 350 801 379 q 818 288 813 321 q 828 224 824 255 q 833 173 832 192 l 837 173 q 859 307 843 222 q 881 422 874 392 l 972 758 l 1175 758 l 957 0 l 731 0 m 361 953 q 386 1021 361 997 q 455 1044 412 1044 q 525 1019 500 1044 q 551 953 551 994 q 525 887 551 912 q 455 863 499 863 q 386 886 412 863 q 361 953 361 910 m 634 953 q 661 1022 634 1000 q 729 1044 689 1044 q 800 1020 773 1044 q 826 953 826 995 q 799 887 826 911 q 729 863 773 863 q 661 885 689 863 q 634 953 634 907 "},"ậ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 574 841 q 416 959 468 903 q 260 841 363 905 l 123 841 l 123 859 q 296 1063 251 987 l 538 1063 q 611 967 559 1027 q 712 859 663 906 l 712 841 l 574 841 m 290 -190 q 403 -89 290 -89 q 515 -190 515 -89 q 487 -265 515 -238 q 403 -291 458 -291 q 290 -190 290 -291 "},"[":{"x_min":97.03125,"x_max":425.421875,"ha":460,"o":"m 425 -220 l 97 -220 l 97 992 l 425 992 l 425 848 l 273 848 l 273 -76 l 425 -76 l 425 -220 "},"Ử":{"x_min":118.015625,"x_max":1243.296875,"ha":1229,"o":"m 931 992 l 931 864 q 1005 932 982 881 q 1029 1056 1029 983 l 1233 1056 l 1243 1041 q 1185 879 1221 936 q 1087 787 1149 822 q 931 739 1025 752 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 368 q 375 212 327 262 q 526 162 423 162 q 675 214 629 162 q 722 369 722 266 l 722 992 l 931 992 m 1050 0 l 1050 0 m 697 1237 q 587 1104 697 1131 l 580 1056 l 462 1056 l 447 1155 q 516 1180 497 1163 q 534 1223 534 1198 q 520 1256 534 1245 q 482 1268 506 1268 q 388 1252 438 1268 l 388 1366 q 444 1377 409 1373 q 508 1382 480 1382 q 650 1344 603 1382 q 697 1237 697 1306 "},"%":{"x_min":42.71875,"x_max":1208.28125,"ha":1251,"o":"m 213 694 q 228 565 213 608 q 278 523 244 523 q 343 694 343 523 q 278 864 343 864 q 228 822 244 864 q 213 694 213 780 m 514 695 q 453 461 514 539 q 276 383 393 383 q 103 463 164 383 q 42 695 42 543 q 276 1006 42 1006 q 452 925 391 1006 q 514 695 514 845 m 980 992 l 430 0 l 267 0 l 817 992 l 980 992 m 907 298 q 923 170 907 212 q 972 127 938 127 q 1037 298 1037 127 q 972 468 1037 468 q 923 426 938 468 q 907 298 907 384 m 1208 300 q 1147 66 1208 144 q 970 -12 1087 -12 q 797 68 859 -12 q 736 300 736 148 q 970 610 736 610 q 1146 529 1085 610 q 1208 300 1208 449 "},"P":{"x_min":124.796875,"x_max":809.609375,"ha":872,"o":"m 335 525 l 404 525 q 549 563 501 525 q 597 675 597 601 q 557 784 597 749 q 430 819 516 819 l 335 819 l 335 525 m 809 682 q 709 437 809 522 q 425 353 609 353 l 335 353 l 335 0 l 124 0 l 124 992 l 441 992 q 715 914 621 992 q 809 682 809 836 "},"_":{"x_min":-2.71875,"x_max":573.71875,"ha":571,"o":"m 573 -220 l -2 -220 l -2 -125 l 573 -125 l 573 -220 "},"Ŕ":{"x_min":124.796875,"x_max":917,"ha":917,"o":"m 335 552 l 402 552 q 550 585 502 552 q 597 689 597 618 q 549 789 597 760 q 398 819 500 819 l 335 819 l 335 552 m 335 381 l 335 0 l 124 0 l 124 992 l 413 992 q 712 918 615 992 q 809 695 809 844 q 761 539 809 607 q 625 432 713 471 q 917 0 849 97 l 683 0 l 446 381 l 335 381 m 323 1071 l 323 1089 q 482 1293 439 1224 l 714 1293 l 714 1278 q 594 1174 679 1243 q 460 1071 508 1104 l 323 1071 "},"ñ":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 572 566 601 525 q 479 607 543 607 q 354 549 392 607 q 315 357 315 491 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 401 744 340 716 q 539 773 461 773 q 740 701 671 773 q 808 494 808 629 l 808 0 m 344 913 q 304 894 323 913 q 276 840 285 876 l 175 840 q 231 994 182 938 q 359 1050 279 1050 q 414 1038 387 1050 q 467 1014 441 1027 q 518 989 493 1000 q 568 978 543 978 q 608 996 589 978 q 636 1051 627 1014 l 737 1051 q 681 896 730 952 q 553 841 631 841 q 498 852 525 841 q 445 877 471 863 q 394 901 419 890 q 344 913 369 913 "},"‚":{"x_min":42.734375,"x_max":311.296875,"ha":404,"o":"m 311 145 q 191 -179 276 8 l 42 -179 q 111 161 86 1 l 301 161 l 311 145 "},"Æ":{"x_min":0,"x_max":1240.9375,"ha":1323,"o":"m 1240 0 l 648 0 l 648 236 l 315 236 l 213 0 l 0 0 l 444 992 l 1240 992 l 1240 819 l 858 819 l 858 602 l 1215 602 l 1215 429 l 858 429 l 858 173 l 1240 173 l 1240 0 m 392 413 l 648 413 l 648 812 l 562 812 l 392 413 "},"ğ":{"x_min":4.0625,"x_max":768.71875,"ha":785,"o":"m 768 759 l 768 653 l 650 623 q 682 508 682 572 q 597 318 682 386 q 360 250 512 250 l 323 252 l 293 255 q 261 201 261 230 q 375 156 261 156 l 504 156 q 694 102 628 156 q 759 -54 759 49 q 648 -260 759 -187 q 330 -334 538 -334 q 87 -278 171 -334 q 4 -123 4 -223 q 46 -9 4 -55 q 172 56 89 36 q 116 100 140 70 q 92 166 92 131 q 118 238 92 209 q 190 295 143 267 q 95 378 130 321 q 61 512 61 435 q 141 705 61 637 q 372 773 222 773 q 448 767 404 773 q 504 759 491 761 l 768 759 m 183 -107 q 224 -174 183 -150 q 339 -199 265 -199 q 513 -168 450 -199 q 576 -85 576 -138 q 539 -26 576 -42 q 424 -10 502 -10 l 316 -10 q 221 -36 259 -10 q 183 -107 183 -63 m 258 510 q 286 412 258 448 q 372 376 314 376 q 458 412 430 376 q 485 510 485 448 q 372 647 485 647 q 258 510 258 647 m 667 1071 q 584 904 659 966 q 397 842 510 842 q 209 903 279 842 q 133 1071 139 965 l 249 1071 q 267 1020 251 1039 q 312 994 283 1002 q 399 986 341 986 q 549 1071 538 986 l 667 1071 "},"Ở":{"x_min":80.703125,"x_max":1188.078125,"ha":1146,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 875 80 744 q 555 1007 326 1007 q 911 869 790 1007 q 974 1055 974 910 l 1178 1055 l 1188 1040 q 1115 851 1163 920 q 983 749 1067 783 q 1025 496 1025 642 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 1106 0 l 1106 0 m 742 1237 q 632 1104 742 1131 l 625 1056 l 507 1056 l 492 1155 q 561 1180 542 1163 q 579 1223 579 1198 q 565 1256 579 1245 q 527 1268 551 1268 q 433 1252 483 1268 l 433 1366 q 489 1377 454 1373 q 553 1382 525 1382 q 695 1344 648 1382 q 742 1237 742 1306 "},"Ū":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 295 1214 l 755 1214 l 755 1071 l 295 1071 l 295 1214 "},"ª":{"x_min":31.890625,"x_max":472.21875,"ha":532,"o":"m 380 518 l 359 592 q 288 531 330 553 q 196 510 246 510 q 74 549 116 510 q 31 661 31 589 q 87 772 31 735 q 269 815 143 809 l 336 817 q 250 897 336 897 q 103 855 195 897 l 58 947 q 157 986 103 969 q 278 1003 211 1003 q 421 954 371 1003 q 472 817 472 906 l 472 518 l 380 518 m 170 662 q 186 624 170 636 q 223 612 202 612 q 306 640 276 612 q 336 712 336 668 l 336 737 l 269 733 q 170 662 170 726 "},"Œ":{"x_min":80.703125,"x_max":1269.9375,"ha":1352,"o":"m 1269 0 l 677 0 q 603 -10 651 -6 q 525 -14 555 -14 q 194 119 308 -14 q 80 498 80 253 q 195 875 80 744 q 526 1007 310 1007 q 612 1002 567 1007 q 681 992 657 997 l 1269 992 l 1269 819 l 887 819 l 887 602 l 1244 602 l 1244 429 l 887 429 l 887 173 l 1269 173 l 1269 0 m 526 832 q 355 746 413 832 q 297 496 297 661 q 355 246 297 331 q 525 162 413 162 q 610 169 569 162 q 677 188 651 176 l 677 804 q 608 824 653 817 q 526 832 563 832 "},"Ạ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 366 -190 q 479 -89 366 -89 q 591 -190 591 -89 q 563 -265 591 -238 q 479 -291 534 -291 q 366 -190 366 -291 "},"Ą":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 753 -154 q 769 -196 753 -182 q 808 -209 784 -209 q 885 -197 845 -209 l 885 -318 q 780 -334 830 -334 q 657 -290 703 -334 q 610 -177 610 -247 q 636 -92 610 -132 q 732 0 662 -52 l 854 0 q 780 -81 806 -44 q 753 -154 753 -118 "},"T":{"x_min":27.671875,"x_max":776.421875,"ha":804,"o":"m 507 0 l 296 0 l 296 817 l 27 817 l 27 992 l 776 992 l 776 817 l 507 817 l 507 0 "},"š":{"x_min":62.390625,"x_max":659.515625,"ha":690,"o":"m 637 224 q 556 47 637 108 q 313 -14 475 -14 q 172 -2 231 -14 q 63 30 114 8 l 63 201 q 193 155 121 173 q 320 137 265 137 q 432 202 432 137 q 418 242 432 226 q 366 276 403 257 q 269 322 329 296 q 140 390 181 358 q 81 461 99 421 q 62 561 62 502 q 140 717 62 662 q 362 773 218 773 q 628 713 499 773 l 566 564 q 460 604 509 588 q 359 619 410 619 q 267 570 267 619 q 297 521 267 542 q 426 461 326 501 q 556 394 515 425 q 617 322 597 362 q 637 224 637 281 m 659 1064 l 659 1045 q 554 932 602 988 q 485 842 506 875 l 243 842 q 187 918 224 873 q 70 1045 150 962 l 70 1064 l 207 1064 q 363 945 307 1001 q 521 1064 420 1003 l 659 1064 "},"ỷ":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 565 1008 q 455 875 565 902 l 448 827 l 330 827 l 315 926 q 384 951 365 934 q 402 994 402 969 q 388 1027 402 1016 q 350 1039 374 1039 q 256 1023 306 1039 l 256 1137 q 312 1148 277 1144 q 376 1153 348 1153 q 518 1115 471 1153 q 565 1008 565 1077 "},"Þ":{"x_min":124.796875,"x_max":809.609375,"ha":872,"o":"m 809 522 q 713 283 809 367 q 438 199 616 199 l 335 199 l 335 0 l 124 0 l 124 992 l 335 992 l 335 837 l 455 837 q 718 756 627 837 q 809 522 809 675 m 335 368 l 402 368 q 549 404 501 368 q 597 522 597 439 q 554 630 597 595 q 419 666 511 666 l 335 666 l 335 368 "},"j":{"x_min":-88.84375,"x_max":324.875,"ha":424,"o":"m 47 -334 q -88 -317 -31 -334 l -88 -154 q 8 -167 -41 -167 q 84 -137 60 -167 q 108 -51 108 -108 l 108 758 l 315 758 l 315 -82 q 245 -268 315 -203 q 47 -334 175 -334 m 99 953 q 212 1055 99 1055 q 324 953 324 1055 q 296 879 324 905 q 212 852 268 852 q 99 953 99 852 "},"1":{"x_min":82.140625,"x_max":573.859375,"ha":793,"o":"m 573 0 l 364 0 l 364 574 l 366 668 l 369 771 q 297 703 317 719 l 183 611 l 82 737 l 401 992 l 573 992 l 573 0 "},"›":{"x_min":55.609375,"x_max":455.765625,"ha":511,"o":"m 455 371 l 204 64 l 55 144 l 244 380 l 55 616 l 204 697 l 455 388 l 455 371 "},"<":{"x_min":59.703125,"x_max":733.296875,"ha":793,"o":"m 733 137 l 59 434 l 59 531 l 733 868 l 733 705 l 269 490 l 733 299 l 733 137 "},"t":{"x_min":31.890625,"x_max":558.234375,"ha":603,"o":"m 427 150 q 558 174 482 150 l 558 20 q 368 -14 480 -14 q 187 48 244 -14 q 130 237 130 111 l 130 602 l 31 602 l 31 690 l 145 759 l 205 919 l 337 919 l 337 758 l 550 758 l 550 602 l 337 602 l 337 236 q 362 171 337 192 q 427 150 387 150 "},"¬":{"x_min":59.6875,"x_max":733.3125,"ha":793,"o":"m 733 168 l 584 168 l 584 415 l 59 415 l 59 564 l 733 564 l 733 168 "},"ù":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 420 842 q 295 938 377 871 q 166 1049 212 1005 l 166 1064 l 398 1064 q 557 860 440 995 l 557 842 l 420 842 "},"ĉ":{"x_min":62.390625,"x_max":703.515625,"ha":714,"o":"m 416 -14 q 62 375 62 -14 q 158 670 62 568 q 434 773 254 773 q 670 721 566 773 l 609 561 q 518 593 560 581 q 434 606 476 606 q 273 376 273 606 q 434 153 273 153 q 545 169 494 153 q 646 219 596 185 l 646 42 q 545 -1 596 10 q 416 -14 494 -14 m 565 842 q 407 960 459 904 q 251 842 354 906 l 114 842 l 114 860 q 287 1064 242 988 l 529 1064 q 602 968 550 1028 q 703 860 654 907 l 703 842 l 565 842 "},"ï":{"x_min":-19.78125,"x_max":445.15625,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m -19 953 q 5 1021 -19 997 q 74 1044 31 1044 q 144 1019 119 1044 q 170 953 170 994 q 144 887 170 912 q 74 863 118 863 q 5 886 31 863 q -19 953 -19 910 m 253 953 q 280 1022 253 1000 q 348 1044 308 1044 q 419 1020 392 1044 q 445 953 445 995 q 418 887 445 911 q 348 863 392 863 q 280 885 308 863 q 253 953 253 907 "},"ī":{"x_min":-16.0625,"x_max":443.765625,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m -16 985 l 443 985 l 443 842 l -16 842 l -16 985 "},"Ò":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 558 1071 q 433 1167 515 1100 q 304 1278 350 1234 l 304 1293 l 536 1293 q 695 1089 578 1224 l 695 1071 l 558 1071 "},"ầ":{"x_min":-30.984375,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 166 860 q 312 1050 242 948 l 526 1050 q 602 945 559 1001 q 672 860 645 890 l 672 842 l 562 842 q 419 954 496 886 q 276 842 347 889 l 166 842 l 166 860 m 226 974 l 123 974 q -30 1113 12 1054 l -30 1128 l 133 1128 q 226 991 169 1052 l 226 974 "},"Ď":{"x_min":124.796875,"x_max":947.296875,"ha":1028,"o":"m 947 505 q 807 130 947 260 q 405 0 668 0 l 124 0 l 124 992 l 436 992 q 813 863 678 992 q 947 505 947 735 m 728 500 q 446 819 728 819 l 335 819 l 335 173 l 425 173 q 728 500 728 173 m 786 1293 l 786 1274 q 681 1161 729 1217 q 612 1071 633 1104 l 370 1071 q 314 1147 351 1102 q 197 1274 277 1191 l 197 1293 l 334 1293 q 490 1174 434 1230 q 648 1293 547 1232 l 786 1293 "},"&":{"x_min":55.609375,"x_max":1042,"ha":1042,"o":"m 1042 0 l 786 0 l 708 76 q 415 -14 578 -14 q 152 62 249 -14 q 55 267 55 138 q 96 426 55 360 q 237 548 137 491 q 163 660 186 607 q 140 776 140 713 q 219 942 140 879 q 430 1006 298 1006 q 632 947 556 1006 q 708 790 708 888 q 661 642 708 709 q 510 515 614 576 l 702 327 q 786 532 751 406 l 1001 532 q 934 353 977 440 q 837 198 892 266 l 1042 0 m 273 287 q 317 194 273 228 q 429 159 360 159 q 583 201 514 159 l 358 425 q 296 362 318 395 q 273 287 273 330 m 516 768 q 492 825 516 804 q 429 845 468 845 q 357 824 383 845 q 331 762 331 802 q 396 631 331 702 q 485 695 454 663 q 516 768 516 726 "},"Ồ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 297 1089 q 443 1279 373 1177 l 657 1279 q 733 1174 690 1230 q 803 1089 776 1119 l 803 1071 l 693 1071 q 550 1183 627 1115 q 407 1071 478 1118 l 297 1071 l 297 1089 m 357 1203 l 254 1203 q 100 1342 143 1283 l 100 1357 l 264 1357 q 357 1220 300 1281 l 357 1203 "},"˝":{"x_min":105.859375,"x_max":711.265625,"ha":817,"o":"m 105 842 l 105 860 q 185 977 147 917 q 237 1064 223 1036 l 441 1064 l 441 1049 q 342 946 419 1013 q 215 842 265 878 l 105 842 m 374 842 l 374 860 q 507 1064 469 990 l 711 1064 l 711 1049 q 626 958 694 1020 q 484 842 557 896 l 374 842 "},"I":{"x_min":124.84375,"x_max":335.09375,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 "},"G":{"x_min":80.703125,"x_max":894.734375,"ha":1006,"o":"m 501 557 l 894 557 l 894 42 q 714 -1 799 11 q 541 -14 630 -14 q 199 117 317 -14 q 80 497 80 249 q 218 871 80 737 q 598 1006 355 1006 q 893 944 751 1006 l 823 776 q 597 831 714 831 q 379 739 461 831 q 297 492 297 647 q 363 246 297 331 q 555 160 429 160 q 689 174 621 160 l 689 382 l 501 382 l 501 557 "},"`":{"x_min":225.15625,"x_max":616.484375,"ha":843,"o":"m 479 842 q 354 938 436 871 q 225 1049 271 1005 l 225 1064 l 457 1064 q 616 860 499 995 l 616 842 l 479 842 "},"·":{"x_min":79.359375,"x_max":316.734375,"ha":396,"o":"m 79 490 q 109 576 79 547 q 198 606 140 606 q 285 576 255 606 q 316 490 316 546 q 285 405 316 435 q 198 375 253 375 q 110 405 141 375 q 79 490 79 435 "},"ỗ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 529 1063 q 479 1071 504 1063 q 429 1090 453 1080 q 382 1109 404 1100 q 340 1118 359 1118 q 298 1106 313 1118 q 275 1062 284 1095 l 198 1062 q 241 1181 204 1137 q 333 1226 277 1226 q 384 1217 358 1226 q 435 1197 411 1208 q 482 1178 459 1187 q 522 1169 504 1169 q 563 1181 550 1169 q 587 1227 577 1194 l 664 1227 q 619 1105 655 1148 q 529 1063 583 1063 m 683 842 l 587 842 q 430 945 491 890 q 273 842 374 895 l 177 842 l 177 860 q 337 1037 293 971 l 523 1037 q 599 945 556 990 q 683 860 643 900 l 683 842 "},"Ễ":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 512 1292 q 462 1300 487 1292 q 412 1319 436 1309 q 365 1338 387 1329 q 323 1347 342 1347 q 281 1335 296 1347 q 258 1291 267 1324 l 181 1291 q 224 1410 187 1366 q 316 1455 260 1455 q 367 1446 341 1455 q 418 1426 394 1437 q 465 1407 442 1416 q 505 1398 487 1398 q 546 1410 533 1398 q 570 1456 560 1423 l 647 1456 q 602 1334 638 1377 q 512 1292 566 1292 m 666 1071 l 570 1071 q 413 1174 474 1119 q 256 1071 357 1124 l 160 1071 l 160 1089 q 320 1266 276 1200 l 506 1266 q 582 1174 539 1219 q 666 1089 626 1129 l 666 1071 "},"ằ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 484 1018 l 395 1018 q 255 1158 324 1076 l 255 1173 l 405 1173 q 484 1036 437 1107 l 484 1018 m 275 1071 q 319 988 280 1020 q 418 955 357 955 q 517 985 480 955 q 561 1071 555 1014 l 662 1071 q 593 899 656 957 q 419 842 530 842 q 244 902 310 842 q 170 1071 178 963 l 275 1071 "},"ŏ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 695 1071 q 612 904 687 966 q 425 842 538 842 q 237 903 307 842 q 161 1071 167 965 l 277 1071 q 295 1020 279 1039 q 340 994 311 1002 q 427 986 369 986 q 577 1071 566 986 l 695 1071 "},"¿":{"x_min":41.390625,"x_max":667.0625,"ha":663,"o":"m 483 411 l 483 360 q 453 246 483 294 q 350 145 423 198 q 256 63 276 93 q 237 -9 237 33 q 266 -73 237 -47 q 356 -98 296 -98 q 471 -78 410 -98 q 597 -30 532 -58 l 667 -180 q 516 -241 600 -218 q 361 -265 432 -265 q 126 -199 211 -265 q 41 -19 41 -134 q 74 107 41 53 q 204 232 107 160 q 286 304 268 279 q 304 371 304 329 l 304 411 l 483 411 m 505 642 q 474 556 505 585 q 386 527 444 527 q 298 557 329 527 q 268 642 268 587 q 299 727 268 697 q 386 758 331 758 q 474 728 443 758 q 505 642 505 698 "},"Ả":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 653 1237 q 543 1104 653 1131 l 536 1056 l 418 1056 l 403 1155 q 472 1180 453 1163 q 490 1223 490 1198 q 476 1256 490 1245 q 438 1268 462 1268 q 344 1252 394 1268 l 344 1366 q 400 1377 365 1373 q 464 1382 436 1382 q 606 1344 559 1382 q 653 1237 653 1306 "},"ý":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 266 842 l 266 860 q 425 1064 382 995 l 657 1064 l 657 1049 q 537 945 622 1014 q 403 842 451 875 l 266 842 "},"Ứ":{"x_min":118.015625,"x_max":1243.296875,"ha":1229,"o":"m 931 992 l 931 864 q 1005 932 982 881 q 1029 1056 1029 983 l 1233 1056 l 1243 1041 q 1185 879 1221 936 q 1087 787 1149 822 q 931 739 1025 752 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 368 q 375 212 327 262 q 526 162 423 162 q 675 214 629 162 q 722 369 722 266 l 722 992 l 931 992 m 1050 0 l 1050 0 m 414 1071 l 414 1089 q 573 1293 530 1224 l 805 1293 l 805 1278 q 685 1174 770 1243 q 551 1071 599 1104 l 414 1071 "},"ſ":{"x_min":108.515625,"x_max":563.875,"ha":532,"o":"m 401 898 q 315 805 315 898 l 315 0 l 108 0 l 108 814 q 172 1003 108 943 q 375 1063 236 1063 q 563 1031 482 1063 l 515 879 q 401 898 453 898 "},"º":{"x_min":38.640625,"x_max":499.671875,"ha":539,"o":"m 499 756 q 437 575 499 640 q 267 510 375 510 q 101 576 164 510 q 38 756 38 643 q 99 937 38 871 q 270 1003 160 1003 q 436 936 373 1003 q 499 756 499 869 m 176 756 q 198 654 176 689 q 269 620 220 620 q 339 654 317 620 q 360 756 360 689 q 339 858 360 824 q 269 891 317 891 q 198 858 220 891 q 176 756 176 824 "},"ź":{"x_min":37.296875,"x_max":636.625,"ha":678,"o":"m 636 0 l 37 0 l 37 122 l 389 599 l 58 599 l 58 758 l 624 758 l 624 623 l 282 158 l 636 158 l 636 0 m 239 842 l 239 860 q 398 1064 355 995 l 630 1064 l 630 1049 q 510 945 595 1014 q 376 842 424 875 l 239 842 "},"ű":{"x_min":104.453125,"x_max":839.265625,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 233 842 l 233 860 q 313 977 275 917 q 365 1064 351 1036 l 569 1064 l 569 1049 q 470 946 547 1013 q 343 842 393 878 l 233 842 m 502 842 l 502 860 q 635 1064 597 990 l 839 1064 l 839 1049 q 754 958 822 1020 q 612 842 685 896 l 502 842 "},"Ư":{"x_min":118.015625,"x_max":1243.296875,"ha":1229,"o":"m 931 992 l 931 864 q 1005 932 982 881 q 1029 1056 1029 983 l 1233 1056 l 1243 1041 q 1185 879 1221 936 q 1087 787 1149 822 q 931 739 1025 752 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 368 q 375 212 327 262 q 526 162 423 162 q 675 214 629 162 q 722 369 722 266 l 722 992 l 931 992 m 1050 0 l 1050 0 "},"Ǽ":{"x_min":0,"x_max":1240.9375,"ha":1323,"o":"m 1240 0 l 648 0 l 648 236 l 315 236 l 213 0 l 0 0 l 444 992 l 1240 992 l 1240 819 l 858 819 l 858 602 l 1215 602 l 1215 429 l 858 429 l 858 173 l 1240 173 l 1240 0 m 392 413 l 648 413 l 648 812 l 562 812 l 392 413 m 681 1071 l 681 1089 q 840 1293 797 1224 l 1072 1293 l 1072 1278 q 952 1174 1037 1243 q 818 1071 866 1104 l 681 1071 "},"ń":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 572 566 601 525 q 479 607 543 607 q 354 549 392 607 q 315 357 315 491 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 401 744 340 716 q 539 773 461 773 q 740 701 671 773 q 808 494 808 629 l 808 0 m 340 842 l 340 860 q 499 1064 456 995 l 731 1064 l 731 1049 q 611 945 696 1014 q 477 842 525 875 l 340 842 "},"Ș":{"x_min":63.75,"x_max":710.0625,"ha":765,"o":"m 710 275 q 613 63 710 140 q 344 -14 516 -14 q 63 45 185 -14 l 63 241 q 233 177 164 196 q 360 159 303 159 q 466 186 429 159 q 503 264 503 212 q 487 316 503 294 q 439 360 471 339 q 311 427 408 381 q 174 509 220 470 q 102 601 129 549 q 75 723 75 653 q 164 930 75 855 q 410 1006 253 1006 q 558 987 488 1006 q 705 936 628 969 l 637 772 q 506 818 558 805 q 404 831 454 831 q 312 803 344 831 q 280 730 280 775 q 293 682 280 702 q 334 641 306 661 q 467 572 362 622 q 658 438 606 505 q 710 275 710 372 m 234 -288 q 257 -191 244 -255 q 276 -85 271 -128 l 467 -85 l 467 -98 q 355 -307 417 -212 l 234 -307 l 234 -288 "},";":{"x_min":42.734375,"x_max":316.734375,"ha":403,"o":"m 301 161 l 311 145 q 191 -179 276 8 l 42 -179 q 111 161 86 1 l 301 161 m 79 657 q 109 743 79 714 q 198 773 140 773 q 285 743 255 773 q 316 657 316 713 q 285 572 316 602 q 198 542 253 542 q 110 572 141 542 q 79 657 79 602 "}," ":{"x_min":0,"x_max":0,"ha":347},"Ġ":{"x_min":80.703125,"x_max":894.734375,"ha":1006,"o":"m 501 557 l 894 557 l 894 42 q 714 -1 799 11 q 541 -14 630 -14 q 199 117 317 -14 q 80 497 80 249 q 218 871 80 737 q 598 1006 355 1006 q 893 944 751 1006 l 823 776 q 597 831 714 831 q 379 739 461 831 q 297 492 297 647 q 363 246 297 331 q 555 160 429 160 q 689 174 621 160 l 689 382 l 501 382 l 501 557 m 444 1183 q 557 1284 444 1284 q 669 1183 669 1284 q 641 1108 669 1135 q 557 1082 613 1082 q 444 1183 444 1082 "},"6":{"x_min":48.84375,"x_max":748.90625,"ha":793,"o":"m 48 420 q 173 859 48 715 q 546 1003 297 1003 q 679 992 630 1003 l 679 825 q 559 838 618 838 q 383 806 451 838 q 281 709 315 773 q 241 528 247 646 l 250 528 q 465 644 317 644 q 673 560 598 644 q 748 329 748 477 q 659 78 748 171 q 411 -14 569 -14 q 219 36 301 -14 q 93 185 137 87 q 48 420 48 283 m 407 153 q 510 198 474 153 q 546 327 546 243 q 512 441 546 399 q 411 483 478 483 q 302 441 347 483 q 257 345 257 400 q 299 209 257 264 q 407 153 341 153 "},"n":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 572 566 601 525 q 479 607 543 607 q 354 549 392 607 q 315 357 315 491 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 401 744 340 716 q 539 773 461 773 q 740 701 671 773 q 808 494 808 629 l 808 0 "},"﻿":{"x_min":0,"x_max":0,"ha":0},"ụ":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 341 -190 q 454 -89 341 -89 q 566 -190 566 -89 q 538 -265 566 -238 q 454 -291 509 -291 q 341 -190 341 -291 "},"ģ":{"x_min":4.0625,"x_max":768.71875,"ha":785,"o":"m 768 759 l 768 653 l 650 623 q 682 508 682 572 q 597 318 682 386 q 360 250 512 250 l 323 252 l 293 255 q 261 201 261 230 q 375 156 261 156 l 504 156 q 694 102 628 156 q 759 -54 759 49 q 648 -260 759 -187 q 330 -334 538 -334 q 87 -278 171 -334 q 4 -123 4 -223 q 46 -9 4 -55 q 172 56 89 36 q 116 100 140 70 q 92 166 92 131 q 118 238 92 209 q 190 295 143 267 q 95 378 130 321 q 61 512 61 435 q 141 705 61 637 q 372 773 222 773 q 448 767 404 773 q 504 759 491 761 l 768 759 m 183 -107 q 224 -174 183 -150 q 339 -199 265 -199 q 513 -168 450 -199 q 576 -85 576 -138 q 539 -26 576 -42 q 424 -10 502 -10 l 316 -10 q 221 -36 259 -10 q 183 -107 183 -63 m 258 510 q 286 412 258 448 q 372 376 314 376 q 458 412 430 376 q 485 510 485 448 q 372 647 485 647 q 258 510 258 647 m 521 1045 q 497 948 511 1012 q 479 842 484 885 l 287 842 l 287 856 q 400 1064 340 971 l 521 1064 l 521 1045 "},"Ẵ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 338 1272 q 378 1208 342 1232 q 481 1184 414 1184 q 624 1272 614 1184 l 725 1272 q 656 1122 719 1173 q 482 1071 594 1071 q 306 1124 372 1071 q 233 1272 241 1178 l 338 1272 m 585 1305 q 535 1313 560 1305 q 485 1332 509 1322 q 438 1351 460 1342 q 396 1359 415 1359 q 353 1347 367 1359 q 331 1304 340 1335 l 254 1304 q 294 1412 260 1371 q 389 1454 327 1454 q 440 1445 414 1454 q 491 1425 467 1436 q 538 1406 515 1415 q 578 1397 560 1397 q 619 1410 606 1397 q 643 1455 633 1422 l 720 1455 q 677 1343 712 1381 q 585 1305 642 1305 "},"¤":{"x_min":76.703125,"x_max":716.9375,"ha":793,"o":"m 127 490 q 164 623 127 559 l 76 709 l 176 809 l 262 723 q 396 759 324 759 q 529 722 467 759 l 615 809 l 716 712 l 629 625 q 665 490 665 564 q 629 355 665 417 l 714 270 l 615 172 l 529 257 q 396 222 464 222 q 261 257 318 222 l 176 173 l 78 272 l 164 356 q 127 490 127 419 m 267 490 q 304 400 267 438 q 396 363 341 363 q 488 400 451 363 q 526 490 526 437 q 488 581 526 544 q 396 619 449 619 q 305 581 343 619 q 267 490 267 543 "},"Ĝ":{"x_min":80.703125,"x_max":894.734375,"ha":1006,"o":"m 501 557 l 894 557 l 894 42 q 714 -1 799 11 q 541 -14 630 -14 q 199 117 317 -14 q 80 497 80 249 q 218 871 80 737 q 598 1006 355 1006 q 893 944 751 1006 l 823 776 q 597 831 714 831 q 379 739 461 831 q 297 492 297 647 q 363 246 297 331 q 555 160 429 160 q 689 174 621 160 l 689 382 l 501 382 l 501 557 m 702 1071 q 544 1189 596 1133 q 388 1071 491 1135 l 251 1071 l 251 1089 q 424 1293 379 1217 l 666 1293 q 739 1197 687 1257 q 840 1089 791 1136 l 840 1071 l 702 1071 "},"p":{"x_min":108.515625,"x_max":816.609375,"ha":879,"o":"m 524 -14 q 315 83 391 -14 l 304 83 q 315 -26 315 -11 l 315 -334 l 108 -334 l 108 758 l 276 758 l 305 660 l 315 660 q 530 773 387 773 q 740 669 664 773 q 816 380 816 565 q 781 169 816 258 q 679 32 745 79 q 524 -14 613 -14 m 463 607 q 352 560 387 607 q 315 404 316 513 l 315 381 q 351 206 315 259 q 466 153 387 153 q 605 383 605 153 q 571 551 605 495 q 463 607 537 607 "},"‡":{"x_min":83.421875,"x_max":646.578125,"ha":730,"o":"m 422 377 l 646 399 l 646 234 l 422 255 l 459 0 l 270 0 l 308 255 l 83 234 l 83 399 l 308 377 l 276 532 l 308 676 l 83 656 l 83 820 l 308 799 l 270 1055 l 459 1055 l 422 799 l 646 820 l 646 656 l 422 676 l 454 532 l 422 377 "},"ň":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 572 566 601 525 q 479 607 543 607 q 354 549 392 607 q 315 357 315 491 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 401 744 340 716 q 539 773 461 773 q 740 701 671 773 q 808 494 808 629 l 808 0 m 768 1064 l 768 1045 q 663 932 711 988 q 594 842 615 875 l 352 842 q 296 918 333 873 q 179 1045 259 962 l 179 1064 l 316 1064 q 472 945 416 1001 q 630 1064 529 1003 l 768 1064 "},"ę":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 539 -140 q 555 -182 539 -168 q 594 -195 570 -195 q 671 -183 631 -195 l 671 -304 q 566 -320 616 -320 q 443 -276 489 -320 q 396 -163 396 -233 q 422 -78 396 -118 q 518 14 448 -38 l 640 14 q 566 -67 592 -30 q 539 -140 539 -104 "},"ố":{"x_min":62.390625,"x_max":874.65625,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 677 842 l 568 842 q 425 954 492 892 q 281 842 347 886 l 172 842 l 172 860 q 317 1050 247 948 l 531 1050 q 613 939 567 997 q 677 860 658 881 l 677 842 m 617 991 q 711 1128 675 1053 l 874 1128 l 874 1113 q 720 974 829 1053 l 617 974 l 617 991 "},"Ặ":{"x_min":0,"x_max":958.328125,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 995 l 607 995 l 958 0 l 731 0 m 609 412 q 497 775 510 733 q 479 841 484 817 q 351 412 457 754 l 609 412 m 746 1300 q 663 1133 737 1195 q 476 1070 588 1070 q 287 1132 358 1070 q 212 1300 217 1194 l 327 1300 q 346 1249 330 1268 q 390 1223 362 1231 q 477 1215 419 1215 q 628 1300 617 1215 l 746 1300 m 366 -190 q 479 -88 366 -88 q 592 -190 592 -88 q 563 -265 592 -238 q 479 -291 535 -291 q 366 -190 366 -291 "},"S":{"x_min":63.75,"x_max":710.0625,"ha":765,"o":"m 710 275 q 613 63 710 140 q 344 -14 516 -14 q 63 45 185 -14 l 63 241 q 233 177 164 196 q 360 159 303 159 q 466 186 429 159 q 503 264 503 212 q 487 316 503 294 q 439 360 471 339 q 311 427 408 381 q 174 509 220 470 q 102 601 129 549 q 75 723 75 653 q 164 930 75 855 q 410 1006 253 1006 q 558 987 488 1006 q 705 936 628 969 l 637 772 q 506 818 558 805 q 404 831 454 831 q 312 803 344 831 q 280 730 280 775 q 293 682 280 702 q 334 641 306 661 q 467 572 362 622 q 658 438 606 505 q 710 275 710 372 "},"ễ":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 522 1063 q 472 1071 497 1063 q 422 1090 446 1080 q 375 1109 397 1100 q 333 1118 352 1118 q 291 1106 306 1118 q 268 1062 277 1095 l 191 1062 q 234 1181 197 1137 q 326 1226 270 1226 q 377 1217 351 1226 q 428 1197 404 1208 q 475 1178 452 1187 q 515 1169 497 1169 q 556 1181 543 1169 q 580 1227 570 1194 l 657 1227 q 612 1105 648 1148 q 522 1063 576 1063 m 676 842 l 580 842 q 423 945 484 890 q 266 842 367 895 l 170 842 l 170 860 q 330 1037 286 971 l 516 1037 q 592 945 549 990 q 676 860 636 900 l 676 842 "},"/":{"x_min":9.5,"x_max":567.21875,"ha":574,"o":"m 567 992 l 197 0 l 9 0 l 379 992 l 567 992 "},"į":{"x_min":28.78125,"x_max":324.875,"ha":424,"o":"m 99 953 q 212 1055 99 1055 q 324 953 324 1055 q 296 879 324 905 q 212 852 268 852 q 99 953 99 852 m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 171 -154 q 187 -196 171 -182 q 226 -209 202 -209 q 303 -197 263 -209 l 303 -318 q 198 -334 248 -334 q 75 -290 121 -334 q 28 -177 28 -247 q 54 -92 28 -132 q 150 0 80 -52 l 272 0 q 198 -81 224 -44 q 171 -154 171 -118 "},"Ế":{"x_min":124.796875,"x_max":860.65625,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 663 1071 l 554 1071 q 411 1183 478 1121 q 267 1071 333 1115 l 158 1071 l 158 1089 q 303 1279 233 1177 l 517 1279 q 599 1168 553 1226 q 663 1089 644 1110 l 663 1071 m 603 1220 q 697 1357 661 1282 l 860 1357 l 860 1342 q 706 1203 815 1282 l 603 1203 l 603 1220 "},"Ọ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 440 -190 q 553 -89 440 -89 q 665 -190 665 -89 q 637 -265 665 -238 q 553 -291 608 -291 q 440 -190 440 -291 "},"ắ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 350 1036 q 429 1173 397 1107 l 579 1173 l 579 1158 q 439 1018 517 1084 l 350 1018 l 350 1036 m 664 1071 q 590 902 656 963 q 416 842 524 842 q 241 900 304 842 q 172 1071 178 958 l 274 1071 q 318 984 279 1012 q 417 955 357 955 q 515 987 477 955 q 560 1071 554 1019 l 664 1071 "},"Ŧ":{"x_min":27.671875,"x_max":776.421875,"ha":804,"o":"m 507 0 l 296 0 l 296 404 l 128 404 l 128 577 l 296 577 l 296 817 l 27 817 l 27 992 l 776 992 l 776 817 l 507 817 l 507 577 l 674 577 l 674 404 l 507 404 l 507 0 "},"y":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 "},"‗":{"x_min":-2.71875,"x_max":573.71875,"ha":571,"o":"m 573 -314 l -2 -314 l -2 -219 l 573 -219 l 573 -314 m 573 -125 l -2 -125 l -2 -30 l 573 -30 l 573 -125 "},"ǿ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 269 16 342 -14 l 223 -51 l 119 19 l 165 87 q 62 380 62 193 q 159 669 62 566 q 432 773 256 773 q 600 737 521 773 l 637 793 l 740 720 l 701 663 q 797 380 797 557 m 273 380 q 286 267 273 316 l 501 590 q 429 606 472 606 q 309 550 346 606 q 273 380 273 494 m 586 380 q 577 476 586 435 l 368 162 q 430 152 394 152 q 549 209 513 152 q 586 380 586 267 m 308 842 l 308 860 q 467 1064 424 995 l 699 1064 l 699 1049 q 579 945 664 1014 q 445 842 493 875 l 308 842 "},"g":{"x_min":4.0625,"x_max":768.71875,"ha":785,"o":"m 768 759 l 768 653 l 650 623 q 682 508 682 572 q 597 318 682 386 q 360 250 512 250 l 323 252 l 293 255 q 261 201 261 230 q 375 156 261 156 l 504 156 q 694 102 628 156 q 759 -54 759 49 q 648 -260 759 -187 q 330 -334 538 -334 q 87 -278 171 -334 q 4 -123 4 -223 q 46 -9 4 -55 q 172 56 89 36 q 116 100 140 70 q 92 166 92 131 q 118 238 92 209 q 190 295 143 267 q 95 378 130 321 q 61 512 61 435 q 141 705 61 637 q 372 773 222 773 q 448 767 404 773 q 504 759 491 761 l 768 759 m 183 -107 q 224 -174 183 -150 q 339 -199 265 -199 q 513 -168 450 -199 q 576 -85 576 -138 q 539 -26 576 -42 q 424 -10 502 -10 l 316 -10 q 221 -36 259 -10 q 183 -107 183 -63 m 258 510 q 286 412 258 448 q 372 376 314 376 q 458 412 430 376 q 485 510 485 448 q 372 647 485 647 q 258 510 258 647 "},"ĸ":{"x_min":108.515625,"x_max":861,"ha":861,"o":"m 314 394 l 409 509 l 622 758 l 842 758 l 544 410 l 861 0 l 624 0 l 412 288 l 315 227 l 315 0 l 108 0 l 108 758 l 315 758 l 315 559 l 313 450 l 311 394 l 314 394 "},"²":{"x_min":31.859375,"x_max":475.859375,"ha":526,"o":"m 475 397 l 37 397 l 37 510 l 189 659 q 277 757 258 727 q 296 822 296 788 q 280 861 296 847 q 237 875 264 875 q 115 815 182 875 l 31 918 q 259 1006 131 1006 q 406 960 352 1006 q 459 836 459 915 q 427 727 459 778 q 308 597 395 676 l 237 532 l 475 532 l 475 397 "},"–":{"x_min":55.609375,"x_max":639.390625,"ha":695,"o":"m 55 296 l 55 452 l 639 452 l 639 296 l 55 296 "},"ë":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 201 953 q 226 1021 201 997 q 295 1044 252 1044 q 365 1019 340 1044 q 391 953 391 994 q 365 887 391 912 q 295 863 339 863 q 226 886 252 863 q 201 953 201 910 m 474 953 q 501 1022 474 1000 q 569 1044 529 1044 q 640 1020 613 1044 q 666 953 666 995 q 639 887 666 911 q 569 863 613 863 q 501 885 529 863 q 474 953 474 907 "},"ƒ":{"x_min":133.671875,"x_max":726.4375,"ha":793,"o":"m 505 -82 q 441 -268 505 -202 q 258 -334 377 -334 q 133 -317 185 -334 l 133 -154 q 213 -167 173 -167 q 298 -51 298 -167 l 298 545 l 184 545 l 184 645 l 298 701 l 298 756 q 357 944 298 884 q 548 1005 417 1005 q 726 973 650 1005 l 677 821 q 579 840 622 840 q 505 748 505 840 l 505 701 l 659 701 l 659 545 l 505 545 l 505 -82 "},"J":{"x_min":-103.09375,"x_max":335.046875,"ha":460,"o":"m 21 -291 q -103 -276 -50 -291 l -103 -101 q -4 -114 -48 -114 q 94 -71 65 -114 q 124 63 124 -28 l 124 992 l 335 992 l 335 64 q 255 -200 335 -109 q 21 -291 176 -291 "},"Ã":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 367 1142 q 327 1123 346 1142 q 299 1069 308 1105 l 198 1069 q 254 1223 205 1167 q 382 1279 302 1279 q 437 1267 410 1279 q 490 1243 464 1256 q 541 1218 516 1229 q 591 1207 566 1207 q 631 1225 612 1207 q 659 1280 650 1243 l 760 1280 q 704 1125 753 1181 q 576 1070 654 1070 q 521 1081 548 1070 q 468 1106 494 1092 q 417 1130 442 1119 q 367 1142 392 1142 "},"ŷ":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 553 842 q 395 960 447 904 q 239 842 342 906 l 102 842 l 102 860 q 275 1064 230 988 l 517 1064 q 590 968 538 1028 q 691 860 642 907 l 691 842 l 553 842 "},"ŕ":{"x_min":108.515625,"x_max":620.484375,"ha":631,"o":"m 531 773 q 601 766 574 773 l 586 572 q 525 579 561 579 q 370 528 426 579 q 315 386 315 477 l 315 0 l 108 0 l 108 758 l 265 758 l 295 631 l 305 631 q 401 734 341 695 q 531 773 461 773 m 229 842 l 229 860 q 388 1064 345 995 l 620 1064 l 620 1049 q 500 945 585 1014 q 366 842 414 875 l 229 842 "},"©":{"x_min":67.84375,"x_max":1088.15625,"ha":1156,"o":"m 607 685 q 505 635 541 685 q 469 495 469 584 q 607 305 469 305 q 690 315 645 305 q 774 345 735 325 l 774 215 q 603 177 692 177 q 388 261 464 177 q 312 497 312 346 q 387 729 312 646 q 597 813 462 813 q 804 760 698 813 l 754 646 q 607 685 677 685 m 67 495 q 135 750 67 631 q 322 937 203 868 q 578 1006 440 1006 q 832 938 713 1006 q 1019 751 951 870 q 1088 495 1088 632 q 1022 244 1088 361 q 837 56 956 127 q 578 -14 719 -14 q 318 56 437 -14 q 133 243 200 126 q 67 495 67 361 m 164 495 q 219 288 164 384 q 371 136 275 192 q 577 81 468 81 q 785 137 689 81 q 936 289 881 192 q 991 495 991 385 q 936 703 991 606 q 784 854 880 799 q 577 909 687 909 q 370 854 466 909 q 219 702 274 798 q 164 495 164 605 "},"˘":{"x_min":153.953125,"x_max":687.71875,"ha":843,"o":"m 687 1071 q 604 904 679 966 q 417 842 530 842 q 229 903 299 842 q 153 1071 159 965 l 269 1071 q 287 1020 271 1039 q 332 994 303 1002 q 419 986 361 986 q 569 1071 558 986 l 687 1071 "},"Ă":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 745 1300 q 662 1133 737 1195 q 475 1071 588 1071 q 287 1132 357 1071 q 211 1300 217 1194 l 327 1300 q 345 1249 329 1268 q 390 1223 361 1231 q 477 1215 419 1215 q 627 1300 616 1215 l 745 1300 "},"D":{"x_min":124.796875,"x_max":947.296875,"ha":1028,"o":"m 947 505 q 807 130 947 260 q 405 0 668 0 l 124 0 l 124 992 l 436 992 q 813 863 678 992 q 947 505 947 735 m 728 500 q 446 819 728 819 l 335 819 l 335 173 l 425 173 q 728 500 728 173 "},"ł":{"x_min":-0.140625,"x_max":458.34375,"ha":458,"o":"m 331 630 l 378 660 l 458 526 l 331 450 l 331 0 l 124 0 l 124 323 l 76 294 l 0 427 l 124 503 l 124 1055 l 331 1055 l 331 630 "},"ÿ":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 165 953 q 190 1021 165 997 q 259 1044 216 1044 q 329 1019 304 1044 q 355 953 355 994 q 329 887 355 912 q 259 863 303 863 q 190 886 216 863 q 165 953 165 910 m 438 953 q 465 1022 438 1000 q 533 1044 493 1044 q 604 1020 577 1044 q 630 953 630 995 q 603 887 630 911 q 533 863 577 863 q 465 885 493 863 q 438 953 438 907 "},"ĺ":{"x_min":108.515625,"x_max":512.484375,"ha":424,"o":"m 315 0 l 108 0 l 108 1055 l 315 1055 l 315 0 m 121 1110 l 121 1128 q 280 1332 237 1263 l 512 1332 l 512 1317 q 392 1213 477 1282 q 258 1110 306 1143 l 121 1110 "},"Ł":{"x_min":1.359375,"x_max":737.53125,"ha":785,"o":"m 124 0 l 124 333 l 78 306 l 1 438 l 124 514 l 124 992 l 335 992 l 335 641 l 432 701 l 511 568 l 335 461 l 335 173 l 737 173 l 737 0 l 124 0 "}," ":{"x_min":0,"x_max":0,"ha":396},"$":{"x_min":59.703125,"x_max":740.765625,"ha":793,"o":"m 740 310 q 662 137 740 202 q 444 58 584 71 l 444 -80 l 351 -80 l 351 56 q 61 114 185 59 l 61 293 q 203 241 120 264 q 351 215 286 219 l 351 425 l 305 443 q 115 558 171 496 q 59 711 59 620 q 136 873 59 809 q 351 950 213 936 l 351 1054 l 444 1054 l 444 953 q 725 890 599 946 l 661 731 q 444 784 555 775 l 444 584 q 632 496 576 533 q 714 414 688 459 q 740 310 740 369 m 536 300 q 513 348 536 328 q 444 388 490 367 l 444 220 q 536 300 536 235 m 263 711 q 284 662 263 681 q 351 622 305 643 l 351 782 q 263 711 263 769 "},"w":{"x_min":13.5625,"x_max":1175.4375,"ha":1189,"o":"m 731 0 l 673 265 l 594 600 l 590 600 l 451 0 l 229 0 l 13 758 l 219 758 l 307 422 q 349 173 328 332 l 354 173 q 377 336 356 225 l 388 394 l 482 758 l 710 758 l 799 394 q 807 350 801 379 q 818 288 813 321 q 828 224 824 255 q 833 173 832 192 l 837 173 q 859 307 843 222 q 881 422 874 392 l 972 758 l 1175 758 l 957 0 l 731 0 "},"\\":{"x_min":8.140625,"x_max":565.859375,"ha":574,"o":"m 196 992 l 565 0 l 377 0 l 8 992 l 196 992 "},"Ì":{"x_min":-38.84375,"x_max":352.484375,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 215 1071 q 90 1167 172 1100 q -38 1278 7 1234 l -38 1293 l 193 1293 q 352 1089 235 1224 l 352 1071 l 215 1071 "},"Ç":{"x_min":80.703125,"x_max":836.171875,"ha":885,"o":"m 545 831 q 362 741 427 831 q 297 492 297 652 q 545 160 297 160 q 798 213 650 160 l 798 36 q 526 -14 676 -14 q 195 117 309 -14 q 80 494 80 248 q 136 765 80 649 q 298 943 193 881 q 545 1006 404 1006 q 836 936 690 1006 l 768 765 q 656 811 712 791 q 545 831 600 831 m 650 -170 q 599 -295 650 -256 q 440 -334 548 -334 q 341 -319 388 -334 l 341 -205 q 391 -215 360 -210 q 438 -220 422 -220 q 487 -177 487 -220 q 375 -104 487 -121 l 428 0 l 559 0 l 540 -42 q 620 -92 590 -58 q 650 -170 650 -126 "},"Ŝ":{"x_min":63.75,"x_max":710.0625,"ha":765,"o":"m 710 275 q 613 63 710 140 q 344 -14 516 -14 q 63 45 185 -14 l 63 241 q 233 177 164 196 q 360 159 303 159 q 466 186 429 159 q 503 264 503 212 q 487 316 503 294 q 439 360 471 339 q 311 427 408 381 q 174 509 220 470 q 102 601 129 549 q 75 723 75 653 q 164 930 75 855 q 410 1006 253 1006 q 558 987 488 1006 q 705 936 628 969 l 637 772 q 506 818 558 805 q 404 831 454 831 q 312 803 344 831 q 280 730 280 775 q 293 682 280 702 q 334 641 306 661 q 467 572 362 622 q 658 438 606 505 q 710 275 710 372 m 562 1071 q 404 1189 456 1133 q 248 1071 351 1135 l 111 1071 l 111 1089 q 284 1293 239 1217 l 526 1293 q 599 1197 547 1257 q 700 1089 651 1136 l 700 1071 l 562 1071 "},"C":{"x_min":80.703125,"x_max":836.171875,"ha":885,"o":"m 545 831 q 362 741 427 831 q 297 492 297 652 q 545 160 297 160 q 798 213 650 160 l 798 36 q 526 -14 676 -14 q 195 117 309 -14 q 80 494 80 248 q 136 765 80 649 q 298 943 193 881 q 545 1006 404 1006 q 836 936 690 1006 l 768 765 q 656 811 712 791 q 545 831 600 831 "},"Ḁ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 651 -244 q 603 -362 651 -317 q 479 -407 555 -407 q 357 -363 403 -407 q 311 -245 311 -320 q 357 -128 311 -172 q 479 -85 403 -85 q 603 -129 554 -85 q 651 -244 651 -174 m 544 -245 q 526 -197 544 -215 q 479 -180 508 -180 q 433 -197 451 -180 q 414 -245 414 -215 q 431 -293 414 -276 q 479 -311 447 -311 q 526 -293 508 -311 q 544 -245 544 -276 "},"Ē":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 185 1214 l 645 1214 l 645 1071 l 185 1071 l 185 1214 "},"!":{"x_min":79.265625,"x_max":316.640625,"ha":397,"o":"m 282 329 l 116 329 l 81 992 l 316 992 l 282 329 m 79 97 q 109 183 79 154 q 198 212 140 212 q 285 182 254 212 q 316 97 316 152 q 285 12 316 43 q 198 -18 254 -18 q 110 12 141 -18 q 79 97 79 42 "},"ç":{"x_min":62.390625,"x_max":670.59375,"ha":714,"o":"m 416 -14 q 62 375 62 -14 q 158 670 62 568 q 434 773 254 773 q 670 721 566 773 l 609 561 q 518 593 560 581 q 434 606 476 606 q 273 376 273 606 q 434 153 273 153 q 545 169 494 153 q 646 219 596 185 l 646 42 q 545 -1 596 10 q 416 -14 494 -14 m 545 -170 q 494 -295 545 -256 q 335 -334 443 -334 q 236 -319 283 -334 l 236 -205 q 286 -215 255 -210 q 333 -220 317 -220 q 382 -177 382 -220 q 270 -104 382 -121 l 323 0 l 454 0 l 435 -42 q 515 -92 485 -58 q 545 -170 545 -126 "},"Ĵ":{"x_min":-103.09375,"x_max":526.515625,"ha":460,"o":"m 21 -291 q -103 -276 -50 -291 l -103 -101 q -4 -114 -48 -114 q 94 -71 65 -114 q 124 63 124 -28 l 124 992 l 335 992 l 335 64 q 255 -200 335 -109 q 21 -291 176 -291 m 388 1071 q 230 1189 282 1133 q 74 1071 177 1135 l -62 1071 l -62 1089 q 110 1293 65 1217 l 352 1293 q 425 1197 373 1257 q 526 1089 477 1136 l 526 1071 l 388 1071 "},"Ẻ":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 589 1237 q 479 1104 589 1131 l 472 1056 l 354 1056 l 339 1155 q 408 1180 389 1163 q 426 1223 426 1198 q 412 1256 426 1245 q 374 1268 398 1268 q 280 1252 330 1268 l 280 1366 q 336 1377 301 1373 q 400 1382 372 1382 q 542 1344 495 1382 q 589 1237 589 1306 "},"È":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 429 1071 q 304 1167 386 1100 q 175 1278 221 1234 l 175 1293 l 407 1293 q 566 1089 449 1224 l 566 1071 l 429 1071 "},"X":{"x_min":0,"x_max":926,"ha":926,"o":"m 926 0 l 685 0 l 455 375 l 225 0 l 0 0 l 328 511 l 21 992 l 252 992 l 466 635 l 675 992 l 902 992 l 591 500 l 926 0 "},"ô":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 585 842 q 427 960 479 904 q 271 842 374 906 l 134 842 l 134 860 q 307 1064 262 988 l 549 1064 q 622 968 570 1028 q 723 860 674 907 l 723 842 l 585 842 "},"Ė":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 305 1164 q 418 1265 305 1265 q 530 1164 530 1265 q 502 1089 530 1116 q 418 1063 474 1063 q 305 1164 305 1063 "},"Ā":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 251 1214 l 711 1214 l 711 1071 l 251 1071 l 251 1214 "},"ċ":{"x_min":62.390625,"x_max":670.59375,"ha":714,"o":"m 416 -14 q 62 375 62 -14 q 158 670 62 568 q 434 773 254 773 q 670 721 566 773 l 609 561 q 518 593 560 581 q 434 606 476 606 q 273 376 273 606 q 434 153 273 153 q 545 169 494 153 q 646 219 596 185 l 646 42 q 545 -1 596 10 q 416 -14 494 -14 m 313 954 q 426 1055 313 1055 q 538 954 538 1055 q 510 879 538 906 q 426 853 482 853 q 313 954 313 853 "},"đ":{"x_min":62.390625,"x_max":875.90625,"ha":901,"o":"m 341 -14 q 136 83 211 -14 q 62 356 62 181 q 129 638 62 547 q 348 730 196 730 q 478 701 421 730 q 572 618 536 673 l 578 618 q 563 776 563 707 l 563 811 l 349 811 l 349 946 l 563 946 l 563 1055 l 770 1055 l 770 946 l 875 946 l 875 811 l 770 811 l 770 0 l 602 0 l 559 97 l 551 97 q 341 -14 480 -14 m 429 150 q 539 192 503 150 q 577 335 574 234 l 577 354 q 543 518 577 474 q 418 561 509 561 q 315 515 343 561 q 287 353 287 468 q 321 201 287 252 q 429 150 355 150 "},"ấ":{"x_min":58.328125,"x_max":866.65625,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 669 842 l 560 842 q 417 954 484 892 q 273 842 339 886 l 164 842 l 164 860 q 309 1050 239 948 l 523 1050 q 605 939 559 997 q 669 860 650 881 l 669 842 m 609 991 q 703 1128 667 1053 l 866 1128 l 866 1113 q 712 974 821 1053 l 609 974 l 609 991 "},"Ẃ":{"x_min":0,"x_max":1343,"ha":1343,"o":"m 1090 0 l 851 0 l 716 521 q 691 636 709 549 q 670 753 673 723 q 650 635 666 716 q 625 519 634 554 l 491 0 l 253 0 l 0 992 l 206 992 l 333 450 q 381 190 366 300 q 400 310 385 229 q 427 436 415 391 l 572 992 l 771 992 l 915 436 q 939 322 925 398 q 961 190 953 245 q 982 322 967 243 q 1009 450 997 401 l 1136 992 l 1343 992 l 1090 0 m 525 1071 l 525 1089 q 684 1293 641 1224 l 916 1293 l 916 1278 q 796 1174 881 1243 q 662 1071 710 1104 l 525 1071 "},"Ŀ":{"x_min":124.796875,"x_max":737.53125,"ha":785,"o":"m 124 0 l 124 992 l 335 992 l 335 173 l 737 173 l 737 0 l 124 0 m 478 509 q 591 610 478 610 q 703 509 703 610 q 675 434 703 461 q 591 408 647 408 q 478 509 478 408 "},"ț":{"x_min":31.890625,"x_max":558.234375,"ha":603,"o":"m 427 150 q 558 174 482 150 l 558 20 q 368 -14 480 -14 q 187 48 244 -14 q 130 237 130 111 l 130 602 l 31 602 l 31 690 l 145 759 l 205 919 l 337 919 l 337 758 l 550 758 l 550 602 l 337 602 l 337 236 q 362 171 337 192 q 427 150 387 150 m 203 -288 q 226 -191 213 -255 q 245 -85 240 -128 l 436 -85 l 436 -98 q 324 -307 386 -212 l 203 -307 l 203 -288 "},"ŋ":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 562 -334 q 437 -317 489 -334 l 437 -154 q 518 -167 477 -167 q 601 -51 601 -167 l 601 458 q 479 607 601 607 q 354 549 392 607 q 315 357 315 491 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 307 661 q 400 744 341 715 q 539 773 460 773 q 740 701 671 773 q 808 494 808 629 l 808 -82 q 744 -268 808 -203 q 562 -334 681 -334 "},"}":{"x_min":55.609375,"x_max":526,"ha":547,"o":"m 352 -30 q 324 -145 352 -106 q 232 -202 297 -184 q 55 -220 168 -220 l 55 -66 q 148 -42 122 -65 q 173 28 173 -19 l 173 231 l 173 239 q 213 334 173 297 q 331 381 253 370 l 331 390 q 173 540 177 413 l 173 743 q 148 814 173 791 q 55 839 123 837 l 55 992 q 233 974 168 992 q 325 917 297 956 q 352 803 352 877 l 352 587 l 352 580 q 394 495 352 523 q 526 466 435 466 l 526 304 q 396 276 441 304 q 352 183 352 248 l 352 -30 "},"â":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 571 841 q 413 959 465 903 q 257 841 360 905 l 120 841 l 120 859 q 293 1063 248 987 l 535 1063 q 608 967 556 1027 q 709 859 660 906 l 709 841 l 571 841 "},"ø":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 269 16 342 -14 l 223 -51 l 119 19 l 165 87 q 62 380 62 193 q 159 669 62 566 q 432 773 256 773 q 600 737 521 773 l 637 793 l 740 720 l 701 663 q 797 380 797 557 m 273 380 q 286 267 273 316 l 501 590 q 429 606 472 606 q 309 550 346 606 q 273 380 273 494 m 586 380 q 577 476 586 435 l 368 162 q 430 152 394 152 q 549 209 513 152 q 586 380 586 267 "},"‰":{"x_min":42.734375,"x_max":1736.265625,"ha":1779,"o":"m 213 694 q 228 565 213 608 q 278 523 244 523 q 343 694 343 523 q 278 864 343 864 q 228 822 244 864 q 213 694 213 780 m 514 695 q 453 461 514 539 q 276 383 393 383 q 103 463 164 383 q 42 695 42 543 q 276 1006 42 1006 q 452 925 391 1006 q 514 695 514 845 m 980 992 l 430 0 l 267 0 l 817 992 l 980 992 m 907 298 q 923 170 907 212 q 972 127 938 127 q 1037 298 1037 127 q 972 468 1037 468 q 923 426 938 468 q 907 298 907 384 m 1208 300 q 1147 66 1208 144 q 970 -12 1087 -12 q 797 68 858 -12 q 736 300 736 148 q 970 610 736 610 q 1146 529 1085 610 q 1208 300 1208 449 m 1436 298 q 1451 170 1436 212 q 1500 127 1466 127 q 1565 298 1565 127 q 1500 468 1565 468 q 1451 426 1466 468 q 1436 298 1436 384 m 1736 300 q 1676 66 1736 145 q 1498 -12 1616 -12 q 1326 68 1387 -12 q 1265 300 1265 148 q 1498 610 1265 610 q 1674 529 1613 610 q 1736 300 1736 449 m 1251 0 l 1251 0 "},"Ä":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 247 1182 q 272 1250 247 1226 q 341 1273 298 1273 q 411 1248 386 1273 q 437 1182 437 1223 q 411 1116 437 1141 q 341 1092 385 1092 q 272 1115 298 1092 q 247 1182 247 1139 m 520 1182 q 547 1251 520 1229 q 615 1273 575 1273 q 686 1249 659 1273 q 712 1182 712 1224 q 685 1116 712 1140 q 615 1092 659 1092 q 547 1114 575 1092 q 520 1182 520 1136 "},"Ỵ":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 319 -190 q 432 -89 319 -89 q 544 -190 544 -89 q 516 -265 544 -238 q 432 -291 487 -291 q 319 -190 319 -291 "},"ř":{"x_min":56.140625,"x_max":645.515625,"ha":631,"o":"m 531 773 q 601 766 574 773 l 586 572 q 525 579 561 579 q 370 528 426 579 q 315 386 315 477 l 315 0 l 108 0 l 108 758 l 265 758 l 295 631 l 305 631 q 401 734 341 695 q 531 773 461 773 m 645 1064 l 645 1045 q 540 932 588 988 q 471 842 492 875 l 229 842 q 173 918 210 873 q 56 1045 136 962 l 56 1064 l 193 1064 q 349 945 293 1001 q 507 1064 406 1003 l 645 1064 "},"—":{"x_min":55.609375,"x_max":1333.390625,"ha":1389,"o":"m 55 296 l 55 452 l 1333 452 l 1333 296 l 55 296 "},"N":{"x_min":124.796875,"x_max":1004.21875,"ha":1129,"o":"m 1004 0 l 737 0 l 305 750 l 299 750 q 312 466 312 551 l 312 0 l 124 0 l 124 992 l 389 992 l 820 249 l 825 249 q 814 522 814 442 l 814 992 l 1004 992 l 1004 0 "},"⁄":{"x_min":-266.546875,"x_max":445.59375,"ha":180,"o":"m 445 992 l -104 0 l -266 0 l 283 992 l 445 992 "},"2":{"x_min":52.921875,"x_max":748.90625,"ha":793,"o":"m 748 0 l 55 0 l 55 145 l 304 397 q 449 554 415 510 q 497 635 483 598 q 512 712 512 672 q 479 801 512 772 q 392 831 447 831 q 280 804 334 831 q 166 729 225 778 l 52 864 q 174 952 126 926 q 279 992 222 978 q 407 1006 336 1006 q 571 972 499 1006 q 681 877 642 938 q 721 737 721 816 q 697 608 721 668 q 622 485 672 548 q 444 305 571 422 l 316 185 l 316 176 l 748 176 l 748 0 "},"ü":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 221 953 q 246 1021 221 997 q 315 1044 272 1044 q 385 1019 360 1044 q 411 953 411 994 q 385 887 411 912 q 315 863 359 863 q 246 886 272 863 q 221 953 221 910 m 494 953 q 521 1022 494 1000 q 589 1044 549 1044 q 660 1020 633 1044 q 686 953 686 995 q 659 887 686 911 q 589 863 633 863 q 521 885 549 863 q 494 953 494 907 "},"˜":{"x_min":140.375,"x_max":702.640625,"ha":843,"o":"m 309 913 q 269 894 288 913 q 241 840 250 876 l 140 840 q 196 994 147 938 q 324 1050 244 1050 q 379 1038 352 1050 q 432 1014 406 1027 q 483 989 458 1000 q 533 978 508 978 q 573 996 554 978 q 601 1051 592 1014 l 702 1051 q 646 896 695 952 q 518 841 596 841 q 463 852 490 841 q 410 877 436 863 q 359 901 384 890 q 309 913 334 913 "},"Ó":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 446 1071 l 446 1089 q 605 1293 562 1224 l 837 1293 l 837 1278 q 717 1174 802 1243 q 583 1071 631 1104 l 446 1071 "}," ":{"x_min":0,"x_max":0,"ha":695},"ˇ":{"x_min":126.140625,"x_max":715.515625,"ha":843,"o":"m 715 1064 l 715 1045 q 610 932 658 988 q 541 842 562 875 l 299 842 q 243 918 280 873 q 126 1045 206 962 l 126 1064 l 263 1064 q 419 945 363 1001 q 577 1064 476 1003 l 715 1064 "},"Ÿ":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 201 1182 q 226 1250 201 1226 q 295 1273 252 1273 q 365 1248 340 1273 q 391 1182 391 1223 q 365 1116 391 1141 q 295 1092 339 1092 q 226 1115 252 1092 q 201 1182 201 1139 m 474 1182 q 501 1251 474 1229 q 569 1273 529 1273 q 640 1249 613 1273 q 666 1182 666 1224 q 639 1116 666 1140 q 569 1092 613 1092 q 501 1114 529 1092 q 474 1182 474 1136 "},"ų":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 664 -154 q 680 -196 664 -182 q 719 -209 695 -209 q 796 -197 756 -209 l 796 -318 q 691 -334 741 -334 q 568 -290 614 -334 q 521 -177 521 -247 q 547 -92 521 -132 q 643 0 573 -52 l 765 0 q 691 -81 717 -44 q 664 -154 664 -118 "},"Ŭ":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 791 1300 q 708 1133 783 1195 q 521 1071 634 1071 q 333 1132 403 1071 q 257 1300 263 1194 l 373 1300 q 391 1249 375 1268 q 436 1223 407 1231 q 523 1215 465 1215 q 673 1300 662 1215 l 791 1300 "},"ĝ":{"x_min":4.0625,"x_max":768.71875,"ha":785,"o":"m 768 759 l 768 653 l 650 623 q 682 508 682 572 q 597 318 682 386 q 360 250 512 250 l 323 252 l 293 255 q 261 201 261 230 q 375 156 261 156 l 504 156 q 694 102 628 156 q 759 -54 759 49 q 648 -260 759 -187 q 330 -334 538 -334 q 87 -278 171 -334 q 4 -123 4 -223 q 46 -9 4 -55 q 172 56 89 36 q 116 100 140 70 q 92 166 92 131 q 118 238 92 209 q 190 295 143 267 q 95 378 130 321 q 61 512 61 435 q 141 705 61 637 q 372 773 222 773 q 448 767 404 773 q 504 759 491 761 l 768 759 m 183 -107 q 224 -174 183 -150 q 339 -199 265 -199 q 513 -168 450 -199 q 576 -85 576 -138 q 539 -26 576 -42 q 424 -10 502 -10 l 316 -10 q 221 -36 259 -10 q 183 -107 183 -63 m 258 510 q 286 412 258 448 q 372 376 314 376 q 458 412 430 376 q 485 510 485 448 q 372 647 485 647 q 258 510 258 647 m 553 842 q 395 960 447 904 q 239 842 342 906 l 102 842 l 102 860 q 275 1064 230 988 l 517 1064 q 590 968 538 1028 q 691 860 642 907 l 691 842 l 553 842 "},"ß":{"x_min":108.515625,"x_max":939.15625,"ha":988,"o":"m 847 841 q 833 765 847 798 q 797 706 819 732 q 750 661 775 680 q 703 625 725 641 q 667 594 681 609 q 653 565 653 580 q 671 529 653 547 q 734 484 689 511 q 868 389 833 423 q 921 315 904 356 q 939 220 939 273 q 860 45 939 104 q 626 -14 781 -14 q 510 -4 559 -14 q 421 28 462 5 l 421 192 q 513 151 457 168 q 612 134 569 134 q 726 218 726 134 q 716 263 726 245 q 677 300 705 280 q 599 349 649 321 q 480 439 513 398 q 447 534 447 479 q 470 613 447 577 q 542 683 494 649 q 615 747 594 720 q 636 805 636 774 q 593 874 636 846 q 482 901 550 901 q 359 865 403 901 q 315 765 315 830 l 315 0 l 108 0 l 108 772 q 207 986 108 909 q 482 1063 307 1063 q 747 1002 648 1063 q 847 841 847 942 "},"Ể":{"x_min":124.796875,"x_max":799.625,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 799 1335 q 714 1241 799 1258 l 710 1200 l 624 1200 l 617 1278 q 677 1290 655 1280 q 699 1320 699 1301 q 687 1345 699 1335 q 645 1355 674 1355 q 596 1348 621 1355 l 596 1434 q 659 1439 611 1439 q 761 1414 722 1439 q 799 1335 799 1390 m 663 1071 l 554 1071 q 411 1183 478 1121 q 267 1071 333 1115 l 158 1071 l 158 1089 q 303 1279 233 1177 l 517 1279 q 599 1168 553 1226 q 663 1089 644 1110 l 663 1071 "},"s":{"x_min":62.390625,"x_max":637.09375,"ha":690,"o":"m 637 224 q 556 47 637 108 q 313 -14 475 -14 q 172 -2 231 -14 q 63 30 114 8 l 63 201 q 193 155 121 173 q 320 137 265 137 q 432 202 432 137 q 418 242 432 226 q 366 276 403 257 q 269 322 329 296 q 140 390 181 358 q 81 461 99 421 q 62 561 62 502 q 140 717 62 662 q 362 773 218 773 q 628 713 499 773 l 566 564 q 460 604 509 588 q 359 619 410 619 q 267 570 267 619 q 297 521 267 542 q 426 461 326 501 q 556 394 515 425 q 617 322 597 362 q 637 224 637 281 "},"ẳ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 519 1128 q 503 1071 519 1093 q 449 1036 486 1049 l 445 1009 l 372 1009 l 366 1083 q 413 1097 400 1089 q 427 1123 427 1106 q 387 1150 427 1150 q 331 1145 351 1150 l 331 1215 q 393 1220 346 1220 q 486 1197 452 1220 q 519 1128 519 1174 m 277 1071 q 321 988 282 1020 q 420 955 359 955 q 519 985 482 955 q 563 1071 557 1014 l 664 1071 q 595 899 658 957 q 421 842 532 842 q 246 902 312 842 q 172 1071 180 963 l 277 1071 "},"Ű":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 298 1071 l 298 1089 q 378 1206 340 1146 q 430 1293 416 1265 l 634 1293 l 634 1278 q 535 1175 612 1242 q 408 1071 458 1107 l 298 1071 m 567 1071 l 567 1089 q 700 1293 662 1219 l 904 1293 l 904 1278 q 819 1187 887 1249 q 677 1071 750 1125 l 567 1071 "},"?":{"x_min":4.078125,"x_max":629.75,"ha":663,"o":"m 187 329 l 187 379 q 215 492 187 444 q 317 594 243 540 q 411 677 388 645 q 433 748 433 709 q 401 816 433 793 q 310 839 368 839 q 78 772 208 839 l 4 921 q 325 1006 155 1006 q 547 938 464 1006 q 629 759 629 871 q 595 630 629 685 q 466 508 561 576 q 384 435 401 460 q 367 369 367 410 l 367 329 l 187 329 m 165 97 q 196 183 165 154 q 285 212 226 212 q 372 182 341 212 q 403 97 403 152 q 371 12 403 43 q 285 -18 340 -18 q 196 12 228 -18 q 165 97 165 42 "},"ỡ":{"x_min":62.390625,"x_max":1007.171875,"ha":943,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 575 749 508 773 q 691 679 643 726 q 792 873 792 709 l 997 873 l 1007 858 q 959 713 988 767 q 881 624 929 660 q 762 570 833 587 q 797 380 797 485 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 860 0 l 860 0 m 323 913 q 283 894 302 913 q 255 840 264 876 l 154 840 q 210 994 161 938 q 338 1050 258 1050 q 393 1038 366 1050 q 446 1014 420 1027 q 497 989 472 1000 q 547 978 522 978 q 587 996 568 978 q 615 1051 606 1014 l 716 1051 q 660 896 709 952 q 532 841 610 841 q 477 852 504 841 q 424 877 450 863 q 373 901 398 890 q 323 913 348 913 "},"Ņ":{"x_min":124.796875,"x_max":1004.21875,"ha":1129,"o":"m 1004 0 l 737 0 l 305 750 l 299 750 q 312 466 312 551 l 312 0 l 124 0 l 124 992 l 389 992 l 820 249 l 825 249 q 814 522 814 442 l 814 992 l 1004 992 l 1004 0 m 405 -288 q 428 -191 415 -255 q 447 -85 442 -128 l 638 -85 l 638 -98 q 526 -307 588 -212 l 405 -307 l 405 -288 "},"c":{"x_min":62.390625,"x_max":670.59375,"ha":714,"o":"m 416 -14 q 62 375 62 -14 q 158 670 62 568 q 434 773 254 773 q 670 721 566 773 l 609 561 q 518 593 560 581 q 434 606 476 606 q 273 376 273 606 q 434 153 273 153 q 545 169 494 153 q 646 219 596 185 l 646 42 q 545 -1 596 10 q 416 -14 494 -14 "},"¶":{"x_min":76.78125,"x_max":791.859375,"ha":910,"o":"m 791 -176 l 682 -176 l 682 919 l 570 919 l 570 -176 l 460 -176 l 460 379 q 361 367 418 367 q 145 451 214 367 q 76 706 76 536 q 150 968 76 882 q 382 1055 224 1055 l 791 1055 l 791 -176 "},"Ī":{"x_min":1.9375,"x_max":461.765625,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 1 1214 l 461 1214 l 461 1071 l 1 1071 l 1 1214 "},"•":{"x_min":66.4375,"x_max":455.734375,"ha":522,"o":"m 66 506 q 116 666 66 611 q 261 722 166 722 q 404 666 354 722 q 455 506 455 610 q 404 347 455 403 q 261 291 353 291 q 116 347 167 291 q 66 506 66 403 "},"Ὅ":{"x_min":-270.078125,"x_max":1081.296875,"ha":1161,"o":"m 1081 496 q 959 118 1081 250 q 609 -14 837 -14 q 258 118 381 -14 q 136 498 136 250 q 259 876 136 745 q 610 1007 381 1007 q 960 875 839 1007 q 1081 496 1081 743 m 357 496 q 420 246 357 330 q 609 162 483 162 q 860 496 860 162 q 610 832 860 832 q 420 747 484 832 q 357 496 357 663 m -270 858 q -218 952 -270 914 q -71 1003 -166 990 l -71 952 q -144 925 -120 937 q -167 893 -167 912 q -155 874 -167 880 q -127 862 -142 868 q -99 848 -112 857 q -86 820 -86 839 q -108 780 -86 795 q -174 765 -129 765 q -244 790 -219 765 q -270 858 -270 815 m -35 788 l -22 834 q 20 993 5 933 l 197 993 l 197 979 q 57 771 169 915 l -35 771 l -35 788 "},"(":{"x_min":55.921875,"x_max":429.625,"ha":471,"o":"m 55 380 q 108 717 55 560 q 260 992 161 873 l 429 992 q 285 704 334 861 q 236 381 236 547 q 286 60 236 215 q 428 -220 336 -94 l 260 -220 q 108 49 160 -104 q 55 380 55 203 "},"Ụ":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 412 -190 q 525 -89 412 -89 q 637 -190 637 -89 q 609 -265 637 -238 q 525 -291 580 -291 q 412 -190 412 -291 "},"◊":{"x_min":59.703125,"x_max":748.9375,"ha":810,"o":"m 748 498 l 442 0 l 365 0 l 59 498 l 365 999 l 442 999 l 748 498 m 569 498 l 404 776 l 238 498 l 404 221 l 569 498 "},"Ỗ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 650 1292 q 600 1300 625 1292 q 550 1319 574 1309 q 503 1338 525 1329 q 461 1347 480 1347 q 419 1335 434 1347 q 396 1291 405 1324 l 319 1291 q 362 1410 325 1366 q 454 1455 398 1455 q 505 1446 479 1455 q 556 1426 532 1437 q 603 1407 580 1416 q 643 1398 625 1398 q 684 1410 671 1398 q 708 1456 698 1423 l 785 1456 q 740 1334 776 1377 q 650 1292 704 1292 m 804 1071 l 708 1071 q 551 1174 612 1119 q 394 1071 495 1124 l 298 1071 l 298 1089 q 458 1266 414 1200 l 644 1266 q 720 1174 677 1219 q 804 1089 764 1129 l 804 1071 "},"­":{"x_min":41.375,"x_max":405.625,"ha":447,"o":"m 41 287 l 41 457 l 405 457 l 405 287 l 41 287 "},"Ħ":{"x_min":0,"x_max":1063,"ha":1063,"o":"m 937 860 l 1063 860 l 1063 725 l 937 725 l 937 0 l 727 0 l 727 428 l 335 428 l 335 0 l 124 0 l 124 725 l 0 725 l 0 860 l 124 860 l 124 992 l 335 992 l 335 860 l 727 860 l 727 992 l 937 992 l 937 860 m 727 603 l 727 725 l 335 725 l 335 603 l 727 603 "},":":{"x_min":79.359375,"x_max":316.734375,"ha":396,"o":"m 79 97 q 109 183 79 154 q 198 212 140 212 q 285 182 255 212 q 316 97 316 152 q 285 12 316 43 q 198 -18 254 -18 q 110 12 141 -18 q 79 97 79 42 m 79 657 q 109 743 79 714 q 198 773 140 773 q 285 743 255 773 q 316 657 316 713 q 285 572 316 602 q 198 542 253 542 q 110 572 141 542 q 79 657 79 602 "},"Û":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 681 1071 q 523 1189 575 1133 q 367 1071 470 1135 l 230 1071 l 230 1089 q 403 1293 358 1217 l 645 1293 q 718 1197 666 1257 q 819 1089 770 1136 l 819 1071 l 681 1071 "},"Ầ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 226 1089 q 372 1279 302 1177 l 586 1279 q 662 1174 619 1230 q 732 1089 705 1119 l 732 1071 l 622 1071 q 479 1183 556 1115 q 336 1071 407 1118 l 226 1071 l 226 1089 m 286 1203 l 183 1203 q 29 1342 72 1283 l 29 1357 l 193 1357 q 286 1220 229 1281 l 286 1203 "},"ś":{"x_min":62.390625,"x_max":637.09375,"ha":690,"o":"m 637 224 q 556 47 637 108 q 313 -14 475 -14 q 172 -2 231 -14 q 63 30 114 8 l 63 201 q 193 155 121 173 q 320 137 265 137 q 432 202 432 137 q 418 242 432 226 q 366 276 403 257 q 269 322 329 296 q 140 390 181 358 q 81 461 99 421 q 62 561 62 502 q 140 717 62 662 q 362 773 218 773 q 628 713 499 773 l 566 564 q 460 604 509 588 q 359 619 410 619 q 267 570 267 619 q 297 521 267 542 q 426 461 326 501 q 556 394 515 425 q 617 322 597 362 q 637 224 637 281 m 232 842 l 232 860 q 391 1064 348 995 l 623 1064 l 623 1049 q 503 945 588 1014 q 369 842 417 875 l 232 842 "},"V":{"x_min":0,"x_max":903,"ha":903,"o":"m 690 992 l 903 992 l 565 0 l 336 0 l 0 992 l 212 992 l 398 401 q 431 279 414 349 q 451 183 447 210 q 502 401 459 245 l 690 992 "},"Ŗ":{"x_min":124.796875,"x_max":917,"ha":917,"o":"m 335 552 l 402 552 q 550 585 502 552 q 597 689 597 618 q 549 789 597 760 q 398 819 500 819 l 335 819 l 335 552 m 335 381 l 335 0 l 124 0 l 124 992 l 413 992 q 712 918 615 992 q 809 695 809 844 q 761 539 809 607 q 625 432 713 471 q 917 0 849 97 l 683 0 l 446 381 l 335 381 m 359 -288 q 382 -191 369 -255 q 401 -85 396 -128 l 592 -85 l 592 -98 q 480 -307 542 -212 l 359 -307 l 359 -288 "}," ":{"x_min":0,"x_max":0,"ha":361},"Ỹ":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 321 1142 q 281 1123 300 1142 q 253 1069 262 1105 l 152 1069 q 208 1223 159 1167 q 336 1279 256 1279 q 391 1267 364 1279 q 444 1243 418 1256 q 495 1218 470 1229 q 545 1207 520 1207 q 585 1225 566 1207 q 613 1280 604 1243 l 714 1280 q 658 1125 707 1181 q 530 1070 608 1070 q 475 1081 502 1070 q 422 1106 448 1092 q 371 1130 396 1119 q 321 1142 346 1142 "},"ʼ":{"x_min":16.953125,"x_max":284.859375,"ha":301,"o":"m 275 992 l 284 977 q 165 652 250 843 l 16 652 q 84 992 63 852 l 275 992 "},"@":{"x_min":69.1875,"x_max":1176.8125,"ha":1246,"o":"m 1176 509 q 1145 331 1176 412 q 1057 204 1114 250 q 925 158 1000 158 q 836 182 875 158 q 780 245 797 206 l 769 245 q 583 158 696 158 q 394 230 463 158 q 324 427 324 302 q 415 658 324 571 q 653 746 506 746 q 781 734 711 746 q 897 708 851 723 l 881 376 q 933 282 881 282 q 1002 345 976 282 q 1028 511 1028 408 q 982 704 1028 620 q 854 831 937 787 q 666 875 772 875 q 428 819 529 875 q 273 657 327 763 q 219 412 219 551 q 319 125 219 225 q 609 25 419 25 q 767 41 681 25 q 937 87 853 57 l 937 -42 q 615 -104 792 -104 q 213 31 357 -104 q 69 408 69 167 q 142 712 69 575 q 352 926 216 848 q 665 1004 488 1004 q 931 942 814 1004 q 1113 769 1049 881 q 1176 509 1176 656 m 482 425 q 598 282 482 282 q 691 325 659 282 q 730 465 723 368 l 739 615 q 661 622 704 622 q 529 569 576 622 q 482 425 482 516 "},"¾":{"x_min":61,"x_max":1160.84375,"ha":1224,"o":"m 472 846 q 357 712 472 749 l 357 703 q 456 652 420 690 q 491 562 491 615 q 431 433 491 480 q 246 386 372 386 q 61 433 149 386 l 61 562 q 244 501 161 501 q 341 573 341 501 q 311 627 341 609 q 229 645 281 645 l 153 645 l 153 754 l 215 754 q 299 771 271 754 q 326 827 326 789 q 309 870 326 853 q 258 887 292 887 q 197 874 226 887 q 130 834 169 861 l 62 930 q 155 982 104 961 q 276 1004 206 1004 q 417 960 362 1004 q 472 846 472 917 m 977 992 l 427 0 l 265 0 l 815 992 l 977 992 m 1160 103 l 1076 103 l 1076 0 l 914 0 l 914 103 l 655 103 l 655 207 l 916 599 l 1076 599 l 1076 217 l 1160 217 l 1160 103 m 914 217 l 914 328 q 918 453 914 386 q 894 398 912 435 q 866 346 876 362 l 780 217 l 914 217 "},"ŉ":{"x_min":3.953125,"x_max":978.546875,"ha":1082,"o":"m 978 0 l 771 0 l 771 443 q 742 566 771 525 q 649 607 713 607 q 524 549 562 607 q 485 357 485 491 l 485 0 l 278 0 l 278 758 l 436 758 l 464 661 l 475 661 q 571 744 510 716 q 709 773 631 773 q 910 701 841 773 q 978 494 978 629 l 978 0 m 262 992 l 271 977 q 152 652 237 843 l 3 652 q 71 992 50 852 l 262 992 "},"i":{"x_min":99.703125,"x_max":324.875,"ha":424,"o":"m 99 953 q 212 1055 99 1055 q 324 953 324 1055 q 296 879 324 905 q 212 852 268 852 q 99 953 99 852 m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 "},"ẽ":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 306 913 q 266 894 285 913 q 238 840 247 876 l 137 840 q 193 994 144 938 q 321 1050 241 1050 q 376 1038 349 1050 q 429 1014 403 1027 q 480 989 455 1000 q 530 978 505 978 q 570 996 551 978 q 598 1051 589 1014 l 699 1051 q 643 896 692 952 q 515 841 593 841 q 460 852 487 841 q 407 877 433 863 q 356 901 381 890 q 306 913 331 913 "},"Ģ":{"x_min":80.703125,"x_max":894.734375,"ha":1006,"o":"m 501 557 l 894 557 l 894 42 q 714 -1 799 11 q 541 -14 630 -14 q 199 117 317 -14 q 80 497 80 249 q 218 871 80 737 q 598 1006 355 1006 q 893 944 751 1006 l 823 776 q 597 831 714 831 q 379 739 461 831 q 297 492 297 647 q 363 246 297 331 q 555 160 429 160 q 689 174 621 160 l 689 382 l 501 382 l 501 557 m 426 -288 q 449 -191 436 -255 q 468 -85 463 -128 l 659 -85 l 659 -98 q 547 -307 609 -212 l 426 -307 l 426 -288 "},"m":{"x_min":108.515625,"x_max":1260.234375,"ha":1364,"o":"m 787 0 l 580 0 l 580 443 q 553 566 580 525 q 466 607 525 607 q 351 549 387 607 q 315 357 315 490 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 394 743 336 713 q 526 773 451 773 q 756 661 696 773 l 775 661 q 865 743 805 714 q 999 773 924 773 q 1194 706 1127 773 q 1260 494 1260 640 l 1260 0 l 1052 0 l 1052 443 q 1025 566 1052 525 q 938 607 997 607 q 825 553 862 607 q 787 380 787 498 l 787 0 "},"ĕ":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 687 1071 q 604 904 679 966 q 417 842 530 842 q 229 903 299 842 q 153 1071 159 965 l 269 1071 q 287 1020 271 1039 q 332 994 303 1002 q 419 986 361 986 q 569 1071 558 986 l 687 1071 "},"Ỉ":{"x_min":94.671875,"x_max":403.265625,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 403 1237 q 293 1104 403 1131 l 286 1056 l 168 1056 l 153 1155 q 222 1180 203 1163 q 240 1223 240 1198 q 226 1256 240 1245 q 188 1268 212 1268 q 94 1252 144 1268 l 94 1366 q 150 1377 115 1373 q 214 1382 186 1382 q 356 1344 309 1382 q 403 1237 403 1306 "},"ż":{"x_min":37.296875,"x_max":636.625,"ha":678,"o":"m 636 0 l 37 0 l 37 122 l 389 599 l 58 599 l 58 758 l 624 758 l 624 623 l 282 158 l 636 158 l 636 0 m 222 954 q 335 1055 222 1055 q 447 954 447 1055 q 419 879 447 906 q 335 853 391 853 q 222 954 222 853 "},"Ị":{"x_min":116.671875,"x_max":341.84375,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 116 -190 q 229 -89 116 -89 q 341 -190 341 -89 q 313 -265 341 -238 q 229 -291 284 -291 q 116 -190 116 -291 "},"ő":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 188 842 l 188 860 q 268 977 230 917 q 320 1064 306 1036 l 524 1064 l 524 1049 q 425 946 502 1013 q 298 842 348 878 l 188 842 m 457 842 l 457 860 q 590 1064 552 990 l 794 1064 l 794 1049 q 709 958 777 1020 q 567 842 640 896 l 457 842 "},"ž":{"x_min":37.296875,"x_max":645.515625,"ha":678,"o":"m 636 0 l 37 0 l 37 122 l 389 599 l 58 599 l 58 758 l 624 758 l 624 623 l 282 158 l 636 158 l 636 0 m 645 1064 l 645 1045 q 540 932 588 988 q 471 842 492 875 l 229 842 q 173 918 210 873 q 56 1045 136 962 l 56 1064 l 193 1064 q 349 945 293 1001 q 507 1064 406 1003 l 645 1064 "},"ự":{"x_min":104.453125,"x_max":1119.875,"ha":1055,"o":"m 645 0 l 617 96 l 605 96 q 512 15 573 44 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 679 q 879 743 852 693 q 905 872 905 793 l 1109 872 l 1119 857 q 1061 694 1098 751 q 962 602 1024 637 q 804 554 900 568 l 804 0 l 645 0 m 913 0 l 913 0 m 336 -190 q 449 -89 336 -89 q 561 -190 561 -89 q 533 -265 561 -238 q 449 -291 504 -291 q 336 -190 336 -291 "},"ớ":{"x_min":62.390625,"x_max":1007.171875,"ha":943,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 575 749 508 773 q 691 679 643 726 q 792 873 792 709 l 997 873 l 1007 858 q 959 713 988 767 q 881 624 929 660 q 762 570 833 587 q 797 380 797 485 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 860 0 l 860 0 m 310 842 l 310 860 q 469 1064 426 995 l 701 1064 l 701 1049 q 581 945 666 1014 q 447 842 495 875 l 310 842 "},"Ŏ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 821 1300 q 738 1133 813 1195 q 551 1071 664 1071 q 363 1132 433 1071 q 287 1300 293 1194 l 403 1300 q 421 1249 405 1268 q 466 1223 437 1231 q 553 1215 495 1215 q 703 1300 692 1215 l 821 1300 "},"á":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 299 842 l 299 860 q 458 1064 415 995 l 690 1064 l 690 1049 q 570 945 655 1014 q 436 842 484 875 l 299 842 "},"×":{"x_min":87.5625,"x_max":705.4375,"ha":793,"o":"m 290 490 l 87 694 l 190 799 l 394 596 l 601 799 l 705 697 l 498 490 l 702 285 l 601 181 l 394 386 l 190 183 l 88 286 l 290 490 "},"ẩ":{"x_min":58.328125,"x_max":808.625,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 808 1106 q 723 1012 808 1029 l 719 971 l 633 971 l 626 1049 q 686 1061 664 1051 q 708 1091 708 1072 q 696 1116 708 1106 q 654 1126 683 1126 q 605 1119 630 1126 l 605 1205 q 668 1210 620 1210 q 770 1185 731 1210 q 808 1106 808 1161 m 672 842 l 563 842 q 420 954 487 892 q 276 842 342 886 l 167 842 l 167 860 q 312 1050 242 948 l 526 1050 q 608 939 562 997 q 672 860 653 881 l 672 842 "},"İ":{"x_min":116.71875,"x_max":341.890625,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 116 1183 q 229 1284 116 1284 q 341 1183 341 1284 q 313 1108 341 1135 q 229 1082 285 1082 q 116 1183 116 1082 "},"Ě":{"x_min":119.140625,"x_max":708.515625,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 708 1293 l 708 1274 q 603 1161 651 1217 q 534 1071 555 1104 l 292 1071 q 236 1147 273 1102 q 119 1274 199 1191 l 119 1293 l 256 1293 q 412 1174 356 1230 q 570 1293 469 1232 l 708 1293 "},"Ố":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 799 1071 l 690 1071 q 547 1183 614 1121 q 403 1071 469 1115 l 294 1071 l 294 1089 q 439 1279 369 1177 l 653 1279 q 735 1168 689 1226 q 799 1089 780 1110 l 799 1071 m 739 1220 q 833 1357 797 1282 l 996 1357 l 996 1342 q 842 1203 951 1282 l 739 1203 l 739 1220 "},"Ǻ":{"x_min":0,"x_max":958,"ha":958,"o":"m 649 991 q 617 891 649 933 l 958 0 l 732 0 l 660 223 l 298 223 l 225 0 l 0 0 l 338 891 q 309 990 309 931 q 355 1107 309 1064 q 477 1151 402 1151 q 600 1107 551 1151 q 649 991 649 1063 m 616 400 l 547 596 q 479 798 488 752 q 420 617 466 750 l 344 400 l 616 400 m 395 1188 l 395 1199 q 463 1268 427 1227 q 513 1330 499 1309 l 745 1330 l 745 1321 q 668 1265 730 1304 q 532 1188 606 1225 l 395 1188 m 543 990 q 524 1037 543 1020 q 477 1055 506 1055 q 430 1037 449 1055 q 412 990 412 1020 q 470 925 412 927 l 483 925 q 526 943 509 926 q 543 990 543 960 "},"K":{"x_min":124.796875,"x_max":922,"ha":922,"o":"m 922 0 l 683 0 l 423 418 l 335 354 l 335 0 l 124 0 l 124 992 l 335 992 l 335 538 l 417 654 l 685 992 l 919 992 l 573 553 l 922 0 "},"7":{"x_min":37.3125,"x_max":748.90625,"ha":793,"o":"m 154 0 l 526 813 l 37 813 l 37 990 l 748 990 l 748 858 l 373 0 l 154 0 "},"¨":{"x_min":189.21875,"x_max":654.15625,"ha":843,"o":"m 189 953 q 214 1021 189 997 q 283 1044 240 1044 q 353 1019 328 1044 q 379 953 379 994 q 353 887 379 912 q 283 863 327 863 q 214 886 240 863 q 189 953 189 910 m 462 953 q 489 1022 462 1000 q 557 1044 517 1044 q 628 1020 601 1044 q 654 953 654 995 q 627 887 654 911 q 557 863 601 863 q 489 885 517 863 q 462 953 462 907 "},"Y":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 "},"E":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 "},"Ô":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 709 1071 q 551 1189 603 1133 q 395 1071 498 1135 l 258 1071 l 258 1089 q 431 1293 386 1217 l 673 1293 q 746 1197 694 1257 q 847 1089 798 1136 l 847 1071 l 709 1071 "},"Ț":{"x_min":27.671875,"x_max":776.421875,"ha":804,"o":"m 507 0 l 296 0 l 296 817 l 27 817 l 27 992 l 776 992 l 776 817 l 507 817 l 507 0 m 265 -288 q 288 -191 275 -255 q 307 -85 302 -128 l 498 -85 l 498 -98 q 386 -307 448 -212 l 265 -307 l 265 -288 "},"‹":{"x_min":55.234375,"x_max":455.390625,"ha":511,"o":"m 55 388 l 306 697 l 455 616 l 266 380 l 455 144 l 306 64 l 55 371 l 55 388 "},"ổ":{"x_min":62.390625,"x_max":813.625,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 813 1106 q 728 1012 813 1029 l 724 971 l 638 971 l 631 1049 q 691 1061 669 1051 q 713 1091 713 1072 q 701 1116 713 1106 q 659 1126 688 1126 q 610 1119 635 1126 l 610 1205 q 673 1210 625 1210 q 775 1185 736 1210 q 813 1106 813 1161 m 677 842 l 568 842 q 425 954 492 892 q 281 842 347 886 l 172 842 l 172 860 q 317 1050 247 948 l 531 1050 q 613 939 567 997 q 677 860 658 881 l 677 842 "},"Ï":{"x_min":-1.78125,"x_max":463.15625,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m -1 1182 q 23 1250 -1 1226 q 92 1273 49 1273 q 162 1248 137 1273 q 188 1182 188 1223 q 162 1116 188 1141 q 92 1092 136 1092 q 23 1115 49 1092 q -1 1182 -1 1139 m 271 1182 q 298 1251 271 1229 q 366 1273 326 1273 q 437 1249 410 1273 q 463 1182 463 1224 q 436 1116 463 1140 q 366 1092 410 1092 q 298 1114 326 1092 q 271 1182 271 1136 "},"ġ":{"x_min":4.0625,"x_max":768.71875,"ha":785,"o":"m 768 759 l 768 653 l 650 623 q 682 508 682 572 q 597 318 682 386 q 360 250 512 250 l 323 252 l 293 255 q 261 201 261 230 q 375 156 261 156 l 504 156 q 694 102 628 156 q 759 -54 759 49 q 648 -260 759 -187 q 330 -334 538 -334 q 87 -278 171 -334 q 4 -123 4 -223 q 46 -9 4 -55 q 172 56 89 36 q 116 100 140 70 q 92 166 92 131 q 118 238 92 209 q 190 295 143 267 q 95 378 130 321 q 61 512 61 435 q 141 705 61 637 q 372 773 222 773 q 448 767 404 773 q 504 759 491 761 l 768 759 m 183 -107 q 224 -174 183 -150 q 339 -199 265 -199 q 513 -168 450 -199 q 576 -85 576 -138 q 539 -26 576 -42 q 424 -10 502 -10 l 316 -10 q 221 -36 259 -10 q 183 -107 183 -63 m 258 510 q 286 412 258 448 q 372 376 314 376 q 458 412 430 376 q 485 510 485 448 q 372 647 485 647 q 258 510 258 647 m 278 954 q 391 1055 278 1055 q 503 954 503 1055 q 475 879 503 906 q 391 853 447 853 q 278 954 278 853 "},"Ẳ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 580 1357 q 564 1300 580 1322 q 510 1265 547 1278 l 506 1238 l 433 1238 l 427 1312 q 474 1326 461 1318 q 488 1352 488 1335 q 448 1379 488 1379 q 392 1374 412 1379 l 392 1444 q 454 1449 407 1449 q 547 1426 513 1449 q 580 1357 580 1403 m 338 1300 q 382 1217 343 1249 q 481 1184 420 1184 q 580 1214 543 1184 q 624 1300 618 1243 l 725 1300 q 656 1128 719 1186 q 482 1071 593 1071 q 307 1131 373 1071 q 233 1300 241 1192 l 338 1300 "},"ứ":{"x_min":104.453125,"x_max":1119.875,"ha":1055,"o":"m 645 0 l 617 96 l 605 96 q 512 15 573 44 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 679 q 879 743 852 693 q 905 872 905 793 l 1109 872 l 1119 857 q 1061 694 1098 751 q 962 602 1024 637 q 804 554 900 568 l 804 0 l 645 0 m 913 0 l 913 0 m 340 842 l 340 860 q 499 1064 456 995 l 731 1064 l 731 1049 q 611 945 696 1014 q 477 842 525 875 l 340 842 "},"ủ":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 624 1008 q 514 875 624 902 l 507 827 l 389 827 l 374 926 q 443 951 424 934 q 461 994 461 969 q 447 1027 461 1016 q 409 1039 433 1039 q 315 1023 365 1039 l 315 1137 q 371 1148 336 1144 q 435 1153 407 1153 q 577 1115 530 1153 q 624 1008 624 1077 "},"Ằ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 547 1247 l 458 1247 q 318 1387 387 1305 l 318 1402 l 468 1402 q 547 1265 500 1336 l 547 1247 m 338 1300 q 382 1217 343 1249 q 481 1184 420 1184 q 580 1214 543 1184 q 624 1300 618 1243 l 725 1300 q 656 1128 719 1186 q 482 1071 593 1071 q 307 1131 373 1071 q 233 1300 241 1192 l 338 1300 "},"ķ":{"x_min":108.515625,"x_max":861,"ha":861,"o":"m 307 412 l 397 527 l 609 758 l 842 758 l 541 429 l 861 0 l 622 0 l 404 307 l 315 235 l 315 0 l 108 0 l 108 1055 l 315 1055 l 315 584 l 304 412 l 307 412 m 316 -288 q 339 -191 326 -255 q 358 -85 353 -128 l 549 -85 l 549 -98 q 437 -307 499 -212 l 316 -307 l 316 -288 "},"Ấ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 732 1071 l 623 1071 q 480 1183 547 1121 q 336 1071 402 1115 l 227 1071 l 227 1089 q 372 1279 302 1177 l 586 1279 q 668 1168 622 1226 q 732 1089 713 1110 l 732 1071 m 672 1220 q 766 1357 730 1282 l 929 1357 l 929 1342 q 775 1203 884 1282 l 672 1203 l 672 1220 "}," ":{"x_min":0,"x_max":0,"ha":463},"ể":{"x_min":62.390625,"x_max":809.625,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 809 1106 q 724 1012 809 1029 l 720 971 l 634 971 l 627 1049 q 687 1061 665 1051 q 709 1091 709 1072 q 697 1116 709 1106 q 655 1126 684 1126 q 606 1119 631 1126 l 606 1205 q 669 1210 621 1210 q 771 1185 732 1210 q 809 1106 809 1161 m 673 842 l 564 842 q 421 954 488 892 q 277 842 343 886 l 168 842 l 168 860 q 313 1050 243 948 l 527 1050 q 609 939 563 997 q 673 860 654 881 l 673 842 "},"±":{"x_min":59.75,"x_max":733.21875,"ha":793,"o":"m 322 457 l 59 457 l 59 606 l 322 606 l 322 869 l 470 869 l 470 606 l 733 606 l 733 457 l 470 457 l 470 196 l 322 196 l 322 457 m 59 0 l 59 148 l 733 148 l 733 0 l 59 0 "},"ì":{"x_min":-68.84375,"x_max":322.484375,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 185 842 q 60 938 142 871 q -68 1049 -22 1005 l -68 1064 l 163 1064 q 322 860 205 995 l 322 842 l 185 842 "},"|":{"x_min":308.578125,"x_max":457.109375,"ha":765,"o":"m 308 1051 l 457 1051 l 457 -315 l 308 -315 l 308 1051 "},"§":{"x_min":71.90625,"x_max":607.15625,"ha":675,"o":"m 82 546 q 106 644 82 599 q 172 715 130 688 q 82 873 82 772 q 157 1016 82 962 q 356 1070 233 1070 q 603 1013 472 1070 l 547 884 q 453 923 501 905 q 352 940 405 940 q 272 924 297 940 q 247 876 247 909 q 281 818 247 843 q 392 762 314 793 q 554 661 502 719 q 607 530 607 604 q 522 353 607 410 q 585 291 564 326 q 607 205 607 255 q 526 45 607 104 q 308 -14 445 -14 q 71 39 170 -14 l 71 179 q 194 132 126 152 q 308 113 261 113 q 440 192 440 113 q 427 235 440 219 q 384 269 415 252 q 299 309 354 286 q 128 413 175 359 q 82 546 82 466 m 233 560 q 277 480 233 515 q 400 413 321 444 q 453 512 453 452 q 418 590 453 558 q 294 656 384 622 q 251 619 269 646 q 233 560 233 592 "},"˳":{"x_min":59.84375,"x_max":399.84375,"ha":463,"o":"m 399 -244 q 351 -362 399 -317 q 227 -407 303 -407 q 105 -363 151 -407 q 59 -245 59 -320 q 105 -128 59 -172 q 227 -85 151 -85 q 351 -129 302 -85 q 399 -244 399 -174 m 292 -245 q 274 -197 292 -215 q 227 -180 256 -180 q 181 -197 199 -180 q 162 -245 162 -215 q 179 -293 162 -276 q 227 -311 195 -311 q 274 -293 256 -311 q 292 -245 292 -276 "},"q":{"x_min":62.390625,"x_max":771.15625,"ha":879,"o":"m 422 148 q 537 193 501 148 q 577 351 574 238 l 577 376 q 540 551 577 498 q 419 604 502 604 q 273 375 273 604 q 309 204 273 260 q 422 148 345 148 m 348 -14 q 138 89 214 -14 q 62 377 62 193 q 140 668 62 563 q 352 773 217 773 q 478 745 424 773 q 572 661 531 718 l 577 661 l 596 758 l 771 758 l 771 -334 l 563 -334 l 563 -15 q 572 98 563 25 l 563 98 q 475 14 530 43 q 348 -14 420 -14 "},"b":{"x_min":108.515625,"x_max":816.59375,"ha":879,"o":"m 530 773 q 740 668 664 773 q 816 380 816 563 q 738 89 816 192 q 524 -14 659 -14 q 315 83 391 -14 l 301 83 l 266 0 l 108 0 l 108 1055 l 315 1055 l 315 809 q 307 660 315 763 l 315 660 q 530 773 387 773 m 463 607 q 352 560 387 607 q 315 404 316 513 l 315 381 q 351 206 315 259 q 466 153 387 153 q 568 212 530 153 q 605 383 605 271 q 567 551 605 495 q 463 607 529 607 "},"ộ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 317 -190 q 430 -89 317 -89 q 542 -190 542 -89 q 514 -265 542 -238 q 430 -291 485 -291 q 317 -190 317 -291 m 585 842 q 427 960 479 904 q 271 842 374 906 l 134 842 l 134 860 q 307 1064 262 988 l 549 1064 q 622 968 570 1028 q 723 860 674 907 l 723 842 l 585 842 "},"®":{"x_min":67.84375,"x_max":1088.15625,"ha":1156,"o":"m 784 613 q 687 455 784 498 l 848 184 l 676 184 l 555 413 l 523 413 l 523 184 l 368 184 l 368 806 l 547 806 q 727 758 670 806 q 784 613 784 710 m 523 527 l 544 527 q 608 547 589 527 q 628 611 628 566 q 609 673 628 655 q 543 692 590 692 l 523 692 l 523 527 m 67 495 q 135 750 67 631 q 322 937 203 868 q 578 1006 440 1006 q 832 938 713 1006 q 1019 751 951 870 q 1088 495 1088 632 q 1022 244 1088 361 q 837 56 956 127 q 578 -14 719 -14 q 318 56 437 -14 q 133 243 200 126 q 67 495 67 361 m 164 495 q 219 288 164 384 q 371 136 275 192 q 577 81 468 81 q 785 137 689 81 q 936 289 881 192 q 991 495 991 385 q 936 703 991 606 q 784 854 880 799 q 577 909 687 909 q 370 854 466 909 q 219 702 274 798 q 164 495 164 605 "},"Ŋ":{"x_min":124.796875,"x_max":1004.21875,"ha":1129,"o":"m 688 -292 q 555 -277 611 -292 l 555 -102 q 667 -115 618 -115 q 781 -84 741 -115 q 827 2 821 -53 l 305 750 l 299 750 q 312 466 312 551 l 312 0 l 124 0 l 124 992 l 389 992 l 820 387 l 825 387 l 819 489 q 814 661 814 563 l 814 992 l 1004 992 l 1004 0 q 922 -216 1004 -140 q 688 -292 840 -292 "},"ọ":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 315 -190 q 428 -89 315 -89 q 540 -190 540 -89 q 512 -265 540 -238 q 428 -291 483 -291 q 315 -190 315 -291 "},"Ũ":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 415 1142 q 375 1123 394 1142 q 347 1069 356 1105 l 246 1069 q 302 1223 253 1167 q 430 1279 350 1279 q 485 1267 458 1279 q 538 1243 512 1256 q 589 1218 564 1229 q 639 1207 614 1207 q 679 1225 660 1207 q 707 1280 698 1243 l 808 1280 q 752 1125 801 1181 q 624 1070 702 1070 q 569 1081 596 1070 q 516 1106 542 1092 q 465 1130 490 1119 q 415 1142 440 1142 "},"L":{"x_min":124.796875,"x_max":737.53125,"ha":785,"o":"m 124 0 l 124 992 l 335 992 l 335 173 l 737 173 l 737 0 l 124 0 "},"ế":{"x_min":62.390625,"x_max":870.65625,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 673 842 l 564 842 q 421 954 488 892 q 277 842 343 886 l 168 842 l 168 860 q 313 1050 243 948 l 527 1050 q 609 939 563 997 q 673 860 654 881 l 673 842 m 613 991 q 707 1128 671 1053 l 870 1128 l 870 1113 q 716 974 825 1053 l 613 974 l 613 991 "},"ď":{"x_min":62.390625,"x_max":1066.859375,"ha":879,"o":"m 348 -14 q 138 89 215 -14 q 62 377 62 193 q 140 668 62 564 q 354 773 217 773 q 572 661 497 773 l 579 661 q 563 812 563 746 l 563 1055 l 771 1055 l 771 0 l 612 0 l 572 98 l 563 98 q 348 -14 493 -14 m 421 150 q 537 197 500 150 q 577 354 574 243 l 577 376 q 540 551 577 498 q 417 604 502 604 q 310 546 348 604 q 271 375 271 487 q 310 206 271 262 q 421 150 349 150 m 833 850 q 856 947 843 884 q 875 1055 870 1011 l 1066 1055 l 1066 1041 q 954 833 1012 922 l 833 833 l 833 850 "}," ":{"x_min":0,"x_max":0,"ha":361},"Ĭ":{"x_min":-36.046875,"x_max":497.71875,"ha":460,"o":"m 124 0 l 124 992 l 335 992 l 335 0 l 124 0 m 497 1300 q 414 1133 489 1195 q 227 1071 340 1071 q 39 1132 109 1071 q -36 1300 -30 1194 l 79 1300 q 97 1249 81 1268 q 142 1223 113 1231 q 229 1215 171 1215 q 379 1300 368 1215 l 497 1300 "},"ŧ":{"x_min":31.890625,"x_max":558.234375,"ha":603,"o":"m 427 150 q 558 174 482 150 l 558 20 q 472 -5 522 3 q 372 -14 421 -14 q 188 47 246 -14 q 130 237 130 109 l 130 337 l 44 337 l 44 472 l 130 472 l 130 602 l 31 602 l 31 690 l 145 759 l 205 919 l 337 919 l 337 758 l 550 758 l 550 602 l 337 602 l 337 472 l 526 472 l 526 337 l 337 337 l 337 237 q 362 171 337 192 q 427 150 387 150 "},"À":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 483 1071 q 358 1167 440 1100 q 229 1278 275 1234 l 229 1293 l 461 1293 q 620 1089 503 1224 l 620 1071 l 483 1071 "},"ẃ":{"x_min":13.5625,"x_max":1175.4375,"ha":1189,"o":"m 731 0 l 673 265 l 594 600 l 590 600 l 451 0 l 229 0 l 13 758 l 219 758 l 307 422 q 349 173 328 332 l 354 173 q 377 336 356 225 l 388 394 l 482 758 l 710 758 l 799 394 q 807 350 801 379 q 818 288 813 321 q 828 224 824 255 q 833 173 832 192 l 837 173 q 859 307 843 222 q 881 422 874 392 l 972 758 l 1175 758 l 957 0 l 731 0 m 466 842 l 466 860 q 625 1064 582 995 l 857 1064 l 857 1049 q 737 945 822 1014 q 603 842 651 875 l 466 842 "},"+":{"x_min":59.75,"x_max":733.21875,"ha":793,"o":"m 322 415 l 59 415 l 59 564 l 322 564 l 322 828 l 470 828 l 470 564 l 733 564 l 733 415 l 470 415 l 470 154 l 322 154 l 322 415 "},"ḁ":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 573 -244 q 525 -362 573 -317 q 401 -407 477 -407 q 279 -363 325 -407 q 233 -245 233 -320 q 279 -128 233 -172 q 401 -85 325 -85 q 525 -129 476 -85 q 573 -244 573 -174 m 466 -245 q 448 -197 466 -215 q 401 -180 430 -180 q 355 -197 373 -180 q 336 -245 336 -215 q 353 -293 336 -276 q 401 -311 369 -311 q 448 -293 430 -311 q 466 -245 466 -276 "},"½":{"x_min":31.25,"x_max":1163.859375,"ha":1224,"o":"m 364 397 l 203 397 l 203 700 l 205 776 l 208 840 q 158 787 190 816 l 105 746 l 31 832 l 235 992 l 364 992 l 364 397 m 929 992 l 379 0 l 217 0 l 767 992 l 929 992 m 1163 0 l 725 0 l 725 113 l 877 262 q 965 360 946 330 q 984 425 984 391 q 968 464 984 450 q 925 478 952 478 q 803 418 870 478 l 719 521 q 947 609 819 609 q 1094 563 1040 609 q 1147 439 1147 518 q 1115 330 1147 381 q 996 200 1083 279 l 925 135 l 1163 135 l 1163 0 "},"Ë":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 184 1182 q 209 1250 184 1226 q 278 1273 235 1273 q 348 1248 323 1273 q 374 1182 374 1223 q 348 1116 374 1141 q 278 1092 322 1092 q 209 1115 235 1092 q 184 1182 184 1139 m 457 1182 q 484 1251 457 1229 q 552 1273 512 1273 q 623 1249 596 1273 q 649 1182 649 1224 q 622 1116 649 1140 q 552 1092 596 1092 q 484 1114 512 1092 q 457 1182 457 1136 "},"'":{"x_min":90.203125,"x_max":279.421875,"ha":370,"o":"m 279 992 l 251 634 l 118 634 l 90 992 l 279 992 "},"Š":{"x_min":63.75,"x_max":710.0625,"ha":765,"o":"m 710 275 q 613 63 710 140 q 344 -14 516 -14 q 63 45 185 -14 l 63 241 q 233 177 164 196 q 360 159 303 159 q 466 186 429 159 q 503 264 503 212 q 487 316 503 294 q 439 360 471 339 q 311 427 408 381 q 174 509 220 470 q 102 601 129 549 q 75 723 75 653 q 164 930 75 855 q 410 1006 253 1006 q 558 987 488 1006 q 705 936 628 969 l 637 772 q 506 818 558 805 q 404 831 454 831 q 312 803 344 831 q 280 730 280 775 q 293 682 280 702 q 334 641 306 661 q 467 572 362 622 q 658 438 606 505 q 710 275 710 372 m 700 1293 l 700 1274 q 595 1161 643 1217 q 526 1071 547 1104 l 284 1071 q 228 1147 265 1102 q 111 1274 191 1191 l 111 1293 l 248 1293 q 404 1174 348 1230 q 562 1293 461 1232 l 700 1293 "},"ĳ":{"x_min":99.703125,"x_max":721.875,"ha":821,"o":"m 99 953 q 212 1055 99 1055 q 324 953 324 1055 q 296 879 324 905 q 212 852 268 852 q 99 953 99 852 m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 444 -334 q 308 -317 365 -334 l 308 -154 q 405 -167 355 -167 q 481 -137 457 -167 q 505 -51 505 -108 l 505 758 l 712 758 l 712 -82 q 642 -268 712 -203 q 444 -334 572 -334 m 496 953 q 609 1055 496 1055 q 721 953 721 1055 q 693 879 721 905 q 609 852 665 852 q 496 953 496 852 "}," ":{"x_min":0,"x_max":0,"ha":1389},"˛":{"x_min":6.78125,"x_max":281.9375,"ha":286,"o":"m 149 -154 q 165 -196 149 -182 q 204 -209 180 -209 q 281 -197 241 -209 l 281 -318 q 176 -334 226 -334 q 53 -290 99 -334 q 6 -177 6 -247 q 32 -92 6 -132 q 128 0 58 -52 l 250 0 q 176 -81 202 -44 q 149 -154 149 -118 "},"ở":{"x_min":62.390625,"x_max":1007.171875,"ha":943,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 575 749 508 773 q 691 679 643 726 q 792 873 792 709 l 997 873 l 1007 858 q 959 713 988 767 q 881 624 929 660 q 762 570 833 587 q 797 380 797 485 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 860 0 l 860 0 m 612 1008 q 502 875 612 902 l 495 827 l 377 827 l 362 926 q 431 951 412 934 q 449 994 449 969 q 435 1027 449 1016 q 397 1039 421 1039 q 303 1023 353 1039 l 303 1137 q 359 1148 324 1144 q 423 1153 395 1153 q 565 1115 518 1153 q 612 1008 612 1077 "},"ð":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 345 883 q 242 945 291 919 l 311 1065 q 486 969 408 1020 l 638 1063 l 706 959 l 591 888 q 747 668 697 791 q 797 388 797 545 q 699 92 797 198 q 427 -14 600 -14 q 162 78 261 -14 q 62 331 62 171 q 150 581 62 488 q 388 674 238 674 q 575 607 527 674 l 580 610 q 450 801 535 720 l 294 704 l 226 810 l 345 883 m 586 360 q 544 477 586 433 q 430 521 503 521 q 310 474 348 521 q 273 329 273 428 q 314 186 273 234 q 430 138 354 138 q 550 194 514 138 q 586 360 586 249 "},"ş":{"x_min":62.390625,"x_max":637.09375,"ha":690,"o":"m 637 224 q 556 47 637 108 q 313 -14 475 -14 q 172 -2 231 -14 q 63 30 114 8 l 63 201 q 193 155 121 173 q 320 137 265 137 q 432 202 432 137 q 418 242 432 226 q 366 276 403 257 q 269 322 329 296 q 140 390 181 358 q 81 461 99 421 q 62 561 62 502 q 140 717 62 662 q 362 773 218 773 q 628 713 499 773 l 566 564 q 460 604 509 588 q 359 619 410 619 q 267 570 267 619 q 297 521 267 542 q 426 461 326 501 q 556 394 515 425 q 617 322 597 362 q 637 224 637 281 m 487 -170 q 436 -295 487 -256 q 277 -334 385 -334 q 178 -319 225 -334 l 178 -205 q 228 -215 197 -210 q 275 -220 259 -220 q 324 -177 324 -220 q 212 -104 324 -121 l 265 0 l 396 0 l 377 -42 q 457 -92 427 -58 q 487 -170 487 -126 "},"Ỡ":{"x_min":80.703125,"x_max":1188.078125,"ha":1146,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 875 80 744 q 555 1007 326 1007 q 911 869 790 1007 q 974 1055 974 910 l 1178 1055 l 1188 1040 q 1115 851 1163 920 q 983 749 1067 783 q 1025 496 1025 642 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 1106 0 l 1106 0 m 447 1142 q 407 1123 426 1142 q 379 1069 388 1105 l 278 1069 q 334 1223 285 1167 q 462 1279 382 1279 q 517 1267 490 1279 q 570 1243 544 1256 q 621 1218 596 1229 q 671 1207 646 1207 q 711 1225 692 1207 q 739 1280 730 1243 l 840 1280 q 784 1125 833 1181 q 656 1070 734 1070 q 601 1081 628 1070 q 548 1106 574 1092 q 497 1130 522 1119 q 447 1142 472 1142 "}," ":{"x_min":0,"x_max":0,"ha":777},"ı":{"x_min":108.515625,"x_max":315.375,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 "},"Ć":{"x_min":80.703125,"x_max":836.171875,"ha":885,"o":"m 545 831 q 362 741 427 831 q 297 492 297 652 q 545 160 297 160 q 798 213 650 160 l 798 36 q 526 -14 676 -14 q 195 117 309 -14 q 80 494 80 248 q 136 765 80 649 q 298 943 193 881 q 545 1006 404 1006 q 836 936 690 1006 l 768 765 q 656 811 712 791 q 545 831 600 831 m 405 1071 l 405 1089 q 564 1293 521 1224 l 796 1293 l 796 1278 q 676 1174 761 1243 q 542 1071 590 1104 l 405 1071 "},"ä":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 193 953 q 218 1021 193 997 q 287 1044 244 1044 q 357 1019 332 1044 q 383 953 383 994 q 357 887 383 912 q 287 863 331 863 q 218 886 244 863 q 193 953 193 910 m 466 953 q 493 1022 466 1000 q 561 1044 521 1044 q 632 1020 605 1044 q 658 953 658 995 q 631 887 658 911 q 561 863 605 863 q 493 885 521 863 q 466 953 466 907 "},"¹":{"x_min":62.25,"x_max":395.9375,"ha":526,"o":"m 395 397 l 234 397 l 234 700 l 236 776 l 239 840 q 189 787 221 816 l 136 746 l 62 832 l 266 992 l 395 992 l 395 397 "},"£":{"x_min":55.625,"x_max":766.546875,"ha":793,"o":"m 474 1006 q 739 950 607 1006 l 676 794 q 491 837 569 837 q 410 807 438 837 q 381 721 381 777 l 381 590 l 636 590 l 636 441 l 381 441 l 381 344 q 279 176 381 229 l 766 176 l 766 0 l 55 0 l 55 168 q 151 236 125 198 q 177 343 177 275 l 177 441 l 56 441 l 56 590 l 177 590 l 177 722 q 255 932 177 858 q 474 1006 333 1006 "},"ẹ":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 296 -190 q 409 -89 296 -89 q 521 -190 521 -89 q 493 -265 521 -238 q 409 -291 464 -291 q 296 -190 296 -291 "},"ů":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 624 1002 q 576 884 624 929 q 451 840 527 840 q 329 883 375 840 q 283 1001 283 926 q 329 1118 283 1074 q 451 1162 375 1162 q 575 1117 526 1162 q 624 1002 624 1072 m 517 1001 q 498 1049 517 1031 q 451 1066 480 1066 q 405 1049 423 1066 q 386 1001 386 1031 q 403 953 386 970 q 451 935 419 935 q 498 953 480 935 q 517 1001 517 970 "},"Ō":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 323 1214 l 783 1214 l 783 1071 l 323 1071 l 323 1214 "},"W":{"x_min":0,"x_max":1343,"ha":1343,"o":"m 1090 0 l 851 0 l 716 521 q 691 636 709 549 q 670 753 673 723 q 650 635 666 716 q 625 519 634 554 l 491 0 l 253 0 l 0 992 l 206 992 l 333 450 q 381 190 366 300 q 400 310 385 229 q 427 436 415 391 l 572 992 l 771 992 l 915 436 q 939 322 925 398 q 961 190 953 245 q 982 322 967 243 q 1009 450 997 401 l 1136 992 l 1343 992 l 1090 0 "},"ỉ":{"x_min":79.671875,"x_max":388.265625,"ha":424,"o":"m 315 0 l 108 0 l 108 758 l 315 758 l 315 0 m 388 1008 q 278 875 388 902 l 271 827 l 153 827 l 138 926 q 207 951 188 934 q 225 994 225 969 q 211 1027 225 1016 q 173 1039 197 1039 q 79 1023 129 1039 l 79 1137 q 135 1148 100 1144 q 199 1153 171 1153 q 341 1115 294 1153 q 388 1008 388 1077 "},"Ğ":{"x_min":80.703125,"x_max":894.734375,"ha":1006,"o":"m 501 557 l 894 557 l 894 42 q 714 -1 799 11 q 541 -14 630 -14 q 199 117 317 -14 q 80 497 80 249 q 218 871 80 737 q 598 1006 355 1006 q 893 944 751 1006 l 823 776 q 597 831 714 831 q 379 739 461 831 q 297 492 297 647 q 363 246 297 331 q 555 160 429 160 q 689 174 621 160 l 689 382 l 501 382 l 501 557 m 816 1300 q 733 1133 808 1195 q 546 1071 659 1071 q 358 1132 428 1071 q 282 1300 288 1194 l 398 1300 q 416 1249 400 1268 q 461 1223 432 1231 q 548 1215 490 1215 q 698 1300 687 1215 l 816 1300 "},"v":{"x_min":0,"x_max":790,"ha":790,"o":"m 288 0 l 0 758 l 216 758 l 362 326 q 393 170 387 244 l 397 170 q 427 326 400 235 l 573 758 l 790 758 l 501 0 l 288 0 "},">":{"x_min":59.703125,"x_max":733.296875,"ha":793,"o":"m 59 299 l 523 490 l 59 705 l 59 868 l 733 531 l 733 434 l 59 137 l 59 299 "},"Ệ":{"x_min":116.140625,"x_max":705.515625,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 567 1071 q 409 1189 461 1133 q 253 1071 356 1135 l 116 1071 l 116 1089 q 289 1293 244 1217 l 531 1293 q 604 1197 552 1257 q 705 1089 656 1136 l 705 1071 l 567 1071 m 295 -190 q 408 -89 295 -89 q 520 -190 520 -89 q 492 -265 520 -238 q 408 -291 463 -291 q 295 -190 295 -291 "},"û":{"x_min":104.453125,"x_max":804.484375,"ha":913,"o":"m 645 0 l 617 96 l 607 96 q 512 14 573 43 q 373 -14 451 -14 q 172 57 240 -14 q 104 263 104 129 l 104 758 l 311 758 l 311 314 q 340 191 311 232 q 433 150 369 150 q 558 208 520 150 q 597 401 597 266 l 597 758 l 804 758 l 804 0 l 645 0 m 610 842 q 452 960 504 904 q 296 842 399 906 l 159 842 l 159 860 q 332 1064 287 988 l 574 1064 q 647 968 595 1028 q 748 860 699 907 l 748 842 l 610 842 "},"Ź":{"x_min":33.21875,"x_max":770.78125,"ha":804,"o":"m 770 0 l 33 0 l 33 136 l 508 818 l 46 818 l 46 992 l 757 992 l 757 856 l 283 173 l 770 173 l 770 0 m 278 1071 l 278 1089 q 437 1293 394 1224 l 669 1293 l 669 1278 q 549 1174 634 1243 q 415 1071 463 1104 l 278 1071 "},"Ų":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 545 -154 q 561 -196 545 -182 q 600 -209 576 -209 q 677 -197 637 -209 l 677 -318 q 572 -334 622 -334 q 449 -290 495 -334 q 402 -177 402 -247 q 428 -92 402 -132 q 524 0 454 -52 l 646 0 q 572 -81 598 -44 q 545 -154 545 -118 "},"Ŵ":{"x_min":0,"x_max":1343,"ha":1343,"o":"m 1090 0 l 851 0 l 716 521 q 691 636 709 549 q 670 753 673 723 q 650 635 666 716 q 625 519 634 554 l 491 0 l 253 0 l 0 992 l 206 992 l 333 450 q 381 190 366 300 q 400 310 385 229 q 427 436 415 391 l 572 992 l 771 992 l 915 436 q 939 322 925 398 q 961 190 953 245 q 982 322 967 243 q 1009 450 997 401 l 1136 992 l 1343 992 l 1090 0 m 827 1071 q 669 1189 721 1133 q 513 1071 616 1135 l 376 1071 l 376 1089 q 549 1293 504 1217 l 791 1293 q 864 1197 812 1257 q 965 1089 916 1136 l 965 1071 l 827 1071 "},"‛":{"x_min":17.171875,"x_max":285.078125,"ha":300,"o":"m 216 992 q 285 652 241 825 l 136 652 q 63 828 96 738 q 17 977 30 919 l 26 992 l 216 992 "},"Ð":{"x_min":31.875,"x_max":947.296875,"ha":1028,"o":"m 31 577 l 124 577 l 124 992 l 436 992 q 813 863 678 992 q 947 505 947 735 q 807 130 947 260 q 405 0 668 0 l 124 0 l 124 404 l 31 404 l 31 577 m 728 500 q 658 738 728 657 q 445 819 587 819 l 335 819 l 335 577 l 495 577 l 495 404 l 335 404 l 335 173 l 423 173 q 728 500 728 173 "},"ˉ":{"x_min":191.9375,"x_max":651.765625,"ha":843,"o":"m 191 985 l 651 985 l 651 842 l 191 842 l 191 985 "},"Ĺ":{"x_min":124.796875,"x_max":737.53125,"ha":785,"o":"m 124 0 l 124 992 l 335 992 l 335 173 l 737 173 l 737 0 l 124 0 m 181 1071 l 181 1089 q 340 1293 297 1224 l 572 1293 l 572 1278 q 452 1174 537 1243 q 318 1071 366 1104 l 181 1071 "},"ỵ":{"x_min":0,"x_max":790,"ha":790,"o":"m 0 758 l 226 758 l 369 331 q 394 199 387 275 l 398 199 q 427 331 406 269 l 568 758 l 790 758 l 469 -97 q 343 -275 425 -216 q 152 -334 261 -334 q 47 -322 99 -334 l 47 -158 q 128 -167 84 -167 q 224 -133 183 -167 q 288 -32 265 -100 l 301 5 l 0 758 m 552 -190 q 665 -89 552 -89 q 777 -190 777 -89 q 749 -265 777 -238 q 665 -291 720 -291 q 552 -190 552 -291 "},"r":{"x_min":108.515625,"x_max":601.828125,"ha":631,"o":"m 531 773 q 601 766 574 773 l 586 572 q 525 579 561 579 q 370 528 426 579 q 315 386 315 477 l 315 0 l 108 0 l 108 758 l 265 758 l 295 631 l 305 631 q 401 734 341 695 q 531 773 461 773 "},"Č":{"x_min":80.703125,"x_max":836.171875,"ha":885,"o":"m 545 831 q 362 741 427 831 q 297 492 297 652 q 545 160 297 160 q 798 213 650 160 l 798 36 q 526 -14 676 -14 q 195 117 309 -14 q 80 494 80 248 q 136 765 80 649 q 298 943 193 881 q 545 1006 404 1006 q 836 936 690 1006 l 768 765 q 656 811 712 791 q 545 831 600 831 m 832 1293 l 832 1274 q 727 1161 775 1217 q 658 1071 679 1104 l 416 1071 q 360 1147 397 1102 q 243 1274 323 1191 l 243 1293 l 380 1293 q 536 1174 480 1230 q 694 1293 593 1232 l 832 1293 "},"x":{"x_min":6.78125,"x_max":796.21875,"ha":803,"o":"m 263 387 l 19 758 l 254 758 l 401 516 l 550 758 l 784 758 l 537 387 l 796 0 l 560 0 l 401 259 l 241 0 l 6 0 l 263 387 "},"è":{"x_min":62.390625,"x_max":761.3125,"ha":821,"o":"m 422 625 q 319 583 356 625 q 276 465 282 542 l 567 465 q 527 583 565 542 q 422 625 488 625 m 451 -14 q 165 87 268 -14 q 62 373 62 188 q 157 668 62 564 q 421 773 253 773 q 671 681 582 773 q 761 427 761 589 l 761 327 l 271 327 q 324 189 275 239 q 461 139 373 139 q 590 154 529 139 q 718 199 652 168 l 718 39 q 602 0 664 12 q 451 -14 540 -14 m 420 842 q 295 938 377 871 q 166 1049 212 1005 l 166 1064 l 398 1064 q 557 860 440 995 l 557 842 l 420 842 "},"Ń":{"x_min":124.796875,"x_max":1004.21875,"ha":1129,"o":"m 1004 0 l 737 0 l 305 750 l 299 750 q 312 466 312 551 l 312 0 l 124 0 l 124 992 l 389 992 l 820 249 l 825 249 q 814 522 814 442 l 814 992 l 1004 992 l 1004 0 m 445 1071 l 445 1089 q 604 1293 561 1224 l 836 1293 l 836 1278 q 716 1174 801 1243 q 582 1071 630 1104 l 445 1071 "},"Ø":{"x_min":80.75,"x_max":1025.25,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 780 -14 q 325 30 419 -14 l 263 -61 l 154 11 l 215 104 q 80 498 80 235 q 203 876 80 745 q 554 1007 325 1007 q 787 959 688 1007 l 844 1044 l 953 973 l 893 884 q 1025 496 1025 753 m 301 496 q 339 288 301 367 l 682 801 q 554 832 625 832 q 364 747 428 832 q 301 496 301 663 m 804 496 q 770 698 804 618 l 430 188 q 553 162 482 162 q 804 496 804 162 "},"Ỳ":{"x_min":0.09375,"x_max":866.859375,"ha":867,"o":"m 433 583 l 640 992 l 866 992 l 537 386 l 537 0 l 329 0 l 329 379 l 0 992 l 227 992 l 433 583 m 389 1071 q 264 1167 346 1100 q 135 1278 181 1234 l 135 1293 l 367 1293 q 526 1089 409 1224 l 526 1071 l 389 1071 "},"Ẽ":{"x_min":124.796875,"x_max":695.9375,"ha":778,"o":"m 695 0 l 124 0 l 124 992 l 695 992 l 695 819 l 335 819 l 335 602 l 670 602 l 670 429 l 335 429 l 335 173 l 695 173 l 695 0 m 297 1142 q 257 1123 276 1142 q 229 1069 238 1105 l 128 1069 q 184 1223 135 1167 q 312 1279 232 1279 q 367 1267 340 1279 q 420 1243 394 1256 q 471 1218 446 1229 q 521 1207 496 1207 q 561 1225 542 1207 q 589 1280 580 1243 l 690 1280 q 634 1125 683 1181 q 506 1070 584 1070 q 451 1081 478 1070 q 398 1106 424 1092 q 347 1130 372 1119 q 297 1142 322 1142 "},"ḿ":{"x_min":108.515625,"x_max":1260.234375,"ha":1364,"o":"m 787 0 l 580 0 l 580 443 q 553 566 580 525 q 466 607 525 607 q 351 549 387 607 q 315 357 315 490 l 315 0 l 108 0 l 108 758 l 266 758 l 294 661 l 305 661 q 394 743 336 713 q 526 773 451 773 q 756 661 696 773 l 775 661 q 865 743 805 714 q 999 773 924 773 q 1194 706 1127 773 q 1260 494 1260 640 l 1260 0 l 1052 0 l 1052 443 q 1025 566 1052 525 q 938 607 997 607 q 825 553 862 607 q 787 380 787 498 l 787 0 m 560 842 l 560 860 q 719 1064 676 995 l 951 1064 l 951 1049 q 831 945 916 1014 q 697 842 745 875 l 560 842 "},"÷":{"x_min":59.6875,"x_max":733.3125,"ha":793,"o":"m 59 415 l 59 564 l 733 564 l 733 415 l 59 415 m 301 253 q 326 330 301 305 q 396 356 351 356 q 465 329 440 356 q 490 253 490 303 q 465 178 490 206 q 396 150 440 150 q 326 176 352 150 q 301 253 301 203 m 301 726 q 326 803 301 777 q 396 830 351 830 q 466 802 441 830 q 490 726 490 775 q 465 651 490 679 q 396 624 440 624 q 326 650 352 624 q 301 726 301 677 "},"h":{"x_min":108.515625,"x_max":808.546875,"ha":913,"o":"m 808 0 l 601 0 l 601 443 q 479 607 601 607 q 354 548 392 607 q 315 357 315 489 l 315 0 l 108 0 l 108 1055 l 315 1055 l 315 840 q 310 722 315 815 l 305 661 l 316 661 q 536 773 385 773 q 739 701 670 773 q 808 494 808 629 l 808 0 "},".":{"x_min":79.359375,"x_max":316.734375,"ha":396,"o":"m 79 97 q 109 183 79 154 q 198 212 140 212 q 285 182 255 212 q 316 97 316 152 q 285 12 316 43 q 198 -18 254 -18 q 110 12 141 -18 q 79 97 79 42 "},"f":{"x_min":27.859375,"x_max":600.40625,"ha":538,"o":"m 527 602 l 348 602 l 348 0 l 141 0 l 141 602 l 27 602 l 27 702 l 141 758 l 141 813 q 205 1003 141 943 q 409 1063 269 1063 q 600 1031 516 1063 l 547 879 q 432 898 485 898 q 368 872 388 898 q 348 805 348 846 l 348 758 l 527 758 l 527 602 "},"“":{"x_min":16.8125,"x_max":601.71875,"ha":618,"o":"m 333 666 q 383 822 348 728 q 453 992 417 915 l 601 992 q 533 652 556 810 l 343 652 l 333 666 m 16 666 q 65 822 31 728 q 136 992 100 915 l 284 992 q 216 652 239 810 l 26 652 l 16 666 "},"A":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 "},"‘":{"x_min":16.828125,"x_max":284.734375,"ha":301,"o":"m 26 652 l 16 666 q 66 822 31 728 q 136 992 100 915 l 284 992 q 216 652 239 810 l 26 652 "},"O":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 "},"Ỏ":{"x_min":80.703125,"x_max":1025.296875,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 876 80 745 q 554 1007 325 1007 q 904 875 783 1007 q 1025 496 1025 743 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 727 1237 q 617 1104 727 1131 l 610 1056 l 492 1056 l 477 1155 q 546 1180 527 1163 q 564 1223 564 1198 q 550 1256 564 1245 q 512 1268 536 1268 q 418 1252 468 1268 l 418 1366 q 474 1377 439 1373 q 538 1382 510 1382 q 680 1344 633 1382 q 727 1237 727 1306 "},"Đ":{"x_min":31.875,"x_max":947.296875,"ha":1028,"o":"m 31 577 l 124 577 l 124 992 l 436 992 q 813 863 678 992 q 947 505 947 735 q 807 130 947 260 q 405 0 668 0 l 124 0 l 124 404 l 31 404 l 31 577 m 728 500 q 658 738 728 657 q 445 819 587 819 l 335 819 l 335 577 l 495 577 l 495 404 l 335 404 l 335 173 l 423 173 q 728 500 728 173 "},"Ớ":{"x_min":80.703125,"x_max":1188.078125,"ha":1146,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 781 -14 q 202 118 325 -14 q 80 498 80 250 q 203 875 80 744 q 555 1007 326 1007 q 911 869 790 1007 q 974 1055 974 910 l 1178 1055 l 1188 1040 q 1115 851 1163 920 q 983 749 1067 783 q 1025 496 1025 642 m 301 496 q 364 246 301 330 q 553 162 427 162 q 804 496 804 162 q 554 832 804 832 q 364 747 428 832 q 301 496 301 663 m 1106 0 l 1106 0 m 416 1071 l 416 1089 q 575 1293 532 1224 l 807 1293 l 807 1278 q 687 1174 772 1243 q 553 1071 601 1104 l 416 1071 "},"3":{"x_min":52.90625,"x_max":739.40625,"ha":793,"o":"m 710 769 q 653 611 710 676 q 495 522 597 546 l 495 518 q 677 445 615 503 q 739 288 739 387 q 635 65 739 145 q 339 -14 531 -14 q 52 39 177 -14 l 52 217 q 179 170 110 188 q 316 152 248 152 q 470 187 420 152 q 519 300 519 222 q 462 400 519 370 q 280 429 405 429 l 205 429 l 205 590 l 282 590 q 450 620 397 590 q 504 723 504 650 q 362 836 504 836 q 263 820 314 836 q 151 763 213 803 l 54 908 q 377 1006 189 1006 q 621 943 531 1006 q 710 769 710 881 "},"9":{"x_min":44.765625,"x_max":744.84375,"ha":793,"o":"m 744 568 q 621 130 744 275 q 247 -14 497 -14 q 113 -4 159 -14 l 113 163 q 233 149 170 149 q 406 180 338 149 q 510 277 474 211 q 551 459 546 343 l 543 459 q 452 369 504 395 q 323 344 400 344 q 119 427 194 344 q 44 658 44 510 q 135 910 44 817 q 381 1003 225 1003 q 574 951 491 1003 q 700 801 656 899 q 744 568 744 703 m 385 834 q 284 789 320 834 q 247 660 247 745 q 280 546 247 588 q 381 504 314 504 q 491 546 445 504 q 536 642 536 588 q 494 779 536 723 q 385 834 451 834 "},"Ǿ":{"x_min":80.75,"x_max":1025.25,"ha":1106,"o":"m 1025 496 q 903 118 1025 250 q 553 -14 780 -14 q 325 30 419 -14 l 263 -61 l 154 11 l 215 104 q 80 498 80 235 q 203 876 80 745 q 554 1007 325 1007 q 787 959 688 1007 l 844 1044 l 953 973 l 893 884 q 1025 496 1025 753 m 301 496 q 339 288 301 367 l 682 801 q 554 832 625 832 q 364 747 428 832 q 301 496 301 663 m 804 496 q 770 698 804 618 l 430 188 q 553 162 482 162 q 804 496 804 162 m 432 1071 l 432 1089 q 591 1293 548 1224 l 823 1293 l 823 1278 q 703 1174 788 1243 q 569 1071 617 1104 l 432 1071 "},"l":{"x_min":108.515625,"x_max":315.375,"ha":424,"o":"m 315 0 l 108 0 l 108 1055 l 315 1055 l 315 0 "},"Ẫ":{"x_min":0,"x_max":958,"ha":958,"o":"m 731 0 l 659 236 l 298 236 l 226 0 l 0 0 l 349 996 l 606 996 l 958 0 l 731 0 m 609 413 q 497 775 509 733 q 479 842 484 817 q 351 413 456 755 l 609 413 m 578 1292 q 528 1300 553 1292 q 478 1319 502 1309 q 431 1338 453 1329 q 389 1347 408 1347 q 347 1335 362 1347 q 324 1291 333 1324 l 247 1291 q 290 1410 253 1366 q 382 1455 326 1455 q 433 1446 407 1455 q 484 1426 460 1437 q 531 1407 508 1416 q 571 1398 553 1398 q 612 1410 599 1398 q 636 1456 626 1423 l 713 1456 q 668 1334 704 1377 q 578 1292 632 1292 m 732 1071 l 636 1071 q 479 1174 540 1119 q 322 1071 423 1124 l 226 1071 l 226 1089 q 386 1266 342 1200 l 572 1266 q 648 1174 605 1219 q 732 1089 692 1129 l 732 1071 "},"4":{"x_min":23.734375,"x_max":771.296875,"ha":793,"o":"m 771 205 l 651 205 l 651 0 l 447 0 l 447 205 l 23 205 l 23 351 l 458 992 l 651 992 l 651 368 l 771 368 l 771 205 m 447 368 l 447 536 q 450 658 447 578 q 455 751 453 739 l 450 751 q 390 643 425 696 l 208 368 l 447 368 "},"Ẁ":{"x_min":0,"x_max":1343,"ha":1343,"o":"m 1090 0 l 851 0 l 716 521 q 691 636 709 549 q 670 753 673 723 q 650 635 666 716 q 625 519 634 554 l 491 0 l 253 0 l 0 992 l 206 992 l 333 450 q 381 190 366 300 q 400 310 385 229 q 427 436 415 391 l 572 992 l 771 992 l 915 436 q 939 322 925 398 q 961 190 953 245 q 982 322 967 243 q 1009 450 997 401 l 1136 992 l 1343 992 l 1090 0 m 650 1071 q 525 1167 607 1100 q 396 1278 442 1234 l 396 1293 l 628 1293 q 787 1089 670 1224 l 787 1071 l 650 1071 "}," ":{"x_min":0,"x_max":0,"ha":139},"Ť":{"x_min":27.671875,"x_max":776.421875,"ha":804,"o":"m 507 0 l 296 0 l 296 817 l 27 817 l 27 992 l 776 992 l 776 817 l 507 817 l 507 0 m 697 1293 l 697 1274 q 592 1161 640 1217 q 523 1071 544 1104 l 281 1071 q 225 1147 262 1102 q 108 1274 188 1191 l 108 1293 l 245 1293 q 401 1174 345 1230 q 559 1293 458 1232 l 697 1293 "},"Ś":{"x_min":63.75,"x_max":710.0625,"ha":765,"o":"m 710 275 q 613 63 710 140 q 344 -14 516 -14 q 63 45 185 -14 l 63 241 q 233 177 164 196 q 360 159 303 159 q 466 186 429 159 q 503 264 503 212 q 487 316 503 294 q 439 360 471 339 q 311 427 408 381 q 174 509 220 470 q 102 601 129 549 q 75 723 75 653 q 164 930 75 855 q 410 1006 253 1006 q 558 987 488 1006 q 705 936 628 969 l 637 772 q 506 818 558 805 q 404 831 454 831 q 312 803 344 831 q 280 730 280 775 q 293 682 280 702 q 334 641 306 661 q 467 572 362 622 q 658 438 606 505 q 710 275 710 372 m 278 1071 l 278 1089 q 437 1293 394 1224 l 669 1293 l 669 1278 q 549 1174 634 1243 q 415 1071 463 1104 l 278 1071 "},"Ü":{"x_min":118.015625,"x_max":931.984375,"ha":1050,"o":"m 931 992 l 931 349 q 882 157 931 239 q 740 30 833 74 q 520 -14 647 -14 q 223 84 329 -14 q 118 352 118 182 l 118 992 l 327 992 l 327 384 q 373 215 327 269 q 526 162 419 162 q 675 216 629 162 q 722 385 722 270 l 722 992 l 931 992 m 293 1182 q 318 1250 293 1226 q 387 1273 344 1273 q 457 1248 432 1273 q 483 1182 483 1223 q 457 1116 483 1141 q 387 1092 431 1092 q 318 1115 344 1092 q 293 1182 293 1139 m 566 1182 q 593 1251 566 1229 q 661 1273 621 1273 q 732 1249 705 1273 q 758 1182 758 1224 q 731 1116 758 1140 q 661 1092 705 1092 q 593 1114 621 1092 q 566 1182 566 1136 "},"à":{"x_min":58.328125,"x_max":734.546875,"ha":839,"o":"m 590 0 l 550 102 l 544 102 q 437 11 492 36 q 293 -14 381 -14 q 121 48 183 -14 q 58 226 58 110 q 142 404 58 347 q 397 467 227 461 l 529 472 l 529 505 q 411 620 529 620 q 197 565 320 620 l 128 705 q 419 774 259 774 q 653 707 571 774 q 734 505 734 641 l 734 0 l 590 0 m 529 351 l 449 348 q 314 315 358 345 q 270 224 270 286 q 371 137 270 137 q 485 178 442 137 q 529 288 529 220 l 529 351 m 416 842 q 291 938 373 871 q 162 1049 208 1005 l 162 1064 l 394 1064 q 553 860 436 995 l 553 842 l 416 842 "},"ơ":{"x_min":62.390625,"x_max":1007.171875,"ha":943,"o":"m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 575 749 508 773 q 691 679 643 726 q 792 873 792 709 l 997 873 l 1007 858 q 959 713 988 767 q 881 624 929 660 q 762 570 833 587 q 797 380 797 485 m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 860 0 l 860 0 "},"ó":{"x_min":62.390625,"x_max":797.609375,"ha":860,"o":"m 273 380 q 310 209 273 267 q 430 152 347 152 q 549 209 513 152 q 586 380 586 267 q 549 549 586 493 q 429 606 512 606 q 309 550 346 606 q 273 380 273 494 m 797 380 q 699 90 797 195 q 427 -14 602 -14 q 235 33 318 -14 q 107 171 151 81 q 62 380 62 261 q 159 669 62 566 q 432 773 256 773 q 624 725 541 773 q 752 588 708 677 q 797 380 797 500 m 317 842 l 317 860 q 476 1064 433 995 l 708 1064 l 708 1049 q 588 945 673 1014 q 454 842 502 875 l 317 842 "},"ŗ":{"x_min":67.546875,"x_max":601.828125,"ha":631,"o":"m 531 773 q 601 766 574 773 l 586 572 q 525 579 561 579 q 370 528 426 579 q 315 386 315 477 l 315 0 l 108 0 l 108 758 l 265 758 l 295 631 l 305 631 q 401 734 341 695 q 531 773 461 773 m 67 -288 q 90 -191 77 -255 q 109 -85 104 -128 l 300 -85 l 300 -98 q 188 -307 250 -212 l 67 -307 l 67 -288 "}},"cssFontWeight":"bold","ascender":1485,"underlinePosition":-154,"cssFontStyle":"normal","boundingBox":{"yMin":-407,"xMin":-270.078125,"yMax":1456,"xMax":1736.265625},"resolution":1000,"original_font_information":{"postscript_name":"OpenSans-Bold","version_string":"Version 1.10","vendor_url":"http://www.ascendercorp.com/","full_font_name":"Open Sans Bold","font_family_name":"Open Sans","copyright":"Digitized data copyright © 2010-2011, Google Corporation.","description":"","trademark":"Open Sans is a trademark of Google and may be registered in certain jurisdictions.","designer":"","designer_url":"http://www.ascendercorp.com/typedesigners.html","unique_font_identifier":"Ascender - Open Sans Bold Build 100","license_url":"http://www.apache.org/licenses/LICENSE-2.0","license_description":"Licensed under the Apache License, Version 2.0","manufacturer_name":"Ascender Corporation","font_sub_family_name":"Bold"},"descender":-407,"familyName":"Open Sans","lineHeight":1891,"underlineThickness":102});
if (_typeface_js && _typeface_js.loadFace) _typeface_js.loadFace({"glyphs":{"ợ":{"x_min":65.78125,"x_max":851.84375,"ha":797,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 520 723 462 747 q 621 656 577 699 q 703 713 676 669 q 731 829 731 758 l 851 829 q 806 668 851 732 q 674 583 761 604 q 710 485 697 538 q 722 373 722 431 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 468 -233 l 320 -233 l 320 -97 l 468 -97 l 468 -233 "},"¦":{"x_min":98.34375,"x_max":231.953125,"ha":338,"o":"m 98 -183 l 98 353 l 231 353 l 231 -183 l 98 -183 m 231 473 l 98 473 l 98 988 l 231 988 l 231 473 "},"Ẩ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 701 1062 l 699 1058 l 584 1058 l 451 1184 l 318 1058 l 203 1058 l 202 1062 l 384 1236 l 518 1236 l 701 1062 m 684 1151 l 683 1241 q 746 1253 728 1244 q 765 1283 765 1262 q 740 1317 765 1306 q 672 1328 714 1328 l 676 1392 q 809 1362 762 1392 q 855 1282 855 1333 q 830 1219 855 1241 q 766 1192 804 1197 l 765 1151 l 684 1151 "},"ǻ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 444 1196 l 579 1196 l 580 1192 l 434 1070 l 346 1070 l 444 1196 m 260 924 q 294 1005 260 973 q 378 1037 329 1037 q 460 1005 426 1037 q 494 924 494 973 q 460 844 494 875 q 378 813 426 813 q 294 844 329 813 q 260 924 260 875 m 319 924 q 337 883 319 900 q 378 867 354 867 q 418 883 401 867 q 435 924 435 899 q 418 966 435 949 q 378 983 401 983 q 337 966 354 983 q 319 924 319 949 "},"Ỷ":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 379 1072 l 378 1176 q 452 1190 430 1179 q 474 1225 474 1200 q 444 1265 474 1252 q 365 1278 415 1278 l 370 1351 q 523 1316 470 1351 q 577 1223 577 1281 q 548 1151 577 1175 q 475 1120 519 1126 l 474 1072 l 379 1072 "},"Ő":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 659 1280 l 815 1280 l 817 1276 l 613 1100 l 497 1100 l 496 1103 l 659 1280 m 438 1280 l 581 1280 l 583 1277 l 420 1100 l 313 1100 l 438 1280 "},"‥":{"x_min":109.1875,"x_max":542.796875,"ha":658,"o":"m 242 0 l 109 0 l 109 137 l 242 137 l 242 0 m 542 0 l 409 0 l 409 137 l 542 137 l 542 0 "},"Ổ":{"x_min":76.640625,"x_max":871.734375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 717 1076 l 715 1072 l 600 1072 l 467 1198 l 334 1072 l 219 1072 l 218 1076 l 400 1250 l 534 1250 l 717 1076 m 700 1165 l 699 1255 q 762 1267 744 1258 q 781 1297 781 1276 q 756 1331 781 1320 q 688 1342 730 1342 l 692 1406 q 825 1376 778 1406 q 871 1296 871 1347 q 846 1233 871 1255 q 782 1206 820 1211 l 781 1165 l 700 1165 "},"Ừ":{"x_min":99.703125,"x_max":1099.4375,"ha":970,"o":"m 843 988 l 843 866 l 847 865 q 937 938 906 883 q 968 1079 968 994 l 1097 1079 l 1099 1075 q 1034 862 1100 944 q 843 756 967 779 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 528 1058 l 421 1058 l 251 1234 l 253 1238 l 409 1238 l 528 1058 "},"Ž":{"x_min":65.78125,"x_max":768.421875,"ha":831,"o":"m 216 104 l 768 104 l 768 0 l 65 0 l 65 99 l 593 882 l 73 882 l 73 988 l 746 988 l 746 892 l 216 104 m 412 1164 l 511 1264 l 627 1264 l 627 1252 l 452 1086 l 372 1086 l 199 1250 l 199 1264 l 312 1264 l 412 1164 "},"Á":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 541 1235 l 697 1235 l 698 1230 l 515 1054 l 415 1054 l 541 1235 "},"ĥ":{"x_min":96.984375,"x_max":694.5,"ha":789,"o":"m 230 635 q 323 717 268 687 q 446 747 379 747 q 629 676 563 747 q 694 459 694 606 l 694 0 l 560 0 l 560 460 q 521 595 560 551 q 405 638 482 638 q 304 612 349 638 q 230 541 259 586 l 230 0 l 96 0 l 96 1058 l 230 1058 l 230 635 m 554 1101 l 554 1085 l 445 1085 l 345 1185 l 246 1085 l 137 1085 l 137 1102 l 304 1263 l 386 1263 l 554 1101 "},"Î":{"x_min":-10.03125,"x_max":406.40625,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 406 1102 l 406 1086 l 297 1086 l 197 1186 l 98 1086 l -10 1086 l -10 1103 l 156 1264 l 238 1264 l 406 1102 "},"e":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 "},"»":{"x_min":74.6875,"x_max":610.140625,"ha":655,"o":"m 175 644 l 375 379 l 375 367 l 175 103 l 74 103 l 247 373 l 74 644 l 175 644 m 410 644 l 610 379 l 610 367 l 410 103 l 309 103 l 482 373 l 309 644 l 410 644 "},"Ề":{"x_min":-13.96875,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 675 1075 l 673 1071 l 538 1071 l 425 1177 l 312 1071 l 177 1071 l 176 1075 l 371 1249 l 479 1249 l 675 1075 m 223 1190 l 123 1190 l -13 1366 l 128 1366 l 223 1190 "},"ļ":{"x_min":74.5,"x_max":241.453125,"ha":350,"o":"m 241 0 l 107 0 l 107 1058 l 241 1058 l 241 0 m 223 -160 l 140 -321 l 74 -321 l 115 -154 l 115 -66 l 223 -66 l 223 -160 "},"Ĕ":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 625 1268 l 627 1264 q 574 1136 629 1186 q 426 1087 519 1087 q 278 1136 333 1087 q 226 1264 223 1186 l 228 1268 l 330 1268 q 353 1196 330 1224 q 426 1168 376 1168 q 499 1196 475 1168 q 523 1268 523 1224 l 625 1268 "},"ị":{"x_min":100.8125,"x_max":248.671875,"ha":350,"o":"m 241 0 l 107 0 l 107 734 l 241 734 l 241 0 m 241 921 l 107 921 l 107 1058 l 241 1058 l 241 921 m 248 -221 l 100 -221 l 100 -85 l 248 -85 l 248 -221 "}," ":{"x_min":0,"x_max":0,"ha":708},"ỹ":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 584 1017 q 543 910 584 954 q 442 866 503 866 q 342 897 394 866 q 255 929 289 929 q 206 907 226 929 q 186 853 186 885 l 113 871 q 153 980 113 934 q 255 1027 193 1027 q 350 995 293 1027 q 442 963 407 963 q 490 985 470 963 q 511 1039 511 1007 l 584 1017 "},"ò":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 451 839 l 344 839 l 174 1015 l 176 1019 l 332 1019 l 451 839 "},"ţ":{"x_min":23.0625,"x_max":419.140625,"ha":480,"o":"m 273 911 l 273 734 l 412 734 l 412 634 l 273 634 l 273 189 q 294 116 273 137 q 351 95 316 95 q 376 98 362 95 q 401 105 390 101 l 419 13 q 375 -6 404 1 q 317 -14 346 -14 q 187 35 236 -14 q 139 189 139 84 l 139 634 l 23 634 l 23 734 l 139 734 l 139 911 l 273 911 m 357 -167 l 274 -328 l 208 -328 l 249 -161 l 249 -73 l 357 -73 l 357 -167 "},"^":{"x_min":41.375,"x_max":537.15625,"ha":581,"o":"m 165 494 l 41 494 l 244 988 l 335 988 l 537 494 l 414 494 l 301 779 l 290 826 l 286 826 l 276 779 l 165 494 "},"«":{"x_min":66.25,"x_max":593.703125,"ha":655,"o":"m 193 350 l 366 80 l 266 80 l 66 344 l 66 356 l 266 621 l 366 621 l 193 350 m 420 350 l 593 80 l 493 80 l 293 344 l 293 356 l 493 621 l 593 621 l 420 350 "},"ử":{"x_min":94.265625,"x_max":938.046875,"ha":817,"o":"m 935 832 l 937 827 q 879 642 940 707 q 691 568 819 577 l 691 0 l 571 0 l 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 656 l 695 655 q 792 703 763 659 q 821 832 821 746 l 935 832 m 348 841 l 347 945 q 421 959 399 948 q 443 994 443 969 q 413 1034 443 1021 q 334 1047 384 1047 l 339 1120 q 492 1085 439 1120 q 546 992 546 1050 q 517 920 546 944 q 444 889 488 895 l 443 841 l 348 841 "},"í":{"x_min":103.765625,"x_max":392.671875,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 235 1002 l 391 1002 l 392 998 l 209 822 l 109 822 l 235 1002 "},"ˆ":{"x_min":115.96875,"x_max":532.40625,"ha":664,"o":"m 532 865 l 532 849 l 423 849 l 323 949 l 224 849 l 115 849 l 115 866 l 282 1027 l 364 1027 l 532 865 "},"ū":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 641 881 l 152 881 l 152 980 l 641 980 l 641 881 "},"Ẅ":{"x_min":36.625,"x_max":1182.140625,"ha":1227,"o":"m 320 341 l 338 218 l 342 217 l 368 341 l 550 988 l 668 988 l 850 341 l 877 215 l 881 215 l 901 341 l 1048 988 l 1182 988 l 944 0 l 824 0 l 630 685 l 612 774 l 608 774 l 591 685 l 393 0 l 274 0 l 36 988 l 169 988 l 320 341 m 842 1089 l 694 1089 l 694 1224 l 842 1224 l 842 1089 m 523 1089 l 375 1089 l 375 1224 l 523 1224 l 523 1089 "},"ȷ":{"x_min":-46.125,"x_max":249.59375,"ha":355,"o":"m 249 734 l 249 -60 q 191 -234 249 -173 q 29 -296 132 -296 q -9 -292 8 -296 q -46 -283 -26 -289 l -36 -182 q -5 -188 -27 -185 q 29 -190 16 -190 q 92 -155 69 -190 q 115 -60 115 -121 l 115 734 l 249 734 "},"ņ":{"x_min":96.984375,"x_max":692.46875,"ha":789,"o":"m 216 734 l 225 624 q 317 715 262 683 q 443 747 373 747 q 627 677 562 747 q 692 462 692 608 l 692 0 l 558 0 l 558 460 q 520 597 558 557 q 403 638 482 638 q 301 610 345 638 q 230 534 257 582 l 230 0 l 96 0 l 96 734 l 216 734 m 440 -160 l 357 -321 l 291 -321 l 332 -154 l 332 -66 l 440 -66 l 440 -160 "},"µ":{"x_min":103.765625,"x_max":685,"ha":789,"o":"m 236 734 l 236 298 q 275 134 238 177 q 381 90 313 90 q 488 114 447 90 q 551 186 529 139 l 551 734 l 685 734 l 685 0 l 564 0 l 558 73 q 485 8 529 30 q 386 -14 442 -14 q 300 -2 337 -14 q 236 32 263 8 l 236 -282 l 103 -282 l 103 734 l 236 734 "},"ỳ":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 405 825 l 298 825 l 128 1001 l 130 1005 l 286 1005 l 405 825 "},"č":{"x_min":65.78125,"x_max":685.09375,"ha":737,"o":"m 395 90 q 512 131 461 90 q 562 232 562 172 l 682 232 l 684 228 q 599 59 687 133 q 395 -14 512 -14 q 150 90 235 -14 q 65 352 65 194 l 65 381 q 150 642 65 537 q 395 747 236 747 q 605 671 524 747 q 685 484 687 595 l 683 480 l 562 480 q 515 594 562 547 q 395 641 467 641 q 245 566 290 641 q 200 381 200 490 l 200 352 q 244 165 200 240 q 395 90 289 90 m 363 946 l 462 1046 l 578 1046 l 578 1034 l 403 868 l 323 868 l 150 1032 l 150 1046 l 263 1046 l 363 946 "},"’":{"x_min":54.265625,"x_max":228.5625,"ha":284,"o":"m 228 927 l 120 692 l 54 692 l 94 925 l 94 1058 l 228 1058 l 228 927 "},"-":{"x_min":23.734375,"x_max":356.0625,"ha":380,"o":"m 356 364 l 23 364 l 23 469 l 356 469 l 356 364 "},"Q":{"x_min":76.640625,"x_max":908.140625,"ha":947,"o":"m 869 405 q 835 227 869 309 q 740 88 801 145 l 908 -69 l 816 -157 l 629 17 q 550 -6 591 1 q 465 -14 509 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 "},"M":{"x_min":122.078125,"x_max":1097.359375,"ha":1220,"o":"m 293 988 l 607 185 l 611 185 l 926 988 l 1097 988 l 1097 0 l 963 0 l 963 390 l 977 792 l 973 793 l 653 0 l 564 0 l 246 791 l 242 790 l 255 390 l 255 0 l 122 0 l 122 988 l 293 988 "},"œ":{"x_min":65.78125,"x_max":1209.265625,"ha":1257,"o":"m 929 -14 q 771 21 840 -14 q 658 122 702 57 q 548 21 615 57 q 394 -14 480 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 q 153 641 65 536 q 393 747 242 747 q 549 710 481 747 q 660 606 617 673 q 770 709 704 672 q 908 747 835 747 q 1133 657 1057 747 q 1209 419 1209 568 l 1209 336 l 733 336 l 731 332 q 784 158 733 226 q 929 90 836 90 q 1048 109 996 90 q 1136 163 1099 129 l 1188 76 q 1085 11 1149 37 q 929 -14 1020 -14 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 908 641 q 794 585 841 641 q 735 443 746 529 l 737 440 l 1075 440 l 1075 458 q 1033 589 1075 536 q 908 641 991 641 "},"ě":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 378 947 l 477 1047 l 593 1047 l 593 1035 l 418 869 l 338 869 l 165 1033 l 165 1047 l 278 1047 l 378 947 "},"Ộ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 682 1116 l 682 1100 l 573 1100 l 473 1200 l 374 1100 l 265 1100 l 265 1117 l 432 1278 l 514 1278 l 682 1116 m 547 -233 l 399 -233 l 399 -97 l 547 -97 l 547 -233 "},"ũ":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 628 1017 q 587 910 628 954 q 486 866 547 866 q 386 897 438 866 q 299 929 333 929 q 250 907 270 929 q 230 853 230 885 l 157 871 q 197 980 157 934 q 299 1027 237 1027 q 394 995 337 1027 q 486 963 451 963 q 534 985 514 963 q 555 1039 555 1007 l 628 1017 "},"Ậ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 657 1102 l 657 1086 l 548 1086 l 448 1186 l 349 1086 l 240 1086 l 240 1103 l 407 1264 l 489 1264 l 657 1102 m 523 -228 l 375 -228 l 375 -92 l 523 -92 l 523 -228 "},"ŭ":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 592 1035 l 594 1031 q 541 903 596 953 q 393 854 486 854 q 245 903 300 854 q 193 1031 190 953 l 195 1035 l 297 1035 q 320 963 297 991 q 393 935 343 935 q 466 963 442 935 q 490 1035 490 991 l 592 1035 "},"―":{"x_min":127.625,"x_max":1033.71875,"ha":1126,"o":"m 1033 439 l 127 439 l 127 545 l 1033 545 l 1033 439 "},"{":{"x_min":42.734375,"x_max":455.09375,"ha":472,"o":"m 427 -247 q 240 -128 295 -209 q 184 68 184 -46 l 184 207 q 149 325 184 283 q 42 368 114 368 l 42 468 q 149 509 114 468 q 184 628 184 551 l 184 767 q 240 964 184 883 q 427 1083 295 1045 l 455 1003 q 349 918 380 979 q 318 767 318 857 l 318 627 q 289 502 318 556 q 202 417 260 448 q 289 331 260 386 q 318 207 318 277 l 318 68 q 349 -81 318 -21 q 455 -166 380 -142 l 427 -247 "},"¼":{"x_min":124.4375,"x_max":1021,"ha":1082,"o":"m 328 450 l 210 450 l 210 894 l 124 894 l 124 985 l 328 1001 l 328 450 m 303 80 l 230 125 l 712 897 l 786 851 l 303 80 m 935 191 l 1021 191 l 1021 103 l 935 103 l 935 0 l 820 0 l 820 103 l 537 103 l 532 172 l 818 543 l 935 543 l 935 191 m 655 191 l 820 191 l 820 401 l 816 401 l 807 387 l 655 191 "},"#":{"x_min":47.46875,"x_max":804.375,"ha":865,"o":"m 482 278 l 309 278 l 255 0 l 153 0 l 207 278 l 47 278 l 47 373 l 226 373 l 272 608 l 99 608 l 99 705 l 291 705 l 347 988 l 449 988 l 394 705 l 567 705 l 622 988 l 725 988 l 669 705 l 804 705 l 804 608 l 651 608 l 604 373 l 753 373 l 753 278 l 585 278 l 531 0 l 428 0 l 482 278 m 328 373 l 501 373 l 548 608 l 375 608 l 328 373 "},"Ḿ":{"x_min":122.078125,"x_max":1097.359375,"ha":1220,"o":"m 293 988 l 607 185 l 611 185 l 926 988 l 1097 988 l 1097 0 l 963 0 l 963 390 l 977 792 l 973 793 l 653 0 l 564 0 l 246 791 l 242 790 l 255 390 l 255 0 l 122 0 l 122 988 l 293 988 m 674 1235 l 830 1235 l 831 1230 l 648 1054 l 548 1054 l 674 1235 "},"Ĳ":{"x_min":128.859375,"x_max":1046.125,"ha":1159,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 912 988 l 1046 988 l 1046 273 q 962 63 1046 141 q 745 -14 878 -14 q 518 58 602 -14 q 437 268 434 130 l 439 272 l 567 272 q 613 135 567 180 q 745 90 660 90 q 865 140 818 90 q 912 273 912 190 l 912 988 "},"Ê":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 634 1102 l 634 1086 l 525 1086 l 425 1186 l 326 1086 l 217 1086 l 217 1103 l 384 1264 l 466 1264 l 634 1102 "},")":{"x_min":4.0625,"x_max":368.28125,"ha":466,"o":"m 368 394 q 260 -61 368 126 q 33 -314 151 -250 l 29 -314 l 4 -240 q 165 -6 95 -169 q 234 393 234 156 l 234 402 q 163 798 234 634 q 4 1036 91 962 l 29 1110 l 33 1110 q 260 857 151 1046 q 368 401 368 668 l 368 394 "},"ș":{"x_min":73.734375,"x_max":657.203125,"ha":726,"o":"m 523 194 q 490 267 523 238 q 362 316 456 295 q 161 395 229 345 q 94 531 94 445 q 170 683 94 620 q 368 747 246 747 q 572 681 496 747 q 644 521 647 615 l 642 517 l 515 517 q 475 603 515 565 q 368 641 434 641 q 262 610 297 641 q 227 535 227 579 q 258 467 227 492 q 382 422 288 442 q 589 341 521 392 q 657 204 657 290 q 578 46 657 106 q 371 -14 499 -14 q 150 57 231 -14 q 73 223 69 128 l 75 227 l 202 227 q 255 123 206 156 q 371 90 305 90 q 483 119 442 90 q 523 194 523 148 m 411 -173 l 328 -334 l 262 -334 l 303 -167 l 303 -79 l 411 -79 l 411 -173 "},"Å":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 310 1176 q 351 1272 310 1233 q 451 1310 392 1310 q 549 1272 508 1310 q 590 1176 590 1234 q 549 1081 590 1118 q 451 1045 509 1045 q 351 1081 392 1045 q 310 1176 310 1118 m 380 1176 q 401 1126 380 1147 q 451 1106 422 1106 q 500 1126 479 1106 q 520 1176 520 1146 q 500 1228 520 1207 q 451 1249 479 1249 q 401 1228 422 1249 q 380 1176 380 1207 "},"¸":{"x_min":80.703125,"x_max":292.3125,"ha":345,"o":"m 198 0 l 189 -35 q 263 -70 233 -42 q 292 -152 292 -98 q 238 -256 292 -217 q 85 -295 185 -295 l 80 -221 q 159 -204 129 -221 q 189 -154 189 -187 q 164 -109 189 -122 q 81 -91 140 -96 l 103 0 l 198 0 "},"a":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 "},"Ę":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 487 0 q 412 -67 439 -35 q 386 -136 386 -99 q 401 -181 386 -164 q 451 -197 416 -197 q 485 -192 469 -197 q 518 -179 500 -187 l 540 -263 q 486 -284 516 -276 q 416 -293 457 -293 q 311 -255 352 -293 q 270 -151 270 -218 q 311 -48 270 -96 q 438 38 352 0 l 487 0 "},"=":{"x_min":103.09375,"x_max":668.734375,"ha":782,"o":"m 668 558 l 103 558 l 103 669 l 668 669 l 668 558 m 668 275 l 103 275 l 103 387 l 668 387 l 668 275 "},"ạ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 417 -228 l 269 -228 l 269 -92 l 417 -92 l 417 -228 "},"˚":{"x_min":90.203125,"x_max":370.3125,"ha":472,"o":"m 90 887 q 131 983 90 944 q 231 1021 172 1021 q 329 983 288 1021 q 370 887 370 945 q 329 792 370 829 q 231 756 289 756 q 131 792 172 756 q 90 887 90 829 m 160 887 q 181 837 160 858 q 231 817 202 817 q 280 837 259 817 q 300 887 300 857 q 280 939 300 918 q 231 960 259 960 q 181 939 202 960 q 160 887 160 918 "},"ú":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 457 1002 l 613 1002 l 614 998 l 431 822 l 331 822 l 457 1002 "},"¯":{"x_min":83.421875,"x_max":572.421875,"ha":644,"o":"m 572 888 l 83 888 l 83 987 l 572 987 l 572 888 "},"Z":{"x_min":65.78125,"x_max":768.421875,"ha":831,"o":"m 216 104 l 768 104 l 768 0 l 65 0 l 65 99 l 593 882 l 73 882 l 73 988 l 746 988 l 746 892 l 216 104 "},"":{"x_min":68.5,"x_max":217.03125,"ha":353,"o":"m 217 70 l 134 -90 l 68 -90 l 109 76 l 109 165 l 217 165 l 217 70 "}," ":{"x_min":0,"x_max":0,"ha":236},"u":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 "},"k":{"x_min":97.671875,"x_max":713.484375,"ha":712,"o":"m 318 338 l 231 338 l 231 0 l 97 0 l 97 1058 l 231 1058 l 231 445 l 316 445 l 517 734 l 677 734 l 426 400 l 713 0 l 556 0 l 318 338 "},"Ù":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 529 1057 l 422 1057 l 252 1233 l 254 1238 l 410 1238 l 529 1057 "},"⅝":{"x_min":80.140625,"x_max":1232.625,"ha":1306,"o":"m 98 678 l 133 987 l 483 987 l 483 896 l 237 896 l 219 771 q 266 791 239 783 q 321 801 293 800 q 462 753 411 802 q 513 617 513 704 q 459 485 513 534 q 292 437 405 437 q 138 474 199 437 q 80 583 76 511 l 81 587 l 190 594 q 218 543 190 561 q 292 525 246 525 q 371 548 345 525 q 397 616 397 571 q 371 688 397 661 q 299 716 344 716 q 232 704 255 716 q 199 672 209 693 l 98 678 m 454 75 l 381 120 l 863 892 l 937 846 l 454 75 m 1216 401 q 1191 330 1216 361 q 1124 281 1166 300 q 1203 229 1174 262 q 1232 153 1232 195 q 1169 35 1232 77 q 1012 -7 1107 -7 q 848 35 913 -7 q 782 153 782 77 q 813 229 782 195 q 894 282 843 263 q 825 331 850 300 q 799 401 799 361 q 859 512 799 473 q 1011 551 919 551 q 1158 512 1099 551 q 1216 401 1216 473 m 1117 157 q 1086 215 1117 192 q 1011 237 1054 237 q 931 215 964 237 q 898 157 898 193 q 931 101 898 122 q 1012 81 963 81 q 1086 101 1056 81 q 1117 157 1117 122 m 1099 395 q 1074 444 1099 426 q 1011 462 1048 462 q 943 444 970 462 q 916 395 916 426 q 944 345 916 364 q 1012 326 971 326 q 1073 345 1048 326 q 1099 395 1099 364 "},"ẻ":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 333 855 l 332 959 q 406 973 384 962 q 428 1008 428 983 q 398 1048 428 1035 q 319 1061 369 1061 l 324 1134 q 477 1099 424 1134 q 531 1006 531 1064 q 502 934 531 958 q 429 903 473 909 l 428 855 l 333 855 "},"ẵ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 566 997 l 568 993 q 518 892 572 931 q 371 853 463 853 q 224 892 278 853 q 174 993 169 931 l 175 997 l 275 997 q 298 940 275 962 q 371 918 321 918 q 443 940 419 918 q 466 997 466 962 l 566 997 m 566 1179 q 534 1092 566 1128 q 454 1055 502 1055 q 372 1081 415 1055 q 303 1107 330 1107 q 264 1089 280 1107 q 249 1046 249 1072 l 189 1061 q 221 1149 189 1111 q 303 1186 253 1186 q 379 1160 333 1186 q 454 1135 425 1135 q 492 1152 476 1135 q 508 1195 508 1169 l 566 1179 "},"Ů":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 331 1176 q 372 1272 331 1233 q 472 1310 413 1310 q 570 1272 529 1310 q 611 1176 611 1234 q 570 1081 611 1118 q 472 1045 530 1045 q 372 1081 413 1045 q 331 1176 331 1118 m 401 1176 q 422 1126 401 1147 q 472 1106 443 1106 q 521 1126 500 1106 q 541 1176 541 1146 q 521 1228 541 1207 q 472 1249 500 1249 q 422 1228 443 1249 q 401 1176 401 1207 "},"¢":{"x_min":72.5625,"x_max":692.53125,"ha":761,"o":"m 402 90 q 519 131 468 90 q 569 231 569 172 l 690 231 l 692 227 q 626 76 694 144 q 458 -9 557 7 l 458 -166 l 324 -166 l 324 -6 q 136 117 200 18 q 72 352 72 216 l 72 381 q 137 615 72 516 q 324 739 201 713 l 324 894 l 458 894 l 458 743 q 629 654 564 726 q 692 484 694 582 l 691 481 l 569 481 q 522 595 569 548 q 402 642 474 642 q 251 566 297 642 q 206 381 206 491 l 206 352 q 251 165 206 240 q 402 90 296 90 "},"ữ":{"x_min":94.265625,"x_max":938.046875,"ha":817,"o":"m 935 832 l 937 827 q 879 642 940 707 q 691 568 819 577 l 691 0 l 571 0 l 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 656 l 695 655 q 792 703 763 659 q 821 832 821 746 l 935 832 m 628 1017 q 587 910 628 954 q 486 866 547 866 q 386 897 438 866 q 299 929 333 929 q 250 907 270 929 q 230 853 230 885 l 157 871 q 197 980 157 934 q 299 1027 237 1027 q 394 995 337 1027 q 486 963 451 963 q 534 985 514 963 q 555 1039 555 1007 l 628 1017 "},"Ş":{"x_min":69.078125,"x_max":793.515625,"ha":866,"o":"m 659 249 q 609 362 659 316 q 428 439 558 408 q 184 549 271 477 q 96 732 96 622 q 190 924 96 847 q 436 1002 285 1002 q 694 913 598 1002 q 786 706 790 824 l 785 702 l 657 702 q 600 843 657 789 q 436 896 543 896 q 283 851 336 896 q 229 734 229 806 q 287 626 229 669 q 474 550 345 583 q 712 437 630 512 q 793 250 793 361 q 695 58 793 131 q 440 -14 598 -14 q 179 66 293 -14 q 69 280 65 146 l 70 284 l 198 284 q 267 139 198 189 q 440 90 337 90 q 600 133 541 90 q 659 249 659 175 m 467 -4 l 458 -40 q 532 -75 502 -47 q 561 -157 561 -103 q 507 -261 561 -222 q 354 -300 454 -300 l 349 -226 q 428 -209 398 -226 q 458 -159 458 -192 q 433 -114 458 -127 q 350 -96 409 -101 l 372 -4 l 467 -4 "},"é":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 443 1017 l 599 1017 l 600 1013 l 417 837 l 317 837 l 443 1017 "},"B":{"x_min":122.078125,"x_max":813.1875,"ha":888,"o":"m 122 0 l 122 988 l 444 988 q 686 921 598 988 q 773 720 773 854 q 731 602 773 654 q 621 525 689 551 q 761 438 710 506 q 813 278 813 369 q 725 71 813 143 q 486 0 637 0 l 122 0 m 255 463 l 255 104 l 486 104 q 628 149 577 104 q 679 277 679 194 q 637 413 679 364 q 506 463 594 463 l 255 463 m 255 568 l 472 568 q 593 609 546 568 q 640 723 640 650 q 589 843 640 803 q 444 882 539 882 l 255 882 l 255 568 "},"…":{"x_min":109.1875,"x_max":827.796875,"ha":936,"o":"m 242 0 l 109 0 l 109 137 l 242 137 l 242 0 m 542 0 l 409 0 l 409 137 l 542 137 l 542 0 m 827 0 l 694 0 l 694 137 l 827 137 l 827 0 "},"Ủ":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 428 1072 l 427 1176 q 501 1190 479 1179 q 523 1225 523 1200 q 493 1265 523 1252 q 414 1278 464 1278 l 419 1351 q 572 1316 519 1351 q 626 1223 626 1281 q 597 1151 626 1175 q 524 1120 568 1126 l 523 1072 l 428 1072 "},"ē":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 626 894 l 137 894 l 137 993 l 626 993 l 626 894 "},"H":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 735 435 l 255 435 l 255 0 l 122 0 l 122 988 l 255 988 l 255 541 l 735 541 l 735 988 l 868 988 l 868 0 "},"î":{"x_min":-35.03125,"x_max":381.40625,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 381 869 l 381 853 l 272 853 l 172 953 l 73 853 l -35 853 l -35 870 l 131 1031 l 213 1031 l 381 869 "},"ư":{"x_min":94.265625,"x_max":938.046875,"ha":817,"o":"m 935 832 l 937 827 q 879 642 940 707 q 691 568 819 577 l 691 0 l 571 0 l 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 656 l 695 655 q 792 703 763 659 q 821 832 821 746 l 935 832 "},"Ẹ":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 499 -221 l 351 -221 l 351 -85 l 499 -85 l 499 -221 "},"⅜":{"x_min":78.71875,"x_max":1199.625,"ha":1274,"o":"m 290 768 q 358 787 336 768 q 380 841 380 806 q 355 890 380 870 q 283 910 330 910 q 222 893 245 910 q 199 850 199 877 l 89 850 l 87 854 q 141 958 83 918 q 283 999 198 999 q 439 958 382 999 q 496 843 496 918 q 471 775 496 806 q 405 727 447 744 q 479 679 453 711 q 504 600 504 646 q 443 483 504 525 q 283 441 382 441 q 136 480 197 441 q 78 594 74 519 l 79 599 l 190 599 q 215 548 190 567 q 283 529 241 529 q 361 549 332 529 q 389 601 389 569 q 364 663 389 643 q 290 682 340 682 l 201 682 l 201 768 l 290 768 m 416 75 l 343 120 l 825 892 l 899 846 l 416 75 m 1183 401 q 1158 330 1183 361 q 1091 281 1133 300 q 1170 229 1141 262 q 1199 153 1199 195 q 1136 35 1199 77 q 979 -7 1074 -7 q 815 35 880 -7 q 749 153 749 77 q 780 229 749 195 q 861 282 810 263 q 792 331 817 300 q 766 401 766 361 q 826 512 766 473 q 978 551 886 551 q 1125 512 1066 551 q 1183 401 1183 473 m 1084 157 q 1053 215 1084 192 q 978 237 1021 237 q 898 215 931 237 q 865 157 865 193 q 898 101 865 122 q 979 81 930 81 q 1053 101 1023 81 q 1084 157 1084 122 m 1066 395 q 1041 444 1066 426 q 978 462 1015 462 q 910 444 937 462 q 883 395 883 426 q 911 345 883 364 q 979 326 938 326 q 1040 345 1015 326 q 1066 395 1066 364 "},"‼":{"x_min":115.96875,"x_max":616.265625,"ha":731,"o":"m 249 324 l 115 324 l 115 988 l 249 988 l 249 324 m 250 0 l 115 0 l 115 138 l 250 138 l 250 0 m 615 324 l 481 324 l 481 988 l 615 988 l 615 324 m 616 0 l 481 0 l 481 138 l 616 138 l 616 0 "},"ǰ":{"x_min":-46.125,"x_max":399.234375,"ha":355,"o":"m 249 734 l 249 -60 q 191 -234 249 -173 q 29 -296 132 -296 q -9 -292 8 -296 q -46 -283 -26 -289 l -36 -182 q -5 -188 -27 -185 q 29 -190 16 -190 q 92 -155 69 -190 q 115 -60 115 -121 l 115 734 l 249 734 m 184 920 l 283 1020 l 399 1020 l 399 1008 l 224 842 l 144 842 l -28 1006 l -28 1020 l 84 1020 l 184 920 "},"¥":{"x_min":20.34375,"x_max":813.1875,"ha":843,"o":"m 417 538 l 661 988 l 813 988 l 529 501 l 741 501 l 741 395 l 481 395 l 481 304 l 741 304 l 741 198 l 481 198 l 481 0 l 347 0 l 347 198 l 93 198 l 93 304 l 347 304 l 347 395 l 93 395 l 93 501 l 304 501 l 20 988 l 173 988 l 417 538 "},"Ĥ":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 735 435 l 255 435 l 255 0 l 122 0 l 122 988 l 255 988 l 255 541 l 735 541 l 735 988 l 868 988 l 868 0 m 697 1102 l 697 1086 l 588 1086 l 488 1186 l 389 1086 l 280 1086 l 280 1103 l 447 1264 l 529 1264 l 697 1102 "},"U":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 "},"Ñ":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 259 764 l 255 762 l 255 0 l 122 0 l 122 988 l 255 988 l 731 225 l 735 226 l 735 988 l 868 988 l 868 0 m 729 1249 q 688 1142 729 1186 q 587 1098 648 1098 q 487 1129 539 1098 q 400 1161 434 1161 q 351 1139 371 1161 q 331 1085 331 1117 l 258 1103 q 298 1212 258 1166 q 400 1259 338 1259 q 495 1227 438 1259 q 587 1195 552 1195 q 635 1217 615 1195 q 656 1271 656 1239 l 729 1249 "},"F":{"x_min":122.078125,"x_max":775.203125,"ha":809,"o":"m 706 436 l 255 436 l 255 0 l 122 0 l 122 988 l 775 988 l 775 882 l 255 882 l 255 542 l 706 542 l 706 436 "},"ả":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 331 854 l 330 958 q 404 972 382 961 q 426 1007 426 982 q 396 1047 426 1034 q 317 1060 367 1060 l 322 1133 q 475 1098 422 1133 q 529 1005 529 1063 q 500 933 529 957 q 427 902 471 908 l 426 854 l 331 854 "},"ĵ":{"x_min":-46.125,"x_max":393.40625,"ha":355,"o":"m 249 734 l 249 -60 q 191 -234 249 -173 q 29 -296 132 -296 q -9 -292 8 -296 q -46 -283 -26 -289 l -36 -182 q -5 -188 -27 -185 q 29 -190 16 -190 q 92 -155 69 -190 q 115 -60 115 -121 l 115 734 l 249 734 m 393 857 l 393 841 l 284 841 l 184 941 l 85 841 l -23 841 l -23 858 l 143 1019 l 225 1019 l 393 857 "},"ā":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 624 893 l 135 893 l 135 992 l 624 992 l 624 893 "},"Ĩ":{"x_min":-38.4375,"x_max":432.25,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 432 1249 q 391 1142 432 1186 q 290 1098 351 1098 q 190 1129 242 1098 q 103 1161 137 1161 q 54 1139 74 1161 q 34 1085 34 1117 l -38 1103 q 1 1212 -38 1166 q 103 1259 41 1259 q 198 1227 141 1259 q 290 1195 255 1195 q 338 1217 318 1195 q 359 1271 359 1239 l 432 1249 "},"ă":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 575 1049 l 577 1045 q 524 917 579 967 q 376 868 469 868 q 228 917 283 868 q 176 1045 173 967 l 178 1049 l 280 1049 q 303 977 280 1005 q 376 949 326 949 q 449 977 425 949 q 473 1049 473 1005 l 575 1049 "},"*":{"x_min":18.984375,"x_max":579.875,"ha":600,"o":"m 219 666 l 18 726 l 52 831 l 252 755 l 246 988 l 355 988 l 348 751 l 547 826 l 579 720 l 375 660 l 505 476 l 417 411 l 294 606 l 174 417 l 85 480 l 219 666 "},"†":{"x_min":47.46875,"x_max":718.921875,"ha":766,"o":"m 718 628 l 448 628 l 448 0 l 314 0 l 314 628 l 47 628 l 47 734 l 314 734 l 314 988 l 448 988 l 448 734 l 718 734 l 718 628 "},"ờ":{"x_min":65.78125,"x_max":851.84375,"ha":797,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 520 723 462 747 q 621 656 577 699 q 703 713 676 669 q 731 829 731 758 l 851 829 q 806 668 851 732 q 674 583 761 604 q 710 485 697 538 q 722 373 722 431 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 451 839 l 344 839 l 174 1015 l 176 1019 l 332 1019 l 451 839 "},"°":{"x_min":86.8125,"x_max":432.03125,"ha":517,"o":"m 86 824 q 138 949 86 896 q 261 1002 189 1002 q 381 949 330 1002 q 432 824 432 896 q 381 701 432 751 q 261 650 331 650 q 138 701 189 650 q 86 824 86 751 m 175 824 q 200 763 175 787 q 261 738 225 738 q 320 763 296 738 q 344 824 344 787 q 320 887 344 862 q 261 913 295 913 q 200 887 225 913 q 175 824 175 862 "},"å":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 234 958 q 275 1054 234 1015 q 375 1092 316 1092 q 473 1054 432 1092 q 514 958 514 1016 q 473 863 514 900 q 375 827 433 827 q 275 863 316 827 q 234 958 234 900 m 304 958 q 325 908 304 929 q 375 888 346 888 q 424 908 403 888 q 444 958 444 928 q 424 1010 444 989 q 375 1031 403 1031 q 325 1010 346 1031 q 304 958 304 989 "},"ồ":{"x_min":-44.96875,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 644 857 l 642 853 l 507 853 l 394 959 l 281 853 l 146 853 l 145 857 l 340 1031 l 448 1031 l 644 857 m 192 972 l 92 972 l -44 1148 l 97 1148 l 192 972 "},"0":{"x_min":76.640625,"x_max":705.359375,"ha":783,"o":"m 705 376 q 621 86 705 187 q 392 -14 537 -14 q 161 87 246 -14 q 76 376 76 188 l 76 610 q 161 900 76 799 q 390 1002 245 1002 q 620 900 536 1002 q 705 610 705 799 l 705 376 m 571 639 q 525 832 571 767 q 390 896 478 896 q 256 832 302 896 q 210 639 210 767 l 210 349 q 257 155 210 221 q 392 90 303 90 q 525 155 480 90 q 571 349 571 220 l 571 639 "},"ō":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 643 893 l 154 893 l 154 992 l 643 992 l 643 893 "},"”":{"x_min":54.265625,"x_max":457.5625,"ha":510,"o":"m 228 927 l 120 692 l 54 692 l 94 925 l 94 1058 l 228 1058 l 228 927 m 457 927 l 349 692 l 283 692 l 323 925 l 323 1058 l 457 1058 l 457 927 "},"ŵ":{"x_min":30.515625,"x_max":1017.328125,"ha":1051,"o":"m 284 267 l 300 178 l 304 178 l 323 267 l 470 734 l 577 734 l 724 267 l 745 168 l 749 168 l 769 267 l 884 734 l 1017 734 l 804 0 l 696 0 l 554 447 l 524 571 l 520 571 l 491 447 l 351 0 l 243 0 l 30 734 l 163 734 l 284 267 m 733 869 l 733 853 l 624 853 l 524 953 l 425 853 l 316 853 l 316 870 l 483 1031 l 565 1031 l 733 869 "},"Ķ":{"x_min":122.078125,"x_max":889.828125,"ha":893,"o":"m 370 445 l 255 445 l 255 0 l 122 0 l 122 988 l 255 988 l 255 551 l 358 551 l 712 988 l 859 988 l 862 984 l 478 510 l 889 3 l 887 0 l 728 0 l 370 445 m 479 -162 l 396 -323 l 330 -323 l 371 -156 l 371 -68 l 479 -68 l 479 -162 "},"ö":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 628 870 l 480 870 l 480 1005 l 628 1005 l 628 870 m 309 870 l 161 870 l 161 1005 l 309 1005 l 309 870 "},"ǽ":{"x_min":39.34375,"x_max":1125.84375,"ha":1173,"o":"m 855 -14 q 693 18 763 -14 q 577 112 622 51 q 464 22 539 59 q 280 -14 388 -14 q 102 45 164 -14 q 39 206 39 104 q 117 372 39 313 q 344 430 195 430 l 499 430 l 499 488 q 464 600 499 560 q 363 641 430 641 q 252 604 293 641 q 210 514 210 567 l 83 527 l 82 531 q 156 685 78 624 q 363 747 233 747 q 500 719 440 747 q 593 639 559 692 q 696 718 636 690 q 824 747 755 747 q 1047 658 969 747 q 1125 416 1125 570 l 1125 336 l 644 336 l 643 332 q 697 157 644 224 q 855 90 750 90 q 970 109 925 90 q 1068 162 1015 127 l 1114 68 q 1014 12 1078 38 q 855 -14 950 -14 m 306 90 q 414 119 358 90 q 499 188 470 149 l 499 334 l 345 334 q 218 296 264 334 q 172 203 172 258 q 206 121 172 153 q 306 90 240 90 m 824 641 q 700 584 747 641 q 646 437 653 527 l 647 434 l 992 434 l 992 455 q 951 589 992 537 q 824 641 910 641 m 647 1017 l 803 1017 l 804 1013 l 621 837 l 521 837 l 647 1017 "},"Ļ":{"x_min":122.078125,"x_max":722.984375,"ha":750,"o":"m 255 104 l 722 104 l 722 0 l 122 0 l 122 988 l 255 988 l 255 104 m 474 -160 l 391 -321 l 325 -321 l 366 -154 l 366 -66 l 474 -66 l 474 -160 "},"Õ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 709 1265 q 668 1157 709 1201 q 567 1113 628 1113 q 467 1144 519 1113 q 380 1176 414 1176 q 331 1154 351 1176 q 311 1101 311 1132 l 238 1118 q 278 1228 238 1181 q 380 1274 318 1274 q 475 1242 418 1274 q 567 1210 532 1210 q 615 1232 595 1210 q 636 1286 636 1254 l 709 1265 "},"ć":{"x_min":65.78125,"x_max":685.09375,"ha":737,"o":"m 395 90 q 512 131 461 90 q 562 232 562 172 l 682 232 l 684 228 q 599 59 687 133 q 395 -14 512 -14 q 150 90 235 -14 q 65 352 65 194 l 65 381 q 150 642 65 537 q 395 747 236 747 q 605 671 524 747 q 685 484 687 595 l 683 480 l 562 480 q 515 594 562 547 q 395 641 467 641 q 245 566 290 641 q 200 381 200 490 l 200 352 q 244 165 200 240 q 395 90 289 90 m 428 1017 l 584 1017 l 585 1013 l 402 837 l 302 837 l 428 1017 "},"þ":{"x_min":103.765625,"x_max":729.09375,"ha":804,"o":"m 729 339 q 653 83 729 180 q 443 -14 577 -14 q 324 8 375 -14 q 237 76 273 31 l 237 -282 l 103 -282 l 103 1058 l 237 1058 l 237 652 q 324 722 273 698 q 441 747 375 747 q 653 638 577 747 q 729 353 729 530 l 729 339 m 595 353 q 546 558 595 477 q 401 638 497 638 q 303 612 343 638 q 237 540 262 586 l 237 186 q 303 115 262 141 q 402 90 343 90 q 546 159 497 90 q 595 339 595 229 l 595 353 "},"]":{"x_min":7.453125,"x_max":269.25,"ha":374,"o":"m 7 1129 l 269 1129 l 269 -212 l 7 -212 l 7 -106 l 135 -106 l 135 1023 l 7 1023 l 7 1129 "},"′":{"x_min":54.265625,"x_max":188.546875,"ha":243,"o":"m 188 906 l 120 715 l 54 715 l 54 895 l 54 1058 l 188 1058 l 188 906 "},"ẁ":{"x_min":30.515625,"x_max":1017.328125,"ha":1051,"o":"m 284 267 l 300 178 l 304 178 l 323 267 l 470 734 l 577 734 l 724 267 l 745 168 l 749 168 l 769 267 l 884 734 l 1017 734 l 804 0 l 696 0 l 554 447 l 524 571 l 520 571 l 491 447 l 351 0 l 243 0 l 30 734 l 163 734 l 284 267 m 580 825 l 473 825 l 303 1001 l 305 1005 l 461 1005 l 580 825 "},"ệ":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 587 884 l 587 868 l 478 868 l 378 968 l 279 868 l 170 868 l 170 885 l 337 1046 l 419 1046 l 587 884 m 462 -228 l 314 -228 l 314 -92 l 462 -92 l 462 -228 "},"ĭ":{"x_min":-27.328125,"x_max":373.15625,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 371 1035 l 373 1031 q 320 903 375 953 q 172 854 265 854 q 24 903 79 854 q -27 1031 -30 953 l -25 1035 l 76 1035 q 99 963 76 991 q 172 935 122 935 q 245 963 221 935 q 269 1035 269 991 l 371 1035 "},"8":{"x_min":69.171875,"x_max":712.140625,"ha":782,"o":"m 685 729 q 641 594 685 652 q 524 508 598 536 q 660 414 609 478 q 712 267 712 350 q 622 58 712 130 q 391 -14 533 -14 q 157 58 246 -14 q 69 267 69 130 q 119 414 69 350 q 255 508 169 478 q 139 594 181 536 q 96 729 96 652 q 177 931 96 860 q 389 1002 257 1002 q 602 931 520 1002 q 685 729 685 860 m 579 270 q 525 403 579 351 q 389 455 472 455 q 254 403 306 455 q 202 270 202 351 q 254 138 202 186 q 391 90 305 90 q 526 138 474 90 q 579 270 579 186 m 551 727 q 505 848 551 800 q 389 896 459 896 q 274 850 318 896 q 230 727 230 803 q 275 606 230 651 q 391 561 319 561 q 506 606 461 561 q 551 727 551 651 "},"Ữ":{"x_min":99.703125,"x_max":1099.4375,"ha":970,"o":"m 843 988 l 843 866 l 847 865 q 937 938 906 883 q 968 1079 968 994 l 1097 1079 l 1099 1075 q 1034 862 1100 944 q 843 756 967 779 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 707 1249 q 666 1142 707 1186 q 565 1098 626 1098 q 465 1129 517 1098 q 378 1161 412 1161 q 329 1139 349 1161 q 309 1085 309 1117 l 236 1103 q 276 1212 236 1166 q 378 1259 316 1259 q 473 1227 416 1259 q 565 1195 530 1195 q 613 1217 593 1195 q 634 1271 634 1239 l 707 1249 "},"R":{"x_min":122.078125,"x_max":855.234375,"ha":920,"o":"m 255 428 l 255 0 l 122 0 l 122 987 l 479 987 q 727 915 641 987 q 812 706 812 843 q 772 573 812 630 q 657 484 733 517 q 774 398 738 457 q 809 251 809 339 l 809 158 q 819 75 809 112 q 855 16 830 39 l 855 0 l 717 0 q 683 67 691 23 q 676 160 676 112 l 676 250 q 629 379 676 330 q 503 428 582 428 l 255 428 m 255 533 l 465 533 q 629 576 579 533 q 678 707 678 619 q 630 836 678 790 q 479 882 581 882 l 255 882 l 255 533 "},"ť":{"x_min":23.0625,"x_max":518.03125,"ha":507,"o":"m 273 911 l 273 734 l 412 734 l 412 634 l 273 634 l 273 189 q 294 116 273 137 q 351 95 316 95 q 376 98 362 95 q 401 105 390 101 l 419 13 q 375 -6 404 1 q 317 -14 346 -14 q 187 35 236 -14 q 139 189 139 84 l 139 634 l 23 634 l 23 734 l 139 734 l 139 911 l 273 911 m 518 982 l 435 821 l 369 821 l 410 988 l 410 1077 l 518 1077 l 518 982 "},"Ľ":{"x_min":122.078125,"x_max":722.984375,"ha":750,"o":"m 255 104 l 722 104 l 722 0 l 122 0 l 122 988 l 255 988 l 255 104 m 544 893 l 461 732 l 395 732 l 436 899 l 436 988 l 544 988 l 544 893 "},"Ż":{"x_min":65.78125,"x_max":768.421875,"ha":831,"o":"m 216 104 l 768 104 l 768 0 l 65 0 l 65 99 l 593 882 l 73 882 l 73 988 l 746 988 l 746 892 l 216 104 m 487 1088 l 339 1088 l 339 1224 l 487 1224 l 487 1088 "},"o":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 "},"5":{"x_min":106.359375,"x_max":707.390625,"ha":782,"o":"m 118 445 l 175 988 l 670 988 l 670 869 l 288 869 l 256 591 q 325 629 287 614 q 414 646 364 644 q 629 557 550 647 q 707 314 707 467 q 627 76 707 166 q 395 -14 548 -14 q 186 54 269 -14 q 106 255 103 123 l 107 260 l 228 260 q 275 134 228 179 q 395 90 321 90 q 526 150 480 90 q 573 313 573 209 q 526 469 573 408 q 395 530 478 530 q 281 506 316 530 q 229 433 246 482 l 118 445 "},"ħ":{"x_min":0.671875,"x_max":714.84375,"ha":810,"o":"m 435 834 l 250 834 l 250 635 q 344 717 288 687 q 466 747 399 747 q 649 676 583 747 q 714 459 714 606 l 714 0 l 581 0 l 581 460 q 542 595 581 551 q 425 638 503 638 q 325 612 370 638 q 250 541 280 586 l 250 0 l 117 0 l 117 834 l 0 834 l 0 940 l 117 940 l 117 1058 l 250 1058 l 250 940 l 435 940 l 435 834 "},"õ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 630 1031 q 589 924 630 968 q 488 880 549 880 q 388 911 440 880 q 301 943 335 943 q 252 921 272 943 q 232 867 232 899 l 159 885 q 199 994 159 948 q 301 1041 239 1041 q 396 1009 339 1041 q 488 977 453 977 q 536 999 516 977 q 557 1053 557 1021 l 630 1031 "},"ẫ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 623 846 l 621 842 l 506 842 l 373 961 l 240 842 l 125 842 l 124 846 l 320 1020 l 427 1020 l 623 846 m 550 1189 q 517 1106 550 1143 q 439 1070 484 1070 q 365 1094 404 1070 q 301 1118 327 1118 q 263 1098 280 1118 q 246 1055 246 1078 l 191 1068 q 224 1152 191 1115 q 301 1190 256 1190 q 371 1167 330 1190 q 439 1143 413 1143 q 478 1162 460 1143 q 496 1205 496 1181 l 550 1189 "},",":{"x_min":32.5625,"x_max":213.640625,"ha":274,"o":"m 213 32 l 111 -174 l 32 -174 l 80 39 l 80 150 l 213 150 l 213 32 "},"d":{"x_min":66.46875,"x_max":687.046875,"ha":789,"o":"m 66 353 q 142 638 66 530 q 354 747 217 747 q 468 723 418 747 q 553 654 518 699 l 553 1058 l 687 1058 l 687 0 l 577 0 l 562 90 q 474 12 526 38 q 352 -14 421 -14 q 142 83 218 -14 q 66 339 66 180 l 66 353 m 200 339 q 245 161 200 227 q 386 94 290 94 q 486 121 446 94 q 553 197 527 148 l 553 539 q 486 611 527 584 q 387 638 445 638 q 245 559 291 638 q 200 353 200 479 l 200 339 "},"\"":{"x_min":54.265625,"x_max":398.109375,"ha":453,"o":"m 188 874 l 120 705 l 54 705 l 54 868 l 54 1058 l 188 1058 l 188 874 m 398 874 l 329 705 l 263 705 l 264 873 l 264 1058 l 398 1058 l 398 874 "},"˙":{"x_min":108.515625,"x_max":256.375,"ha":377,"o":"m 256 851 l 108 851 l 108 987 l 256 987 l 256 851 "},"ê":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 587 884 l 587 868 l 478 868 l 378 968 l 279 868 l 170 868 l 170 885 l 337 1046 l 419 1046 l 587 884 "},"″":{"x_min":54.265625,"x_max":398.109375,"ha":453,"o":"m 188 874 l 120 705 l 54 705 l 54 868 l 54 1058 l 188 1058 l 188 874 m 398 874 l 329 705 l 263 705 l 264 873 l 264 1058 l 398 1058 l 398 874 "},"„":{"x_min":54.265625,"x_max":437.453125,"ha":492,"o":"m 228 65 l 120 -162 l 54 -162 l 94 58 l 94 190 l 228 190 l 228 65 m 437 65 l 328 -162 l 263 -162 l 303 63 l 303 190 l 437 190 l 437 65 "},"ľ":{"x_min":107.84375,"x_max":456.03125,"ha":452,"o":"m 241 0 l 107 0 l 107 1058 l 241 1058 l 241 0 m 456 963 l 373 802 l 307 802 l 348 969 l 348 1058 l 456 1058 l 456 963 "},"Â":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 657 1102 l 657 1086 l 548 1086 l 448 1186 l 349 1086 l 240 1086 l 240 1103 l 407 1264 l 489 1264 l 657 1102 "},"Į":{"x_min":31.125,"x_max":301.734375,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 248 0 q 173 -67 200 -35 q 147 -136 147 -99 q 162 -181 147 -164 q 212 -197 177 -197 q 246 -192 230 -197 q 279 -179 261 -187 l 301 -263 q 247 -284 277 -276 q 177 -293 218 -293 q 72 -255 113 -293 q 31 -151 31 -218 q 72 -48 31 -96 q 199 38 113 0 l 248 0 "},"ė":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 452 870 l 304 870 l 304 1006 l 452 1006 l 452 870 "},"ề":{"x_min":-60.96875,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 628 858 l 626 854 l 491 854 l 378 960 l 265 854 l 130 854 l 129 858 l 324 1032 l 432 1032 l 628 858 m 176 973 l 76 973 l -60 1149 l 81 1149 l 176 973 "},"Ţ":{"x_min":23.0625,"x_max":790.8125,"ha":814,"o":"m 790 882 l 473 882 l 473 0 l 339 0 l 339 882 l 23 882 l 23 988 l 790 988 l 790 882 m 457 -160 l 374 -321 l 308 -321 l 349 -154 l 349 -66 l 457 -66 l 457 -160 "},"Í":{"x_min":128.859375,"x_max":417.671875,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 260 1235 l 416 1235 l 417 1230 l 234 1054 l 134 1054 l 260 1235 "},"´":{"x_min":88.84375,"x_max":371.671875,"ha":444,"o":"m 214 1001 l 370 1001 l 371 997 l 188 821 l 88 821 l 214 1001 "},"Ơ":{"x_min":73.25,"x_max":1041.078125,"ha":952,"o":"m 866 405 q 753 105 866 224 q 462 -14 641 -14 q 181 105 289 -14 q 73 405 73 224 l 73 581 q 181 881 73 761 q 462 1002 289 1002 q 613 974 543 1002 q 737 898 683 947 q 864 963 820 905 q 907 1121 907 1021 l 1041 1121 q 981 908 1041 990 q 811 801 921 826 q 851 697 837 753 q 866 581 866 640 l 866 405 m 732 582 q 659 805 732 718 q 462 892 585 892 q 276 805 345 892 q 206 582 206 718 l 206 405 q 276 182 206 268 q 462 95 345 95 q 659 181 586 95 q 732 405 732 268 l 732 582 "},"Ú":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 537 1235 l 693 1235 l 694 1230 l 511 1054 l 411 1054 l 537 1235 "}," ":{"x_min":0,"x_max":0,"ha":284},"Ŷ":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 632 1101 l 632 1085 l 523 1085 l 423 1185 l 324 1085 l 215 1085 l 215 1102 l 382 1263 l 464 1263 l 632 1101 "},"ỏ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 350 854 l 349 958 q 423 972 401 961 q 445 1007 445 982 q 415 1047 445 1034 q 336 1060 386 1060 l 341 1133 q 494 1098 441 1133 q 548 1005 548 1063 q 519 933 548 957 q 446 902 490 908 l 445 854 l 350 854 "},"Ự":{"x_min":99.703125,"x_max":1099.4375,"ha":970,"o":"m 843 988 l 843 866 l 847 865 q 937 938 906 883 q 968 1079 968 994 l 1097 1079 l 1099 1075 q 1034 862 1100 944 q 843 756 967 779 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 545 -233 l 397 -233 l 397 -97 l 545 -97 l 545 -233 "},"ŝ":{"x_min":73.734375,"x_max":657.203125,"ha":726,"o":"m 523 194 q 490 267 523 238 q 362 316 456 295 q 161 395 229 345 q 94 531 94 445 q 170 683 94 620 q 368 747 246 747 q 572 681 496 747 q 644 521 647 615 l 642 517 l 515 517 q 475 603 515 565 q 368 641 434 641 q 262 610 297 641 q 227 535 227 579 q 258 467 227 492 q 382 422 288 442 q 589 341 521 392 q 657 204 657 290 q 578 46 657 106 q 371 -14 499 -14 q 150 57 231 -14 q 73 223 69 128 l 75 227 l 202 227 q 255 123 206 156 q 371 90 305 90 q 483 119 442 90 q 523 194 523 148 m 571 883 l 571 867 l 462 867 l 362 967 l 263 867 l 154 867 l 154 884 l 321 1045 l 403 1045 l 571 883 "},"Ý":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 488 1234 l 644 1234 l 645 1229 l 462 1053 l 362 1053 l 488 1234 "},"Ĉ":{"x_min":80.03125,"x_max":821.40625,"ha":880,"o":"m 819 316 l 821 312 q 723 79 824 173 q 458 -14 623 -14 q 185 104 290 -14 q 80 405 80 223 l 80 581 q 185 882 80 763 q 458 1002 290 1002 q 725 912 626 1002 q 821 676 824 823 l 819 672 l 691 672 q 630 836 691 776 q 458 896 569 896 q 280 806 346 896 q 213 582 213 716 l 213 405 q 280 180 213 270 q 458 90 346 90 q 630 150 569 90 q 691 316 691 210 l 819 316 m 668 1116 l 668 1100 l 559 1100 l 459 1200 l 360 1100 l 251 1100 l 251 1117 l 418 1278 l 500 1278 l 668 1116 "}," ":{"x_min":0,"x_max":0,"ha":1417},"ą":{"x_min":71.890625,"x_max":722.734375,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 669 0 q 594 -67 621 -35 q 568 -136 568 -99 q 583 -181 568 -164 q 633 -197 598 -197 q 667 -192 651 -197 q 700 -179 682 -187 l 722 -263 q 668 -284 698 -276 q 598 -293 639 -293 q 493 -255 534 -293 q 452 -151 452 -218 q 493 -48 452 -96 q 620 38 534 0 l 669 0 "},"Ờ":{"x_min":73.25,"x_max":1041.078125,"ha":952,"o":"m 866 405 q 753 105 866 224 q 462 -14 641 -14 q 181 105 289 -14 q 73 405 73 224 l 73 581 q 181 881 73 761 q 462 1002 289 1002 q 613 974 543 1002 q 737 898 683 947 q 864 963 820 905 q 907 1121 907 1021 l 1041 1121 q 981 908 1041 990 q 811 801 921 826 q 851 697 837 753 q 866 581 866 640 l 866 405 m 732 582 q 659 805 732 718 q 462 892 585 892 q 276 805 345 892 q 206 582 206 718 l 206 405 q 276 182 206 268 q 462 95 345 95 q 659 181 586 95 q 732 405 732 268 l 732 582 m 531 1045 l 424 1045 l 254 1221 l 256 1225 l 412 1225 l 531 1045 "},"​":{"x_min":0,"x_max":0,"ha":0},"Ö":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 707 1103 l 559 1103 l 559 1238 l 707 1238 l 707 1103 m 388 1103 l 240 1103 l 240 1238 l 388 1238 l 388 1103 "},"z":{"x_min":63.75,"x_max":647.03125,"ha":699,"o":"m 223 104 l 647 104 l 647 0 l 63 0 l 63 93 l 460 628 l 68 628 l 68 734 l 623 734 l 623 643 l 223 104 "},"ặ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 575 1049 l 577 1045 q 524 917 579 967 q 376 868 469 868 q 228 917 283 868 q 176 1045 173 967 l 178 1049 l 280 1049 q 303 977 280 1005 q 376 949 326 949 q 449 977 425 949 q 473 1049 473 1005 l 575 1049 m 417 -228 l 269 -228 l 269 -92 l 417 -92 l 417 -228 "},"Ř":{"x_min":122.078125,"x_max":855.234375,"ha":920,"o":"m 255 428 l 255 0 l 122 0 l 122 987 l 479 987 q 727 915 641 987 q 812 706 812 843 q 772 573 812 630 q 657 484 733 517 q 774 398 738 457 q 809 251 809 339 l 809 158 q 819 75 809 112 q 855 16 830 39 l 855 0 l 717 0 q 683 67 691 23 q 676 160 676 112 l 676 250 q 629 379 676 330 q 503 428 582 428 l 255 428 m 255 533 l 465 533 q 629 576 579 533 q 678 707 678 619 q 630 836 678 790 q 479 882 581 882 l 255 882 l 255 533 m 420 1164 l 519 1264 l 635 1264 l 635 1252 l 460 1086 l 380 1086 l 207 1250 l 207 1264 l 320 1264 l 420 1164 "},"Ắ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 650 1218 l 652 1214 q 600 1115 656 1154 q 450 1077 544 1077 q 300 1115 355 1077 q 249 1214 244 1154 l 250 1218 l 353 1218 q 376 1162 353 1184 q 450 1141 399 1141 q 523 1162 500 1141 q 547 1218 547 1184 l 650 1218 m 484 1367 l 589 1367 l 591 1363 l 483 1233 l 411 1233 l 484 1367 "},"ã":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 612 1031 q 571 924 612 968 q 470 880 531 880 q 370 911 422 880 q 283 943 317 943 q 234 921 254 943 q 214 867 214 899 l 141 885 q 181 994 141 948 q 283 1041 221 1041 q 378 1009 321 1041 q 470 977 435 977 q 518 999 498 977 q 539 1053 539 1021 l 612 1031 "},"Ň":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 259 764 l 255 762 l 255 0 l 122 0 l 122 988 l 255 988 l 731 225 l 735 226 l 735 988 l 868 988 l 868 0 m 493 1164 l 592 1264 l 708 1264 l 708 1252 l 533 1086 l 453 1086 l 280 1250 l 280 1264 l 393 1264 l 493 1164 "},"æ":{"x_min":39.34375,"x_max":1125.84375,"ha":1173,"o":"m 855 -14 q 693 18 763 -14 q 577 112 622 51 q 464 22 539 59 q 280 -14 388 -14 q 102 45 164 -14 q 39 206 39 104 q 117 372 39 313 q 344 430 195 430 l 499 430 l 499 488 q 464 600 499 560 q 363 641 430 641 q 252 604 293 641 q 210 514 210 567 l 83 527 l 82 531 q 156 685 78 624 q 363 747 233 747 q 500 719 440 747 q 593 639 559 692 q 696 718 636 690 q 824 747 755 747 q 1047 658 969 747 q 1125 416 1125 570 l 1125 336 l 644 336 l 643 332 q 697 157 644 224 q 855 90 750 90 q 970 109 925 90 q 1068 162 1015 127 l 1114 68 q 1014 12 1078 38 q 855 -14 950 -14 m 306 90 q 414 119 358 90 q 499 188 470 149 l 499 334 l 345 334 q 218 296 264 334 q 172 203 172 258 q 206 121 172 153 q 306 90 240 90 m 824 641 q 700 584 747 641 q 646 437 653 527 l 647 434 l 992 434 l 992 455 q 951 589 992 537 q 824 641 910 641 "},"ừ":{"x_min":94.265625,"x_max":938.046875,"ha":817,"o":"m 935 832 l 937 827 q 879 642 940 707 q 691 568 819 577 l 691 0 l 571 0 l 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 656 l 695 655 q 792 703 763 659 q 821 832 821 746 l 935 832 m 449 825 l 342 825 l 172 1001 l 174 1005 l 330 1005 l 449 825 "},"Ợ":{"x_min":73.25,"x_max":1041.078125,"ha":952,"o":"m 866 405 q 753 105 866 224 q 462 -14 641 -14 q 181 105 289 -14 q 73 405 73 224 l 73 581 q 181 881 73 761 q 462 1002 289 1002 q 613 974 543 1002 q 737 898 683 947 q 864 963 820 905 q 907 1121 907 1021 l 1041 1121 q 981 908 1041 990 q 811 801 921 826 q 851 697 837 753 q 866 581 866 640 l 866 405 m 732 582 q 659 805 732 718 q 462 892 585 892 q 276 805 345 892 q 206 582 206 718 l 206 405 q 276 182 206 268 q 462 95 345 95 q 659 181 586 95 q 732 405 732 268 l 732 582 m 543 -228 l 395 -228 l 395 -92 l 543 -92 l 543 -228 "},"ĩ":{"x_min":-63.4375,"x_max":407.25,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 407 1017 q 366 910 407 954 q 265 866 326 866 q 165 897 217 866 q 78 929 112 929 q 29 907 49 929 q 9 853 9 885 l -63 871 q -23 980 -63 934 q 78 1027 16 1027 q 173 995 116 1027 q 265 963 230 963 q 313 985 293 963 q 334 1039 334 1007 l 407 1017 "},"É":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 490 1235 l 646 1235 l 647 1230 l 464 1054 l 364 1054 l 490 1235 "},"ŀ":{"x_min":107.84375,"x_max":476.375,"ha":499,"o":"m 241 0 l 107 0 l 107 1058 l 241 1058 l 241 0 m 476 454 l 328 454 l 328 591 l 476 591 l 476 454 "},"~":{"x_min":86.8125,"x_max":857.28125,"ha":943,"o":"m 857 502 q 798 340 857 409 q 651 272 739 272 q 540 294 590 272 q 432 367 490 317 q 359 416 392 399 q 292 432 326 432 q 214 396 246 432 q 182 309 182 360 l 86 321 q 144 479 86 414 q 292 545 202 545 q 402 521 352 545 q 511 450 453 498 q 583 400 550 416 q 651 384 615 384 q 728 423 695 384 q 761 514 761 462 l 857 502 "},"Ċ":{"x_min":80.03125,"x_max":821.40625,"ha":880,"o":"m 819 316 l 821 312 q 723 79 824 173 q 458 -14 623 -14 q 185 104 290 -14 q 80 405 80 223 l 80 581 q 185 882 80 763 q 458 1002 290 1002 q 725 912 626 1002 q 821 676 824 823 l 819 672 l 691 672 q 630 836 691 776 q 458 896 569 896 q 280 806 346 896 q 213 582 213 716 l 213 405 q 280 180 213 270 q 458 90 346 90 q 630 150 569 90 q 691 316 691 210 l 819 316 m 533 1102 l 385 1102 l 385 1238 l 533 1238 l 533 1102 "},"³":{"x_min":75.71875,"x_max":501.890625,"ha":594,"o":"m 287 771 q 355 790 333 771 q 377 844 377 809 q 352 893 377 873 q 280 913 327 913 q 219 896 242 913 q 196 853 196 880 l 86 853 l 84 857 q 138 961 80 921 q 280 1002 195 1002 q 436 961 379 1002 q 493 846 493 921 q 468 778 493 809 q 402 730 444 747 q 476 682 450 714 q 501 603 501 649 q 440 485 501 528 q 280 443 379 443 q 133 483 194 443 q 75 597 71 522 l 76 601 l 187 601 q 212 551 187 570 q 280 532 238 532 q 358 552 329 532 q 386 604 386 572 q 361 666 386 646 q 287 685 337 685 l 198 685 l 198 771 l 287 771 "},"¡":{"x_min":97.671875,"x_max":231.28125,"ha":344,"o":"m 231 -254 l 97 -254 l 97 409 l 231 409 l 231 -254 m 231 594 l 97 594 l 97 734 l 231 734 l 231 594 "},"ẅ":{"x_min":30.515625,"x_max":1017.328125,"ha":1051,"o":"m 284 267 l 300 178 l 304 178 l 323 267 l 470 734 l 577 734 l 724 267 l 745 168 l 749 168 l 769 267 l 884 734 l 1017 734 l 804 0 l 696 0 l 554 447 l 524 571 l 520 571 l 491 447 l 351 0 l 243 0 l 30 734 l 163 734 l 284 267 m 758 856 l 610 856 l 610 991 l 758 991 l 758 856 m 439 856 l 291 856 l 291 991 l 439 991 l 439 856 "},"ậ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 585 883 l 585 867 l 476 867 l 376 967 l 277 867 l 168 867 l 168 884 l 335 1045 l 417 1045 l 585 883 m 417 -228 l 269 -228 l 269 -92 l 417 -92 l 417 -228 "},"[":{"x_min":96.984375,"x_max":358.109375,"ha":374,"o":"m 358 1023 l 230 1023 l 230 -106 l 358 -106 l 358 -212 l 96 -212 l 96 1129 l 358 1129 l 358 1023 "},"Ử":{"x_min":99.703125,"x_max":1099.4375,"ha":970,"o":"m 843 988 l 843 866 l 847 865 q 937 938 906 883 q 968 1079 968 994 l 1097 1079 l 1099 1075 q 1034 862 1100 944 q 843 756 967 779 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 427 1072 l 426 1176 q 500 1190 478 1179 q 522 1225 522 1200 q 492 1265 522 1252 q 413 1278 463 1278 l 418 1351 q 571 1316 518 1351 q 625 1223 625 1281 q 596 1151 625 1175 q 523 1120 567 1126 l 522 1072 l 427 1072 "},"%":{"x_min":70.53125,"x_max":956.96875,"ha":1016,"o":"m 70 797 q 126 942 70 883 q 274 1002 181 1002 q 423 943 367 1002 q 478 797 478 884 l 478 745 q 423 601 478 659 q 276 542 368 542 q 126 601 182 542 q 70 745 70 659 l 70 797 m 169 745 q 197 660 169 695 q 276 625 224 625 q 352 660 325 625 q 379 745 379 694 l 379 797 q 352 883 379 848 q 274 919 324 919 q 196 883 223 919 q 169 797 169 848 l 169 745 m 548 242 q 604 387 548 328 q 752 445 659 445 q 901 387 845 445 q 956 242 956 328 l 956 189 q 901 44 956 102 q 754 -14 845 -14 q 604 44 660 -14 q 548 189 548 102 l 548 242 m 647 189 q 675 103 647 138 q 754 68 702 68 q 830 103 803 68 q 857 189 857 138 l 857 242 q 830 327 857 292 q 752 363 802 363 q 675 327 702 363 q 647 242 647 292 l 647 189 m 310 75 l 236 120 l 718 892 l 792 846 l 310 75 "},"P":{"x_min":122.078125,"x_max":832.859375,"ha":890,"o":"m 255 396 l 255 0 l 122 0 l 122 988 l 499 988 q 745 906 657 988 q 832 692 832 825 q 745 476 832 556 q 499 396 657 396 l 255 396 m 255 500 l 499 500 q 649 554 600 500 q 699 690 699 608 q 649 827 699 772 q 499 882 599 882 l 255 882 l 255 500 "},"_":{"x_min":2.71875,"x_max":628.71875,"ha":631,"o":"m 628 -104 l 2 -104 l 2 0 l 628 0 l 628 -104 "},"Ŕ":{"x_min":122.078125,"x_max":855.234375,"ha":920,"o":"m 255 428 l 255 0 l 122 0 l 122 987 l 479 987 q 727 915 641 987 q 812 706 812 843 q 772 573 812 630 q 657 484 733 517 q 774 398 738 457 q 809 251 809 339 l 809 158 q 819 75 809 112 q 855 16 830 39 l 855 0 l 717 0 q 683 67 691 23 q 676 160 676 112 l 676 250 q 629 379 676 330 q 503 428 582 428 l 255 428 m 255 533 l 465 533 q 629 576 579 533 q 678 707 678 619 q 630 836 678 790 q 479 882 581 882 l 255 882 l 255 533 m 485 1235 l 641 1235 l 642 1230 l 459 1054 l 359 1054 l 485 1235 "},"ñ":{"x_min":96.984375,"x_max":692.46875,"ha":789,"o":"m 216 734 l 225 624 q 317 715 262 683 q 443 747 373 747 q 627 677 562 747 q 692 462 692 608 l 692 0 l 558 0 l 558 460 q 520 597 558 557 q 403 638 482 638 q 301 610 345 638 q 230 534 257 582 l 230 0 l 96 0 l 96 734 l 216 734 m 627 1031 q 586 924 627 968 q 485 880 546 880 q 385 911 437 880 q 298 943 332 943 q 249 921 269 943 q 229 867 229 899 l 156 885 q 196 994 156 948 q 298 1041 236 1041 q 393 1009 336 1041 q 485 977 450 977 q 533 999 513 977 q 554 1053 554 1021 l 627 1031 "},"‚":{"x_min":54.265625,"x_max":228.5625,"ha":283,"o":"m 228 17 l 120 -172 l 54 -172 l 94 5 l 94 169 l 228 169 l 228 17 "},"⅞":{"x_min":72.4375,"x_max":1118.625,"ha":1193,"o":"m 471 898 q 343 722 381 791 q 305 530 305 653 l 305 444 l 189 444 l 189 530 q 241 747 189 652 q 354 898 294 841 l 72 898 l 72 987 l 471 987 l 471 898 m 323 75 l 250 120 l 732 892 l 806 846 l 323 75 m 1102 401 q 1077 330 1102 361 q 1010 281 1052 300 q 1089 229 1060 262 q 1118 153 1118 195 q 1055 35 1118 77 q 898 -7 993 -7 q 734 35 799 -7 q 668 153 668 77 q 699 229 668 195 q 780 282 729 263 q 711 331 736 300 q 685 401 685 361 q 745 512 685 473 q 897 551 805 551 q 1044 512 985 551 q 1102 401 1102 473 m 1003 157 q 972 215 1003 192 q 897 237 940 237 q 817 215 850 237 q 784 157 784 193 q 817 101 784 122 q 898 81 849 81 q 972 101 942 81 q 1003 157 1003 122 m 985 395 q 960 444 985 426 q 897 462 934 462 q 829 444 856 462 q 802 395 802 426 q 830 345 802 364 q 898 326 857 326 q 959 345 934 326 q 985 395 985 364 "},"Æ":{"x_min":-13.5625,"x_max":1281.15625,"ha":1304,"o":"m 1281 0 l 674 0 l 663 238 l 286 238 l 149 0 l -13 0 l 583 988 l 1239 988 l 1239 882 l 770 882 l 784 566 l 1184 566 l 1184 460 l 788 460 l 803 104 l 1281 104 l 1281 0 m 356 359 l 659 359 l 638 840 l 634 842 l 356 359 "},"₣":{"x_min":19.015625,"x_max":775.203125,"ha":809,"o":"m 706 436 l 255 436 l 255 0 l 122 0 l 122 988 l 775 988 l 775 882 l 255 882 l 255 542 l 706 542 l 706 436 m 453 179 l 19 179 l 19 285 l 453 285 l 453 179 "},"ğ":{"x_min":67.828125,"x_max":692.46875,"ha":789,"o":"m 67 353 q 145 638 67 530 q 358 747 222 747 q 481 719 428 747 q 569 638 534 691 l 585 734 l 692 734 l 692 -3 q 610 -220 692 -144 q 373 -296 528 -296 q 259 -281 320 -296 q 151 -241 198 -266 l 185 -137 q 271 -170 221 -158 q 372 -183 322 -183 q 514 -139 470 -183 q 558 -3 558 -94 l 558 78 q 472 9 522 32 q 357 -14 422 -14 q 145 83 222 -14 q 67 339 67 181 l 67 353 m 201 339 q 248 161 201 228 q 390 94 295 94 q 491 121 451 94 q 558 199 532 149 l 558 536 q 491 611 533 583 q 392 638 450 638 q 248 558 296 638 q 201 353 201 478 l 201 339 m 581 1049 l 583 1045 q 530 917 585 967 q 382 868 475 868 q 234 917 289 868 q 182 1045 179 967 l 184 1049 l 286 1049 q 309 977 286 1005 q 382 949 332 949 q 455 977 431 949 q 479 1049 479 1005 l 581 1049 "},"Ở":{"x_min":73.25,"x_max":1041.078125,"ha":952,"o":"m 866 405 q 753 105 866 224 q 462 -14 641 -14 q 181 105 289 -14 q 73 405 73 224 l 73 581 q 181 881 73 761 q 462 1002 289 1002 q 613 974 543 1002 q 737 898 683 947 q 864 963 820 905 q 907 1121 907 1021 l 1041 1121 q 981 908 1041 990 q 811 801 921 826 q 851 697 837 753 q 866 581 866 640 l 866 405 m 732 582 q 659 805 732 718 q 462 892 585 892 q 276 805 345 892 q 206 582 206 718 l 206 405 q 276 182 206 268 q 462 95 345 95 q 659 181 586 95 q 732 405 732 268 l 732 582 m 430 1086 l 429 1190 q 503 1204 481 1193 q 525 1239 525 1214 q 495 1279 525 1266 q 416 1292 466 1292 l 421 1365 q 574 1330 521 1365 q 628 1237 628 1295 q 599 1165 628 1189 q 526 1134 570 1140 l 525 1086 l 430 1086 "},"Ū":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 721 1112 l 232 1112 l 232 1211 l 721 1211 l 721 1112 "},"ª":{"x_min":81.390625,"x_max":533.765625,"ha":622,"o":"m 415 478 q 406 509 410 492 q 401 542 403 525 q 340 490 379 511 q 250 469 302 469 q 125 510 169 469 q 81 623 81 551 q 138 739 81 698 q 305 780 196 780 l 399 780 l 399 815 q 379 881 399 858 q 319 904 358 904 q 249 885 274 904 q 224 834 224 867 l 114 843 l 113 847 q 167 957 109 913 q 319 1002 224 1002 q 463 953 410 1002 q 516 814 516 905 l 516 601 q 520 537 516 567 q 533 478 524 507 l 415 478 m 278 563 q 350 583 313 563 q 399 627 387 604 l 399 702 l 305 702 q 226 680 255 702 q 198 626 198 657 q 218 579 198 595 q 278 563 238 563 "},"Œ":{"x_min":70.53125,"x_max":1268.953125,"ha":1329,"o":"m 1268 0 l 646 0 q 539 -10 583 -6 q 450 -14 495 -14 q 176 98 281 -14 q 70 390 70 211 l 70 597 q 175 889 70 776 q 448 1002 280 1002 q 544 998 495 1002 q 646 988 592 994 l 1261 988 l 1261 882 l 747 882 l 747 563 l 1199 563 l 1199 457 l 747 457 l 747 104 l 1268 104 l 1268 0 m 450 91 q 533 94 491 91 q 613 103 574 97 l 613 883 q 531 893 572 889 q 448 896 489 896 q 269 819 334 896 q 204 598 204 742 l 204 390 q 269 168 204 245 q 450 91 335 91 "},"Ạ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 523 -228 l 375 -228 l 375 -92 l 523 -92 l 523 -228 "},"Ą":{"x_min":13.5625,"x_max":922.734375,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 869 0 q 794 -67 821 -35 q 768 -136 768 -99 q 783 -181 768 -164 q 833 -197 798 -197 q 867 -192 851 -197 q 900 -179 882 -187 l 922 -263 q 868 -284 898 -276 q 798 -293 839 -293 q 693 -255 734 -293 q 652 -151 652 -218 q 693 -48 652 -96 q 820 38 734 0 l 869 0 "},"T":{"x_min":23.0625,"x_max":790.8125,"ha":814,"o":"m 790 882 l 473 882 l 473 0 l 339 0 l 339 882 l 23 882 l 23 988 l 790 988 l 790 882 "},"š":{"x_min":73.734375,"x_max":657.203125,"ha":726,"o":"m 523 194 q 490 267 523 238 q 362 316 456 295 q 161 395 229 345 q 94 531 94 445 q 170 683 94 620 q 368 747 246 747 q 572 681 496 747 q 644 521 647 615 l 642 517 l 515 517 q 475 603 515 565 q 368 641 434 641 q 262 610 297 641 q 227 535 227 579 q 258 467 227 492 q 382 422 288 442 q 589 341 521 392 q 657 204 657 290 q 578 46 657 106 q 371 -14 499 -14 q 150 57 231 -14 q 73 223 69 128 l 75 227 l 202 227 q 255 123 206 156 q 371 90 305 90 q 483 119 442 90 q 523 194 523 148 m 362 946 l 461 1046 l 577 1046 l 577 1034 l 402 868 l 322 868 l 149 1032 l 149 1046 l 262 1046 l 362 946 "},"ỷ":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 303 841 l 302 945 q 376 959 354 948 q 398 994 398 969 q 368 1034 398 1021 q 289 1047 339 1047 l 294 1120 q 447 1085 394 1120 q 501 992 501 1050 q 472 920 501 944 q 399 889 443 895 l 398 841 l 303 841 "},"Þ":{"x_min":110.546875,"x_max":760.28125,"ha":820,"o":"m 244 988 l 244 789 l 426 789 q 672 708 583 789 q 760 500 760 628 q 672 291 760 371 q 426 212 583 212 l 244 212 l 244 0 l 110 0 l 110 988 l 244 988 m 244 684 l 244 316 l 426 316 q 576 369 526 316 q 626 499 626 422 q 576 630 626 576 q 426 684 526 684 l 244 684 "},"j":{"x_min":-44.765625,"x_max":250.9375,"ha":359,"o":"m 250 734 l 250 -60 q 192 -234 250 -173 q 30 -296 134 -296 q -7 -292 9 -296 q -44 -283 -25 -289 l -35 -178 q -8 -184 -25 -182 q 21 -186 9 -186 q 91 -156 65 -186 q 117 -60 117 -127 l 117 734 l 250 734 m 246 924 l 113 924 l 113 1058 l 246 1058 l 246 924 "},"1":{"x_min":126.15625,"x_max":461.875,"ha":782,"o":"m 461 0 l 328 0 l 328 857 l 126 855 l 126 951 l 461 988 l 461 0 "},"›":{"x_min":59.6875,"x_max":360.140625,"ha":417,"o":"m 160 644 l 360 379 l 360 367 l 160 103 l 59 103 l 232 373 l 59 644 l 160 644 "},"<":{"x_min":48.15625,"x_max":601.578125,"ha":705,"o":"m 222 379 l 164 366 l 164 362 l 222 349 l 601 195 l 601 58 l 48 315 l 48 417 l 601 673 l 601 537 l 222 379 "},"t":{"x_min":23.0625,"x_max":419.140625,"ha":480,"o":"m 273 911 l 273 734 l 412 734 l 412 634 l 273 634 l 273 189 q 294 116 273 137 q 351 95 316 95 q 376 98 362 95 q 401 105 390 101 l 419 13 q 375 -6 404 1 q 317 -14 346 -14 q 187 35 236 -14 q 139 189 139 84 l 139 634 l 23 634 l 23 734 l 139 734 l 139 911 l 273 911 "},"¬":{"x_min":86.140625,"x_max":652.453125,"ha":771,"o":"m 652 254 l 518 254 l 518 432 l 86 432 l 86 544 l 652 544 l 652 254 "},"ù":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 449 825 l 342 825 l 172 1001 l 174 1005 l 330 1005 l 449 825 "},"ĉ":{"x_min":65.78125,"x_max":685.09375,"ha":737,"o":"m 395 90 q 512 131 461 90 q 562 232 562 172 l 682 232 l 684 228 q 599 59 687 133 q 395 -14 512 -14 q 150 90 235 -14 q 65 352 65 194 l 65 381 q 150 642 65 537 q 395 747 236 747 q 605 671 524 747 q 685 484 687 595 l 683 480 l 562 480 q 515 594 562 547 q 395 641 467 641 q 245 566 290 641 q 200 381 200 490 l 200 352 q 244 165 200 240 q 395 90 289 90 m 573 883 l 573 867 l 464 867 l 364 967 l 265 867 l 156 867 l 156 884 l 323 1045 l 405 1045 l 573 883 "},"ï":{"x_min":-60.703125,"x_max":406.59375,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 406 856 l 258 856 l 258 991 l 406 991 l 406 856 m 87 856 l -60 856 l -60 991 l 87 991 l 87 856 "},"ī":{"x_min":-68.578125,"x_max":420.421875,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 420 881 l -68 881 l -68 980 l 420 980 l 420 881 "},"Ò":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 529 1071 l 422 1071 l 252 1247 l 254 1252 l 410 1252 l 529 1071 "},"ầ":{"x_min":-62.96875,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 626 857 l 624 853 l 489 853 l 376 959 l 263 853 l 128 853 l 127 857 l 322 1031 l 430 1031 l 626 857 m 174 972 l 74 972 l -62 1148 l 79 1148 l 174 972 "},"Ď":{"x_min":122.078125,"x_max":853.875,"ha":915,"o":"m 122 0 l 122 988 l 425 988 q 736 868 619 988 q 853 561 853 749 l 853 426 q 736 118 853 236 q 425 0 619 0 l 122 0 m 255 882 l 255 104 l 425 104 q 641 194 562 104 q 720 426 720 284 l 720 562 q 641 792 720 702 q 425 882 562 882 l 255 882 m 420 1164 l 519 1264 l 635 1264 l 635 1252 l 460 1086 l 380 1086 l 207 1250 l 207 1264 l 320 1264 l 420 1164 "},"&":{"x_min":43.40625,"x_max":835.578125,"ha":865,"o":"m 43 266 q 91 410 43 348 q 233 535 139 472 q 155 655 181 602 q 129 763 129 707 q 195 939 129 877 q 377 1002 261 1002 q 552 940 484 1002 q 619 791 619 878 q 583 676 619 725 q 478 577 548 628 l 404 523 l 634 245 q 678 343 662 289 q 693 456 693 397 l 813 456 q 786 291 813 367 q 710 154 760 215 l 835 3 l 834 0 l 678 0 l 621 69 q 501 7 567 28 q 364 -14 435 -14 q 130 64 217 -14 q 43 266 43 142 m 364 90 q 461 107 413 90 q 550 154 508 123 l 305 449 l 278 430 q 197 342 217 384 q 177 266 177 300 q 225 139 177 189 q 364 90 273 90 m 263 764 q 281 689 263 728 q 336 604 299 650 l 430 668 q 482 724 468 694 q 496 791 496 755 q 463 865 496 833 q 377 896 430 896 q 292 858 322 896 q 263 764 263 820 "},"Ồ":{"x_min":34.03125,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 723 1090 l 721 1086 l 586 1086 l 473 1192 l 360 1086 l 225 1086 l 224 1090 l 419 1264 l 527 1264 l 723 1090 m 271 1205 l 171 1205 l 34 1381 l 176 1381 l 271 1205 "},"˝":{"x_min":67.828125,"x_max":571.0625,"ha":517,"o":"m 413 1029 l 569 1029 l 571 1025 l 367 849 l 251 849 l 250 852 l 413 1029 m 192 1029 l 335 1029 l 337 1026 l 174 849 l 67 849 l 192 1029 "},"I":{"x_min":128.859375,"x_max":263.15625,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 "},"G":{"x_min":81.390625,"x_max":837.609375,"ha":947,"o":"m 837 131 q 715 31 802 76 q 489 -14 628 -14 q 197 99 312 -14 q 81 392 81 212 l 81 595 q 189 888 81 775 q 467 1002 297 1002 q 733 918 636 1002 q 832 703 830 835 l 831 699 l 704 699 q 638 841 697 785 q 467 896 579 896 q 284 812 354 896 q 215 597 215 727 l 215 392 q 292 175 215 260 q 489 90 370 90 q 627 112 573 90 q 704 163 680 135 l 704 387 l 487 387 l 487 493 l 837 493 l 837 131 "},"`":{"x_min":55.609375,"x_max":332.328125,"ha":435,"o":"m 332 821 l 225 821 l 55 997 l 57 1001 l 213 1001 l 332 821 "},"·":{"x_min":109.1875,"x_max":243.484375,"ha":366,"o":"m 243 423 l 109 423 l 109 567 l 243 567 l 243 423 "},"ỗ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 642 846 l 640 842 l 525 842 l 392 961 l 259 842 l 144 842 l 143 846 l 339 1020 l 446 1020 l 642 846 m 569 1189 q 536 1106 569 1143 q 458 1070 503 1070 q 384 1094 423 1070 q 320 1118 346 1118 q 282 1098 299 1118 q 265 1055 265 1078 l 210 1068 q 243 1152 210 1115 q 320 1190 275 1190 q 390 1167 349 1190 q 458 1143 432 1143 q 497 1162 479 1143 q 515 1205 515 1181 l 569 1189 "},"Ễ":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 673 1063 l 671 1059 l 556 1059 l 423 1178 l 290 1059 l 175 1059 l 174 1063 l 370 1237 l 477 1237 l 673 1063 m 600 1406 q 567 1323 600 1360 q 489 1287 534 1287 q 415 1311 454 1287 q 351 1335 377 1335 q 313 1315 330 1335 q 296 1272 296 1295 l 241 1285 q 274 1369 241 1332 q 351 1407 306 1407 q 421 1384 380 1407 q 489 1360 463 1360 q 528 1379 510 1360 q 546 1422 546 1398 l 600 1406 "},"ằ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 417 1014 l 336 1014 l 201 1144 l 202 1148 l 323 1148 l 417 1014 m 572 999 l 574 995 q 522 896 578 935 q 372 858 466 858 q 222 896 277 858 q 171 995 166 935 l 172 999 l 275 999 q 298 943 275 965 q 372 922 321 922 q 445 943 422 922 q 469 999 469 965 l 572 999 "},"ŏ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 593 1049 l 595 1045 q 542 917 597 967 q 394 868 487 868 q 246 917 301 868 q 194 1045 191 967 l 196 1049 l 298 1049 q 321 977 298 1005 q 394 949 344 949 q 467 977 443 949 q 491 1049 491 1005 l 593 1049 "},"¿":{"x_min":77.3125,"x_max":636.859375,"ha":687,"o":"m 437 456 q 419 319 436 357 q 335 219 403 281 q 239 96 267 139 q 210 -5 210 53 q 248 -115 210 -77 q 358 -154 286 -154 q 463 -120 419 -154 q 507 -22 507 -87 l 634 -22 l 636 -26 q 559 -201 638 -135 q 358 -267 480 -267 q 150 -198 224 -267 q 77 -8 77 -130 q 124 149 77 77 q 251 299 172 222 q 295 364 287 335 q 303 456 303 393 l 437 456 m 299 735 l 438 735 l 438 593 l 299 593 l 299 735 "},"Ả":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 406 1072 l 405 1176 q 479 1190 457 1179 q 501 1225 501 1200 q 471 1265 501 1252 q 392 1278 442 1278 l 397 1351 q 550 1316 497 1351 q 604 1223 604 1281 q 575 1151 604 1175 q 502 1120 546 1126 l 501 1072 l 406 1072 "},"ý":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 413 1002 l 569 1002 l 570 998 l 387 822 l 287 822 l 413 1002 "},"Ứ":{"x_min":99.703125,"x_max":1099.4375,"ha":970,"o":"m 843 988 l 843 866 l 847 865 q 937 938 906 883 q 968 1079 968 994 l 1097 1079 l 1099 1075 q 1034 862 1100 944 q 843 756 967 779 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 536 1235 l 692 1235 l 693 1230 l 510 1054 l 410 1054 l 536 1235 "},"ſ":{"x_min":107.84375,"x_max":438.8125,"ha":350,"o":"m 107 0 l 107 826 q 169 1007 107 943 q 341 1072 231 1072 q 386 1068 363 1072 q 438 1057 410 1064 l 422 959 q 394 964 408 962 q 362 966 379 966 q 272 929 303 966 q 241 826 241 892 l 241 0 l 107 0 "},"º":{"x_min":81.390625,"x_max":550.03125,"ha":633,"o":"m 81 774 q 145 938 81 875 q 315 1002 208 1002 q 486 938 422 1002 q 550 774 550 875 l 550 695 q 486 531 550 594 q 316 468 423 468 q 145 531 209 468 q 81 695 81 594 l 81 774 m 198 695 q 228 600 198 635 q 316 564 258 564 q 403 600 373 564 q 433 695 433 636 l 433 774 q 402 868 433 831 q 315 904 372 904 q 228 868 258 904 q 198 774 198 831 l 198 695 "},"ź":{"x_min":63.75,"x_max":647.03125,"ha":699,"o":"m 223 104 l 647 104 l 647 0 l 63 0 l 63 93 l 460 628 l 68 628 l 68 734 l 623 734 l 623 643 l 223 104 m 420 1002 l 576 1002 l 577 998 l 394 822 l 294 822 l 420 1002 "},"ű":{"x_min":94.265625,"x_max":736.0625,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 578 1033 l 734 1033 l 736 1029 l 532 853 l 416 853 l 415 856 l 578 1033 m 357 1033 l 500 1033 l 502 1030 l 339 853 l 232 853 l 357 1033 "},"Ư":{"x_min":99.703125,"x_max":1099.4375,"ha":970,"o":"m 843 988 l 843 866 l 847 865 q 937 938 906 883 q 968 1079 968 994 l 1097 1079 l 1099 1075 q 1034 862 1100 944 q 843 756 967 779 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 "},"Ǽ":{"x_min":-13.5625,"x_max":1281.15625,"ha":1304,"o":"m 1281 0 l 674 0 l 663 238 l 286 238 l 149 0 l -13 0 l 583 988 l 1239 988 l 1239 882 l 770 882 l 784 566 l 1184 566 l 1184 460 l 788 460 l 803 104 l 1281 104 l 1281 0 m 356 359 l 659 359 l 638 840 l 634 842 l 356 359 m 698 1235 l 854 1235 l 855 1230 l 672 1054 l 572 1054 l 698 1235 "},"ń":{"x_min":96.984375,"x_max":692.46875,"ha":789,"o":"m 216 734 l 225 624 q 317 715 262 683 q 443 747 373 747 q 627 677 562 747 q 692 462 692 608 l 692 0 l 558 0 l 558 460 q 520 597 558 557 q 403 638 482 638 q 301 610 345 638 q 230 534 257 582 l 230 0 l 96 0 l 96 734 l 216 734 m 456 1017 l 612 1017 l 613 1013 l 430 837 l 330 837 l 456 1017 "},"Ș":{"x_min":69.078125,"x_max":793.515625,"ha":866,"o":"m 659 249 q 609 362 659 316 q 428 439 558 408 q 184 549 271 477 q 96 732 96 622 q 190 924 96 847 q 436 1002 285 1002 q 694 913 598 1002 q 786 706 790 824 l 785 702 l 657 702 q 600 843 657 789 q 436 896 543 896 q 283 851 336 896 q 229 734 229 806 q 287 626 229 669 q 474 550 345 583 q 712 437 630 512 q 793 250 793 361 q 695 58 793 131 q 440 -14 598 -14 q 179 66 293 -14 q 69 280 65 146 l 70 284 l 198 284 q 267 139 198 189 q 440 90 337 90 q 600 133 541 90 q 659 249 659 175 m 464 -174 l 381 -335 l 315 -335 l 356 -168 l 356 -80 l 464 -80 l 464 -174 "},";":{"x_min":67.5625,"x_max":248.640625,"ha":356,"o":"m 243 594 l 110 594 l 110 731 l 243 731 l 243 594 m 248 32 l 146 -174 l 67 -174 l 115 39 l 115 150 l 248 150 l 248 32 "}," ":{"x_min":0,"x_max":0,"ha":354},"Ġ":{"x_min":81.390625,"x_max":837.609375,"ha":947,"o":"m 837 131 q 715 31 802 76 q 489 -14 628 -14 q 197 99 312 -14 q 81 392 81 212 l 81 595 q 189 888 81 775 q 467 1002 297 1002 q 733 918 636 1002 q 832 703 830 835 l 831 699 l 704 699 q 638 841 697 785 q 467 896 579 896 q 284 812 354 896 q 215 597 215 727 l 215 392 q 292 175 215 260 q 489 90 370 90 q 627 112 573 90 q 704 163 680 135 l 704 387 l 487 387 l 487 493 l 837 493 l 837 131 m 527 1102 l 379 1102 l 379 1238 l 527 1238 l 527 1102 "},"6":{"x_min":89.53125,"x_max":731.796875,"ha":782,"o":"m 457 1002 q 558 990 508 1002 q 640 961 608 978 l 612 858 q 542 886 579 875 q 457 896 506 896 q 287 812 352 896 q 222 590 222 727 l 222 575 q 321 634 265 613 q 442 656 377 656 q 653 564 574 656 q 731 332 731 472 q 648 82 731 179 q 424 -14 564 -14 q 184 91 279 -14 q 89 387 89 196 l 89 576 q 195 883 89 765 q 457 1002 301 1002 m 412 556 q 295 528 343 556 q 222 454 247 500 l 222 374 q 280 164 222 238 q 424 90 337 90 q 552 159 506 90 q 598 332 598 229 q 549 493 598 430 q 412 556 499 556 "},"n":{"x_min":96.984375,"x_max":692.46875,"ha":789,"o":"m 216 734 l 225 624 q 317 715 262 683 q 443 747 373 747 q 627 677 562 747 q 692 462 692 608 l 692 0 l 558 0 l 558 460 q 520 597 558 557 q 403 638 482 638 q 301 610 345 638 q 230 534 257 582 l 230 0 l 96 0 l 96 734 l 216 734 "},"﻿":{"x_min":0,"x_max":0,"ha":0},"ụ":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 422 -228 l 274 -228 l 274 -92 l 422 -92 l 422 -228 "},"ģ":{"x_min":67.828125,"x_max":692.46875,"ha":789,"o":"m 67 353 q 145 638 67 530 q 358 747 222 747 q 481 719 428 747 q 569 638 534 691 l 585 734 l 692 734 l 692 -3 q 610 -220 692 -144 q 373 -296 528 -296 q 259 -281 320 -296 q 151 -241 198 -266 l 185 -137 q 271 -170 221 -158 q 372 -183 322 -183 q 514 -139 470 -183 q 558 -3 558 -94 l 558 78 q 472 9 522 32 q 357 -14 422 -14 q 145 83 222 -14 q 67 339 67 181 l 67 353 m 201 339 q 248 161 201 228 q 390 94 295 94 q 491 121 451 94 q 558 199 532 149 l 558 536 q 491 611 533 583 q 392 638 450 638 q 248 558 296 638 q 201 353 201 478 l 201 339 m 311 949 l 393 1116 l 459 1116 l 445 942 l 445 849 l 311 849 l 311 949 "},"Ẵ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 645 1216 l 647 1212 q 597 1111 651 1150 q 450 1072 542 1072 q 303 1111 357 1072 q 253 1212 248 1150 l 254 1216 l 354 1216 q 377 1159 354 1181 q 450 1137 400 1137 q 522 1159 498 1137 q 545 1216 545 1181 l 645 1216 m 645 1398 q 613 1311 645 1347 q 533 1274 581 1274 q 451 1300 494 1274 q 382 1326 409 1326 q 343 1308 359 1326 q 328 1265 328 1291 l 268 1280 q 300 1368 268 1330 q 382 1405 332 1405 q 458 1379 412 1405 q 533 1354 504 1354 q 571 1371 555 1354 q 587 1414 587 1388 l 645 1398 "},"¤":{"x_min":70.53125,"x_max":929.171875,"ha":988,"o":"m 744 72 q 629 8 691 30 q 497 -14 566 -14 q 366 8 429 -14 q 252 71 303 30 l 164 -18 l 70 75 l 164 170 q 112 283 130 222 q 94 412 94 345 q 113 545 94 481 q 169 661 132 608 l 70 763 l 164 857 l 261 758 q 372 816 311 795 q 497 837 432 837 q 623 815 563 837 q 735 756 684 794 l 834 858 l 929 763 l 827 659 q 882 543 862 606 q 901 412 901 480 q 883 284 901 345 q 832 172 865 224 l 929 75 l 834 -18 l 744 72 m 217 412 q 299 194 217 284 q 497 104 381 104 q 694 194 613 104 q 776 412 776 284 q 694 628 776 538 q 497 717 613 717 q 299 628 381 717 q 217 412 217 538 "},"Ĝ":{"x_min":81.390625,"x_max":837.609375,"ha":947,"o":"m 837 131 q 715 31 802 76 q 489 -14 628 -14 q 197 99 312 -14 q 81 392 81 212 l 81 595 q 189 888 81 775 q 467 1002 297 1002 q 733 918 636 1002 q 832 703 830 835 l 831 699 l 704 699 q 638 841 697 785 q 467 896 579 896 q 284 812 354 896 q 215 597 215 727 l 215 392 q 292 175 215 260 q 489 90 370 90 q 627 112 573 90 q 704 163 680 135 l 704 387 l 487 387 l 487 493 l 837 493 l 837 131 m 662 1116 l 662 1100 l 553 1100 l 453 1200 l 354 1100 l 245 1100 l 245 1117 l 412 1278 l 494 1278 l 662 1116 "},"p":{"x_min":96.984375,"x_max":722.3125,"ha":789,"o":"m 722 339 q 646 83 722 180 q 436 -14 570 -14 q 317 8 368 -14 q 230 76 266 31 l 230 -282 l 96 -282 l 96 734 l 199 734 l 220 639 q 309 719 256 691 q 434 747 363 747 q 646 638 571 747 q 722 353 722 530 l 722 339 m 588 353 q 539 558 588 477 q 394 638 490 638 q 296 612 337 638 q 230 540 255 586 l 230 186 q 296 115 255 141 q 396 90 337 90 q 539 159 491 90 q 588 339 588 229 l 588 353 "},"‡":{"x_min":59,"x_max":729.765625,"ha":794,"o":"m 729 0 l 459 0 l 459 -282 l 325 -282 l 325 0 l 59 0 l 59 104 l 325 104 l 325 628 l 59 628 l 59 734 l 325 734 l 325 988 l 459 988 l 459 734 l 729 734 l 729 628 l 459 628 l 459 104 l 729 104 l 729 0 "},"ň":{"x_min":96.984375,"x_max":692.46875,"ha":789,"o":"m 216 734 l 225 624 q 317 715 262 683 q 443 747 373 747 q 627 677 562 747 q 692 462 692 608 l 692 0 l 558 0 l 558 460 q 520 597 558 557 q 403 638 482 638 q 301 610 345 638 q 230 534 257 582 l 230 0 l 96 0 l 96 734 l 216 734 m 391 946 l 490 1046 l 606 1046 l 606 1034 l 431 868 l 351 868 l 178 1032 l 178 1046 l 291 1046 l 391 946 "},"ę":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 597 42 q 522 -25 549 6 q 496 -94 496 -57 q 511 -139 496 -122 q 561 -155 526 -155 q 595 -150 579 -155 q 628 -137 610 -145 l 650 -221 q 596 -242 626 -234 q 526 -251 567 -251 q 421 -213 462 -251 q 380 -109 380 -176 q 421 -6 380 -54 q 548 80 462 42 l 597 42 "},"ố":{"x_min":65.78125,"x_max":831.140625,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 337 1043 l 444 1043 l 639 869 l 638 865 l 504 865 l 390 971 l 277 865 l 142 865 l 141 869 l 337 1043 m 688 1160 l 831 1160 l 692 984 l 593 984 l 688 1160 "},"Ặ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 648 1268 l 650 1264 q 597 1136 652 1186 q 449 1087 542 1087 q 301 1136 356 1087 q 249 1264 246 1186 l 251 1268 l 353 1268 q 376 1196 353 1224 q 449 1168 399 1168 q 522 1196 498 1168 q 546 1268 546 1224 l 648 1268 m 523 -228 l 375 -228 l 375 -92 l 523 -92 l 523 -228 "},"S":{"x_min":69.078125,"x_max":793.515625,"ha":866,"o":"m 659 249 q 609 362 659 316 q 428 439 558 408 q 184 549 271 477 q 96 732 96 622 q 190 924 96 847 q 436 1002 285 1002 q 694 913 598 1002 q 786 706 790 824 l 785 702 l 657 702 q 600 843 657 789 q 436 896 543 896 q 283 851 336 896 q 229 734 229 806 q 287 626 229 669 q 474 550 345 583 q 712 437 630 512 q 793 250 793 361 q 695 58 793 131 q 440 -14 598 -14 q 179 66 293 -14 q 69 280 65 146 l 70 284 l 198 284 q 267 139 198 189 q 440 90 337 90 q 600 133 541 90 q 659 249 659 175 "},"ễ":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 625 847 l 623 843 l 508 843 l 375 962 l 242 843 l 127 843 l 126 847 l 322 1021 l 429 1021 l 625 847 m 552 1190 q 519 1107 552 1144 q 441 1071 486 1071 q 367 1095 406 1071 q 303 1119 329 1119 q 265 1099 282 1119 q 248 1056 248 1079 l 193 1069 q 226 1153 193 1116 q 303 1191 258 1191 q 373 1168 332 1191 q 441 1144 415 1144 q 480 1163 462 1144 q 498 1206 498 1182 l 552 1190 "},"/":{"x_min":10.859375,"x_max":536.46875,"ha":576,"o":"m 124 -85 l 10 -85 l 423 988 l 536 988 l 124 -85 "},"į":{"x_min":9.125,"x_max":279.734375,"ha":350,"o":"m 241 0 l 107 0 l 107 734 l 241 734 l 241 0 m 241 921 l 107 921 l 107 1058 l 241 1058 l 241 921 m 226 0 q 151 -67 178 -35 q 125 -136 125 -99 q 140 -181 125 -164 q 190 -197 155 -197 q 224 -192 208 -197 q 257 -179 239 -187 l 279 -263 q 225 -284 255 -276 q 155 -293 196 -293 q 50 -255 91 -293 q 9 -151 9 -218 q 50 -48 9 -96 q 177 38 91 0 l 226 0 "},"Ế":{"x_min":122.078125,"x_max":862.140625,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 368 1261 l 475 1261 l 670 1087 l 669 1083 l 535 1083 l 421 1189 l 308 1083 l 173 1083 l 172 1087 l 368 1261 m 719 1378 l 862 1378 l 723 1202 l 624 1202 l 719 1378 "},"Ọ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 547 -233 l 399 -233 l 399 -97 l 547 -97 l 547 -233 "},"ắ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 572 999 l 574 995 q 522 896 578 935 q 372 858 466 858 q 222 896 277 858 q 171 995 166 935 l 172 999 l 275 999 q 298 943 275 965 q 372 922 321 922 q 445 943 422 922 q 469 999 469 965 l 572 999 m 406 1148 l 511 1148 l 513 1144 l 405 1014 l 333 1014 l 406 1148 "},"Ŧ":{"x_min":23.0625,"x_max":790.8125,"ha":814,"o":"m 622 555 l 473 555 l 473 0 l 339 0 l 339 555 l 187 555 l 187 661 l 339 661 l 339 882 l 23 882 l 23 988 l 790 988 l 790 882 l 473 882 l 473 661 l 622 661 l 622 555 "},"y":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 "},"‗":{"x_min":3.71875,"x_max":629.71875,"ha":634,"o":"m 629 -276 l 3 -276 l 3 -172 l 629 -172 l 629 -276 m 629 -104 l 3 -104 l 3 0 l 629 0 l 629 -104 "},"ǿ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 466 739 431 747 q 532 718 501 732 l 582 819 l 670 819 l 599 676 q 691 547 659 626 q 722 373 722 469 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 328 -8 360 -14 q 269 8 297 -2 l 220 -91 l 132 -91 l 200 46 q 100 176 135 95 q 65 358 65 257 l 65 373 m 199 358 q 212 245 199 297 q 254 162 226 194 l 258 162 l 483 618 q 441 635 463 629 q 393 641 418 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 589 373 q 577 475 589 427 q 543 555 565 523 l 539 555 l 318 106 q 353 94 334 97 q 394 90 372 90 q 539 166 490 90 q 589 358 589 242 l 589 373 m 430 1016 l 586 1016 l 587 1012 l 404 836 l 304 836 l 430 1016 "},"g":{"x_min":67.828125,"x_max":692.46875,"ha":789,"o":"m 67 353 q 145 638 67 530 q 358 747 222 747 q 481 719 428 747 q 569 638 534 691 l 585 734 l 692 734 l 692 -3 q 610 -220 692 -144 q 373 -296 528 -296 q 259 -281 320 -296 q 151 -241 198 -266 l 185 -137 q 271 -170 221 -158 q 372 -183 322 -183 q 514 -139 470 -183 q 558 -3 558 -94 l 558 78 q 472 9 522 32 q 357 -14 422 -14 q 145 83 222 -14 q 67 339 67 181 l 67 353 m 201 339 q 248 161 201 228 q 390 94 295 94 q 491 121 451 94 q 558 199 532 149 l 558 536 q 491 611 533 583 q 392 638 450 638 q 248 558 296 638 q 201 353 201 478 l 201 339 "},"ĸ":{"x_min":103.765625,"x_max":737.90625,"ha":776,"o":"m 305 311 l 237 311 l 237 0 l 103 0 l 103 734 l 237 734 l 237 424 l 294 424 l 557 734 l 714 734 l 715 730 l 410 381 l 737 3 l 736 0 l 573 0 l 305 311 "},"²":{"x_min":80.4375,"x_max":484.25,"ha":589,"o":"m 484 452 l 82 452 l 82 540 l 287 718 q 349 784 334 758 q 364 838 364 809 q 344 893 364 872 q 286 914 325 914 q 216 892 240 914 q 191 836 191 870 l 82 836 l 80 840 q 133 955 76 908 q 286 1003 190 1003 q 429 959 377 1003 q 480 837 480 916 q 450 745 480 783 q 341 636 420 707 l 238 544 l 239 540 l 484 540 l 484 452 "},"–":{"x_min":122.125,"x_max":858.3125,"ha":960,"o":"m 858 439 l 122 439 l 122 545 l 858 545 l 858 439 "},"ë":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 612 871 l 464 871 l 464 1006 l 612 1006 l 612 871 m 293 871 l 145 871 l 145 1006 l 293 1006 l 293 871 "},"ƒ":{"x_min":-15.59375,"x_max":477.46875,"ha":476,"o":"m 413 634 l 280 634 l 280 -60 q 222 -234 280 -173 q 59 -296 164 -296 q 20 -292 37 -296 q -15 -283 2 -289 l -6 -182 q 24 -188 2 -185 q 59 -190 47 -190 q 123 -155 100 -190 q 146 -60 146 -121 l 146 634 l 31 634 l 31 734 l 146 734 l 146 826 q 207 1007 146 943 q 379 1072 269 1072 q 425 1068 402 1072 q 477 1057 448 1064 l 461 956 q 431 960 448 958 q 396 962 414 962 q 308 927 337 962 q 280 826 280 893 l 280 734 l 413 734 l 413 634 "},"J":{"x_min":44.640625,"x_max":653.125,"ha":766,"o":"m 519 988 l 653 988 l 653 273 q 569 63 653 141 q 352 -14 485 -14 q 125 58 209 -14 q 44 268 41 130 l 46 272 l 174 272 q 220 135 174 180 q 352 90 267 90 q 472 140 425 90 q 519 273 519 190 l 519 988 "},"Ã":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 685 1249 q 644 1142 685 1186 q 543 1098 604 1098 q 443 1129 495 1098 q 356 1161 390 1161 q 307 1139 327 1161 q 287 1085 287 1117 l 214 1103 q 254 1212 214 1166 q 356 1259 294 1259 q 451 1227 394 1259 q 543 1195 508 1195 q 591 1217 571 1195 q 612 1271 612 1239 l 685 1249 "},"ŷ":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 557 869 l 557 853 l 448 853 l 348 953 l 249 853 l 140 853 l 140 870 l 307 1031 l 389 1031 l 557 869 "},"ŕ":{"x_min":96.984375,"x_max":501.671875,"ha":476,"o":"m 444 615 l 375 619 q 286 594 322 619 q 230 523 250 569 l 230 0 l 96 0 l 96 734 l 216 734 l 229 626 q 306 715 260 683 q 411 747 352 747 q 440 744 426 747 q 462 739 453 742 l 444 615 m 344 1017 l 500 1017 l 501 1013 l 318 837 l 218 837 l 344 1017 "},"©":{"x_min":59.6875,"x_max":1022.078125,"ha":1088,"o":"m 753 404 l 754 400 q 697 244 757 297 q 531 191 638 191 q 359 263 423 191 q 295 453 295 335 l 295 534 q 359 724 295 651 q 531 797 423 797 q 698 743 638 797 q 755 589 758 689 l 754 585 l 655 585 q 624 678 655 649 q 531 708 593 708 q 433 660 467 708 q 398 535 398 612 l 398 453 q 433 326 398 374 q 531 279 467 279 q 623 308 593 279 q 654 404 654 337 l 753 404 m 141 494 q 258 191 141 314 q 541 68 374 68 q 824 191 707 68 q 940 494 940 314 q 824 795 940 672 q 541 918 707 918 q 258 795 374 918 q 141 494 141 672 m 59 494 q 200 854 59 708 q 541 1001 340 1001 q 881 854 741 1001 q 1022 494 1022 708 q 881 133 1022 280 q 541 -14 740 -14 q 200 133 340 -14 q 59 494 59 280 "},"˘":{"x_min":90.671875,"x_max":491.15625,"ha":594,"o":"m 489 987 l 491 983 q 438 855 493 905 q 290 806 383 806 q 142 855 197 806 q 90 983 87 905 l 92 987 l 194 987 q 217 915 194 943 q 290 887 240 887 q 363 915 339 887 q 387 987 387 943 l 489 987 "},"Ă":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 648 1268 l 650 1264 q 597 1136 652 1186 q 449 1087 542 1087 q 301 1136 356 1087 q 249 1264 246 1186 l 251 1268 l 353 1268 q 376 1196 353 1224 q 449 1168 399 1168 q 522 1196 498 1168 q 546 1268 546 1224 l 648 1268 "},"D":{"x_min":122.078125,"x_max":853.875,"ha":915,"o":"m 122 0 l 122 988 l 425 988 q 736 868 619 988 q 853 561 853 749 l 853 426 q 736 118 853 236 q 425 0 619 0 l 122 0 m 255 882 l 255 104 l 425 104 q 641 194 562 104 q 720 426 720 284 l 720 562 q 641 792 720 702 q 425 882 562 882 l 255 882 "},"ł":{"x_min":25.09375,"x_max":356.75,"ha":378,"o":"m 255 591 l 356 630 l 356 518 l 255 479 l 255 0 l 121 0 l 121 428 l 25 391 l 25 503 l 121 540 l 121 1058 l 255 1058 l 255 591 "},"ÿ":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 582 856 l 434 856 l 434 991 l 582 991 l 582 856 m 263 856 l 115 856 l 115 991 l 263 991 l 263 856 "},"ĺ":{"x_min":107.84375,"x_max":396.671875,"ha":350,"o":"m 241 0 l 107 0 l 107 1058 l 241 1058 l 241 0 m 239 1261 l 395 1261 l 396 1257 l 213 1081 l 113 1081 l 239 1261 "},"Ł":{"x_min":27.125,"x_max":711.453125,"ha":730,"o":"m 244 572 l 426 630 l 426 517 l 244 459 l 244 104 l 711 104 l 711 0 l 110 0 l 110 417 l 27 390 l 27 503 l 110 529 l 110 988 l 244 988 l 244 572 "}," ":{"x_min":0,"x_max":0,"ha":380},"$":{"x_min":77.21875,"x_max":708.75,"ha":782,"o":"m 575 254 q 531 358 575 314 q 389 435 488 401 q 182 546 252 477 q 112 730 112 615 q 176 913 112 842 q 353 998 240 983 l 353 1147 l 460 1147 l 460 997 q 637 900 574 981 q 699 682 699 818 l 567 682 q 524 831 567 774 q 405 888 481 888 q 285 847 325 888 q 246 732 246 805 q 287 626 246 666 q 435 548 328 585 q 641 437 574 504 q 708 255 708 370 q 638 70 708 139 q 446 -11 569 1 l 446 -141 l 340 -141 l 340 -12 q 149 73 223 0 q 77 287 74 146 l 78 290 l 207 290 q 260 141 207 186 q 389 97 312 97 q 525 138 476 97 q 575 254 575 180 "},"w":{"x_min":30.515625,"x_max":1017.328125,"ha":1051,"o":"m 284 267 l 300 178 l 304 178 l 323 267 l 470 734 l 577 734 l 724 267 l 745 168 l 749 168 l 769 267 l 884 734 l 1017 734 l 804 0 l 696 0 l 554 447 l 524 571 l 520 571 l 491 447 l 351 0 l 243 0 l 30 734 l 163 734 l 284 267 "},"\\":{"x_min":26.453125,"x_max":564.953125,"ha":574,"o":"m 26 988 l 152 988 l 564 -85 l 438 -85 l 26 988 "},"Ì":{"x_min":-23.390625,"x_max":263.15625,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 253 1057 l 146 1057 l -23 1233 l -21 1238 l 134 1238 l 253 1057 "},"Ç":{"x_min":80.03125,"x_max":821.40625,"ha":880,"o":"m 819 316 l 821 312 q 723 79 824 173 q 458 -14 623 -14 q 185 104 290 -14 q 80 405 80 223 l 80 581 q 185 882 80 763 q 458 1002 290 1002 q 725 912 626 1002 q 821 676 824 823 l 819 672 l 691 672 q 630 836 691 776 q 458 896 569 896 q 280 806 346 896 q 213 582 213 716 l 213 405 q 280 180 213 270 q 458 90 346 90 q 630 150 569 90 q 691 316 691 210 l 819 316 m 511 -4 l 502 -40 q 576 -75 546 -47 q 605 -157 605 -103 q 551 -261 605 -222 q 398 -300 498 -300 l 393 -226 q 472 -209 442 -226 q 502 -159 502 -192 q 477 -114 502 -127 q 394 -96 453 -101 l 416 -4 l 511 -4 "},"Ŝ":{"x_min":69.078125,"x_max":793.515625,"ha":866,"o":"m 659 249 q 609 362 659 316 q 428 439 558 408 q 184 549 271 477 q 96 732 96 622 q 190 924 96 847 q 436 1002 285 1002 q 694 913 598 1002 q 786 706 790 824 l 785 702 l 657 702 q 600 843 657 789 q 436 896 543 896 q 283 851 336 896 q 229 734 229 806 q 287 626 229 669 q 474 550 345 583 q 712 437 630 512 q 793 250 793 361 q 695 58 793 131 q 440 -14 598 -14 q 179 66 293 -14 q 69 280 65 146 l 70 284 l 198 284 q 267 139 198 189 q 440 90 337 90 q 600 133 541 90 q 659 249 659 175 m 624 1116 l 624 1100 l 515 1100 l 415 1200 l 316 1100 l 207 1100 l 207 1117 l 374 1278 l 456 1278 l 624 1116 "},"C":{"x_min":80.03125,"x_max":821.40625,"ha":880,"o":"m 819 316 l 821 312 q 723 79 824 173 q 458 -14 623 -14 q 185 104 290 -14 q 80 405 80 223 l 80 581 q 185 882 80 763 q 458 1002 290 1002 q 725 912 626 1002 q 821 676 824 823 l 819 672 l 691 672 q 630 836 691 776 q 458 896 569 896 q 280 806 346 896 q 213 582 213 716 l 213 405 q 280 180 213 270 q 458 90 346 90 q 630 150 569 90 q 691 316 691 210 l 819 316 "},"Ḁ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 354 -158 q 385 -85 354 -114 q 460 -56 416 -56 q 534 -85 503 -56 q 564 -158 564 -114 q 534 -229 564 -201 q 460 -257 504 -257 q 385 -229 416 -257 q 354 -158 354 -201 m 414 -158 q 428 -189 414 -176 q 460 -202 441 -202 q 491 -189 478 -202 q 504 -158 504 -177 q 491 -125 504 -138 q 460 -111 478 -111 q 428 -125 441 -111 q 414 -158 414 -139 "},"Ē":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 674 1112 l 185 1112 l 185 1211 l 674 1211 l 674 1112 "},"!":{"x_min":115.96875,"x_max":250.265625,"ha":366,"o":"m 249 324 l 115 324 l 115 988 l 249 988 l 249 324 m 250 0 l 115 0 l 115 138 l 250 138 l 250 0 "},"ç":{"x_min":65.78125,"x_max":685.09375,"ha":737,"o":"m 395 90 q 512 131 461 90 q 562 232 562 172 l 682 232 l 684 228 q 599 59 687 133 q 395 -14 512 -14 q 150 90 235 -14 q 65 352 65 194 l 65 381 q 150 642 65 537 q 395 747 236 747 q 605 671 524 747 q 685 484 687 595 l 683 480 l 562 480 q 515 594 562 547 q 395 641 467 641 q 245 566 290 641 q 200 381 200 490 l 200 352 q 244 165 200 240 q 395 90 289 90 m 416 -4 l 407 -40 q 481 -75 451 -47 q 510 -157 510 -103 q 456 -261 510 -222 q 303 -300 403 -300 l 298 -226 q 377 -209 347 -226 q 407 -159 407 -192 q 382 -114 407 -127 q 299 -96 358 -101 l 321 -4 l 416 -4 "},"Ĵ":{"x_min":44.640625,"x_max":789.40625,"ha":766,"o":"m 519 988 l 653 988 l 653 273 q 569 63 653 141 q 352 -14 485 -14 q 125 58 209 -14 q 44 268 41 130 l 46 272 l 174 272 q 220 135 174 180 q 352 90 267 90 q 472 140 425 90 q 519 273 519 190 l 519 988 m 789 1094 l 789 1078 l 680 1078 l 580 1178 l 481 1078 l 372 1078 l 372 1095 l 539 1256 l 621 1256 l 789 1094 "},"Ẻ":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 381 1072 l 380 1176 q 454 1190 432 1179 q 476 1225 476 1200 q 446 1265 476 1252 q 367 1278 417 1278 l 372 1351 q 525 1316 472 1351 q 579 1223 579 1281 q 550 1151 579 1175 q 477 1120 521 1126 l 476 1072 l 381 1072 "},"È":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 482 1057 l 375 1057 l 205 1233 l 207 1238 l 363 1238 l 482 1057 "},"X":{"x_min":44.765625,"x_max":839.640625,"ha":878,"o":"m 440 602 l 671 988 l 832 988 l 519 498 l 839 0 l 680 0 l 443 392 l 206 0 l 44 0 l 364 498 l 51 988 l 211 988 l 440 602 "},"ô":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 603 883 l 603 867 l 494 867 l 394 967 l 295 867 l 186 867 l 186 884 l 353 1045 l 435 1045 l 603 883 "},"Ė":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 499 1088 l 351 1088 l 351 1224 l 499 1224 l 499 1088 "},"Ā":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 694 1112 l 205 1112 l 205 1211 l 694 1211 l 694 1112 "},"ċ":{"x_min":65.78125,"x_max":685.09375,"ha":737,"o":"m 395 90 q 512 131 461 90 q 562 232 562 172 l 682 232 l 684 228 q 599 59 687 133 q 395 -14 512 -14 q 150 90 235 -14 q 65 352 65 194 l 65 381 q 150 642 65 537 q 395 747 236 747 q 605 671 524 747 q 685 484 687 595 l 683 480 l 562 480 q 515 594 562 547 q 395 641 467 641 q 245 566 290 641 q 200 381 200 490 l 200 352 q 244 165 200 240 q 395 90 289 90 m 438 869 l 290 869 l 290 1005 l 438 1005 l 438 869 "},"đ":{"x_min":66.46875,"x_max":820.65625,"ha":810,"o":"m 820 834 l 687 834 l 687 0 l 577 0 l 562 90 q 474 12 526 38 q 352 -14 421 -14 q 142 83 218 -14 q 66 339 66 180 l 66 353 q 142 638 66 530 q 354 747 217 747 q 468 723 418 747 q 553 654 518 699 l 553 834 l 385 834 l 385 940 l 553 940 l 553 1058 l 687 1058 l 687 940 l 820 940 l 820 834 m 200 339 q 245 161 200 227 q 386 94 290 94 q 486 121 446 94 q 553 197 527 148 l 553 539 q 486 611 527 584 q 387 638 445 638 q 245 559 291 638 q 200 353 200 479 l 200 339 "},"ấ":{"x_min":71.890625,"x_max":812.140625,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 318 1043 l 425 1043 l 620 869 l 619 865 l 485 865 l 371 971 l 258 865 l 123 865 l 122 869 l 318 1043 m 669 1160 l 812 1160 l 673 984 l 574 984 l 669 1160 "},"Ẃ":{"x_min":36.625,"x_max":1182.140625,"ha":1227,"o":"m 320 341 l 338 218 l 342 217 l 368 341 l 550 988 l 668 988 l 850 341 l 877 215 l 881 215 l 901 341 l 1048 988 l 1182 988 l 944 0 l 824 0 l 630 685 l 612 774 l 608 774 l 591 685 l 393 0 l 274 0 l 36 988 l 169 988 l 320 341 m 673 1235 l 829 1235 l 830 1230 l 647 1054 l 547 1054 l 673 1235 "},"Ŀ":{"x_min":122.078125,"x_max":722.984375,"ha":750,"o":"m 255 104 l 722 104 l 722 0 l 122 0 l 122 988 l 255 988 l 255 104 m 563 465 l 415 465 l 415 602 l 563 602 l 563 465 "},"ŋ":{"x_min":96.984375,"x_max":687.046875,"ha":789,"o":"m 216 734 l 225 632 q 316 717 261 687 q 438 747 370 747 q 621 677 556 747 q 687 463 687 608 l 687 -60 q 628 -234 687 -173 q 465 -296 570 -296 q 426 -292 444 -296 q 389 -283 408 -289 l 399 -175 q 431 -181 408 -178 q 465 -183 453 -183 q 530 -151 507 -183 q 553 -60 553 -119 l 553 460 q 514 597 553 557 q 397 638 476 638 q 298 616 339 638 q 230 553 256 593 l 230 0 l 96 0 l 96 734 l 216 734 "},"}":{"x_min":14.25,"x_max":427.28125,"ha":472,"o":"m 14 -166 q 120 -81 88 -142 q 151 68 151 -21 l 151 207 q 182 334 151 279 q 276 417 212 388 q 182 499 212 445 q 151 627 151 553 l 151 767 q 120 918 151 857 q 14 1003 88 979 l 42 1083 q 229 964 173 1045 q 285 767 285 883 l 285 628 q 319 509 285 551 q 427 468 354 468 l 427 368 q 319 325 354 368 q 285 207 285 283 l 285 68 q 229 -128 285 -46 q 42 -247 173 -209 l 14 -166 "},"â":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 585 883 l 585 867 l 476 867 l 376 967 l 277 867 l 168 867 l 168 884 l 335 1045 l 417 1045 l 585 883 "},"ø":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 466 739 431 747 q 532 718 501 732 l 582 819 l 670 819 l 599 676 q 691 547 659 626 q 722 373 722 469 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 328 -8 360 -14 q 269 8 297 -2 l 220 -91 l 132 -91 l 200 46 q 100 176 135 95 q 65 358 65 257 l 65 373 m 199 358 q 212 245 199 297 q 254 162 226 194 l 258 162 l 483 618 q 441 635 463 629 q 393 641 418 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 589 373 q 577 475 589 427 q 543 555 565 523 l 539 555 l 318 106 q 353 94 334 97 q 394 90 372 90 q 539 166 490 90 q 589 358 589 242 l 589 373 "},"‰":{"x_min":43.40625,"x_max":1273.03125,"ha":1327,"o":"m 555 242 q 611 386 555 327 q 758 445 666 445 q 848 424 809 445 q 913 366 888 403 q 978 424 938 403 q 1068 445 1018 445 q 1217 387 1161 445 q 1273 242 1273 328 l 1273 189 q 1217 44 1273 102 q 1069 -14 1161 -14 q 978 6 1018 -14 q 913 64 938 27 q 849 6 888 27 q 760 -14 809 -14 q 611 44 666 -14 q 555 189 555 102 l 555 242 m 43 797 q 99 942 43 883 q 246 1002 154 1002 q 396 943 340 1002 q 451 797 451 884 l 451 745 q 396 601 451 659 q 248 542 340 542 q 99 601 155 542 q 43 745 43 659 l 43 797 m 654 189 q 681 103 654 138 q 760 68 709 68 q 837 103 810 68 q 864 189 864 138 l 864 242 q 836 327 864 292 q 758 363 809 363 q 681 327 708 363 q 654 242 654 292 l 654 189 m 963 189 q 991 103 963 138 q 1069 68 1018 68 q 1146 103 1119 68 q 1173 189 1173 138 l 1173 242 q 1145 327 1173 292 q 1068 363 1118 363 q 990 327 1018 363 q 963 242 963 292 l 963 189 m 142 745 q 169 660 142 695 q 248 625 197 625 q 325 660 297 625 q 352 745 352 694 l 352 797 q 324 883 352 848 q 246 919 297 919 q 169 883 196 919 q 142 797 142 848 l 142 745 m 310 75 l 236 120 l 718 892 l 792 846 l 310 75 "},"Ä":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 683 1089 l 535 1089 l 535 1224 l 683 1224 l 683 1089 m 364 1089 l 216 1089 l 216 1224 l 364 1224 l 364 1089 "},"Ỵ":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 497 -221 l 349 -221 l 349 -85 l 497 -85 l 497 -221 "},"ř":{"x_min":68.953125,"x_max":496.234375,"ha":476,"o":"m 444 615 l 375 619 q 286 594 322 619 q 230 523 250 569 l 230 0 l 96 0 l 96 734 l 216 734 l 229 626 q 306 715 260 683 q 411 747 352 747 q 440 744 426 747 q 462 739 453 742 l 444 615 m 281 946 l 380 1046 l 496 1046 l 496 1034 l 321 868 l 241 868 l 68 1032 l 68 1046 l 181 1046 l 281 946 "},"—":{"x_min":127.625,"x_max":1033.71875,"ha":1126,"o":"m 1033 439 l 127 439 l 127 545 l 1033 545 l 1033 439 "},"N":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 259 764 l 255 762 l 255 0 l 122 0 l 122 988 l 255 988 l 731 225 l 735 226 l 735 988 l 868 988 l 868 0 "},"⁄":{"x_min":40.015625,"x_max":596.15625,"ha":633,"o":"m 113 75 l 40 120 l 522 892 l 596 846 l 113 75 "},"2":{"x_min":65.65625,"x_max":720.265625,"ha":782,"o":"m 720 0 l 80 0 l 80 91 l 403 451 q 521 605 490 548 q 552 721 552 662 q 509 846 552 795 q 394 896 465 896 q 243 844 292 896 q 195 696 195 791 l 67 696 l 65 700 q 150 915 62 828 q 394 1002 238 1002 q 606 924 527 1002 q 685 726 685 846 q 637 564 685 645 q 503 390 590 483 l 244 107 l 245 104 l 720 104 l 720 0 "},"ü":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 627 856 l 479 856 l 479 991 l 627 991 l 627 856 m 308 856 l 160 856 l 160 991 l 308 991 l 308 856 "},"˜":{"x_min":91.5625,"x_max":562.25,"ha":664,"o":"m 562 1010 q 521 903 562 947 q 420 859 481 859 q 320 890 372 859 q 233 922 267 922 q 184 900 204 922 q 164 846 164 878 l 91 864 q 131 973 91 927 q 233 1020 171 1020 q 328 988 271 1020 q 420 956 385 956 q 468 978 448 956 q 489 1032 489 1000 l 562 1010 "},"Ó":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 538 1249 l 694 1249 l 695 1244 l 512 1068 l 412 1068 l 538 1249 "}," ":{"x_min":0,"x_max":0,"ha":708},"ˇ":{"x_min":94.953125,"x_max":522.234375,"ha":625,"o":"m 307 927 l 406 1027 l 522 1027 l 522 1015 l 347 849 l 267 849 l 94 1013 l 94 1027 l 207 1027 l 307 927 "},"Ÿ":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 657 1088 l 509 1088 l 509 1223 l 657 1223 l 657 1088 m 338 1088 l 190 1088 l 190 1223 l 338 1223 l 338 1088 "},"ų":{"x_min":94.265625,"x_max":728.734375,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 675 0 q 600 -67 627 -35 q 574 -136 574 -99 q 589 -181 574 -164 q 639 -197 604 -197 q 673 -192 657 -197 q 706 -179 688 -187 l 728 -263 q 674 -284 704 -276 q 604 -293 645 -293 q 499 -255 540 -293 q 458 -151 458 -218 q 499 -48 458 -96 q 626 38 540 0 l 675 0 "},"€":{"x_min":53.578125,"x_max":665.34375,"ha":738,"o":"m 619 326 l 290 326 l 289 323 q 344 160 286 229 q 502 90 402 90 q 579 96 541 90 q 652 113 617 101 l 665 7 q 585 -8 627 -3 q 502 -14 543 -14 q 249 84 345 -14 q 152 326 152 182 l 53 326 l 53 432 l 152 432 l 152 523 l 53 523 l 53 629 l 152 629 l 152 639 q 248 903 152 804 q 501 1002 344 1002 q 580 996 541 1002 q 665 980 620 991 l 652 873 q 577 890 615 883 q 501 896 539 896 q 344 827 402 896 q 286 640 286 757 l 286 629 l 619 629 l 619 523 l 286 523 l 286 432 l 619 432 l 619 326 "},"Ŭ":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 671 1268 l 673 1264 q 620 1136 675 1186 q 472 1087 565 1087 q 324 1136 379 1087 q 272 1264 269 1186 l 274 1268 l 376 1268 q 399 1196 376 1224 q 472 1168 422 1168 q 545 1196 521 1168 q 569 1268 569 1224 l 671 1268 "},"ĝ":{"x_min":67.828125,"x_max":692.46875,"ha":789,"o":"m 67 353 q 145 638 67 530 q 358 747 222 747 q 481 719 428 747 q 569 638 534 691 l 585 734 l 692 734 l 692 -3 q 610 -220 692 -144 q 373 -296 528 -296 q 259 -281 320 -296 q 151 -241 198 -266 l 185 -137 q 271 -170 221 -158 q 372 -183 322 -183 q 514 -139 470 -183 q 558 -3 558 -94 l 558 78 q 472 9 522 32 q 357 -14 422 -14 q 145 83 222 -14 q 67 339 67 181 l 67 353 m 201 339 q 248 161 201 228 q 390 94 295 94 q 491 121 451 94 q 558 199 532 149 l 558 536 q 491 611 533 583 q 392 638 450 638 q 248 558 296 638 q 201 353 201 478 l 201 339 m 591 883 l 591 867 l 482 867 l 382 967 l 283 867 l 174 867 l 174 884 l 341 1045 l 423 1045 l 591 883 "},"ß":{"x_min":92.921875,"x_max":770.46875,"ha":828,"o":"m 225 0 l 92 0 l 92 734 q 172 970 92 885 q 376 1055 252 1055 q 554 996 485 1055 q 622 825 622 938 q 578 670 622 745 q 535 557 535 595 q 652 405 535 501 q 770 214 770 308 q 699 43 770 101 q 507 -14 628 -14 q 390 0 451 -14 q 305 34 330 13 l 335 142 q 408 106 364 123 q 494 90 453 90 q 602 122 567 90 q 636 207 636 154 q 519 362 636 264 q 401 558 401 459 q 449 687 401 612 q 497 814 497 762 q 462 913 497 877 q 383 950 427 950 q 269 893 312 950 q 225 734 225 837 l 225 0 "},"Ể":{"x_min":122.078125,"x_max":824.734375,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 670 1062 l 668 1058 l 553 1058 l 420 1184 l 287 1058 l 172 1058 l 171 1062 l 353 1236 l 487 1236 l 670 1062 m 653 1151 l 652 1241 q 715 1253 697 1244 q 734 1283 734 1262 q 709 1317 734 1306 q 641 1328 683 1328 l 645 1392 q 778 1362 731 1392 q 824 1282 824 1333 q 799 1219 824 1241 q 735 1192 773 1197 l 734 1151 l 653 1151 "},"s":{"x_min":73.734375,"x_max":657.203125,"ha":726,"o":"m 523 194 q 490 267 523 238 q 362 316 456 295 q 161 395 229 345 q 94 531 94 445 q 170 683 94 620 q 368 747 246 747 q 572 681 496 747 q 644 521 647 615 l 642 517 l 515 517 q 475 603 515 565 q 368 641 434 641 q 262 610 297 641 q 227 535 227 579 q 258 467 227 492 q 382 422 288 442 q 589 341 521 392 q 657 204 657 290 q 578 46 657 106 q 371 -14 499 -14 q 150 57 231 -14 q 73 223 69 128 l 75 227 l 202 227 q 255 123 206 156 q 371 90 305 90 q 483 119 442 90 q 523 194 523 148 "},"ẳ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 560 992 l 562 988 q 512 889 566 927 q 368 851 459 851 q 223 889 276 851 q 174 988 169 927 l 175 992 l 273 992 q 296 936 273 958 q 368 914 319 914 q 439 936 416 914 q 462 992 462 957 l 560 992 m 334 1030 l 334 1115 q 404 1125 383 1117 q 421 1150 424 1133 l 421 1154 q 397 1182 424 1173 q 322 1192 369 1192 l 326 1248 q 474 1221 423 1248 q 526 1150 526 1195 q 498 1096 526 1114 q 427 1072 469 1077 l 426 1030 l 334 1030 "},"Ű":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 658 1266 l 814 1266 l 816 1262 l 612 1086 l 496 1086 l 495 1089 l 658 1266 m 437 1266 l 580 1266 l 582 1263 l 419 1086 l 312 1086 l 437 1266 "},"?":{"x_min":41.328125,"x_max":600.90625,"ha":661,"o":"m 240 278 q 257 414 241 376 q 343 514 274 452 q 438 637 410 594 q 467 740 467 679 q 428 850 467 812 q 319 889 390 889 q 214 855 257 889 q 170 757 170 822 l 43 757 l 41 761 q 118 936 39 870 q 319 1002 197 1002 q 526 933 453 1002 q 600 743 600 865 q 553 583 600 656 q 426 434 505 510 q 382 369 389 398 q 374 278 374 339 l 240 278 m 379 0 l 239 0 l 239 141 l 379 141 l 379 0 "},"ỡ":{"x_min":65.78125,"x_max":851.84375,"ha":797,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 520 723 462 747 q 621 656 577 699 q 703 713 676 669 q 731 829 731 758 l 851 829 q 806 668 851 732 q 674 583 761 604 q 710 485 697 538 q 722 373 722 431 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 630 1031 q 589 924 630 968 q 488 880 549 880 q 388 911 440 880 q 301 943 335 943 q 252 921 272 943 q 232 867 232 899 l 159 885 q 199 994 159 948 q 301 1041 239 1041 q 396 1009 339 1041 q 488 977 453 977 q 536 999 516 977 q 557 1053 557 1021 l 630 1031 "},"Ņ":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 259 764 l 255 762 l 255 0 l 122 0 l 122 988 l 255 988 l 731 225 l 735 226 l 735 988 l 868 988 l 868 0 m 542 -160 l 459 -321 l 393 -321 l 434 -154 l 434 -66 l 542 -66 l 542 -160 "},"c":{"x_min":65.78125,"x_max":685.09375,"ha":737,"o":"m 395 90 q 512 131 461 90 q 562 232 562 172 l 682 232 l 684 228 q 599 59 687 133 q 395 -14 512 -14 q 150 90 235 -14 q 65 352 65 194 l 65 381 q 150 642 65 537 q 395 747 236 747 q 605 671 524 747 q 685 484 687 595 l 683 480 l 562 480 q 515 594 562 547 q 395 641 467 641 q 245 566 290 641 q 200 381 200 490 l 200 352 q 244 165 200 240 q 395 90 289 90 "},"¶":{"x_min":42.734375,"x_max":567,"ha":682,"o":"m 433 0 l 433 352 l 376 352 q 130 440 218 352 q 42 670 42 528 q 130 899 42 810 q 376 988 218 988 l 567 988 l 567 0 l 433 0 "},"Ī":{"x_min":-43.578125,"x_max":445.421875,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 445 1112 l -43 1112 l -43 1211 l 445 1211 l 445 1112 "},"•":{"x_min":92.921875,"x_max":373.703125,"ha":471,"o":"m 92 537 q 130 635 92 597 q 232 673 168 673 q 335 635 297 673 q 373 537 373 597 l 373 496 q 335 399 373 436 q 233 362 297 362 q 130 399 168 362 q 92 496 92 436 l 92 537 "},"Ὅ":{"x_min":-149.46875,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 54 929 l 123 1141 l 265 1141 l 265 1127 l 110 911 l 54 911 l 54 929 m -149 1006 l -39 1141 l 33 1141 l -21 1002 l -21 909 l -149 909 l -149 1006 "},"(":{"x_min":89.53125,"x_max":453.734375,"ha":461,"o":"m 89 401 q 197 857 89 668 q 423 1110 305 1046 l 427 1109 l 453 1030 q 291 797 360 958 q 223 402 223 637 l 223 393 q 291 -1 223 158 q 453 -240 360 -162 l 427 -314 l 423 -314 q 197 -61 305 -250 q 89 394 89 126 l 89 401 "},"Ụ":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 545 -233 l 397 -233 l 397 -97 l 545 -97 l 545 -233 "},"◊":{"x_min":27.8125,"x_max":672.125,"ha":700,"o":"m 297 988 l 399 988 l 672 493 l 401 0 l 300 0 l 27 493 l 297 988 m 535 493 l 361 840 l 349 874 l 345 874 l 333 840 l 164 493 l 338 146 l 349 112 l 354 112 l 366 146 l 535 493 "},"Ỗ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 720 1077 l 718 1073 l 603 1073 l 470 1192 l 337 1073 l 222 1073 l 221 1077 l 417 1251 l 524 1251 l 720 1077 m 647 1420 q 614 1337 647 1374 q 536 1301 581 1301 q 462 1325 501 1301 q 398 1349 424 1349 q 360 1329 377 1349 q 343 1286 343 1309 l 288 1299 q 321 1383 288 1346 q 398 1421 353 1421 q 468 1398 427 1421 q 536 1374 510 1374 q 575 1393 557 1374 q 593 1436 593 1412 l 647 1420 "},"­":{"x_min":23.734375,"x_max":356.0625,"ha":380,"o":"m 356 364 l 23 364 l 23 469 l 356 469 l 356 364 "},"Ħ":{"x_min":21.03125,"x_max":965.109375,"ha":976,"o":"m 867 793 l 965 793 l 965 694 l 867 694 l 867 0 l 733 0 l 733 435 l 254 435 l 254 0 l 120 0 l 120 694 l 21 694 l 21 793 l 120 793 l 120 988 l 254 988 l 254 793 l 733 793 l 733 988 l 867 988 l 867 793 m 254 541 l 733 541 l 733 694 l 254 694 l 254 541 "},":":{"x_min":109.1875,"x_max":242.796875,"ha":351,"o":"m 242 0 l 109 0 l 109 137 l 242 137 l 242 0 m 242 594 l 109 594 l 109 731 l 242 731 l 242 594 "},"Û":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 681 1102 l 681 1086 l 572 1086 l 472 1186 l 373 1086 l 264 1086 l 264 1103 l 431 1264 l 513 1264 l 681 1102 "},"₫":{"x_min":66.46875,"x_max":820.65625,"ha":810,"o":"m 737 -187 l 111 -187 l 111 -83 l 737 -83 l 737 -187 m 820 834 l 687 834 l 687 0 l 577 0 l 562 90 q 474 12 526 38 q 352 -14 421 -14 q 142 83 218 -14 q 66 339 66 180 l 66 353 q 142 638 66 530 q 354 747 217 747 q 468 723 418 747 q 553 654 518 699 l 553 834 l 385 834 l 385 940 l 553 940 l 553 1058 l 687 1058 l 687 940 l 820 940 l 820 834 m 200 339 q 245 161 200 227 q 386 94 290 94 q 486 121 446 94 q 553 197 527 148 l 553 539 q 486 611 527 584 q 387 638 445 638 q 245 559 291 638 q 200 353 200 479 l 200 339 "},"Ầ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 706 1075 l 704 1071 l 569 1071 l 456 1177 l 343 1071 l 208 1071 l 207 1075 l 402 1249 l 510 1249 l 706 1075 m 254 1190 l 154 1190 l 17 1366 l 159 1366 l 254 1190 "},"ś":{"x_min":73.734375,"x_max":657.203125,"ha":726,"o":"m 523 194 q 490 267 523 238 q 362 316 456 295 q 161 395 229 345 q 94 531 94 445 q 170 683 94 620 q 368 747 246 747 q 572 681 496 747 q 644 521 647 615 l 642 517 l 515 517 q 475 603 515 565 q 368 641 434 641 q 262 610 297 641 q 227 535 227 579 q 258 467 227 492 q 382 422 288 442 q 589 341 521 392 q 657 204 657 290 q 578 46 657 106 q 371 -14 499 -14 q 150 57 231 -14 q 73 223 69 128 l 75 227 l 202 227 q 255 123 206 156 q 371 90 305 90 q 483 119 442 90 q 523 194 523 148 m 427 1017 l 583 1017 l 584 1013 l 401 837 l 301 837 l 427 1017 "},"V":{"x_min":14.921875,"x_max":863.375,"ha":878,"o":"m 415 245 l 437 167 l 441 167 l 463 245 l 718 988 l 863 988 l 496 0 l 381 0 l 14 988 l 160 988 l 415 245 "},"Ŗ":{"x_min":122.078125,"x_max":855.234375,"ha":920,"o":"m 255 428 l 255 0 l 122 0 l 122 987 l 479 987 q 727 915 641 987 q 812 706 812 843 q 772 573 812 630 q 657 484 733 517 q 774 398 738 457 q 809 251 809 339 l 809 158 q 819 75 809 112 q 855 16 830 39 l 855 0 l 717 0 q 683 67 691 23 q 676 160 676 112 l 676 250 q 629 379 676 330 q 503 428 582 428 l 255 428 m 255 533 l 465 533 q 629 576 579 533 q 678 707 678 619 q 630 836 678 790 q 479 882 581 882 l 255 882 l 255 533 m 469 -160 l 386 -321 l 320 -321 l 361 -154 l 361 -66 l 469 -66 l 469 -160 "}," ":{"x_min":0,"x_max":0,"ha":345},"Ỹ":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 659 1249 q 618 1142 659 1186 q 517 1098 578 1098 q 417 1129 469 1098 q 330 1161 364 1161 q 281 1139 301 1161 q 261 1085 261 1117 l 188 1103 q 228 1212 188 1166 q 330 1259 268 1259 q 425 1227 368 1259 q 517 1195 482 1195 q 565 1217 545 1195 q 586 1271 586 1239 l 659 1249 "},"ʼ":{"x_min":54.265625,"x_max":228.5625,"ha":284,"o":"m 228 927 l 120 692 l 54 692 l 94 925 l 94 1058 l 228 1058 l 228 927 "},"@":{"x_min":76.34375,"x_max":1175.578125,"ha":1243,"o":"m 1174 340 q 1093 90 1168 195 q 868 -14 1018 -14 q 782 14 818 -14 q 731 93 746 42 q 648 12 697 39 q 534 -14 599 -14 q 402 67 449 -14 q 368 282 356 149 q 461 563 383 457 q 651 670 539 670 q 765 652 722 670 q 859 598 809 634 l 857 595 l 861 595 l 826 198 q 841 96 820 124 q 896 68 862 68 q 1030 145 980 68 q 1085 340 1080 222 q 988 744 1096 599 q 651 889 879 889 q 315 732 442 889 q 178 324 188 576 q 280 -78 166 69 q 607 -226 394 -226 q 728 -212 666 -226 q 831 -174 789 -197 l 857 -246 q 741 -291 811 -275 q 604 -307 671 -307 q 205 -137 346 -307 q 77 324 65 31 q 246 791 90 611 q 654 971 402 971 q 1048 801 911 971 q 1174 340 1186 631 m 488 282 q 502 135 480 186 q 575 85 524 85 q 654 102 618 85 q 720 161 690 118 q 719 178 719 169 q 721 198 720 188 l 753 563 q 716 576 735 571 q 676 581 697 581 q 546 506 591 581 q 488 282 501 432 "},"¾":{"x_min":86.71875,"x_max":1150,"ha":1208,"o":"m 427 80 l 354 125 l 836 897 l 910 851 l 427 80 m 1064 191 l 1150 191 l 1150 103 l 1064 103 l 1064 0 l 949 0 l 949 103 l 666 103 l 661 172 l 947 543 l 1064 543 l 1064 191 m 784 191 l 949 191 l 949 401 l 945 401 l 936 387 l 784 191 m 298 772 q 366 791 344 772 q 388 845 388 810 q 363 894 388 874 q 291 914 338 914 q 230 897 253 914 q 207 854 207 881 l 97 854 l 95 858 q 149 962 91 922 q 291 1003 206 1003 q 447 962 390 1003 q 504 847 504 922 q 479 779 504 810 q 413 731 455 748 q 487 683 461 715 q 512 604 512 650 q 451 487 512 529 q 291 445 390 445 q 144 484 205 445 q 86 598 82 523 l 87 603 l 198 603 q 223 552 198 571 q 291 533 249 533 q 369 553 340 533 q 397 605 397 573 q 372 667 397 647 q 298 686 348 686 l 209 686 l 209 772 l 298 772 "},"ŉ":{"x_min":-21.5,"x_max":692.46875,"ha":789,"o":"m 216 734 l 225 624 q 317 715 262 683 q 443 747 373 747 q 627 677 562 747 q 692 462 692 608 l 692 0 l 558 0 l 558 460 q 520 597 558 557 q 403 638 482 638 q 301 610 345 638 q 230 534 257 582 l 230 0 l 96 0 l 96 734 l 216 734 m 127 963 l 44 802 l -21 802 l 19 969 l 19 1058 l 127 1058 l 127 963 "},"i":{"x_min":107.84375,"x_max":241.453125,"ha":350,"o":"m 241 0 l 107 0 l 107 734 l 241 734 l 241 0 m 241 921 l 107 921 l 107 1058 l 241 1058 l 241 921 "},"ẽ":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 614 1032 q 573 925 614 969 q 472 881 533 881 q 372 912 424 881 q 285 944 319 944 q 236 922 256 944 q 216 868 216 900 l 143 886 q 183 995 143 949 q 285 1042 223 1042 q 380 1010 323 1042 q 472 978 437 978 q 520 1000 500 978 q 541 1054 541 1022 l 614 1032 "},"Ģ":{"x_min":81.390625,"x_max":837.609375,"ha":947,"o":"m 837 131 q 715 31 802 76 q 489 -14 628 -14 q 197 99 312 -14 q 81 392 81 212 l 81 595 q 189 888 81 775 q 467 1002 297 1002 q 733 918 636 1002 q 832 703 830 835 l 831 699 l 704 699 q 638 841 697 785 q 467 896 579 896 q 284 812 354 896 q 215 597 215 727 l 215 392 q 292 175 215 260 q 489 90 370 90 q 627 112 573 90 q 704 163 680 135 l 704 387 l 487 387 l 487 493 l 837 493 l 837 131 m 502 -173 l 419 -334 l 353 -334 l 394 -167 l 394 -79 l 502 -79 l 502 -173 "},"m":{"x_min":96.984375,"x_max":1117.03125,"ha":1214,"o":"m 216 734 l 225 637 q 317 718 261 689 q 445 747 372 747 q 571 713 518 747 q 650 611 623 679 q 741 710 685 673 q 874 747 798 747 q 1051 670 986 747 q 1117 438 1117 593 l 1117 0 l 983 0 l 983 439 q 946 593 983 548 q 834 638 908 638 q 724 591 766 638 q 674 471 681 543 l 674 465 l 674 0 l 539 0 l 539 439 q 501 590 539 542 q 391 638 463 638 q 290 613 330 638 q 230 542 251 588 l 230 0 l 96 0 l 96 734 l 216 734 "},"ĕ":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 577 1050 l 579 1046 q 526 918 581 968 q 378 869 471 869 q 230 918 285 869 q 178 1046 175 968 l 180 1050 l 282 1050 q 305 978 282 1006 q 378 950 328 950 q 451 978 427 950 q 475 1050 475 1006 l 577 1050 "},"Ỉ":{"x_min":128.859375,"x_max":349.453125,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 151 1072 l 150 1176 q 224 1190 202 1179 q 246 1225 246 1200 q 216 1265 246 1252 q 137 1278 187 1278 l 142 1351 q 295 1316 242 1351 q 349 1223 349 1281 q 320 1151 349 1175 q 247 1120 291 1126 l 246 1072 l 151 1072 "},"ż":{"x_min":63.75,"x_max":647.03125,"ha":699,"o":"m 223 104 l 647 104 l 647 0 l 63 0 l 63 93 l 460 628 l 68 628 l 68 734 l 623 734 l 623 643 l 223 104 m 429 855 l 281 855 l 281 991 l 429 991 l 429 855 "},"Ị":{"x_min":121.8125,"x_max":269.671875,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 269 -222 l 121 -222 l 121 -86 l 269 -86 l 269 -222 "},"ő":{"x_min":65.78125,"x_max":738.0625,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 580 1047 l 736 1047 l 738 1043 l 534 867 l 418 867 l 417 870 l 580 1047 m 359 1047 l 502 1047 l 504 1044 l 341 867 l 234 867 l 359 1047 "},"ž":{"x_min":63.75,"x_max":647.03125,"ha":699,"o":"m 223 104 l 647 104 l 647 0 l 63 0 l 63 93 l 460 628 l 68 628 l 68 734 l 623 734 l 623 643 l 223 104 m 354 932 l 453 1032 l 569 1032 l 569 1020 l 394 854 l 314 854 l 141 1018 l 141 1032 l 254 1032 l 354 932 "},"ự":{"x_min":94.265625,"x_max":938.046875,"ha":817,"o":"m 935 832 l 937 827 q 879 642 940 707 q 691 568 819 577 l 691 0 l 571 0 l 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 656 l 695 655 q 792 703 763 659 q 821 832 821 746 l 935 832 m 422 -228 l 274 -228 l 274 -92 l 422 -92 l 422 -228 "},"ớ":{"x_min":65.78125,"x_max":851.84375,"ha":797,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 520 723 462 747 q 621 656 577 699 q 703 713 676 669 q 731 829 731 758 l 851 829 q 806 668 851 732 q 674 583 761 604 q 710 485 697 538 q 722 373 722 431 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 459 1017 l 615 1017 l 616 1013 l 433 837 l 333 837 l 459 1017 "},"Ŏ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 672 1282 l 674 1278 q 621 1150 676 1200 q 473 1101 566 1101 q 325 1150 380 1101 q 273 1278 270 1200 l 275 1282 l 377 1282 q 400 1210 377 1238 q 473 1182 423 1182 q 546 1210 522 1182 q 570 1282 570 1238 l 672 1282 "},"á":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 441 1017 l 597 1017 l 598 1013 l 415 837 l 315 837 l 441 1017 "},"×":{"x_min":59.6875,"x_max":673.46875,"ha":743,"o":"m 59 238 l 281 465 l 59 691 l 145 777 l 366 551 l 588 777 l 673 691 l 451 465 l 673 238 l 588 153 l 366 378 l 145 153 l 59 238 "},"ẩ":{"x_min":71.890625,"x_max":774.734375,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 620 845 l 618 841 l 503 841 l 370 967 l 237 841 l 122 841 l 121 845 l 303 1019 l 437 1019 l 620 845 m 603 934 l 602 1024 q 665 1036 647 1027 q 684 1066 684 1045 q 659 1100 684 1089 q 591 1111 633 1111 l 595 1175 q 728 1145 681 1175 q 774 1065 774 1116 q 749 1002 774 1024 q 685 975 723 980 l 684 934 l 603 934 "},"İ":{"x_min":122.515625,"x_max":270.375,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 270 1088 l 122 1088 l 122 1224 l 270 1224 l 270 1088 "},"Ě":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 425 1164 l 524 1264 l 640 1264 l 640 1252 l 465 1086 l 385 1086 l 212 1250 l 212 1264 l 325 1264 l 425 1164 "},"Ố":{"x_min":76.640625,"x_max":909.140625,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 415 1275 l 522 1275 l 717 1101 l 716 1097 l 582 1097 l 468 1203 l 355 1097 l 220 1097 l 219 1101 l 415 1275 m 766 1392 l 909 1392 l 770 1216 l 671 1216 l 766 1392 "},"Ǻ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 514 1414 l 649 1414 l 650 1409 l 504 1288 l 416 1288 l 514 1414 m 330 1142 q 364 1223 330 1191 q 448 1255 399 1255 q 530 1223 496 1255 q 564 1142 564 1191 q 530 1062 564 1093 q 448 1031 496 1031 q 364 1062 399 1031 q 330 1142 330 1093 m 389 1142 q 407 1101 389 1118 q 448 1085 424 1085 q 488 1101 471 1085 q 505 1142 505 1117 q 488 1184 505 1167 q 448 1201 471 1201 q 407 1184 424 1201 q 389 1142 389 1167 "},"K":{"x_min":122.078125,"x_max":889.828125,"ha":893,"o":"m 370 445 l 255 445 l 255 0 l 122 0 l 122 988 l 255 988 l 255 551 l 358 551 l 712 988 l 859 988 l 862 984 l 478 510 l 889 3 l 887 0 l 728 0 l 370 445 "},"7":{"x_min":52.21875,"x_max":720.265625,"ha":782,"o":"m 720 882 q 478 505 541 669 q 387 106 415 340 l 377 0 l 243 0 l 254 106 q 364 523 282 339 q 589 882 446 707 l 52 882 l 52 988 l 720 988 l 720 882 "},"¨":{"x_min":115.296875,"x_max":582.59375,"ha":692,"o":"m 582 852 l 434 852 l 434 987 l 582 987 l 582 852 m 263 852 l 115 852 l 115 987 l 263 987 l 263 852 "},"Y":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 "},"E":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 "},"Ô":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 682 1116 l 682 1100 l 573 1100 l 473 1200 l 374 1100 l 265 1100 l 265 1117 l 432 1278 l 514 1278 l 682 1116 "},"‹":{"x_min":73.25,"x_max":373.703125,"ha":417,"o":"m 200 373 l 373 103 l 273 103 l 73 367 l 73 379 l 273 644 l 373 644 l 200 373 "},"ổ":{"x_min":65.78125,"x_max":793.734375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 639 845 l 637 841 l 522 841 l 389 967 l 256 841 l 141 841 l 140 845 l 322 1019 l 456 1019 l 639 845 m 622 934 l 621 1024 q 684 1036 666 1027 q 703 1066 703 1045 q 678 1100 703 1089 q 610 1111 652 1111 l 614 1175 q 747 1145 700 1175 q 793 1065 793 1116 q 768 1002 793 1024 q 704 975 742 980 l 703 934 l 622 934 "},"Ï":{"x_min":-35.703125,"x_max":431.59375,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 431 1089 l 283 1089 l 283 1224 l 431 1224 l 431 1089 m 112 1089 l -35 1089 l -35 1224 l 112 1224 l 112 1089 "},"ġ":{"x_min":67.828125,"x_max":692.46875,"ha":789,"o":"m 67 353 q 145 638 67 530 q 358 747 222 747 q 481 719 428 747 q 569 638 534 691 l 585 734 l 692 734 l 692 -3 q 610 -220 692 -144 q 373 -296 528 -296 q 259 -281 320 -296 q 151 -241 198 -266 l 185 -137 q 271 -170 221 -158 q 372 -183 322 -183 q 514 -139 470 -183 q 558 -3 558 -94 l 558 78 q 472 9 522 32 q 357 -14 422 -14 q 145 83 222 -14 q 67 339 67 181 l 67 353 m 201 339 q 248 161 201 228 q 390 94 295 94 q 491 121 451 94 q 558 199 532 149 l 558 536 q 491 611 533 583 q 392 638 450 638 q 248 558 296 638 q 201 353 201 478 l 201 339 m 456 869 l 308 869 l 308 1005 l 456 1005 l 456 869 "},"Ẳ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 642 1213 l 644 1209 q 594 1110 648 1148 q 450 1072 541 1072 q 305 1110 358 1072 q 256 1209 251 1148 l 257 1213 l 355 1213 q 378 1157 355 1179 q 450 1135 401 1135 q 521 1157 498 1135 q 544 1213 544 1178 l 642 1213 m 416 1251 l 416 1336 q 486 1346 465 1338 q 503 1371 506 1354 l 503 1375 q 479 1403 506 1394 q 404 1413 451 1413 l 408 1469 q 556 1442 505 1469 q 608 1371 608 1416 q 580 1317 608 1335 q 509 1293 551 1298 l 508 1251 l 416 1251 "},"ứ":{"x_min":94.265625,"x_max":938.046875,"ha":817,"o":"m 935 832 l 937 827 q 879 642 940 707 q 691 568 819 577 l 691 0 l 571 0 l 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 656 l 695 655 q 792 703 763 659 q 821 832 821 746 l 935 832 m 457 1002 l 613 1002 l 614 998 l 431 822 l 331 822 l 457 1002 "},"ủ":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 348 841 l 347 945 q 421 959 399 948 q 443 994 443 969 q 413 1034 443 1021 q 334 1047 384 1047 l 339 1120 q 492 1085 439 1120 q 546 992 546 1050 q 517 920 546 944 q 444 889 488 895 l 443 841 l 348 841 "},"Ằ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 495 1233 l 414 1233 l 279 1363 l 280 1367 l 401 1367 l 495 1233 m 650 1218 l 652 1214 q 600 1115 656 1154 q 450 1077 544 1077 q 300 1115 355 1077 q 249 1214 244 1154 l 250 1218 l 353 1218 q 376 1162 353 1184 q 450 1141 399 1141 q 523 1162 500 1141 q 547 1218 547 1184 l 650 1218 "},"ķ":{"x_min":97.671875,"x_max":713.484375,"ha":712,"o":"m 318 338 l 231 338 l 231 0 l 97 0 l 97 1058 l 231 1058 l 231 445 l 316 445 l 517 734 l 677 734 l 426 400 l 713 0 l 556 0 l 318 338 m 412 -160 l 329 -321 l 263 -321 l 304 -154 l 304 -66 l 412 -66 l 412 -160 "},"Ấ":{"x_min":13.5625,"x_max":892.140625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 398 1261 l 505 1261 l 700 1087 l 699 1083 l 565 1083 l 451 1189 l 338 1083 l 203 1083 l 202 1087 l 398 1261 m 749 1378 l 892 1378 l 753 1202 l 654 1202 l 749 1378 "}," ":{"x_min":0,"x_max":0,"ha":473},"ể":{"x_min":67.140625,"x_max":777.734375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 623 846 l 621 842 l 506 842 l 373 968 l 240 842 l 125 842 l 124 846 l 306 1020 l 440 1020 l 623 846 m 606 935 l 605 1025 q 668 1037 650 1028 q 687 1067 687 1046 q 662 1101 687 1090 q 594 1112 636 1112 l 598 1176 q 731 1146 684 1176 q 777 1066 777 1117 q 752 1003 777 1025 q 688 976 726 981 l 687 935 l 606 935 "},"±":{"x_min":67.140625,"x_max":688.390625,"ha":744,"o":"m 445 581 l 688 581 l 688 476 l 445 476 l 445 196 l 325 196 l 325 476 l 67 476 l 67 581 l 325 581 l 325 859 l 445 859 l 445 581 m 658 3 l 92 3 l 92 108 l 658 108 l 658 3 "},"ì":{"x_min":-48.390625,"x_max":237.375,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 228 825 l 121 825 l -48 1001 l -46 1005 l 109 1005 l 228 825 "},"|":{"x_min":118.6875,"x_max":225.84375,"ha":344,"o":"m 225 -183 l 118 -183 l 118 988 l 225 988 l 225 -183 "},"§":{"x_min":63.75,"x_max":778.59375,"ha":854,"o":"m 778 292 q 746 181 778 228 q 654 106 713 133 q 725 25 701 72 q 748 -86 748 -20 q 658 -269 748 -203 q 415 -336 568 -336 q 163 -266 265 -336 q 64 -47 61 -196 l 65 -43 l 193 -42 q 258 -185 193 -139 q 415 -230 324 -230 q 561 -190 508 -230 q 615 -88 615 -150 q 566 7 615 -26 q 379 85 517 42 q 140 190 217 127 q 63 374 63 253 q 95 483 63 435 q 186 559 127 531 q 117 640 140 593 q 94 753 94 687 q 185 933 94 865 q 427 1002 276 1002 q 674 926 585 1002 q 759 713 762 850 l 757 709 l 630 709 q 576 843 630 789 q 427 896 522 896 q 278 856 329 896 q 227 754 227 816 q 273 653 227 687 q 461 581 318 620 q 702 472 627 534 q 778 292 778 411 m 408 467 q 348 484 377 475 q 296 503 320 492 q 222 456 246 490 q 197 375 197 422 q 243 272 197 307 q 432 197 289 237 q 495 178 470 186 q 542 163 520 171 q 618 210 591 176 q 645 290 645 243 q 595 388 645 352 q 408 467 545 424 "},"˳":{"x_min":123.4375,"x_max":333.6875,"ha":456,"o":"m 123 -158 q 154 -85 123 -114 q 229 -56 185 -56 q 303 -85 272 -56 q 333 -158 333 -114 q 303 -229 333 -201 q 229 -257 273 -257 q 154 -229 185 -257 q 123 -158 123 -201 m 183 -158 q 197 -189 183 -176 q 229 -202 210 -202 q 260 -189 247 -202 q 273 -158 273 -177 q 260 -125 273 -138 q 229 -111 247 -111 q 197 -125 210 -111 q 183 -158 183 -139 "},"q":{"x_min":66.46875,"x_max":679.578125,"ha":789,"o":"m 66 353 q 142 638 66 530 q 354 747 217 747 q 472 721 421 747 q 558 647 522 696 l 577 734 l 679 734 l 679 -282 l 545 -282 l 545 69 q 462 7 510 28 q 352 -14 414 -14 q 142 83 218 -14 q 66 339 66 180 l 66 353 m 200 339 q 245 159 200 227 q 386 90 291 90 q 480 114 441 90 q 545 183 519 139 l 545 553 q 480 618 519 594 q 387 641 441 641 q 246 560 292 641 q 200 353 200 479 l 200 339 "},"b":{"x_min":96.984375,"x_max":723.65625,"ha":789,"o":"m 723 339 q 647 83 723 180 q 437 -14 571 -14 q 311 14 364 -14 q 222 96 257 42 l 206 0 l 96 0 l 96 1058 l 230 1058 l 230 646 q 316 721 265 695 q 436 747 367 747 q 647 638 571 747 q 723 353 723 530 l 723 339 m 590 353 q 543 558 590 479 q 402 638 497 638 q 298 608 340 638 q 230 527 255 578 l 230 209 q 298 125 256 155 q 403 94 339 94 q 543 161 497 94 q 590 339 590 228 l 590 353 "},"ộ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 603 883 l 603 867 l 494 867 l 394 967 l 295 867 l 186 867 l 186 884 l 353 1045 l 435 1045 l 603 883 m 468 -233 l 320 -233 l 320 -97 l 468 -97 l 468 -233 "},"®":{"x_min":59.6875,"x_max":1022.078125,"ha":1088,"o":"m 59 494 q 200 854 59 708 q 541 1001 340 1001 q 881 854 741 1001 q 1022 494 1022 708 q 881 133 1022 280 q 541 -14 740 -14 q 200 133 340 -14 q 59 494 59 280 m 141 494 q 258 191 141 314 q 541 68 374 68 q 823 191 706 68 q 940 494 940 314 q 823 795 940 673 q 541 918 707 918 q 258 795 374 918 q 141 494 141 673 m 442 443 l 442 214 l 341 214 l 341 791 l 531 791 q 693 746 634 791 q 752 616 752 702 q 729 542 752 574 q 664 489 707 510 q 729 436 709 472 q 749 349 749 400 l 749 311 q 751 261 749 283 q 760 224 754 239 l 760 214 l 657 214 q 649 255 651 228 q 648 311 648 283 l 648 348 q 625 420 648 397 q 550 443 602 443 l 442 443 m 442 532 l 545 532 q 620 554 590 532 q 651 613 651 575 q 624 682 651 662 q 531 702 598 702 l 442 702 l 442 532 "},"₧":{"x_min":111.234375,"x_max":1052.609375,"ha":1141,"o":"m 906 911 l 906 734 l 1045 734 l 1045 634 l 906 634 l 906 189 q 928 116 906 137 q 984 95 949 95 q 1010 98 996 95 q 1034 105 1024 101 l 1052 13 q 1008 -6 1037 1 q 950 -14 980 -14 q 821 35 869 -14 q 773 189 773 84 l 773 634 l 681 634 q 596 466 668 534 q 351 383 508 383 l 244 383 l 244 0 l 111 0 l 111 988 l 351 988 q 596 903 508 988 q 681 734 668 834 l 773 734 l 773 911 l 906 911 m 244 488 l 351 488 q 500 544 451 488 q 550 684 550 601 q 500 825 550 767 q 351 882 451 882 l 244 882 l 244 488 "},"Ŋ":{"x_min":109.1875,"x_max":855.921875,"ha":960,"o":"m 855 988 l 855 -59 q 797 -234 855 -173 q 634 -296 739 -296 q 596 -292 613 -296 q 558 -283 578 -289 l 568 -182 q 600 -188 577 -185 q 634 -190 623 -190 q 698 -156 675 -190 q 722 -60 722 -121 l 722 0 l 246 754 l 242 753 l 242 0 l 109 0 l 109 988 l 242 988 l 718 233 l 722 234 l 722 988 l 855 988 "},"ọ":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 468 -233 l 320 -233 l 320 -97 l 468 -97 l 468 -233 "},"Ũ":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 708 1249 q 667 1142 708 1186 q 566 1098 627 1098 q 466 1129 518 1098 q 379 1161 413 1161 q 330 1139 350 1161 q 310 1085 310 1117 l 237 1103 q 277 1212 237 1166 q 379 1259 317 1259 q 474 1227 417 1259 q 566 1195 531 1195 q 614 1217 594 1195 q 635 1271 635 1239 l 708 1249 "},"L":{"x_min":122.078125,"x_max":722.984375,"ha":750,"o":"m 255 104 l 722 104 l 722 0 l 122 0 l 122 988 l 255 988 l 255 104 "},"ế":{"x_min":67.140625,"x_max":814.140625,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 320 1043 l 427 1043 l 622 869 l 621 865 l 487 865 l 373 971 l 260 865 l 125 865 l 124 869 l 320 1043 m 671 1160 l 814 1160 l 675 984 l 576 984 l 671 1160 "},"ď":{"x_min":66.46875,"x_max":888.03125,"ha":891,"o":"m 66 353 q 142 638 66 530 q 354 747 217 747 q 468 723 418 747 q 553 654 518 699 l 553 1058 l 687 1058 l 687 0 l 577 0 l 562 90 q 474 12 526 38 q 352 -14 421 -14 q 142 83 218 -14 q 66 339 66 180 l 66 353 m 200 339 q 245 161 200 227 q 386 94 290 94 q 486 121 446 94 q 553 197 527 148 l 553 539 q 486 611 527 584 q 387 638 445 638 q 245 559 291 638 q 200 353 200 479 l 200 339 m 888 963 l 805 802 l 739 802 l 780 969 l 780 1058 l 888 1058 l 888 963 "}," ":{"x_min":0,"x_max":0,"ha":345},"Ĭ":{"x_min":-2.328125,"x_max":398.15625,"ha":393,"o":"m 263 0 l 128 0 l 128 988 l 263 988 l 263 0 m 396 1268 l 398 1264 q 345 1136 400 1186 q 197 1087 290 1087 q 49 1136 104 1087 q -2 1264 -5 1186 l 0 1268 l 101 1268 q 124 1196 101 1224 q 197 1168 147 1168 q 270 1196 246 1168 q 294 1268 294 1224 l 396 1268 "},"ŧ":{"x_min":-5.421875,"x_max":429.3125,"ha":480,"o":"m 273 911 l 273 734 l 412 734 l 412 634 l 273 634 l 273 512 l 429 512 l 429 406 l 273 406 l 273 189 q 294 116 273 137 q 351 95 316 95 q 376 98 362 95 q 401 105 390 101 l 419 13 q 375 -6 404 1 q 317 -14 346 -14 q 187 35 236 -14 q 139 189 139 84 l 139 406 l -5 406 l -5 512 l 139 512 l 139 634 l 23 634 l 23 734 l 139 734 l 139 911 l 273 911 "},"À":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 533 1057 l 426 1057 l 256 1233 l 258 1238 l 414 1238 l 533 1057 "},"ẃ":{"x_min":30.515625,"x_max":1017.328125,"ha":1051,"o":"m 284 267 l 300 178 l 304 178 l 323 267 l 470 734 l 577 734 l 724 267 l 745 168 l 749 168 l 769 267 l 884 734 l 1017 734 l 804 0 l 696 0 l 554 447 l 524 571 l 520 571 l 491 447 l 351 0 l 243 0 l 30 734 l 163 734 l 284 267 m 588 1002 l 744 1002 l 745 998 l 562 822 l 462 822 l 588 1002 "},"+":{"x_min":52.90625,"x_max":729.765625,"ha":788,"o":"m 459 531 l 729 531 l 729 410 l 459 410 l 459 98 l 325 98 l 325 410 l 52 410 l 52 531 l 325 531 l 325 817 l 459 817 l 459 531 "},"ḁ":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 229 -158 q 260 -85 229 -114 q 335 -56 291 -56 q 409 -85 378 -56 q 439 -158 439 -114 q 409 -229 439 -201 q 335 -257 379 -257 q 260 -229 291 -257 q 229 -158 229 -201 m 289 -158 q 303 -189 289 -176 q 335 -202 316 -202 q 366 -189 353 -202 q 379 -158 379 -177 q 366 -125 379 -138 q 335 -111 353 -111 q 303 -125 316 -111 q 289 -158 289 -139 "},"½":{"x_min":124.4375,"x_max":1034.25,"ha":1158,"o":"m 312 80 l 239 125 l 721 897 l 795 851 l 312 80 m 328 450 l 210 450 l 210 894 l 124 894 l 124 985 l 328 1001 l 328 450 m 1034 0 l 632 0 l 632 88 l 837 266 q 899 332 884 306 q 914 386 914 357 q 894 441 914 420 q 836 462 875 462 q 766 440 790 462 q 741 384 741 418 l 632 384 l 630 388 q 683 503 626 456 q 836 551 740 551 q 979 507 927 551 q 1030 385 1030 464 q 1000 293 1030 331 q 891 183 970 255 l 788 92 l 789 88 l 1034 88 l 1034 0 "},"Ë":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 659 1089 l 511 1089 l 511 1224 l 659 1224 l 659 1089 m 340 1089 l 192 1089 l 192 1224 l 340 1224 l 340 1089 "},"'":{"x_min":54.265625,"x_max":188.546875,"ha":243,"o":"m 188 906 l 120 715 l 54 715 l 54 895 l 54 1058 l 188 1058 l 188 906 "},"Š":{"x_min":69.078125,"x_max":793.515625,"ha":866,"o":"m 659 249 q 609 362 659 316 q 428 439 558 408 q 184 549 271 477 q 96 732 96 622 q 190 924 96 847 q 436 1002 285 1002 q 694 913 598 1002 q 786 706 790 824 l 785 702 l 657 702 q 600 843 657 789 q 436 896 543 896 q 283 851 336 896 q 229 734 229 806 q 287 626 229 669 q 474 550 345 583 q 712 437 630 512 q 793 250 793 361 q 695 58 793 131 q 440 -14 598 -14 q 179 66 293 -14 q 69 280 65 146 l 70 284 l 198 284 q 267 139 198 189 q 440 90 337 90 q 600 133 541 90 q 659 249 659 175 m 415 1179 l 514 1279 l 630 1279 l 630 1267 l 455 1101 l 375 1101 l 202 1265 l 202 1279 l 315 1279 l 415 1179 "},"ĳ":{"x_min":107.84375,"x_max":600.9375,"ha":709,"o":"m 241 0 l 107 0 l 107 734 l 241 734 l 241 0 m 241 921 l 107 921 l 107 1058 l 241 1058 l 241 921 m 600 734 l 600 -60 q 542 -234 600 -173 q 380 -296 484 -296 q 342 -292 359 -296 q 305 -283 324 -289 l 314 -178 q 341 -184 324 -182 q 371 -186 359 -186 q 441 -156 415 -186 q 467 -60 467 -127 l 467 734 l 600 734 m 596 924 l 463 924 l 463 1058 l 596 1058 l 596 924 "}," ":{"x_min":0,"x_max":0,"ha":1417},"˛":{"x_min":46.125,"x_max":316.734375,"ha":381,"o":"m 263 0 q 188 -67 215 -35 q 162 -136 162 -99 q 177 -181 162 -164 q 227 -197 192 -197 q 261 -192 245 -197 q 294 -179 276 -187 l 316 -263 q 262 -284 292 -276 q 192 -293 233 -293 q 87 -255 128 -293 q 46 -151 46 -218 q 87 -48 46 -96 q 214 38 128 0 l 263 0 "},"ở":{"x_min":65.78125,"x_max":851.84375,"ha":797,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 520 723 462 747 q 621 656 577 699 q 703 713 676 669 q 731 829 731 758 l 851 829 q 806 668 851 732 q 674 583 761 604 q 710 485 697 538 q 722 373 722 431 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 350 854 l 349 958 q 423 972 401 961 q 445 1007 445 982 q 415 1047 445 1034 q 336 1060 386 1060 l 341 1133 q 494 1098 441 1133 q 548 1005 548 1063 q 519 933 548 957 q 446 902 490 908 l 445 854 l 350 854 "},"ð":{"x_min":48.828125,"x_max":727.0625,"ha":815,"o":"m 592 879 q 691 716 656 809 q 727 512 727 622 l 727 363 q 629 91 727 196 q 385 -14 531 -14 q 143 80 238 -14 q 48 316 48 175 q 142 566 48 470 q 380 663 236 663 q 495 637 441 663 q 584 572 549 612 l 587 575 q 552 709 581 649 q 477 813 523 768 l 280 701 l 228 770 l 402 870 q 347 896 375 885 q 289 917 319 908 l 330 1029 q 432 993 383 1016 q 524 940 481 971 l 672 1024 l 724 955 l 592 879 m 388 90 q 536 167 478 90 q 593 362 593 244 l 593 463 q 515 530 569 503 q 380 557 460 557 q 237 487 291 557 q 182 316 182 416 q 238 158 182 226 q 388 90 293 90 "},"ş":{"x_min":73.734375,"x_max":657.203125,"ha":726,"o":"m 523 194 q 490 267 523 238 q 362 316 456 295 q 161 395 229 345 q 94 531 94 445 q 170 683 94 620 q 368 747 246 747 q 572 681 496 747 q 644 521 647 615 l 642 517 l 515 517 q 475 603 515 565 q 368 641 434 641 q 262 610 297 641 q 227 535 227 579 q 258 467 227 492 q 382 422 288 442 q 589 341 521 392 q 657 204 657 290 q 578 46 657 106 q 371 -14 499 -14 q 150 57 231 -14 q 73 223 69 128 l 75 227 l 202 227 q 255 123 206 156 q 371 90 305 90 q 483 119 442 90 q 523 194 523 148 m 414 -4 l 405 -40 q 479 -75 449 -47 q 508 -157 508 -103 q 454 -261 508 -222 q 301 -300 401 -300 l 296 -226 q 375 -209 345 -226 q 405 -159 405 -192 q 380 -114 405 -127 q 297 -96 356 -101 l 319 -4 l 414 -4 "},"Ỡ":{"x_min":73.25,"x_max":1041.078125,"ha":952,"o":"m 866 405 q 753 105 866 224 q 462 -14 641 -14 q 181 105 289 -14 q 73 405 73 224 l 73 581 q 181 881 73 761 q 462 1002 289 1002 q 613 974 543 1002 q 737 898 683 947 q 864 963 820 905 q 907 1121 907 1021 l 1041 1121 q 981 908 1041 990 q 811 801 921 826 q 851 697 837 753 q 866 581 866 640 l 866 405 m 732 582 q 659 805 732 718 q 462 892 585 892 q 276 805 345 892 q 206 582 206 718 l 206 405 q 276 182 206 268 q 462 95 345 95 q 659 181 586 95 q 732 405 732 268 l 732 582 m 711 1237 q 670 1130 711 1174 q 569 1086 630 1086 q 469 1117 521 1086 q 382 1149 416 1149 q 333 1127 353 1149 q 313 1073 313 1105 l 240 1091 q 280 1200 240 1154 q 382 1247 320 1247 q 477 1215 420 1247 q 569 1183 534 1183 q 617 1205 597 1183 q 638 1259 638 1227 l 711 1237 "}," ":{"x_min":0,"x_max":0,"ha":781},"ı":{"x_min":103.765625,"x_max":237.375,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 "},"Ć":{"x_min":80.03125,"x_max":821.40625,"ha":880,"o":"m 819 316 l 821 312 q 723 79 824 173 q 458 -14 623 -14 q 185 104 290 -14 q 80 405 80 223 l 80 581 q 185 882 80 763 q 458 1002 290 1002 q 725 912 626 1002 q 821 676 824 823 l 819 672 l 691 672 q 630 836 691 776 q 458 896 569 896 q 280 806 346 896 q 213 582 213 716 l 213 405 q 280 180 213 270 q 458 90 346 90 q 630 150 569 90 q 691 316 691 210 l 819 316 m 524 1249 l 680 1249 l 681 1244 l 498 1068 l 398 1068 l 524 1249 "},"ä":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 610 870 l 462 870 l 462 1005 l 610 1005 l 610 870 m 291 870 l 143 870 l 143 1005 l 291 1005 l 291 870 "},"¹":{"x_min":64.4375,"x_max":268.578125,"ha":378,"o":"m 268 451 l 150 451 l 150 895 l 64 895 l 64 986 l 268 1002 l 268 451 "},"£":{"x_min":47.46875,"x_max":753.5,"ha":810,"o":"m 291 416 l 295 315 q 285 199 295 254 q 255 104 274 144 l 753 104 l 752 0 l 90 0 l 90 104 l 97 104 q 146 179 130 113 q 162 315 162 246 l 158 416 l 47 416 l 47 522 l 154 522 l 147 705 q 223 922 147 843 q 427 1002 299 1002 q 637 931 562 1002 q 709 743 712 860 l 708 739 l 579 739 q 536 858 579 819 q 427 896 493 896 q 320 846 360 896 q 281 705 281 795 l 288 522 l 571 522 l 571 416 l 291 416 "},"ẹ":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 462 -228 l 314 -228 l 314 -92 l 462 -92 l 462 -228 "},"ů":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 251 943 q 292 1039 251 1000 q 392 1077 333 1077 q 490 1039 449 1077 q 531 943 531 1001 q 490 848 531 885 q 392 812 450 812 q 292 848 333 812 q 251 943 251 885 m 321 943 q 342 893 321 914 q 392 873 363 873 q 441 893 420 873 q 461 943 461 913 q 441 995 461 974 q 392 1016 420 1016 q 342 995 363 1016 q 321 943 321 974 "},"Ō":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 721 1126 l 232 1126 l 232 1225 l 721 1225 l 721 1126 "},"W":{"x_min":36.625,"x_max":1182.140625,"ha":1227,"o":"m 320 341 l 338 218 l 342 217 l 368 341 l 550 988 l 668 988 l 850 341 l 877 215 l 881 215 l 901 341 l 1048 988 l 1182 988 l 944 0 l 824 0 l 630 685 l 612 774 l 608 774 l 591 685 l 393 0 l 274 0 l 36 988 l 169 988 l 320 341 "},"ỉ":{"x_min":103.765625,"x_max":324.453125,"ha":349,"o":"m 237 0 l 103 0 l 103 734 l 237 734 l 237 0 m 126 841 l 125 945 q 199 959 177 948 q 221 994 221 969 q 191 1034 221 1021 q 112 1047 162 1047 l 117 1120 q 270 1085 217 1120 q 324 992 324 1050 q 295 920 324 944 q 222 889 266 895 l 221 841 l 126 841 "},"Ğ":{"x_min":81.390625,"x_max":837.609375,"ha":947,"o":"m 837 131 q 715 31 802 76 q 489 -14 628 -14 q 197 99 312 -14 q 81 392 81 212 l 81 595 q 189 888 81 775 q 467 1002 297 1002 q 733 918 636 1002 q 832 703 830 835 l 831 699 l 704 699 q 638 841 697 785 q 467 896 579 896 q 284 812 354 896 q 215 597 215 727 l 215 392 q 292 175 215 260 q 489 90 370 90 q 627 112 573 90 q 704 163 680 135 l 704 387 l 487 387 l 487 493 l 837 493 l 837 131 m 652 1282 l 654 1278 q 601 1150 656 1200 q 453 1101 546 1101 q 305 1150 360 1101 q 253 1278 250 1200 l 255 1282 l 357 1282 q 380 1210 357 1238 q 453 1182 403 1182 q 526 1210 502 1182 q 550 1282 550 1238 l 652 1282 "},"v":{"x_min":31.203125,"x_max":675.515625,"ha":699,"o":"m 341 216 l 353 164 l 357 164 l 370 216 l 539 734 l 675 734 l 405 0 l 304 0 l 31 734 l 168 734 l 341 216 "},">":{"x_min":92.234375,"x_max":672.796875,"ha":727,"o":"m 92 541 l 92 673 l 672 417 l 672 315 l 92 58 l 92 191 l 497 353 l 555 364 l 555 368 l 497 382 l 92 541 "},"Ệ":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 634 1102 l 634 1086 l 525 1086 l 425 1186 l 326 1086 l 217 1086 l 217 1103 l 384 1264 l 466 1264 l 634 1102 m 499 -221 l 351 -221 l 351 -85 l 499 -85 l 499 -221 "},"û":{"x_min":94.265625,"x_max":691.78125,"ha":789,"o":"m 562 108 q 474 17 528 49 q 348 -14 419 -14 q 161 62 228 -14 q 94 301 94 139 l 94 734 l 227 734 l 227 299 q 262 138 227 182 q 370 94 297 94 q 487 123 441 94 q 558 205 534 152 l 558 734 l 691 734 l 691 0 l 571 0 l 562 108 m 602 869 l 602 853 l 493 853 l 393 953 l 294 853 l 185 853 l 185 870 l 352 1031 l 434 1031 l 602 869 "},"Ź":{"x_min":65.78125,"x_max":768.421875,"ha":831,"o":"m 216 104 l 768 104 l 768 0 l 65 0 l 65 99 l 593 882 l 73 882 l 73 988 l 746 988 l 746 892 l 216 104 m 477 1235 l 633 1235 l 634 1230 l 451 1054 l 351 1054 l 477 1235 "},"Ų":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 551 0 q 476 -67 503 -35 q 450 -136 450 -99 q 465 -181 450 -164 q 515 -197 480 -197 q 549 -192 533 -197 q 582 -179 564 -187 l 604 -263 q 550 -284 580 -276 q 480 -293 521 -293 q 375 -255 416 -293 q 334 -151 334 -218 q 375 -48 334 -96 q 502 38 416 0 l 551 0 "},"Ŵ":{"x_min":36.625,"x_max":1182.140625,"ha":1227,"o":"m 320 341 l 338 218 l 342 217 l 368 341 l 550 988 l 668 988 l 850 341 l 877 215 l 881 215 l 901 341 l 1048 988 l 1182 988 l 944 0 l 824 0 l 630 685 l 612 774 l 608 774 l 591 685 l 393 0 l 274 0 l 36 988 l 169 988 l 320 341 m 818 1102 l 818 1086 l 709 1086 l 609 1186 l 510 1086 l 401 1086 l 401 1103 l 568 1264 l 650 1264 l 818 1102 "},"‛":{"x_min":29.46875,"x_max":203.734375,"ha":284,"o":"m 29 927 l 137 692 l 203 692 l 163 925 l 163 1058 l 29 1058 l 29 927 "},"Ð":{"x_min":28.484375,"x_max":874.234375,"ha":935,"o":"m 142 0 l 142 449 l 28 449 l 28 555 l 142 555 l 142 988 l 445 988 q 756 868 639 988 q 874 561 874 749 l 874 426 q 756 118 874 236 q 445 0 639 0 l 142 0 m 463 449 l 276 449 l 276 104 l 445 104 q 661 194 582 104 q 740 426 740 284 l 740 562 q 661 792 740 702 q 445 882 582 882 l 276 882 l 276 555 l 463 555 l 463 449 "},"ˉ":{"x_min":83.421875,"x_max":572.421875,"ha":644,"o":"m 572 888 l 83 888 l 83 987 l 572 987 l 572 888 "},"Ĺ":{"x_min":122.078125,"x_max":722.984375,"ha":750,"o":"m 255 104 l 722 104 l 722 0 l 122 0 l 122 988 l 255 988 l 255 104 m 251 1235 l 407 1235 l 408 1230 l 225 1054 l 125 1054 l 251 1235 "},"ỵ":{"x_min":17.640625,"x_max":678.21875,"ha":699,"o":"m 321 272 l 345 180 l 349 180 l 529 734 l 678 734 l 369 -112 q 289 -241 341 -186 q 149 -296 238 -296 q 108 -292 133 -296 q 69 -285 83 -288 l 83 -180 q 107 -181 79 -179 q 143 -183 135 -183 q 212 -145 185 -183 q 258 -61 240 -107 l 290 15 l 17 734 l 166 734 l 321 272 m 560 -334 l 412 -334 l 412 -198 l 560 -198 l 560 -334 "},"r":{"x_min":96.984375,"x_max":462.546875,"ha":476,"o":"m 444 615 l 375 619 q 286 594 322 619 q 230 523 250 569 l 230 0 l 96 0 l 96 734 l 216 734 l 229 626 q 306 715 260 683 q 411 747 352 747 q 440 744 426 747 q 462 739 453 742 l 444 615 "},"₤":{"x_min":47.46875,"x_max":753.5,"ha":810,"o":"m 295 298 q 283 191 293 242 q 255 104 273 141 l 753 104 l 752 0 l 90 0 l 90 104 l 97 104 q 144 171 128 112 q 162 298 160 229 l 47 298 l 47 404 l 159 404 l 155 500 l 48 500 l 48 606 l 151 606 l 147 705 q 223 922 147 843 q 427 1002 299 1002 q 637 931 562 1002 q 709 743 712 860 l 708 739 l 579 739 q 536 858 579 819 q 427 896 493 896 q 320 846 360 896 q 281 705 281 795 l 284 606 l 571 606 l 571 500 l 288 500 l 292 404 l 571 404 l 571 298 l 295 298 "},"Č":{"x_min":80.03125,"x_max":821.40625,"ha":880,"o":"m 819 316 l 821 312 q 723 79 824 173 q 458 -14 623 -14 q 185 104 290 -14 q 80 405 80 223 l 80 581 q 185 882 80 763 q 458 1002 290 1002 q 725 912 626 1002 q 821 676 824 823 l 819 672 l 691 672 q 630 836 691 776 q 458 896 569 896 q 280 806 346 896 q 213 582 213 716 l 213 405 q 280 180 213 270 q 458 90 346 90 q 630 150 569 90 q 691 316 691 210 l 819 316 m 459 1179 l 558 1279 l 674 1279 l 674 1267 l 499 1101 l 419 1101 l 246 1265 l 246 1279 l 359 1279 l 459 1179 "},"x":{"x_min":31.203125,"x_max":664.65625,"ha":699,"o":"m 345 463 l 501 734 l 657 734 l 419 371 l 664 0 l 511 0 l 348 277 l 185 0 l 31 0 l 276 371 l 37 734 l 191 734 l 345 463 "},"è":{"x_min":67.140625,"x_max":681.609375,"ha":735,"o":"m 401 -14 q 157 87 248 -14 q 67 352 67 189 l 67 382 q 160 642 67 538 q 381 747 253 747 q 605 657 529 747 q 681 419 681 568 l 681 336 l 205 336 l 203 332 q 257 158 205 226 q 401 90 308 90 q 520 109 469 90 q 609 163 571 129 l 661 76 q 557 11 621 37 q 401 -14 493 -14 m 381 641 q 266 585 314 641 q 208 443 219 529 l 209 440 l 548 440 l 548 458 q 505 589 548 536 q 381 641 463 641 m 434 840 l 327 840 l 157 1016 l 159 1020 l 315 1020 l 434 840 "},"Ń":{"x_min":122.078125,"x_max":868.796875,"ha":991,"o":"m 868 0 l 735 0 l 259 764 l 255 762 l 255 0 l 122 0 l 122 988 l 255 988 l 731 225 l 735 226 l 735 988 l 868 988 l 868 0 m 558 1235 l 714 1235 l 715 1230 l 532 1054 l 432 1054 l 558 1235 "},"Ø":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 357 0 408 -14 q 262 40 305 13 l 200 -63 l 99 -63 l 193 95 q 106 232 137 152 q 76 405 76 312 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 587 984 529 1002 q 693 936 644 967 l 748 1029 l 849 1029 l 759 879 q 840 745 811 822 q 869 581 869 668 l 869 405 m 210 405 q 223 298 210 348 q 259 213 236 249 l 263 213 l 632 834 q 556 877 598 862 q 465 892 514 892 q 279 805 349 892 q 210 582 210 718 l 210 405 m 735 582 q 724 679 735 633 q 693 758 713 724 l 689 759 l 322 141 q 387 106 352 118 q 465 95 423 95 q 662 181 590 95 q 735 405 735 268 l 735 582 "},"Ỳ":{"x_min":13.5625,"x_max":834.21875,"ha":848,"o":"m 423 485 l 681 988 l 834 988 l 487 347 l 487 0 l 354 0 l 354 356 l 13 988 l 166 988 l 423 485 m 480 1056 l 373 1056 l 203 1232 l 205 1237 l 361 1237 l 480 1056 "},"Ẽ":{"x_min":122.078125,"x_max":777.25,"ha":812,"o":"m 708 457 l 255 457 l 255 104 l 777 104 l 777 0 l 122 0 l 122 988 l 769 988 l 769 882 l 255 882 l 255 563 l 708 563 l 708 457 m 661 1249 q 620 1142 661 1186 q 519 1098 580 1098 q 419 1129 471 1098 q 332 1161 366 1161 q 283 1139 303 1161 q 263 1085 263 1117 l 190 1103 q 230 1212 190 1166 q 332 1259 270 1259 q 427 1227 370 1259 q 519 1195 484 1195 q 567 1217 547 1195 q 588 1271 588 1239 l 661 1249 "},"ḿ":{"x_min":96.984375,"x_max":1117.03125,"ha":1214,"o":"m 216 734 l 225 637 q 317 718 261 689 q 445 747 372 747 q 571 713 518 747 q 650 611 623 679 q 741 710 685 673 q 874 747 798 747 q 1051 670 986 747 q 1117 438 1117 593 l 1117 0 l 983 0 l 983 439 q 946 593 983 548 q 834 638 908 638 q 724 591 766 638 q 674 471 681 543 l 674 465 l 674 0 l 539 0 l 539 439 q 501 590 539 542 q 391 638 463 638 q 290 613 330 638 q 230 542 251 588 l 230 0 l 96 0 l 96 734 l 216 734 m 685 1017 l 841 1017 l 842 1013 l 659 837 l 559 837 l 685 1017 "},"÷":{"x_min":48.15625,"x_max":725.015625,"ha":794,"o":"m 725 404 l 48 404 l 48 532 l 725 532 l 725 404 m 454 677 l 320 677 l 320 814 l 454 814 l 454 677 m 454 121 l 320 121 l 320 259 l 454 259 l 454 121 "},"h":{"x_min":96.984375,"x_max":694.5,"ha":789,"o":"m 230 635 q 323 717 268 687 q 446 747 379 747 q 629 676 563 747 q 694 459 694 606 l 694 0 l 560 0 l 560 460 q 521 595 560 551 q 405 638 482 638 q 304 612 349 638 q 230 541 259 586 l 230 0 l 96 0 l 96 1058 l 230 1058 l 230 635 "},".":{"x_min":109.1875,"x_max":242.796875,"ha":372,"o":"m 242 0 l 109 0 l 109 137 l 242 137 l 242 0 "},"f":{"x_min":37.984375,"x_max":483.578125,"ha":480,"o":"m 152 0 l 152 634 l 37 634 l 37 734 l 152 734 l 152 826 q 213 1007 152 943 q 385 1072 275 1072 q 431 1068 408 1072 q 483 1057 455 1064 l 467 956 q 437 960 455 958 q 401 962 420 962 q 314 927 343 962 q 286 826 286 893 l 286 734 l 438 734 l 438 634 l 286 634 l 286 0 l 152 0 "},"“":{"x_min":54.265625,"x_max":451.5625,"ha":505,"o":"m 54 816 l 162 1058 l 228 1058 l 187 812 l 187 691 l 54 691 l 54 816 m 277 816 l 385 1058 l 451 1058 l 410 812 l 410 691 l 277 691 l 277 816 "},"A":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 "},"‘":{"x_min":54.265625,"x_max":228.5625,"ha":284,"o":"m 54 816 l 162 1058 l 228 1058 l 187 812 l 187 691 l 54 691 l 54 816 "},"O":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 "},"Ỏ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 184 105 293 -14 q 76 405 76 224 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 757 882 644 1002 q 869 581 869 762 l 869 405 m 735 582 q 662 805 735 718 q 465 892 589 892 q 279 805 349 892 q 210 582 210 718 l 210 405 q 279 182 210 268 q 465 95 349 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 428 1086 l 427 1190 q 501 1204 479 1193 q 523 1239 523 1214 q 493 1279 523 1266 q 414 1292 464 1292 l 419 1365 q 572 1330 519 1365 q 626 1237 626 1295 q 597 1165 626 1189 q 524 1134 568 1140 l 523 1086 l 428 1086 "},"Đ":{"x_min":28.484375,"x_max":874.234375,"ha":935,"o":"m 142 0 l 142 449 l 28 449 l 28 555 l 142 555 l 142 988 l 445 988 q 756 868 639 988 q 874 561 874 749 l 874 426 q 756 118 874 236 q 445 0 639 0 l 142 0 m 463 449 l 276 449 l 276 104 l 445 104 q 661 194 582 104 q 740 426 740 284 l 740 562 q 661 792 740 702 q 445 882 582 882 l 276 882 l 276 555 l 463 555 l 463 449 "},"Ớ":{"x_min":73.25,"x_max":1041.078125,"ha":952,"o":"m 866 405 q 753 105 866 224 q 462 -14 641 -14 q 181 105 289 -14 q 73 405 73 224 l 73 581 q 181 881 73 761 q 462 1002 289 1002 q 613 974 543 1002 q 737 898 683 947 q 864 963 820 905 q 907 1121 907 1021 l 1041 1121 q 981 908 1041 990 q 811 801 921 826 q 851 697 837 753 q 866 581 866 640 l 866 405 m 732 582 q 659 805 732 718 q 462 892 585 892 q 276 805 345 892 q 206 582 206 718 l 206 405 q 276 182 206 268 q 462 95 345 95 q 659 181 586 95 q 732 405 732 268 l 732 582 m 540 1223 l 696 1223 l 697 1219 l 514 1043 l 414 1043 l 540 1223 "},"3":{"x_min":67.703125,"x_max":691.109375,"ha":782,"o":"m 263 555 l 379 555 q 505 599 468 555 q 542 723 542 644 q 500 852 542 808 q 376 896 458 896 q 251 851 298 896 q 204 729 204 805 l 75 729 l 74 733 q 155 923 71 845 q 376 1002 240 1002 q 594 929 513 1002 q 676 721 676 856 q 639 599 676 660 q 528 506 602 538 q 654 415 617 477 q 691 275 691 352 q 602 63 691 140 q 376 -14 514 -14 q 152 58 241 -14 q 67 256 64 131 l 69 260 l 197 260 q 245 136 197 182 q 376 90 293 90 q 509 136 461 90 q 557 272 557 182 q 514 407 557 363 q 379 450 472 450 l 263 450 l 263 555 "},"9":{"x_min":56.296875,"x_max":695.171875,"ha":782,"o":"m 346 90 q 502 164 444 90 q 561 383 561 238 l 561 428 q 478 355 528 380 q 367 331 428 331 q 140 419 224 331 q 56 663 56 508 q 145 907 56 812 q 362 1002 234 1002 q 605 905 516 1002 q 695 620 695 808 l 695 385 q 598 89 695 192 q 346 -14 501 -14 q 240 -4 294 -14 q 143 26 186 5 l 164 128 q 247 98 204 107 q 346 90 290 90 m 367 435 q 490 467 441 435 q 561 548 539 499 l 561 634 q 511 830 561 763 q 366 896 461 896 q 241 831 293 896 q 189 663 189 765 q 237 498 189 561 q 367 435 285 435 "},"Ǿ":{"x_min":76.640625,"x_max":869.484375,"ha":947,"o":"m 869 405 q 757 105 869 224 q 465 -14 644 -14 q 357 0 408 -14 q 262 40 305 13 l 200 -63 l 99 -63 l 193 95 q 106 232 137 152 q 76 405 76 312 l 76 581 q 184 881 76 761 q 465 1002 293 1002 q 587 984 529 1002 q 693 936 644 967 l 748 1029 l 849 1029 l 759 879 q 840 745 811 822 q 869 581 869 668 l 869 405 m 210 405 q 223 298 210 348 q 259 213 236 249 l 263 213 l 632 834 q 556 877 598 862 q 465 892 514 892 q 279 805 349 892 q 210 582 210 718 l 210 405 m 735 582 q 724 679 735 633 q 693 758 713 724 l 689 759 l 322 141 q 387 106 352 118 q 465 95 423 95 q 662 181 590 95 q 735 405 735 268 l 735 582 m 538 1277 l 694 1277 l 695 1273 l 512 1097 l 412 1097 l 538 1277 "},"⅛":{"x_min":72.4375,"x_max":1097.625,"ha":1171,"o":"m 276 438 l 158 438 l 158 882 l 72 882 l 72 973 l 276 989 l 276 438 m 291 75 l 218 120 l 700 892 l 774 846 l 291 75 m 1081 401 q 1056 330 1081 361 q 989 281 1031 300 q 1068 229 1039 262 q 1097 153 1097 195 q 1034 35 1097 77 q 877 -7 972 -7 q 713 35 778 -7 q 647 153 647 77 q 678 229 647 195 q 759 282 708 263 q 690 331 715 300 q 664 401 664 361 q 724 512 664 473 q 876 551 784 551 q 1023 512 964 551 q 1081 401 1081 473 m 982 157 q 951 215 982 192 q 876 237 919 237 q 796 215 829 237 q 763 157 763 193 q 796 101 763 122 q 877 81 828 81 q 951 101 921 81 q 982 157 982 122 m 964 395 q 939 444 964 426 q 876 462 913 462 q 808 444 835 462 q 781 395 781 426 q 809 345 781 364 q 877 326 836 326 q 938 345 913 326 q 964 395 964 364 "},"l":{"x_min":107.84375,"x_max":241.453125,"ha":350,"o":"m 241 0 l 107 0 l 107 1058 l 241 1058 l 241 0 "},"Ẫ":{"x_min":13.5625,"x_max":885.765625,"ha":899,"o":"m 657 254 l 243 254 l 149 0 l 13 0 l 395 988 l 510 988 l 885 0 l 749 0 l 657 254 m 284 365 l 617 365 l 454 816 l 450 816 l 284 365 m 699 1063 l 697 1059 l 582 1059 l 449 1178 l 316 1059 l 201 1059 l 200 1063 l 396 1237 l 503 1237 l 699 1063 m 626 1406 q 593 1323 626 1360 q 515 1287 560 1287 q 441 1311 480 1287 q 377 1335 403 1335 q 339 1315 356 1335 q 322 1272 322 1295 l 267 1285 q 300 1369 267 1332 q 377 1407 332 1407 q 447 1384 406 1407 q 515 1360 489 1360 q 554 1379 536 1360 q 572 1422 572 1398 l 626 1406 "},"4":{"x_min":37.296875,"x_max":750.109375,"ha":782,"o":"m 613 332 l 750 332 l 750 227 l 613 227 l 613 0 l 480 0 l 480 227 l 37 227 l 37 302 l 472 988 l 613 988 l 613 332 m 179 332 l 480 332 l 480 796 l 476 796 l 463 762 l 179 332 "},"Ẁ":{"x_min":36.625,"x_max":1182.140625,"ha":1227,"o":"m 320 341 l 338 218 l 342 217 l 368 341 l 550 988 l 668 988 l 850 341 l 877 215 l 881 215 l 901 341 l 1048 988 l 1182 988 l 944 0 l 824 0 l 630 685 l 612 774 l 608 774 l 591 685 l 393 0 l 274 0 l 36 988 l 169 988 l 320 341 m 665 1057 l 558 1057 l 388 1233 l 390 1238 l 546 1238 l 665 1057 "}," ":{"x_min":0,"x_max":0,"ha":142},"Ť":{"x_min":23.0625,"x_max":790.8125,"ha":814,"o":"m 790 882 l 473 882 l 473 0 l 339 0 l 339 882 l 23 882 l 23 988 l 790 988 l 790 882 m 408 1164 l 507 1264 l 623 1264 l 623 1252 l 448 1086 l 368 1086 l 195 1250 l 195 1264 l 308 1264 l 408 1164 "},"Ś":{"x_min":69.078125,"x_max":793.515625,"ha":866,"o":"m 659 249 q 609 362 659 316 q 428 439 558 408 q 184 549 271 477 q 96 732 96 622 q 190 924 96 847 q 436 1002 285 1002 q 694 913 598 1002 q 786 706 790 824 l 785 702 l 657 702 q 600 843 657 789 q 436 896 543 896 q 283 851 336 896 q 229 734 229 806 q 287 626 229 669 q 474 550 345 583 q 712 437 630 512 q 793 250 793 361 q 695 58 793 131 q 440 -14 598 -14 q 179 66 293 -14 q 69 280 65 146 l 70 284 l 198 284 q 267 139 198 189 q 440 90 337 90 q 600 133 541 90 q 659 249 659 175 m 480 1249 l 636 1249 l 637 1244 l 454 1068 l 354 1068 l 480 1249 "},"Ü":{"x_min":99.703125,"x_max":843.703125,"ha":940,"o":"m 843 988 l 843 318 q 738 71 843 156 q 465 -14 634 -14 q 201 71 302 -14 q 99 318 99 157 l 99 988 l 233 988 l 233 318 q 297 148 233 206 q 465 90 360 90 q 642 148 575 90 q 710 318 710 206 l 710 988 l 843 988 m 706 1089 l 558 1089 l 558 1224 l 706 1224 l 706 1089 m 387 1089 l 239 1089 l 239 1224 l 387 1224 l 387 1089 "},"à":{"x_min":71.890625,"x_max":685.6875,"ha":764,"o":"m 548 0 q 537 58 541 33 q 533 109 533 84 q 435 21 495 56 q 306 -14 375 -14 q 131 44 191 -14 q 71 206 71 103 q 157 370 71 311 q 387 430 242 430 l 533 430 l 533 502 q 493 604 533 566 q 382 641 454 641 q 277 609 318 641 q 237 530 237 576 l 109 530 l 108 534 q 184 680 104 614 q 389 747 263 747 q 590 683 514 747 q 666 500 666 620 l 666 147 q 670 71 666 108 q 685 0 674 35 l 548 0 m 326 97 q 457 135 398 97 q 533 220 515 172 l 533 339 l 383 339 q 253 299 302 339 q 205 203 205 258 q 236 126 205 154 q 326 97 266 97 m 432 839 l 325 839 l 155 1015 l 157 1019 l 313 1019 l 432 839 "},"ơ":{"x_min":65.78125,"x_max":851.84375,"ha":797,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 520 723 462 747 q 621 656 577 699 q 703 713 676 669 q 731 829 731 758 l 851 829 q 806 668 851 732 q 674 583 761 604 q 710 485 697 538 q 722 373 722 431 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 "},"ó":{"x_min":65.78125,"x_max":722.984375,"ha":789,"o":"m 65 373 q 153 641 65 536 q 393 747 242 747 q 634 641 545 747 q 722 373 722 536 l 722 358 q 634 90 722 194 q 394 -14 546 -14 q 154 90 242 -14 q 65 358 65 195 l 65 373 m 199 358 q 248 166 199 242 q 394 90 297 90 q 539 166 490 90 q 589 358 589 242 l 589 373 q 539 565 589 488 q 393 641 489 641 q 248 565 297 641 q 199 373 199 488 l 199 358 m 459 1017 l 615 1017 l 616 1013 l 433 837 l 333 837 l 459 1017 "},"ŗ":{"x_min":72.5,"x_max":462.546875,"ha":476,"o":"m 444 615 l 375 619 q 286 594 322 619 q 230 523 250 569 l 230 0 l 96 0 l 96 734 l 216 734 l 229 626 q 306 715 260 683 q 411 747 352 747 q 440 744 426 747 q 462 739 453 742 l 444 615 m 221 -160 l 138 -321 l 72 -321 l 113 -154 l 113 -66 l 221 -66 l 221 -160 "},"\r":{"x_min":0,"x_max":0,"ha":345}},"cssFontWeight":"normal","ascender":1456,"underlinePosition":-150,"cssFontStyle":"normal","boundingBox":{"yMin":-336,"xMin":-149.46875,"yMax":1469.4375,"xMax":1281.15625},"resolution":1000,"original_font_information":{"postscript_name":"Roboto-Regular","version_string":"Version 1.100141; 2013","vendor_url":"Google.com","full_font_name":"Roboto Regular","font_family_name":"Roboto","copyright":"Font data copyright Google 2012","description":"","trademark":"Roboto is a trademark of Google.","designer":"Google","designer_url":"Christian Robertson","unique_font_identifier":"Google:Roboto Regular:2013","license_url":"http://www.apache.org/licenses/LICENSE-2.0","license_description":"Licensed under the Apache License, Version 2.0","manufacturer_name":"","font_sub_family_name":"Regular"},"descender":-377,"familyName":"Roboto","lineHeight":1832,"underlineThickness":100});
if (_typeface_js && _typeface_js.loadFace) _typeface_js.loadFace({"glyphs":{"\u0000":{"x_min":0,"x_max":0,"ha":0},"a":{"x_min":0,"x_max":826.078125,"ha":826,"o":"m 664 1083 q 661 1043 661 1051 q 642 941 659 1037 q 622 868 632 896 q 664 762 614 842 q 716 664 718 680 q 713 647 716 659 q 718 622 716 640 q 712 569 721 607 q 705 607 705 581 q 694 671 704 636 q 683 701 691 675 q 629 789 678 729 q 614 736 618 822 q 607 634 610 651 q 606 602 607 623 q 583 501 606 577 q 653 518 629 500 q 679 537 675 534 q 708 533 699 537 q 754 575 716 529 q 785 577 777 603 q 793 550 786 569 q 822 522 813 533 q 826 500 826 516 q 822 457 826 484 q 793 379 811 392 q 773 379 773 366 q 724 322 746 351 q 656 272 702 294 q 550 203 557 223 q 549 180 542 183 q 564 138 573 164 q 569 65 550 111 q 557 62 575 52 q 541 73 550 66 q 507 56 508 66 q 492 50 507 50 q 450 54 476 50 q 415 69 434 56 q 415 131 394 78 q 439 146 443 135 q 455 199 434 158 q 411 196 417 199 q 355 204 404 195 q 328 207 339 208 q 230 245 314 207 q 187 261 214 252 q 109 333 158 272 q 32 459 37 423 q 27 497 28 497 q 24 518 13 510 q 36 585 35 524 q 44 640 37 602 q 51 687 52 679 q 29 687 40 691 q 0 756 18 685 q 21 778 13 774 q 20 809 28 782 q 101 847 86 851 q 119 834 113 842 q 168 880 162 874 q 227 911 174 887 q 339 941 265 927 q 512 916 415 953 q 480 921 523 903 q 368 933 436 941 q 282 915 295 925 q 276 907 271 903 q 255 891 290 911 q 191 854 215 872 q 149 823 176 843 q 126 782 122 805 q 211 855 157 819 q 314 904 264 891 q 378 915 328 907 q 499 903 431 925 q 569 876 561 883 q 577 872 572 874 q 581 872 580 880 q 599 850 583 864 q 622 968 607 948 q 642 1018 638 990 q 655 1062 647 1033 q 664 1090 663 1090 q 664 1083 664 1087 m 279 859 q 215 823 225 838 q 184 789 206 811 q 143 736 143 750 q 143 733 143 736 q 146 721 143 729 q 187 664 183 675 q 207 642 191 655 q 211 634 211 638 q 288 558 211 628 q 311 541 305 545 q 358 489 320 534 q 360 463 355 489 q 409 404 363 439 q 463 349 461 363 q 488 306 466 337 q 492 339 488 330 q 504 400 496 345 q 507 423 507 411 q 507 508 507 451 q 512 550 504 533 q 504 575 518 567 q 545 638 548 602 q 539 704 542 675 q 549 790 533 741 q 565 842 556 807 q 425 892 485 888 q 415 892 420 892 q 279 859 358 892 m 116 647 q 109 573 109 607 q 122 481 109 522 q 173 370 142 411 q 238 310 198 337 q 288 278 279 282 q 393 245 355 245 q 404 248 398 245 q 435 256 427 252 q 442 261 442 257 q 374 343 390 330 q 358 362 360 358 q 298 419 309 406 q 244 497 288 431 q 211 545 222 533 q 154 611 200 554 q 122 642 127 644 q 116 647 116 640 m 621 484 q 561 408 575 480 q 549 329 549 345 q 550 318 549 318 q 557 321 553 318 q 610 355 610 343 q 632 412 607 358 q 630 447 642 435 q 606 461 615 448 q 637 463 621 451 q 663 469 653 465 q 621 484 638 484 m 393 387 q 431 326 402 371 q 434 325 431 326 q 467 269 463 274 q 477 268 474 268 q 444 318 447 318 q 423 354 444 321 q 396 387 398 387 q 393 387 394 387 "}," ":{"x_min":0,"x_max":0,"ha":374},"\r":{"x_min":0,"x_max":0,"ha":0}},"cssFontWeight":"normal","ascender":931,"underlinePosition":-2,"cssFontStyle":"normal","boundingBox":{"yMin":50.1875,"xMin":0,"yMax":1090.578125,"xMax":826.078125},"resolution":1000,"original_font_information":{"postscript_name":"VisualGraphics","version_string":"1","vendor_url":"","full_font_name":"Visual Graphics","font_family_name":"VisualGraphics","copyright":"VG","description":"Version 1.0","trademark":"","designer":"","designer_url":"","unique_font_identifier":"FontForge 2.0 : Visual Graphics : 18-11-2014","license_url":"","license_description":"","manufacturer_name":"","font_sub_family_name":"Regular"},"descender":0,"familyName":"Visual Graphics","lineHeight":930,"underlineThickness":1});
/*
 * Copyright 2010, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */


/**
 * @fileoverview This file contains functions every webgl program will need
 * a version of one way or another.
 *
 * Instead of setting up a context manually it is recommended to
 * use. This will check for success or failure. On failure it
 * will attempt to present an approriate message to the user.
 *
 *       gl = WebGLUtils.setupWebGL(canvas);
 *
 * For animated WebGL apps use of setTimeout or setInterval are
 * discouraged. It is recommended you structure your rendering
 * loop like this.
 *
 *       function render() {
 *         window.requestAnimationFrame(render, canvas);
 *
 *         // do rendering
 *         ...
 *       }
 *       render();
 *
 * This will call your rendering function up to the refresh rate
 * of your display but will stop rendering if your app is not
 * visible.
 */

WebGLUtils = function() {

/**
 * Creates the HTLM for a failure message
 * @param {string} canvasContainerId id of container of th
 *        canvas.
 * @return {string} The html.
 */
var makeFailHTML = function(msg) {
  return '' +
        '<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">' + msg + '</div>';
};

/**
 * Mesasge for getting a webgl browser
 * @type {string}
 */
var GET_A_WEBGL_BROWSER = '' +
  'This page requires a browser that supports WebGL.<br/>' +
  '<a href="http://get.webgl.org">Click here to upgrade your browser.</a>';

/**
 * Mesasge for need better hardware
 * @type {string}
 */
var OTHER_PROBLEM = '' +
  "It doesn't appear your computer can support WebGL.<br/>" +
  '<a href="http://get.webgl.org">Click here for more information.</a>';

/**
 * Creates a webgl context. If creation fails it will
 * change the contents of the container of the <canvas>
 * tag to an error message with the correct links for WebGL.
 * @param {Element} canvas. The canvas element to create a
 *     context from.
 * @param {WebGLContextCreationAttirbutes} opt_attribs Any
 *     creation attributes you want to pass in.
 * @param {function:(msg)} opt_onError An function to call
 *     if there is an error during creation.
 * @return {WebGLRenderingContext} The created context.
 */
var setupWebGL = function(canvas, opt_attribs, opt_onError) {
  function handleCreationError(msg) {
      var container = document.getElementsByTagName("body")[0];
    //var container = canvas.parentNode;
    if (container) {
      var str = window.WebGLRenderingContext ?
           OTHER_PROBLEM :
           GET_A_WEBGL_BROWSER;
      if (msg) {
        str += "<br/><br/>Status: " + msg;
      }
      container.innerHTML = makeFailHTML(str);
    }
  }

  opt_onError = opt_onError || handleCreationError;

  if (canvas.addEventListener) {
    canvas.addEventListener("webglcontextcreationerror", function(event) {
          opt_onError(event.statusMessage);
        }, false);
  }
  var context = create3DContext(canvas, {antialias:true, alpha: true, preserveDrawingBuffer: true}  );//premultipliedAlpha: false
  if (!context) {
    if (!window.WebGLRenderingContext) {
      opt_onError("");
    } else {
      opt_onError("");
    }
  }

  return context;
};

/**
 * Creates a webgl context.
 * @param {!Canvas} canvas The canvas tag to get context
 *     from. If one is not passed in one will be created.
 * @return {!WebGLContext} The created context.
 */
var create3DContext = function(canvas, opt_attribs) {
  var names = ["webgl2","webgl", "experimental-webgl", "webkit-3d", "moz-webgl"];
  var context = null;
  for (var ii = 0; ii < names.length; ++ii) {
    try {
      context = canvas.getContext(names[ii], opt_attribs);
    } catch(e) {}
    if (context) {
      break;
    }
  }
  VG.webgl2 = names[ii] === "webgl2";
  return context;
};

return {
  create3DContext: create3DContext,
  setupWebGL: setupWebGL
};
}();

/**
 * Provides requestAnimationFrame in a cross browser
 * way.
 */
if (!window.requestAnimationFrame) {
  window.requestAnimationFrame = (function() {
    return window.requestAnimationFrame ||
           window.webkitRequestAnimationFrame ||
           window.mozRequestAnimationFrame ||
           window.oRequestAnimationFrame ||
           window.msRequestAnimationFrame ||
           function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {
             window.setTimeout(callback, 1000/60);
           };
  })();
}

/** * ERRATA: 'cancelRequestAnimationFrame' renamed to 'cancelAnimationFrame' to reflect an update to the W3C Animation-Timing Spec.
 *
 * Cancels an animation frame request.
 * Checks for cross-browser support, falls back to clearTimeout.
 * @param {number}  Animation frame request. */
if (!window.cancelAnimationFrame) {
  window.cancelAnimationFrame = (window.cancelRequestAnimationFrame ||
                                 window.webkitCancelAnimationFrame || window.webkitCancelRequestAnimationFrame ||
                                 window.mozCancelAnimationFrame || window.mozCancelRequestAnimationFrame ||
                                 window.msCancelAnimationFrame || window.msCancelRequestAnimationFrame ||
                                 window.oCancelAnimationFrame || window.oCancelRequestAnimationFrame ||
                                 window.clearTimeout);
}

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

if ( !VG )

/** @namespace */
 VG = {};

/**
 * Enum for Host Visual Graphics is running on
 * @readonly
 * @enum {number}
 */

VG.HostProperty={
	"Platform" : 0,
	"PlatformWeb" : 1,
	"PlatformDesktop" : 2,
	"PlatformTablet" : 3,
	"PlatformMobile" : 4,

	"OperatingSystem" : 5,
	"OSWindows" : 6,
	"OSMac" : 7,
	"OSUnix" : 8,
	"OSLinux" : 9,

	"DrawMenus" : 12,

	"ProjectChangedState" : 20
};

VG.AnimationTick=1000.0 / 60.0;

/**
 * The context applications are running in. vgMain() of the application is running in this context.
 * @namespace
 */

VG.context={};

/** Forces a redraw of the UI during the next tick. */

VG.update=function()
{
    if ( VG.context && VG.context.workspace ) VG.context.workspace.needsRedraw=true;
    if ( VG.hostUpdate ) VG.hostUpdate();
};

/** Prints the arguments to the console of the current host. */

VG.log=function()
{
	var string="";

	for( var i=0; i < arguments.length; ++i ) string+=String( arguments[i] ) + " ";

	if ( typeof console == "object" ) console.log( string );
	else if ( VG.print ) VG.print( string );

	if ( VG.globalVIDEInstance ) VG.globalVIDEInstance.addToRuntimeLog( string );
};

/** Prints the error arguments to the console of the current host. */

VG.error=function()
{
	var string="Error: ";

	for( var i=0; i < arguments.length; ++i ) string+=String( arguments[i] ) + " ";

	if ( typeof console == "object" ) console.log( string );
	else if ( VG.print ) VG.print( string );

	if ( VG.globalVIDEInstance ) VG.globalVIDEInstance.addToRuntimeLog( string );
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains the core classes used by Visual Graphics. These classes are meant to be used in the UI aspect of Visual Graphics. For realtime graphics
 * please use the classes contained in {@link VG.Math}.
 * @namespace
 */

VG.Core = {};

// --- Global function to be able to chain constructors using apply

Function.prototype.creator=function( aArgs )
{
    var fConstructor = this, fNewConstr = function() { fConstructor.apply(this, aArgs); };
    fNewConstr.prototype = fConstructor.prototype;
    return new fNewConstr();
};

// --------------------------------------------- VG.Core.Point

/**
* Creates a new VG.Core.Point class.
* @constructor
* @param {Number | VG.Core.Point} value - Either the x value or a VG.Core.Point class
* @param {Number} y - The Y Value
*/

VG.Core.Point=function()
{
    if ( !(this instanceof VG.Core.Point ) ) return VG.Core.Point.creator( arguments );

    /** The x coordinate, default is 0
     *  @member {Number} */
    this.x=0;

    /** The y coordinate, default is 0
     *  @member {Number} */
    this.y=0;

    if ( arguments.length === 2 ) {
        this.x=arguments[0]; this.y=arguments[1];
    } else
    if ( arguments.length === 1 ) {
        this.x=arguments[0].x; this.y=arguments[0].y;
    }
};

/**
 * Sets the Point values directly.
 * @param {Number | VG.Core.Point} value - Either the x value of the Point or a Point class
 * @param {Number} y - Y Value
 */

VG.Core.Point.prototype.set=function()
{
    if ( arguments.length == 2 ) {
        this.x=arguments[0]; this.y=arguments[1];
    } else if ( arguments.length == 1 ) {
        this.x=arguments[0].x; this.y=arguments[0].y;
    }
};

/**
 * Copy the Point values from the given {@link VG.Core.Point} class.
 * @param {VG.Core.Point} value - A Point class
 */

VG.Core.Point.prototype.copy=function()
{
    this.x=arguments[0].x; this.y=arguments[0].y;
};

/**
 * Returns true if the given {@link VG.Core.Point} is equal.
 * @param {VG.Core.Point} point - The point to compare
 * @returns {bool}
 */

VG.Core.Point.prototype.equals=function( arg )
{
    if ( this.x === arg.x && this.y === arg.y )
        return true; else return false;
};

/**
 * Returns a string version of this class.
 * @returns {String}
 */

VG.Core.Point.prototype.toString=function()
{
    return "VG.Core.Point( " + this.x + ", " + this.y + " );";
};


/**
 * Creates a new VG.Core.Size class.
 * @constructor
 * @param {Number | VG.Core.Size} value - Either the width value or a VG.Core.Size class
 * @param {Number} height - The height value
 */

VG.Core.Size=function()
{
    if ( !(this instanceof VG.Core.Size ) ) return VG.Core.Size.creator( arguments );

    /** The width, default is 0.
     *  @member {Number} */
    this.width=0;

    /** The height, default is 0.
     *  @member {Number} */
    this.height=0;

    if ( arguments.length === 2 ) {
        this.width=arguments[0]; this.height=arguments[1];
    } else
    if ( arguments.length === 1 ) {
        this.width=arguments[0].width; this.height=arguments[0].height;
    }
};

/**
 * Creates a new VG.Core.Size class with the values of this class and adds the given values to it. Returns the new class. Optionally an
 * @param {Number | VG.Core.Point} value - Either the width value or a VG.Core.Size class
 * @param {Number} height - Height value
 * @param {VG.Core.Size} resultSize - Optional, use this size instead of allocating a new one
 * @returns {VG.Core.Size}
 */

VG.Core.Size.prototype.add=function( width, height, resultSize )
{
    var size;
    if ( !resultSize ) size=new VG.Core.Size( this ); else { if ( resultSize !== this ) resultSize.copy( this ); size=resultSize; }

    if ( arguments.length >= 2 )
        size.set( this.width+width, this.height+height );
    if ( arguments.length === 1 )
        size.set( this.width+arguments[0].width, this.height+arguments[0].height );

    return size;
};

/**
 * Sets the Size values directly.
 * @param {Number | VG.Core.Point} value - Either the width value or a VG.Core.Size class
 * @param {Number} height - Height value
 */

VG.Core.Size.prototype.set=function( width, height )
{
    if ( arguments.length == 2 ) {
        this.width=width; this.height=height;
    } else
    if ( arguments.length == 1 ) {
        this.width=arguments[0].width; this.height=arguments[0].height;
    }
};

/**
 * Copies the values from an {@link VG.Core.Size} object.
 * @param {Number | VG.Core.Point} size - A VG.Core.Size class
 */

VG.Core.Size.prototype.copy=function()
{
    this.width=arguments[0].width; this.height=arguments[0].height;
};

/**
 * Returns true if the given VG.Core.Size is equal.
 * @param {VG.Core.Size} size - The VG.Core.Size to compare
 *  @returns {bool}
 */

VG.Core.Size.prototype.equals=function( arg )
{
    if ( this.width === arg.width && this.height === arg.height )
        return true; else return false;
};

/** Returns a string version of this class.
 *  @returns {String}
 */

VG.Core.Size.prototype.toString=function()
{
    return "VG.Core.Size( " + this.width + ", " + this.height + " );";
};


/**
 * Creates a new VG.Core.Rect class containing the x, y coordinates and width, height values of the rectangle.
 *
 *  @constructor
 *  @param {Number | VG.Core.Rect} value - Either the x coordinate or a VG.Core.Rect class
 *  @param {Number} y - The y coordinate
 *  @param {Number} width - The width value
 *  @param {Number} height - The height value
 */

VG.Core.Rect=function()
{
    if ( !(this instanceof VG.Core.Rect ) ) return VG.Core.Rect.creator( arguments );

    /** The x coordinate of the rectangle, default is 0.
     *  @member {Number} */
    this.x=0;

    /** The y coordinate of the rectangle, default is 0.
     *  @member {Number} */
    this.y=0;

    /** The width of the rectangle, default is 0.
     *  @member {Number} */
    this.width=0;

    /** The height of the rectangle, default is 0.
     *  @member {Number} */
    this.height=0;

    if ( arguments.length === 4 ) {
        this.x=arguments[0]; this.y=arguments[1];
        this.width=arguments[2]; this.height=arguments[3];
    } else if ( arguments.length == 1 ) {
        // --- Copy constructor
        this.x=arguments[0].x; this.y=arguments[0].y;
        this.width=arguments[0].width; this.height=arguments[0].height;
    }
};

/**
 * Creates a new VG.Core.Rect class with the values of this class and adds the given rectangle values to it. Returns the new class.
 * @param {number | VG.Core.Rect} value - Either the width value or a VG.Core.Rect class
 * @param {number} y - Y Coordinate
 * @param {number} width - Width value
 * @param {number} height - Height value
 * @param {VG.Core.Rect} resultRect - Optional, use this rect instead of allocating a new one
 * @returns {VG.Core.Rect}
 */

VG.Core.Rect.prototype.add=function( x, y, width, height, resultRect )
{
    var rect;
    if ( !resultRect ) rect=new VG.Core.Rect( this ); else { if ( resultRect !== this ) resultRect.copy( this ); rect=resultRect; }

    if ( arguments.length >= 4 ) {
        rect.x+=x; rect.y+=y;
        rect.width+=width; rect.height+=height;
    } else
    if ( arguments.length === 1 ) {
        rect.x+=arguments[0].x; rect.y+=arguments[0].y;
        rect.width+=arguments[0].width; rect.height+=arguments[0].height;
    }

    return rect;
};

/** Sets all values to 0. */

VG.Core.Rect.prototype.clear=function()
{
    this.x=0; this.y=0;
    this.width=0; this.height=0;
};

/**
 * Creates a new VG.Core.Rect class with the values of this class and subtracts the given width and height values from it. Adjusts the x, y coordinates
 * so that the new rectangle is centered on this rectangle. Returns the new class.
 *
 *  @param {Number} width - Width value to subtract.
 *  @param {Number} height - Height walue to subtract.
 *  @param {VG.Core.Rect} resultRect - Optional, use this rect instead of allocating a new one
 *  @returns {VG.Core.Rect}
 */

VG.Core.Rect.prototype.shrink=function( width, height, resultRect )
{
    var rect;
    if ( !resultRect ) rect=new VG.Core.Rect( this ); else { if ( resultRect !== this ) resultRect.copy( this ); rect=resultRect; }

    rect.x+=width; rect.y+=height;
    rect.width-=2*width; rect.height-=2*height;

    return rect;
};

/**
 * Sets the position values.
 * @param {Number | VG.Core.Point} value - Either the new x coordinate value or a VG.Core.Point class
 * @param {Number} y - New y Coordinate
 */

VG.Core.Rect.prototype.setPos=function( x, y )
{
    if ( arguments.length === 2 ) {
        this.x=x; this.y=y;
    } else {
        this.x=arguments[0].x;
        this.y=arguments[0].y;
    }
};

/**
 * Returns the position of this rectangle as a {@link VG.Core.Point} class.
 * @returns {VG.Core.Point}
 */

VG.Core.Rect.prototype.pos=function()
{
    return VG.Core.Point( this.x, this.y );
};

/**
 * Sets the size values.
 * @param {Number | VG.Core.Point} value - Either the new width value or a VG.Core.Size class
 * @param {Number} y - New height value
 */

VG.Core.Rect.prototype.setSize=function( width, height )
{
    if ( arguments.length === 2 ) {
        this.width=width; this.height=height;
    } else {
        this.width=arguments[0].width;
        this.height=arguments[0].height;
    }
};

/**
 * Returns the size of this rectangle as a {@link VG.Core.Size} class.
 * @returns {VG.Core.Size}
 */

VG.Core.Rect.prototype.size=function()
{
    return VG.Core.Size( this.width, this.height );
};

/**
 * Sets the values of the rectangle directly.
 * @param {Number | VG.Core.Rect} value - Either the x coordinate or a VG.Core.Rect class
 * @param {Number} y - The y coordinate
 * @param {Number} width - The width value
 * @param {Number} height - The height value
 */

VG.Core.Rect.prototype.set=function( rect )
{
    if ( arguments.length === 4 ) {
        this.x=arguments[0]; this.y=arguments[1];
        this.width=arguments[2]; this.height=arguments[3];
    } else {
        this.x=rect.x; this.y=rect.y;
        this.width=rect.width; this.height=rect.height;
    }
};

/**
 * Copies the values of the given rectangle.
 * @param {VG.Core.Rect} rect - The VG.Core.Rect object to copy
 */

VG.Core.Rect.prototype.copy=function( rect )
{
    this.x=rect.x; this.y=rect.y;
    this.width=rect.width; this.height=rect.height;
};

/**
 * Returns the upper left position as a {@link VG.Core.Point} class.
 * @returns {VG.Core.Point}
 */

VG.Core.Rect.prototype.upperLeft=function()
{
    return new VG.Core.Point( this.x, this.y );
};

/**
 * Returns the upper right position as a {@link VG.Core.Point} class.
 * @returns {VG.Core.Point}
 */

VG.Core.Rect.prototype.upperRight=function()
{
    return new VG.Core.Point( this.x+this.width, this.y );
};

/**
 * Returns the lower left coordinate as a {@link VG.Core.Point} class.
 * @returns {VG.Core.Point}
 */

VG.Core.Rect.prototype.lowerLeft=function()
{
    return new VG.Core.Point( this.x, this.y + this.height-1 );
};

/**
 * Returns the lower right coordinate of this rectangle as a {@link VG.Core.Point} class.
 * @returns {VG.Core.Point}
 */

VG.Core.Rect.prototype.lowerRight=function()
{
    return new VG.Core.Point( this.x + this.width, this.y + this.height-1 );
};

/**
 * Returns the right x coordinate.
 * @returns {Number}
 */

VG.Core.Rect.prototype.right=function()
{
    return this.x+this.width;
};

/**
 * Returns the bottom y coordinate.
 * @returns {Number}
 */

VG.Core.Rect.prototype.bottom=function()
{
    return this.y+this.height;
};

/** Rounds all values, afterwards all values of the rectangle are integers. */

VG.Core.Rect.prototype.round=function()
{
    this.x=Math.round( this.x );
    this.y=Math.round( this.y );
    this.width=Math.round( this.width );
    this.height=Math.round( this.height );

    return this;
};

/**
 * Returns true if the two rectangles are equal, i.e. all values are a perfect match
 * @param {VG.Core.Rect} rect - A VG.Core.Rect class to compare.
 * @returns {bool}
 */

VG.Core.Rect.prototype.equals=function( arg )
{
    if ( this.x === arg.x && this.y === arg.y && this.width === arg.width && this.height === arg.height )
        return true; else return false;
};

/**
 * Returns true if the VG.Core.Point or VG.Core.Rect are completely contained in this rectangle.
 *
 * @param {VG.Core.Rect | VG.Core.Point | Number} value - A VG.Core.Rect or VG.Core.Point class or a Number representing the x value
 * @param {Number} y - The Y Value
 * @returns {bool}
 */

VG.Core.Rect.prototype.contains=function( arg )
{
    if ( arg instanceof VG.Core.Point ) {
        if ( (this.x <= arg.x) && (this.y <= arg.y) && (this.x + this.width >= arg.x) && (this.y + this.height >= arg.y) )
            return true; else return false;
    } else
    if ( arg instanceof VG.Core.Rect ) {
        if ( (this.x <= arg.x) && (this.y <= arg.y) && (this.right() >= arg.right() ) && (this.bottom() >= arg.bottom()) )
            return true; else return false;
    } else if ( arguments.length === 2 )
    {
        if ( (this.x <= arguments[0] ) && (this.y <= arguments[1] ) && (this.x + this.width >= arguments[0] ) && (this.y + this.height >= arguments[1] ) )
            return true; else return false;
    }

    return false;
};

/**
 * Returns a resultant rectangle of the intersection of this and rect if they intersect. If they don't, returns null.
 *
 * @param {VG.Core.Rect} rect - A VG.Core.Rect class
 * @returns {VG.Core.Rect}
 */

VG.Core.Rect.prototype.intersect=function( rect )
{
    if( rect instanceof VG.Core.Rect ) {

        var left = Math.max( this.x, rect.x );
        var top = Math.max( this.y, rect.y );

        var right = Math.min( this.x+this.width, rect.x+rect.width );
        var bottom = Math.min( this.y+this.height, rect.y+rect.height );

        var width = right - left;
        var height= bottom - top;

        if( width > 0 && height > 0 )
            return VG.Core.Rect(left, top, width, height);

        return null;
    }
};

/**
 * Returns the resultant rectangle of the union of this and rect. Applies to and returns resultRect if defined.
 *
 * @param {VG.Core.Rect} rect - A VG.Core.Rect class
 * @param {VG.Core.Rect} resultRect - Optional, use this rect instead of allocating a new one
 * @returns {VG.Core.Rect}
 */

VG.Core.Rect.prototype.union=function( rect, resultRect )
{
    if( rect instanceof VG.Core.Rect ) {

        var left = Math.min( this.x, rect.x );
        var top = Math.min( this.y, rect.y );

        var right = Math.max( this.x+this.width, rect.x+rect.width );
        var bottom = Math.max( this.y+this.height, rect.y+rect.height );

        var width = right - left;
        var height= bottom - top;

        if ( resultRect ) {
            resultRect.set( left, top, width, height );
            return resultRect;
        }
        else return VG.Core.Rect(left, top, width, height);
    }
};

/**
 * Returns a string version of this class.
 * @returns {String}
 */

VG.Core.Rect.prototype.toString=function()
{
    return "VG.Core.Rect( " + this.x + ", " + this.y + ", " + this.width + ", " + this.height + " );";
};

/**
 * Returns true if the rectangle is valid, i.e. both width and height are greater than 0, otherwise returns false.
 *  @returns {String}
 */

VG.Core.Rect.prototype.isValid=function()
{
    if ( this.width > 0 && this.height > 0 ) return true;
    else return false;
};


/**
 * Creates a new VG.Core.Margin class, used to specify the margins of Layouts.
 * @constructor
 * @param {Number | VG.Core.Margin} value - Either the left margin or a VG.Core.Margin class
 * @param {Number} top - Top margin
 * @param {Number} right - Right margin
 * @param {Number} bottom - Bottom margin
 */

VG.Core.Margin=function()
{
    if ( !(this instanceof VG.Core.Margin ) ) return VG.Core.Margin.creator( arguments );

    /** The left margin, default is 0.
     *  @member {Number} */
    this.left=0;

    /** The top margin, default is 0.
     *  @member {Number} */
    this.top=0;

    /** The right margin, default is 0.
     *  @member {Number} */
    this.right=0;

    /** The bottom margin, default is 0.
     *  @member {Number} */
    this.bottom=0;

    if ( arguments.length == 4 ) {
        // --- All 4 args passed
        this.left=arguments[0]; this.top=arguments[1];
        this.right=arguments[2]; this.bottom=arguments[3];
    } else if ( arguments.length === 1 ) {
        // --- Copy constructor
        this.left=arguments[0].left; this.top=arguments[0].top;
        this.right=arguments[0].right; this.bottom=arguments[0].bottom;
    }
};

/**
 * Sets the values of the margin.
 * @param {Number | VG.Core.Margin} value - Either the left margin or a VG.Core.Margin class
 * @param {Number} top - Top margin
 * @param {Number} right - Right margin
 * @param {Number} bottom - Bottom margin
 */

VG.Core.Margin.prototype.set=function( left, top, right, bottom )
{
    if ( arguments.length === 4 ) {
        this.left=left; this.top=top;
        this.right=right; this.bottom=bottom;
    } else
    if ( arguments.length === 1 ) {
        this.left=arguments[0].left; this.top=arguments[0].top;
        this.right=arguments[0].right; this.bottom=arguments[0].bottom;
    }
};

/** Sets all values of the Margin to 0.*/

VG.Core.Margin.prototype.clear=function()
{
    this.left=0; this.top=0;
    this.right=0; this.bottom=0;
};

/** Returns a string version of this class.
 *  @returns {String}
 */

VG.Core.Margin.prototype.toString=function()
{
    return "VG.Core.Margin( " + this.left + ", " + this.top + ", " + this.right + ", " + this.bottom + " );";
};


/**
 * Creates a new VG.Core.Color which specifies a specific RGB color, including alpha. Internally the color values are represented normalized between
 * 0 .. 1.<br>
 * There are several constructors available:<ul>
 * <li>The copy constructor takes a single VG.Core.Color value.</li>
 * <li>The HEX constructor takes a single string value of the form "#ffffff".</li>
 * <li>You can specify RGB values using either 3 arguments for red, green and blue or 4 values including alpha. All these values are between 0..255.</li>
 *</ul>
 * Internally all values are stored as normalized value between 0..1. If you want to pass normalized value to an constructor please use the
 * {@link VG.Core.NormalizedColor} constructor.
 * @constructor
 */

VG.Core.Color=function()
{
    if ( !(this instanceof VG.Core.Color ) ) return VG.Core.Color.creator( arguments );

    /** The red color value, normalized between 0..1, default is 0.
     *  @member {Number} */
    this.r=0.0;
    /** The green color value, normalized between 0..1, default is 0.
     *  @member {Number} */
    this.g=0.0;
    /** The blue color value, normalized between 0..1, default is 0.
     *  @member {Number} */
    this.b=0.0;
    /** The alpha value, normalized between 0..1, default is 1.
     *  @member {Number} */
    this.a=1.0;

    if ( arguments.length === 1 )
    {
        if ( arguments[0] instanceof VG.Core.Color ) {
            this.r=arguments[0].r; this.g=arguments[0].g; this.b=arguments[0].b;
            this.a=arguments[0].a;
        } else
        if ( typeof( arguments[0] ) === 'string' ) {
            this.setHex( arguments[0] );
            this.a=1.0;
        }
    } else
    if ( arguments.length === 3 ) {
        this.r=arguments[0]/255.0; this.g=arguments[1]/255.0; this.b=arguments[2]/255.0;
        this.a=1.0;
    } else
    if ( arguments.length === 4 ) {
        this.r=arguments[0]/255.0; this.g=arguments[1]/255.0; this.b=arguments[2]/255.0;
        this.a=arguments[3]/255.0;
    }
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Creates a new {@link VG.Core.Color} class which specifies a specific RGB color, including alpha. Internally the color values are represented normalized between
 * 0 .. 1.<br>
 * There are several constructors available:<ul>
 * <li>The copy constructor takes a single VG.Core.Color value.</li>
 * <li>You can specify RGB values using either 3 arguments for red, green and blue or 4 values including alpha. All these values are between 0..1.</li>
 *</ul>
 * @constructor
 */

VG.Core.NormalizedColor=function()
{
	let color = VG.Core.Color();
    if ( arguments.length === 1 )
    {
        if ( arguments[0] instanceof VG.Core.Color ) {
            color.r=arguments[0].r; color.g=arguments[0].g; color.b=arguments[0].b;
            color.a=arguments[0].a;
        }
    } else
    if ( arguments.length === 3 ) {
        color.r=arguments[0]; color.g=arguments[1]; color.b=arguments[2];
        color.a=1.0;
    } else
    if ( arguments.length === 4 ) {
        color.r=arguments[0]; color.g=arguments[1]; color.b=arguments[2];
        color.a=arguments[3];
    }
    color.canvasStyle = color.toCanvasStyle();
	return color;
};

/**
 * Copies the color values from the given color.
 * @param {VG.Core.Color} color - The color class to copy the values from.
 */

VG.Core.Color.prototype.copy=function(color)
{
    this.r = color.r;
    this.g = color.g;
    this.b = color.b;
    this.a = color.a;
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Sets the color values directly. All values have to be between 0..1.
 * @param {number} r - The red color value.
 * @param {number} g - The green color value.
 * @param {number} b - The blue color value.
 * @param {number} a - Optional, the alpha value.
 */

VG.Core.Color.prototype.set=function( r, g, b, a )
{
    this.r = r;
    this.g = g;
    this.b = b;
    if ( a !== undefined ) this.a = a;
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Multiplies the color values with the given value. The results are clamped between 0..1.
 * @param {Number} value - The value to multiply each color value with.
 */

VG.Core.Color.prototype.mul=function(d)
{
    this.r = VG.Math.clamp(this.r * d, 0.0, 1.0);
    this.g = VG.Math.clamp(this.g * d, 0.0, 1.0);
    this.b = VG.Math.clamp(this.b * d, 0.0, 1.0);
    this.a = VG.Math.clamp(this.a * d, 0.0, 1.0);
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Sets the color values to RGBA values between 0..255.
 * @param {number} r - The red color value.
 * @param {number} g - The green color value.
 * @param {number} b - The blue color value.
 * @param {number} a - Optional, the alpha value.
 */

VG.Core.Color.prototype.setRGBA=function( r, g, b, a )
{
    this.r=r/255.0; this.g=g/255.0; this.b=b/255.0;
    if ( a !== undefined ) this.a=a/255.0;
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Copies the color values from the given array.
 * @param {array} value - The array to copy the color values from.
 */

VG.Core.Color.prototype.setArray=function(value)
{
	if (0 < value.length)
		this.r = value[0];
	if (1 < value.length)
		this.g = value[1];
	if (2 < value.length)
		this.b = value[2];
	if (3 < value.length)
        this.a = value[3];
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Returns an object containing the converted HSL values for this color.
 * @returns {Object} Containing the converted h, s, l values.
 */

VG.Core.Color.prototype.toHSL=function()
{
    var max = Math.max(this.r, this.g, this.b);
    var min = Math.min(this.r, this.g, this.b);

    var v = (max + min) / 2;
    var h = v;
    var s = v;
    var l = v;

    if (max == min)
    {
        h = 0.0;
        s = 0.0;
    }
    else
    {
        var d = max - min;

        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

        if (max == this.r)
        {
            h = (this.g - this.b) / d + (this.g < this.b ? 6 : 0);
        }
        else
        if (max == this.g)
        {
            h = (this.b - this.r) / d + 2;
        }
        else
        if (max == this.b)
        {
            h = (this.r - this.g) / d + 4;
        }

        h /= 6;
    }


    return { h: h, s: s, l: l };
};

/**
 * Sets the internal color values to the given HSL values.
 * @param {Number} h - Hue value
 * @param {Number} s - Saturation value
 * @param {Number} l - Lightness value
 */

VG.Core.Color.prototype.setHSL=function(h, s, l)
{
    function hueAngle(hue, x, y)
    {
        if (hue < 0.0)
        {
            hue += 1;
        }
        else
        if (hue > 1.0)
        {
            hue -= 1;
        }

        if (hue < 1 / 6) return x + (y - x) * 6 * hue;
        if (hue < 1 / 2) return y;
        if (hue < 2 / 3) return x + (y - x) * ((2 / 3) - hue) * 6;

        return x;
    }

    if (s === 0.0)
    {
        this.r = l;
        this.g = l;
        this.b = l;
    }
    else
    {
        var y = l < 0.5 ? l * (1 + s) : l + s - l * s;
        var x = 2 * l - y;

        var hue = h / 360;

        this.r = hueAngle(hue + 1 / 3, x, y);
        this.g = hueAngle(hue        , x, y);
        this.b = hueAngle(hue - 1 / 3, x, y);
    }
    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Returns a string containing a hex representation of this color, i.e. "#ffffff"
 * @returns {String}
 */

VG.Core.Color.prototype.toHex=function()
{
    // Based on http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb

    function componentToHex(c) {
        let hex = c.toString(16);
        return hex.length == 1 ? "0" + hex : hex;
    }

    return "#" + componentToHex( Math.round( this.r * 255.0 ) ) + componentToHex( Math.round( this.g * 255.0 ) ) + componentToHex( Math.round( this.b * 255.0 ) );
};

/**
 * Returns a string containing a canvas style representation of this color, i.e. "rgba( 255, 255, 255, 255)"
 * @returns {String}
 */

VG.Core.Color.prototype.toCanvasStyle=function()
{
    let text="rgba( " + this.r * 255 + ", " + this.g * 255 + ", " + this.b * 255 + ", " + this.a + ")";
    return text;
};

/**
 * Sets the internal color values to the given Hex value.
 * @param {String} hex - Hex value in the form "#ffffff"
 */

VG.Core.Color.prototype.setHex=function( hex )
{
    // Based on http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb
    // Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
    var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
    hex = hex.replace(shorthandRegex, function(m, r, g, b) {
        return r + r + g + g + b + b;
    });

    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);

    if ( !result ) return;

    this.r=result.length >= 2 ? parseInt(result[1], 16) / 255.0 : 0;
    this.g=result.length >= 3 ? parseInt(result[2], 16) / 255.0 : 0;
    this.b=result.length >= 4 ? parseInt(result[3], 16) / 255.0 : 0;

    this.canvasStyle = this.toCanvasStyle();
};

/**
 * Creates a new {@link VG.Core.Material} class
 * @constructor
 */

VG.Core.Material=function( color, m, s, r )
{
    if ( !(this instanceof VG.Core.Material ) ) return VG.Core.Material.creator( arguments );

    this.color=color || VG.Core.Color();
    this.r = this.color.r;
    this.g = this.color.g;
    this.b = this.color.b;
    this.a = this.color.a;
    this.metallic=m || 0;
    this.smoothness=s || 0;
    this.reflectance=r || 0.5;
};

/**
 * Copies the material values from the given material or color.
 * @param {VG.Core.Material} material - The materialclass to copy the values from.
 */

VG.Core.Material.prototype.copy=function(material)
{
    if ( material instanceof VG.Core.Material )
    {
        this.color.copy( material.color );
        this.r = this.color.r;
        this.g = this.color.g;
        this.b = this.color.b;
        this.a = this.color.a;
        this.metallic = material.metallic;
        this.smoothness = material.smoothness;
        this.reflectance = material.reflectance;
    } else
    if ( material instanceof VG.Core.Color )
    {
        this.color.copy( material );
    }
};

VG.Core.Material.prototype.set=function( color, metallic, smoothness, reflectance )
{
    this.color.copy( color );
    this.r = color.r;
    this.g = color.g;
    this.b = color.b;
    this.a = color.a;
    this.metallic = metallic;
    this.smoothness = smoothness;
    this.reflectance = reflectance;
};

/**
 * Clock/Timer for delta calculation
 * @constructor
 */

VG.Core.Timer=function()
{
    this.prev=Date.now(); //old time
};

/** Returns the time elapsed since the last call to this method in seconds (float) */

VG.Core.Timer.prototype.getDelta = function()
{
    var nt = Date.now();

    var diff=0.001 * (nt -this.prev);

    this.prev = nt;

    return diff;
};

/** Predefined Black Color Object */
VG.Core.Color.Black=VG.Core.Color();
/** Predefined White Color Object */
VG.Core.Color.White=VG.Core.Color( 255, 255, 255 );

/** Creates a new Typed Array
 *  @constructor
 *  @param {enum} type - The buffer type: VG.Core.TypedArray.Type.Float, VG.Core.TypedArray.Type.Uint8, VG.Core.TypedArray.Uint16, VG.Core.TypedArray.Uint32
 *  @param {number} size - The buffer size (not in bytes but in elements)
 */

VG.Core.TypedArray = function( type, size )
{
    if ( !(this instanceof VG.Core.TypedArray) ) return new VG.Core.TypedArray( type, size );

    this.data = null;
    this.type = type;

    switch (type)
    {
        case VG.Type.Float:
            this.data = new Float32Array( size );
        break;
        case VG.Type.Uint8:
            this.data = new Uint8Array( size );
        break;
        case VG.Type.Uint16:
            this.data = new Uint16Array( size );
        break;
        case VG.Type.Uint32:
            this.data = new Uint32Array( size );
        break;
    }
};

/**
 * @enum
 * The available typed array types
*/

VG.Core.TypedArray.Type = { Float: 0, Uint8: 1, Uint16: 2, Uint32: 3 };

/**
 * Sets the array data by index
 * @param {number} index - The index in the array, must be < size
 * @param {*} The value to set
 */

VG.Core.TypedArray.prototype.set=function( index, value )
{
    this.data[index] = value;
};

/**
 * Gets the array data by index
 * @param {number} index - The index in the array, must be < size
 * @returns {*}
 */

VG.Core.TypedArray.prototype.get=function( index )
{
    return this.data[index];
};

/**
 * Returns the size of the typed array (not in bytes but elements).
 *  @returns {number}
 */

VG.Core.TypedArray.prototype.getSize = function()
{
    return this.data.length;
};

/**
 * Creates a new VG.Core.Image class containing the color values of an image. Image Data is allocated via an Uint8Array typed array. The image data is allocated
 * in the power of two of the width and height values to ensure direct WebGL / OpenGL support. realWidth and realHeight contain the power of the two sizes.
 *
 * @param {Number | VG.Core.Image} value - Either the width or a VG.Core.Image class to copy width/height values from
 * @param {Number} height - Height value
 * @constructor
 */

VG.Core.Image=function()
{
    if ( !(this instanceof VG.Core.Image ) ) return VG.Core.Image.creator( arguments );

    /** The user specified width of the Image.
     *  @member {Number} */
    this.width=0;

    /** The user specified height of the Image.
     *  @member {Number} */
    this.height=0;

    /** The image data, allocated in the power of two of the width and height values using an Uint8Array typed array.
     *  @member {Number} */
    this.data=null;

    /** The real width of the image (power of two).
     *  @member {Number} */
    this.realWidth=0;

    /** The real height of the image (power of two).
     *  @member {Number} */
    this.realHeight=0;

    /** The modulo of the image data, i.e. the distance between lines in bytes.
     *  @member {Number} */
    this.modulo=0;

    /** Determines if the image is forced power of two, default is true.
     *  @member {Bool} */
    this.forcePowerOfTwo = false;

    if ( !(this instanceof VG.Core.Image ) ) return VG.Core.Image.creator( arguments );

    if ( arguments.length === 1 ) {
        this.width=arguments[0].width; this.height=arguments[0].height;
        this.forcePowerOfTwo = arguments[0].forcePowerOfTwo;
    } else
    if ( arguments.length === 2 ) {
        this.width=arguments[0]; this.height=arguments[1];
    }

    Object.defineProperty( this, "data", {
        enumerable: false,
        writable: true
    });

    this.alloc();
    this.type=VG.Core.TypedArray.Type.Uint8;
    this.elements=4;
};

/**
 * Allocates the image data. If forcePowerOfTwo is true (the default) allocates the image data in the power of two.
 */

VG.Core.Image.prototype.alloc=function()
{
    this.data=0;
    this.modulo=0;

    this.width = Math.round( this.width );
    this.height = Math.round( this.height );

    if ( this.width && this.height )
    {
        if (this.forcePowerOfTwo)
        {
            this.realWidth=this.powerOfTwo( this.width );
            this.realHeight=this.powerOfTwo( this.height );
        }
        else
        {
            this.realWidth=this.width;
            this.realHeight=this.height;
        }

        this.modulo=this.realWidth * 4;

        this.data=new Uint8Array( this.realWidth * 4 * this.realHeight);
    }
};

/**
 * Disposes the texture associated with this image and deallocates the image data.
 */

VG.Core.Image.prototype.dispose=function()
{
    var texture=VG.Renderer().getTexture( this );
    if ( texture ) texture.dispose();
    this.invalidate();
};

/**
 * Converts the image to a canvas image.
 */

VG.Core.Image.prototype.toCanvasImage=function()
{
    VG.Utils.imageToHTML5Image( this, ( image ) => {
        this.canvasImage = image;
        var texture=VG.Renderer().getTexture( this );
        if ( texture ) texture.dispose();
    } );
};

/**
 * Gets a pixel color at position x, y.
 * @param {number} position x coordinate
 * @param {number} position y coordinate
 * @param {VG.Core.Color} The color class to store the pixel data.
 */

VG.Core.Image.prototype.getPixel=function( x, y, color )
{
    if ( !color ) color=VG.Core.Color();
    let offset=y * this.modulo + x * 4;
    color.r=this.data[offset] / 255;
    color.g=this.data[offset+1] / 255;
    color.b=this.data[offset+2] / 255;
    color.a=this.data[offset+3] / 255;

    return color;
};

/**
 * Sets pixel color at position
 * @param {number} position x coordinate
 * @param {number} position y coordinate
 * @param {number} 0.0 to 1.0 red channel
 * @param {number} 0.0 to 1.0 green channel
 * @param {number} 0.0 to 1.0 blue channel
 * @param {number} 0.0 to 1.0 alpha channel
*/

VG.Core.Image.prototype.setPixel=function( x, y, r, g, b, a )
{
    var offset=y * this.modulo + x * 4;
    this.data[offset]=r * 255;
    this.data[offset+1]=g * 255;
    this.data[offset+2]=b * 255;
    this.data[offset+3]=a * 255;
};

/**
 * Sets pixel color at position
 * @param {number} position x coordinate
 * @param {number} position y coordinate
 * @param {number} 0 to 255 red channel
 * @param {number} 0 to 255 green channel
 * @param {number} 0 to 255 blue channel
 * @param {number} 0 to 255 alpha channel
*/

VG.Core.Image.prototype.setPixelRGBA=function( x, y, r, g, b, a )
{
    var offset=y * this.modulo + x * 4;
    this.data[offset]=r;
    this.data[offset+1]=g;
    this.data[offset+2]=b;
    this.data[offset+3]=a;
};

VG.Core.Image.prototype.powerOfTwo=function (value, pow) {
    pow = pow || 1;
    while(pow<value) {
        pow *= 2;
    }
    return pow;
};

/**
 * Resizes the image (all image data is lost) using the given width and height.
 * @param {number} width - The new width of the image.
 * @param {number} height - The new height of the image.
 */

VG.Core.Image.prototype.resize=function( width, height )
{
    if ( !this.isValid() || this.width !== width || this.height !== height ) {
        this.width=width; this.height=height;
        this.alloc();
    }
    this.needsUpdate=true;
};

/**
 * Clears the image data with 0 values.
 */

VG.Core.Image.prototype.clear=function()
{
    if ( this.data.fill ) this.data.fill( 0 );
    else
    {
        for ( var i=0; i < this.data.length; ++i )
            this.data[i]=0;
    }
};

/**
 * Copies the values of the given image using a new data array.
 * @param {VG.Core.Image} image - The image to copy
 */

VG.Core.Image.prototype.set=function( image )
{
    this.width=image.width; this.height=image.height;
    this.realWidth=image.realWidth; this.realHeight=image.realHeight;
    this.modulo=image.modulo;
    this.imageData=image.imageData;
    this.name=image.name;
    this.powerOfTwo=image.powerOfTwo;

    this.data=null;
    this.data=new Uint8Array( image.data );
};

/**
 * Copies the values of the given image using a new data array.
 * @param {VG.Core.Image} image - The image to copy
 */

VG.Core.Image.prototype.copy=function( image )
{
    this.set( image );
};

/**
 * Multiplies the given VG.Core.Color with every pixel of the image.
 * @param {VG.Core.Color} color - The color to multiply the image data with.
 */

VG.Core.Image.prototype.mul=function( color )
{
    for ( var h=0; h < this.height; ++h ) {
        for ( var w=0; w < this.width; ++w )
        {
            var offset=h * this.modulo + w * 4;

            this.data[offset]=this.data[offset] * color.r;
            this.data[offset+1]=this.data[offset+1] * color.g;
            this.data[offset+2]=this.data[offset+2] * color.b;
        }
    }
};

/**
 * Returns true if the image has valid image data associated with it.
 * Returns {bool}
 */

VG.Core.Image.prototype.isValid=function()
{
    if ( this.width && this.height && this.data && !this.locked ) return true;
    else return false;
};

/**
 * Invalidates the image by setting the data and dimensions of the image to 0.
 */

VG.Core.Image.prototype.invalidate=function()
{
    this.data=undefined;
    this.width=0; this.height=0;
};

/** Get the real width of the image (power of two).
 * @return {Number}
 */

VG.Core.Image.prototype.getRealWidth=function()
{
    return this.realWidth;
};

/**
 * Get the real height of the image (power of two).
 * @return {Number}
 */

VG.Core.Image.prototype.getRealHeight=function()
{
    return this.realHeight;
};

/**
 * Get the user specified width of the Image.
 * @return {Number}
 */

VG.Core.Image.prototype.getWidth=function()
{
    return this.width;
};

/**
 * Get the user specified height of the Image.
 * @return {Number}
 */

VG.Core.Image.prototype.getHeight=function()
{
    return this.height;
};


VG.Core.Float32Image=function()
{
    if ( !(this instanceof VG.Core.Float32Image ) ) return VG.Core.Float32Image.creator( arguments );

    /** The user specified width of the Image.
     *  @member {Number} */
    this.width=0;

    /** The user specified height of the Image.
     *  @member {Number} */
    this.height=0;

    /** The image data, allocated in the power of two of the width and height values using an Uint8Array typed array.
     *  @member {Number} */
    this.data=null;

    /** The real width of the image (power of two).
     *  @member {Number} */
    this.realWidth=0;

    /** The real height of the image (power of two).
     *  @member {Number} */
    this.realHeight=0;

    /** The modulo of the image data, i.e. the distance between lines in bytes.
     *  @member {Number} */
    this.modulo=0;

    /** Determines if the image is forced power of two, default is true.
     *  @member {Bool} */
    this.forcePowerOfTwo = false;

    if ( !(this instanceof VG.Core.Image ) ) return VG.Core.Image.creator( arguments );

    if ( arguments.length === 1 ) {
        this.width=arguments[0].width; this.height=arguments[0].height;
    } else
    if ( arguments.length === 2 ) {
        this.width=arguments[0]; this.height=arguments[1];
    }

    Object.defineProperty( this, "data", {
        enumerable: false,
        writable: true
    });

    this.alloc();
    this.type=VG.Core.TypedArray.Type.Float;
    this.elements=4;
};

VG.Core.Float32Image.prototype=VG.Core.Image();

/**
 * Allocates the image data. If forcePowerOfTwo is true (the default) allocates the image data in the power of two.
 */

VG.Core.Float32Image.prototype.alloc=function()
{
    this.data=0;
    this.modulo=0;

    if ( this.width && this.height )
    {
        if (this.forcePowerOfTwo)
        {
            this.realWidth=this.powerOfTwo( this.width );
            this.realHeight=this.powerOfTwo( this.height );
        }
        else
        {
            this.realWidth=this.width;
            this.realHeight=this.height;
        }

        this.modulo=this.realWidth * this.elements;
        this.data=new Float32Array( this.realWidth * this.elements * this.realHeight);
    }
};

/**
 * Creates an VG.Core.ImagePool class. The default image pool of every Visual Graphics application is located at VG.context.imagePool. It is filled automatically
 * on application startup with all application images as well as with images used by the Style. You can retrieve images from the default pool
 * using VG.Utils.getImageByName() which in turn calls VG.context.imagePool.getImageByName().
 *  @constructor
 */

VG.Core.ImagePool=function()
{
    if ( !(this instanceof VG.Core.ImagePool) ) return new VG.Core.ImagePool();

    this.images=[];
};

/**
 * Adds an image to the pool.
 * param {VG.Core.Image} image - The image to add.
 */

VG.Core.ImagePool.prototype.addImage=function( image )
{
    this.images.push( image );
};

/**
 * Returns an image from the pool based on its name.
 * @returns {VG.Core.Image} or null if no image with the given name was found.
 */

VG.Core.ImagePool.prototype.getImageByName=function( name )
{
    for( var i=0; i < this.images.length; ++i ) {
        if ( this.images[i].name === name )
            return this.images[i];
    }

    var prefixName=VG.UI.stylePool.current.skin.prefix + name;

    for( i=0; i < this.images.length; ++i ) {
        if ( this.images[i].name === prefixName )
            return this.images[i];
    }

    if ( VG.UI.stylePool.current.skin.fallbackPrefix ) {
        prefixName=VG.UI.stylePool.current.skin.fallbackPrefix + name;
        for( i=0; i < this.images.length; ++i ) {
            if ( this.images[i].name === prefixName )
                return this.images[i];
        }
    }

    return null;
};

VG.context.imagePool=VG.Core.ImagePool();

// cuon-matrix.js (c) 2012 kanda and matsuda
/**
 * This is a class treating 4x4 matrix.
 * This class contains the function that is equivalent to OpenGL matrix stack.
 * The matrix after conversion is calculated by multiplying a conversion matrix from the right.
 * The matrix is replaced by the calculated result.
 */

/**
 * Contains Math related classes used by Visual Graphics
 * @namespace
 */

VG.Math = {};

/**
 * Constructor of Matrix4
 * If opt_src is specified, new matrix is initialized by opt_src.
 * Otherwise, new matrix is initialized by identity matrix.
 * @param opt_src source matrix(option)
 * @constructor
 */
VG.Math.Matrix4 = function(opt_src) {
  var i, s, d;
  if (opt_src && typeof opt_src === 'object' && opt_src.hasOwnProperty('elements')) {
    s = opt_src.elements;
    d = new Float32Array(16);
    for (i = 0; i < 16; ++i) {
      d[i] = s[i];
    }
    this.elements = d;
  } else {
    this.elements = new Float32Array([1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1]);
  }
};

/**
 * Set the identity matrix.
 * @return this
 */
VG.Math.Matrix4.prototype.setIdentity = function() {
  var e = this.elements;
  e[0] = 1;   e[4] = 0;   e[8]  = 0;   e[12] = 0;
  e[1] = 0;   e[5] = 1;   e[9]  = 0;   e[13] = 0;
  e[2] = 0;   e[6] = 0;   e[10] = 1;   e[14] = 0;
  e[3] = 0;   e[7] = 0;   e[11] = 0;   e[15] = 1;
  return this;
};

/**
 * Copy matrix.
 * @param src source matrix
 * @return this
 */
VG.Math.Matrix4.prototype.set = function(src) {
  var i, s, d;

  s = src.elements;
  d = this.elements;

  if (s === d) {
    return;
  }

  for (i = 0; i < 16; ++i) {
    d[i] = s[i];
  }

  return this;
};

/**
 * Multiply the matrix from the right.
 * @param other The multiply matrix
 * @return this
 */
VG.Math.Matrix4.prototype.concat = function(other) {
  var i, e, a, b, ai0, ai1, ai2, ai3;

  // Calculate e = a * b
  e = this.elements;
  a = this.elements;
  b = other.elements;

  // If e equals b, copy b to temporary matrix.
  if (e === b) {
    b = new Float32Array(16);
    for (i = 0; i < 16; ++i) {
      b[i] = e[i];
    }
  }
  for (i = 0; i < 4; i++) {
    ai0=a[i];  ai1=a[i+4];  ai2=a[i+8];  ai3=a[i+12];
    e[i]    = ai0 * b[0]  + ai1 * b[1]  + ai2 * b[2]  + ai3 * b[3];
    e[i+4]  = ai0 * b[4]  + ai1 * b[5]  + ai2 * b[6]  + ai3 * b[7];
    e[i+8]  = ai0 * b[8]  + ai1 * b[9]  + ai2 * b[10] + ai3 * b[11];
    e[i+12] = ai0 * b[12] + ai1 * b[13] + ai2 * b[14] + ai3 * b[15];
  }
  return this;
};
VG.Math.Matrix4.prototype.multiply = VG.Math.Matrix4.prototype.concat;

/**
 * Multiply the three-dimensional vector.
 * This assume the vector is direction (NOT position).
 * @param pos {VG.Math.Vector3} The multiply vector
 * @return {VG.Math.Vector3} The result of multiplication
 */
VG.Math.Matrix4.prototype.multiplyVector3 = function(pos) {
    var e = this.elements;
    var p = [pos.x, pos.y, pos.z];
    var v = new VG.Math.Vector3();

    v.x = p[0] * e[0] + p[1] * e[4] + p[2] * e[ 8] + e[12]; // was: e[11];
    v.y = p[0] * e[1] + p[1] * e[5] + p[2] * e[ 9] + e[13]; // was: e[12];
    v.z = p[0] * e[2] + p[1] * e[6] + p[2] * e[10] + e[14]; // was: e[13];
    return v;
};

VG.Math.Matrix4.prototype.multiplyDirection = function (dir) {
  /**
   * transform a direction vector with this matrix.
   * @param dir {VG.Math.Vector3} direction
   * @return {VG.Math.Vector3} the transformed direction.
   */
    return this.multiplyVector3(dir);
};

VG.Math.Matrix4.prototype.multiplyPosition = function(pos) {
  /**
   * transform a position vector with this matrix.
   * @param pos {VG.Math.Vector3} position
   * @return {VG.Math.Matrix3} the transformed position.
   */
    var out = this.multiplyDirection(pos);
    var e = this.elements;
    var w = pos.x * e[3] + pos.y * e[7] + pos.z * e[11] + e[15];
    out.mul(1/w);
    return out;
};

/**
 * Transpose the matrix.
 * @return this
 */
VG.Math.Matrix4.prototype.transpose = function() {
  var e, t;

  e = this.elements;

  t = e[ 1];  e[ 1] = e[ 4];  e[ 4] = t;
  t = e[ 2];  e[ 2] = e[ 8];  e[ 8] = t;
  t = e[ 3];  e[ 3] = e[12];  e[12] = t;
  t = e[ 6];  e[ 6] = e[ 9];  e[ 9] = t;
  t = e[ 7];  e[ 7] = e[13];  e[13] = t;
  t = e[11];  e[11] = e[14];  e[14] = t;

  return this;
};

/**
 * Calculate the inverse matrix of specified matrix, and set to this.
 * @param other The source matrix
 * @return this
 */
VG.Math.Matrix4.prototype.setInverseOf = function(other) {
  var i, s, d, inv, det;

  s = other.elements;
  d = this.elements;
  inv = new Float32Array(16);

  inv[0]  =   s[5]*s[10]*s[15] - s[5] *s[11]*s[14] - s[9] *s[6]*s[15] + s[9]*s[7] *s[14] + s[13]*s[6] *s[11] - s[13]*s[7]*s[10];
  inv[4]  = - s[4]*s[10]*s[15] + s[4] *s[11]*s[14] + s[8] *s[6]*s[15] - s[8]*s[7] *s[14] - s[12]*s[6] *s[11] + s[12]*s[7]*s[10];
  inv[8]  =   s[4]*s[9] *s[15] - s[4] *s[11]*s[13] - s[8] *s[5]*s[15] + s[8]*s[7] *s[13] + s[12]*s[5] *s[11] - s[12]*s[7]*s[9];
  inv[12] = - s[4]*s[9] *s[14] + s[4] *s[10]*s[13] + s[8] *s[5]*s[14] - s[8]*s[6] *s[13] - s[12]*s[5] *s[10] + s[12]*s[6]*s[9];

  inv[1]  = - s[1]*s[10]*s[15] + s[1] *s[11]*s[14] + s[9] *s[2]*s[15] - s[9]*s[3] *s[14] - s[13]*s[2] *s[11] + s[13]*s[3]*s[10];
  inv[5]  =   s[0]*s[10]*s[15] - s[0] *s[11]*s[14] - s[8] *s[2]*s[15] + s[8]*s[3] *s[14] + s[12]*s[2] *s[11] - s[12]*s[3]*s[10];
  inv[9]  = - s[0]*s[9] *s[15] + s[0] *s[11]*s[13] + s[8] *s[1]*s[15] - s[8]*s[3] *s[13] - s[12]*s[1] *s[11] + s[12]*s[3]*s[9];
  inv[13] =   s[0]*s[9] *s[14] - s[0] *s[10]*s[13] - s[8] *s[1]*s[14] + s[8]*s[2] *s[13] + s[12]*s[1] *s[10] - s[12]*s[2]*s[9];

  inv[2]  =   s[1]*s[6]*s[15] - s[1] *s[7]*s[14] - s[5] *s[2]*s[15] + s[5]*s[3]*s[14] + s[13]*s[2]*s[7]  - s[13]*s[3]*s[6];
  inv[6]  = - s[0]*s[6]*s[15] + s[0] *s[7]*s[14] + s[4] *s[2]*s[15] - s[4]*s[3]*s[14] - s[12]*s[2]*s[7]  + s[12]*s[3]*s[6];
  inv[10] =   s[0]*s[5]*s[15] - s[0] *s[7]*s[13] - s[4] *s[1]*s[15] + s[4]*s[3]*s[13] + s[12]*s[1]*s[7]  - s[12]*s[3]*s[5];
  inv[14] = - s[0]*s[5]*s[14] + s[0] *s[6]*s[13] + s[4] *s[1]*s[14] - s[4]*s[2]*s[13] - s[12]*s[1]*s[6]  + s[12]*s[2]*s[5];

  inv[3]  = - s[1]*s[6]*s[11] + s[1]*s[7]*s[10] + s[5]*s[2]*s[11] - s[5]*s[3]*s[10] - s[9]*s[2]*s[7]  + s[9]*s[3]*s[6];
  inv[7]  =   s[0]*s[6]*s[11] - s[0]*s[7]*s[10] - s[4]*s[2]*s[11] + s[4]*s[3]*s[10] + s[8]*s[2]*s[7]  - s[8]*s[3]*s[6];
  inv[11] = - s[0]*s[5]*s[11] + s[0]*s[7]*s[9]  + s[4]*s[1]*s[11] - s[4]*s[3]*s[9]  - s[8]*s[1]*s[7]  + s[8]*s[3]*s[5];
  inv[15] =   s[0]*s[5]*s[10] - s[0]*s[6]*s[9]  - s[4]*s[1]*s[10] + s[4]*s[2]*s[9]  + s[8]*s[1]*s[6]  - s[8]*s[2]*s[5];

  det = s[0]*inv[0] + s[1]*inv[4] + s[2]*inv[8] + s[3]*inv[12];
  if (det === 0) {
    return this;
  }

  det = 1 / det;
  for (i = 0; i < 16; i++) {
    d[i] = inv[i] * det;
  }

  return this;
};

/**
 * Calculate the inverse matrix of this, and set to this.
 * @return this
 */
VG.Math.Matrix4.prototype.invert = function() {
  return this.setInverseOf(this);
};

/**
 * Set the orthographic projection matrix.
 * @param left The coordinate of the left of clipping plane.
 * @param right The coordinate of the right of clipping plane.
 * @param bottom The coordinate of the bottom of clipping plane.
 * @param top The coordinate of the top top clipping plane.
 * @param near The distances to the nearer depth clipping plane. This value is minus if the plane is to be behind the viewer.
 * @param far The distances to the farther depth clipping plane. This value is minus if the plane is to be behind the viewer.
 * @return this
 */
VG.Math.Matrix4.prototype.setOrtho = function(left, right, bottom, top, near, far) {
  var e, rw, rh, rd;

  if (left === right || bottom === top || near === far) {
    throw 'null frustum';
  }

  rw = 1 / (right - left);
  rh = 1 / (top - bottom);
  rd = 1 / (far - near);

  e = this.elements;

  e[0]  = 2 * rw;
  e[1]  = 0;
  e[2]  = 0;
  e[3]  = 0;

  e[4]  = 0;
  e[5]  = 2 * rh;
  e[6]  = 0;
  e[7]  = 0;

  e[8]  = 0;
  e[9]  = 0;
  e[10] = -2 * rd;
  e[11] = 0;

  e[12] = -(right + left) * rw;
  e[13] = -(top + bottom) * rh;
  e[14] = -(far + near) * rd;
  e[15] = 1;

  return this;
};

/**
 * Multiply the orthographic projection matrix from the right.
 * @param left The coordinate of the left of clipping plane.
 * @param right The coordinate of the right of clipping plane.
 * @param bottom The coordinate of the bottom of clipping plane.
 * @param top The coordinate of the top top clipping plane.
 * @param near The distances to the nearer depth clipping plane. This value is minus if the plane is to be behind the viewer.
 * @param far The distances to the farther depth clipping plane. This value is minus if the plane is to be behind the viewer.
 * @return this
 */
VG.Math.Matrix4.prototype.ortho = function(left, right, bottom, top, near, far) {
  return this.concat(new Matrix4().setOrtho(left, right, bottom, top, near, far));
};

/**
 * Set the perspective projection matrix.
 * @param left The coordinate of the left of clipping plane.
 * @param right The coordinate of the right of clipping plane.
 * @param bottom The coordinate of the bottom of clipping plane.
 * @param top The coordinate of the top top clipping plane.
 * @param near The distances to the nearer depth clipping plane. This value must be plus value.
 * @param far The distances to the farther depth clipping plane. This value must be plus value.
 * @return this
 */
VG.Math.Matrix4.prototype.setFrustum = function(left, right, bottom, top, near, far) {
  var e, rw, rh, rd;

  if (left === right || top === bottom || near === far) {
    throw 'null frustum';
  }
  if (near <= 0) {
    throw 'near <= 0';
  }
  if (far <= 0) {
    throw 'far <= 0';
  }

  rw = 1 / (right - left);
  rh = 1 / (top - bottom);
  rd = 1 / (far - near);

  e = this.elements;

  e[ 0] = 2 * near * rw;
  e[ 1] = 0;
  e[ 2] = 0;
  e[ 3] = 0;

  e[ 4] = 0;
  e[ 5] = 2 * near * rh;
  e[ 6] = 0;
  e[ 7] = 0;

  e[ 8] = (right + left) * rw;
  e[ 9] = (top + bottom) * rh;
  e[10] = -(far + near) * rd;
  e[11] = -1;

  e[12] = 0;
  e[13] = 0;
  e[14] = -2 * near * far * rd;
  e[15] = 0;

  return this;
};

/**
 * Multiply the perspective projection matrix from the right.
 * @param left The coordinate of the left of clipping plane.
 * @param right The coordinate of the right of clipping plane.
 * @param bottom The coordinate of the bottom of clipping plane.
 * @param top The coordinate of the top top clipping plane.
 * @param near The distances to the nearer depth clipping plane. This value must be plus value.
 * @param far The distances to the farther depth clipping plane. This value must be plus value.
 * @return this
 */
VG.Math.Matrix4.prototype.frustum = function(left, right, bottom, top, near, far) {
  return this.concat(new Matrix4().setFrustum(left, right, bottom, top, near, far));
};

/**
 * Set the perspective projection matrix by fovy and aspect.
 * @param fovy The angle between the upper and lower sides of the frustum.
 * @param aspect The aspect ratio of the frustum. (width/height)
 * @param near The distances to the nearer depth clipping plane. This value must be plus value.
 * @param far The distances to the farther depth clipping plane. This value must be plus value.
 * @return this
 */
VG.Math.Matrix4.prototype.setPerspective = function(fovy, aspect, near, far) {
  var e, rd, s, ct;

  if (near === far || aspect === 0) {
    throw 'null frustum';
  }
  if (near <= 0) {
    throw 'near <= 0';
  }
  if (far <= 0) {
    throw 'far <= 0';
  }

  fovy = Math.PI * fovy / 180 / 2;
  s = Math.sin(fovy);
  if (s === 0) {
    throw 'null frustum';
  }

  rd = 1 / (far - near);
  ct = Math.cos(fovy) / s;

  e = this.elements;

  e[0]  = ct / aspect;
  e[1]  = 0;
  e[2]  = 0;
  e[3]  = 0;

  e[4]  = 0;
  e[5]  = ct;
  e[6]  = 0;
  e[7]  = 0;

  e[8]  = 0;
  e[9]  = 0;
  e[10] = -(far + near) * rd;
  e[11] = -1;

  e[12] = 0;
  e[13] = 0;
  e[14] = -2 * near * far * rd;
  e[15] = 0;

  return this;
};

/**
 * Multiply the perspective projection matrix from the right.
 * @param fovy The angle between the upper and lower sides of the frustum.
 * @param aspect The aspect ratio of the frustum. (width/height)
 * @param near The distances to the nearer depth clipping plane. This value must be plus value.
 * @param far The distances to the farther depth clipping plane. This value must be plus value.
 * @return this
 */
VG.Math.Matrix4.prototype.perspective = function(fovy, aspect, near, far) {
  return this.concat(new Matrix4().setPerspective(fovy, aspect, near, far));
};

/**
 * Set the matrix for scaling.
 * @param x The scale factor along the X axis
 * @param y The scale factor along the Y axis
 * @param z The scale factor along the Z axis
 * @return this
 */
VG.Math.Matrix4.prototype.setScale = function(x, y, z) {
  var e = this.elements;
  e[0] = x;  e[4] = 0;  e[8]  = 0;  e[12] = 0;
  e[1] = 0;  e[5] = y;  e[9]  = 0;  e[13] = 0;
  e[2] = 0;  e[6] = 0;  e[10] = z;  e[14] = 0;
  e[3] = 0;  e[7] = 0;  e[11] = 0;  e[15] = 1;
  return this;
};

/**
 * Multiply the matrix for scaling from the right.
 * @param x The scale factor along the X axis
 * @param y The scale factor along the Y axis
 * @param z The scale factor along the Z axis
 * @return this
 */
VG.Math.Matrix4.prototype.scale = function(x, y, z) {
  var e = this.elements;
  e[0] *= x;  e[4] *= y;  e[8]  *= z;
  e[1] *= x;  e[5] *= y;  e[9]  *= z;
  e[2] *= x;  e[6] *= y;  e[10] *= z;
  e[3] *= x;  e[7] *= y;  e[11] *= z;
  return this;
};

/**
 * Set the matrix for translation.
 * @param x The X value of a translation.
 * @param y The Y value of a translation.
 * @param z The Z value of a translation.
 * @return this
 */
VG.Math.Matrix4.prototype.setTranslate = function(x, y, z) {
  var e = this.elements;
  e[0] = 1;  e[4] = 0;  e[8]  = 0;  e[12] = x;
  e[1] = 0;  e[5] = 1;  e[9]  = 0;  e[13] = y;
  e[2] = 0;  e[6] = 0;  e[10] = 1;  e[14] = z;
  e[3] = 0;  e[7] = 0;  e[11] = 0;  e[15] = 1;
  return this;
};

/**
 * Multiply the matrix for translation from the right.
 * @param x The X value of a translation.
 * @param y The Y value of a translation.
 * @param z The Z value of a translation.
 * @return this
 */
VG.Math.Matrix4.prototype.translate = function(x, y, z) {
  var e = this.elements;
  e[12] += e[0] * x + e[4] * y + e[8]  * z;
  e[13] += e[1] * x + e[5] * y + e[9]  * z;
  e[14] += e[2] * x + e[6] * y + e[10] * z;
  e[15] += e[3] * x + e[7] * y + e[11] * z;
  return this;
};

/**
 * Set the matrix for rotation.
 * The vector of rotation axis may not be normalized.
 * @param angle The angle of rotation (degrees)
 * @param x The X coordinate of vector of rotation axis.
 * @param y The Y coordinate of vector of rotation axis.
 * @param z The Z coordinate of vector of rotation axis.
 * @return this
 */
VG.Math.Matrix4.prototype.setRotate = function(angle, x, y, z) {
  var e, s, c, len, rlen, nc, xy, yz, zx, xs, ys, zs;

  angle = Math.PI * angle / 180;
  e = this.elements;

  s = Math.sin(angle);
  c = Math.cos(angle);

  if (0 !== x && 0 === y && 0 === z) {
    // Rotation around X axis
    if (x < 0) {
      s = -s;
    }
    e[0] = 1;  e[4] = 0;  e[ 8] = 0;  e[12] = 0;
    e[1] = 0;  e[5] = c;  e[ 9] =-s;  e[13] = 0;
    e[2] = 0;  e[6] = s;  e[10] = c;  e[14] = 0;
    e[3] = 0;  e[7] = 0;  e[11] = 0;  e[15] = 1;
  } else if (0 === x && 0 !== y && 0 === z) {
    // Rotation around Y axis
    if (y < 0) {
      s = -s;
    }
    e[0] = c;  e[4] = 0;  e[ 8] = s;  e[12] = 0;
    e[1] = 0;  e[5] = 1;  e[ 9] = 0;  e[13] = 0;
    e[2] =-s;  e[6] = 0;  e[10] = c;  e[14] = 0;
    e[3] = 0;  e[7] = 0;  e[11] = 0;  e[15] = 1;
  } else if (0 === x && 0 === y && 0 !== z) {
    // Rotation around Z axis
    if (z < 0) {
      s = -s;
    }
    e[0] = c;  e[4] =-s;  e[ 8] = 0;  e[12] = 0;
    e[1] = s;  e[5] = c;  e[ 9] = 0;  e[13] = 0;
    e[2] = 0;  e[6] = 0;  e[10] = 1;  e[14] = 0;
    e[3] = 0;  e[7] = 0;  e[11] = 0;  e[15] = 1;
  } else {
    // Rotation around another axis
    len = Math.sqrt(x*x + y*y + z*z);
    if (len !== 1) {
      rlen = 1 / len;
      x *= rlen;
      y *= rlen;
      z *= rlen;
    }
    nc = 1 - c;
    xy = x * y;
    yz = y * z;
    zx = z * x;
    xs = x * s;
    ys = y * s;
    zs = z * s;

    e[ 0] = x*x*nc +  c;
    e[ 1] = xy *nc + zs;
    e[ 2] = zx *nc - ys;
    e[ 3] = 0;

    e[ 4] = xy *nc - zs;
    e[ 5] = y*y*nc +  c;
    e[ 6] = yz *nc + xs;
    e[ 7] = 0;

    e[ 8] = zx *nc + ys;
    e[ 9] = yz *nc - xs;
    e[10] = z*z*nc +  c;
    e[11] = 0;

    e[12] = 0;
    e[13] = 0;
    e[14] = 0;
    e[15] = 1;
  }

  return this;
};

/**
 * Multiply the matrix for rotation from the right.
 * The vector of rotation axis may not be normalized.
 * @param angle The angle of rotation (degrees)
 * @param x The X coordinate of vector of rotation axis.
 * @param y The Y coordinate of vector of rotation axis.
 * @param z The Z coordinate of vector of rotation axis.
 * @return this
 */
VG.Math.Matrix4.prototype.rotate = function(angle, x, y, z) {
  return this.concat(new VG.Math.Matrix4().setRotate(angle, x, y, z));
};

/**
 * Return a new rotation matrix, with rotation angle specified by theta
 * according to taitBryan angles.
 * I.e rotate(x).rotate(y).rotate(z)
 */
VG.Math.Matrix4.taitBryan = (theta0, theta1, theta2) => {
  theta0 = theta0 * Math.PI / 180;
  theta1 = theta1 * Math.PI / 180;
  theta2 = theta2 * Math.PI / 180;
  let c = {
    x: Math.cos(theta0),
    y: Math.cos(theta1),
    z: Math.cos(theta2)
  };
  let s = {
      x: Math.sin(theta0),
      y: Math.sin(theta1),
      z: Math.sin(theta2)
  };
  let m = new VG.Math.Matrix4();
  let e = m.elements;
  e[0] = c.y*c.z;
  e[1] = c.x*s.z + c.z*s.x*s.y;
  e[2] = s.x*s.z-c.x*c.z*s.y;
  e[3] = 0.0;
  e[4] = -c.y*s.z;
  e[5] = c.x*c.z-s.x*s.y*s.z;
  e[6] = c.z*s.x + c.x*s.y*s.z;
  e[7] = 0.0;
  e[8] = s.y;
  e[9] = -c.y*s.x;
  e[10] = c.x*c.y;
  e[11] = 0.0;
  return m;
};

/**
 * Set the viewing matrix.
 * @param eyeX, eyeY, eyeZ The position of the eye point.
 * @param centerX, centerY, centerZ The position of the reference point.
 * @param upX, upY, upZ The direction of the up vector.
 * @return this
 */
VG.Math.Matrix4.prototype.setLookAt = function(eyeX, eyeY, eyeZ, centerX, centerY, centerZ, upX, upY, upZ) {
  var e, fx, fy, fz, rlf, sx, sy, sz, rls, ux, uy, uz;

  fx = centerX - eyeX;
  fy = centerY - eyeY;
  fz = centerZ - eyeZ;

  // Normalize f.
  rlf = 1 / Math.sqrt(fx*fx + fy*fy + fz*fz);
  fx *= rlf;
  fy *= rlf;
  fz *= rlf;

  // Calculate cross product of f and up.
  sx = fy * upZ - fz * upY;
  sy = fz * upX - fx * upZ;
  sz = fx * upY - fy * upX;

  // Normalize s.
  rls = 1 / Math.sqrt(sx*sx + sy*sy + sz*sz);
  sx *= rls;
  sy *= rls;
  sz *= rls;

  // Calculate cross product of s and f.
  ux = sy * fz - sz * fy;
  uy = sz * fx - sx * fz;
  uz = sx * fy - sy * fx;

  // Set to this.
  e = this.elements;
  e[0] = sx;
  e[1] = ux;
  e[2] = -fx;
  e[3] = 0;

  e[4] = sy;
  e[5] = uy;
  e[6] = -fy;
  e[7] = 0;

  e[8] = sz;
  e[9] = uz;
  e[10] = -fz;
  e[11] = 0;

  e[12] = 0;
  e[13] = 0;
  e[14] = 0;
  e[15] = 1;

  // Translate.
  return this.translate(-eyeX, -eyeY, -eyeZ);
};

/**
 * Multiply the viewing matrix from the right.
 * @param eyeX, eyeY, eyeZ The position of the eye point.
 * @param centerX, centerY, centerZ The position of the reference point.
 * @param upX, upY, upZ The direction of the up vector.
 * @return this
 */
VG.Math.Matrix4.prototype.lookAt = function(eyeX, eyeY, eyeZ, centerX, centerY, centerZ, upX, upY, upZ) {
  return this.concat(new VG.Math.Matrix4().setLookAt(eyeX, eyeY, eyeZ, centerX, centerY, centerZ, upX, upY, upZ));
};

/**
 * Multiply the matrix for project vertex to plane from the right.
 * @param plane The array[A, B, C, D] of the equation of plane "Ax + By + Cz + D = 0".
 * @param light The array which stored coordinates of the light. if light[3]=0, treated as parallel light.
 * @return this
 */
VG.Math.Matrix4.prototype.dropShadow = function(plane, light) {
  var mat = new Matrix4();
  var e = mat.elements;

  var dot = plane[0] * light[0] + plane[1] * light[1] + plane[2] * light[2] + plane[3] * light[3];

  e[ 0] = dot - light[0] * plane[0];
  e[ 1] =     - light[1] * plane[0];
  e[ 2] =     - light[2] * plane[0];
  e[ 3] =     - light[3] * plane[0];

  e[ 4] =     - light[0] * plane[1];
  e[ 5] = dot - light[1] * plane[1];
  e[ 6] =     - light[2] * plane[1];
  e[ 7] =     - light[3] * plane[1];

  e[ 8] =     - light[0] * plane[2];
  e[ 9] =     - light[1] * plane[2];
  e[10] = dot - light[2] * plane[2];
  e[11] =     - light[3] * plane[2];

  e[12] =     - light[0] * plane[3];
  e[13] =     - light[1] * plane[3];
  e[14] =     - light[2] * plane[3];
  e[15] = dot - light[3] * plane[3];

  return this.concat(mat);
};

/**
 * Multiply the matrix for project vertex to plane from the right.(Projected by parallel light.)
 * @param normX, normY, normZ The normal vector of the plane.(Not necessary to be normalized.)
 * @param planeX, planeY, planeZ The coordinate of arbitrary points on a plane.
 * @param lightX, lightY, lightZ The vector of the direction of light.(Not necessary to be normalized.)
 * @return this
 */
VG.Math.Matrix4.prototype.dropShadowDirectionally = function(normX, normY, normZ, planeX, planeY, planeZ, lightX, lightY, lightZ) {
  var a = planeX * normX + planeY * normY + planeZ * normZ;
  return this.dropShadow([normX, normY, normZ, -a], [lightX, lightY, lightZ, 0]);
};


//FROM HERE VG'S CODE

/*
 * Copyright (c) 2014-2016 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */


//TODO implement own Matrix4

/**
 * Transform a single vector 3 or 4 array
 * @param {Array} p - The vector array
 * @param {Bool} normal - Determines if the vector is a normal, must be 3 element long
 */

VG.Math.Matrix4.prototype.transformVectorArray=function(p, normal)
{
    var e = this.elements;

    var x = 0.0;
    var y = 0.0;
    var z = 0.0;
    var w = 0.0;

    if (p.length == 3)
    {
        if (normal)
        {
            x = p[0] * e[0] + p[1] * e[4] + p[2] * e[ 8];
            y = p[0] * e[1] + p[1] * e[5] + p[2] * e[ 9];
            z = p[0] * e[2] + p[1] * e[6] + p[2] * e[10];
        }
        else
        {
            x = p[0] * e[0] + p[1] * e[4] + p[2] * e[ 8] + e[12];
            y = p[0] * e[1] + p[1] * e[5] + p[2] * e[ 9] + e[13];
            z = p[0] * e[2] + p[1] * e[6] + p[2] * e[10] + e[14];
        }

    }
    else
    if (p.length == 4)
    {

        x = p[0] * e[0] + p[1] * e[4] + p[2] * e[ 8] + p[3] * e[12];
        y = p[0] * e[1] + p[1] * e[5] + p[2] * e[ 9] + p[3] * e[13];
        z = p[0] * e[2] + p[1] * e[6] + p[2] * e[10] + p[3] * e[14];
        w = p[0] * e[3] + p[1] * e[7] + p[2] * e[11] + p[3] * e[15];
    }

    p[0] = x;
    p[1] = y;
    p[2] = z;
    if (p[3])
		p[3] = w;
};

/** Multiplies against
 *  @paramn {VG.Math.Matrix4} other - The other matrix
 *  @return this
 */

VG.Math.Matrix4.prototype.mul=function(other)
{
    return this.concat(other);
};

/** Sets this matrix rotation from a quaternion
 *  @param {VG.Math.Quat} q - The quaternion
 *  @return this */

VG.Math.Matrix4.prototype.setQuatRotation=function(q)
{
    var te = this.elements;

    var x = q.x;
    var y = q.y;
    var z = q.z;
    var w = q.w;

    var x2 = x + x;
    var y2 = y + y;
    var z2 = z + z;

    var xx = x * x2;
    var xy = x * y2;
    var xz = x * z2;

    var yy = y * y2;
    var yz = y * z2;
    var zz = z * z2;
    var wx = w * x2;
    var wy = w * y2;
    var wz = w * z2;

    te[0] = 1 - (yy + zz);
    te[4] = xy - wz;
    te[8] = xz + wy;

    te[1] = xy + wz;
    te[5] = 1 - (xx + zz);
    te[9] = yz - wx;

    te[2]  = xz - wy;
    te[6]  = yz + wx;
    te[10] = 1 - (xx + yy);

    te[3]  = 0;
    te[7]  = 0;
    te[11] = 0;

    te[12] = 0;
    te[13] = 0;
    te[14] = 0;
    te[15] = 1;

    return this;
};

/** Converts degrees to radians
 * @param {Number} deg - The degree value to convert
 */

VG.Math.rad=function(deg)
{
    return deg * (Math.PI / 180.0);
};

/** Converts radians to degrees
 *  @param {Number} rad - The radian value to convert
 */

VG.Math.deg=function(rad)
{
    return rad * (180.0 / Math.PI);
};

/** Float linear interpolation
 *  @param {Number} a - The value from
 *  @param {Number} b - The value to
 *  @param {Number} d - The alpha / time */

VG.Math.lerp=function(a, b, d)
{
    return a + (d * (b - a));
};

/** Clamps val between min and max.
 *  @param {Number} val - The value to clamp
 *  @param {Number} min - The minimum border
 *  @param {Number} max - The maximum border */

VG.Math.clamp=function(val, min, max)
{
    return Math.min(Math.max(val, min), max);
};

//TODO upgrade to use Vector2
VG.Math.testLine=function(vT, v0, v1)
{
    /** Tests if the given lines intersects */
    var x0 = vT.x - v0.x;
    var y0 = vT.y - v0.y;

    var x1 = v1.x - v0.x;
    var y1 = v1.y - v0.y;
    var x0y1 = x0 * y1;
    var x1y0 = x1 * y0;
    var det = x0y1 - x1y0;

    var zero = 0.0;
    return ( det > zero ? 1 : (det < zero ? -1 : 0) );
};

//TODO upgrade to use Vector2
VG.Math.testTri=function(ts, v0, v1, v2)
{
    /** Test if the given triangles intersects */
    var sign0 = VG.Math.testLine(ts, v1, v2);
    if (sign0 > 0) return 1;

    var sign1 = VG.Math.testLine(ts, v0, v2);
    if (sign1 < 0) return 1;

    var sign2 = VG.Math.testLine(ts, v0, v1);
    if (sign2 > 0) return 1;

    return (sign0 && sign1 && sign2) ? -1 : 0;
};

VG.Math.bezierCubic=function(t, p0, p1, p2, p3)
{
    function Bp0(t, p) { var k = 1 - t; return k * k * k * p; }
    function Bp1(t, p) { var k = 1 - t; return 3 * k * k * t * p; }
    function Bp2(t, p) { var k = 1 - t; return 3 * k * t * t * p; }

    function Bp3(t, p) { return t * t * t * p; }

    return Bp0(t, p0) + Bp1(t, p1) + Bp2(t, p2) + Bp3(t, p3);
};

VG.Math.bezier=function(t, p0, p1, p2)
{
    function Bp0(t, p) { var k = 1 - t; return k * k * p; }
    function Bp1(t, p) { return 2 * (1 - t) * t * p; }
    function Bp2(t, p) { return t * t * p; }

    return Bp0(t, p0) + Bp1(t, p1) + Bp2(t, p2);
};


/** Two-dimensional vector class
 *  @constructor
 *  @param {number} x
 *  @param {number} y
 */


VG.Math.Vector2=function(x, y)
{
    this.x = x ? x : 0.0;
    this.y = y ? y : 0.0;
};

/** Sets the vector from individual components
 *  @param {Number} x - The x component
 *  @param {Number} y - The y component
 */

VG.Math.Vector2.prototype.set=function(x, y)
{
    this.x = x;
    this.y = y;
};

/** Copies the vector
 *  @param {VG.Math.Vector2} other - The vector to copy from
 *  @returns this */

VG.Math.Vector2.prototype.copy=function(other)
{
    this.x = other.x;
    this.y = other.y;

    return this;
};

/** Returns a copy of this vector
 *  @returns VG.Math.Vector2 */

VG.Math.Vector2.prototype.clone=function()
{
    return new VG.Math.Vector2(this.x, this.y);
};

/** Adds the provided value into this vector
 *  @param {VG.Math.Vector2 | number} v - The value to add
 *  @returns this */

VG.Math.Vector2.prototype.add=function(v)
{
    if (v instanceof VG.Math.Vector2)
    {
        this.x += v.x;
        this.y += v.y;
    }
    else
    {
        this.x += v;
        this.y += v;
    }

    return this;
};

/** Substracts the provided value from this vector
 *  @param {VG.Math.Vector2 | number} v - The value to substract
 *  @returns this */

VG.Math.Vector2.prototype.sub=function(v)
{
    if (v instanceof VG.Math.Vector2)
    {
        this.x -= v.x;
        this.y -= v.y;
    }
    else
    {
        this.x -= v;
        this.y -= v;
    }

    return this;
};

/** Multiplies this vector by the provided value
 *  @param {VG.Math.Vector2 | number} v - The multiplier
 *  @returns this */

VG.Math.Vector2.prototype.mul=function(v)
{
    if (v instanceof VG.Math.Vector2)
    {
        this.x *= v.x;
        this.y *= v.y;
    }
    else
    {
        this.x *= v;
        this.y *= v;
    }

    return this;
};

/** Divides this vector by the provided value
 *  @param {VG.Math.Vector2 | number} v - The divisor
 *  @returns this */

VG.Math.Vector2.prototype.div=function(v)
{
    if (v instanceof VG.Math.Vector2)
    {
        this.x /= v.x;
        this.y /= v.y;
    }
    else
    {
        this.x /= v;
        this.y /= v;
    }

    return this;
};

/** Negates into a new vector
 *  @returns VG.Math.Vector2 */

VG.Math.Vector2.prototype.neg=function()
{
    return new VG.Vector2(-this.x, -this.y);
};

/** Dot product
 *  @param {VG.Math.Vector2} v - The other vector
 *  @returns number */

VG.Math.Vector2.prototype.dot=function(v)
{
    return this.x * v.x + this.y * v.y;
};

/** Vector length
 *  @returns number */

VG.Math.Vector2.prototype.length=function()
{
    return Math.sqrt(this.x * this.x + this.y * this.y);
};

/** Vector square length
 *  @returns number */

VG.Math.Vector2.prototype.lengthSq=function()
{
    return this.x * this.x + this.y * this.y;
};

/** Normalizes the vector, returns the inverse scalar
 *  @returns number */

VG.Math.Vector2.prototype.normalize=function()
{
    var invScal = 1 / this.length();

    this.mul(invScal);

    return invScal;
};

/** Returns a normalized copy of this vector
 *  @returns VG.Math.Vector2 */

VG.Math.Vector2.prototype.normalized=function()
{
    var v = this.clone();
    v.normalize();

    return v;
};

/** Returns the distance to the provided vector
 *  @param {VG.Math.Vector2} v - The other vector
 *  @returns number */

VG.Math.Vector2.prototype.dist=function(v)
{
    return Math.sqrt(this.distSq(v));
};

/** Returns the squared distance to the provided vector
 *  @param {VG.Math.Vector2} v - The other vector
 *  @returns number */

VG.Math.Vector2.prototype.distSq=function(v)
{
    var dx = this.x - v.x;
    var dy = this.y - v.y;

    return dx * dx + dy * dy;
};

/** Returns the quadratic angle in radians
 *  @params {VG.Math.Vector2} v - The other vector */

VG.Math.Vector2.prototype.angleTo=function(v)
{
    return Math.atan2(v.x - this.x, v.y - this.y);
};

VG.Math.Vector2.prototype.dirFromAngle=function(a)
{
    /** Returns the a normalized direction from a quadratic angle in radians
     *  @params {number} a - The angle in radians */

    this.y = Math.cos(a);
    this.x = Math.sin(a);

    return this;
};

/** Linearly interpolates to the provided vector
 *  @param {VG.Math.Vector2} v - The other vector
 *  @param {number} delta - The interpolation delta
 *  @returns this */

VG.Math.Vector2.prototype.lerp=function(v, delta)
{
    this.x += (v.x - this.x) * alpha;
    this.y += (v.y - this.y) * alpha;

    return this;
};

/** Applies floor function to this vector */

VG.Math.Vector2.prototype.floor=function()
{
    this.x = Math.floor(this.x);
    this.y = Math.floor(this.y);

    return this;
};

/** Applies ceil function to this vector */

VG.Math.Vector2.prototype.ceil=function()
{
    this.x = Math.ceil(this.x);
    this.y = Math.ceil(this.y);

    return this;
};

/** Applies round function to this vector */

VG.Math.Vector2.prototype.round=function()
{
    this.x = Math.round(this.x);
    this.y = Math.round(this.y);

    return this;
};

/** Sets this vector (direction) to its perpendicular form */

VG.Math.Vector2.prototype.setPerpendicular=function()
{
    var invX = -this.y;
    var invY = this.x;

    var length = this.length();

    this.x = invX / length;
    this.y = invY / length;
};

VG.Math.Vector2.Zero = new VG.Math.Vector2(0, 0);
VG.Math.Vector2.Up = new VG.Math.Vector2(1, 0);






/** Three-dimensional vector class
 *  @constructor
 *  @param {number} x
 *  @param {number} y
 *  @param {number} z
 */

VG.Math.Vector3=function(x, y, z)
{
    this.x = x ? x : 0.0;
    this.y = y ? y : 0.0;
    this.z = z ? z : 0.0;

};

/** Sets the vector values directly
 *  @param {number} x
 *  @param {number} y
 *  @param {number} z
 */

VG.Math.Vector3.prototype.set=function(x, y, z)
{
    this.x = x;
    this.y = y;
    this.z = z;

    return this;
};

/** Copies the vector
 *  @param {VG.Math.Vector3} other - The vector to copy from
 *  @returns this */

VG.Math.Vector3.prototype.copy=function(other)
{
    this.x = other.x;
    this.y = other.y;
    this.z = other.z;

    return this;
};

/**
 * Returns array of all components.
 *  @returns [x, y, z] */

VG.Math.Vector3.prototype.toArray = function()
{
    return [this.x, this.y, this.z];
};

/** set array of all components.
 *  @param [x, y, z] array - array to set
 */

VG.Math.Vector3.prototype.getArray = function(array)
{
  array[0] = this.x;
	array[1] = this.y;
	array[2] = this.z;
};

/** Returns a copy of this vector
 *  @returns VG.Math.Vector3 */

VG.Math.Vector3.prototype.clone=function()
{
    return new VG.Math.Vector3(this.x, this.y, this.z);
};

/** Adds the provided value into this vector
 *  @param {VG.Math.Vector3 | number} v - The value to add
 *  @returns this */

VG.Math.Vector3.prototype.add=function(v)
{
    if (v instanceof VG.Math.Vector3)
    {
        this.x += v.x;
        this.y += v.y;
        this.z += v.z;
    }
    else
    {
        this.x += v;
        this.y += v;
        this.z += v;
    }

    return this;
};

/** Adds the given vector multiplied
 *  @param {VG.Math.Vector3} v - The value to add
 *  @param {Number} m - The multiplier as vector3 * m
 *  @returns this */

VG.Math.Vector3.prototype.addMul=function(v, m)
{
    this.x += v.x * m;
    this.y += v.y * m;
    this.z += v.z * m;

    return this;
};

/** Substracts the provided value from this vector
 *  @param {VG.Math.Vector3 | number} v - The value to substract
 *  @returns this */

VG.Math.Vector3.prototype.sub=function(v)
{
    if (v instanceof VG.Math.Vector3)
    {
        this.x -= v.x;
        this.y -= v.y;
        this.z -= v.z;
    }
    else
    {
        this.x -= v;
        this.y -= v;
        this.z -= v;
    }

    return this;
};

/** Multiplies this vector by the provided value
 *  @param {VG.Math.Vector3 | number} v - The multiplier
 *  @returns this */

VG.Math.Vector3.prototype.mul=function(v)
{
    if (v instanceof VG.Math.Vector3)
    {
        this.x *= v.x;
        this.y *= v.y;
        this.z *= v.z;
    }
    else
    {
        this.x *= v;
        this.y *= v;
        this.z *= v;
    }

    return this;
};

/** Divides this vector by the provided value
 *  @param {VG.Math.Vector3 | number} v - The divisor
 *  @returns this */

VG.Math.Vector3.prototype.div=function(v)
{
    if (v instanceof VG.Math.Vector3)
    {
        this.x /= v.x;
        this.y /= v.y;
        this.z /= v.z;
    }
    else
    {
        this.x /= v;
        this.y /= v;
        this.z /= v;
    }

    return this;
};

/** Negates this vector */

VG.Math.Vector3.prototype.negate=function()
{
    this.x = -this.x;
    this.y = -this.y;
    this.z = -this.z;

    return this;
};

/** Negates into a new vector
 *  @returns VG.Math.Vector3 */

VG.Math.Vector3.prototype.negated=function()
{
    return this.clone().negate();
};

/** Dot product
 *  @param {VG.Math.Vector3} v - The other vector
 *  @returns number */

VG.Math.Vector3.prototype.dot=function(v)
{
    return this.x * v.x + this.y * v.y + this.z * v.z;
};

/** Vector length
 *  @returns number */

VG.Math.Vector3.prototype.length=function()
{
    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
};

/** Vector square length
 *  @returns number */

VG.Math.Vector3.prototype.lengthSq=function()
{
    return this.x * this.x + this.y * this.y + this.z * this.z;
};

/** Normalizes the vector, returns the inverse scalar
 *  @returns number */

VG.Math.Vector3.prototype.normalize=function()
{
    var invScal = 1 / this.length();

    this.mul(invScal);

    return invScal;
};

/** Sets the min value per component
 *  @param {VG.Math.Vector3} v - The vector
 *  @returns this */

VG.Math.Vector3.prototype.min=function(v)
{
    if (this.x > v.x) this.x = v.x;
    if (this.y > v.y) this.y = v.y;
    if (this.z > v.z) this.z = v.z;

    return this;
};

/** Sets the max value per component
 *  @param {VG.Math.Vector3} v - The vector
 *  @returns this */

VG.Math.Vector3.prototype.max=function(v)
{
    if (this.x < v.x) this.x = v.x;
    if (this.y < v.y) this.y = v.y;
    if (this.z < v.z) this.z = v.z;

    return this;
};

/** Returns a normalized copy of this vector
 *  @returns VG.Math.Vector3 */

VG.Math.Vector3.prototype.normalized=function()
{
    var v = this.clone();
    v.normalize();

    return v;
};

/** Returns the distance to the provided vector
 *  @param {VG.Math.Vector3} v - The other vector
 *  @returns number */

VG.Math.Vector3.prototype.dist=function(v)
{
    return Math.sqrt(this.distSq(v));
};

/** Returns the squared distance to the provided vector
 *  @param {VG.Math.Vector3} v - The other vector
 *  @returns number */

VG.Math.Vector3.prototype.distSq=function(v)
{
    var dx = this.x - v.x;
    var dy = this.y - v.y;
    var dz = this.z - v.z;

    return dx * dx + dy * dy + dz * dz;
};

/** Linearly interpolates to the provided vector
 *  @param {VG.Math.Vector3} v - The other vector
 *  @param {number} alpha - The interpolation alpha
 *  @returns this */

VG.Math.Vector3.prototype.lerp=function(v, alpha)
{
    this.x += (v.x - this.x) * alpha;
    this.y += (v.y - this.y) * alpha;
    this.z += (v.z - this.z) * alpha;

    return this;
};

/** Applies round function to this vector */

VG.Math.Vector3.prototype.round=function()
{
    this.x = Math.round(this.x);
    this.y = Math.round(this.y);
    this.z = Math.round(this.z);

    return this;
};

/* Computes the surface normal of the given three-dimmensional triangle
 * result is set into this vector.
 *
 * @param {VG.Math.Vector3} p1 - Point in a triangle
 * @param {VG.Math.Vector3} p2 - Point in a triangle
 * @param {VG.Math.Vector3} p2 - Point in a triangle */

VG.Math.Vector3.prototype.computeNormal=function(p1, p2, p3)
{
    var u = p2.clone().sub(p1);
    var v = p3.clone().sub(p1);

    this.x = (u.y * v.z) - (u.z * v.y);
    this.y = (u.z * v.x) - (u.x * v.z);
    this.z = (u.x * v.y) - (u.y * v.x);

    return this;
};

/**
 * Compute cross product from vectors, this cross B.
 * @param {VG.Math.Vector3} B - a vector
 */

VG.Math.Vector3.prototype.cross=function(B)
{
    var A = this;
    return new VG.Math.Vector3(
        A.y * B.z - A.z * B.y,
        A.z * B.x - A.x * B.z,
        A.x * B.y - A.y * B.x
    );
};

/** Transforms this vector by a matrix4
 *  @param {VG.Math.Matrix4}
 *  @returns this */

VG.Math.Vector3.prototype.transform=function(m, byVector)
{
    var p = [this.x, this.y, this.z];

    m.transformVectorArray(p, byVector);

    this.x = p[0];
    this.y = p[1];
    this.z = p[2];

	return this;
};

VG.Math.Vector3.Zero = new VG.Math.Vector3(0, 0, 0);
VG.Math.Vector3.Up = new VG.Math.Vector3(0, 1, 0);
VG.Math.Vector3.Right = new VG.Math.Vector3(1, 0, 0);
VG.Math.Vector3.Front = new VG.Math.Vector3(0, 0, -1);







/** Four-dimmensional vector (mostly used for matrix transform)
 *  @constructor
 *  @param {Number} x - The x component
 *  @param {Number} y - The x component
 *  @param {Number} z - The x component
 *  @param {Number} w - The x component */

VG.Math.Vector4=function(x, y, z, w)
{
    this.set(x, y, z, w);
};

/** Sets the vector
 *  @param {Number} x - The x component
 *  @param {Number} y - The x component
 *  @param {Number} z - The x component
 *  @param {Number} w - The x component */

VG.Math.Vector4.prototype.set=function(x, y, z, w)
{
    this.x = x;
    this.y = y;
    this.z = z;
    this.w = w;
};

/** Copies the vector
 *  @param {VG.Math.Vector4} other - The vector to copy from
 *  @returns this */

VG.Math.Vector4.prototype.copy=function(other)
{
    this.x = other.x;
    this.y = other.y;
    this.z = other.z;
    this.w = other.w;

    return this;
};

/** Transforms this vector by a matrix4
 *  @param {VG.Math.Matrix4}
 *  @returns this */

VG.Math.Vector4.prototype.transform=function(m)
{
    var p = [this.x, this.y, this.z, this.w];

    m.transformVectorArray(p);

    this.x = p[0];
    this.y = p[1];
    this.z = p[2];
    this.w = p[3];

    return this;
};

/** Returns array of all components.
 *  @returns [x, y, z, w] */

VG.Math.Vector4.prototype.toArray = function()
{
    return [this.x, this.y, this.z, this.w];
};

/** set array of all components.
 *  @param [x, y, z, w] array - array to set*/

VG.Math.Vector4.prototype.getArray = function(array)
{
    array[0] = this.x;
	array[1] = this.y;
	array[2] = this.z;
	array[3] = this.w;
};


/** Axis aligned bounding box
 *  @constructor */

VG.Math.Aabb=function()
{
    /** Minimum bounds vector
     *  @member {VG.Math.Vector3} */
    this.min = new VG.Math.Vector3();

    /** Minimum bounds vector
     *  @member {VG.Math.Vector3} */
    this.max = new VG.Math.Vector3();

    this.setEmpty();
};

/** Copies the given aabb into this
 *  @param {VG.Math.Aabb} other - The aabb to copy from
 *  @returns this */

VG.Math.Aabb.prototype.copy=function(other)
{
    this.min.copy(other.min);
    this.max.copy(other.max);

    return this;
};

/** Checks the validity of the bounds
 *  @return {Bool} */


VG.Math.Aabb.prototype.isValid=function()
{
    return this.min.length() > 0 || this.max.length() > 0;
};

/** Expands by the given value (Vector or another Aabb)
 *  @param {VG.Math.Vector3 | VG.Math.Vector4 | VG.Math.Aabb} v - The value */

VG.Math.Aabb.prototype.expand=function(v)
{
    if (v instanceof VG.Math.Vector3)
    {
        this.min.min(v);
        this.max.max(v);
    }
    else
    if (v instanceof VG.Math.Vector4)
    {
        var v3 = VG.Math.Aabb.__cacheV3;

        v3.copy(v);

        this.min.min(v3);
        this.max.max(v3);
    }
    else
    if (v instanceof VG.Math.Aabb)
    {
    }
    else
    {
        throw "Value not recognized or undefined";
    }
};

/** Sets the bounds from a half extent vector
 * @param {VG.Math.Vector3} halfExtent - The half extent vector */

VG.Math.Aabb.prototype.setFromHalfExtent=function(halfExtent)
{
    this.min.copy(halfExtent).negate();
    this.max.copy(halfExtent);
};

/** Sets the bounds from a center vector and a radius
 * @param {VG.Math.Vector3} center - Center vector */

VG.Math.Aabb.prototype.setFromCenterRadius=function(center, radius)
{
    var hE = radius;

    this.setHalfExtent(new VG.Math.Vector3(hE, hE, hE));

    this.min.add(center);
    this.max.add(center);
};

VG.Math.Aabb.__cacheV3 = new VG.Math.Vector3();

VG.Math.Aabb.__cacheV4Array = [
    new VG.Math.Vector4(),
    new VG.Math.Vector4(),
    new VG.Math.Vector4(),
    new VG.Math.Vector4(),
    new VG.Math.Vector4(),
    new VG.Math.Vector4(),
    new VG.Math.Vector4(),
    new VG.Math.Vector4()
];

/** Sets the bounds as empty/null
 *  @returns this */


VG.Math.Aabb.prototype.setEmpty=function()
{
    this.min.x = Infinity;
    this.min.y = Infinity;
    this.min.z = Infinity;

    this.max.x = -Infinity;
    this.max.y = -Infinity;
    this.max.z = -Infinity;

    return this;
};

/** Tests if the given Aabb overlaps with this bounds
 *  @param {VG.Math.Aabb} other - The other aabb
 *  @returns {Bool}*/

VG.Math.Aabb.prototype.overlaps=function(other)
{
    if (other.max.x < this.min.x || other.min.x > this.max.x ||
        other.max.y < this.min.y || other.min.y > this.max.y ||
        other.max.z < this.min.z || other.min.z > this.max.z)
    {
        return false;
    }

    return true;
};

/** Transforms the aabb by the given matrix
 *  @param {VG.Math.Matrix4} m - The matrix
 *  @returns this */

VG.Math.Aabb.prototype.transform=function(m)
{
    var p = VG.Math.Aabb.__cacheV4Array;

    p[0].set(this.min.x, this.min.y, this.min.z, 1.0);
    p[1].set(this.min.x, this.min.y, this.max.z, 1.0);
    p[2].set(this.min.x, this.max.y, this.min.z, 1.0);
    p[3].set(this.min.x, this.max.y, this.max.z, 1.0);
    p[4].set(this.max.x, this.min.y, this.min.z, 1.0);
    p[5].set(this.max.x, this.min.y, this.max.z, 1.0);
    p[6].set(this.max.x, this.max.y, this.min.z, 1.0);
    p[7].set(this.max.x, this.max.y, this.max.z, 1.0);

    this.setEmpty();

    for (var i = 0; i < p.length; i++)
    {
        this.expand(p[i].transform(m));
    }

    return this;
};

VG.Math.Aabb.prototype.sample=function()
{
    var svec=new VG.Math.Vector3();

    svec.x=this.min.x + (this.max.x - this.min.x) * Math.random();
    svec.y=this.min.y + (this.max.y - this.min.y) * Math.random();
    svec.z=this.min.z + (this.max.z - this.min.z) * Math.random();

    //VG.log( this.min.x, this.min.y, this.min.z, this.max.x, this.max.y, this.max.z );

    return svec;
};

/** Quaternion
 *
 *  @constructor
 *  @param {VG.Math.Quat} q - A quaternion to copy from
 *
 *  @constructor
 *  @param {Number} x - The x component
 *  @param {Number} y - The y component
 *  @param {Number} z - The z component
 *  @param {Number} w - The w component
 *
 *  @constructor
 *  @param {Number} yaw - Yaw in radians
 *  @param {Number} pitch - Pitch in radians
 *  @param {Number} roll - Roll in radians */

VG.Math.Quat=function()
{
    this.x = 0.0;
    this.y = 0.0;
    this.z = 0.0;
    this.w = 0.0;

    if (arguments.length == 1 && arguments[0] instanceof VG.Math.Quat)
    {
        this.copy(arguments[0]);
    }
    else
    if (arguments.length == 3)
    {
        this.setEuler(arguments[0], arguments[1], arguments[2]);
    }
    else
    if (arguments.length == 4)
    {
        this.x = arguments[0];
        this.y = arguments[1];
        this.z = arguments[2];
        this.w = arguments[3];
    }
    else
    {
        this.setIdentity();
    }
};

/** Clones this quaternion
 *  @return {VG.Math.Quat} */

VG.Math.Quat.prototype.clone=function()
{
    return new VG.Math.Quat(this);
};

/** Copies the provided quaternion into this one
 *  @param {VG.Math.Quat} other - The other quaternion
 *  @return this */

VG.Math.Quat.prototype.copy=function(other)
{
    this.x = other.x;
    this.y = other.y;
    this.z = other.z;
    this.w = other.w;

    return this;
};

/** Sets this quaternion angle axis
 *  @param {Number} angle - The angle in radians
 *  @param {VG.Math.Vector3} axis - The axis vector, normalized
 *  @return this */

VG.Math.Quat.prototype.setAxis=function(angle, axis)
{
    var hAngle = angle * 0.5;
    var s0 = Math.sin(hAngle);

    this.x = axis.x * s0;
    this.y = axis.y * s0;
    this.z = axis.z * s0;
    this.w = Math.cos(hAngle);

    return this;
};

/** Sets this quaternion from euler angles in radians
 *  @param {Number} yaw - Yaw in radians
 *  @param {Number} pitch - Pitch in radians
 *  @param {Number} roll- Roll in radians
 *  @return this */

VG.Math.Quat.prototype.setEuler=function(yaw, pitch, roll)
{
    //order hack
    var x = pitch;
    var y = yaw;
    var z = roll;

    var c1 = Math.cos(x * 0.5);
    var c2 = Math.cos(y * 0.5);
    var c3 = Math.cos(z * 0.5);

    var s1 = Math.sin(x * 0.5);
    var s2 = Math.sin(y * 0.5);
    var s3 = Math.sin(z * 0.5);

    this.x = s1 * c2 * c3 + c1 * s2 * s3;
    this.y = c1 * s2 * c3 - s1 * c2 * s3;
    this.z = c1 * c2 * s3 + s1 * s2 * c3;
    this.w = c1 * c2 * c3 - s1 * s2 * s3;

    return this;
};

/** Returns the length squared of this quaternion
 *  @return {Number} */

VG.Math.Quat.prototype.lengthSq=function()
{
    return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
};

/** Returns the length of this quaternion
 *  @return {Number} */

VG.Math.Quat.prototype.length=function()
{
    return Math.sqrt(this.lengthSq());
};

/** Inverses this quaternion in place
 *  @return this */

VG.Math.Quat.prototype.inverse=function()
{
    this.conj();
    this.normalize();

    return this;
};

/** Sets this quaternion as identity (0, 0, 0, 1) */

VG.Math.Quat.prototype.setIdentity=function()
{
    this.x = 0.0;
    this.y = 0.0;
    this.z = 0.0;
    this.w = 1.0;
};

/** Returns the dot product
 *  @param {VG.Math.Quat} other - The other quaternion
 *  @return {Number} */

VG.Math.Quat.prototype.dot=function(other)
{
    return this.x * other.x + this.y * other.y + this.z * other.z + this.w * other.w;
};

/** Normalizes this quaternion
 *  @return this */

VG.Math.Quat.prototype.normalize=function()
{
    var len = this.length();

    if (len === 0)
    {
        this.setIdentity();
    }
    else
    {
        this.x = this.x * len;
        this.y = this.y * len;
        this.z = this.z * len;
        this.w = this.w * len;
    }

    return this;
};

/** Multiplies two quaternions and sets the result into this quaternion
 *  @param {VG.Math.Quat} a = The A quaternion
 *  @param {VG.Math.Quat} b = The B quaternion
 *  @return this */

VG.Math.Quat.prototype.setMul=function(a, b)
{

    var ax = a.x;
    var ay = a.y;
    var az = a.z;
    var aw = a.w;

    var bx = b.x;
    var by = b.y;
    var bz = b.z;
    var bw = b.w;

    this.x = ax * bw + aw * bx + ay * bz - az * by;
    this.y = ay * bw + aw * by + az * bx - ax * bz;
    this.z = az * bw + aw * bz + ax * by - ay * bx;
    this.w = aw * bw - ax * bx - ay * by - az * bz;

    return this;
};

/** Multiplies against the provided quaternion
 *  @param {VG.Math.Quat} other - The other quaternion
 *  @return this */

VG.Math.Quat.prototype.mul=function(other)
{
    this.setMul(this, other);

    return this;
};

/** Multiplies against the provided quaternion in inverse order
 *  @param {VG.Math.Quat} other - The other quaternion
 *  @return this */

VG.Math.Quat.prototype.mulInv=function(other)
{
    this.setMul(other, this);

    return this;
};

/** Conjugates this quaternion
 *  @return this */

VG.Math.Quat.prototype.conj=function()
{

    this.x = this.x * -1.0;
    this.y = this.y * -1.0;
    this.z = this.z * -1.0;

    return this;
};

/** Rotates a vector
 *  @param {VG.Math.Vector3} vin - The vector to rotate
 *  @param {VG.Math.Vector3} [null] vout - If not null/undefined then vin is left untouched */

VG.Math.Quat.prototype.rotateVector=function(vin, vout)
{
    var vx = vin.x;
    var vy = vin.y;
    var vz = vin.z;

    var qx = this.x;
    var qy = this.y;
    var qz = this.z;
    var qw = this.w;

    var rx = qw * vx + qy * vz - qz * vy;
    var ry = qw * vy + qz * vx - qx * vz;
    var rz = qw * vz + qx * vy - qy * vx;
    var rw = -qx * vx - qy * vy - qz * vz;

    if (!vout)
    {
        vout = vin;
    }

    vout.x = rx * qw + rw * -qx + ry * -qz - rz * -qy;
    vout.y = ry * qw + rw * -qy + rz * -qx - rx * -qz;
    vout.z = rz * qw + rw * -qz + rx * -qy - ry * -qx;
};

/** Sphere-interpolates this quaternion against
 *  @param {VG.Math.Quat} qb - The other quaternion
 *  @param {Number} t - The alpha
 *  @return this */

VG.Math.Quat.prototype.slerp=function(qb, a)
{
    if (a === 0) return this;
    if (a === 1) return this.copy(qb);

    var x = this.x;
    var y = this.y;
    var z = this.z;
    var w = this.w;

    var chTheta = w * qb.w + x * qb.x + y * qb.y + z * qb.z;

    if (chTheta < 0)
    {
        this.x = -qb.x;
        this.y = -qb.y;
        this.z = -qb.z;
        this.w = -qb.w;

        chTheta = -chTheta;
    }
    else
    {
        this.copy(qb);
    }

    if (chTheta >= 1.0)
    {
        this.x = x;
        this.y = y;
        this.z = z;
        this.w = w;

        return this;
    }

    var hTheta = Math.acos(chTheta);
    var shTheta = Math.sqrt(1.0 - chTheta * chTheta);

    if (Math.abs(shTheta) < 0.001)
    {
        this.x = 0.5 * (x + this.x);
        this.y = 0.5 * (y + this.y);
        this.z = 0.5 * (z + this.z);
        this.w = 0.5 * (w + this.w);
    }

    var rA = Math.sin((1.0 - a) * hTheta) / shTheta;
    var rB = Math.sin(a * hTheta) / shTheta;

    this.x = x * rA + this.x * rB;
    this.y = y * rA + this.y * rB;
    this.z = z * rA + this.z * rB;
    this.w = w * rA + this.w * rB;

    return this;
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains classes related to the data model of Visual Graphics.
 * @namespace
 */

VG.Data = {};

VG.Data.Binding=function( object, path )
{
    if ( !(this instanceof VG.Data.Binding) ) return new VG.Data.Binding();

    this.object=object;
    this.path=path;
};

/**
 * The base class which handles value bindings between paths and their controllers.
 * @constructor
 */

VG.Data.Base=function( name, extension )
{
    if ( !(this instanceof VG.Data.Base) ) return new VG.Data.Base( name, extension );

    Object.defineProperty( this, "__vgName", {
        enumerable: false,
        writable: true
    });

    Object.defineProperty( this, "__vgExtension", {
        enumerable: false,
        writable: true
    });

	Object.defineProperty( this, "__vgControllerBindings", {
        enumerable: false,
        writable: true
    });

	Object.defineProperty( this, "__vgValueBindings", {
    	enumerable: false,
        writable: true
    });

    Object.defineProperty( this, "__vgUndo", {
        enumerable: false,
        writable: true
    });

    this.__vgName=name ? name : "";
    this.__vgExtension=extension ? extension : "";

    this.__vgControllerBindings=[];
    this.__vgValueBindings=[];
};

VG.Data.Base.prototype.addControllerForPath=function( controller, path )
{
	var binding=new VG.Data.Binding( controller, path );
	this.__vgControllerBindings.push( binding );
};

VG.Data.Base.prototype.addValueBindingForPath=function( object, path )
{
	var binding=new VG.Data.Binding( object, path );
	this.__vgValueBindings.push( binding );
};

VG.Data.Base.prototype.removeAllValueBindingsForPath=function( path )
{
    //console.log( "removeAllValueBindingsForPath", path );

    var array=[];

    for( var i=0; i < this.__vgValueBindings.length; ++i ) {
        var bind=this.__vgValueBindings[i];
        if ( path !== bind.path ) array.push( bind );
    }
    this.__vgValueBindings=array;
};

VG.Data.Base.prototype.controllerForPath=function( path )
{
	for( var i=0; i < this.__vgControllerBindings.length; ++i ) {
		var cont=this.__vgControllerBindings[i];
		if ( path === cont.path ) return cont;
	}
	return 0;
};

VG.Data.Base.prototype.valueBindingForPath=function( path )
{
    for( var i=0; i < this.__vgValueBindings.length; ++i ) {
        var valueBinding=this.__vgValueBindings[i];
        if ( path === valueBinding.path ) return valueBinding;
    }
    return 0;
};

VG.Data.Base.prototype.dataForPath=function( path )
{
    if ( path.indexOf( '.' ) === -1 ) return this[path];
    else {
    	var object=this.objectForPath( path );

    	if ( object ) {
	    	return object[this.valueSegmentOfPath(path)];
    	}
/*
        else {
            var controller=this.controllerForPath( path );

            if ( controller )
            {
                object=controller.object.selected;

                //console.log( controller.path );
                console.log( "dataForPath returning", controller.path, controller.object, controller.object.selected );
                return object[this.valueSegmentOfPath(path)];

                if ( !object ) return null;
                else return object;
            }
        }*/
    }

    return null;
};

/**
 * Stores a given value for the given path and creates an undo step. Widgets like a Checkbox widget use this function to store
 * user changes inside the model. However this function can also be used directly to store value changes.
 * @param {string} path - The path of the value to store.
 * @param {object} value - The data value to store inside the model.
 * @param {bool} noUndo - Optional, if true blocks the creation of an undo step for the value change.
 * @param {bool} forceStorage - Optional, if true forces storing of the value. Normally if the model value is the same as the new value
 * @param {undoText} undoText - An optional custom text for this undo step.
 * this function will not store it, however to make sure this value is always stored set forceStorage to true. This is useful for undo groups
 * where the initial value may be the same as in the model but other value changes inside the group will change values.
 * @returns {VG.Data.UndoItem} The undo item created for this data value step. To add further undo steps into this group just call addSubItem() on the
 * undo item.
 */

VG.Data.Base.prototype.storeDataForPath=function( { path, value, noUndo, forceStorage, undoText } = {} )
{
    var undo;
    if ( path.indexOf( '.' ) === -1 )
    {
        if ( this.__vgUndo && !noUndo ) undo=this.__vgUndo.pathValueAboutToChange( this, path, value, undefined, undoText );
        this[path]=value;
    } else
    {
    	var object=this.objectForPath( path );
    	if ( object ) {

            if ( object[this.valueSegmentOfPath(path)] !== value || forceStorage ) {

                if ( this.__vgUndo && !noUndo ) undo=this.__vgUndo.pathValueAboutToChange( this, path, value, undefined, undoText );
                object[this.valueSegmentOfPath(path)]=value;
            }
    	}
    }
    return undo;
};

VG.Data.Base.prototype.objectForPath=function( path )
{
	var parts=path.split( '.' );
	var object=null;
	var travelingPath="";

    for( var i=0; i < parts.length-1; ++i ) {
    	var segment=parts[i];

		if ( object ) travelingPath+=".";
		travelingPath+=segment;

		var controller=this.controllerForPath( travelingPath );
		if ( controller ) {
			object=controller.object.selected;
			if ( !object ) return null;
		} else return null;
    }

	return object;
};

VG.Data.Base.prototype.valueSegmentOfPath=function( path )
{
	if ( path.indexOf( '.' ) === -1 ) return path;

	var parts=path.split( '.' );
	return parts[parts.length-1];
};

/**
 * Update the top level bindings after the model changed from the outside, like after "New" and "Open" operations.
 * <br><br>
 */

VG.Data.Base.prototype.updateTopLevelBindings=function()
{
    for( i=0; i < this.__vgControllerBindings.length; ++i ) {
        var cont=this.__vgControllerBindings[i];

        if  ( cont.path.indexOf(".") === -1 ) {
            cont.object.selected=0;
        }

        if ( cont.object.modelChanged ) cont.object.modelChanged();
    }

    for( i=0; i < this.__vgValueBindings.length; ++i ) {
        var val=this.__vgValueBindings[i];

        if  ( val.path.indexOf(".") === -1 ) {
            val.object.valueFromModel( this.dataForPath( val.path ) );
        }
    }
};

VG.Data.Base.prototype.clearUndo=function( dontInvokeClearCallback )
{
    if ( this.__vgUndo )
        this.__vgUndo.clear( dontInvokeClearCallback );
};

/**
 * Data collections are used for storing any kind of application data. They can be accessed with their paths and bound to controllers.
 * @constructor
 * @augments VG.Data.Base
 * @tutorial Data Model
 */

VG.Data.Collection=function( name, extension )
{
    if ( !(this instanceof VG.Data.Collection) ) return new VG.Data.Collection( name, extension );

    VG.Data.Base.call( this, name, extension );
};

VG.Data.Collection.prototype=VG.Data.Base();

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * An undo item stores all data for one specific undo step inside an application. This class will be created by the data model of Visual Graphics.
 * @constructor
 */

VG.Data.UndoItem=function( undoObject, undoText )
{
    if ( !(this instanceof VG.Data.UndoItem) ) return new VG.Data.UndoItem( undoObject, undoText );

    this.text=undoText ? undoText : "Edit";

    this.undoObject=undoObject;
    this.subItems=[];

    this.visible=true;
};

/**
 * Adds a sub item to this undo item.
 * @param {string} path - The path of the sub item.
 * @param {string} path - The data value of the sub item.
 */

VG.Data.UndoItem.prototype.addSubItem=function( path, value )
{
    var subItem=this.undoObject.pathValueAboutToChange( this.collection, path, value, true );
    // this.collection.storeDataForPath( "cameraLookAt", value, true );

    this.subItems.push( subItem );
};

VG.Data.UndoItem.Type={ "ValueBased" : 0, "ControllerBased" : 1 };
VG.Data.UndoItem.ControllerAction={ "Add" : 0, "Remove" : 1, "MultipleChanges" : 2 , "Move" : 3, "NodeProperty" : 4, "NodeConnect" : 5, "NodeDisconnect" : 6, "NodeKeyAdd" : 7, "NodeKeyRemove" : 8,
     "NodeKeyChange" : 9, "NodeKeyMove" : 10, "NodeMarkInOutChange" : 11, "CustomUncompressed" : 101 };

VG.Data.Undo=function()
{
    if ( !(this instanceof VG.Data.Undo) ) return new VG.Data.Undo();

    //this.dataCollection=0;
    this.undoIsAvailable=false;
    this.redoIsAvailable=false;
    this.newIsAvailable=false;
    this.saveIsAvailable=false;

    this.undoWidgets=[];
    this.redoWidgets=[];
    this.newWidgets=[];
    this.saveWidgets=[];

    this.steps=[];
    this.stepIndex=0;

    this.maxSteps=25;
};

VG.Data.Undo.prototype.clear=function( dontInvokeClearCallback )
{
    this.steps=[];
    this.stepIndex=0;
    this.updateUndoRedoWidgets();

    if ( !dontInvokeClearCallback && this.callbackForClear )
        this.callbackForClear();
};

VG.Data.Undo.prototype.pathValueAboutToChange=function( collection, path, value, dontInstall, undoText )
{
    //console.log( "pathValueAboutToChange", path, value );

    var undo=VG.Data.UndoItem( this, undoText );

    undo.type=VG.Data.UndoItem.Type.ValueBased;

    undo.collection=collection;
    undo.path=path;
    undo.oldValue=collection.dataForPath( path );
    undo.newValue=value;
    undo.pathIndex=[];

    if ( path.indexOf( '.') !== -1 ) {
        var parts=path.split( '.' );
        var controllerPath="";

        for ( var i=0; i < parts.length-1; ++i ) {
            if ( i > 0 ) controllerPath+='.';
            controllerPath+=parts[i];

            controller=collection.controllerForPath( controllerPath ).object;
            if ( controller )
                undo.pathIndex.push( controller.indexOf( controller.selected ) );
            else VG.log( "Controller for path ", controllerPath, " not found!");
        }
    }

    // ---

    if ( !dontInstall ) {
        this.steps=this.steps.slice( 0, this.stepIndex );

        if ( this.stepIndex < this.maxSteps ) {
            this.stepIndex++;
            this.steps.push( undo );
        } else {

            if ( this.toBeDeleted ) {
                this.toBeDeleted.newValue._deleteCallback( this.toBeDeleted.newValue );
                this.toBeDeleted=undefined;
            }

            let toBeDeleted=this.steps.shift();

            if ( toBeDeleted && toBeDeleted.newValue && toBeDeleted.newValue._deleteCallback )
                this.toBeDeleted=toBeDeleted;

            this.steps.push( undo );
        }

        this.updateUndoRedoWidgets();
    }

    return undo;
};

VG.Data.Undo.prototype.controllerProcessedItem=function( controller, action, path, index, stringifiedItem, undoName )
{
    //console.log( "controllerProcessedItem", action, controller, path, index, stringifiedItem );

    var text="Edit";

    if ( action === VG.Data.UndoItem.ControllerAction.Add ) text="Add";
    else
    if ( action === VG.Data.UndoItem.ControllerAction.Remove ) text="Remove";
    else
    if ( action === VG.Data.UndoItem.ControllerAction.Move ) text="Move";
    if ( controller.undoObjectName ) text+=" " + controller.undoObjectName;

    if ( undoName ) text=undoName;

    var undo=VG.Data.UndoItem( undefined, text );

    undo.type=VG.Data.UndoItem.Type.ControllerBased;
    undo.action=action;

    undo.controller=controller;
    undo.path=path;
    undo.index=index;
    undo.stringifiedItem=stringifiedItem;
    undo.pathIndex=[];
    undo.collection=controller.collection;

    var collection=controller.collection;

    if ( ( typeof path === 'string' || path instanceof String ) && path.indexOf( '.') !== -1 ) {
        var parts=path.split( '.' );
        var controllerPath="";

        for ( var i=0; i < parts.length-1; ++i ) {
            if ( i > 0 ) controllerPath+='.';
            controllerPath+=parts[i];

            controller=collection.controllerForPath( controllerPath ).object;
            if ( controller )
                undo.pathIndex.push( controller.indexOf( controller.selected ) );
            else VG.log( "Controller for path ", controllerPath, " not found!");
        }
    }

    //---
    this.steps=this.steps.slice( 0, this.stepIndex );

    if ( this.stepIndex < this.maxSteps ) {
        this.stepIndex++;
        this.steps.push( undo );
    } else {
        // --- Reached the limit

            if ( this.toBeDeleted ) {
                this.toBeDeleted.newValue._deleteCallback( this.toBeDeleted.newValue );
                this.toBeDeleted=undefined;
            }

            let toBeDeleted=this.steps.shift();

            if ( toBeDeleted && toBeDeleted.newValue && toBeDeleted.newValue._deleteCallback )
                this.toBeDeleted=toBeDeleted;

        this.steps.push( undo );
    }
    this.updateUndoRedoWidgets();
};

VG.Data.Undo.prototype.undo=function()
{
    this.stepIndex--;
    var undo=this.steps[this.stepIndex];

    if ( undo.pathIndex.length )
        this.adjustPathIndex( undo );

    if ( undo.type === VG.Data.UndoItem.Type.ValueBased )
    {
        // --- Value Based

        var valueBinding=undo.collection.valueBindingForPath( undo.path );

        valueBinding.object.valueFromModel( undo.oldValue, true );
        undo.collection.storeDataForPath( { path : undo.path, value : undo.oldValue, noUndo : true } );

        for ( var i=0; i < undo.subItems.length; ++i ) {
            var subItem=undo.subItems[i];
            valueBinding=undo.collection.valueBindingForPath( subItem.path );

            valueBinding.object.valueFromModel( subItem.oldValue );
            undo.collection.storeDataForPath( { path : subItem.path, value : subItem.oldValue, noUndo : true } );
        }
    } else
    if ( undo.type === VG.Data.UndoItem.Type.ControllerBased )
    {
        // --- Controller Based: Add / Remove

        var item;
        if ( undo.action === VG.Data.UndoItem.ControllerAction.Add )
        {
            // --- This was an Add action, in the undo step we have to remove this item.

            item=undo.controller.at( undo.index );
            undo.controller.remove( item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.Remove )
        {
            // --- This was an Remove action, in the undo step restore the item.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.insert( undo.index, item, true );
            undo.controller.selected=item;
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.MultipleChanges )
        {
            // --- Apply the changes for multiple items

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.applyMultipleChanges( item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.Move )
        {
            // --- Apply the changes for move

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.move( item.undo.sourceIndex, item.undo.destIndex, item.undo.mode, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeProperty )
        {
            // --- Node Property action.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.changeProperty( undo.index, undo.path, item.oldValue, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeConnect )
        {
            item=JSON.parse( undo.stringifiedItem );
            undo.controller.disconnect( undo.index, undo.path, item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeDisconnect )
        {
            item=JSON.parse( undo.stringifiedItem );
            undo.controller.connect( undo.index, undo.path, item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyAdd )
        {
            // --- Node KeyAdd action.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.keyRemove( undo.index, undo.path, item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyRemove )
        {
            // --- Node KeyRemove action.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.keyAdd( undo.index, undo.path, item.key, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyChange )
        {
            // --- Node KeyChange action.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.keyChange( undo.index, undo.path, JSON.parse( item.oldValue ), true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyMove )
        {
            // --- Node KeyMove action.

            item = JSON.parse( undo.stringifiedItem );
            undo.controller.keyMove( undo.index, undo.path, item.oldPos, item.newPos, item.name, item.value, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeInOutChange )
        {
            // --- Node InOut Change action.

            item=JSON.parse( undo.stringifiedItem );
            var object = undo.controller.at( undo.index );
            var data = item.oldValue;

            if ( data.inFrames !== undefined ) object.inTime.setTotalFrames( data.inFrames );
            if ( data.outFrames !== undefined ) object.outTime.setTotalFrames( data.outFrames );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.CustomUncompressed )
        {
            undo.controller.customUncompressed( undo.stringifiedItem, true );
        }
    }

    this.updateUndoRedoWidgets();

    if ( this.callbackForUndoRedo )
        this.callbackForUndoRedo( undo.path );
};

VG.Data.Undo.prototype.redo=function()
{
    var undo=this.steps[this.stepIndex];
    this.stepIndex++;

    if ( undo.type === VG.Data.UndoItem.Type.ValueBased ) {

        if ( undo.pathIndex.length )
            this.adjustPathIndex( undo );

        var valueBinding=undo.collection.valueBindingForPath( undo.path );

        valueBinding.object.valueFromModel( undo.newValue, false );
        undo.collection.storeDataForPath( { path : undo.path, value : undo.newValue, noUndo : true } );

        for ( var i=0; i < undo.subItems.length; ++i ) {
            var subItem=undo.subItems[i];
            valueBinding=undo.collection.valueBindingForPath( subItem.path );

            valueBinding.object.valueFromModel( subItem.newValue );
            undo.collection.storeDataForPath( { path : subItem.path, value : subItem.newValue, noUndo : true } );
        }
    } else
    if ( undo.type === VG.Data.UndoItem.Type.ControllerBased )
    {
        // --- Controller Based: Add / Remove

        var item;
        if ( undo.action === VG.Data.UndoItem.ControllerAction.Add )
        {
            // --- This was an Add action, in the redo step restore the item.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.insert( undo.index, item, true );
            undo.controller.selected=item;
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.Remove )
        {
            // --- This was an Remove action, in the redo step we have to remove this item.

            item=undo.controller.at( undo.index );
            undo.controller.remove( item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.MultipleChanges )
        {
            // --- Apply the changes for multiple items

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.applyMultipleChanges( item, false );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.Move )
        {
            // --- Apply move

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.move( item.redo.sourceIndex, item.redo.destIndex, item.redo.mode, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeProperty )
        {
            // --- Node Property action.

            item=JSON.parse( undo.stringifiedItem );

            undo.controller.changeProperty( undo.index, undo.path, item.newValue, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeConnect )
        {
            item=JSON.parse( undo.stringifiedItem );
            undo.controller.connect( undo.index, undo.path, item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeDisconnect )
        {
            item=JSON.parse( undo.stringifiedItem );
            undo.controller.disconnect( undo.index, undo.path, item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyAdd )
        {
            // --- Node KeyAdd action.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.keyAdd( undo.index, undo.path, item, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyRemove )
        {
            // --- Node KeyRemove action.

            item=JSON.parse( undo.stringifiedItem );
            if ( !item.newKey ) undo.controller.keyRemove( undo.index, undo.path, item.key, true );
            else undo.controller.keyRemove( undo.index, item.keyName, item.key, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyChange )
        {
            // --- Node KeyChange action.

            item=JSON.parse( undo.stringifiedItem );
            undo.controller.keyChange( undo.index, undo.path, JSON.parse( item.newValue ), true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeKeyMove )
        {
            // --- Node KeyMove action.

            item = JSON.parse( undo.stringifiedItem );
            undo.controller.keyMove( undo.index, undo.path, item.newPos, item.oldPos, item.name, item.value, true );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.NodeInOutChange )
        {
            // --- Node InOut Change action.

            item=JSON.parse( undo.stringifiedItem );
            var object = undo.controller.at( undo.index );
            var data = item.newValue;
            if ( data.inFrames ) object.inTime.setTotalFrames( data.inFrames );
            if ( data.outFrames ) object.outTime.setTotalFrames( data.outFrames );
        } else
        if ( undo.action === VG.Data.UndoItem.ControllerAction.CustomUncompressed )
        {
            undo.controller.customUncompressed( undo.stringifiedItem, false );
        }
    }

    this.updateUndoRedoWidgets();

    if ( this.callbackForUndoRedo )
        this.callbackForUndoRedo( undo.path );
};

VG.Data.Undo.prototype.adjustPathIndex=function( undo )
{
    var parts=undo.path.split( '.' );
    var controllerPath="";

    for( var i=0; i < parts.length-1; ++i )
    {
        if ( i > 0 ) controllerPath+=".";
        controllerPath+=parts[i];

        var controller=undo.collection.controllerForPath( controllerPath ).object;

        if ( controller ) {
            if ( controller.indexOf( controller.selected ) !== undo.pathIndex[i] )
                controller.selected=controller.at( undo.pathIndex[i] );
        }
    }
};

VG.Data.Undo.prototype.addUndoWidget=function( widget )
{
    widget.disabled=!this.undoIsAvailable;
    widget.clicked=this.undo.bind( this );

    if ( this.undoWidgets.indexOf( widget ) == -1 )
        this.undoWidgets.push( widget );
};

VG.Data.Undo.prototype.addRedoWidget=function( widget )
{
    widget.disabled=!this.redoIsAvailable;
    widget.clicked=this.redo.bind( this );

    if ( this.redoWidgets.indexOf( widget ) == -1 )
        this.redoWidgets.push( widget );
};

VG.Data.Undo.prototype.addNewWidget=function( widget )
{
    widget.disabled=false;//!this.undoIsAvailable;
    this.newWidgets.push( widget );
};

VG.Data.Undo.prototype.addSaveWidget=function( widget )
{
    widget.disabled=!this.undoIsAvailable;
    this.saveWidgets.push( widget );
};

VG.Data.Undo.prototype.updateUndoRedoWidgets=function()
{
    this.undoIsAvailable = Boolean( this.stepIndex );
    for( var i=0; i < this.undoWidgets.length; ++i ) {
        this.undoWidgets[i].disabled=!this.undoIsAvailable;
    }

    this.redoIsAvailable=this.stepIndex < this.steps.length ? true : false;
    for( i=0; i < this.redoWidgets.length; ++i ) {
        this.redoWidgets[i].disabled=!this.redoIsAvailable;
    }

    this.newIsAvailable = Boolean( this.undoIsAvailable );
    for( i=0; i < this.newWidgets.length; ++i ) {
        this.newWidgets[i].disabled=false;//!this.newIsAvailable;
    }

    this.saveIsAvailable = this.newIsAvailable;
    for( i=0; i < this.saveWidgets.length; ++i ) {
        if ( this.saveWidgets[i].role === VG.UI.ActionItemRole.Save )
        {
            // --- Save
            if ( this.saveIsAvailable && VG.context.workspace.filePath )
                this.saveWidgets[i].disabled=false;
            else this.saveWidgets[i].disabled=true;
        } else
        {
            // --- SaveAs
            this.saveWidgets[i].disabled=!this.saveIsAvailable;
        }
    }

    // --- Set the Electron State
    if ( VG.context.workspace.isElectron() ) {
        const win = require('electron').remote.getCurrentWindow();
        const Menu = require('electron').remote.Menu;
        const ipc = require('electron').ipcRenderer;

        // --- Set Document State
        win.setDocumentEdited( this.undoIsAvailable );
        ipc.send( 'document-state-change', { id: win.id, state: this.undoIsAvailable } );

        // --- Set the Undo/Redo Menu Items disabled state
        const menu = Menu.getApplicationMenu();
        for( let i =0; i < menu.items.length; ++i ) {
            let m = menu.items[i];

            if ( m.label === "Edit" ) {
                m = m.submenu;
                for ( let k = 0; k < m.items.length; ++k ) {
                    let item = m.items[k];
                    if ( item.label === "Undo" ) item.enabled = this.undoIsAvailable;
                    else
                    if ( item.label === "Redo" ) item.enabled = this.redoIsAvailable;
                }
            } else
            if ( m.label === "File" ) {
                m = m.submenu;
                for ( let k = 0; k < m.items.length; ++k ) {
                    let item = m.items[k];
                    if ( item.label === "Save" ) item.enabled = Boolean( this.saveIsAvailable && VG.context.workspace.filePath );
                    else
                    if ( item.label === "Save As..." ) item.enabled = Boolean( this.saveIsAvailable );
                }
            }
        }
    }

    VG.setHostProperty( VG.HostProperty.ProjectChangedState, this.newIsAvailable );
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains the controllers of the data model of Visual Graphics.
 * @namespace
 */

VG.Controller = {};

VG.Controller.Observer=function( func, context )
{
    if ( !(this instanceof VG.Controller.Observer) ) return new VG.Controller.Observer();

    this.func=func;

    if ( context === undefined ) this.context=VG.context;
    else this.context=context;
};

/**
 * The base class for all controllers. Implements observer handling.
 * @constructor
 */

VG.Controller.Base=function()
{
    if ( !(this instanceof VG.Controller.Base) ) return new VG.Controller.Base();

    this.observerKeys=[];
};

VG.Controller.Base.prototype.addObserverKey=function( key )
{
	this[key]=[];
	this.observerKeys.push( key );
};

/**
 * Adds an observer to the controller.
 * @param {string} key - The observer key
 * @param {function} func - The callback function.
 */

VG.Controller.Base.prototype.addObserver=function( key, func, context )
{
	if ( this.observerKeys.indexOf( key ) !== -1 ) {
		this[key].push( new VG.Controller.Observer( func, context ) );
	}
};

VG.Controller.Base.prototype.notifyObservers=function( key, arg )
{
    var binding, i;
	if ( this.observerKeys.indexOf( key ) !== -1 ) {
		for( i=0; i < this[key].length; ++i ) {
			var observer=this[key][i];
			observer.func.call( observer.context, arg );
		}
	}

	if ( key === "selectionChanged" ) {
		// --- Now search all value bindings depending on this controller and send an update message to those who need to be updated.

		for ( i=0; i < this.collection.__vgValueBindings.length; ++i ) {
			binding=this.collection.__vgValueBindings[i];

			if ( binding.path.indexOf( this.path ) === 0 ) {
				// --- This binding starts with our controller path

				var restPath=binding.path.slice( this.path.length );
				if ( restPath[0] === '.' ) {
					// --- Sanity Check for the '.' (which represents this controller)
					restPath=restPath.slice( 1, restPath.length );

					if ( restPath.indexOf( '.' ) === -1 ) {
						// --- The path does not contain any more dots / controllers, update the value

						if ( binding.object.isWidget ) {
							// --- Set the value to the binding object
							if ( !this.selected ) binding.object.valueFromModel( null );
							else
                            if ( this.selected.hasOwnProperty( restPath ) ) {
                                binding.object.valueFromModel( this.selected[restPath] );
                            }
						}
					}
				}
			}
		}

        // --- Now search all the controller bindings and notify controller in the path that their parent path has changed

        for ( i=0; i < this.collection.__vgControllerBindings.length; ++i ) {
            binding=this.collection.__vgControllerBindings[i];

            if ( this.path != binding.path && binding.path.indexOf( this.path ) === 0 ) {
                // --- This binding starts with our controller path
                binding.object.notifyObservers( "parentSelectionChanged" );
            }
        }
	}
};

VG.Controller.Base.prototype.modelChanged=function( forceRenew )
{
    var data=this.collection.dataForPath( this.path );
    if ( !data ) return;

    for( let i=0; i < data.length; ++i ) {
        let item=data[i];

        this.notifyObservers( "addItem", item );
    }

    this.notifyObservers( "changed" );
};

/**
 * Creates an array controller which handles objects inside a flat array.</br>
 * You will not need to create this controller yourself, it is mostly returned by widgets like {@link VG.UI.ListWidget}.
 * </br>Supports the following observer keys: "parentSelectionChanged", "selectionChanged", "changed", "addItem", "removeItem".
 * @property {object} selected - The currently selected object.
 * @property {array} selection - The currently selected objects when <i>multiSelection</i> is on.
 * @property {bool} multiSelection - Set to true if this controller should handle multiple selections, default is false.
 * @property {number} length - The number of items managed by the controller (read-only).
 * @constructor
 * @tutorial Data Model
 * @augments VG.Controller.Base
 */

VG.Controller.Array=function( collection, path )
{
    if ( !(this instanceof VG.Controller.Array) ) return new VG.Controller.Array( collection, path );

    VG.Controller.Base.call( this );

    this.collection=collection;
    this.path=path;
    this.contentClassName="";

    // ---

    this.multiSelection=false;

    this._selected=0;
    this.selection=[];

    // --- Init possible OberverKeys

    this.addObserverKey( "parentSelectionChanged" );
    this.addObserverKey( "selectionChanged" );
    this.addObserverKey( "changed" );
    this.addObserverKey( "addItem" );
    this.addObserverKey( "removeItem" );
};

VG.Controller.Array.prototype=VG.Controller.Base();

Object.defineProperty( VG.Controller.Array.prototype, "length",
{
    get: function() {
    	var array=this.collection.dataForPath( this.path );
        if ( array ) return array.length;
        else return 0;
    }
});

VG.Controller.Array.prototype.count=function( selOnly )
{
    if ( !selOnly ) return this.length;

    var array=this.collection.dataForPath( this.path );
    if ( !array ) return 0;

    var count=0;

    array.forEach( function( item ) {
        if ( item.visible ) count++;
    }.bind( this ) );

    return count;
};

/**
 * Returns the object at the given index
 * @param {string} index - The index of the object.
 * @returns {object} The object at the given index.
 */

VG.Controller.Array.prototype.at=function( index )
{
    var array=this.collection.dataForPath( this.path );

    if ( index < 0 || index >= array.length ) return undefined;

    return array[index];
};

/**
 * Adds an object to the controller.
 * Triggers installed "addItem" observers.
 * @param {object} item - The object to add. Item can be undefined if you set the <i>contentClassName</i> property of the controller.
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Array.prototype.add=function( item, noUndo )
{
    var array=this.collection.dataForPath( this.path );
    item.visible=true;

    if ( item === undefined && this.contentClassName.length ) {
    	item=this.create( this.contentClassName );
    }

    this.notifyObservers( "addItem", item );

    array.push( item );

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Add, this.path, array.length-1, JSON.stringify( item ) );

	this.notifyObservers( "changed" );

    return item;
};

/**
 * Insert an object to the controller.
 * Triggers installed "addItem" observers.
 * @param {number} index - The index position to insert the object at.
 * @param {object} item - The object to add. Item can be undefined if you set the <i>contentClassName</i> property of the controller.
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Array.prototype.insert=function( index, item, noUndo )
{
    var array=this.collection.dataForPath( this.path );
    item.visible=true;

    if ( item === undefined && this.contentClassName.length ) {
        item=this.create( this.contentClassName );
    }

    this.notifyObservers( "addItem", item );

    array.splice( index, 0, item );

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Add, this.path, index, JSON.stringify( item ) );

    this.notifyObservers( "changed" );
    return item;
};

/**
 * Removes an object from the controller.
 * Triggers installed "removeItem" observers.
 * @param {object} item - The object to remove.
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Array.prototype.remove=function( item, noUndo )
{
    var array=this.collection.dataForPath( this.path );

    this.notifyObservers( "removeItem", item );

    var index=array.indexOf( item );
    if ( index >= 0 )
        array.splice( index, 1 );

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Remove, this.path, index, JSON.stringify( item ) );

	this.notifyObservers( "changed" );

    if ( index-1 < array.length && index-1 >= 0 )
    	this.selected=array[index-1];
    else
        this.selected=array[index];

    this.removeFromSelection( item );
};

VG.Controller.Array.prototype.create=function( strClass )
{
    var args = Array.prototype.slice.call(arguments, 1);
    var clsClass = eval( strClass );

    function F() {
        return clsClass.apply(this, args);
    }
    F.prototype = clsClass.prototype;

    return new F();
};

Object.defineProperty( VG.Controller.Array.prototype, "selected",
{
    get: function() {
        return this._selected;
    },
    set: function( selected ) {
    	if ( this._selected !== selected ) {

        	this._selected=selected;
        	this.selection=[];

        	if ( selected ) {
        		this.selection.push( selected );
        	}

	        this.notifyObservers( "selectionChanged" );
        }
    }
});

/**
 * Adds an object to the selection.
 * @param {object} item - The object to add to the selection.
 */

VG.Controller.Array.prototype.addToSelection=function( item )
{
	if ( !this._selected ) this._selected=item;

    var index=this.selection.indexOf( item );
    if ( index === -1 && item )
		this.selection.push( item );

	this.notifyObservers( "selectionChanged" );
};

/**
 * Removes an object from the selection.
 * @param {object} item - The object to remove from the selection.
 */

VG.Controller.Array.prototype.removeFromSelection=function( item )
{
	if ( this._selected === item ) this._selected=0;

    var index=this.selection.indexOf( item );
    if ( index >= 0 )
    {
        this.selection.splice( index, 1 );

     //   if ( this.selectionChanged )
     //       this.selectionChanged.call( VG.context );
    }

	if ( this._selected === 0 && this.selection.length ) {
		this._selected=this.selection[0];
	}

	this.notifyObservers( "selectionChanged" );
};

/**
 * Returns true if the given object is selected.
 * @param {object} item - The object to check for selection.
 * @returns {bool} True if the item is selected, false otherwise.
 */

VG.Controller.Array.prototype.isSelected=function( item )
{
    var index=this.selection.indexOf( item );

    if ( index === -1 ) return false;
    else return true;
};

VG.Controller.Array.prototype.setSelected=function( item )
{
    this.selected=item;
};

/**
 * Returns true if you can remove the current item, i.e. if it is non null.
 * @returns {bool} True if you can remove the current item.
 */

VG.Controller.Array.prototype.canRemove=function()
{
	if ( this.selected ) return true;
	else return false;
};

/**
 * Returns the index of the item.
 * @param {object} item - The object to get the index for.
 * @returns {number} The index of the object.
 */

VG.Controller.Array.prototype.indexOf=function( item )
{
    var array=this.collection.dataForPath( this.path );
    return array.indexOf( item );
};

VG.Controller.Array.prototype.applyUndoForMultipleChanges=function( item, undoName )
{
    if ( this.collection.__vgUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.MultipleChanges,
            this.path, -1, JSON.stringify( item ), undoName );
};

VG.Controller.Array.prototype.applyMultipleChanges=function( undoItem, undo )
{
    var values=undo ? undoItem.oldValues : undoItem.newValues;

    if ( undoItem.parentControllerPath ) {
        // --- Adjust selection of parentController if necessary
        var parentController=this.collection.controllerForPath( undoItem.parentControllerPath );
        parentController.object.selected=parentController.object.at( undoItem.parentIndex );
    }

    for ( var i=0; i < values.length; ++i )
    {
        var object=values[i];
        var item=this.at( object._index );

        for ( var p=0; p < undoItem.propertyNames.length; ++p )
        {
            var propName=undoItem.propertyNames[p];
            item[propName]=object[propName];
        }
    }
};

/**
 * Creates an array controller which handles nested object hierarchies.</br>
 * Note that index locations for this controller are not numbers but string, like "0.1" or "" to indicate the root level.
 * You will not need to create this controller yourself, it is mostly returned by widgets like {@link VG.UI.TreeWidget}.
 * </br>Supports the following observer keys: "selectionChanged", "changed", "addItem", "removeItem".
 * @property {object} selected - The currently selected object.
 * @property {array} selection - The currently selected objects when <i>multiSelection</i> is on.
 * @property {bool} multiSelection - Set to true if this controller should handle multiple selections, default is false.
 * @property {number} length - The number of items managed by the controller (read-only).
 * @constructor
 * @tutorial Data Model
 * @augments VG.Controller.Base
 */

VG.Controller.Tree=function( collection, path )
{
    if ( !(this instanceof VG.Controller.Tree) ) return new VG.Controller.Tree( collection, path );

    VG.Controller.Base.call( this );

    this.collection=collection;
    this.path=path;
    this.contentClassName="";

    // ---

    this.multiSelection=false;

    this._selected=0;
    this.selection=[];

    // --- Init possible OberverKeys

    this.addObserverKey( "selectionChanged" );
    this.addObserverKey( "changed" );
    this.addObserverKey( "addItem" );
    this.addObserverKey( "removeItem" );
};

VG.Controller.Tree.prototype=VG.Controller.Base();

Object.defineProperty( VG.Controller.Tree.prototype, "length",
{
    get: function() {
        var array=this.collection.dataForPath( this.path );
        if ( !array ) return 0;
        return array.length;
    }
});

/**
 * Returns the object at the given index
 * @param {string} index - The index of the object.
 * @returns {object} The object at the given index.
 */

VG.Controller.Tree.prototype.at=function( index )
{
    var array=this.collection.dataForPath( this.path );

    var item=0;
    var pathArray;

    index=index.toString();

    if ( index.indexOf( "." ) === -1 )
    {
        item=array[Number(index)];
    } else
    {
        pathArray=index.split( "." );
    }

    if ( !item )
    {
        if ( !pathArray ) return undefined;
        for( var i=0; i < pathArray.length; ++i )
        {
            if ( i === 0 )
            {
                item=array[ pathArray[i] ];
            } else
            {
                item=item.children[ pathArray[i] ];
            }
        }
    }

    return item;
};

/**
 * Adds an object to the controller.
 * Triggers installed "addItem" observers.
 * @param {object} item - The object to add. Item can be undefined if you set the <i>contentClassName</i> property of the controller.
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Tree.prototype.add=function( index, item, noUndo )
{
    var array=this.collection.dataForPath( this.path );

    if ( item === undefined && this.contentClassName.length ) {
        item=this.create( this.contentClassName );
    }

    this.notifyObservers( "addItem", item );

    // --- Add the item

    var itemIndex;

    if ( index === "" )
    {
        // --- New top level item
        array.push( item );
        itemIndex=String( array.length-1 );
    }
    else
    {
        var pathArray;

        if ( index.indexOf( "." ) === -1 )
        {
            pathArray=[];
            pathArray.push( index );
        } else
        {
            pathArray=index.split( "." );
        }

        var obj=array;

        for( var i=0; i < pathArray.length; ++i )
        {
            if ( i === 0 )
            {
                obj=array[ pathArray[i] ];
            } else
            {
                obj=obj.children[ pathArray[i] ];
            }
        }

        obj.children.push( item );
        itemIndex=String(index) + "." + String(obj.children.length-1);
    }

    // ---


    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Add, this.path, itemIndex, JSON.stringify( item ) );

    this.notifyObservers( "changed" );
    return item;
};

/**
 * Insert an object to the controller.
 * Triggers installed "addItem" observers.
 * @param {number} index - The index position to insert the object at.
 * @param {object} item - The object to add. Item can be undefined if you set the <i>contentClassName</i> property of the controller.
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Tree.prototype.insert=function( index, item, noUndo )
{
    var array=this.collection.dataForPath( this.path );

    if ( item === undefined && this.contentClassName.length ) {
        item=this.create( this.contentClassName );
    }

    this.notifyObservers( "addItem", item );

    // --- Insert the item

    var done=false;

    if ( index === "" )
        array.push( item );
    else {
        var pathArray;

        if ( index.indexOf( "." ) === -1 )
        {
            array.splice( Number(index), 0, item );
        } else
        {
            pathArray=index.split( "." );

            var obj=array;

            for( var i=0; i < pathArray.length-1; ++i )
            {
                if ( i === 0 )
                {
                    obj=array[ pathArray[i] ];
                } else
                {
                    obj=obj.children[ pathArray[i] ];
                }
            }

            obj.children.splice( Number(pathArray[pathArray.length-1]), 0, item );
        }
    }

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Add, this.path, index, JSON.stringify( item ) );

    this.notifyObservers( "changed" );
    return item;
};

/**
 * Removes an object from the controller.
 * Triggers installed "removeItem" observers.
 * @param {object} item - The object to remove.
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Tree.prototype.remove=function( item, noUndo )
{
    var array=this.collection.dataForPath( this.path );

    this.notifyObservers( "removeItem", item );

    var index=this.indexOf( item );
    var itemArray=this.arrayOfItem( item );
    var itemIndex=itemArray.indexOf( item );

    if ( itemArray )
    {
        itemArray.splice( itemArray.indexOf( item ), 1 );

        if ( this.collection.__vgUndo && !noUndo )
            this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Remove, this.path, index, JSON.stringify( item ) );

        this.notifyObservers( "changed" );
        this.removeFromSelection( item );

        itemIndex-=1;
        if ( itemArray.length ) {
            if ( itemIndex >= 0 ) this.selected=itemArray[itemIndex];
            this.selected=itemArray[0];
        }
    }
};

/**
 * Moves an object from one index to another index.
 * @param {string} sourceIndex - The source index of the item.
 * @param {string} destIndex - The destination index of the item.
 * @param {number} mode - 0 noop, 1 below on same hierarchy, 2 new child (expand hierachy)
 * @param {bool} noUndo - Set to true if you don't want to trigger an undo step for this action inside the data model. Default is false.
 */

VG.Controller.Tree.prototype.move=function( sourceIndex, destIndex, mode, noUndo )
{
    // --- mode: 0 noop, 1 below on same hierarchy, 2 new child (expand hierachy)

    var undoItem={
        undo : { sourceIndex : destIndex, destIndex : sourceIndex, mode : 0 },
        redo : { sourceIndex : sourceIndex, destIndex : destIndex, mode : mode },
    };

    var sourceItem=this.at( sourceIndex );
    var sourceArray=this.arrayOfItem( sourceItem );
    var destItem=this.at( destIndex );

    sourceArray.splice( sourceArray.indexOf( sourceItem ), 1 );

    if ( mode === 0 || mode === 1 )
    {
        // --- Stays in same hierarchy
        var destArray=this.arrayOfItem( destItem );
        destIndex=destArray.indexOf( destItem );
        if ( mode === 1 ) destIndex++;

        destArray.splice( destIndex, 0, sourceItem );
    } else
    {
        // --- Add as a new child

        var testIndexItem=this.indexOf( destItem );

        if ( testIndexItem !== destIndex && testIndexItem )
            destIndex = testIndexItem;

        if ( !noUndo )
        {
            destIndex+=".0";

            undoItem.undo.sourceIndex=destIndex;
            undoItem.redo.destIndex=destIndex;
            undoItem.undo.mode=mode;
        }

        this.insert( destIndex, sourceItem, true );
    }

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Move, this.path, sourceIndex,
            JSON.stringify( undoItem  ) );
};

VG.Controller.Tree.prototype.create=function( strClass )
{
    var args = Array.prototype.slice.call(arguments, 1);
    var clsClass = eval( strClass );

    function F() {
        return clsClass.apply(this, args);
    }
    F.prototype = clsClass.prototype;

    return new F();
};

Object.defineProperty( VG.Controller.Tree.prototype, "selected",
{
    get: function() {
        return this._selected;
    },
    set: function( selected ) {
        if ( this._selected !== selected ) {

            this._selected=selected;
            this.selection=[];

            if ( selected ) {
                this.selection.push( selected );
            }

            this.notifyObservers( "selectionChanged" );
        }
    }
});

/**
 * Adds an object to the selection.
 * @param {object} item - The object to add to the selection.
 */

VG.Controller.Tree.prototype.addToSelection=function( item )
{
    if ( !this._selected ) this._selected=item;

    var index=this.selection.indexOf( item );
    if ( index === -1 && item )
        this.selection.push( item );

    this.notifyObservers( "selectionChanged" );
};

/**
 * Removes an object from the selection.
 * @param {object} item - The object to remove from the selection.
 */

VG.Controller.Tree.prototype.removeFromSelection=function( item )
{
    if ( this._selected === item ) this._selected=0;

    var index=this.selection.indexOf( item );
    if ( index >= 0 )
    {
        this.selection.splice( index, 1 );

     //   if ( this.selectionChanged )
     //       this.selectionChanged.call( VG.context );
    }

    if ( this._selected === 0 && this.selection.length ) {
        this._selected=this.selection[0];
    }

    this.notifyObservers( "selectionChanged" );
};

/**
 * Returns true if the given object is selected.
 * @param {object} item - The object to check for selection.
 * @returns {bool} True if the item is selected, false otherwise.
 */

VG.Controller.Tree.prototype.isSelected=function( item )
{
    var index=this.selection.indexOf( item );

    if ( index === -1 ) return false;
    else return true;
};

/**
 * Returns true if you can remove the current item, i.e. if it is non null.
 * @returns {bool} True if you can remove the current item.
 */

VG.Controller.Tree.prototype.canRemove=function()
{
    if ( this.selected ) return true;
    else return false;
};

VG.Controller.Tree.prototype.arrayOfItemChildren=function( curItem, item )
{
    if ( curItem.children.indexOf( item ) !== -1 )
    {
        return curItem.children;
    } else
    {
        for( var i=0; i < curItem.children.length; ++i )
        {
            var childItem=curItem.children[i];

            if ( childItem.children )
            {
                var rc=this.arrayOfItemChildren( childItem, item );
                if ( rc ) return rc;
            }
        }
    }
    return 0;
};

VG.Controller.Tree.prototype.arrayOfItem=function( item )
{
    var array=this.collection.dataForPath( this.path );

    var pathArray;
    var index=0;

    if ( array.indexOf( item ) !== -1 ) {
        return array;
    }
    else {
        for( var i=0; i < array.length; ++i )
        {
            var childItem=array[i];

            if ( childItem.children )
            {
                var rc=this.arrayOfItemChildren( childItem, item );
                if ( rc ) return rc;
            }
        }
    }
    return 0;
};

VG.Controller.Tree.prototype.indexOfChildren=function( curItem, path, item )
{
    if ( curItem.children.indexOf( item ) !== -1 )
    {
        path+=curItem.children.indexOf( item ).toString();
        return path;
    } else
    {
        for( var i=0; i < curItem.children.length; ++i )
        {
            var childItem=curItem.children[i];

            if ( childItem.children )
            {
                var childPath=path + i.toString() + ".";

                var rc=this.indexOfChildren( childItem, childPath, item );
                if ( rc != -1 ) return rc;
            }
        }
    }
    return -1;
};

/**
 * Returns the index of the item.
 * @param {object} item - The object to get the index for.
 * @returns {number} The index of the object.
 */

VG.Controller.Tree.prototype.indexOf=function( item )
{
    var array=this.collection.dataForPath( this.path );

    var pathArray;
    var index=0;

    index=index.toString();

    if ( array.indexOf( item ) !== -1 ) {
        index=array.indexOf( item ).toString();
        return index;
    }
    else {
        for( var i=0; i < array.length; ++i )
        {
            var childItem=array[i];

            if ( childItem.children )
            {
                var childPath=i.toString() + ".";

                var rc=this.indexOfChildren( childItem, childPath, item );
                if ( rc != -1 )
                {
                    index=rc;
                    return index;
                }
            }
        }
    }

    return undefined;
};

VG.Controller.Tree.prototype.parentOfItem=function( item )
{
    var index=this.indexOf( item );

    if ( index !== undefined ) {
        var array=index.split( '.' );
        array.splice( -1, 1 );

        return this.at( array.join( '.' ) );
    }

    return undefined;
};

VG.Controller.Tree.prototype.topLevelIndexOfIndex=function( index )
{
    if ( index === undefined ) {
        if ( this.selected )
            index=this.indexOf( this.selected );
    }

    if ( index )
    {
        if ( index.indexOf( '.' ) === -1 ) return index;
        else
        {
            var array=index.split('');
            return array[0];
        }
    }
};

VG.Controller.Tree.prototype.modelChanged_proccessChilds=function( item )
{
    this.notifyObservers( "addItem", item );

    if ( item.children )
    {
        for( let c=0; c < item.children.length; ++c )
        {
            let child=item.children[c];
            this.modelChanged_proccessChilds( child );
        }
    }
};

VG.Controller.Tree.prototype.modelChanged=function( forceRenew )
{
    var data=this.collection.dataForPath( this.path );
    if ( !data ) return;

    for( let i=0; i < data.length; ++i ) {
        let item=data[i];

        this.notifyObservers( "addItem", item );

        if ( item.children )
        {
            for( let c=0; c < item.children.length; ++c )
            {
                let child=item.children[c];
                this.modelChanged_proccessChilds( child );
            }
        }
    }

    this.notifyObservers( "changed" );
};

VG.Controller.Tree.prototype.iterator=function*( array )
{
    let index = 0;
    let data = array ? array : this.collection.dataForPath( this.path );

    while ( index < data.length ) {
        let item = data[index];
        yield( item );

        if ( item.children )
            yield *this.iterator( item.children );
        ++index;
    }
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains everything font related.
 * @namespace
 */

VG.Font = {};

/**
 * The global font manager which will be installed in VG.fontManager. </br>
 * This class is scheduled for a major rewrite as fonts are currently based on the discontinued typeface library.
 * @constructor
 */

VG.Font.Manager=function()
{
    this.triFonts=[];
    this.addFonts();
};

/**
 * Parses all fonts installed typeface and make them available to Visual Graphics.
 */

VG.Font.Manager.prototype.addFonts=function()
{
    for (var font in _typeface_js.faces ) {
        //console.log( font,  _typeface_js.faces[font] );

        if ( this.getFont( font ) === null )
        {
            var fontFace=null;
            //console.log( "adding", font,  _typeface_js.faces[font] );

            if ( _typeface_js.faces[font].normal )
            {
                if ( _typeface_js.faces[font].normal.normal )
                    fontFace=_typeface_js.faces[font].normal.normal;
                else
                if ( _typeface_js.faces[font].normal.italic )
                    fontFace=_typeface_js.faces[font].normal.italic;
            }
            else
            if ( _typeface_js.faces[font].bold )
            {
                if ( _typeface_js.faces[font].bold.normal )
                    fontFace=_typeface_js.faces[font].bold.normal;
                else
                if ( _typeface_js.faces[font].bold.italic )
                    fontFace=_typeface_js.faces[font].bold.italic;
            }

            var triFont=VG.Font.Triangulator.createFont( fontFace, { curveDiv: 3 } );
            triFont.name=font;

            this.triFonts.push( triFont );
        }
    }
};

/**
 * Returns the font of the given name.
 * @returns {VG.Font.Font} The found font or undefined.
 */

VG.Font.Manager.prototype.getFont=function( name )
{
    for (var i=0; i < this.triFonts.length; ++i )
    {
        var triFont=this.triFonts[i];

        if ( String( triFont.name ).toUpperCase() === String( name ).toUpperCase() )
            return triFont;
    }
    return null;
};

/**
 * The main Visual Graphics font object for a given font.
 * @param {string} name - The font to use.
 * @param {number} size - The initial pixel size to use for this font.
 * @param {number} curveDiv - Optional, the curve subdivion value to use for this font during triangulation. Visual Graphics uses a value of 3 by default.
 * @constructor
 */

VG.Font.Font=function( name, size, curveDiv )
{
    if ( !(this instanceof VG.Font.Font) ) return new VG.Font.Font( name, size, curveDiv );

    if ( size === undefined && name.triFont )
    {
        // --- Copy

        this.name=name.name;
        this.size=name.size;
        this.triFont=name.triFont;
        this.scale=name.scale;
    } else
    if ( !curveDiv )
    {
        // --- Use existing font
        this.name=name;
        this.size=size;
        this.triFont=VG.fontManager.getFont( name );
        this.scale=this.size * this.triFont.pixelScale;
    } else
    {
        // --- Create Font fresh with a custom curveDiv
        this.name=name;
        this.size=size;
        this.triFont=VG.fontManager.getFont( name );
        this.triFont=VG.Font.Triangulator.createFont( this.triFont.face, { curveDiv: curveDiv } );
        this.scale=this.size * this.triFont.pixelScale;
    }
};

VG.Font.Font.prototype.toString=function()
{
    return this.name;
};

VG.Font.Font.prototype.setFont=function( name )
{
    if ( this.name !== name ) {
        this.triFont=VG.fontManager.getFont( name );
        this.name=name;
    }
};

/**
 * Changes the font size for this font.
 * @param {number} size - The pixel size to use for this font.
 */

VG.Font.Font.prototype.setSize=function( size )
{
    this.size=size;
    this.scale=this.size * this.triFont.pixelScale;
};


VG.Font.Triangulator = {};

VG.Font.Triangulator.createFont=function(font, options)
{
    /** Takes a fontface.js face/font and creates a triangle version of it
     *
     * Options:
     *    curveDiv - Divisor varible for the bezier curves (defult: 2)
     *
     * returns an structure similar to typeface.js's face*/

    if (!options) options = {};

    var out = { glyphs: {}, tris: [] };
    var curveDiv = options.curveDiv ? options.curveDiv : 2;

    out.face = font;

    var totalSize = 0;

    var v = out.tris;

    var text = " ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789" +
               "~!@#$%^&*()_+{}:\"<>?|[];',./\\-=%";

    for (var i=0; i < text.length; ++i )
    {
        var chr=text[i];

        if (!font.glyphs[chr]) continue;

        var g =
        {
            offset: out.tris.length,
            size: 0,
            width: font.glyphs[chr].ha / font.resolution,
            baseLine: 0
        };


        g.size = this.processGlyph(font, chr, curveDiv, out.tris);

        out.glyphs[chr] = g;
        totalSize += g.size;

        for (var j = g.offset; j < (g.offset + g.size); j += 3)
        {
            var y1 = v[j].y;
            var y2 = v[j + 1].y;
            var y3 = v[j + 2].y;

            g.baseLine = Math.max(g.baseLine, y1);
            g.baseLine = Math.max(g.baseLine, y2);
            g.baseLine = Math.max(g.baseLine, y3);
        }
    }

    out.height = font.lineHeight / font.resolution;
    out.ascender = font.ascender / font.resolution;
    out.descender = font.descender / font.resolution;
    out.pixelScale = (out.height + out.descender) / out.height;

    if (totalSize != out.tris.length) throw "total size doesn't match the float array length";

    v = null;

    return out;
};

VG.Font.Triangulator.getGlyph=function( font, chr )
{
    var g = font.glyphs[chr];

    if (!g)
    {
        return this.getGlyph(font, " ");
    }

    return g;
};

VG.Font.Triangulator.clockwise=function(vs)
{
    /** Checks if the polygon/shape is clockwise or not */

    var area = 0.0;

    for (var i = 0; i < vs.length - 1; i++)
    {
        var sX = vs[i].x - vs[0].x;
        var sY = vs[i].y - vs[0].y;
        var eX = vs[i + 1].x - vs[0].x;
        var eY = vs[i + 1].y - vs[0].y;

        area += (sX * -eY) - (eX * -sY);
    }

    return  area < 0.0;
};

VG.Font.Triangulator.processGlyph=function(face, char, seg, triOut)
{
    /** Utility function that wraps several other functions
     *
     * Returns the number of generated triangles */

    var polygons = this.generatePolygons(face, char, seg);

    if (polygons.length === 0) return 0;

    return this.triangulatePolygons(polygons, triOut);
};

VG.Font.Triangulator.triangulatePolygons=function(polygons, triOut)
{
    /** Triagulates the given array of polygons, if found holes then merges them
     *  into simple polygons */
    var count = 0;

    var merged = []; //other clockwise polygons that aren't holes


    for (var i = 0; i < polygons.length; i++)
    {
        var p = polygons[i];

        if (this.clockwise(polygons[i]))
        {
            merged.push(p);
        }
        else
        {
            var iL = merged.length - 1;

            if (iL == -1)
            {
                polygons.push(p);
                continue;
            }



            try
            {
                merged[iL] = this.mergePolygons(merged[iL], p);
                merged[iL].push({});
            }
            catch (e)
            {
                //console.info("Unable to merge holes", char);
                return 0;
            }
        }
    }


    try
    {

        for (i = 0; i < merged.length; i++)
        {
            count += this.performEarClipping(merged[i], triOut);
        }
    }
    catch (e)
    {
        count = 0;
        console.info("Unable to triangulate", char);
    }

    return count;
};

VG.Font.Triangulator.mergePolygons=function(outer, inner)
{
    /** Merges outer and inner polygons */
    var p = outer;

    var EPSILON = 0.00001;

    var nOuter = (outer.length - 1);
    var nInner = (inner.length - 1);

    var xM = inner[0].x;
    var iM = 0;

    for (var i = 1; i < nInner; i++)
    {
        var x = inner[i].x;

        if (x > xM)
        {
            xM = x;
            iM = i;
        }
    }

    var vM = inner[iM];

    var cM = Number.MAX_VALUE;
    var zr = 0;

    var intr = { x: cM, y: vM.y };

    var v0m = -1;
    var v1m = -1;
    var edm = -1;

    var i0 = 0;
    var i1 = 0;

    var s = cM, t = cM;

    function Sub(v1, v2)
    {
        return { x: v1.x - v2.x, y: v1.y - v2.y };
    }

    function Dot(v1, v2)
    {
        return (v1.x * v2.x) + (v1.y * v2.y);
    }

    function PerpDot(a, b)
    {
        return (a.y * b.x) - (a.x * b.y);
    }

    for (i0 = nOuter - 1, i1 = 0; i1 < nOuter; i0 = i1++)
    {
        var vD0 = Sub(outer[i0], vM);

        if (vD0.y > zr)
        {
            continue;
        }

        var vD1 = Sub(outer[i1], vM);

        if (vD1.y < zr)
        {
            continue;
        }

        var cEndM = -1;

        if (vD0.y < zr)
        {
            if (vD1.y > zr)
            {
                s = vD0.y / (vD0.y - vD1.y);
                t = vD0.x + s * (vD1.x - vD0.x);
            }
            else
            {
                t = vD1.x;
                cEndM = i1;
            }
        }
        else
        {
            if (vD1.y > zr)
            {
                t = vD0.x;
                cEndM = i0;
            }
            else
            {
                if (vD0.x < vD1.x)
                {
                    t = vD0.x;
                    cEndM = i0;
                }
                else
                {
                    t = vD1.x;
                    cEndM = i1;
                }
            }
        }


        if (zr <= t && t < intr.x)
        {
            intr.x = t;
            v0m = i0;
            v1m = i1;

            if (cEndM == -1)
            {
                edm = -1;
            }
            else
            {
                edm = cEndM;
            }

        }
        else
        if (t == intr.x)
        {
            if (edm == -1 || cEndM == -1)
            {
                throw "Unexpected values";
            }

            var vS = outer[i1];

            var iO = (edm == v0m ? v1m : v0m);

            vD0 = Sub(outer[i0], vS);
            vD1 = Sub(outer[iO], vS);

            var pD = PerpDot(vD0, vD1);

            if (pD > zr)
            {
                v0m = i0;
                v1m = i1;
                edm = cEndM;
            }
        }
    }

    intr.x += vM.x;

    var iMCos = null;

    if (edm == -1)
    {
        if (v0m < 0 || v1m < 0)
        {
            throw "Invalid nesting";

            //v0m = 0;
            //v1m = 0;
        }

        var sT = [{x: 0, y: 0}, {x: 0, y: 0}, {x: 0, y: 0}];
        var iP = 0;

        if (outer[v0m].x > outer[v1m].x)
        {
            sT[0] = outer[v0m];
            sT[1] = { x: intr.x, y: intr.y };
            sT[2] = { x: vM.x, y: vM.y };

            iP = v0m;
        }
        else
        {
            sT[0] = outer[v1m];
            sT[1] = { x: vM.x, y: vM.y };
            sT[2] = { x: intr.x, y: intr.y };

            iP = v1m;
        }

        var vD = Sub(sT, vM);
        var mxSqrLen = Dot(vD, vD);
        var mxCos = vD.x * vD.x / mxSqrLen;

        iMCos = iP;

        for (i = 0; i < nOuter; i++)
        {
            if (i == iP)
            {
                continue;
            }

            var curr = i;
            var prev = (i + nOuter - 1) % nOuter;
            var next = (i + 1) % nOuter;

            if (VG.Math.testLine(outer[curr], outer[prev], outer[next]) <= 0 &&
                VG.Math.testTri(outer[curr], sT[0], sT[1], sT[2]) <= 0)
            {
                vD = Sub(outer[curr], vM);
                var sqrL = Dot(vD, vD);
                var cs = vD.x * vD.x / sqrL;

                if (cs > mxCos)
                {
                    mxSqrLen = sqrLen;
                    mxCos = cs;
                    iMCos = i;
                }
                else
                if (cs == mxCos && sqrLen < mxSqrLen)
                {
                    mxSqrLen = sqrL;
                    iMCos = i;
                }

                throw 0;
            }
        }

    }
    else
    {
        iMCos = edm;
    }

    var outSiz = nOuter + nInner + 2;

    var out = [];//new Array(nOuter + nInner + 2);

    var iC = 0;
    for (i = 0; i <= iMCos; i++, iC++)
    {
        out[iC] = outer[i];
    }

    for (i = 0; i < nInner; i++, iC++)
    {
        j = (iM + i) % nInner;
        out[iC] = inner[j];
    }

    var iIdx = iM;

    out[iC++] = inner[iM];
    out[iC++] = outer[iMCos];

    for (i = iMCos + 1; i < nOuter; i++, iC++)
    {
        out[iC] = outer[i];
    }

    return out;
},


VG.Font.Triangulator.generatePolygons=function(face, char, seg)
{
    /** Generate polygons from a face and character,
     * Optionally takes a segmentation variable.
     *
     * returns an array of polygons (including holes) */

    if (!seg) seg = 2;

    var polygons = [];

    var vs = [];

    glyph = face.glyphs[char];

    var i = 0;
    var i2 = 0;
    var scale = 1.0 / face.resolution;


    if (!glyph) glyph = face.glyphs['?'];

    if (!glyph.o)
    {
        return polygons;
    }

    var outline = glyph.cached_o ? glyph.cached_o : glyph.cached_o = glyph.o.split(' ');

    var bezierCubic = VG.Math.bezierCubic;
    var bezier = VG.Math.bezier;

    function vX(x)
    {
        return x * scale;
    }

    function vY(y)
    {
        return -(y * scale) + (face.resolution * scale);
    }

    while (i < outline.length)
    {
        var action = outline[i++];

        switch (action)
        {
        case 'm':

            vs = [];

            polygons.push(vs);

            vs.push(new VG.Math.Vector3(vX(outline[i++]), vY(outline[i++]), 0.0));

            break;

        case 'l':
            vs.push(new VG.Math.Vector3(vX(outline[i++]), vY(outline[i++]), 0.0));

            break;

        case 'q':
            //bezier curve
            px  = vX(outline[i++]);
            py  = vY(outline[i++]);
            px1 = vX(outline[i++]);
            py1 = vY(outline[i++]);

            px0 = vs[vs.length - 1].x;
            py0 = vs[vs.length - 1].y;

            for (j = 1, seg = seg; j <= seg; j++)
            {
                t = j / seg;
                tx = bezier(t, px0, px1, px);
                ty = bezier(t, py0, py1, py);

                vs.push(new VG.Math.Vector3(tx, ty, 0.0));
            }

            break;

        case 'b':
            //cubic bezier
            px  = vX(outline[i++]);
            py  = vY(outline[i++]);
            px1 = vX(outline[i++]);
            py1 = vY(outline[i++]);
            px2 = vX(outline[i++]);
            py2 = vY(outline[i++]);

            px0 = vs[vs.length - 1].x;
            py0 = vs[vs.length - 1].y;

            for (j = 1, seg = seg; j <= seg; j++)
            {
                t = j / seg;
                tx = bezierCubic(t, px0, px1, px2, px);
                ty = bezierCubic(t, py0, py1, py2, py);

                vs.push(new VG.Math.Vector3(tx, ty, 0.0));
            }
            break;
        }

    }

    return polygons;
},

VG.Font.Triangulator.performEarClipping=function(polygon, out)
{
    /** Triangulates a polygon with a ear clipping algorithm */
    var outCount = 0;

    var vs = polygon;

    var EPSILON = 0.00001;

    var iRL = -1;
    var iEF = -1;
    var iEL = -1;
    var iCF = -1;
    var iCL = -1;
    var iRF = -1;

    var nVerts = polygon.length - 1;
    var v = new Array(nVerts);

    var nVertsM1 = nVerts - 1;

    function CheckConvex(i)
    {
        var vtx = v[i];

        var curr = vtx.index;

        var prev = v[vtx.vPrev].index;
        var next = v[vtx.vNext].index;

        vtx.convex = VG.Math.testLine(vs[curr], vs[prev], vs[next]) > 0;

        return vtx.convex;
    }

    function AddAfterR(i)
    {
        if (iRF == -1)
        {
            iRF = i;
        }
        else
        {
            v[iRL].sNext = i;
            v[i].sPrev = iRL;
        }

        iRL = i;
    }

    function AddAfterE(i)
    {
        var f = v[iEF];
        var cEN = f.eNext;

        var vtx = v[i];
        vtx.ePrev = iEF;
        vtx.eNext = cEN;
        f.eNext = i;
        v[cEN].ePrev = i;
    }

    function AddBefE(i)
    {
        var f = v[iEF];
        var cEP = f.ePrev;

        var vtx = v[i];
        vtx.ePrev = cEP;
        vtx.eNext = iEF;

        f.ePrev = i;

        v[cEP].eNext = i;
    }

    function AddAfterC(i)
    {
        if (iCF == -1)
        {
            iCF = i;
        }
        else
        {
            v[iCL].sNext = i;
            v[i].sPrev = iCL;
        }

        iCL = i;
    }

    function AddEndE(i)
    {
        if (iEF == -1)
        {
            iEF = i;
            iEL = i;
        }

        v[iEL].eNext = i;
        v[i].ePrev = iEL;

        iEL = i;
    }

    function VCmp(v1, v2)
    {
        if (Math.abs(v1.x - v2.x) > EPSILON) return false;
        if (Math.abs(v1.y - v2.y) > EPSILON) return false;

        return true;
    }


    function CheckEar(i)
    {
        var vtx = v[i];

        if (iRF == -1)
        {
            vtx.ear = true;
            return true;
        }

        var prev = v[vtx.vPrev].index;
        var curr = vtx.index;
        var next = v[vtx.vNext].index;

        vtx.ear = true;

        for (var j = iRF; j != -1; j = v[j].sNext)
        {
            if (j == vtx.vPrev || j == i || j == vtx.vNext) continue;

            var ts = v[j].index;

            if (VCmp(vs[ts], vs[prev]) || VCmp(vs[ts], vs[curr]) || VCmp(vs[ts], vs[next]))
            {
                continue;
            }

            if (VG.Math.testTri(vs[ts], vs[prev], vs[curr], vs[next]) <= 0)
            {
                vtx.ear = false;
                break;
            }

        }

        return vtx.ear;
    }

    function WipeR(i)
    {
        if (!(iRF != -1 && iRL != -1)) throw "Reflex not defined";

        if (i == iRF)
        {
            iRF = v[i].sNext;

            if (iRF != -1)
            {
                v[iRF].sPrev = -1;
            }

            v[i].sNext = -1;
        }
        else
        if (i == iRL)
        {
            iRL = v[i].sPrev;

            if (iRL != -1)
            {
                v[iRL].sNext = -1;
            }

            v[i].sPrev = -1;
        }
        else
        {
            var cSP = v[i].sPrev;
            var cSN = v[i].sNext;

            v[cSP].sNext = cSN;
            v[cSN].sPrev = cSP;

            v[i].sNext = -1;
            v[i].sPrev = -1;
        }
    }

    function WipeE(i)
    {
        var cEP = v[i].ePrev;
        var cEN = v[i].eNext;

        v[cEP].eNext = cEN;
        v[cEN].ePrev = cEP;

        return cEN;
    }

    function WipeV(i)
    {
        var cVP = v[i].vPrev;
        var cVN = v[i].vNext;

        v[cVP].vNext = cVN;
        v[cVN].vPrev = cVP;
    }

    for (i = 0; i <= nVertsM1; i++)
    {
        var vtx = v[i] = {
            convex: false,
            ear: false,
            ePrev: -1,
            eNext: -1,
            sPrev: -1,
            sNext: -1
        };

        vtx.index = i;
        vtx.vPrev = i > 0 ? i - 1 : nVertsM1;
        vtx.vNext = i < nVertsM1 ? i + 1 : 0;
    }

    for (i = 0; i <= nVertsM1; i++)
    {
        if (CheckConvex(i))
        {
            AddAfterC(i);
        }
        else
        {
            AddAfterR(i);
        }
    }

    function PushTri(iA, iB, iC)
    {
        out.push(vs[iA]);
        out.push(vs[iC]);
        out.push(vs[iB]);

        outCount += 3;
    }

    if (iRF == -1)
    {
        for (i = 1; i < nVertsM1; i++)
        {
            PushTri(0, i, i + 1);
        }

        return outCount;
    }

    for (i = iCF; i != -1; i = v[i].sNext)
    {
        if (CheckEar(i))
        {
            AddEndE(i);
        }
    }

    if (iEF == -1 || iEL == -1) throw "Invalid polygon";

    v[iEF].ePrev = iEL;
    v[iEL].eNext = iEF;

    var clipEar = true;

    var step = 0;

    while (clipEar)
    {
        var iVP = v[iEF].vPrev;
        var iVN = v[iEF].vNext;

        PushTri(v[iVP].index, v[iEF].index, v[iVN].index);

        WipeV(iEF);

        if (--nVerts == 3)
        {
            iEF = WipeE(iEF);
            iVP = v[iEF].vPrev;
            iVN = v[iEF].vNext;

            PushTri(v[iVP].index, v[iEF].index, v[iVN].index);

            clipEar = false;
            continue;
        }

        var vtxPrev = v[iVP];

        if (vtxPrev.ear)
        {
            if (!CheckEar(iVP))
            {
                WipeE(iVP);
            }
        }
        else
        {
            wReflex = !vtxPrev.convex;

            if (CheckConvex(iVP))
            {
                if (wReflex)
                {
                    WipeR(iVP);
                }

                if (CheckEar(iVP))
                {
                    AddBefE(iVP);
                }
            }

        }

        var vtxNext = v[iVN];

        if (vtxNext.ear)
        {
            if (!CheckEar(iVN))
            {
                WipeE(iVN);
            }
        }
        else
        {
            wReflex = !vtxNext.convex;


            if (CheckConvex(iVN))
            {
                if (wReflex)
                {
                    WipeR(iVN);
                }

                if (CheckEar(iVN))
                {
                    AddAfterE(iVN);
                }
            }

        }


        iEF = WipeE(iEF);
    }

    return outCount;
};

VG.Font.Triangulator.create3DText=function(font, text, S, T, bS, bT)
{
    /** Creates an array of vertices from the given text for 3D Rendering
     *  @param {VG.Font} font - The font for glyph look up
     *  @param {string} text - The text to make into 3D text
     *  @param {number} [4] S - The 2d bazier segments
     *  @param {number} [0.1] T - The thickness
     *  @param {number} [0] bS - The bevel segments
     *  @param {number} [0.01] bT - The bevel thickness
     *  @returns Object containing vertex position and normal arrays */

    if (!font || !font.face) throw "font is null or invalid";

    var tA = { v: [], n: [] };

    var xOffset = 0.0;

    for (var i = 0; i < text.length; i++)
    {
        var chr = text[i];

        var g = font.glyphs[chr];

        if (!g) continue;

        var ha = g.ha / font.resolution;

        var t = this.create3DGlyph(font, chr, S, T, bS, bT);

        for (var j = 0; j < t.v.length; j++)
        {
            var v = t.v[j];
            var n = t.n[j];

            tA.v.push(new VG.Math.Vector3(v.x + xOffset, v.y, v.z));
            tA.n.push(n);
        }


        xOffset += g.width;
    }

    return tA;
};

VG.Font.Triangulator.create3DGlyph=function(font, chr, S, T, bS, bT)
{
    /** Creates a 3D representation of the glyph
     *  @param {VG.Font} font - The font for glyph look up
     *  @param {char} chr - The glyph
     *  @param {number} [4] S - The 2d bazier segments
     *  @param {number} [0.1] T - The thickness
     *  @param {number} [0] bS - The bevel segments
     *  @param {number} [0.01] bT - The bevel thickness
     *  @returns Object containing vertex position and normal arrays.*/

    if (!font || !font.face) throw "font is null or invalid";

    if (S === undefined) S = 4;
    if (T === undefined) T = 0.1;
    if (bS === undefined) bS = 0;
    if (bT === undefined) bT = 0.01;

    var noBevel = (bS <= 0);

    //center plus sides in multiplies of 2
    bS = 1 + (2 * bS);

    font = font.face;

    var t = { v: [], n: [] };

    //Simply copies the front lid and flips the triangles into clockwise
    function CreateBackLid(tSize)
    {
        for (var j = 0; j < tSize; j += 3)
        {
            var v1 = t.v[j + 0];
            var v2 = t.v[j + 1];
            var v3 = t.v[j + 2];

            t.v.push({x: v1.x, y: v1.y, z: v1.z - T});
            t.v.push({x: v3.x, y: v3.y, z: v3.z - T});
            t.v.push({x: v2.x, y: v2.y, z: v2.z - T});

            var n = {x: 0.0, y: 0.0, z: -1.0};

            t.n.push(n);
            t.n.push(n);
            t.n.push(n);
        }

        return tSize;
    }


    var n0 = new VG.Math.Vector3();
    var n1 = new VG.Math.Vector3();
    var n2 = new VG.Math.Vector3();
    var n3 = new VG.Math.Vector3();

    var n0N = new VG.Math.Vector3();
    var n1N = new VG.Math.Vector3();
    var n2N = new VG.Math.Vector3();
    var n3N = new VG.Math.Vector3();

    function FlipV(iv)
    {
        var v = iv.clone();

        v.z = -iv.z - T;

        return v;
    }

    function CreateContour(polygons, disp)
    {
        if (disp === undefined) disp = 0;

        var size = 0;

        for (p = 0; p < polygons.length; p++)
        {
            var poly = polygons[p];

            for (var j = 0; j < poly.length; j++)
            {
                //previous from p1
                var v0F = poly[j - 1 < 0 ? poly.length - 1 : j - 1];
                var v0B = new VG.Math.Vector3(v0F.x, v0F.y, v0F.z - T + disp);

                //current point and previous from p2
                var v1F = poly[j];
                var v1B = new VG.Math.Vector3(v1F.x, v1F.y, v1F.z - T + disp);

                //next from p1
                var v2F = poly[j + 1 >= poly.length ? 0 : j + 1];
                var v2B = new VG.Math.Vector3(v2F.x, v2F.y, v2F.z - T + disp);

                //next from p2
                var v3F = poly[j + 2 >= poly.length ? (j + 1 < poly.length ? 0 : 1) : j + 2];
                var v3B = new VG.Math.Vector3(v3F.x, v3F.y, v3F.z - T + disp);

                t.v.push(v1F);
                t.v.push(v2F);
                t.v.push(v1B);

                t.v.push(v2F);
                t.v.push(v2B);
                t.v.push(v1B);


                n0.computeNormal(v0F, v1F, v1B);
                n0.normalize();
                n0.negate();


                n1.computeNormal(v1F, v2F, v1B);
                n1.normalize();
                n1.negate();


                n2.computeNormal(v2F, v2B, v1B);
                n2.normalize();
                n2.negate();


                n3.computeNormal(v2F, v3F, v2B);
                n3.normalize();
                n3.negate();



                var nAvg1 = n0.clone().add(n1);
                nAvg1.normalize();


                var nAvg2 = n2.clone().add(n3);
                nAvg2.normalize();



                t.n.push(nAvg1);
                t.n.push(nAvg2);
                t.n.push(nAvg1);

                t.n.push(nAvg2);
                t.n.push(nAvg2);
                t.n.push(nAvg1);

                size += 6;
            }
        }

        return size;
    }

    function TriangulateBevel(bevels)
    {
        for (var i = 0; i < bevels.length - 1; i++)
        {
            var bP = bevels[i - 1 < 0 ? i : i - 1];

            //current bevel
            var bC = bevels[i];

            //next bevel
            var bN = bevels[i + 1];
            var b2 = bevels[i + 2 >= bevels.length ? i : i + 2];

            for (var k = 0; k < bP.length; k++)
            {
                var polyP = bP[k];
                var polyC = bC[k];
                var polyN = bN[k];
                var poly2 = b2[k];

                for (var j = 0; j < polyC.length; j++)
                {
                    var i0 = j - 1 < 0 ? polyC.length - 1 : j - 1;
                    var i1 = j;
                    var i2 = j + 1 >= polyC.length ? 0 : j + 1;
                    var i3 = j + 2 >= polyC.length ? (j + 1 < polyC.length ? 0 : 1) : j + 2;

                    //previous from p1
                    var v0P = polyP[i0];
                    var v0C = polyC[i0];
                    var v0N = polyN[i0];
                    var v02 = poly2[i0];

                    //current point and previous from p2
                    var v1P = polyP[i1];
                    var v1C = polyC[i1];
                    var v1N = polyN[i1];
                    var v12 = poly2[i1];

                    //next from p1
                    var v2P = polyP[i2];
                    var v2C = polyC[i2];
                    var v2N = polyN[i2];
                    var v22 = poly2[i2];

                    //next from p2
                    var v3P = polyP[i3];
                    var v3C = polyC[i3];
                    var v3N = polyN[i3];
                    var v32 = poly2[i3];

                    t.v.push(v1C);
                    t.v.push(v1N);
                    t.v.push(v2C);

                    t.v.push(v2C);
                    t.v.push(v1N);
                    t.v.push(v2N);

                    //back
                    t.v.push(FlipV(v1C));
                    t.v.push(FlipV(v2C));
                    t.v.push(FlipV(v1N));

                    t.v.push(FlipV(v2C));
                    t.v.push(FlipV(v2N));
                    t.v.push(FlipV(v1N));

                    function ComputeNormals(flip)
                    {
                        if (flip)
                        {
                            v0C = FlipV(v0C);
                            v1C = FlipV(v1C);
                            v2C = FlipV(v2C);
                            v3C = FlipV(v3C);

                            v0P = FlipV(v0P);
                            v1P = FlipV(v1P);
                            v2P = FlipV(v2P);
                            v3P = FlipV(v3P);

                            v0N = FlipV(v0N);
                            v1N = FlipV(v1N);
                            v2N = FlipV(v2N);
                            v3N = FlipV(v3N);

                            v02 = FlipV(v02);
                            v12 = FlipV(v12);
                            v22 = FlipV(v22);
                            v32 = FlipV(v32);
                        }

                        n0.computeNormal(v0C, v0N, v1C);
                        n0.normalize();
                        if (!flip) n0.negate();

                        n1.computeNormal(v1C, v1N, v2C);
                        n1.normalize();
                        if (!flip) n1.negate();

                        n2.computeNormal(v2C, v1N, v2N);
                        n2.normalize();
                        if (!flip) n2.negate();

                        n3.computeNormal(v2C, v2N, v3C);
                        n3.normalize();
                        if (!flip) n3.negate();



                        n0N.computeNormal(v0N, v02, v1N);
                        n0N.normalize();
                        if (!flip) n0N.negate();

                        n1N.computeNormal(v1N, v12, v2N);
                        n1N.normalize();
                        if (!flip) n1N.negate();

                        n2N.computeNormal(v2N, v12, v22);
                        n2N.normalize();
                        if (!flip) n2N.negate();

                        n3N.computeNormal(v2N, v22, v3N);
                        n3N.normalize();
                        if (!flip) n3N.negate();
                    }

                    ComputeNormals();

                    if (i + 2 >= bevels.length)
                    {
                        n0N.set(0, 0.05, 0.95);
                        n1N.set(0, 0.05, 0.95);
                        n2N.set(0, 0.05, 0.95);
                        n3N.set(0, 0.05, 0.95);
                    }


                    var nAvg1 = n0.clone().add(n1);
                    nAvg1.normalize();

                    var nAvg2 = n2.clone().add(n3);
                    nAvg2.normalize();

                    var nAvg1N = n0N.clone().add(n1N);
                    nAvg1N.normalize();

                    var nAvg2N = n2N.clone().add(n3N);
                    nAvg2N.normalize();

                    t.n.push(nAvg1);
                    t.n.push(nAvg1N);
                    t.n.push(nAvg2);

                    t.n.push(nAvg2);
                    t.n.push(nAvg1N);
                    t.n.push(nAvg2N);




                    //apend the back face
                    ComputeNormals(true);

                    if (i + 2 >= bevels.length)
                    {
                        n0N.set(0, 0.05, -0.95);
                        n1N.set(0, 0.05, -0.95);
                        n2N.set(0, 0.05, -0.95);
                        n3N.set(0, 0.05, -0.95);
                    }


                    nAvg1 = n0.clone().add(n1);
                    nAvg1.normalize();

                    nAvg2 = n2.clone().add(n3);
                    nAvg2.normalize();

                    nAvg1N = n0N.clone().add(n1N);
                    nAvg1N.normalize();

                    nAvg2N = n2N.clone().add(n3N);
                    nAvg2N.normalize();

                    t.n.push(nAvg1);
                    t.n.push(nAvg2);
                    t.n.push(nAvg1N);

                    t.n.push(nAvg2);
                    t.n.push(nAvg2N);
                    t.n.push(nAvg1N);

                }
            }
        }

    }

    var poly;
    var ha = font.glyphs[chr].ha / font.resolution;

    //create the shapes/polygons
    var polygons = this.generatePolygons(font, chr, S);

    var tSize = this.triangulatePolygons(polygons, t.v);

    for (j = 0; j < t.v.length; j++)
    {
        t.n[j] = {x: 0.0, y: 0.0, z: 1.0};
    }


    tSize += CreateBackLid(tSize);


    //remove the last vector in each polygon
    for (p = 0; p < polygons.length; p++)
    {
        poly = polygons[p];

        poly.splice(poly.length - 1, 1);
    }

    //if no bevel segments then just stick the lids toguether
    if (noBevel)
    {
        tSize += CreateContour(polygons);

    }
    else
    {

        var bevels = [];

        //the bevel segments
        for (var bi = 0; bi < bS; bi++)
        {

            //z displacement acording with the bevel thickness
            var zDisp = bT / (bi + 1);

            var bTi = bi / bS - 1;

            var bPolygons = [];


            for (p = 0; p < polygons.length; p++)
            {
                poly = polygons[p];


                var isHole = !this.clockwise(poly);

                var bevel = [];

                for (j = 0; j < poly.length; j++)
                {
                    var pp = poly[j - 1 < 0 ? poly.length - 1 : j - 1];
                    var cp = poly[j];
                    var np = poly[j + 1 >= poly.length ? 0 : j + 1];

                    var b2 = !isHole ? this.computeBevel(cp, pp, np) : this.computeBevel(cp, np, pp);

                    var b3 = new VG.Math.Vector3(b2.x, b2.y, 0.0);

                    b3 = cp.clone().sub(b3);
                    b3.normalize();

                    var cD = bT + -(bT) * (Math.sin(bTi * Math.PI / 2));

                    b3.mul(isHole ? -cD : cD);

                    b3 = cp.clone().add(b3);

                    b3.z = -zDisp;

                    bevel.push(b3);
                }

                bPolygons.push(bevel);
            }

            bevels.push(bPolygons);
        }

        bevels.push(polygons);

        tSize += TriangulateBevel(bevels);

        tSize += CreateContour(bevels[0], bT * 2);

    }

    return t;
};


VG.Font.Triangulator.computeBevel=function(p, pp, pn)
{
    /** Computes the bevel for the given point in a shape, previous and next
     *  points are required.
     *
     *  @param {VG.Math.Vector2} p - The point of interest
     *  @param {VG.Math.Vector2} pp - The previous point relative to p
     *  @param {VG.Math.Vector2} pn - The next point relative to n i
     *  @returns {VG.Math.Vector2} The bevel point */

    var EPSILON = 0.0000000001;

    var shrink = 1.0;
    var vx = 0.0;
    var vy = 0.0;

    var vpx = p.x - pp.x;
    var vpy = p.y - pp.y;
    var vnx = pn.x - p.x;
    var vny = pn.y - p.y;

    var vpLenSqr = vpx * vpx + vpy * vpy;
    var c0 = vpx * vny - vpy * vnx;

    var con=!(Math.abs(c0));
    if (con > EPSILON)
    {
        var dirEq = false;

        if (vpx > EPSILON)
        {
           if (vnx > EPSILON) dirEq = true;
        }
        else
        {
            if (vpx < -EPSILON)
            {
                if (vnx < -EPSILON) dirEq = true;
            }
            else
            {
                if (Math.sign(vpy) == Math.sign(vny)) dirEq = true;
            }
        }

        if (dirEq)
        {
            vx = -vpy;
            vy = vpx;
            shrink = Math.sqrt(vpLenSqr);
        }
        else
        {
            vx = vpx;
            vy = vpy;
            shrink = Math.sqrt(vpLenSqr / 2);
        }

    } else {
        var vpLen = Math.sqrt(vpLenSqr);
        var vnLen = Math.sqrt(vnx * vnx + vny * vny);

        var ppsx = pp.x - vpy / vpLen;
        var ppsy = pp.y + vpx / vpLen;

        var pnsx = pn.x - vny / vnLen;
        var pnsy = pn.y + vnx / vnLen;

        var sf = ((pnsx - ppsx) * vny - (pnsy - ppsy) * vnx) / (vpx * vny - vpy * vnx);



        vx = ppsx + vpx * sf - p.x;
        vy = ppsy + vpy * sf - p.y;

        var vtLenSqr = vx * vx + vy * vy;

        if (vtLenSqr <= 2)
        {
            return new VG.Math.Vector2(vx, vy);
        }
        else
        {
            shrink = Math.sqrt(vtLenSqr / 2);
        }
    }

    return new VG.Math.Vector2(vx / shrink, vy / shrink);
};




VG.Font.Triangulator.extrude=function(shape)
{
    /** Extrudes the shape contour, returns a new shape */

};

VG.fontManager=new VG.Font.Manager();

/*
The ISC License

Copyright (c) Isaac Z. Schlueter and Contributors

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR
IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/

VG.sax={};

;(function (sax) { // wrapper for non-node envs
  sax.parser = function (strict, opt) { return new SAXParser(strict, opt); };
  sax.SAXParser = SAXParser;
  sax.SAXStream = SAXStream;
  sax.createStream = createStream;

  // When we pass the MAX_BUFFER_LENGTH position, start checking for buffer overruns.
  // When we check, schedule the next check for MAX_BUFFER_LENGTH - (max(buffer lengths)),
  // since that's the earliest that a buffer overrun could occur.  This way, checks are
  // as rare as required, but as often as necessary to ensure never crossing this bound.
  // Furthermore, buffers are only tested at most once per write(), so passing a very
  // large string into write() might have undesirable effects, but this is manageable by
  // the caller, so it is assumed to be safe.  Thus, a call to write() may, in the extreme
  // edge case, result in creating at most one complete copy of the string passed in.
  // Set to Infinity to have unlimited buffers.
  sax.MAX_BUFFER_LENGTH = 64 * 1024;

  var buffers = [
    'comment', 'sgmlDecl', 'textNode', 'tagName', 'doctype',
    'procInstName', 'procInstBody', 'entity', 'attribName',
    'attribValue', 'cdata', 'script'
  ];

  sax.EVENTS = [
    'text',
    'processinginstruction',
    'sgmldeclaration',
    'doctype',
    'comment',
    'opentagstart',
    'attribute',
    'opentag',
    'closetag',
    'opencdata',
    'cdata',
    'closecdata',
    'error',
    'end',
    'ready',
    'script',
    'opennamespace',
    'closenamespace'
  ];

  function SAXParser (strict, opt) {
    if (!(this instanceof SAXParser)) {
      return new SAXParser(strict, opt);
    }

    var parser = this;
    clearBuffers(parser);
    parser.q = parser.c = '';
    parser.bufferCheckPosition = sax.MAX_BUFFER_LENGTH;
    parser.opt = opt || {};
    parser.opt.lowercase = parser.opt.lowercase || parser.opt.lowercasetags;
    parser.looseCase = parser.opt.lowercase ? 'toLowerCase' : 'toUpperCase';
    parser.tags = [];
    parser.closed = parser.closedRoot = parser.sawRoot = false;
    parser.tag = parser.error = null;
    parser.strict = !!strict;
    parser.noscript = !!(strict || parser.opt.noscript);
    parser.state = S.BEGIN;
    parser.strictEntities = parser.opt.strictEntities;
    parser.ENTITIES = parser.strictEntities ? Object.create(sax.XML_ENTITIES) : Object.create(sax.ENTITIES);
    parser.attribList = [];

    // namespaces form a prototype chain.
    // it always points at the current tag,
    // which protos to its parent tag.
    if (parser.opt.xmlns) {
      parser.ns = Object.create(rootNS);
    }

    // mostly just for error reporting
    parser.trackPosition = parser.opt.position !== false;
    if (parser.trackPosition) {
      parser.position = parser.line = parser.column = 0;
    }
    emit(parser, 'onready');
  }

  if (!Object.create) {
    Object.create = function (o) {
      function F () {}
      F.prototype = o;
      var newf = new F();
      return newf;
    };
  }

  if (!Object.keys) {
    Object.keys = function (o) {
      var a = [];
      for (var i in o) if (o.hasOwnProperty(i)) a.push(i);
      return a;
    };
  }

  function checkBufferLength (parser) {
    var maxAllowed = Math.max(sax.MAX_BUFFER_LENGTH, 10);
    var maxActual = 0;
    for (var i = 0, l = buffers.length; i < l; i++) {
      var len = parser[buffers[i]].length;
      if (len > maxAllowed) {
        // Text/cdata nodes can get big, and since they're buffered,
        // we can get here under normal conditions.
        // Avoid issues by emitting the text node now,
        // so at least it won't get any bigger.
        switch (buffers[i]) {
          case 'textNode':
            closeText(parser);
            break;

          case 'cdata':
            emitNode(parser, 'oncdata', parser.cdata);
            parser.cdata = '';
            break;

          case 'script':
            emitNode(parser, 'onscript', parser.script);
            parser.script = '';
            break;

          default:
            error(parser, 'Max buffer length exceeded: ' + buffers[i]);
        }
      }
      maxActual = Math.max(maxActual, len);
    }
    // schedule the next check for the earliest possible buffer overrun.
    var m = sax.MAX_BUFFER_LENGTH - maxActual;
    parser.bufferCheckPosition = m + parser.position;
  }

  function clearBuffers (parser) {
    for (var i = 0, l = buffers.length; i < l; i++) {
      parser[buffers[i]] = '';
    }
  }

  function flushBuffers (parser) {
    closeText(parser);
    if (parser.cdata !== '') {
      emitNode(parser, 'oncdata', parser.cdata);
      parser.cdata = '';
    }
    if (parser.script !== '') {
      emitNode(parser, 'onscript', parser.script);
      parser.script = '';
    }
  }

  SAXParser.prototype = {
    end: function () { end(this); },
    write: write,
    resume: function () { this.error = null; return this; },
    close: function () { return this.write(null); },
    flush: function () { flushBuffers(this); }
  };

  var Stream;
  try {
    Stream = require('stream').Stream;
  } catch (ex) {
    Stream = function () {};
  }

  var streamWraps = sax.EVENTS.filter(function (ev) {
    return ev !== 'error' && ev !== 'end';
  });

  function createStream (strict, opt) {
    return new SAXStream(strict, opt);
  }

  function SAXStream (strict, opt) {
    if (!(this instanceof SAXStream)) {
      return new SAXStream(strict, opt);
    }

    Stream.apply(this);

    this._parser = new SAXParser(strict, opt);
    this.writable = true;
    this.readable = true;

    var me = this;

    this._parser.onend = function () {
      me.emit('end');
    };

    this._parser.onerror = function (er) {
      me.emit('error', er);

      // if didn't throw, then means error was handled.
      // go ahead and clear error, so we can write again.
      me._parser.error = null;
    };

    this._decoder = null;

    streamWraps.forEach(function (ev) {
      Object.defineProperty(me, 'on' + ev, {
        get: function () {
          return me._parser['on' + ev];
        },
        set: function (h) {
          if (!h) {
            me.removeAllListeners(ev);
            me._parser['on' + ev] = h;
            return h;
          }
          me.on(ev, h);
        },
        enumerable: true,
        configurable: false
      });
    });
  }

  SAXStream.prototype = Object.create(Stream.prototype, {
    constructor: {
      value: SAXStream
    }
  });

  SAXStream.prototype.write = function (data) {
    if (typeof Buffer === 'function' &&
      typeof Buffer.isBuffer === 'function' &&
      Buffer.isBuffer(data)) {
      if (!this._decoder) {
        var SD = require('string_decoder').StringDecoder;
        this._decoder = new SD('utf8');
      }
      data = this._decoder.write(data);
    }

    this._parser.write(data.toString());
    this.emit('data', data);
    return true;
  };

  SAXStream.prototype.end = function (chunk) {
    if (chunk && chunk.length) {
      this.write(chunk);
    }
    this._parser.end();
    return true;
  };

  SAXStream.prototype.on = function (ev, handler) {
    var me = this;
    if (!me._parser['on' + ev] && streamWraps.indexOf(ev) !== -1) {
      me._parser['on' + ev] = function () {
        var args = arguments.length === 1 ? [arguments[0]] : Array.apply(null, arguments);
        args.splice(0, 0, ev);
        me.emit.apply(me, args);
      };
    }

    return Stream.prototype.on.call(me, ev, handler);
  };

  // character classes and tokens
  var whitespace = '\r\n\t ';

  // this really needs to be replaced with character classes.
  // XML allows all manner of ridiculous numbers and digits.
  var number = '0124356789';
  var letter = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

  // (Letter | "_" | ":")
  var quote = '\'"';
  var attribEnd = whitespace + '>';
  var CDATA = '[CDATA[';
  var DOCTYPE = 'DOCTYPE';
  var XML_NAMESPACE = 'http://www.w3.org/XML/1998/namespace';
  var XMLNS_NAMESPACE = 'http://www.w3.org/2000/xmlns/';
  var rootNS = { xml: XML_NAMESPACE, xmlns: XMLNS_NAMESPACE };

  // turn all the string character sets into character class objects.
  whitespace = charClass(whitespace);
  number = charClass(number);
  letter = charClass(letter);

  // http://www.w3.org/TR/REC-xml/#NT-NameStartChar
  // This implementation works on strings, a single character at a time
  // as such, it cannot ever support astral-plane characters (10000-EFFFF)
  // without a significant breaking change to either this  parser, or the
  // JavaScript language.  Implementation of an emoji-capable xml parser
  // is left as an exercise for the reader.
  var nameStart = /[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;

  var nameBody = /[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;

  var entityStart = /[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;
  var entityBody = /[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;

  quote = charClass(quote);
  attribEnd = charClass(attribEnd);

  function charClass (str) {
    return str.split('').reduce(function (s, c) {
      s[c] = true;
      return s;
    }, {});
  }

  function isRegExp (c) {
    return Object.prototype.toString.call(c) === '[object RegExp]';
  }

  function is (charclass, c) {
    return isRegExp(charclass) ? !!c.match(charclass) : charclass[c];
  }

  function not (charclass, c) {
    return !is(charclass, c);
  }

  var S = 0;
  sax.STATE = {
    BEGIN: S++, // leading byte order mark or whitespace
    BEGIN_WHITESPACE: S++, // leading whitespace
    TEXT: S++, // general stuff
    TEXT_ENTITY: S++, // &amp and such.
    OPEN_WAKA: S++, // <
    SGML_DECL: S++, // <!BLARG
    SGML_DECL_QUOTED: S++, // <!BLARG foo "bar
    DOCTYPE: S++, // <!DOCTYPE
    DOCTYPE_QUOTED: S++, // <!DOCTYPE "//blah
    DOCTYPE_DTD: S++, // <!DOCTYPE "//blah" [ ...
    DOCTYPE_DTD_QUOTED: S++, // <!DOCTYPE "//blah" [ "foo
    COMMENT_STARTING: S++, // <!-
    COMMENT: S++, // <!--
    COMMENT_ENDING: S++, // <!-- blah -
    COMMENT_ENDED: S++, // <!-- blah --
    CDATA: S++, // <![CDATA[ something
    CDATA_ENDING: S++, // ]
    CDATA_ENDING_2: S++, // ]]
    PROC_INST: S++, // <?hi
    PROC_INST_BODY: S++, // <?hi there
    PROC_INST_ENDING: S++, // <?hi "there" ?
    OPEN_TAG: S++, // <strong
    OPEN_TAG_SLASH: S++, // <strong /
    ATTRIB: S++, // <a
    ATTRIB_NAME: S++, // <a foo
    ATTRIB_NAME_SAW_WHITE: S++, // <a foo _
    ATTRIB_VALUE: S++, // <a foo=
    ATTRIB_VALUE_QUOTED: S++, // <a foo="bar
    ATTRIB_VALUE_CLOSED: S++, // <a foo="bar"
    ATTRIB_VALUE_UNQUOTED: S++, // <a foo=bar
    ATTRIB_VALUE_ENTITY_Q: S++, // <foo bar="&quot;"
    ATTRIB_VALUE_ENTITY_U: S++, // <foo bar=&quot
    CLOSE_TAG: S++, // </a
    CLOSE_TAG_SAW_WHITE: S++, // </a   >
    SCRIPT: S++, // <script> ...
    SCRIPT_ENDING: S++ // <script> ... <
  };

  sax.XML_ENTITIES = {
    'amp': '&',
    'gt': '>',
    'lt': '<',
    'quot': '"',
    'apos': "'"
  };

  sax.ENTITIES = {
    'amp': '&',
    'gt': '>',
    'lt': '<',
    'quot': '"',
    'apos': "'",
    'AElig': 198,
    'Aacute': 193,
    'Acirc': 194,
    'Agrave': 192,
    'Aring': 197,
    'Atilde': 195,
    'Auml': 196,
    'Ccedil': 199,
    'ETH': 208,
    'Eacute': 201,
    'Ecirc': 202,
    'Egrave': 200,
    'Euml': 203,
    'Iacute': 205,
    'Icirc': 206,
    'Igrave': 204,
    'Iuml': 207,
    'Ntilde': 209,
    'Oacute': 211,
    'Ocirc': 212,
    'Ograve': 210,
    'Oslash': 216,
    'Otilde': 213,
    'Ouml': 214,
    'THORN': 222,
    'Uacute': 218,
    'Ucirc': 219,
    'Ugrave': 217,
    'Uuml': 220,
    'Yacute': 221,
    'aacute': 225,
    'acirc': 226,
    'aelig': 230,
    'agrave': 224,
    'aring': 229,
    'atilde': 227,
    'auml': 228,
    'ccedil': 231,
    'eacute': 233,
    'ecirc': 234,
    'egrave': 232,
    'eth': 240,
    'euml': 235,
    'iacute': 237,
    'icirc': 238,
    'igrave': 236,
    'iuml': 239,
    'ntilde': 241,
    'oacute': 243,
    'ocirc': 244,
    'ograve': 242,
    'oslash': 248,
    'otilde': 245,
    'ouml': 246,
    'szlig': 223,
    'thorn': 254,
    'uacute': 250,
    'ucirc': 251,
    'ugrave': 249,
    'uuml': 252,
    'yacute': 253,
    'yuml': 255,
    'copy': 169,
    'reg': 174,
    'nbsp': 160,
    'iexcl': 161,
    'cent': 162,
    'pound': 163,
    'curren': 164,
    'yen': 165,
    'brvbar': 166,
    'sect': 167,
    'uml': 168,
    'ordf': 170,
    'laquo': 171,
    'not': 172,
    'shy': 173,
    'macr': 175,
    'deg': 176,
    'plusmn': 177,
    'sup1': 185,
    'sup2': 178,
    'sup3': 179,
    'acute': 180,
    'micro': 181,
    'para': 182,
    'middot': 183,
    'cedil': 184,
    'ordm': 186,
    'raquo': 187,
    'frac14': 188,
    'frac12': 189,
    'frac34': 190,
    'iquest': 191,
    'times': 215,
    'divide': 247,
    'OElig': 338,
    'oelig': 339,
    'Scaron': 352,
    'scaron': 353,
    'Yuml': 376,
    'fnof': 402,
    'circ': 710,
    'tilde': 732,
    'Alpha': 913,
    'Beta': 914,
    'Gamma': 915,
    'Delta': 916,
    'Epsilon': 917,
    'Zeta': 918,
    'Eta': 919,
    'Theta': 920,
    'Iota': 921,
    'Kappa': 922,
    'Lambda': 923,
    'Mu': 924,
    'Nu': 925,
    'Xi': 926,
    'Omicron': 927,
    'Pi': 928,
    'Rho': 929,
    'Sigma': 931,
    'Tau': 932,
    'Upsilon': 933,
    'Phi': 934,
    'Chi': 935,
    'Psi': 936,
    'Omega': 937,
    'alpha': 945,
    'beta': 946,
    'gamma': 947,
    'delta': 948,
    'epsilon': 949,
    'zeta': 950,
    'eta': 951,
    'theta': 952,
    'iota': 953,
    'kappa': 954,
    'lambda': 955,
    'mu': 956,
    'nu': 957,
    'xi': 958,
    'omicron': 959,
    'pi': 960,
    'rho': 961,
    'sigmaf': 962,
    'sigma': 963,
    'tau': 964,
    'upsilon': 965,
    'phi': 966,
    'chi': 967,
    'psi': 968,
    'omega': 969,
    'thetasym': 977,
    'upsih': 978,
    'piv': 982,
    'ensp': 8194,
    'emsp': 8195,
    'thinsp': 8201,
    'zwnj': 8204,
    'zwj': 8205,
    'lrm': 8206,
    'rlm': 8207,
    'ndash': 8211,
    'mdash': 8212,
    'lsquo': 8216,
    'rsquo': 8217,
    'sbquo': 8218,
    'ldquo': 8220,
    'rdquo': 8221,
    'bdquo': 8222,
    'dagger': 8224,
    'Dagger': 8225,
    'bull': 8226,
    'hellip': 8230,
    'permil': 8240,
    'prime': 8242,
    'Prime': 8243,
    'lsaquo': 8249,
    'rsaquo': 8250,
    'oline': 8254,
    'frasl': 8260,
    'euro': 8364,
    'image': 8465,
    'weierp': 8472,
    'real': 8476,
    'trade': 8482,
    'alefsym': 8501,
    'larr': 8592,
    'uarr': 8593,
    'rarr': 8594,
    'darr': 8595,
    'harr': 8596,
    'crarr': 8629,
    'lArr': 8656,
    'uArr': 8657,
    'rArr': 8658,
    'dArr': 8659,
    'hArr': 8660,
    'forall': 8704,
    'part': 8706,
    'exist': 8707,
    'empty': 8709,
    'nabla': 8711,
    'isin': 8712,
    'notin': 8713,
    'ni': 8715,
    'prod': 8719,
    'sum': 8721,
    'minus': 8722,
    'lowast': 8727,
    'radic': 8730,
    'prop': 8733,
    'infin': 8734,
    'ang': 8736,
    'and': 8743,
    'or': 8744,
    'cap': 8745,
    'cup': 8746,
    'int': 8747,
    'there4': 8756,
    'sim': 8764,
    'cong': 8773,
    'asymp': 8776,
    'ne': 8800,
    'equiv': 8801,
    'le': 8804,
    'ge': 8805,
    'sub': 8834,
    'sup': 8835,
    'nsub': 8836,
    'sube': 8838,
    'supe': 8839,
    'oplus': 8853,
    'otimes': 8855,
    'perp': 8869,
    'sdot': 8901,
    'lceil': 8968,
    'rceil': 8969,
    'lfloor': 8970,
    'rfloor': 8971,
    'lang': 9001,
    'rang': 9002,
    'loz': 9674,
    'spades': 9824,
    'clubs': 9827,
    'hearts': 9829,
    'diams': 9830
  };

  Object.keys(sax.ENTITIES).forEach(function (key) {
    var e = sax.ENTITIES[key];
    var s = typeof e === 'number' ? String.fromCharCode(e) : e;
    sax.ENTITIES[key] = s;
  });

  for (var s in sax.STATE) {
    sax.STATE[sax.STATE[s]] = s;
  }

  // shorthand
  S = sax.STATE;

  function emit (parser, event, data) {
    parser[event] && parser[event](data);
  }

  function emitNode (parser, nodeType, data) {
    if (parser.textNode) closeText(parser);
    emit(parser, nodeType, data);
  }

  function closeText (parser) {
    parser.textNode = textopts(parser.opt, parser.textNode);
    if (parser.textNode) emit(parser, 'ontext', parser.textNode);
    parser.textNode = '';
  }

  function textopts (opt, text) {
    if (opt.trim) text = text.trim();
    if (opt.normalize) text = text.replace(/\s+/g, ' ');
    return text;
  }

  function error (parser, er) {
    closeText(parser);
    if (parser.trackPosition) {
      er += '\nLine: ' + parser.line +
        '\nColumn: ' + parser.column +
        '\nChar: ' + parser.c;
    }
    er = new Error(er);
    parser.error = er;
    emit(parser, 'onerror', er);
    return parser;
  }

  function end (parser) {
    if (parser.sawRoot && !parser.closedRoot) strictFail(parser, 'Unclosed root tag');
    if ((parser.state !== S.BEGIN) &&
      (parser.state !== S.BEGIN_WHITESPACE) &&
      (parser.state !== S.TEXT)) {
      error(parser, 'Unexpected end');
    }
    closeText(parser);
    parser.c = '';
    parser.closed = true;
    emit(parser, 'onend');
    SAXParser.call(parser, parser.strict, parser.opt);
    return parser;
  }

  function strictFail (parser, message) {
    if (typeof parser !== 'object' || !(parser instanceof SAXParser)) {
      throw new Error('bad call to strictFail');
    }
    if (parser.strict) {
      error(parser, message);
    }
  }

  function newTag (parser) {
    if (!parser.strict) parser.tagName = parser.tagName[parser.looseCase]();
    var parent = parser.tags[parser.tags.length - 1] || parser;
    var tag = parser.tag = { name: parser.tagName, attributes: {} };

    // will be overridden if tag contails an xmlns="foo" or xmlns:foo="bar"
    if (parser.opt.xmlns) {
      tag.ns = parent.ns;
    }
    parser.attribList.length = 0;
    emitNode(parser, 'onopentagstart', tag);
  }

  function qname (name, attribute) {
    var i = name.indexOf(':');
    var qualName = i < 0 ? [ '', name ] : name.split(':');
    var prefix = qualName[0];
    var local = qualName[1];

    // <x "xmlns"="http://foo">
    if (attribute && name === 'xmlns') {
      prefix = 'xmlns';
      local = '';
    }

    return { prefix: prefix, local: local };
  }

  function attrib (parser) {
    if (!parser.strict) {
      parser.attribName = parser.attribName[parser.looseCase]();
    }

    if (parser.attribList.indexOf(parser.attribName) !== -1 ||
      parser.tag.attributes.hasOwnProperty(parser.attribName)) {
      parser.attribName = parser.attribValue = '';
      return;
    }

    if (parser.opt.xmlns) {
      var qn = qname(parser.attribName, true);
      var prefix = qn.prefix;
      var local = qn.local;

      if (prefix === 'xmlns') {
        // namespace binding attribute. push the binding into scope
        if (local === 'xml' && parser.attribValue !== XML_NAMESPACE) {
          strictFail(parser,
            'xml: prefix must be bound to ' + XML_NAMESPACE + '\n' +
            'Actual: ' + parser.attribValue);
        } else if (local === 'xmlns' && parser.attribValue !== XMLNS_NAMESPACE) {
          strictFail(parser,
            'xmlns: prefix must be bound to ' + XMLNS_NAMESPACE + '\n' +
            'Actual: ' + parser.attribValue);
        } else {
          var tag = parser.tag;
          var parent = parser.tags[parser.tags.length - 1] || parser;
          if (tag.ns === parent.ns) {
            tag.ns = Object.create(parent.ns);
          }
          tag.ns[local] = parser.attribValue;
        }
      }

      // defer onattribute events until all attributes have been seen
      // so any new bindings can take effect. preserve attribute order
      // so deferred events can be emitted in document order
      parser.attribList.push([parser.attribName, parser.attribValue]);
    } else {
      // in non-xmlns mode, we can emit the event right away
      parser.tag.attributes[parser.attribName] = parser.attribValue;
      emitNode(parser, 'onattribute', {
        name: parser.attribName,
        value: parser.attribValue
      });
    }

    parser.attribName = parser.attribValue = '';
  }

  function openTag (parser, selfClosing) {
    if (parser.opt.xmlns) {
      // emit namespace binding events
      var tag = parser.tag;

      // add namespace info to tag
      var qn = qname(parser.tagName);
      tag.prefix = qn.prefix;
      tag.local = qn.local;
      tag.uri = tag.ns[qn.prefix] || '';

      if (tag.prefix && !tag.uri) {
        strictFail(parser, 'Unbound namespace prefix: ' +
          JSON.stringify(parser.tagName));
        tag.uri = qn.prefix;
      }

      var parent = parser.tags[parser.tags.length - 1] || parser;
      if (tag.ns && parent.ns !== tag.ns) {
        Object.keys(tag.ns).forEach(function (p) {
          emitNode(parser, 'onopennamespace', {
            prefix: p,
            uri: tag.ns[p]
          });
        });
      }

      // handle deferred onattribute events
      // Note: do not apply default ns to attributes:
      //   http://www.w3.org/TR/REC-xml-names/#defaulting
      for (var i = 0, l = parser.attribList.length; i < l; i++) {
        var nv = parser.attribList[i];
        var name = nv[0];
        var value = nv[1];
        var qualName = qname(name, true);
        var prefix = qualName.prefix;
        var local = qualName.local;
        var uri = prefix === '' ? '' : (tag.ns[prefix] || '');
        var a = {
          name: name,
          value: value,
          prefix: prefix,
          local: local,
          uri: uri
        };

        // if there's any attributes with an undefined namespace,
        // then fail on them now.
        if (prefix && prefix !== 'xmlns' && !uri) {
          strictFail(parser, 'Unbound namespace prefix: ' +
            JSON.stringify(prefix));
          a.uri = prefix;
        }
        parser.tag.attributes[name] = a;
        emitNode(parser, 'onattribute', a);
      }
      parser.attribList.length = 0;
    }

    parser.tag.isSelfClosing = !!selfClosing;

    // process the tag
    parser.sawRoot = true;
    parser.tags.push(parser.tag);
    emitNode(parser, 'onopentag', parser.tag);
    if (!selfClosing) {
      // special case for <script> in non-strict mode.
      if (!parser.noscript && parser.tagName.toLowerCase() === 'script') {
        parser.state = S.SCRIPT;
      } else {
        parser.state = S.TEXT;
      }
      parser.tag = null;
      parser.tagName = '';
    }
    parser.attribName = parser.attribValue = '';
    parser.attribList.length = 0;
  }

  function closeTag (parser) {
    if (!parser.tagName) {
      strictFail(parser, 'Weird empty close tag.');
      parser.textNode += '</>';
      parser.state = S.TEXT;
      return;
    }

    if (parser.script) {
      if (parser.tagName !== 'script') {
        parser.script += '</' + parser.tagName + '>';
        parser.tagName = '';
        parser.state = S.SCRIPT;
        return;
      }
      emitNode(parser, 'onscript', parser.script);
      parser.script = '';
    }

    // first make sure that the closing tag actually exists.
    // <a><b></c></b></a> will close everything, otherwise.
    var t = parser.tags.length;
    var tagName = parser.tagName;
    if (!parser.strict) {
      tagName = tagName[parser.looseCase]();
    }
    var closeTo = tagName;
    while (t--) {
      var close = parser.tags[t];
      if (close.name !== closeTo) {
        // fail the first time in strict mode
        strictFail(parser, 'Unexpected close tag');
      } else {
        break;
      }
    }

    // didn't find it.  we already failed for strict, so just abort.
    if (t < 0) {
      strictFail(parser, 'Unmatched closing tag: ' + parser.tagName);
      parser.textNode += '</' + parser.tagName + '>';
      parser.state = S.TEXT;
      return;
    }
    parser.tagName = tagName;
    var s = parser.tags.length;
    while (s-- > t) {
      var tag = parser.tag = parser.tags.pop();
      parser.tagName = parser.tag.name;
      emitNode(parser, 'onclosetag', parser.tagName);

      var x = {};
      for (var i in tag.ns) {
        x[i] = tag.ns[i];
      }

      var parent = parser.tags[parser.tags.length - 1] || parser;
      if (parser.opt.xmlns && tag.ns !== parent.ns) {
        // remove namespace bindings introduced by tag
        Object.keys(tag.ns).forEach(function (p) {
          var n = tag.ns[p];
          emitNode(parser, 'onclosenamespace', { prefix: p, uri: n });
        });
      }
    }
    if (t === 0) parser.closedRoot = true;
    parser.tagName = parser.attribValue = parser.attribName = '';
    parser.attribList.length = 0;
    parser.state = S.TEXT;
  }

  function parseEntity (parser) {
    var entity = parser.entity;
    var entityLC = entity.toLowerCase();
    var num;
    var numStr = '';

    if (parser.ENTITIES[entity]) {
      return parser.ENTITIES[entity];
    }
    if (parser.ENTITIES[entityLC]) {
      return parser.ENTITIES[entityLC];
    }
    entity = entityLC;
    if (entity.charAt(0) === '#') {
      if (entity.charAt(1) === 'x') {
        entity = entity.slice(2);
        num = parseInt(entity, 16);
        numStr = num.toString(16);
      } else {
        entity = entity.slice(1);
        num = parseInt(entity, 10);
        numStr = num.toString(10);
      }
    }
    entity = entity.replace(/^0+/, '');
    if (numStr.toLowerCase() !== entity) {
      strictFail(parser, 'Invalid character entity');
      return '&' + parser.entity + ';';
    }

    return String.fromCodePoint(num);
  }

  function beginWhiteSpace (parser, c) {
    if (c === '<') {
      parser.state = S.OPEN_WAKA;
      parser.startTagPosition = parser.position;
    } else if (not(whitespace, c)) {
      // have to process this as a text node.
      // weird, but happens.
      strictFail(parser, 'Non-whitespace before first tag.');
      parser.textNode = c;
      parser.state = S.TEXT;
    }
  }

  function charAt (chunk, i) {
    var result = '';
    if (i < chunk.length) {
      result = chunk.charAt(i);
    }
    return result;
  }

  function write (chunk) {
    var parser = this;
    if (this.error) {
      throw this.error;
    }
    if (parser.closed) {
      return error(parser,
        'Cannot write after close. Assign an onready handler.');
    }
    if (chunk === null) {
      return end(parser);
    }
    if (typeof chunk === 'object') {
      chunk = chunk.toString();
    }
    var i = 0;
    var c = '';
    while (true) {
      c = charAt(chunk, i++);
      parser.c = c;
      if (!c) {
        break;
      }
      if (parser.trackPosition) {
        parser.position++;
        if (c === '\n') {
          parser.line++;
          parser.column = 0;
        } else {
          parser.column++;
        }
      }
      switch (parser.state) {
        case S.BEGIN:
          parser.state = S.BEGIN_WHITESPACE;
          if (c === '\uFEFF') {
            continue;
          }
          beginWhiteSpace(parser, c);
          continue;

        case S.BEGIN_WHITESPACE:
          beginWhiteSpace(parser, c);
          continue;

        case S.TEXT:
          if (parser.sawRoot && !parser.closedRoot) {
            var starti = i - 1;
            while (c && c !== '<' && c !== '&') {
              c = charAt(chunk, i++);
              if (c && parser.trackPosition) {
                parser.position++;
                if (c === '\n') {
                  parser.line++;
                  parser.column = 0;
                } else {
                  parser.column++;
                }
              }
            }
            parser.textNode += chunk.substring(starti, i - 1);
          }
          if (c === '<' && !(parser.sawRoot && parser.closedRoot && !parser.strict)) {
            parser.state = S.OPEN_WAKA;
            parser.startTagPosition = parser.position;
          } else {
            if (not(whitespace, c) && (!parser.sawRoot || parser.closedRoot)) {
              strictFail(parser, 'Text data outside of root node.');
            }
            if (c === '&') {
              parser.state = S.TEXT_ENTITY;
            } else {
              parser.textNode += c;
            }
          }
          continue;

        case S.SCRIPT:
          // only non-strict
          if (c === '<') {
            parser.state = S.SCRIPT_ENDING;
          } else {
            parser.script += c;
          }
          continue;

        case S.SCRIPT_ENDING:
          if (c === '/') {
            parser.state = S.CLOSE_TAG;
          } else {
            parser.script += '<' + c;
            parser.state = S.SCRIPT;
          }
          continue;

        case S.OPEN_WAKA:
          // either a /, ?, !, or text is coming next.
          if (c === '!') {
            parser.state = S.SGML_DECL;
            parser.sgmlDecl = '';
          } else if (is(whitespace, c)) {
            // wait for it...
          } else if (is(nameStart, c)) {
            parser.state = S.OPEN_TAG;
            parser.tagName = c;
          } else if (c === '/') {
            parser.state = S.CLOSE_TAG;
            parser.tagName = '';
          } else if (c === '?') {
            parser.state = S.PROC_INST;
            parser.procInstName = parser.procInstBody = '';
          } else {
            strictFail(parser, 'Unencoded <');
            // if there was some whitespace, then add that in.
            if (parser.startTagPosition + 1 < parser.position) {
              var pad = parser.position - parser.startTagPosition;
              c = new Array(pad).join(' ') + c;
            }
            parser.textNode += '<' + c;
            parser.state = S.TEXT;
          }
          continue;

        case S.SGML_DECL:
          if ((parser.sgmlDecl + c).toUpperCase() === CDATA) {
            emitNode(parser, 'onopencdata');
            parser.state = S.CDATA;
            parser.sgmlDecl = '';
            parser.cdata = '';
          } else if (parser.sgmlDecl + c === '--') {
            parser.state = S.COMMENT;
            parser.comment = '';
            parser.sgmlDecl = '';
          } else if ((parser.sgmlDecl + c).toUpperCase() === DOCTYPE) {
            parser.state = S.DOCTYPE;
            if (parser.doctype || parser.sawRoot) {
              strictFail(parser,
                'Inappropriately located doctype declaration');
            }
            parser.doctype = '';
            parser.sgmlDecl = '';
          } else if (c === '>') {
            emitNode(parser, 'onsgmldeclaration', parser.sgmlDecl);
            parser.sgmlDecl = '';
            parser.state = S.TEXT;
          } else if (is(quote, c)) {
            parser.state = S.SGML_DECL_QUOTED;
            parser.sgmlDecl += c;
          } else {
            parser.sgmlDecl += c;
          }
          continue;

        case S.SGML_DECL_QUOTED:
          if (c === parser.q) {
            parser.state = S.SGML_DECL;
            parser.q = '';
          }
          parser.sgmlDecl += c;
          continue;

        case S.DOCTYPE:
          if (c === '>') {
            parser.state = S.TEXT;
            emitNode(parser, 'ondoctype', parser.doctype);
            parser.doctype = true; // just remember that we saw it.
          } else {
            parser.doctype += c;
            if (c === '[') {
              parser.state = S.DOCTYPE_DTD;
            } else if (is(quote, c)) {
              parser.state = S.DOCTYPE_QUOTED;
              parser.q = c;
            }
          }
          continue;

        case S.DOCTYPE_QUOTED:
          parser.doctype += c;
          if (c === parser.q) {
            parser.q = '';
            parser.state = S.DOCTYPE;
          }
          continue;

        case S.DOCTYPE_DTD:
          parser.doctype += c;
          if (c === ']') {
            parser.state = S.DOCTYPE;
          } else if (is(quote, c)) {
            parser.state = S.DOCTYPE_DTD_QUOTED;
            parser.q = c;
          }
          continue;

        case S.DOCTYPE_DTD_QUOTED:
          parser.doctype += c;
          if (c === parser.q) {
            parser.state = S.DOCTYPE_DTD;
            parser.q = '';
          }
          continue;

        case S.COMMENT:
          if (c === '-') {
            parser.state = S.COMMENT_ENDING;
          } else {
            parser.comment += c;
          }
          continue;

        case S.COMMENT_ENDING:
          if (c === '-') {
            parser.state = S.COMMENT_ENDED;
            parser.comment = textopts(parser.opt, parser.comment);
            if (parser.comment) {
              emitNode(parser, 'oncomment', parser.comment);
            }
            parser.comment = '';
          } else {
            parser.comment += '-' + c;
            parser.state = S.COMMENT;
          }
          continue;

        case S.COMMENT_ENDED:
          if (c !== '>') {
            strictFail(parser, 'Malformed comment');
            // allow <!-- blah -- bloo --> in non-strict mode,
            // which is a comment of " blah -- bloo "
            parser.comment += '--' + c;
            parser.state = S.COMMENT;
          } else {
            parser.state = S.TEXT;
          }
          continue;

        case S.CDATA:
          if (c === ']') {
            parser.state = S.CDATA_ENDING;
          } else {
            parser.cdata += c;
          }
          continue;

        case S.CDATA_ENDING:
          if (c === ']') {
            parser.state = S.CDATA_ENDING_2;
          } else {
            parser.cdata += ']' + c;
            parser.state = S.CDATA;
          }
          continue;

        case S.CDATA_ENDING_2:
          if (c === '>') {
            if (parser.cdata) {
              emitNode(parser, 'oncdata', parser.cdata);
            }
            emitNode(parser, 'onclosecdata');
            parser.cdata = '';
            parser.state = S.TEXT;
          } else if (c === ']') {
            parser.cdata += ']';
          } else {
            parser.cdata += ']]' + c;
            parser.state = S.CDATA;
          }
          continue;

        case S.PROC_INST:
          if (c === '?') {
            parser.state = S.PROC_INST_ENDING;
          } else if (is(whitespace, c)) {
            parser.state = S.PROC_INST_BODY;
          } else {
            parser.procInstName += c;
          }
          continue;

        case S.PROC_INST_BODY:
          if (!parser.procInstBody && is(whitespace, c)) {
            continue;
          } else if (c === '?') {
            parser.state = S.PROC_INST_ENDING;
          } else {
            parser.procInstBody += c;
          }
          continue;

        case S.PROC_INST_ENDING:
          if (c === '>') {
            emitNode(parser, 'onprocessinginstruction', {
              name: parser.procInstName,
              body: parser.procInstBody
            });
            parser.procInstName = parser.procInstBody = '';
            parser.state = S.TEXT;
          } else {
            parser.procInstBody += '?' + c;
            parser.state = S.PROC_INST_BODY;
          }
          continue;

        case S.OPEN_TAG:
          if (is(nameBody, c)) {
            parser.tagName += c;
          } else {
            newTag(parser);
            if (c === '>') {
              openTag(parser);
            } else if (c === '/') {
              parser.state = S.OPEN_TAG_SLASH;
            } else {
              if (not(whitespace, c)) {
                strictFail(parser, 'Invalid character in tag name');
              }
              parser.state = S.ATTRIB;
            }
          }
          continue;

        case S.OPEN_TAG_SLASH:
          if (c === '>') {
            openTag(parser, true);
            closeTag(parser);
          } else {
            strictFail(parser, 'Forward-slash in opening tag not followed by >');
            parser.state = S.ATTRIB;
          }
          continue;

        case S.ATTRIB:
          // haven't read the attribute name yet.
          if (is(whitespace, c)) {
            continue;
          } else if (c === '>') {
            openTag(parser);
          } else if (c === '/') {
            parser.state = S.OPEN_TAG_SLASH;
          } else if (is(nameStart, c)) {
            parser.attribName = c;
            parser.attribValue = '';
            parser.state = S.ATTRIB_NAME;
          } else {
            strictFail(parser, 'Invalid attribute name');
          }
          continue;

        case S.ATTRIB_NAME:
          if (c === '=') {
            parser.state = S.ATTRIB_VALUE;
          } else if (c === '>') {
            strictFail(parser, 'Attribute without value');
            parser.attribValue = parser.attribName;
            attrib(parser);
            openTag(parser);
          } else if (is(whitespace, c)) {
            parser.state = S.ATTRIB_NAME_SAW_WHITE;
          } else if (is(nameBody, c)) {
            parser.attribName += c;
          } else {
            strictFail(parser, 'Invalid attribute name');
          }
          continue;

        case S.ATTRIB_NAME_SAW_WHITE:
          if (c === '=') {
            parser.state = S.ATTRIB_VALUE;
          } else if (is(whitespace, c)) {
            continue;
          } else {
            strictFail(parser, 'Attribute without value');
            parser.tag.attributes[parser.attribName] = '';
            parser.attribValue = '';
            emitNode(parser, 'onattribute', {
              name: parser.attribName,
              value: ''
            });
            parser.attribName = '';
            if (c === '>') {
              openTag(parser);
            } else if (is(nameStart, c)) {
              parser.attribName = c;
              parser.state = S.ATTRIB_NAME;
            } else {
              strictFail(parser, 'Invalid attribute name');
              parser.state = S.ATTRIB;
            }
          }
          continue;

        case S.ATTRIB_VALUE:
          if (is(whitespace, c)) {
            continue;
          } else if (is(quote, c)) {
            parser.q = c;
            parser.state = S.ATTRIB_VALUE_QUOTED;
          } else {
            strictFail(parser, 'Unquoted attribute value');
            parser.state = S.ATTRIB_VALUE_UNQUOTED;
            parser.attribValue = c;
          }
          continue;

        case S.ATTRIB_VALUE_QUOTED:
          if (c !== parser.q) {
            if (c === '&') {
              parser.state = S.ATTRIB_VALUE_ENTITY_Q;
            } else {
              parser.attribValue += c;
            }
            continue;
          }
          attrib(parser);
          parser.q = '';
          parser.state = S.ATTRIB_VALUE_CLOSED;
          continue;

        case S.ATTRIB_VALUE_CLOSED:
          if (is(whitespace, c)) {
            parser.state = S.ATTRIB;
          } else if (c === '>') {
            openTag(parser);
          } else if (c === '/') {
            parser.state = S.OPEN_TAG_SLASH;
          } else if (is(nameStart, c)) {
            strictFail(parser, 'No whitespace between attributes');
            parser.attribName = c;
            parser.attribValue = '';
            parser.state = S.ATTRIB_NAME;
          } else {
            strictFail(parser, 'Invalid attribute name');
          }
          continue;

        case S.ATTRIB_VALUE_UNQUOTED:
          if (not(attribEnd, c)) {
            if (c === '&') {
              parser.state = S.ATTRIB_VALUE_ENTITY_U;
            } else {
              parser.attribValue += c;
            }
            continue;
          }
          attrib(parser);
          if (c === '>') {
            openTag(parser);
          } else {
            parser.state = S.ATTRIB;
          }
          continue;

        case S.CLOSE_TAG:
          if (!parser.tagName) {
            if (is(whitespace, c)) {
              continue;
            } else if (not(nameStart, c)) {
              if (parser.script) {
                parser.script += '</' + c;
                parser.state = S.SCRIPT;
              } else {
                strictFail(parser, 'Invalid tagname in closing tag.');
              }
            } else {
              parser.tagName = c;
            }
          } else if (c === '>') {
            closeTag(parser);
          } else if (is(nameBody, c)) {
            parser.tagName += c;
          } else if (parser.script) {
            parser.script += '</' + parser.tagName;
            parser.tagName = '';
            parser.state = S.SCRIPT;
          } else {
            if (not(whitespace, c)) {
              strictFail(parser, 'Invalid tagname in closing tag');
            }
            parser.state = S.CLOSE_TAG_SAW_WHITE;
          }
          continue;

        case S.CLOSE_TAG_SAW_WHITE:
          if (is(whitespace, c)) {
            continue;
          }
          if (c === '>') {
            closeTag(parser);
          } else {
            strictFail(parser, 'Invalid characters in closing tag');
          }
          continue;

        case S.TEXT_ENTITY:
        case S.ATTRIB_VALUE_ENTITY_Q:
        case S.ATTRIB_VALUE_ENTITY_U:
          var returnState;
          var buffer;
          switch (parser.state) {
            case S.TEXT_ENTITY:
              returnState = S.TEXT;
              buffer = 'textNode';
              break;

            case S.ATTRIB_VALUE_ENTITY_Q:
              returnState = S.ATTRIB_VALUE_QUOTED;
              buffer = 'attribValue';
              break;

            case S.ATTRIB_VALUE_ENTITY_U:
              returnState = S.ATTRIB_VALUE_UNQUOTED;
              buffer = 'attribValue';
              break;
          }

          if (c === ';') {
            parser[buffer] += parseEntity(parser);
            parser.entity = '';
            parser.state = returnState;
          } else if (is(parser.entity.length ? entityBody : entityStart, c)) {
            parser.entity += c;
          } else {
            strictFail(parser, 'Invalid character in entity name');
            parser[buffer] += '&' + parser.entity + c;
            parser.entity = '';
            parser.state = returnState;
          }

          continue;

        default:
          throw new Error(parser, 'Unknown state: ' + parser.state);
      }
    } // while

    if (parser.position >= parser.bufferCheckPosition) {
      checkBufferLength(parser);
    }
    return parser;
  }

  /*! http://mths.be/fromcodepoint v0.1.0 by @mathias */
  if (!String.fromCodePoint) {
    (function () {
      var stringFromCharCode = String.fromCharCode;
      var floor = Math.floor;
      var fromCodePoint = function () {
        var MAX_SIZE = 0x4000;
        var codeUnits = [];
        var highSurrogate;
        var lowSurrogate;
        var index = -1;
        var length = arguments.length;
        if (!length) {
          return '';
        }
        var result = '';
        while (++index < length) {
          var codePoint = Number(arguments[index]);
          if (
            !isFinite(codePoint) || // `NaN`, `+Infinity`, or `-Infinity`
            codePoint < 0 || // not a valid Unicode code point
            codePoint > 0x10FFFF || // not a valid Unicode code point
            floor(codePoint) !== codePoint // not an integer
          ) {
            throw RangeError('Invalid code point: ' + codePoint);
          }
          if (codePoint <= 0xFFFF) { // BMP code point
            codeUnits.push(codePoint);
          } else { // Astral code point; split in surrogate halves
            // http://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae
            codePoint -= 0x10000;
            highSurrogate = (codePoint >> 10) + 0xD800;
            lowSurrogate = (codePoint % 0x400) + 0xDC00;
            codeUnits.push(highSurrogate, lowSurrogate);
          }
          if (index + 1 === length || codeUnits.length > MAX_SIZE) {
            result += stringFromCharCode.apply(null, codeUnits);
            codeUnits.length = 0;
          }
        }
        return result;
      };
      if (Object.defineProperty) {
        Object.defineProperty(String, 'fromCodePoint', {
          value: fromCodePoint,
          configurable: true,
          writable: true
        });
      } else {
        String.fromCodePoint = fromCodePoint;
      }
    }());
  }
})(typeof exports === "undefined" ? sax = VG.sax : exports);


/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.Core.SVG=function( name, data, options, dontAddToPool )
{
    if ( !(this instanceof VG.Core.SVG) ) return new VG.Core.SVG( name, data, options );

    var strict = true;
    parser = VG.sax.parser( strict );

    this.name=name;
    this.data=data;

    groups=[];

    var currentGroup=null, groupDepth=0;

    function createGroup( node )
    {
        var group={ name : 'Unnamed', pathNodes : [], polygonNodes : [], rectNodes : [], ellipseNodes : [] };
        if ( node.attributes.id )
            group.name=node.attributes.id;
        currentGroup=group;
        groups.push( group );
    }

    parser.onopentag = function (node) {
        //console.log( 'onopentag', node, groupDepth );

        if ( node.name === "g" )
        {
            if ( groupDepth === 0 )
            {
                createGroup( node );
            }
            ++groupDepth;
        } else
        if ( node.name === "path" )
        {
            if ( !currentGroup ) createGroup( node );

            currentGroup.pathNodes.push( node );
            currentGroup.hasContent=true;
        } else
        if ( node.name === "polygon" )
        {
            if ( !currentGroup ) createGroup( node );

            currentGroup.polygonNodes.push( node );
            currentGroup.hasContent=true;
        } else
        if ( node.name === "rect" && currentGroup && currentGroup.hasContent )
        {
            if ( !currentGroup ) createGroup( node );
            currentGroup.rectNodes.push( node );
        }  else
        if ( node.name === "rect" )
        {
            if ( !currentGroup ) createGroup( node );

            currentGroup.rectNodes.push( node );
        } else
        if ( node.name === "ellipse" )
        {
            if ( !currentGroup ) createGroup( node );

            currentGroup.ellipseNodes.push( node );
        } else
        if ( node.name === "circle" )
        {
            if ( !currentGroup ) createGroup( node );

            currentGroup.ellipseNodes.push( node );
        }
    };

    parser.onclosetag = function (name) {
        //console.log( 'onclosetag', name );

        if ( name === "g" ) --groupDepth;
    };

    parser.write( data ).close();

    this.curveDiv=options && options.curveDiv ? options.curveDiv : 20;
    var createPolygons=true;
    if ( options && options.noPolygons )
        createPolygons=false;

    if ( groups.length )
        this.groups=groups;

    this.tris=[];

    if ( createPolygons )
    {
        for ( var i=0; i < this.groups.length; ++i )
            this.createPolygonsForGroup( this.groups[i] );

        if ( !dontAddToPool )
            VG.context.svgPool.addSVG( this );
    }
};

VG.Core.SVG.prototype.getGroupByName=function( name )
{
    if ( !name || ( name && !name.length ) )
    {
        if ( this.groups.length ) return this.groups[0];
        else return undefined;
    }

    for ( var i=0; i < this.groups.length; ++ i)
    {
        if ( this.groups[i].name === name )
            return this.groups[i];
    }

    return undefined;
};

VG.Core.SVG.prototype.getGroupByIndex=function( index )
{
    if ( index < this.groups.length ) return this.groups[index];
    return undefined;
};

VG.Core.SVG.prototype.createPolygonsForGroup=function( group )
{
    group.polygons=[];
    group.triOffset=this.tris.length;

    for ( i=0; i < group.pathNodes.length; ++i )
    {
        path=group.pathNodes[i];
        polys=[];

        this.createPolygonsForPath( path.attributes.d, polys );
        for ( k=0; k < polys.length; ++k) group.polygons.push( polys[k] );

        // ---

        this.triangulatePolygons( group, polys );
    }

    for ( i=0; i < group.polygonNodes.length; ++i )
    {
        poly=group.polygonNodes[i];
        polys=[];

        this.createPolygonsForPoly( poly.attributes.points, polys );
        for ( k=0; k < polys.length; ++k) group.polygons.push( polys[k] );

        this.triangulatePolygons( group, polys );
    }

    for ( i=0; i < group.rectNodes.length; ++i )
    {
        rect=group.rectNodes[i];
        polys=[];

        this.createPolygonsForRect( Number(rect.attributes.x), Number(rect.attributes.y), Number(rect.attributes.width),
            Number(rect.attributes.height), polys );

        this.triangulatePolygons( group, polys );
        for ( k=0; k < polys.length; ++k) group.polygons.push( polys[k] );
    }

    for ( i=0; i < group.ellipseNodes.length; ++i )
    {
        rect=group.ellipseNodes[i];
        polys=[];

        if ( rect.attributes.r )
            this.createPolygonsForEllipse( Number(rect.attributes.cx), Number(rect.attributes.cy), Number(rect.attributes.r),
                Number(rect.attributes.r), polys );
        else
            this.createPolygonsForEllipse( Number(rect.attributes.cx), Number(rect.attributes.cy), Number(rect.attributes.rx),
                Number(rect.attributes.ry), polys );

        this.triangulatePolygons( group, polys );
        for ( k=0; k < polys.length; ++k) group.polygons.push( polys[k] );
    }

    this.createBoundingBoxForGroup( group );
    //this.normalizeGroupPolygons( group );

    group.triSize=this.tris.length - group.triOffset - 1;
};

VG.Core.SVG.prototype.triangulatePolygons=function( group, polygons )
{
    var i=0;

    var contourOrientation=false;

    if ( polygons.length )
        contourOrientation=this.clockwise( polygons[0] );

    while ( i < polygons.length )
    {
        var polygon=polygons[i];

        if ( polygon.length && this.clockwise( polygon ) === contourOrientation )
        {
            var holes=[];
            var contour=[];

            for ( o=0; o < polygon.length; ++o )
            {
                contour.push( polygon[o].x, polygon[o].y );
            }

            var contourOffset=contour.length;

            for ( var j=i+1; j < polygons.length; ++j )
            {
                var invContourOrientation=!contourOrientation;
                if ( polygons[j].length && this.clockwise( polygons[j] ) === invContourOrientation )
                {
                    holes.push( contour.length / 2 );

                    for ( o=0; o < polygons[j].length; ++o )
                    {
                        var hpoly=polygons[j];
                        contour.push( hpoly[o].x, hpoly[o].y );
                    }
                } else break;
            }

            var indices=VG.Utils.earcut( contour, holes );

            for ( var t=0; t < indices.length; ++t )
            {
                var index=indices[t] * 2;
                this.tris.push( contour[index], contour[index + 1] );
            }
        }
        ++i;
    }
};

VG.Core.SVG.prototype.normalizeGroupPolygons=function( group )
{
    for ( var i=0; i < group.polygons.length; ++i )
    {
        var poly=group.polygons[i];

        for ( var pi=0; pi < poly.length; ++pi )
        {
            var p=poly[pi];

            p.x-=group.bbox.minX;
            p.y-=group.bbox.minY;

            p.x/=1.0 / group.bbox.width;
            p.y/=1.0 / group.bbox.height;
        }
    }
};

VG.Core.SVG.prototype.createBoundingBoxForGroup=function( group )
{
    var bbox={ maxX : -100000, minX : 100000, maxY : -100000, minY : 100000 };

    for ( var i=0; i < group.polygons.length; ++i )
    {
        var poly=group.polygons[i];

        for ( var pi=0; pi < poly.length; ++pi )
        {
            var p=poly[pi];

            if ( p.x > bbox.maxX ) bbox.maxX=p.x;
            if ( p.y > bbox.maxY ) bbox.maxY=p.y;

            if ( p.x < bbox.minX ) bbox.minX=p.x;
            if ( p.y < bbox.minY ) bbox.minY=p.y;
        }
    }

    group.width=bbox.maxX - bbox.minX;
    group.height=bbox.maxY - bbox.minY;

    group.bbox=bbox;
};

VG.Core.SVG.prototype.createPolygonsForRect=function( x, y, width, height, polygons )
{
    var poly=[];

    poly.push( { x : x, y : y } );
    poly.push( { x : x, y : y+height } );
    poly.push( { x : x + width, y : y+height } );
    poly.push( { x : x + width, y : y } );
    poly.push( { x : x, y : y } );

    polygons.push( poly );
};

VG.Core.SVG.prototype.createPolygonsForEllipse=function( cx, cy, rx, ry, polygons )
{
    var poly=[];

    var step=2 * Math.PI / 60; // 60 Segments
    for ( var theta=0; theta <= 2 * Math.PI; theta+=step )
    {
        var x=cx + Math.cos( theta ) * rx;
        var y=cy + Math.sin( theta ) * ry;

        poly.push( { x : x, y : y } );
    }

    polygons.push( poly );
};

VG.Core.SVG.prototype.createPolygonsForPoly=function( polyText, polygons )
{
    var pairs=polyText.split( " " );
    var poly=[];

    for( var i=0; i < pairs.length; ++i )
    {
        var pair=pairs[i];

        if ( pair.length && pair.indexOf( ',') !== -1 )
        {
            var points=pair.split( ',' );

            var p={ x : Number(points[0]), y : Number(points[1]) };
            poly.push( p );
        }
    }

    if ( poly.length ) polygons.push( poly );
};

VG.Core.SVG.prototype.createPolygonsForPath=function( path, polygons )
{
    var cmdArray=VG.Core.SVG.path_parser( path );

    var points=[];
    var p={};

    var lCubicControlPoint={ x: -100000, y: -100000 };
    var lQuadraticControlPoint={ x: -100000, y: -100000 };

    for ( var i=0; i < cmdArray.length; ++i )
    {
        var cmd=cmdArray[i];

        switch( cmd[0] )
        {
            case 'Z' :
            case 'z' :
            {
                if ( polygons.indexOf( points ) === -1 && points.length )
                    polygons.push( points );

                points=[];
            }
            break;

            case 'M' :
            {
                p.x=cmd[1]; p.y=cmd[2];

                points.push( { x : p.x, y : p.y } );
            }
            break;

            case 'm' :
            {
                p.x+=cmd[1]; p.y+=cmd[2];

                points.push( { x : p.x, y : p.y } );
            }
            break;

            case 'L' :
            {
                points.push( { x : cmd[1], y : cmd[2] } );
                p.x=cmd[1]; p.y=cmd[2];
            }
            break;

            case 'l' :
            {
                points.push( { x : cmd[1] + p.x, y : cmd[2] + p.y } );
                p.x+=cmd[1]; p.y+=cmd[2];
            }
            break;

            case 'H' :
            {
                points.push( { x : cmd[1], y : p.y } );
                p.x=cmd[1];
            }
            break;

            case 'h' :
            {
                points.push( { x : cmd[1] + p.x, y : p.y } );
                p.x+=cmd[1];
            }
            break;

            case 'V' :
            {
                points.push( { x : p.x, y : cmd[1] } );
                p.y=cmd[1];
            }
            break;

            case 'v' :
            {
                points.push( { x :  p.x, y : cmd[1] + p.y } );
                p.y+=cmd[1];
            }
            break;

            case 'C' :
            {
                cx1=cmd[1];
                cy1=cmd[2];
                cx2=cmd[3];
                cy2=cmd[4];
                dx=cmd[5];
                dy=cmd[6];

                lCubicControlPoint.x=cx2;
                lCubicControlPoint.y=cy2;

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezierCubic(t, p.x, cx1, cx2, dx );
                    ty = VG.Math.bezierCubic(t, p.y, cy1, cy2, dy );

                    points.push( { x : tx, y : ty } );
                }

                p.x=dx; p.y=dy;
            }
            break;

            case 'c' :
            {
                cx1=cmd[1] + p.x;
                cy1=cmd[2] + p.y;
                cx2=cmd[3] + p.x;
                cy2=cmd[4] + p.y;
                dx=cmd[5] + p.x;
                dy=cmd[6] + p.y;

                lCubicControlPoint.x=cx2;
                lCubicControlPoint.y=cy2;

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezierCubic(t, p.x, cx1, cx2, dx );
                    ty = VG.Math.bezierCubic(t, p.y, cy1, cy2, dy );

                    points.push( { x : tx, y : ty } );
                }
                p.x=dx; p.y=dy;

            }
            break;

            case 'S' :
            {
                cx1=2 * p.x - lCubicControlPoint.x;
                cy1=2 * p.y - lCubicControlPoint.y;
                cx2=cmd[1];
                cy2=cmd[2];
                dx=cmd[3];
                dy=cmd[4];

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezierCubic(t, p.x, cx1, cx2, dx );
                    ty = VG.Math.bezierCubic(t, p.y, cy1, cy2, dy );

                    points.push( { x : tx, y : ty } );
                }

                p.x=dx; p.y=dy;
            }
            break;

            case 's' :
            {
                cx1=2 * p.x - lCubicControlPoint.x;
                cy1=2 * p.y - lCubicControlPoint.y;
                cx2=cmd[1] + p.x;
                cy2=cmd[2] + p.y;
                dx=cmd[3] + p.x;
                dy=cmd[4] + p.y;

                seg=this.curveDiv;

                for (j = 1; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezierCubic(t, p.x, cx1, cx2, dx );
                    ty = VG.Math.bezierCubic(t, p.y, cy1, cy2, dy );

                    points.push( { x : tx, y : ty } );
                }
                p.x=dx; p.y=dy;

            }
            break;

            case 'Q' :
            {
                cx1=cmd[1];
                cy1=cmd[2];
                dx=cmd[3];
                dy=cmd[4];

                lQuadraticControlPoint.x=cx1;
                lQuadraticControlPoint.y=cy2;

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezier(t, p.x, cx1, dx );
                    ty = VG.Math.bezier(t, p.y, cy1, dy );

                    points.push( { x : tx, y : ty } );
                }

                p.x=dx; p.y=dy;
            }
            break;

            case 'q' :
            {
                cx1=cmd[1] + p.x;
                cy1=cmd[2] + p.y;
                dx=cmd[3] + p.x;
                dy=cmd[4] + p.y;

                lQuadraticControlPoint.x=cx2;
                lQuadraticControlPoint.y=cy2;

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezier(t, p.x, cx1, dx );
                    ty = VG.Math.bezier(t, p.y, cy1, dy );

                    points.push( { x : tx, y : ty } );
                }
                p.x=dx; p.y=dy;

            }
            break;

            case 'T' :
            {
                cx1=lQuadraticControlPoint.x;
                cy1=lQuadraticControlPoint.y;
                dx=cmd[1];
                dy=cmd[2];

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezier(t, p.x, cx1, dx );
                    ty = VG.Math.bezier(t, p.y, cy1, dy );

                    points.push( { x : tx, y : ty } );
                }

                p.x=dx; p.y=dy;
            }
            break;

            case 't' :
            {
                cx1=lQuadraticControlPoint.x;
                cy1=lQuadraticControlPoint.y;
                dx=cmd[1] + p.x;
                dy=cmd[2] + p.y;

                if ( cx1 === -100000 ) cx1=p.x;
                if ( cy1 === -100000 ) cy1=p.y;

                seg=this.curveDiv;

                for (j = 1, seg = seg; j <= seg; j++)
                {
                    t = j / seg;
                    tx = VG.Math.bezier(t, p.x, cx1, dx );
                    ty = VG.Math.bezier(t, p.y, cy1, dy );

                    points.push( { x : tx, y : ty } );
                }
                p.x=dx; p.y=dy;

            }
            break;

            default:
                VG.log( cmd[0] );
            break;
        }
    }

    if ( polygons.indexOf( points ) === -1 && points.length )
        polygons.push( points );
};


VG.Core.SVG.prototype.clockwise=function(vs)
{
    /** Checks if the polygon/shape is clockwise or not */

    var area = 0.0;

    for (var i = 0; i < vs.length - 1; i++)
    {
        var sX = vs[i].x - vs[0].x;
        var sY = vs[i].y - vs[0].y;
        var eX = vs[i + 1].x - vs[0].x;
        var eY = vs[i + 1].y - vs[0].y;

        area += (sX * -eY) - (eX * -sY);
    }

    return  area < 0.0;
};

// --------------------------------------------- VG.Core.SVGPool

VG.Core.SVGPool=function()
{
    if ( !(this instanceof VG.Core.SVGPool) ) return new VG.Core.SVGPool();

    /** Creates an VG.Core.SVGPool class. The default SVG pool of every VG application is located at VG.context.svgPool. It is filled automatically
     * on application startup with all application images as well as with vector graphics used by the Style. You can retrieve svg's from the default pool
     * using VG.Utils.getSVGByName() which in turn calls VG.context.svgPool.getSVGByName().
     */

    this.svgs=[];
};

// --- addSVG

VG.Core.SVGPool.prototype.addSVG=function( svg )
{
    /** Adds an svg file to the pool.
     * param {VG.Core.SVG} svg - The svg to add.
     */

    this.svgs.push( svg );
};

// --- getSVGByName

VG.Core.SVGPool.prototype.getSVGByName=function( name )
{
    /** Returns an SVG from the pool based on its name.
     * @returns {VG.Core.SVG} or null if no svg with the given name was found.
     */

    for( i=0; i < this.svgs.length; ++i ) {
        if ( this.svgs[i].name == name )
            return this.svgs[i];
    }

    name=VG.UI.stylePool.current.skin.prefix + name;

    for( i=0; i < this.svgs.length; ++i ) {
        if ( this.svgs[i].name == name )
            return this.svgs[i];
    }
    return null;
};

VG.context.svgPool=VG.Core.SVGPool();

// --- The below taken from https://github.com/jkroso/parse-svg-path/blob/master/index.js

/*
The MIT License

Copyright (c) 2013 Jake Rosoman <jkroso@gmail.com>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
'Software'), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/

VG.Core.SVG.path_parser_length = {a: 7, c: 6, h: 1, l: 2, m: 2, q: 4, s: 4, t: 2, v: 1, z: 0};

/**
 * segment pattern
 * @type {RegExp}
 */

VG.Core.SVG.path_parser_segment = /([astvzqmhlc])([^astvzqmhlc]*)/ig;

/**
 * parse an svg path data string. Generates an Array
 * of commands where each command is an Array of the
 * form `[command, arg1, arg2, ...]`
 *
 * @param {String} path
 * @return {Array}
 */

VG.Core.SVG.path_parser=function( path )
{
    var data = [];
    path.replace(VG.Core.SVG.path_parser_segment, function(_, command, args){
        var type = command.toLowerCase();
        args = VG.Core.SVG.path_parser_parseValues(args);

        // overloaded moveTo
        if (type == 'm' && args.length > 2) {
            data.push([command].concat(args.splice(0, 2)));
            type = 'l';
            command = command == 'm' ? 'l' : 'L';
        }

        while (true) {
            if (args.length == VG.Core.SVG.path_parser_length[type]) {
                args.unshift(command);
                return data.push(args);
            }
            if (args.length < VG.Core.SVG.path_parser_length[type]) return data;//throw new Error('malformed path data')
            data.push([command].concat(args.splice(0, VG.Core.SVG.path_parser_length[type])));
        }
    });
    return data;
};

VG.Core.SVG.path_parser_parseValues=function(args){
    args = args.match(/-?[.0-9]+(?:e[-+]?\d+)?/ig);
    return args ? args.map(Number) : [];
};

// ----
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/* Type enum */
VG.Type = { Float: 0, Uint8: 1, Uint16: 2, Uint32: 3 };

VG.Renderer = function()
{
    if (!(this instanceof VG.Renderer))
    {
        if (!VG.Renderer.instance) return new VG.Renderer();

        return VG.Renderer.instance;
    }

    VG.Renderer.instance = this;

    this.textures = new Map();
    this.w = 16;
    this.h = 16;

    /** Holds all the gpu resources for proper restoration */
    this.resources = new Map();

    this.proj2d = new VG.Math.Matrix4();

    this.shaderTex2d = new VG.Shader([
        "#version 100",
        "attribute vec4 vPos;",
        "attribute vec2 vTexCoord;",
        "varying vec2 texCoord;",
        "void main(){",
        "   texCoord = vec2(vTexCoord.x, 1.0-vTexCoord.y);",
        "   gl_Position = vPos;",
        "}", ""
    ].join('\n'), [
        "#version 100",
        "precision mediump float;",
        "uniform sampler2D tex;",
        "uniform float alpha;",
        "uniform bool premAlpha;",
        "varying vec2 texCoord;",
        "void main(){",
        "   vec4 color = texture2D(tex, texCoord);",
        "   if(premAlpha){",
        "       gl_FragColor = vec4(clamp( color.r * alpha, 0.0, 1.0), clamp( color.g * alpha, 0.0, 1.0), clamp( color.b * alpha, 0.0, 1.0), clamp( color.a * alpha, 0.0, 1.0) );",
        "   }else{",
        "       gl_FragColor = vec4(color.rgb, clamp( color.a * alpha, 0.0, 1.0) );",
        "   }",
        "}", ""
    ].join('\n'));

    this.shaderTex2d.blendType = VG.Shader.Blend.Alpha;
    this.shaderTex2d.create();

    //Generic quad buffer with uv
    this.texQuadBuffer = new VG.GPUBuffer(VG.Type.Float, 4 * 4, true);
    this.texQuadBuffer.create();

    //the main render target (it's actually null), dont need to call create.
    this.mainRT = new VG.RenderTarget(0, 0, true);
    this.mainRT.clear();

	// the render targets(fbo) for continued effect-chain process, while ping pong (switching).
	this.rtPing = new VG.RenderTarget();
	this.rtPong = new VG.RenderTarget();

	this.framePingPong = new VG.GPUBuffer(VG.Type.Float, 4 * 4, true);
	this.framePingPong.create();
};

VG.Renderer.prototype.addResource = function(resource)
{
    this.resources.set(resource, resource);
};

VG.Renderer.prototype.removeResource = function(resource)
{
    this.resources.delete(resource);
};

// ping pong RT mechanism - begin
VG.Renderer.prototype.startPingPong = function(width, height, imageWidth, imageHeight )
{
	this.rtPing.resetSize(width, height);
	this.rtPong.resetSize(width, height);

    this.rtPing.imageWidth=imageWidth; this.rtPing.imageHeight=imageHeight;
    this.rtPong.imageWidth=imageWidth; this.rtPong.imageHeight=imageHeight;

	this.mainRT.setViewportEx(0, VG.context.workspace.rect.height-height, width, height );
	this.prepareFrameQuad(0, 0, width, height, VG.Core.Size(width, height), this.framePingPong);
};

VG.Renderer.prototype.whilePingPong = function(texture)
{
	var rtActive;

	if (texture===this.rtPing)
		rtActive = this.rtPong;
	else
		rtActive = this.rtPing;

	rtActive.bind();

	return rtActive;
};

VG.Renderer.prototype.drawPingPong = function(aPos, aTex)
{
    /** Draws a frame-quad.
	 *  @param {number} aPos - The vertex coordinate attribute location of shader.
	 *  @param {number} aTex - The Texture coordinate attribute location of shader.
     *  */
    this.drawFrameQuad(aPos, aTex, true, this.framePingPong);
};

VG.Renderer.prototype.endPingPong = function(texture)
{
	if (texture.bindAsTexture) // instanceof VG.RenderTarget
		texture.unbind();
};
// ping pong RT mechanism - end

VG.Renderer.prototype.getTexture = function(source)
{
    /** Gets a texture from the pool
     *  @param {string | VG.Core.Image} source - The image source, either a path or an image object
     *  @returns {VG.Texture}
     *  */
    var tex = null;

    if (this.textures.has(source))
    {
        tex = this.textures.get(source);
    }
    else if (source.bindAsTexture) // instanceof VG.RenderTarget
    {
		tex = source;
    }
    else if (source.identifyTexture) // instanceof VG.Texture
    {
		tex = source;
    }
	else
    {
        tex = new VG.Texture([source]);
        tex.create();

        this.textures.set(source, tex);
    }

    return tex;
};

VG.Renderer.prototype.onResize = function(w, h)
{
    this.w = w;
    this.h = h;

    this.resources.forEach(function(r) {

        if (r.bindAsTexture) // instanceof VG.RenderTarget
        {
            if (r.autoResize)
            {
                r.resize(w, h);
            }
        }

    });


    this.proj2d.setOrtho(0, this.w, this.h, 0, 1, 0);
};

VG.Renderer.prototype.restore = function()
{
    /** Calls create on every tracked gpu resource */

    //Explicity call create on each resource
    this.resources.forEach(function(r) {

        r.create();
    });
};

VG.Renderer.prototype.release = function()
{
    /** Calls release on every tracked gpu resource, it's
     *  safe to call this multiple times */
    this.resources.forEach(function(r) {
        r.destroy();
    });
};

VG.Renderer.prototype.invalidateAll = function()
{
    /** Same as release */
    this.release();
};

VG.Renderer.prototype.tick = function()
{
};

/**
 *
 * @param {Object} options - Options
 * @param {VG.Texture} options.texture - Texture to use
 * @param {number} options.x - Center x
 * @param {number} options.y - Center y
 * @param {number} options.width - Quad width
 * @param {number} options.height - Quad height
 * @param {number} [options.angle=0] - Rotation in radian ccc.
 * @param {number} [options.scale=1] - Scale
 * @param {number} [options.alpha=1] - Alpha
 * @param {VG.Core.Size} [options.viewportSize=undefined] - View port size
 */
VG.Renderer.prototype.drawQuadRotate = function(options){
    "use strict";
    var buffer,
        shader,
        db,
        i,
        x,
        y,
        dx,
        dy,
        angle,
        scale;

    var view = {
        width: this.w,
        height: this.h
    };
    if(options.viewportSize){
        view.width = options.viewportSize.width;
        view.height = options.viewportSize.height;
    }
    view.max = Math.max(view.width, view.height);
    view.min = Math.min(view.width, view.height);
    view.aspect = {
        x: view.height/view.max,
        y: view.width/view.max
    };

    // buffer init
    VG.Renderer._gpuBuffer = VG.Renderer._gpuBuffer || {};
    if(!VG.Renderer._gpuBuffer.drawQuadRotate){
        buffer = VG.Renderer._gpuBuffer.drawQuadRotate = new VG.GPUBuffer(VG.Type.Float, 4 * 8, true);
        buffer.create();
    }
    buffer = VG.Renderer._gpuBuffer.drawQuadRotate;

    // shader init
    VG.Renderer._shader = VG.Renderer._shader || {};
    if(!VG.Renderer._shader.drawQuadRotate){
        shader = VG.Renderer._shader.drawQuadRotate = new VG.Shader([
            "#version 100",
            "attribute vec2 a_center;",
            "attribute vec2 a_offset;",
            "attribute float a_angle;",
            "attribute float a_scale;",
            "attribute vec2 a_texCoord;",
            "uniform vec2 u_aspect;",
            "varying vec2 v_texCoord;",
            "void main(){",
            "   float c = cos(a_angle);",
            "   float s = sin(a_angle);",
            "   v_texCoord = vec2(a_texCoord.x, a_texCoord.y);",
            "   vec2 offset = a_offset * a_scale;",
            "   gl_Position = vec4(a_center + vec2((offset.x*c - offset.y*s), (offset.x*s + offset.y*c))*u_aspect, 0.0, 1.0);",
            "}", ""
        ].join('\n'),[
            "#version 100",
            "precision mediump float;",
            "uniform sampler2D tex;",
            "uniform float alpha;",
            "uniform bool premAlpha;",
            "varying vec2 v_texCoord;",
            "void main(){",
            "   vec4 color = texture2D(tex, v_texCoord);",
            "   if(premAlpha){",
            "       gl_FragColor = vec4(clamp( color.r * alpha, 0.0, 1.0), clamp( color.g * alpha, 0.0, 1.0), clamp( color.b * alpha, 0.0, 1.0), clamp( color.a * alpha, 0.0, 1.0) );",
            "   }else{",
            "       gl_FragColor = vec4(color.rgb, clamp( color.a * alpha, 0.0, 1.0) );",
            "   }",
            "}", ""
        ].join('\n'));
        shader.blendType = VG.Shader.Blend.Alpha;
        shader.create();
    }
    shader = VG.Renderer._shader.drawQuadRotate;
    shader.bind();

    // shader update
    if(options.texture)
        shader.setTexture("tex", options.texture, 0);

    shader.setFloat("alpha", (typeof options.alpha === 'undefined') ? 1.0 : options.alpha);
    shader.setFloat("u_aspect", [view.aspect.x, view.aspect.y]);

    // buffer update
    x = (options.x * 2.0 / view.width - 1);
    y = options.y * 2.0 / view.height - 1;
    dx = options.width / view.min;
    dy = options.height / view.min;
    angle = typeof options.angle === 'undefined' ? 0 : options.angle;
    scale = typeof options.scale === 'undefined' ? 1.0 : options.scale;

    db = buffer.getDataBuffer(); i = 0;

    db.set(i++, x); db.set(i++, y); db.set(i++, 0.0); db.set(i++, 1.0);
    db.set(i++, -dx); db.set(i++, -dy); db.set(i++, angle); db.set(i++, scale);

    db.set(i++, x); db.set(i++, y); db.set(i++, 0.0); db.set(i++, 0.0);
    db.set(i++, -dx); db.set(i++, dy); db.set(i++, angle); db.set(i++, scale);

    db.set(i++, x); db.set(i++, y); db.set(i++, 1.0); db.set(i++, 1.0);
    db.set(i++, dx); db.set(i++, -dy); db.set(i++, angle); db.set(i++, scale);

    db.set(i++, x); db.set(i++, y); db.set(i++, 1.0); db.set(i++, 0.0);
    db.set(i++, dx); db.set(i++, dy); db.set(i++, angle); db.set(i++, scale);

    buffer.update();

    // buffer draw
    // todo: move it to shader creation, its possible if buffer.update() does not change gpu location
    buffer.vertexAttrib(shader.getAttrib("a_center"), 2, false, 32, 0);
    buffer.vertexAttrib(shader.getAttrib("a_texCoord"), 2, false, 32, 8);
    buffer.vertexAttrib(shader.getAttrib("a_offset"), 2, false, 32, 16);
    buffer.vertexAttrib(shader.getAttrib("a_angle"), 1, false, 32, 24);
    buffer.vertexAttrib(shader.getAttrib("a_scale"), 1, false, 32, 28);

    buffer.drawBuffer(VG.Renderer.Primitive.TriangleStrip, 0, 4);
};

VG.Renderer.prototype.drawQuad = function(texture, w, h, x, y, alpha, viewportSize)
{
    /** Draws a textured quad, if rect is null then it render a full screen quad
     *  unless w or h are defined
     *  @param {VG.Texture | VG.TextureCube | VG.RenderTarget} texture - The texture to use
     *  @param {number} w - Width in pixels
     *  @param {number} h - Height in pixels
     *  @param {number} x - X offset
     *  @param {number} y - Y offset
     *  @param {number} alpha - The alpha for the blend
     *  @param {VG.Core.Size} [null] viewportSize - The viewport size
     *  */

	// texture
    this.shaderTex2d.bind();
    this.shaderTex2d.setTexture("tex", texture, 0);

	// alpha
	if (alpha === undefined)
		alpha = 1.0;
    this.shaderTex2d.setFloat("alpha", alpha);

	// quad
	this.prepareFrameQuad(x, y, w, h, viewportSize);
	this.drawFrameQuad(this.shaderTex2d.getAttrib("vPos"), this.shaderTex2d.getAttrib("vTexCoord"), true);
};

VG.Renderer.prototype.prepareFrameQuad = function(x, y, w, h, viewportSize, quad)
{
    /** Prepares a frame-quad to draw, if rect is null then it render a full screen quad
     *  unless w or h are defined
     *  @param {number} x - X offset
     *  @param {number} y - Y offset
     *  @param {number} w - Width in pixels
     *  @param {number} h - Height in pixels
     *  @param {VG.Core.Size} [null] viewportSize - The viewport size
	 *  @param {VG.GPUBuffer} quad - primitive to set
     *  */
    var vw = viewportSize ? viewportSize.width : this.w;
    var vh = viewportSize ? viewportSize.height : this.h;

    if (!w) w = vw;
    if (!h) h = vh;
    if (!x) x = 0;
    if (!y) y = 0;

    var b = quad ? quad : this.texQuadBuffer;

	var x1 = (x - vw / 2) / (vw / 2);
    var y1 = (vh / 2 - y) / (vh / 2);
    var x2 = ((x + w) - vw / 2) / (vw / 2);
    var y2 = (vh / 2 - (y + h)) / (vh / 2);

    var i = 0;
    var db=b.getDataBuffer();

    db.set(i++, x1); db.set(i++, y1); db.set(i++, 0.0); db.set(i++, 1.0);
    db.set(i++, x1); db.set(i++, y2); db.set(i++, 0.0); db.set(i++, 0.0);
    db.set(i++, x2); db.set(i++, y1); db.set(i++, 1.0); db.set(i++, 1.0);
    db.set(i++, x2); db.set(i++, y2); db.set(i++, 1.0); db.set(i++, 0.0);

    b.update();

	return b;
};

VG.Renderer.prototype.drawFrameQuad = function(aPos, aTex, nobind, quad)
{
    /** Draws a frame-quad.
	 *  @param {number} aPos - The vertex coordinate attribute location of shader.
	 *  @param {number} aTex - The Texture coordinate attribute location of shader.
	 *  @param {bool} nobind - If true the buffer wont be binded.
	 *  @param {VG.GPUBuffer} quad - primitive to draw
     *  */
	var b = quad ? quad : this.texQuadBuffer;
	if (!nobind)
		b.bind();
    b.vertexAttrib(aPos, 2, false, 16, 0);
    b.vertexAttrib(aTex, 2, false, 16, 4 * 2);

	b.drawBuffer(VG.Renderer.Primitive.TriangleStrip, 0, 4);
};

VG.Renderer.prototype.drawMesh = function(mesh, element, shader)
{
    /** Draw a mesh element(s) with a shader
     *  @param {VG.Render.Mesh} mesh - The mesh, must be valid
     *  @param {Number} element - The element index, -1 to draw all elements
     *  @param {VG.Shader} shader - The shader to use */

    if (mesh.isValid() === false) return;

	var vb;
    for (var i = 0; i < mesh.vBuffers.length; i++)
    {
        vb = mesh.vBuffers[i].vb;
        var layout = mesh.vBuffers[i].layout;

        //byte stride
        var tStride = vb.getStride();
        var vStride = tStride * mesh.vBuffers[i].stride;

        vb.bind();

        for (var j = 0; j < layout.length; j++)
        {
            var vL = layout[j];
            var index = shader.getAttrib(vL.name);
            if (index < 0) continue;

            vb.vertexAttrib(index, vL.stride, false, vStride, tStride * vL.offset);
        }
    }

    var eOffset = 0;
    var eSize = 0;

    if (element == -1 || mesh.elements[element] === undefined)
    {
        eOffset = 0;
        eSize = mesh.isIndexed() ? mesh.getIndexCount() : mesh.vertexCount;
    }
    else
    {
        eOffset = mesh.elements[element].offset;
        eSize = mesh.elements[element].size;
    }

    if (mesh.isIndexed())
    {
        mesh.iBuffer.bind();
		vb.drawBuffer(VG.Renderer.Primitive.Triangles, eOffset, eSize, true, mesh.iBuffer.elemType);
    }
    else
    {
		vb.drawBuffer(VG.Renderer.Primitive.Triangles, eOffset, eSize);
    }
};


VG.Renderer.Primitive = { Triangles: 0, Lines: 1, TriangleStrip: 2, LineStrip: 3, Points: 4 };


/**
 * Namespace contains all realtime Scene / Mesh / Material classes.
 * @namespace
 */
VG.Render = {};

VG.Render.TraceContext = function()
{
    /** Ray tracing context, used with VG.Render.trace function, holds an image which gets updated
     *  per pixel/tile asynchronously
     *
     *  @constructor */

    /** Output image
     *  @member {VG.Core.Image} */
    this.output = new VG.Core.Image(1, 1);
    this.output.forcePowerOfTwo = false;
    this.output.alloc();

    /** Internal ID, if set/zero then a new internal context is created
     *  @member {Number} */
    this.id = 0;

    /** Texture to use in real time rendering
     *  @member {VG.Texture} */
    this.texture = new VG.Texture([this.output]);

    /** If true then the tracing re-starts from zero, usefull when the camera or geometry changes
     *  to avoid artifacts, otherwise the tracer would continue to trace the scene with the new changes regardless
     *
     *  This gets automatically set to false once processed.
     *  @member {Bool} */
    this.resetAccumulation = false;

    /** Set by the tracer, current iterations
     *  @member {Number} */
    this.iterations = 0;

    /** Maximum iterations
     *  @member {Number} */
    this.maxIterations = 512;

    /** Render scale ratio, use low values for faster iteration
     *  @member {Number} */
    this.scaleRatio = 0.5;

    /** Flag to notify scene changed
     *  @member {bool} */
    this.sceneChanged = true;

    this.texture.create();
};

VG.Render.networkTrace = function()
{
    return false; // not implemented, as for nows
};

VG.Render.TraceSettings = function()
{
    /** Ray tracing settings, used with VG.Render.trace function.
     *
     *  @constructor */
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Creates an VG.Canvas object.<br>
 *
 * VG.Canvas implements the basic drawing operations for Widgets inside an VG.UI.Workspace. Use it to draw 2D shapes, images and text. It implements these
 * functions based on the OpenGL ES 2 wrapper integrated into Visual Graphics.<br>
 *
 * The VG.Canvas for a given Workspace is passed to the calcSize() and paintWidget() calls of every Widget. If you ever need to access the VG.Canvas outside
 * these functions you can find references at both VG.context.canvas and VG.context.workspace.
 *
 * @constructor
 */

VG.Canvas=function()
{
    if ( arguments.length != 1 ) {
        if ( this instanceof VG.Canvas ) {
            this.canvas=0;
        } else return new VG.Canvas();
    } else {
        if ( this instanceof VG.Canvas ) {
            this.canvas=arguments[0];
        } else return new VG.Canvas( arguments[0] );
    }

    this.renderer = VG.Renderer();

    var VSHADER_SOURCE =
        '#version 100\n\n' +
        'attribute vec4 drawPosition;\n' +
        'attribute vec4 drawColor;\n' +
        'uniform mat4 pM;\n' +
        'varying vec4 v_Color;\n\n' +
        'void main() {\n' +
        '  gl_Position =  pM * drawPosition;\n' +
        '  v_Color = drawColor;\n' +
        '}\n';

    var FSHADER_SOURCE =
        '#version 100\n\n' +
        'precision mediump float;\n' +
        'varying vec4 v_Color;\n' +
        'uniform float uniformAlpha;\n' +
        'void main() {\n' +
        '  vec4 color = v_Color;\n' +
        '  gl_FragColor = vec4( color.rgb, color.a * uniformAlpha );\n' +
        '}\n';

    this.primShader=new VG.Shader(VSHADER_SOURCE, FSHADER_SOURCE);
    this.primShader.blendType = VG.Shader.Blend.Alpha;
    this.primShader.create();

    this.triBuffer=new VG.GPUBuffer(VG.Type.Float, (6 * 3) * 256 * 8, true);
    this.triBufferDB = this.triBuffer.getDataBuffer();
    this.triBuffer.create();
    this.triCount=0;


    this.fonts=[];
    this.fonts.push( VG.UI.stylePool.current.skin.Widget.Font );
    this.fontIndex=0;

    this.delayedPaintWidgets=[];

    this.hasBeenResized=false;
    this.alpha = 1.0;

    this.matrix=new VG.Math.Matrix4();


    //font rendering
    var FONT_VSHADER_SOURCE = [
        '#version 100',

        'attribute vec2 vPos;',

        'uniform mat4 tM;',
        'uniform mat4 pM;',

        'void main() {',
        '  mat4 m = pM * tM;',
        '  gl_Position = m * vec4(vPos, 0, 1);',
        '}'

    ].join('\n');

    var FONT_FSHADER_SOURCE = [
        '#version 100',

        'precision mediump float;',

        'uniform vec4 color;',
        'uniform float uniformAlpha;\n' +

        'void main() {',
        '  gl_FragColor = color;',
        '  gl_FragColor = vec4( color.rgb, color.a * uniformAlpha );\n' +

        '}'
    ].join('\n');

    this.fontShader=new VG.Shader(FONT_VSHADER_SOURCE, FONT_FSHADER_SOURCE);
    this.fontShader.blendType = VG.Shader.Blend.Alpha;
    this.fontShader.create();


    this.cacheM1 = new VG.Math.Matrix4();
    this.cacheM2 = new VG.Math.Matrix4();

    this.cacheC1 = VG.Core.Color();
    this.cacheC2 = VG.Core.Color();
    this.cacheC3 = VG.Core.Color();

    this.cacheV2A = new VG.Math.Vector2();
    this.cacheV2B = new VG.Math.Vector2();
    this.cacheV2C = new VG.Math.Vector2();
    this.cacheV2D = new VG.Math.Vector2();

    //render target
    this.rt = VG.Renderer().mainRT;
    this.clipRects=[];

    this.customProjectionMatrix = new VG.Math.Matrix4();
    this.twoD = true;

    this.canvas = document.getElementById( 'workspace' );
    this.ctx = this.canvas.getContext('2d');

    // If thie canvasContext class doesn't have  a fillRoundedRect, extend it now
    if (!this.ctx.constructor.prototype.fillRoundedRect) {
    // Extend the canvaseContext class with a fillRoundedRect method
        this.ctx.constructor.prototype.fillRoundedRect =
        function (xx,yy, ww,hh, rad, fill, stroke) {
            if (typeof(rad) == "undefined") rad = 5;
            this.beginPath();
            this.moveTo(xx+rad, yy);
            this.arcTo(xx+ww, yy,    xx+ww, yy+hh, rad);
            this.arcTo(xx+ww, yy+hh, xx,    yy+hh, rad);
            this.arcTo(xx,    yy+hh, xx,    yy,    rad);
            this.arcTo(xx,    yy,    xx+ww, yy,    rad);
            if (stroke) this.stroke();  // Default to no stroke
            if (fill || typeof(fill)=="undefined") this.fill();  // Default to fill
        };
    }

    // --- Check for Firefox. Needed for correcting text aligning on the 2D canvas
    // if ( navigator && navigator.userAgent.indexOf("Firefox") > 0 )
        this.fireFox = true;
};

/**
 * An enum of 2D primitives which can be drawn via {@link VG.Canvas.draw2DShape}.
 * @enum {Number}
 */

VG.Canvas.Shape2D={ "Rectangle" : 0, "VerticalGradient" : 1, "HorizontalGradient" : 2, "RectangleOutline" : 3,  "RectangleOutlineMin1px" : 4,  "RectangleOutlineMin2px" : 5,
                    "RoundedRectangleOutline1px" : 6, "RoundedRectangle2px" : 7, "RectangleCorners" : 8,
                    "FlippedTriangle" : 9, "ArrowLeft" : 10, "ArrowRight" : 11, "Circle": 12, "CircleHue" : 13, "CircleOutline": 14, "ArrowRightGradient": 15,
                };

/**
 * Sets an {@link VG.RenderTarget} to the canvas. All drawing operations will be applied to the given render target. Call setTarget again with undefined to clear the render target.
 * @param {VG.RenderTarget} rt - RenderTarget to draw to.
 */

VG.Canvas.prototype.setTarget=function( rt )
{
    this.flush();
    if ( rt ) {
        this.customProjM = this.customProjectionMatrix;
        this.customProjM.setOrtho( 0, rt.width, 0, rt.height, 1, 0 );
        this.customTarget = rt;
    } else {
        this.customProjM = undefined;
        this.customTarget = undefined;
    }
};

VG.Canvas.prototype.setActiveCanvas=function( canvasName )
{
    if ( canvasName === "Overlay" ) {
        this.canvas = document.getElementById( 'workspaceOverlay' );
        this.ctx = this.canvas.getContext('2d');
    } else {
        this.canvas = document.getElementById( 'workspace' );
        this.ctx = this.canvas.getContext('2d');
    }
    this.canvasName = canvasName;
};

/**
 * Pushes the given VG.Font.Font to the canvas. It will be used until a popFont() call takes it off the top of the font stack. Every pushFont() call needs to have a matching popFont()
 * call.
 * @param {VG.Font.Font} font - The font to use
 */

VG.Canvas.prototype.pushFont=function( font )
{
    this.fontIndex++;
    this.fonts.splice( this.fontIndex, 0, font );

    this.font = this.fonts[this.fontIndex];
    this.fontText = this.font.size + "px " + this.font.triFont.face.familyName;

    if ( typeof font.name === 'string' ) {
        if ( font.name.includes( "Bold") ) {
            this.fontText = "Bold " + this.fontText;
        }
        if ( font.name.includes( "Italic") ) {
            this.fontText = "Italic " + this.fontText;
        }
    }
    this.ctx.font = this.fontText;
    this.fontHeight = this.font.size;
};

/**
 * Takes the current font of the font stack and the canvas resumes using the new font at the top of the stack.
 */

VG.Canvas.prototype.popFont=function()
{
    this.fonts.splice( this.fontIndex, 1 );
    --this.fontIndex;

    this.font = this.fonts[this.fontIndex];
    this.fontText = this.font.size + "px " + this.font.triFont.face.familyName;

    if ( typeof this.font.name === 'string' ) {
        if ( this.font.name.includes( "Bold") ) {
            this.fontText = "Bold " + this.fontText;
        }
        if ( this.font.name.includes( "Italic") ) {
            this.fontText = "Italic " + this.fontText;
        }
    }
    this.ctx.font = this.fontText;
    this.fontHeight = this.font.size;
};

/**
 * Sets a new alpha value for the canvas. All following drawing operations will use this new alpha value. Calls {@link VG.Canvas.flush} to draw all pending triangles.
 * @param {number} alpha - The new alpha value to use, has to be in the range of 0..1.
 */

VG.Canvas.prototype.setAlpha=function( alpha )
{
    this.flush();
    this.alpha = alpha;
    this.ctx.globalAlpha = alpha;
};

/**
 * Sets a new clipping rectangle. All drawing outside this rectangle will be ignored. Pass null to reset to no clipping.
 * @param {VG.Core.Rect} rect - The new clipping rectangle to use or null to reset to no clipping.
 */

VG.Canvas.prototype.pushClipRect=function( rect )
{
    let ctx = this.ctx;

    if ( !this.clipRects.length ) ctx.save();
    else { ctx.restore(); ctx.save(); }

    this.flush();

    if ( rect )
    {
        if ( this.clipRects.length )
        {
            var lastRect=this.clipRects[this.clipRects.length-1];
            var intersectRect = lastRect.intersect( rect );

            if ( !intersectRect ) {
                //VG.log( "intersect is null", lastRect.toString(), rect.toString() );

                this.clipRects.push( VG.Core.Rect( lastRect ) );
                return;
            } else {
                this.clipRects.push( intersectRect );
                ctx.beginPath();
                ctx.rect( intersectRect.x, intersectRect.y, intersectRect.width, intersectRect.height );
                ctx.clip();
                ctx.beginPath();
                this.rt.setScissor( intersectRect );
            }

        } else {
            this.clipRects.push( rect );
            ctx.beginPath();
            ctx.rect( rect.x, rect.y, rect.width, rect.height );
            ctx.clip();
            ctx.beginPath();
            this.rt.setScissor( rect );
        }
    }
};

/**
 * Takes the current rectangle of the clip stack.
 */

VG.Canvas.prototype.popClipRect=function()
{
    if ( this.clipRects.length <= 0 ) { VG.error( "popClipRect -- Stack Underflow"); return; }

    let ctx = this.ctx;
    ctx.restore(); ctx.save();

    this.flush();

    this.clipRects.splice(-1,1);

    let last=this.clipRects[this.clipRects.length-1];
    if ( last ) {
        ctx.beginPath();
        ctx.rect( last.x, last.y, last.width, last.height );
        ctx.clip();
        ctx.beginPath();
        this.rt.setScissor( last );
    } else {
        // ctx.beginPath();
        // ctx.rect( 0, 0, VG.context.workspace.rect.width, VG.context.workspace.rect.height );
        // ctx.clip();
        this.rt.setScissor();
    }
};

/**
 * Flushes all triangle caches. Called by {@link VG.UI.Workspace} at the end of a redraw operation to make sure all triangles are painted.
 */

VG.Canvas.prototype.flush=function()
{
    if (this.triCount) this.flushTris();
};

/**
 * Draws a 2D triangle using the specified coordinates and the VG.Core.Color for each coordinate.
 * @param {number} x1 - The x1 coordinate
 * @param {number} y1 - The y1 coordinate
 * @param {number} x2 - The x2 coordinate
 * @param {number} y2 - The y2 coordinate
 * @param {number} x3 - The x3 coordinate
 * @param {number} y3 - The y3 coordinate
 * @param {number} col1 - The color at the x1, y1 coordinate
 * @param {number} col2 - The color at the x2, y2 coordinate
 * @param {number} col3 - The color at the x3, y3 coordinate
 */

VG.Canvas.prototype.addTriangle2D=function( x1, y1, x2, y2, x3, y3, col1, col2, col3 )
{
    var db = this.triBufferDB;
    var data=db.data;

    data[this.triCount++] = x1;
    data[this.triCount++] = y1;

    data[this.triCount++] = col1.r;
    data[this.triCount++] = col1.g;
    data[this.triCount++] = col1.b;
    data[this.triCount++] = col1.a;

    data[this.triCount++] = x2;
    data[this.triCount++] = y2;

    data[this.triCount++] = col2.r;
    data[this.triCount++] = col2.g;
    data[this.triCount++] = col2.b;
    data[this.triCount++] = col2.a;

    data[this.triCount++] = x3;
    data[this.triCount++] = y3;

    data[this.triCount++] = col3.r;
    data[this.triCount++] = col3.g;
    data[this.triCount++] = col3.b;
    data[this.triCount++] = col3.a;

    if (this.triCount >= db.getSize())
        this.flushTris();
};

/**
 * Draws a 2D rectangle using the specified coordinates and VG.Core.Color.
 * @param {number} x1 - The x1 coordinate
 * @param {number} y1 - The y1 coordinate
 * @param {number} x2 - The x2 coordinate
 * @param {number} y2 - The y2 coordinate
 * @param {number} col - The color of the rectangle.
 */

VG.Canvas.prototype.addSolidRectangle2D=function( x1, y1, x2, y2, col )
{
    this.addTriangle2D(x1, y1, x2, y1, x1, y2, col, col, col);
    this.addTriangle2D(x1, y2, x2, y1, x2, y2, col, col, col);
};

VG.Canvas.prototype.flushTris=function()
{
    if ( !this.triCount ) return;

   var b = this.triBuffer;
    var shader = this.primShader;

    shader.bind();

    //this also binds the buffer
    b.update(0, this.triCount);

    var stride = b.getStride();

    b.vertexAttrib(shader.getAttrib("drawPosition"), 2, false, stride * 6, 0);
    b.vertexAttrib(shader.getAttrib("drawColor"), 4, false, stride * 6, stride * 2);

    shader.setFloat("uniformAlpha", this.alpha);

    if ( this.customTarget ) {
        shader.setMatrix( "pM", this.customProjM.elements );
        this.customTarget.bind();
        this.customTarget.setViewportEx( 0, 0, this.customTarget.width, this.customTarget.height );
        b.drawBuffer(VG.Renderer.Primitive.Triangles, 0, this.triCount / 6);
        this.customTarget.unbind();
    } else {
        shader.setMatrix( "pM", VG.Renderer().proj2d.elements );
        b.drawBuffer(VG.Renderer.Primitive.Triangles, 0, this.triCount / 6);
    }

    this.triCount = 0;
};

/**
 * Draws a 2D Shape using the specified rectangle and colors on the 2D canvas layer.
 * @param {VG.Canvas.Shape2D} shape - The shape as specified in the VG.Canvas.Shape2D enum
 * @param {VG.Core.Rect} rect - The rectangle for the shape
 * @param {VG.Core.Color} col1 - The main color of the shape
 * @param {VG.Core.Color} col2 - The optional 2nd color of the shape. Usage depends on shape type.
 * @param {VG.Core.Color} col3 - The optional 3rd color of the shape. Usage depends on shape type.
 */

VG.Canvas.prototype.draw2DShape=function( shape, rect, col1, col2, col3 )
{
    let ctx = this.ctx; ctx.globalAlpha = this.alpha;

    switch( shape )
    {
        case VG.Canvas.Shape2D.Rectangle:
            ctx.fillStyle = col1.canvasStyle;
            ctx.fillRect( rect.x, rect.y, rect.width, rect.height );
        break;

        case VG.Canvas.Shape2D.RectangleGL:
            this.addSolidRectangle2D( rect.x, rect.y, rect.right(), rect.bottom(), col1 );
        break;

        case VG.Canvas.Shape2D.VerticalGradient:
        {
            let lingrad = ctx.createLinearGradient(0,rect.y,0, rect.bottom() );
            lingrad.addColorStop( 0, col1.canvasStyle );
            lingrad.addColorStop( 1, col2.canvasStyle );

            ctx.fillStyle = lingrad;
            ctx.fillRect( rect.x, rect.y, rect.width, rect.height );
        }
        break;

        case VG.Canvas.Shape2D.HorizontalGradient:
        {
            let lingrad = ctx.createLinearGradient(rect.x,0,rect.right(),0);
            lingrad.addColorStop( 0, col1.canvasStyle );
            lingrad.addColorStop( 1, col2.canvasStyle );

            ctx.fillStyle = lingrad;
            ctx.fillRect( rect.x, rect.y, rect.width, rect.height );
        }
        break;

        case VG.Canvas.Shape2D.RectangleOutline:
            ctx.strokeStyle = col1.canvasStyle;
            ctx.lineWidth = 1.0;
            ctx.strokeRect( rect.x + 0.5, rect.y + 0.5, rect.width - 1.0, rect.height - 1.0 );
        break;

        case VG.Canvas.Shape2D.RectangleOutlineMin1px:
            ctx.strokeStyle = col1.canvasStyle;
            ctx.lineWidth = 1.0;

            ctx.beginPath();
            ctx.moveTo( rect.x + 1.5, rect.y + 0.5 );
            ctx.lineTo( rect.right() - 1.5, rect.y + 0.5 );

            ctx.moveTo( rect.x + 1.5, rect.bottom() - 0.5 );
            ctx.lineTo( rect.right() - 1.5, rect.bottom() - 0.5 );

            ctx.moveTo( rect.right() - 0.5, rect.y + 1.5 );
            ctx.lineTo( rect.right() - 0.5, rect.bottom() - 1.5 );
            ctx.moveTo( rect.x + 0.5, rect.y + 1.5 );
            ctx.lineTo( rect.x + 0.5, rect.bottom() - 1.5 );
            ctx.stroke();
        break;

        case VG.Canvas.Shape2D.RectangleOutlineMin2px:
            ctx.strokeStyle = col1.canvasStyle;
            ctx.lineWidth = 1.0;

            ctx.beginPath();
            ctx.moveTo( rect.x + 2.5, rect.y + 0.5 );
            ctx.lineTo( rect.right() - 2.5, rect.y + 0.5 );

            ctx.moveTo( rect.x + 2.5, rect.bottom() - 0.5 );
            ctx.lineTo( rect.right() - 2.5, rect.bottom() - 0.5 );

            ctx.moveTo( rect.right() - 0.5, rect.y + 2.5 );
            ctx.lineTo( rect.right() - 0.5, rect.bottom() - 2.5 );
            ctx.moveTo( rect.x + 0.5, rect.y + 2.5 );
            ctx.lineTo( rect.x + 0.5, rect.bottom() - 2.5 );
            ctx.stroke();
        break;

        case VG.Canvas.Shape2D.RoundedRectangleOutline1px:
            ctx.strokeStyle = col1.canvasStyle;
            ctx.lineWidth = 1.0;
            ctx.fillRoundedRect( rect.x, rect.y, rect.width, rect.height, 2, false, true );
        break;

        case VG.Canvas.Shape2D.RoundedRectangle2px:
            ctx.fillStyle = col1.canvasStyle;
            ctx.fillRoundedRect( rect.x, rect.y, rect.width, rect.height, 5 );
        break;

        case VG.Canvas.Shape2D.RectangleCorners:
            // --- Top Left
            this.addSolidRectangle2D( rect.x, rect.y, rect.x+1, rect.y+1, col1 );
            // --- Bottom Left
            this.addSolidRectangle2D( rect.x, rect.bottom()-1, rect.x+1, rect.bottom(), col1 );
            // --- Top Right
            this.addSolidRectangle2D( rect.right()-1, rect.y, rect.right(), rect.y+1, col1 );
            // --- Bottom Right
            this.addSolidRectangle2D( rect.right()-1, rect.bottom()-1, rect.right(), rect.bottom(), col1 );
        break;

        case VG.Canvas.Shape2D.FlippedTriangle:
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y, rect.x + rect.width/2, rect.bottom(), col1, col1, col1 );
        break;

        case VG.Canvas.Shape2D.ArrowRightGradient:
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y + rect.height/2, rect.x, rect.bottom(), col1, col2, col3 );
        break;

        case VG.Canvas.Shape2D.ArrowLeft:
            this.addTriangle2D( rect.x, rect.y+rect.height/2, rect.right(), rect.y, rect.right(), rect.bottom(), col1, col1, col1 );
        break;

        case VG.Canvas.Shape2D.ArrowRight:
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y + rect.height/2, rect.x, rect.bottom(), col1, col1, col1 );
        break;

        case VG.Canvas.Shape2D.Circle:
            ctx.beginPath();
            ctx.fillStyle = col1.canvasStyle;
            ctx.arc( rect.x + rect.width/2, rect.y + rect.height/2, Math.min( rect.width, rect.height) / 2, 0, 2 * Math.PI, false);
            ctx.fill();
        break;

        case VG.Canvas.Shape2D.CircleGL:
            rW = rect.width / 2;
            rH =  rect.height / 2;

            step = Math.floor(VG.Math.clamp(rW * rH, 8, 64));

            theta = 0.0;
            pX = rect.x + rect.width / 2;
            pY = rect.y + rect.height / 2;
            inc = (Math.PI * 2.0) / step;

            if (!col3) col3 = col1;
            if (!col2) col2 = col1;

            for (var i = 1; i <= step; i++)
            {
                x1 = pX + rW * Math.cos(inc * (i - 1));
                y1 = pY - rH * Math.sin(inc * (i - 1));

                x2 = pX + rW * Math.cos(inc * i);
                y2 = pY - rH * Math.sin(inc * i);

                this.addTriangle2D(x1, y1, x2, y2, pX, pY, col1, col2, col3);
            }
        break;

        case VG.Canvas.Shape2D.CircleHue:
            rW = rect.width / 2;
            rH =  rect.height / 2;

            step = Math.floor(VG.Math.clamp(rW * rH, 8, 64));

            theta = 0.0;
            pX = rect.x + rect.width / 2;
            pY = rect.y + rect.height / 2;
            inc = (Math.PI * 2.0) / step;

            if (!col3) col3 = col1;
            if (!col2) col2 = col1;

            for (let i = 1; i <= step; i++)
            {
                x1 = pX + rW * Math.cos(inc * (i - 1));
                y1 = pY - rH * Math.sin(inc * (i - 1));

                x2 = pX + rW * Math.cos(inc * i);
                y2 = pY - rH * Math.sin(inc * i);

                col1 = this.cacheC1;
                col1.setHSL(VG.Math.deg(inc * (i - 1)) - 90, 1.0, 0.5);

                col2 = this.cacheC2;
                col2.setHSL(VG.Math.deg(inc * i) - 90, 1.0, 0.5);

                col3 = VG.Core.Color.White;

                this.addTriangle2D(x1, y1, x2, y2, pX, pY, col1, col2, col3);
            }
        break;

        case VG.Canvas.Shape2D.CircleOutline:
            ctx.beginPath();
            ctx.fillStyle = col1.canvasStyle;
            ctx.lineWidth = 1.0;
            ctx.arc( rect.x + rect.width/2, rect.y + rect.height/2, Math.min( rect.width, rect.height) / 2, 0, 2 * Math.PI, false);
            ctx.stroke();
        break;
    }
};

VG.Canvas.prototype.drawShape=function( shape, rect, options, col1, col2, col3 )
{
    let ctx = this.ctx;
    let drawRoundRect = ( x, y, w, h, r ) => {
        ctx.beginPath();

        ctx.lineTo(x + w -r, y);
        ctx.quadraticCurveTo(x + w, y, x + w, y + r);
        ctx.lineTo(x + w, y + h - r);
        ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
        ctx.lineTo(x + r, y + h);
        ctx.quadraticCurveTo(x, y + h, x, y + h - r);
        ctx.lineTo(x, y + r);
        ctx.quadraticCurveTo(x, y, x + r, y);

        ctx.closePath();
    };

    if ( shape === "RoundedRect" ) {
        ctx.fillStyle = options.fillStyle ? options.fillStyle : undefined;
        ctx.strokeStyle = options.strokeStyle ? options.strokeStyle : undefined;
        ctx.lineWidth = options.strokeWidth ? options.strokeWidth : 1.0;

        drawRoundRect( rect.x, rect.y, rect.width, rect.height, options.radius !== undefined ? options.radius : 0 );
        if ( options.strokeStyle ) ctx.stroke();
        if ( options.fillStyle ) ctx.fill();
    }
};

/**
 * Draws a 2D Shape using the specified rectangle and colors on the WebGL layer.
 * @param {VG.Canvas.Shape2D} shape - The shape as specified in the VG.Canvas.Shape2D enum
 * @param {VG.Core.Rect} rect - The rectangle for the shape
 * @param {VG.Core.Color} col1 - The main color of the shape
 * @param {VG.Core.Color} col2 - The optional 2nd color of the shape. Usage depends on shape type.
 * @param {VG.Core.Color} col3 - The optional 3rd color of the shape. Usage depends on shape type.
 */

VG.Canvas.prototype.draw2DShapeGL=function( shape, rect, col1, col2, col3 )
{
    switch( shape )
    {
        case VG.Canvas.Shape2D.Rectangle:
        case VG.Canvas.Shape2D.RectangleGL:
            //this.addTriangle2D( rect.x, rect.bottom(), rect.right(), rect.bottom(), rect.x, rect.y, col1, col1, col1 );
            //this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y, rect.right(), rect.bottom(), col1, col1, col1 );

            this.addSolidRectangle2D( rect.x, rect.y, rect.right(), rect.bottom(), col1 );
        break;

        case VG.Canvas.Shape2D.VerticalGradient:
            this.addTriangle2D( rect.x, rect.bottom(), rect.right(), rect.bottom(), rect.x, rect.y, col2, col2, col1 );
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y, rect.right(), rect.bottom(), col1, col1, col2 );
        break;

        case VG.Canvas.Shape2D.HorizontalGradient:
            this.addTriangle2D( rect.x, rect.bottom(), rect.right(), rect.bottom(), rect.x, rect.y, col1, col2, col1 );
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y, rect.right(), rect.bottom(), col1, col2, col2 );
        break;

        case VG.Canvas.Shape2D.RectangleOutline:
            // --- Top
            this.addSolidRectangle2D( rect.x, rect.y, rect.right(), rect.y+1, col1 );
            // --- Bottom
            this.addSolidRectangle2D( rect.x, rect.bottom()-1, rect.right(), rect.bottom(), col1 );
            // --- Left
            this.addSolidRectangle2D( rect.x, rect.y, rect.x+1, rect.bottom(), col1 );
            // --- Right
            this.addSolidRectangle2D( rect.right()-1, rect.y, rect.right(), rect.bottom(), col1 );
        break;

        case VG.Canvas.Shape2D.RectangleOutlineMin1px:
            // --- Top
            this.addSolidRectangle2D( rect.x + 1, rect.y, rect.right()-1, rect.y+1, col1 );
            // --- Bottom
            this.addSolidRectangle2D( rect.x + 1, rect.bottom()-1, rect.right()-1, rect.bottom(), col1 );
            // --- Left
            this.addSolidRectangle2D( rect.x, rect.y+1, rect.x+1, rect.bottom()-1, col1 );
            // --- Right
            this.addSolidRectangle2D( rect.right()-1, rect.y+1, rect.right(), rect.bottom()-1, col1 );
        break;

        case VG.Canvas.Shape2D.RectangleOutlineMin2px:
            // --- Top
            this.addSolidRectangle2D( rect.x + 2, rect.y, rect.right()-2, rect.y+1, col1 );
            // --- Bottom
            this.addSolidRectangle2D( rect.x + 2, rect.bottom()-1, rect.right()-2, rect.bottom(), col1 );
            // --- Left
            this.addSolidRectangle2D( rect.x, rect.y+2, rect.x+1, rect.bottom()-2, col1 );
            // --- Right
            this.addSolidRectangle2D( rect.right()-1, rect.y+2, rect.right(), rect.bottom()-2, col1 );
        break;

        case VG.Canvas.Shape2D.RoundedRectangleOutline1px:
            // --- Top
            this.addSolidRectangle2D( rect.x+1, rect.y, rect.right()-1, rect.y+1, col1 );
            // --- Bottom
            this.addSolidRectangle2D( rect.x+1, rect.bottom()-1, rect.right()-1, rect.bottom(), col1 );
            // --- Left
            this.addSolidRectangle2D( rect.x, rect.y+1, rect.x+1, rect.bottom()-1, col1 );
            // --- Right
            this.addSolidRectangle2D( rect.right()-1, rect.y+1, rect.right(), rect.bottom()-1, col1 );

            // --- Set the anti aliasing pixels in each corner

            var pixelColor=VG.Core.Color( col1 );
            pixelColor.a=0.3;

            this.addSolidRectangle2D( rect.x, rect.y, rect.x+1, rect.y+1, pixelColor );
            this.addSolidRectangle2D( rect.right()-1, rect.y, rect.right(), rect.y+1, pixelColor );
            this.addSolidRectangle2D( rect.x, rect.bottom()-1, rect.x+1, rect.bottom(), pixelColor );
            this.addSolidRectangle2D( rect.right()-1, rect.bottom()-1, rect.right(), rect.bottom(), pixelColor );
        break;

        case VG.Canvas.Shape2D.RoundedRectangle2px:
            // --- Top
            this.addSolidRectangle2D( rect.x+2, rect.y, rect.right()-2, rect.y+2, col1 );
            // --- Bottom
            this.addSolidRectangle2D( rect.x+2, rect.bottom()-2, rect.right()-2, rect.bottom(), col1 );
            // --- Middle
            this.addSolidRectangle2D( rect.x, rect.y+2, rect.right(), rect.bottom()-2, col1 );

            // --- Set the 2x2 anti aliasing pixels in each corner

            pixelColor=VG.Core.Color( col1 );

            // --- Top Left
            pixelColor.a=0.1 * col1.a;
            this.addSolidRectangle2D( rect.x, rect.y, rect.x+1, rect.y+1, pixelColor );
            pixelColor.a=0.75 * col1.a;
            this.addSolidRectangle2D( rect.x+1, rect.y, rect.x+2, rect.y+1, pixelColor );
            this.addSolidRectangle2D( rect.x, rect.y+1, rect.x+1, rect.y+2, pixelColor );
            pixelColor.a=1.0 * col1.a;
            this.addSolidRectangle2D( rect.x+1, rect.y+1, rect.x+2, rect.y+2, pixelColor );
            // --- Top Right
            pixelColor.a=0.1 * col1.a;
            this.addSolidRectangle2D( rect.right()-1, rect.y, rect.right(), rect.y+1, pixelColor );
            pixelColor.a=0.75 * col1.a;
            this.addSolidRectangle2D( rect.right()-2, rect.y, rect.right()-1, rect.y+1, pixelColor );
            this.addSolidRectangle2D( rect.right()-1, rect.y+1, rect.right(), rect.y+2, pixelColor );
            pixelColor.a=1.0 * col1.a;
            this.addSolidRectangle2D( rect.right()-2, rect.y+1, rect.right()-1, rect.y+2, pixelColor );
            // --- Bottom Left
            pixelColor.a=0.1 * col1.a;
            this.addSolidRectangle2D( rect.x, rect.bottom()-1, rect.x+1, rect.bottom(), pixelColor );
            pixelColor.a=0.75 * col1.a;
            this.addSolidRectangle2D( rect.x+1, rect.bottom()-1, rect.x+2, rect.bottom(), pixelColor );
            this.addSolidRectangle2D( rect.x, rect.bottom()-2, rect.x+1, rect.bottom()-1, pixelColor );
            pixelColor.a=1.0 * col1.a;
            this.addSolidRectangle2D( rect.x+1, rect.bottom()-2, rect.x+2, rect.bottom()-1, pixelColor );
            // --- Bottom Right
            pixelColor.a=0.1 * col1.a;
            this.addSolidRectangle2D( rect.right()-1, rect.bottom()-1, rect.right(), rect.bottom(), pixelColor );
            pixelColor.a=0.75 * col1.a;
            this.addSolidRectangle2D( rect.right()-2, rect.bottom()-1, rect.right()-1, rect.bottom(), pixelColor );
            this.addSolidRectangle2D( rect.right()-1, rect.bottom()-2, rect.right(), rect.bottom()-1, pixelColor );
            pixelColor.a=1.0 * col1.a;
            this.addSolidRectangle2D( rect.right()-2, rect.bottom()-2, rect.right()-1, rect.bottom()-1, pixelColor );
        break;

        case VG.Canvas.Shape2D.RectangleCorners:
            // --- Top Left
            this.addSolidRectangle2D( rect.x, rect.y, rect.x+1, rect.y+1, col1 );
            // --- Bottom Left
            this.addSolidRectangle2D( rect.x, rect.bottom()-1, rect.x+1, rect.bottom(), col1 );
            // --- Top Right
            this.addSolidRectangle2D( rect.right()-1, rect.y, rect.right(), rect.y+1, col1 );
            // --- Bottom Right
            this.addSolidRectangle2D( rect.right()-1, rect.bottom()-1, rect.right(), rect.bottom(), col1 );
        break;

        case VG.Canvas.Shape2D.FlippedTriangle:
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y, rect.x + rect.width/2, rect.bottom(), col1, col1, col1 );
        break;

        case VG.Canvas.Shape2D.ArrowRightGradient:
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y + rect.height/2, rect.x, rect.bottom(), col1, col2, col3 );
        break;

        case VG.Canvas.Shape2D.ArrowLeft:
            this.addTriangle2D( rect.x, rect.y+rect.height/2, rect.right(), rect.y, rect.right(), rect.bottom(), col1, col1, col1 );
        break;

        case VG.Canvas.Shape2D.ArrowRight:
            this.addTriangle2D( rect.x, rect.y, rect.right(), rect.y + rect.height/2, rect.x, rect.bottom(), col1, col1, col1 );
        break;

        case VG.Canvas.Shape2D.CircleHue:
        case VG.Canvas.Shape2D.Circle:
            rW = rect.width / 2;
            rH =  rect.height / 2;

            step = Math.floor(VG.Math.clamp(rW * rH, 8, 64));

            theta = 0.0;
            pX = rect.x + rect.width / 2;
            pY = rect.y + rect.height / 2;
            inc = (Math.PI * 2.0) / step;

            if (!col3) col3 = col1;
            if (!col2) col2 = col1;

            for (var i = 1; i <= step; i++)
            {
                x1 = pX + rW * Math.cos(inc * (i - 1));
                y1 = pY - rH * Math.sin(inc * (i - 1));

                x2 = pX + rW * Math.cos(inc * i);
                y2 = pY - rH * Math.sin(inc * i);

                if (shape === VG.Canvas.Shape2D.CircleHue)
                {
                    col1 = this.cacheC1;
                    col1.setHSL(VG.Math.deg(inc * (i - 1)) - 90, 1.0, 0.5);

                    col2 = this.cacheC2;
                    col2.setHSL(VG.Math.deg(inc * i) - 90, 1.0, 0.5);

                    col3 = VG.Core.Color.White;
                }

                this.addTriangle2D(x1, y1, x2, y2, pX, pY, col1, col2, col3);
            }
        break;

        case VG.Canvas.Shape2D.CircleOutline:
            rW = rect.width / 2;
            rH =  rect.height / 2;

            step = Math.floor(VG.Math.clamp(rW * rH, 8, 64));

            let lineWidth = rect.lineWidth === undefined ? 1 : rect.lineWidth;

            theta = 0.0;
            pX = rect.x + rect.width / 2;
            pY = rect.y + rect.height / 2;
            inc = (Math.PI * 2.0) / step;

            if (!col3) col3 = col1;
            if (!col2) col2 = col1;

            for (i = 1; i <= step; i++)
            {
                x1 = pX + rW * Math.cos(inc * (i - 1));
                y1 = pY - rH * Math.sin(inc * (i - 1));

                x2 = pX + rW * Math.cos(inc * i);
                y2 = pY - rH * Math.sin(inc * i);

                this.drawLineGL(x1, y1, x2, y2, lineWidth, col1 );
            }

        break;
    }
};

/**
 * Draws a line using the 2D canvas layer.
 * @param {Number} x1 - From X coordinate
 * @param {Number} y1 - From Y coordinate
 * @param {Number} x2 - To X coordinate
 * @param {Number} y2 - To Y coordinate
 * @param {Number} t - The thickness of the line
 * @param {VG.Core.Color} color - The color of the line
 */

VG.Canvas.prototype.drawLine=function(x1, y1, x2, y2, t, color)
{
    this.ctx.strokeStyle = color.toCanvasStyle();
    this.ctx.lineWidth = t;

    this.ctx.beginPath();
    this.ctx.moveTo(x1+0.5, y1+0.5);
    this.ctx.lineTo(x2-0.5, y2-0.5);
    this.ctx.stroke();
};

/** Draws a cubic bezier line using the 2D canvas layer.
 *  @param {Number} x1 - The p1 x coordinate
 *  @param {Number} y1 - The p1 y coordinate
 *  @param {Number} x2 - The p2 x coordinate
 *  @param {Number} y2 - The p2 y coordinate
 *  @param {Number} x3 - The p3 x coordinate
 *  @param {Number} y3 - The p3 y coordinate
 *  @param {Number} x4 - The p4 x coordinate
 *  @param {Number} y4 - The p4 y coordinate
 *  @param {Number} t - Thickness of the curve
 *  @param {Number} seg - Segment count the higher the better quality
 *  @param {Number} color - The line color */

VG.Canvas.prototype.drawCurve=function(x1, y1, x2, y2, x3, y3, x4, y4, thick, seg, color)
{
    let ctx = this.ctx;
    ctx.strokeStyle = color.toCanvasStyle();
    ctx.lineWidth = thick;

    ctx.beginPath();
    ctx.moveTo( x1, y1 );
    ctx.bezierCurveTo( x2, y2, x3, y3, x4, y4 );
    ctx.stroke();
};

/**
 * Draws a line using the WegGL layer.
 * @param {Number} x1 - From X coordinate
 * @param {Number} y1 - From Y coordinate
 * @param {Number} x2 - To X coordinate
 * @param {Number} y2 - To Y coordinate
 * @param {Number} t - The thickness of the line
 * @param {VG.Core.Color} color - The color of the line
 */

VG.Canvas.prototype.drawLineGL=function(x1, y1, x2, y2, t, color)
{
    let hT = t * 0.5;

    let p0 = this.cacheV2B;
    p0.set(x1, y1);

    let p1 = this.cacheV2C;
    p1.set(x2, y2);

    //direction
    let vD = this.cacheV2A;
    vD.copy(p1);
    vD.sub(p0);
    //vD.normalize();

    //perpendicular direction
    let pD = this.cacheV2D;
    pD.copy(vD);
    pD.setPerpendicular();
    pD.normalize();

    this.addTriangle2D(p0.x + pD.x * hT, p0.y + pD.y * hT, p1.x + pD.x * hT, p1.y + pD.y * hT,
                       p1.x + pD.x * -hT, p1.y + pD.y * -hT, color, color, color);

    this.addTriangle2D(p0.x + pD.x * hT, p0.y + pD.y * hT, p1.x + pD.x * -hT, p1.y + pD.y * -hT,
                       p0.x + pD.x * -hT, p0.y + pD.y * -hT, color, color, color);
};

/** Draws a cubic bezier line using the WebGL layer.
 *  @param {Number} x1 - The p1 x coordinate
 *  @param {Number} y1 - The p1 y coordinate
 *  @param {Number} x2 - The p2 x coordinate
 *  @param {Number} y2 - The p2 y coordinate
 *  @param {Number} x3 - The p3 x coordinate
 *  @param {Number} y3 - The p3 y coordinate
 *  @param {Number} x4 - The p4 x coordinate
 *  @param {Number} y4 - The p4 y coordinate
 *  @param {Number} t - Thickness of the curve
 *  @param {Number} seg - Segment count the higher the better quality
 *  @param {Number} color - The line color */

VG.Canvas.prototype.drawCurveGL=function(x1, y1, x2, y2, x3, y3, x4, y4, thick, seg, color)
{
    let oldX=x1, oldY=y1;
    for (var j = 1; j <= seg; j++)
    {
        let t = j / seg;
        let tx = VG.Math.bezierCubic(t, x1, x2, x3, x4);
        let ty = VG.Math.bezierCubic(t, y1, y2, y3, y4);

        this.drawLine( oldX, oldY, tx, ty, thick, color);
        oldX=tx; oldY=ty;
    }
};

/**
 * Draws an image at the specified position, optionaly scales it to the given size.
 * @param {VG.Core.Point} point - The position of the image
 * @param {VG.Core.Image} image - The image to draw.
 * @param {VG.Core.Size} size - Optional, the size to scale the image to.
 */

VG.Canvas.prototype.drawImage=function( pt, image, size )
{
    if ( image.canvasImage ) {
        this.ctx.drawImage( image.canvasImage, pt.x, pt.y );
        return;
    }

    this.flush();

	var tex = this.renderer.getTexture(image);

    var width=tex.getRealWidth();
	var height=tex.getRealHeight();

    if ( size )
    {
        width=size.width + (image.getRealWidth() - image.getWidth()) * size.width / image.getWidth();
        height=size.height + (image.getRealHeight() - image.getHeight()) * size.height / image.getHeight();
    }

    //using the renderer's routine, as drawing textured 2d quads is very common
    this.renderer.drawQuad(tex, width, height, pt.x, pt.y, this.alpha);
};

/**
 * Downscales an image into the specified rectangle. During downscaling the aspect ratio of the image is honored and the image is centered inside the rectangle.
 * @param {VG.Core.Rect} rect - The rectangle to draw into
 * @param {VG.Core.Image} image - The image to draw
 */

VG.Canvas.prototype.drawScaledImage=function( rect, image )
{
    // --- Get new Width and Height based on Aspect Ratio
    var aspectRatio=image.height / image.width;

    var newWidth, newHeight;

    if ( rect.width * aspectRatio > rect.height ) {
        newWidth=rect.height / aspectRatio < image.width ? rect.height / aspectRatio : image.width;
    } else {
        newWidth=rect.width < image.width ? rect.width : image.width;
    }
    newHeight=aspectRatio*newWidth;

    var xOffset=Math.round( (rect.width - newWidth)/2 );
    var yOffset=Math.round( (rect.height - newHeight)/2 );

    newWidth = Math.round( newWidth );
    newHeight = Math.round( newHeight );

    this.drawImage( VG.Core.Point( rect.x + xOffset, rect.y + yOffset ), image, VG.Core.Size( newWidth, newHeight ) );
};


/**
 * Fills the given fillRect with the given image. The image is tiled optionally in the horizontal and vertical directions.
 * @param {VG.Core.Rect} rect - The rectangle to fill.
 * @param {VG.Core.Image} image - The image to tile
 * @param {bool} horizontal - True if the image should be tiled horizontally.
 * @param {bool} vertical - True if the image should be tiled vertically.
 * @param {number} horOffset - Optional, the horizontal offset can be adjusted with this value, for example a value of -10 would adjust the image 10 pixels to the left on each iteration.
 * @param {number} verOffset - Optional, adjust the vertical offset.
 */

VG.Canvas.prototype.drawTiledImage=function( fillRect, image, horizontal, vertical, horOffset, verOffset )
{
    if ( !image.isValid() ) return;
    var rect=VG.Core.Rect( fillRect.x, fillRect.y, image.width, image.height );
    this.pushClipRect( fillRect );

    do
    {
        rect.x=fillRect.x;
        while( rect.x < fillRect.right() )
        {
            this.drawImage( rect, image );

            if ( !horizontal ) break;
            rect.x+=image.width;
            if ( horOffset ) rect.x+=horOffset;
        }

        if ( !vertical ) break;
        rect.y+=image.height;
    } while( rect.y < fillRect.bottom() );

    this.popClipRect();
};

/**
 * Returns the size of the given text using the current canvas font. Returns an VG.Core.Size, optionally you can pass the size object to use.
 * @param {string} text - The text to analyze for size using the current canvas font.
 * @param {VG.Core.Size} size - The size object to use, optional.
 * @returns {VG.Core.Size}
 */

VG.Canvas.prototype.getTextSize=function( text, size )
{
    if ( !size ) size = new VG.Core.Size();

    this.ctx.textBaseline = "hanging";

    size.width = ( this.ctx.measureText( text ).width );
    size.height = this.fontHeight;//this.getLineHeight();

    return size;
};

/**
 * Returns the height of one line of text using the current canvas font.
 * @returns {number}
 */

VG.Canvas.prototype.getLineHeight=function()
{
    // var font=this.fonts[this.fontIndex];
    // return this.font.triFont.height * this.font.scale;
    return Math.ceil( this.fontHeight * 1.4 );
};

// --------------------------------------------- VG.Canvas.prototype.wordWrap

VG.Canvas.prototype.wordWrap=function( text, start, width, textLines, dontAppendBreakSymbol )
{
    let font=this.fonts[this.fontIndex];
    let lineWidth=start;
    let oneWordFit=false;
    let newLine=false;

    if( text === "" || text===undefined || width < 0 ) {
        textLines.push("");
        return { nextStart: start };
    }

    if( !textLines ) textLines=[];

    let i=0;
    while( text )
    {
        let snipLocation;
        lineWidth += this.getTextSize( text[i] ).width;

        if(lineWidth >= width)
        {
            // Not even the 1st letter fits.
            if(i === 0) {
                newLine=true;
                lineWidth=0;
                continue;
            }

            if(text[i] === " ")
            {
                snipLocation = i+1 < text.length ? i+1 : i;
                if( snipLocation === i )
                    textLines.push(text.substring( 0 ) );
                else
                    textLines.push( text.substring ( 0, snipLocation ) );

                text=text.substring(snipLocation);
                i=0;
                lineWidth = 0;
            }
            else
            {
                var j = i;
                for(j = i; j >= 0; --j)
                {
                    if(text[j] === " ")
                    {
                        textLines.push( text.substring ( 0, j+1 ) );
                        text=text.substring(j+1);
                        i=0;
                        lineWidth = 0;
                        break;
                    }
                }

                if(i != j && j === -1)
                {
                    // Clearly this word doesnt fit in one line.
                    snipLocation = i-1 > 0 ? i-1 : i;
                    if ( dontAppendBreakSymbol ) textLines.push( text.substring ( 0, snipLocation) );
                    else textLines.push( text.substring ( 0, snipLocation) + "-" );
                    text=text.substring( snipLocation );
                    lineWidth = 0;
                    i = 0;
                    continue;
                }
                else if( j >= 0 )
                    continue;
            }
        }
        else if( text[i] == " " && !newLine ) oneWordFit = true;

        ++i;
        if(i >= text.length) break;
    }

    if ( !oneWordFit && lineWidth < width && !newLine ) oneWordFit = true;

    textLines.push( text.substring ( 0 ));

    return { nextStart: lineWidth, forceStartNewLine: !oneWordFit };
};

/**
 * Draws one line of text using the current canvas font aligned inside the given rectangle using the 2D canvas layer. Optionally rotates the font.
 * @returns {string} text - The text to draw.
 * @returns {VG.Core.Rect} rect - The rectangle to align the text into
 * @returns {VG.Core.Color} col - The color to use for the text drawing
 * @returns {number} halign - The horizontal alignment method: 0 is left, 1 centered and 2 is right. TODO: Move into enum
 * @returns {number} valign - The vertical alignment method: 0 is top (plus font descender), 1 centered, 2 is bottom and 3 is top without descender. TODO: Move into enum
 */

VG.Canvas.prototype.drawTextRect=function( text, rect, col, halign, valign, angle, crX, crY)
{
    let ctx = this.ctx; ctx.globalAlpha = this.alpha;
    let textSize = VG.Core.Size( ctx.measureText( text).width, this.getLineHeight() );

    // if ( valign === 0 )
        // this.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, VG.Core.Color( 255, 0, 0 ) );
    // else if ( valign === 1 )
        // this.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, VG.Core.Color( 0, 255, 0 ) );
    // else if ( valign === 2 )
        // this.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, VG.Core.Color( 0, 0, 255 ) );

    ctx.save();
    ctx.rect( rect.x, rect.y, rect.width,  textSize.height > rect.height ? textSize.height : rect.height );
    ctx.clip();

    ctx.fillStyle = col.toCanvasStyle();
    ctx.textBaseline = "top";
    ctx.lineWidth = 1.0;

    let startX = rect.x;
    let y = rect.y;

    if ( !angle ) angle = 0;

    // --- Alignment

    var xalign=1, yalign=1;
    if ( arguments.length == 5 ) {
        xalign=halign; yalign=valign;
    }

    if ( xalign === 1 ) {
        if ( textSize.width > rect.width ) startX = rect.x;
        else startX=rect.x + (rect.width - textSize.width) / 2;
    } else
    if ( xalign === 2 ) {
        startX=rect.x + rect.width - textSize.width;
    }

    if ( yalign === 1 ) {
        ctx.textBaseline = "middle";
        y = rect.y + Math.ceil( rect.height / 2 );
        if ( this.fireFox ) ++y;
    } else
    if ( yalign === 2 ) {
        y = rect.y + rect.height - textSize.height;
        if ( y < rect.y ) y = rect.y;
        if ( this.fireFox ) ++y;
    } else
    if ( yalign === 3 ) {
        y = rect.y;
    }

    if ( angle !== 0 ) {
        crX = crX ? crX : rect.x + rect.width / 2;
        crY = crY ? crY : rect.y + rect.height / 2;

        ctx.translate( crX, crY );
        ctx.rotate( - VG.Math.rad( angle ) );
        ctx.translate( -crX, -crY );
    }

    ctx.fillText( text, startX, y );
    ctx.restore();

    return textSize.width;
};

/**
 * Draws one line of text using the current canvas font aligned inside the given rectangle using the WebGL layer. Optionally rotates the font.
 * @returns {string} text - The text to draw.
 * @returns {VG.Core.Rect} rect - The rectangle to align the text into
 * @returns {VG.Core.Color} col - The color to use for the text drawing
 * @returns {number} halign - The horizontal alignment method: 0 is left, 1 centered and 2 is right. TODO: Move into enum
 * @returns {number} valign - The vertical alignment method: 0 is top (plus font descender), 1 centered, 2 is bottom and 3 is top without descender. TODO: Move into enum
 */

VG.Canvas.prototype.drawTextRectGL=function( text, rect, col, halign, valign, angle, crX, crY)
{
    var font=this.fonts[this.fontIndex];

    var b=font.triFont.buffer, i;

    //create the gpu buffer if not present
    if (!b)
    {
        var v = font.triFont.tris;

        //Static gpu buffer
        b = new VG.GPUBuffer(VG.Type.Float, 2 * v.length, false);

        var j = 0;
        var db=b.getDataBuffer();

        for (i = 0; i < v.length; i++)
        {
            db.set(j++, v[i].x);
            db.set(j++, v[i].y);
        }

        if (j != v.length * 2) throw [j, v.length, "buffer length missmatch"];


        b.create();

        font.triFont.buffer = b;

        /* makes sure that there's no rederences left on the triangle array as
         *  the buffer has a copy already, from this point on it's not needed */

        delete font.triFont.tris;
        v = null;
    }

    //if angle not defined assume no rotation
    if (!angle) {
        angle = 0;
    }

    var startX=rect.x;
    var x=0, y=rect.y - font.triFont.descender * font.scale;
    //var lineHeight=font.triFont.height * font.size;

    var textSize=VG.Core.Size();
    this.getTextSize( text, textSize );

    if ( textSize.height > rect.height ) return;

    // --- Alignment

    var xalign=1, yalign=1;
    if ( arguments.length == 5 ) {
        xalign=halign; yalign=valign;
    }

    if ( xalign === 1 ) {
        if ( textSize.width > rect.width ) startX=rect.x;
        else startX=rect.x + (rect.width - textSize.width) / 2;
    } else
    if ( xalign === 2 ) {
        startX=rect.x + rect.width - textSize.width;
    }

    if ( yalign === 1 ) {
        y=rect.y + (rect.height - font.triFont.height * font.scale) / 2 - font.triFont.descender * font.scale;
    } else
    if ( yalign === 2 ) {
        y=rect.y + rect.height - textSize.height;
    } else
    if ( yalign === 3 ) {
        y=rect.y;
    }

    y=Math.round( y );
    // --- Draw it

    // fix rotation at center for now
    crX = crX ? crX : rect.x + rect.width / 2;
    crY = crY ? crY : rect.y + rect.height / 2;

    this.flush();

    this.fontShader.bind();
    this.fontShader.setFloat("uniformAlpha", this.alpha);
    this.fontShader.setColor("color", col);

    b.bind();
	b.vertexAttrib(this.fontShader.getAttrib("vPos"), 2, false, 8, 0);

    var tM = this.cacheM1;

    tM.setIdentity();

    if ( !this.customTarget )
        this.fontShader.setMatrix( "pM", VG.Renderer().proj2d.elements );
    else {
        this.fontShader.setMatrix( "pM", this.customProjM.elements );
        this.customTarget.bind();
        this.customTarget.setViewportEx( 0, 0, this.customTarget.width, this.customTarget.height );
    }

    for (i = 0; i < text.length; i++)
    {
        var g = VG.Font.Triangulator.getGlyph( font.triFont, text[i] );

        var drawX=Math.round( startX + x );

        if ( angle === 0.0 && ( x + g.width * font.scale ) > rect.width ) return;

        tM.setIdentity();

        if (angle !== 0.0)
        {
            tM.translate(crX, crY, 0);
            tM.rotate(-angle, 0, 0, 1);
            tM.translate(-crX, -crY, 0);
        }

        tM.translate(drawX, y, 0);
        tM.scale(font.scale, font.scale, font.scale);

        this.fontShader.setMatrix("tM", tM.elements);

        if (g.size > 0)
            b.drawBuffer(VG.Renderer.Primitive.Triangles, g.offset, g.size);

        x+=g.width * font.scale;
    }

    if ( this.customTarget )
        this.customTarget.unbind();

    return x;
};

// --------------------------------------------- VG.Canvas.prototype.drawSVG

VG.Canvas.prototype.drawSVG=function( svg, svgGroup, rect, col, angle, crX, crY)
{
    /**Draws one line of text using the current canvas font aligned inside the given rectangle. Optionally rotates the font.
     * @returns {string} text - The text to draw.
     * @returns {VG.Core.Rect} rect - The rectangle to align the text into
     * @returns {VG.Core.Color} col - The color to use for the text drawing
     * @returns {number} halign - The horizontal alignment method: 0 is left, 1 centered and 2 is right. TODO: Move into enum
     * @returns {number} valign - The vertical alignment method: 0 is top (plus font descender), 1 centered, 2 is bottom and 3 is top without descender. TODO: Move into enum
     */

    var b=svg.buffer;

    //create the gpu buffer if not present
    if (!b)
    {
        var v = svg.tris;

        //Static gpu buffer
        b = new VG.GPUBuffer(VG.Type.Float, v.length, true);

        var j = 0;
        var db=b.getDataBuffer();

        for (var i = 0; i < v.length; i++)
            db.set(j++, v[i] );

        if (j != v.length ) throw [j, v.length, "buffer length missmatch"];

        b.create();

        svg.buffer = b;

        /* makes sure that there's no rederences left on the triangle array as
         *  the buffer has a copy already, from this point on it's not needed */


        delete svg.tris;
        v = null;
    }


    if ( !svgGroup ) group=svg.groups[0];
    else group=svgGroup;

    //if angle not defined assume no rotation
    if (!angle) {
        angle = 0;
    }

    var posX=rect.x, posY=rect.y;
    var scale=1;

    if ( rect.width && rect.height )//&& ( rect.width < group.width || rect.height < group.height ) )
    {
        var scaleX=rect.width / group.width;
        var scaleY=rect.height / group.height;

        scale=Math.min( scaleX, scaleY );

        // --- temp solution for icon alignment
        if ( group.name === "SaveAs" ) {
            posY-=4; scale=0.93;
        }

        var newWidth=group.width * scale;//aspectRatio;
        var newHeight=group.height * scale;//aspectRatio;

        posX+=(group.width*scaleX - newWidth)/2 - group.bbox.minX * scale;
        posY+=(group.height*scaleY - newHeight)/2 - group.bbox.minY * scale;
    } else
    if ( rect.width && rect.height ) {
        posX+=(rect.width - group.width)/2 - group.bbox.minX;
        posY+=(rect.height - group.height)/2 - group.bbox.minY;
    }

    posX=Math.round( posX ); posY=Math.round( posY );

    // --- Draw it

    // fix rotation at center for now
    crX = crX ? crX : rect.x + rect.width / 2;
    crY = crY ? crY : rect.y + rect.height / 2;

    this.flush();

    this.fontShader.bind();
    this.fontShader.setFloat("uniformAlpha", this.alpha);
    this.fontShader.setColor("color", col);

    b.bind();
    b.vertexAttrib(this.fontShader.getAttrib("vPos"), 2, false, 8, 0);

    var tM = this.cacheM1;

    tM.setIdentity();

    this.fontShader.setMatrix("pM", VG.Renderer().proj2d.elements);

    tM.setIdentity();

    if (angle !== 0.0)
    {
        tM.translate(crX, crY, 0);
        tM.rotate(-angle, 0, 0, 1);
        tM.translate(-crX, -crY, 0);
    }

    tM.translate( posX, posY, 0);
    tM.translate( 0, 0, 0);
    tM.scale(scale, scale, scale);

    this.fontShader.setMatrix("tM", tM.elements);

    if (group.triSize > 0)
        b.drawBuffer(VG.Renderer.Primitive.Triangles, Math.round( group.triOffset/2 ), Math.round( group.triSize/2 ) );
};

/**
 * Make sure the UI gets repaint on the next tick.
 **/

VG.Canvas.prototype.update=function()
{
    VG.update();
};

/**
 * Clears the given rectangle on the GL layer.
 * @param {VG.Core.Rectangle} rect - The rectangle to clear.
 **/

VG.Canvas.prototype.clearGLRect=function( rect )
{
    this.flush();
    this.rt.setScissor( rect );
    this.rt.clear( true );
    this.rt.setScissor();
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

var VG;
(function (VG) {
    "use strict";
    var WebGL,
        GPUBuffer,
        Shader,
        QuadShader,
        Texture,
        RenderTarget,
        gl,
        _state = VG._state = {
            WebGL: {
                enabled: {},
                activeTexture: 0,
                texture: {},
                vertexAttrib: {},
                stencilMode: null
            },
            GPUBuffer: {
                bindBuffer: {}
            },
            Shader: {},
            Texture: {},
            FrameBuffer: {}
        };

    /**
     * Initialize VG.
     * This method should be called before call to any GL related classes, i.e:
     * Shader, GPUBuffer, Texture, Rendertarget
     *
     * <pre>
     * Common usage:
     * VG.Init();
     * ...
     * // here create buffer, see: VG.GPUBuffer
     * ...
     * // here create shader, see: VG.Shader
     * ...
     * // rede to draw
     * </pre>
     * @return {null}
     */

    VG.init = function () {
        WebGL.init();
    };

    /**
     *
     * @constructor
     */

    VG.WebGL = WebGL = function () {
    };

    /**
     * @returns
     * @private
     */

    VG.WebGL.init = function () {
        WebGL.canvas = document.getElementById('webgl');
        gl = VG.gl = WebGL.gl = WebGLUtils.setupWebGL(WebGL.canvas);
        WebGL.samples = WebGL.gl.getParameter(WebGL.gl.SAMPLES);
        var maxTextureImageUnits = 8;
        for (var i = 0; i < maxTextureImageUnits; i += 1) {
            _state.WebGL.texture[i] = {};
        }
        VG.WebGL.magFilter = gl.LINEAR;
        VG.WebGL.minFilter = gl.LINEAR;

        if ( !VG.webgl2 ) {
            // --- WebGL 1 extensions
            this.supportsFloatTextures = gl.getExtension("OES_texture_float");
            this.supportsFloatLinear = gl.getExtension("OES_texture_float_linear");
            this.disjointTimerExt = VG.WebGL.gl.getExtension('EXT_disjoint_timer_query');
        } else {
            // --- WebGL 2 extensions
            this.disjointTimerExt = VG.WebGL.gl.getExtension('EXT_disjoint_timer_query_webgl2');
            if ( !this.disjointTimerExt )
                this.disjointTimerExt = VG.WebGL.gl.getExtension('EXT_disjoint_timer_query');
            this.supportsFloatTextures = gl.getExtension("EXT_color_buffer_float");
            this.supportsFloatLinear = gl.getExtension("OES_texture_float_linear");
        }
    };

    /**
     * Convert VG.Renderer.Primitive type to GL types
     * @param primitiveType
     * @returns {number}
     * @private
     */

    VG.WebGL.primitiveTypeToGL = function (primitiveType) {
        if (primitiveType === VG.Renderer.Primitive.Lines)
            return gl.LINES;
        if (primitiveType === VG.Renderer.Primitive.LineStrip)
            return gl.LINE_STRIP;
        if (primitiveType === VG.Renderer.Primitive.TriangleStrip)
            return gl.TRIANGLE_STRIP;
        if (primitiveType === VG.Renderer.Primitive.Points)
            return gl.POINTS;
        return gl.TRIANGLES;
    };

    /**
     * GPUBuffer encapsulates OpenGL VBO<br>
     * Usage:<br>
     *     <pre>
     * var g = new GPUBuffer(VG.Type.Float, 3*3).create();
     * ... fill with data ...
     * g.update(); // transfer data and optional alloc
     * ...
     * ... link data to shader pointer ...
     * g.vertexAttrib(...);
     * ...
     * g.bind();
     * g.update();
     * ... drawing ...
     * shader.bind();
     * b.drawBuffer(...);
     * ...
     * g.destroy()
     * g.create()
     * ...
     * g.dispose()
     * </pre>
     * @param {VG.Type} type - Type of buffer, i.e VG.Type.Float
     * @param {number} size - Size of buffer (#type)
     * @param {boolean} [dynamic=false] - Is dynamic buffer
     * @param {boolean} [isIndexBuffer=false] - Index buffer flag
     * @constructor
     */

    VG.GPUBuffer = GPUBuffer = function (type, size, dynamic, isIndexBuffer) {
        this.id = 0;
        this.usage = dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;
        this.target = isIndexBuffer ? gl.ELEMENT_ARRAY_BUFFER : gl.ARRAY_BUFFER;
        this.type = type;
        if (type === VG.Type.Float)
            this.elemType = gl.FLOAT;
        else if (type === VG.Type.Uint8)
            this.elemType = gl.UNSIGNED_BYTE;
        else if (type === VG.Type.Uint16)
            this.elemType = gl.UNSIGNED_SHORT;
        else if (type === VG.Type.Uint32)
            this.elemType = gl.UNSIGNED_INT;
        else
            throw "Invalid Type:" + type + ".";
        this.dataBuffer = new VG.Core.TypedArray(type, size);
        if (!this.dataBuffer.data)
            throw "Fail to create dataBuffer";
        VG.Renderer().addResource(this);
        this._state = {};
    };

    /**
     * Get the stride in bytes.<br>
     * Stride in #bytes per element.
     * @returns {number} - Buffer stride.
     */

    VG.GPUBuffer.prototype.getStride = function () {
        return this.dataBuffer.data.BYTES_PER_ELEMENT;
    };
    /**
     * Get data buffer, i.e vertex buffer
     * @returns {VG.Core.TypedArray} - Buffer data.
     */

    VG.GPUBuffer.prototype.getDataBuffer = function () {
        return this.dataBuffer;
    };

    /**
     * Allocate buffer ID in GPU. Auto bind.
     * This also transfer data to GPU.
     * @returns {VG.GPUBuffer} - this
     * @private
     */

    VG.GPUBuffer.prototype.create = function () {
        if (this.id !== 0) {
            throw "GPUBuffer.create(), this.id !== 0. Buffer already created.";
        }
        this.id = gl.createBuffer();
        this.bind();
        this.update();
        return this;
    };
    /**
     * Bind buffer.
     * @returns {VG.GPUBuffer} - this
     */

    VG.GPUBuffer.prototype.bind = function () {
        if (_state.GPUBuffer.bindBuffer[this.target] !== this.id) {
            gl.bindBuffer(this.target, this.id);
            _state.GPUBuffer.bindBuffer[this.target] = this.id;
        }
        return this;
    };

    /**
     * Update the buffer from RAM to GPU. <br>
     * The updated data must be inside dataBuffer.data. <br>
     * offset + count <= this.dataBuffer.data.length <br>
     * @param {number} [offset=0] - Offset to update
     * @param {number} [count=data.size] - Count to update
     * @returns {VG.GPUBuffer} - this
     */

    VG.GPUBuffer.prototype.update = function (offset, count) {
        if (this.id === 0)
            throw "GPUBuffer.update(), this.id == 0.";
        this.bind();
        offset = offset === undefined || offset < 0 ? 0 : offset;
        count = count === undefined ? this.dataBuffer.data.length : count;
        if (offset + count > this.dataBuffer.data.length) {
            throw "GPUBuffer.update(), offset + count (" + (offset + count) + ") > data.length (" + this.dataBuffer.data.length + ")";
        }
        if (this._state.bufferData) {
            var data = offset === 0 && count === this.dataBuffer.data.length ?
                this.dataBuffer.data : this.dataBuffer.data.subarray(offset, count);
            gl.bufferSubData(this.target, offset, data);
        }
        else {
            gl.bufferData(this.target, this.dataBuffer.data, this.usage);
            this._state.bufferData = true;
        }
        return this;
    };
    /**
     * Release buffer from GPU.
     * Opposite of create()
     * @private
     */

    VG.GPUBuffer.prototype.destroy = function () {
        if (this.id === 0)
            return;
        gl.deleteBuffer(this.id);
        delete this._state.bufferData;
        this.id = 0;
    };

    /**
     * Invalidate.
     * Opposite of new.
     */
    VG.GPUBuffer.prototype.dispose = function () {
        this.destroy();
        delete this.dataBuffer;
        VG.Renderer().removeResource(this);
    };

    /**
     * Pointer a buffer to a vertex attribute.
     * @param {number} index - Index of attribute, i.e: shader.getAttrib("v_position")
     * @param {number} size - Size of each item
     * @param normalized
     * @param stride
     * @param offset
     * @returns {VG.GPUBuffer} this
     */

    VG.GPUBuffer.prototype.vertexAttrib = function (index, size, normalized, stride, offset) {
        var shader = _state.Shader.bind;
        shader._state.toEnable[index] = true;
        if (index in _state.WebGL.vertexAttrib) {
        }
        else {
            gl.enableVertexAttribArray(index);
            _state.WebGL.vertexAttrib[index] = true;
        }
        gl.vertexAttribPointer(index, size, this.elemType, normalized, stride, offset);
        return this;
    };

    /**
     * Draw VBO (vertex buffer)
     * @param primitiveType {VG.Renderer.Primitive} Type of primitive
     * @param offset {number} Offset
     * @param count {number} Count
     * @returns {VG.GPUBuffer}
     */

    VG.GPUBuffer.prototype.drawBuffer = function (primitiveType, offset, count) {
        var shader = _state.Shader.bind;
        for (var index in _state.WebGL.vertexAttrib) {
            if (!(index in shader._state.toEnable)) {
                gl.disableVertexAttribArray(index);
                delete _state.WebGL.vertexAttrib[index];
            }
        }
        if (this.target === gl.ELEMENT_ARRAY_BUFFER) {
            gl.drawElements(WebGL.primitiveTypeToGL(primitiveType), count, this.elemType, offset);
        } else {
            gl.drawArrays(WebGL.primitiveTypeToGL(primitiveType), offset, count);
        }
        return this;
    };

    /**
     * Construct & compile shader with given source.
     * <pre>
     *     Example:
     *     s = new Shader(vsSource, fsSource);
     *     s.create();
     *     ...
     *     // drawing
     *     s.bind();
     *     gpuBuffer.drawBuffer(...);
     *     ...
     *     // clean up
     *     s.destroy();
     * </pre>
     * @param vSource {string} Vertex source
     * @param fSource {string} Fragment source
     * @constructor
     */

    VG.Shader = Shader = function (vSource, fSource) {
        this.depthWrite = false;
        this.depthTest = false;
        this.blendType = VG.Shader.Blend.None;
        this.blendEquation = VG.Shader.BlendEquation.Add;
        this.culling = false;
        this.id = 0;
        this._state = {
            uniform: {},
            attribute: {},
            value: {},
            toEnable: {}
        };
        this.vSource = vSource;
        this.fSource = fSource;
        VG.Renderer().addResource(this);
    };

    /**
     * Compile this Shader
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.create = function () {
        var vId = gl.createShader(gl.VERTEX_SHADER);
        var fId = gl.createShader(gl.FRAGMENT_SHADER);

        let self  = this;
        function compile(id, source) {
            gl.shaderSource(id, source);
            gl.compileShader(id);
            if (!gl.getShaderParameter(id, gl.COMPILE_STATUS)) {
                if ( self.errorCallback ) self.errorCallback( gl.getShaderInfoLog(id) );
                else console.error(gl.getShaderInfoLog(id));
                return false;
            }
            return true;
        }

        if (!compile(vId, this.vSource) || !compile(fId, this.fSource)) {
            gl.deleteShader(vId);
            gl.deleteShader(fId);
            throw "Shader.compile(), fail in vertex or fragment shader.";
        }
        this.id = gl.createProgram();
        gl.attachShader(this.id, vId);
        gl.attachShader(this.id, fId);
        gl.linkProgram(this.id);
        if (!gl.getProgramParameter(this.id, gl.LINK_STATUS)) {
            var error = gl.getProgramInfoLog(this.id);
            this.destroy();
            throw "Shader.compile(), fail to link program: " + error;
        }
        this.vId = vId;
        this.fId = fId;
        return this;
    };

    /**
     * Compile this Shader
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.compile = function () {
        var vId = gl.createShader(gl.VERTEX_SHADER);
        var fId = gl.createShader(gl.FRAGMENT_SHADER);

        let self  = this;
        function compile(id, source) {
            gl.shaderSource(id, source);
            gl.compileShader(id);
            /*
            if (!gl.getShaderParameter(id, gl.COMPILE_STATUS)) {
                if ( self.errorCallback ) self.errorCallback( gl.getShaderInfoLog(id) );
                else console.error(gl.getShaderInfoLog(id));
                return false;
            }*/
            return true;
        }

        if (!compile(vId, this.vSource) || !compile(fId, this.fSource)) {
            gl.deleteShader(vId);
            gl.deleteShader(fId);
            throw "Shader.compile(), fail in vertex or fragment shader.";
        }

        this.vId = vId;
        this.fId = fId;

        this.id = gl.createProgram();
        return this;
    };

    /**
     * Link this Shader
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.link = function () {

        if (!gl.getShaderParameter(this.fId, gl.COMPILE_STATUS)) {
            if ( self.errorCallback ) self.errorCallback( gl.getShaderInfoLog(this.fId) );
            else console.error(gl.getShaderInfoLog(this.fId));
            return false;
        }

        gl.attachShader(this.id, this.vId);
        gl.attachShader(this.id, this.fId);
        gl.linkProgram(this.id);

        if (!gl.getProgramParameter(this.id, gl.LINK_STATUS)) {
            var error = gl.getProgramInfoLog(this.id);
            this.destroy();
            throw "Shader.compile(), fail to link program: " + error;
        }

        return this;
    };

    /**
     * Release shader from GPU.
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.destroy = function () {
        if (this.id === 0)
            return this;
        gl.deleteProgram(this.id);
        gl.deleteShader(this.vId);
        gl.deleteShader(this.fId);
        this.id = 0;
        this.vId = 0;
        this.fId = 0;
        this._state.uniform = {};
        this._state.attribute = {};
        this._state.value = {};
        return this;
    };

    /**
     * Invalidate this object
     */

    VG.Shader.prototype.dispose = function () {
        this.destroy();
        VG.Renderer().removeResource(this);
    };
    /**
     * Bind Shader
     * @returns {VG.Shader}
     * todo: add other blend mode
     */

    VG.Shader.prototype.bind = function () {
        if (_state.WebGL.useProgram !== this.id) {
            gl.useProgram(this.id);
            _state.WebGL.useProgram = this.id;
            _state.Shader.bind = this;
        }
        if (this.blendType === VG.Shader.Blend.None) {
            if (_state.WebGL.enabled.blend !== false) {
                gl.disable(gl.BLEND);
                _state.WebGL.enabled.blend = false;
            }
        }
        else {
            if (_state.WebGL.enabled.blend !== true) {
                gl.enable(gl.BLEND);
                _state.WebGL.enabled.blend = true;
            }
            if (_state.WebGL.blendFunc !== this.blendType) {
                switch (this.blendType) {
                    case VG.Shader.Blend.RemoveBack:
                        gl.blendFunc(gl.ONE, gl.ZERO);
                        break;
                    case VG.Shader.Blend.Additive:
                        gl.blendFunc(gl.SRC_ALPHA, gl.ONE);
                        break;
                    case VG.Shader.Blend.AdditiveIgnoreAlpha:
                        gl.blendFunc(gl.ONE, gl.ONE);
                        break;
                    case VG.Shader.Blend.Alpha:
                        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
                        break;
                    case VG.Shader.Blend.Brush:
                        gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
                        break;
                    case VG.Shader.Blend.OneAlpha: // transparent
                        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
                        break;
                    case VG.Shader.Blend.ReverseBrush:
                        gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ZERO, gl.ONE_MINUS_SRC_ALPHA);
                        break;
                }
                _state.WebGL.blendFunc = this.blendType;
            }
            if (_state.WebGL.blendEquation !== this.blendEquation) {
                switch (this.blendEquation) {
                    case VG.Shader.BlendEquation.Add:
                        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
                        break;
                    case VG.Shader.BlendEquation.Subtract:
                        gl.blendEquationSeparate(gl.FUNC_SUBTRACT, gl.FUNC_SUBTRACT);
                        break;
                    case VG.Shader.BlendEquation.ReverseSubtract:
                        gl.blendEquationSeparate(gl.FUNC_REVERSE_SUBTRACT, gl.FUNC_REVERSE_SUBTRACT);
                        break;
                    case VG.Shader.BlendEquation.AddReverseSubtract:
                        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_REVERSE_SUBTRACT);
                        break;
                    case VG.Shader.BlendEquation.Min:
                        gl.blendEquation(VG.WebGL.ext.minmax.MIN_EXT);
                        break;
                    case VG.Shader.BlendEquation.Max:
                        gl.blendEquation(VG.WebGL.ext.minmax.MAX_EXT);
                        break;
                }
                _state.WebGL.blendEquation = this.blendEquation;
            }
        }
        if (_state.WebGL.enabled.depthTest !== this.depthTest) {
            if (this.depthTest)
                gl.enable(gl.DEPTH_TEST);
            else
                gl.disable(gl.DEPTH_TEST);
            _state.WebGL.enabled.depthTest = this.depthTest;
        }
        if (_state.WebGL.depthFunc !== this.depthWrite) {
            if (this.depthWrite)
                gl.depthFunc(gl.LESS);
            else
                gl.depthFunc(gl.NEVER);
            _state.WebGL.depthFunc = this.depthWrite;
        }
        if (_state.WebGL.enabled.cullFace !== this.culling) {
            if (this.culling) {
                gl.enable(gl.CULL_FACE);
                gl.cullFace(gl.BACK);
            }
            else
                gl.disable(gl.CULL_FACE);
            _state.WebGL.enabled.cullFace = this.culling;
        }
        return this;
    };

    /**
     * Get Uniform location
     * @param name
     * @returns {number}
     */

    VG.Shader.prototype.getUniform = function (name) {
        if (name in this._state.uniform)
            return this._state.uniform[name];
        this._state.uniform[name] = gl.getUniformLocation(this.id, name);
        return this._state.uniform[name];
    };

    /**
     * Get Attribute location.
     * @param name
     * @returns {number}
     */

    VG.Shader.prototype.getAttrib = function (name) {
        if (!(name in this._state.attribute)) {
            this._state.attribute[name] = gl.getAttribLocation(this.id, name);
        }
        if (this._state.attribute[name] === -1) {
            VG.log("shader does not use attribute: " + name);
        }
        return this._state.attribute[name];
    };

    /**
     * Set uniform value
     * @param {number | string} uniform Can be string (name) or number (id).
     * @param {number | Array} value
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setFloat = function (uniform, value) {
        var name = uniform,
            cache = false;
        if (!(uniform instanceof WebGLUniformLocation)) {
            uniform = this.getUniform(uniform);
            cache = true;
        }
        if (value instanceof Array) {
            if (value.length === 0)
                throw "Shader.setFloat(), value == [].";
            else if (value.length === 1) {
                if (!cache || this._state.value[name] !== value[0]) {
                    gl.uniform1f(uniform, value[0]);
                    this._state.value[name] = value[0];
                }
            }
            else if (value.length === 2) {
                if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 2)) {
                    gl.uniform2fv(uniform, value);
                    this._state.value[name] = Array.from(value);
                }
            }
            else if (value.length === 3) {
                if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 3)) {
                    gl.uniform3fv(uniform, value);
                    this._state.value[name] = Array.from(value);
                }
            }
            else {
                if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 4)) {
                    gl.uniform4fv(uniform, value);
                    this._state.value[name] = Array.from(value);
                }
            }
        }
        else {
            if (!cache || this._state.value[name] !== value) {
                gl.uniform1f(uniform, value);
                this._state.value[name] = value;
            }
        }
        return this;
    };

    /**
     * Set uniform with Float Array.
     * @param {number|string} uniform - uniform name or index
     * @param {[Float]} value - input Float Array
     * @param {number=1} size - size of each element, ie. 3 for vec3
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setFloatArray = function (uniform, value, size) {
        var name = uniform,
            cache = false;
        if (!(uniform instanceof WebGLUniformLocation)) {
            uniform = this.getUniform(uniform);
            cache = true;
        }
        if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, value.length)) {
            gl['uniform' + (size ? size : 1) + 'fv'](uniform, value);
            if (cache) {
                this._state.value[name] = Array.from(value);
            }
        }
        return this;
    };

    /**
     * Set uniform value
     * @param {number | string} uniform Can be string (name) or number (id).
     * @param {number | Array} value
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setInt = function (uniform, value) {
        var name = uniform,
            cache = false;
        if (!(uniform instanceof WebGLUniformLocation)) {
            uniform = this.getUniform(uniform);
            cache = true;
        }
        if (value instanceof Array) {
            if (value.length === 0)
                throw "Shader.setInt(), value == [].";
            else if (value.length === 1) {
                if (!cache || this._state.value[name] !== value[0]) {
                    gl.uniform1i(uniform, value[0]);
                    this._state.value[name] = value[0];
                }
            }
            else if (value.length === 2) {
                if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 2)) {
                    gl.uniform2iv(uniform, value);
                    if (cache) {
                        this._state.value[name] = Array.from(value);
                    }
                }
            }
            else if (value.length === 3) {
                if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 3)) {
                    gl.uniform3iv(uniform, value);
                    if (cache) {
                        this._state.value[name] = Array.from(value);
                    }
                }
            }
            else {
                if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 4)) {
                    gl.uniform4iv(uniform, value);
                    if (cache) {
                        this._state.value[name] = Array.from(value);
                    }
                }
            }
        }
        else {
            if (!cache || this._state.value[name] !== value) {
                gl.uniform1i(uniform, value);
                if (cache) {
                    this._state.value[name] = value;
                }
            }
        }
        return this;
    };

    /**
     * Set uniform with Int Array.
     * @param {number|string} uniform - uniform name or index
     * @param {[Int]} value - input Int Array
     * @param {number=1} size - size of each element, ie. 3 for vec3
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setIntArray = function (uniform, value, size) {
        var name = uniform,
            cache = false;
        if (!(uniform instanceof WebGLUniformLocation)) {
            uniform = this.getUniform(uniform);
            cache = true;
        }
        if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, value.length)) {
            gl['uniform' + (size ? size : 1) + 'iv'](uniform, value);
            if (cache) {
                this._state.value[name] = Array.from(value);
            }
        }
        return this;
    };

    /**
     * Set uniform value
     * @param {number | string} uniform
     * @param {boolean} value
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setBool = function (uniform, value) {
        var name = uniform,
            cache = false;
        if (!(uniform instanceof WebGLUniformLocation)) {
            uniform = this.getUniform(uniform);
            cache = true;
        }
        value = value ? 1 : 0;
        if (!cache || this._state.value[name] !== value) {
            gl.uniform1i(uniform, value);
            if (cache) {
                this._state.value[name] = value;
            }
        }
        return this;
    };

    /**
     * Set uniform matrix
     * @param {number | string} uniform
     * @param {number[]} value - Matrix
     * @param {boolean} transpose - Transpose mode
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setMatrix = function (uniform, value, transpose) {
        var name = uniform,
            cache = false;
        if (!(uniform instanceof WebGLUniformLocation)) {
            uniform = this.getUniform(uniform);
            cache = true;
        }
        transpose = !!transpose;
        if (value.length === 0)
            throw "Shader.setMatrix(), value == [].";
        else if (value.length === 4) {
            if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 4)) {
                gl.uniformMatrix2fv(uniform, transpose, value);
                if (cache) {
                    this._state.value[name] = Array.from(value);
                }
            }
        }
        else if (value.length === 9) {
            if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 9)) {
                gl.uniformMatrix3fv(uniform, transpose, value);
                if (cache) {
                    this._state.value[name] = Array.from(value);
                }
            }
        }
        else if (value.length === 16) {
            if (!cache || !Shader.arrayValueCheck(this._state.value[name], value, 16)) {
                gl.uniformMatrix4fv(uniform, transpose, value);
                if (cache) {
                    this._state.value[name] = Array.from(value);
                }
            }
        }
        else {
            throw "Shader.setMatrix(), invalid value.length = " + value.length + " .";
        }
        return this;
    };

    /**
     * Set uniform value
     * @param {number | string} uniform Can be string (name) or number (id).
     * @param {VG.Texture2D | VG.TextureCube | VG.RenderTarget} texture - Texture input
     * @param {number} slot - Which slot
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setTexture = function( uniform, texture, slot, textureSlot ) {
        if (!(uniform instanceof WebGLUniformLocation))
            uniform = this.getUniform(uniform);
        if (slot === undefined)
            slot = _state.WebGL.activeTexture;
        if (_state.WebGL.activeTexture !== slot) {
            gl.activeTexture(gl["TEXTURE" + slot]);
            _state.WebGL.activeTexture = slot;
        }
        if (texture instanceof VG.RenderTarget) {
            texture.bindAsTexture( textureSlot );
        } else {
            texture.bind();
        }
        gl.uniform1i(uniform, slot);
        return this;
    };

    /**
     * Set color RGBA.
     * @param {number|string} uniform - uniform index or name
     * @param {VG.Core.Color} value - Color
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setColor = function (uniform, value) {
        return this.setFloat(uniform, [value.r, value.g, value.b, value.a]);
    };

    /**
     * Set color RGB.
     * @param {number|string} uniform - uniform index or name
     * @param {VG.Core.Color} value - Color
     * @returns {VG.Shader}
     */

    VG.Shader.prototype.setColor3 = function (uniform, value) {
        return this.setFloat(uniform, [value.r, value.g, value.b]);
    };

    /**
     * Special array value check, used internally only.
     * True if b is prefix of a.
     * @param a Checked array
     * @param b Reference array
     * @param length
     * @returns {boolean}
     * @private
     */

    VG.Shader.arrayValueCheck = function (a, b, length) {
        // return false; // disabled, always return false.
        if (!a || !(a instanceof Array) || a.length < length)
            return false;
        for (var i = 0; i < length; i += 1)
            if (a[i] !== b[i])
                return false;
        return true;
    };

    /**
     * Shader Blend mode.
     * @static
     * @readonly
     * @enum {number}
     */

    VG.Shader.Blend = {
        /**
         * No blending.
         */
        None: 0,
        /**
         * Multiply alpha on both source and destination.
         */
        Alpha: 1,
        /**
         * Use alpha on source, one for destination.
         */
        Brush: 2,
        /**
         * Suitable for transparency.
         */
        OneAlpha: 3,
        /**
         * Use alpha on source, zero for destination.
         */
        ReverseBrush: 4,
        /**
         * Simply add source and destination.
         */
        Additive: 5,
        /**
         * Add source and destination but alpha.
         */
        AdditiveIgnoreAlpha: 6,
        /**
         * Ignore back. Back will become dark at places with no source.
         */
        RemoveBack: 7
    };

    /**
     * @static
     * @readonly
     * @enum {number}
     */

    VG.Shader.BlendEquation = {
        Add: 0, Subtract: 1, ReverseSubtract: 2,
        /**
         * Min, requires extension minmax
         */
        Min: 3,
        /**
         * Max, requires extension minmax
         */
        Max: 4,
        AddReverseSubtract: 5
    };

    VG.QuadShader = QuadShader = class extends VG.Shader
    {
        constructor( fSource, { forceWebGL2 = false } = {} )
        {
            super();

            if ( fSource )
                this.applyShader( fSource, { forceWebGL2 } );

            this.bufferSize = 18;

            this.buffer = new VG.GPUBuffer( VG.Type.Float, this.bufferSize, true );
            this.bufferDB = this.buffer.getDataBuffer();
            this.buffer.create();
        }

        createFrame(x, y, w, h, b)
        {
            var vw = w;
            var vh = h;

            var x1 = (x - vw / 2) / (vw / 2);
            var y1 = (vh / 2 - y) / (vh / 2);
            var x2 = ((x + w) - vw / 2) / (vw / 2);
            var y2 = (vh / 2 - (y + h)) / (vh / 2);

            var i = 0;
            var db=b.getDataBuffer();

            db.set(i++, x1); db.set(i++, y1); db.set(i++, 0.0); db.set(i++, 1.0);
            db.set(i++, x1); db.set(i++, y2); db.set(i++, 0.0); db.set(i++, 0.0);
            db.set(i++, x2); db.set(i++, y1); db.set(i++, 1.0); db.set(i++, 1.0);
            db.set(i++, x2); db.set(i++, y2); db.set(i++, 1.0); db.set(i++, 0.0);

            b.update();

            return b;
        }

        applyShader( fSource, { forceWebGL2 = false, flipY = true } = {} )
        {
            this.destroy();
            this.webgl2 = VG.webgl2 || forceWebGL2;

            this.vSource = !VG.webgl2 && !forceWebGL2 ? `#version 100
                precision mediump float;
                attribute vec4 aPosition;
                attribute vec2 aTexCoord;
                varying vec2 texCoord;

                void main() {
                    texCoord = vec2(aTexCoord.x, ${flipY ? "1.0-" : ""} aTexCoord.y);
                    gl_Position = aPosition;
                }`
            : `#version 300 es
                precision highp float;
                in vec4 aPosition;
                in vec2 aTexCoord;
                out vec2 texCoord;

                void main() {
                    texCoord = vec2(aTexCoord.x, ${flipY ? "1.0-" : ""} aTexCoord.y);
                    gl_Position = aPosition;
                }`;

            let header = !VG.webgl2 && !forceWebGL2 ? `#version 100
                #extension GL_OES_standard_derivatives : enable
                precision mediump float;
                varying vec2 texCoord;
                uniform vec2 inResolution;
            ` : `#version 300 es
                precision mediump float;

                out vec4 fragColor;
                in vec2 texCoord;

                uniform vec2 inResolution;
            `;

            this.headerOffset = header.split(/\r\n|\r|\n/).length;
            this.fSource = header + (this.webgl2 ? fSource : fSource.replace( /fragColor/g, "gl_FragColor" ));
            if ( !this.webgl2 ) this.fSource = this.fSource.replace( /texture/g, "texture2D" );
            this.create();

            this.aPosition = this.getAttrib("aPosition");
            this.aTexCoord = this.getAttrib("aTexCoord");
        }

        run( rt, rect, { setUniforms, blendType = VG.Shader.Blend.Alpha } = {} )
        {
            rt.bind();
            rt.setViewportEx( 0, 0, rt.width, rt.height );

            let b = this.buffer;
            let stride = b.getStride();

            this.blendType = blendType;
            this.blendEquation = VG.Shader.BlendEquation.Add;

            this.bind();
            if ( setUniforms ) setUniforms( this );
            b.bind();

            b.vertexAttrib( this.aPosition, 2, false, stride * 4, 0);
            b.vertexAttrib( this.aTexCoord, 2, false, stride * 4, stride * 2);

            this.setFloat( "inResolution", [ rt.width, rt.height ] );

            this.createFrame( 0, 0, rt.width, rt.height, b );

            b.drawBuffer( VG.Renderer.Primitive.TriangleStrip, 0,  4 );
            rt.unbind();
        }
    };

    /**
     * 2D Texture
     * @param images {VG.Core.Image[]} Array of image input
     * @param cube {boolean} Is cube texture
     * @constructor
     */

    VG.Texture = Texture = function (images, cube) {
        /**
         * Texture configuration
         * @type {{mipmaps: boolean, filtering: number, wrapU: number, wrapV: number}}
         * @private
         */
        this._config = {
            mipmaps: false,
            filtering: Texture.Filter.None,
            wrapU: Texture.Wrap.Clamp,
            wrapV: Texture.Wrap.Clamp
        };
        this.id = 0;
        this.images = images;
        var image = images[0];
        this.initialRealWidth = image.getRealWidth();
        this.initialRealHeight = image.getRealHeight();
        this.initialWidth = image.getWidth();
        this.initialHeight = image.getHeight();
        this.target = cube ? gl.TEXTURE_CUBE_MAP : gl.TEXTURE_2D;
        VG.Renderer().addResource(this);
    };

    /**
     * Get the real width of the image (power of two).
     * @returns {number}
     */

    VG.Texture.prototype.getRealWidth = function () {
        return this.initialRealWidth;
    };

    /**
     * Get the real height of the image (power of two).
     * @returns {number}
     */

    VG.Texture.prototype.getRealHeight = function () {
        return this.initialRealHeight;
    };

    /**
     * Get the user specified width of the Image.
     * @returns {number}
     */

    VG.Texture.prototype.getWidth = function () {
        return this.initialWidth;
    };

    /**
     * Get the user specified height of the Image.
     * @returns {number}
     */

    VG.Texture.prototype.getHeight = function () {
        return this.initialHeight;
    };

    /**
     * Bind the texture.
     * @returns {VG.Texture} - this
     */

    VG.Texture.prototype.bind = function () {
        if (this.target === gl.TEXTURE_2D && this.images[0].needsUpdate) {
            this.images[0].needsUpdate = false;
            this.update();
        }
        // if (_state.WebGL.texture[_state.WebGL.activeTexture][this.target] !== this.id) {
        gl.bindTexture(this.target, this.id);
        //     _state.WebGL.texture[_state.WebGL.activeTexture][this.target] = this.id;
        // }
        return this;
    };

    /**
     * Create texture on GPU.
     * @returns {VG.Texture} - this
     * @private
     */

    VG.Texture.prototype.create = function () {
        this.images[0].needsUpdate = false;
        this.id = gl.createTexture(this.target);
        this.bind();
        if (this._config.mipmaps) {
            gl.generateMipmap(this.target);
        }
        var minFilter = this._config.mipmaps ? gl.NEAREST_MIPMAP_NEAREST : VG.WebGL.minFilter;
        var magFilter = VG.WebGL.magFilter;
        var wrapS = this._config.wrapU == Texture.Wrap.Clamp ? gl.CLAMP_TO_EDGE : gl.REPEAT;
        var wrapT = this._config.wrapV == Texture.Wrap.Clamp ? gl.CLAMP_TO_EDGE : gl.REPEAT;
        switch (this._config.filtering) {
            case Texture.Filter.Bilinear:
                minFilter = this._config.mipmaps ? gl.LINEAR_MIPMAP_NEAREST : gl.LINEAR;
                magFilter = gl.LINEAR;
                break;
            case Texture.Filter.Anisotropic:
                // todo: test it
                var ext = gl.getExtension("MOZ_EXT_texture_filter_anisotropic") ||
                    gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                gl.texParameterf(this.target, ext.TEXTURE_MAX_ANISOTROPY_EXT, 4);
                break;
            case Texture.Filter.Trilinear:
                minFilter = this._config.mipmaps ? gl.LINEAR_MIPMAP_LINEAR : gl.LINEAR;
                magFilter = gl.LINEAR;
                break;
        }

        let image = this.images[0];

        if ( image.linearInterpolation ) {
            minFilter = gl.LINEAR;
            magFilter = gl.LINEAR;

            wrapS = gl.REPEAT;
            wrapT = gl.REPEAT;
        }

        gl.texParameteri(this.target, gl.TEXTURE_MIN_FILTER, minFilter);
        gl.texParameteri(this.target, gl.TEXTURE_MAG_FILTER, magFilter);
        gl.texParameteri(this.target, gl.TEXTURE_WRAP_S, wrapS);
        gl.texParameteri(this.target, gl.TEXTURE_WRAP_T, wrapT);

        this.initialRealWidth = image.getRealWidth();
        this.initialRealHeight = image.getRealHeight();
        this.initialWidth = image.getWidth();
        this.initialHeight = image.getHeight();
        var w = image.getRealWidth();
        var h = image.getRealHeight();
        if (this.target == gl.TEXTURE_CUBE_MAP) {
            var faceOrder = [
                gl.TEXTURE_CUBE_MAP_POSITIVE_X,
                gl.TEXTURE_CUBE_MAP_NEGATIVE_X,
                gl.TEXTURE_CUBE_MAP_POSITIVE_Y,
                gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,
                gl.TEXTURE_CUBE_MAP_POSITIVE_Z,
                gl.TEXTURE_CUBE_MAP_NEGATIVE_Z
            ];

            if (this.images.length != 6) throw "unexpected number of faces";

            for (var i = 0; i < this.images.length; i++) {
                gl.texImage2D(faceOrder[i], 0, gl.RGBA, w, h, 0, gl.RGBA, gl.UNSIGNED_BYTE, this.images[i].data);
            }

        } else {

            if ( image.canvas )
                gl.texImage2D( this.target, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image.data );
            else
            if (image.type === VG.Core.TypedArray.Type.Uint8)
                gl.texImage2D(this.target, 0, gl.RGBA, w, h, 0, gl.RGBA, gl.UNSIGNED_BYTE, image.data);
            else if (image.type === VG.Core.TypedArray.Type.Float) {
                if (image.elements === 4)
                    gl.texImage2D(this.target, 0, VG.webgl2 ? gl.RGBA32F : gl.RGBA, w, h, 0, gl.RGBA, gl.FLOAT, image.data);
                else if (image.elements === 1)
                    gl.texImage2D(this.target, 0, VG.webgl2 ? gl.R32F : gl.ALPHA, w, h, 0, VG.webgl2 ? gl.RED : gl.ALPHA, gl.FLOAT, image.data);
            }
        }
        return this;
    };

    /**
     * Udates the image pixel data from the internal image, cube textures are not supported
     *  @param {number} [x=0] - The X offset
     *  @param {number} [y=0] - The y offset
     *  @param {number} [w=-1] - The width, defaults to full width or -1
     *  @param {number} [h=-1] - The height, default to full height or -1
     * @returns {VG.Texture}
     */

    VG.Texture.prototype.update = function (x, y, w, h) {
        var image = this.images[0];

        var imW = image.realWidth;
        var imH = image.realHeight;
        //if the dimension has changed, recreate the texture from scratch
        if (imW != this.initialRealWidth || imH != this.initialRealHeight) {
            this.destroy();
            this.create();
            return this;
        }

        if (!x)
            x = 0;
        if (!y)
            y = 0;
        if (!w)
            w = imW;
        if (!h)
            h = imH;
        gl.bindTexture(this.target, this.id);


        if (image.type === VG.Core.TypedArray.Type.Uint8)
            gl.texSubImage2D(this.target, 0, x, y, w, h, gl.RGBA, gl.UNSIGNED_BYTE, image.data);
        else if (image.type === VG.Core.TypedArray.Type.Float) {
            if (image.elements === 4)
                gl.texSubImage2D(this.target, 0, x, y, w, h, VG.webgl2 ? gl.RGBA32F : gl.RGBA, gl.FLOAT, image.data);
            else if (image.elements === 1)
                gl.texSubImage2D(this.target, 0, x, y, w, h, VG.webgl2 ? gl.RED : gl.ALPHA, gl.FLOAT, image.data);
        }

        return this;
    };

    VG.Texture.prototype.identifyTexture = function () {
        /* Identify if this is a texture class.
         * Used by VG.Renderer() to identify if this class is a VG.Texture as instanceof does not work for this on non-web implementations.
         */
    };

    /**
     * Remove GPU resources.
     * @returns {VG.Texture}
     * @private
     */

    VG.Texture.prototype.destroy = function () {
        if (this.id === 0)
            return this;
        gl.deleteTexture(this.id);
        this.id = 0;
        return this;
    };

    /**
     * Dispose this object.
     * Dispose GPU resource and also link from VG.Renderer().
     */

    VG.Texture.prototype.dispose = function () {
        this.destroy();
        VG.Renderer().removeResource(this);
    };

    /**
     * Wrap mode.
     * @static
     * @enum {number}
     * @readonly
     */

    VG.Texture.Wrap = {
        /**
         * Clamp texture at edge.
         */
        Clamp: 0,
        /**
         * Repeat texture on u and v.
         */
        Repeat: 1
    };

    /**
     * Texture filtering mode.
     * @static
     * @enum {number}
     * @readonly
     */

    VG.Texture.Filter = {
        /**
         * No filtering, default to nearest neighbor.
         */
        None: 0,
        /**
         * Linear filtering, interpolate two nearest neighbor.
         */
        Linear: 1,
        /**
         * Bilinear filtering, Linear + interpolate on distance axis, so it's four neighbor.
         */
        Bilinear: 2,
        /**
         * Correct Bilinear on boundaries where mipmap level change.
         */
        Trilinear: 3,
        /**
         * Correct isotropic filtering when the surface viewed from angled direction.
         * The sampling not necessarrily square.
         */
        Anisotropic: 4
    };

    /**
     * Encapsulates an off-screen VBO.
     *
     * @param width {number} Width of <tt>Rendertarget</tt>.
     * @param height {number} Height of <tt>RT</tt>.
     * @param isMain {boolean} Is this main <tt>RT</tt>.
     * @param amount {amount} Amount of textures to allocate. WebGL2 only. <tt>RT</tt>.
     * @constructor
     */

    VG.RenderTarget = RenderTarget = function (width, height, isMain, amount) {
        this.id = 0;
        this.renderbufferId = 0;
        this.autoResize = false;
        this.width = 16;
        this.height = 16;
        this.supportsStencil = false;
        this.isMain = false;
        this.textureId = 0;

        if (width) this.width = width;
        if (height) this.height = height;

        this.floatTexture = false;

        this.isMain = (isMain && true) || false;
        if (isMain) this.autoResize = true;

        this.amount = amount ? amount : 1;
        this.scissorRect = VG.Core.Rect();
        VG.Renderer().addResource(this);
    };

    /**
     * Create this <tt>RT</tt> in GPU with its texture and renderbuffer attachment.
     * @returns {VG.RenderTarget}
     */

    VG.RenderTarget.prototype.create = function () {
        if (this.isMain)
            return this;
        if (this.id !== 0) {
            throw "RenderTarget().create(), already created().";
        }
        this.id = gl.createFramebuffer();
        gl.bindFramebuffer(gl.FRAMEBUFFER, this.id);

        this.textures = [];

        for ( let i = 0; i < this.amount; ++i ) {
            let texId = gl.createTexture( gl.TEXTURE_2D );

            if ( !i ) this.textureId = texId;
            this.textures[i] = texId;

            gl.bindTexture(gl.TEXTURE_2D, texId);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

            if ( this.floatTexture && VG.WebGL.supportsFloatTextures )
                gl.texImage2D(gl.TEXTURE_2D, 0, VG.webgl2 ? gl.RGBA32F : gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.FLOAT, null);
            else
                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);
        }

        this.renderbufferId = gl.createRenderbuffer();
        gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderbufferId);

        //set the depth buffer, standard 16bit for better portability
        if (!this.supportsStencil) {
            gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, this.width, this.height);
        } else {
            gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, this.width, this.height);
        }

        //attach the texture(s)
        for ( let i = 0; i < this.amount; ++i ) {
            let texId = this.textures[i];
            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl["COLOR_ATTACHMENT" + String( i )], gl.TEXTURE_2D, texId, 0);
        }

        if (!this.supportsStencil) gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this.renderbufferId);
        else gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, this.renderbufferId);

        if ( this.amount === 2 ) {
            gl.drawBuffers([
                gl.COLOR_ATTACHMENT0,
                gl.COLOR_ATTACHMENT1
            ]);
        } else
        if ( this.amount === 3 ) {
            gl.drawBuffers([
                gl.COLOR_ATTACHMENT0,
                gl.COLOR_ATTACHMENT1,
                gl.COLOR_ATTACHMENT2
            ]);
        } else
        if ( this.amount === 4 ) {
            gl.drawBuffers([
                gl.COLOR_ATTACHMENT0,
                gl.COLOR_ATTACHMENT1,
                gl.COLOR_ATTACHMENT2,
                gl.COLOR_ATTACHMENT3
            ]);
        } else
        if ( this.amount === 5 ) {
            gl.drawBuffers([
                gl.COLOR_ATTACHMENT0,
                gl.COLOR_ATTACHMENT1,
                gl.COLOR_ATTACHMENT2,
                gl.COLOR_ATTACHMENT3,
                gl.COLOR_ATTACHMENT4
            ]);
        } else
        if ( this.amount === 6 ) {
            gl.drawBuffers([
                gl.COLOR_ATTACHMENT0,
                gl.COLOR_ATTACHMENT1,
                gl.COLOR_ATTACHMENT2,
                gl.COLOR_ATTACHMENT3,
                gl.COLOR_ATTACHMENT4,
                gl.COLOR_ATTACHMENT5
            ]);
        }

        //revert to previous
        gl.bindRenderbuffer(gl.RENDERBUFFER, null);
        gl.bindTexture(gl.TEXTURE_2D, _state.WebGL.texture[_state.WebGL.activeTexture][gl.TEXTURE_2D] || null);
        gl.bindFramebuffer(gl.FRAMEBUFFER, null);
        return this;
    };

    /**
     * Get the real width of the image (power of two).
     * @returns {number}
     */

    VG.RenderTarget.prototype.getRealWidth = function () {
        return this.width;
    };

    /**
     * Get the real height of the image (power of two).
     * @returns {number}
     */

    VG.RenderTarget.prototype.getRealHeight = function () {
        return this.height;
    };

    /**
     * Get the user specified width of the Image.
     * @returns {number}
     */

    VG.RenderTarget.prototype.getWidth = function () {
        return this.imageWidth ? this.imageWidth : this.width;
    };

    /**
     * Get the user specified height of the Image.
     * @returns {number}
     */

    VG.RenderTarget.prototype.getHeight = function () {
        return this.imageHeight ? this.imageHeight : this.height;
    };

    /**
     * Release the frame buffer from GPU.
     * @returns {VG.RenderTarget}
     */

    VG.RenderTarget.prototype.destroy = function () {
        if (this.id === 0) return;

        gl.deleteFramebuffer(this.id);
        gl.deleteRenderbuffer(this.rbid);

        for ( let i = 0; i < this.textures.length; ++i ) {
            gl.deleteTexture( this.textures[i] );
        }

        this.textures = undefined;

        this.id = 0;
        this.renderbufferId = 0;
        this.textureId = 0;
        return this;
    };

    /**
     * Dispose the RT.
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.dispose = function () {
        this.destroy();
        VG.Renderer().removeResource(this);
        return this;
    };

    /**
     * Unbinds the frame buffer, in this case the main frame buffer will be
     * used for rendering
     * @returns {VG.RenderTarget} - this;
     */

    VG.RenderTarget.prototype.unbind = function () {
        gl.bindFramebuffer(gl.FRAMEBUFFER, null);
        return this;
    };

    /**
     * Binds the frame buffer, unbind must be called after drawing to ensure
     * flush into the main frame buffer
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.bind = function () {
        if (this.isMain) {
            //force unbind if any
            this.unbind();
        } else {
            gl.bindFramebuffer(gl.FRAMEBUFFER, this.id);
        }
        return this;
    };

    /**
     * Fills the given typed array with raw pixel data from the render target. The rect parameter can be either null / undefined if the whole rendertarget
     * data should be copied or a VG.Core.Rect structure if only a certain rectangle is required.
     * @param {VG.Core.rect} rect - An VG.Core.Rect object defining the pixel data to acquire or undefined if the whole pixel data should be copied.
     * @param {Uint8Array} typedArray - A typed Uint8Array big enough to hold the pixel data to copy. The whole pixel data of the render target would have the size of getWidth() * getHeight() * 4.
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.fillPixelBuffer = function (rect, typedArray) {

        var x = 0, y = 0, width = this.getWidth(), height = this.getHeight();
        if (rect) {
            x = rect.x;
            y = rect.y;
            width = rect.width;
            height = rect.height;
        }

        if ( this.floatTexture && VG.WebGL.supportsFloatTextures )
            gl.readPixels(x, this.getRealHeight() - (y + height), width, height, gl.RGBA, gl.FLOAT, typedArray);
        else
            gl.readPixels(x, this.getRealHeight() - (y + height), width, height, gl.RGBA, gl.UNSIGNED_BYTE, typedArray);

        return this;
    };

    /**
     * Binds this frame buffer as a texture
     * @returns {VG.RenderTarget}
     */

    VG.RenderTarget.prototype.bindAsTexture = function ( slot = 0 ) {
        if (this.isMain) throw "You can't bind a main frame buffer as texture";

        if ( !slot ) gl.bindTexture(gl.TEXTURE_2D, this.textureId);
        else gl.bindTexture(gl.TEXTURE_2D, this.textures[1] );

        return this;
    };

    /**
     * Resize the frame buffer, it must not be bind-ed as this recreates
     * the internal data.
     * @param {number} width - Width
     * @param {number} height - Height
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.resize = function (width, height) {
        this.destroy();

        this.width = width;
        this.height = height;

        this.create();
        return this;
    };

    /**
     * Reset the frame buffer
     * @param {number} width - Width
     * @param {number} height - Height
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.resetSize = function (width, height) {
        var recreate = !this.id || this.width != width || this.height != height;
        if (recreate)
            this.resize(width, height);
        else {
            this.bind();
            this.clear();
            this.unbind();
        }
        return this;
    };

    /**
     * Sets the drawing viewport for the next draw call and on
     * @param {VG.Core.Rect} rect - Rectangle to be used.
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.setViewport = function (rect) {
        gl.viewport(rect.x, this.height - rect.bottom(), rect.width, rect.height);
        return this;
    };

    /**
     * Sets the drawing viewport for the next draw call and on
     * @param {number} x - The x value
     * @param {number} y - The y value
     * @param {number} width - Width
     * @param {number} height - Height
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.setViewportEx = function (x, y, width, height) {
        gl.viewport(x, this.height - (y + height), width, height);
        return this;
    };

    /**
     * Scissor the next draw operation with <tt>rect</tt>.
     * @param rect {VG.Core.Rect} Bounding rectangle.
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.setScissor = function (rect) {
        if (rect && rect.width > 0 && rect.height > 0) {
            if (_state.WebGL.enabled[gl.SCISSOR_TEST] !== true) {
                gl.enable(gl.SCISSOR_TEST);
                _state.WebGL.enabled[gl.SCISSOR_TEST] = true;
            }
            this.scissorRect.copy(rect);
            gl.scissor(rect.x, this.height - rect.bottom(), rect.width, rect.height);
        }
        else {
            if (_state.WebGL.enabled[gl.SCISSOR_TEST] !== false) {
                gl.disable(gl.SCISSOR_TEST);
                _state.WebGL.enabled[gl.SCISSOR_TEST] = false;
                this.scissorRect.clear();
            }
        }
        return this;
    };

    /**
     * Clear frame buffer.
     * @param {VG.Core.Color} color - Clear color
     * @param {number} [depth=undefined] - If defined, clear depth buffer with this value.
     * @returns {VG.RenderTarget} - this
     */

    VG.RenderTarget.prototype.clear = function (color, depth) {
        var clearBits = 0;
        if (color) {
            if (color instanceof VG.Core.Color)
                gl.clearColor(color.r, color.g, color.b, color.a);
            clearBits |= gl.COLOR_BUFFER_BIT;
        }
        if (depth !== undefined && depth !== false) {
            if (depth)
                gl.clearDepth(depth);
            clearBits |= gl.DEPTH_BUFFER_BIT;
        }
        if ( clearBits )
            gl.clear(clearBits);
        return this;
    };

    /**
     * Check RT complete status.
     * @returns {boolean}
     */

    VG.RenderTarget.prototype.checkStatusComplete = function () {
        return gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE;
    };

    /**
     * Set stencil for the next draw operation.
     * @param mode {VG.RenderTarget.StencilMode} Stencil mode to activate.
     * @returns {VG.RenderTarget}
     */

    VG.RenderTarget.prototype.setStencilMode = function (mode) {
        if (!this.supportsStencil)
            return this;
        if (mode === _state.WebGL.stencilMode)
            return this;
        if (mode === RenderTarget.StencilMode.None) {
            if (_state.WebGL.enabled[gl.STENCIL_TEST] !== false) {
                gl.disable(gl.STENCIL_TEST);
                _state.WebGL.enabled[gl.STENCIL_TEST] = false;
            }
        }
        else if (mode === RenderTarget.StencilMode.FillKeepOne || mode === RenderTarget.StencilMode.DrawKeepOne || mode === RenderTarget.StencilMode.DrawInverse) {
            if (_state.WebGL.enabled[gl.STENCIL_TEST] !== true) {
                gl.enable(gl.STENCIL_TEST);
                _state.WebGL.enabled[gl.STENCIL_TEST] = true;
            }
            if (mode === RenderTarget.StencilMode.FillKeepOne) {
                gl.stencilFunc(gl.ALWAYS, 1, 0xFF); // Set any stencil to 1
                gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);
                gl.stencilMask(0xFF);
                gl.colorMask(false, false, false, false);
                gl.clear(gl.STENCIL_BUFFER_BIT);
            }
            else if (mode === RenderTarget.StencilMode.DrawKeepOne) {
                gl.colorMask(true, true, true, true);
                gl.stencilFunc(gl.EQUAL, 1, 0xFF); // Pass test if stencil value is 1
                gl.stencilMask(0x00);
            }
            else {
                gl.colorMask(true, true, true, true);
                gl.stencilFunc(gl.EQUAL, 0, 0xFF); // Pass test if stencil value is 0
                gl.stencilMask(0x00);
            }
            _state.WebGL.stencilMode = mode;
        }
        return this;
    };

    /**
     * Stencil mode applicable to RT.
     * @static
     * @enum {number}
     * @readonly
     */

    VG.RenderTarget.StencilMode = {
        /**
         * Disable stencil
         */
        None: 0,
        /**
         * Set any stencil to 1.
         */
        FillKeepOne: 1,
        /**
         * Pass if 1.
         */
        DrawKeepOne: 2,
        /**
         * Pass if 0.
         */
        DrawInverse: 3
    };
})(VG || (VG = {}));

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.sendHost = function( name, param )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( name, param );
};

// Web specific Implementations

VG.downloadRequest=function( url, parameters, method )
{
    VG.context.workspace._downloadIP=true;

	var serverUrl="https://viralgraphics.io";

    method=method || "POST";

    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", serverUrl + url);

    for(var key in parameters) {
        if(parameters.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", parameters[key]);

            form.appendChild(hiddenField);
         }
    }

    var button = document.createElement('input');
    button.setAttribute('type', 'submit');
    form.appendChild(button);

    document.body.appendChild(form);

    form.submit();
};

VG.sendBackendRequest=function( url, parameters, callback, type, error_callback )
{
    var request = new VG.ajaxRequest();

    request.withCredentials = true;

    request.onreadystatechange = function() {

        if (request.readyState == 4) {
            if ( request.status == 200 || window.location.href.indexOf("http") ==-1 ) {
                //VG.log( parameters, request.responseText );

                if ( callback ) callback.call( this, request.responseText );
            } else {
                if (callback && !error_callback) callback.call( this, request.responseText );
                if (error_callback) {
                    error_callback(request.responseText);
            }
            }
        }
    };

    var serverUrl="";

    if ( VG.localVGLibPrefix !== undefined ) serverUrl="https://viralgraphics.io";
    var requestType="POST";

    if ( type ) requestType=type;

    request.open( requestType, serverUrl + url, true );
    request.setRequestHeader( "Content-type", "application/json;charset=UTF-8" );
    request.send( parameters );
};

VG.ajaxRequest=function()
{
    var activexmodes=["Msxml2.XMLHTTP", "Microsoft.XMLHTTP"];

    if ( window.ActiveXObject ) {
        // --- IE
        for (var i=0; i<activexmodes.length; i++) {
            try {
                return new ActiveXObject(activexmodes[i]);
            }

            catch(e) {
                //suppress error
            }
        }
    } else
    {
        if (window.XMLHttpRequest) // --- Mozilla, Safari etc
            return new XMLHttpRequest();
        else return false;
    }
};

VG.setMouseCursorByID=function( id, cursorStyle )
{
    var elem;
    if (document.getElementById && (elem=document.getElementById(id)) ) {
        if (elem.style) elem.style.cursor=cursorStyle;
    }
};

/**
 * Sets the mouse cursor.
 * @param {string} cursor - The name of the CSS value of the mouse cursor, like "default". For a list of possible values see https://developer.mozilla.org/en/docs/Web/CSS/cursor.
 */

VG.setMouseCursor=function( cursor )
{
    VG.setMouseCursorByID( "webgl", cursor );
    VG.activeMouseCursor = cursor;
};

VG.getHostProperty=function( property )
{
    switch ( property )
    {
        case VG.HostProperty.Platform :
            return VG.HostProperty.PlatformWeb;

        case VG.HostProperty.OperatingSystem :
        {
            var OS = "Unknown";
            if (window.navigator.userAgent.indexOf("Windows NT 6.2") != -1) OS=VG.HostProperty.OSWindows;
            if (window.navigator.userAgent.indexOf("Windows NT 6.1") != -1) OS=VG.HostProperty.OSWindows;
            if (window.navigator.userAgent.indexOf("Windows NT 6.0") != -1) OS=VG.HostProperty.OSWindows;
            if (window.navigator.userAgent.indexOf("Windows NT 5.1") != -1) OS=VG.HostProperty.OSWindows;
            if (window.navigator.userAgent.indexOf("Windows NT 5.0") != -1) OS=VG.HostProperty.OSWindows;
            if (window.navigator.userAgent.indexOf("Mac")!=-1) OS=VG.HostProperty.OSMac;
            if (window.navigator.userAgent.indexOf("X11")!=-1) OS=VG.HostProperty.OSUnix;
            if (window.navigator.userAgent.indexOf("Linux")!=-1) OS=VG.HostProperty.OSLinux;

            return OS;
        }
        break;

        case VG.HostProperty.DrawMenus :
            return true;
    }
};

VG.setHostProperty=function( property, value )
{

};

VG.remoteOpenFile=function( fileName, callback )
{
    var parameters={};

    var string="/upload/" + VG.context.workspace.appId + "/" + fileName;
    VG.sendBackendRequest( string, JSON.stringify( parameters ), callback, "GET" );
};

VG.remoteSaveFile=function( fileName, data, callback )
{
    var parameters={};
    parameters[fileName]=data;

    var string="/upload/" + VG.context.workspace.appId;
    VG.sendBackendRequest( string, JSON.stringify( parameters ), callback, "POST" );
};

/**
 * Decompresses encoded image data.
 * @param {string} data - The Base64 encoded data to decompress
 * @param {VG.Core.Image} - The image object to decompress into, can be empty.
 * @param {callback} finishedCallback - Will be called upon completion with the image object as its main parameter.
 * @example
 *
 * VG.decompressImageData( imageData, VG.Core.Image(), function( image ) {
 *     VG.log( "Image decoded successfully." );
 * });
 */

VG.decompressImageData=function( data, image, finishedCallback, options )
{
    var im=new Image();
    image.locked=true;

    im.onload=function()
    {
        //image.data=null;
        image.imageData=data;

        var textureCanvas=document.getElementById( 'textureCanvas' );
        var ctx=textureCanvas.getContext('2d');

        ctx.canvas.width=im.width;
        ctx.canvas.height=im.height;

        var alwaysUseImage=false;
        if ( options && options.alwaysUseImage )
            alwaysUseImage=true;

        if ( !alwaysUseImage ) {
            if ( image.width !== im.width || image.height !== im.height )
                image.resize( im.width, im.height );
        }

        ctx.drawImage(im, 0, 0, im.width, im.height);

        var imageData=ctx.getImageData( 0, 0, im.width, im.height );
        var pixelData=imageData.data;

        for ( var h=0; h < image.height; ++h )
        {
            var offset=h * imageData.width * 4;
            var dOffset=h * image.modulo;

            for ( var w=0; w < image.width; ++w )
            {
                image.data[dOffset++]=pixelData[offset++];
                image.data[dOffset++]=pixelData[offset++];
                image.data[dOffset++]=pixelData[offset++];
                image.data[dOffset++]=pixelData[offset++];
            }
        }

        im=null;
        image.locked=false;
        image.needsUpdate=true;
        VG.update();

        if ( finishedCallback ) finishedCallback( image );
    };
    im.src=data;
};

/**
 * Compresses an image to .PNG or .JPEG.
 * @param {VG.Core.Image} - The image object to compress.
 * @param {string} format - The image format to compress into, can be "PNG" or "JPEG". "PNG" is default.
 * @example
 *
 * var imageData=VG.compressImage( image, "PNG" );
 *
 */

VG.compressImage=function( image, format, quality )
{
    var ctx=textureCanvas.getContext('2d');

    ctx.canvas.width=image.width;
    ctx.canvas.height=image.height;

    var id=ctx.getImageData( 0, 0, image.width, image.height );
    var pixelData=id.data;

    var h, w, offset, dOffset;
    if ( image.elements === 4 )
    {
        for ( h=0; h < image.height; ++h )
        {
            for ( w=0; w < image.width; ++w )
            {
                offset=h * image.width * 4 + w * 4;
                dOffset=h * image.modulo + w * 4;

                pixelData[offset]=image.data[dOffset];
                pixelData[offset+1]=image.data[dOffset+1];
                pixelData[offset+2]=image.data[dOffset+2];
                pixelData[offset+3]=image.data[dOffset+3];
            }
        }
    } else
    if ( image.elements === 1 )
    {
        for ( h=0; h < image.height; ++h )
        {
            for ( w=0; w < image.width; ++w )
            {
                offset=h * image.width * 4 + w * 4;
                dOffset=h * image.modulo + w;
                //im.setPixelRGBA( w, h, pixelData[offset], pixelData[offset+1], pixelData[offset+2], pixelData[offset+3] );

                var val=Math.floor( image.data[dOffset] );
                pixelData[offset]=val;
                pixelData[offset+1]=val;
                pixelData[offset+2]=val;
                pixelData[offset+3]=255;
            }
        }
    }

    ctx.putImageData( id, 0, 0 );

    if ( format && format === "JPEG" )
        return ctx.canvas.toDataURL( "image/jpeg", quality );
    else if ( format )
        return ctx.canvas.toDataURL( "image/" + format.toLowerCase(), quality );
    else return ctx.canvas.toDataURL( "image/png", quality );
};

VG.loadStyleImage=function( style, imageName, callback )
{
    let image = new Image();
    image.onload=function()
    {
        let im = VG.Core.Image( image.width, image.height );
        im.name = image.name;

        let textureCanvas=document.getElementById( 'textureCanvas' );
        let ctx = textureCanvas.getContext('2d');

        ctx.canvas.width=image.width;
        ctx.canvas.height=image.height;

        ctx.drawImage(image, 0, 0, image.width, image.height);
        let pixelData = ctx.getImageData( 0, 0, image.width, image.height ).data;

        for ( let h=0; h < image.height; ++h )
        {
            for ( let w=0; w < image.width; ++w )
            {
                let offset=h * image.width * 4 + w * 4;

                im.setPixelRGBA( w, h,
                    pixelData[offset],
                    pixelData[offset+1],
                    pixelData[offset+2],
                    pixelData[offset+3]
                );
            }
        }

        VG.context.imagePool.addImage( im );
        im.canvasImage = image;
        VG.update();

        if ( callback ) callback( im );
     };

    if ( VG.localVGLibPrefix ) image.src = VG.localVGLibPrefix + "vglib/ui/styles/" + style + "/icons/" + imageName;
    else image.src = "/vglib/ui/styles/" + style + "/icons/" + imageName;

    image.name = imageName;
    image.stylePath = style;
};

VG.copyToClipboard=function( type, data )
{
    if ( type === "Text" ) VG.context.workspace.textClipboard = data;
    else
    if ( type === "Image" ) VG.context.workspace.imageClipboard = data;
    else
    if ( type === "Nodes" ) VG.context.workspace.nodesClipboard = data;
    else
    VG.context.workspace.textClipboard = data;

    if ( VG.context.workspace.isElectron() )
    {
        const { clipboard, nativeImage } = require('electron');

        if ( type === "Image" ) {
            let imageData = VG.compressImage( data );
            let image = nativeImage.createFromDataURL( imageData );

            clipboard.writeImage( image );
        }
    }
};

VG.clipboardPasteDataForType=function( type )
{
    if ( type === "Text" ) return VG.context.workspace.textClipboard;
    else
    if ( type === "Image" ) return VG.context.workspace.imageClipboard;
    else
    if ( type === "Nodes" ) return VG.context.workspace.nodesClipboard;
    else
    return VG.context.workspace.textClipboard;
};

/**
 * Opens the given Url in a new browser tab.
 * @param {string} url - The url to open.
 *
 */

VG.gotoUrl=function( link )
{
    if ( !VG.context.workspace.isElectron() ) window.open( link );
    else {
        const {shell} = require('electron');
        shell.openExternal( link );
    }
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains all events supported by the Visual Graphics UI system.
 * @namespace
 */
VG.Events = {};

/**
 * Mouse buttons.
 * @enum
 */
VG.Events.MouseButton={ "Left" : 0, "Right" : 1, "Middle" : 2 };

/**
 * KeyCodes.
 * @enum
 */
VG.Events.KeyCodes={ "Backspace" : 8, "Tab" : 9, "Enter" : 13, "Shift" : 16, "Ctrl" : 17, "Alt" : 18, "Pause" : 19,
	"CapsLock" : 20, "Esc" : 27,  "Space" : 32, "PageUp" : 33, "PageDow" : 34, "End" : 35, "Home" : 36, "ArrowLeft" : 37, "ArrowUp" : 38,
	 "ArrowRight" : 39,  "ArrowDown" : 40,  "PrintScrn" : 44,  "Insert" : 45,  "Delete" : 46,
	 "Zero" : 48, "One" : 49, "Two" : 50, "Three" : 51, "Four" : 52, "Five" : 53, "Six" : 54, "Seven" : 55, "Eight" : 56, "Nine" : 57,
	 "A" : 65, "B" : 66, "C" : 67, "D" : 68, "E" : 69, "F" : 70, "G" : 71, "H" : 72, "I" : 73, "J" : 74,
	 "K" : 75, "L" : 76, "M" : 77, "N" : 78, "O" : 79, "P" : 80, "Q" : 81, "R" : 82, "S" : 83, "T" : 84,
	 "U" : 85, "V" : 86, "W" : 87, "X" : 88, "Y" : 89, "Z" : 90,
	 "AppleLeft" : 91, "AppleRight" : 93,
	 "F1" : 112, "F2" : 113, "F3" : 114, "F4" : 115, "F5" : 116, "F6" : 117, "F7" : 118, "F8" : 119, "F9" : 120, "F10" : 121,
	 "F11" : 122, "F12" : 123,
	 "NumLock" : 144, "ScrollLock" : 145,
	};

/**
 * Creates an MouseMoveEvent. Send to the focus Widget on user mouse move.
 * @constructor
 */

VG.Events.MouseMoveEvent=function()
{
    if (!(this instanceof VG.Events.MouseMoveEvent)) return new VG.Events.MouseMoveEvent();

    /** The current mouse position.
     * @member {VG.Core.Point}
     */

    this.pos=VG.Core.Point();
};

/**
 * Creates an MouseDownEvent. Send to the focus Widget on user initiated mouse button press.
 * @constructor
 */

VG.Events.MouseDownEvent=function( workspace )
{
    if (!(this instanceof VG.Events.MouseDownEvent)) return new VG.Events.MouseDownEvent( workspace );

    /** The current mouse position.
     * @member {VG.Core.Point}
     */
    this.pos=workspace.mousePos;

    /** The mouse button which has been pressed.
     * @member {VG.Events.MouseButton}
     */
    this.button=VG.Events.MouseButton.Left;

    /** An array containing all currently pressed keys.
     * @member {array}
     */
    this.keysDown=workspace.keysDown;
};

/**
 * Creates an MouseUpEvent. Send to the focus Widget on user initiated mouse button release.
 * @constructor
 */

VG.Events.MouseUpEvent=function( workspace )
{
    if (!(this instanceof VG.Events.MouseUpEvent)) return new VG.Events.MouseUpEvent( workspace );

    /** The current mouse position.
     * @member {VG.Core.Point}
     */
    this.pos=workspace.mousePos;

    /** The mouse button which has been pressed.
     * @member {VG.Events.MouseButton}
     */
    this.button=VG.Events.MouseButton.Left;

    /** An array containing all currently pressed keys.
     * @member {array}
     */
    this.keysDown=workspace.keysDown;
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.Shortcut = {};

VG.Shortcut.Item=function( key, modifier, modifierOptional )
{
    /** Represents a keyboard shortcut sequence
     **/

    if ( !(this instanceof VG.Shortcut.Item ) ) return new VG.Shortcut.Item( key, modifier, modifierOptional );

     this.key=key;
     this.modifier=modifier;
     this.modifierOptional=modifierOptional;

     this.createText();
};

VG.Shortcut.Item.prototype.createText=function()
{
    this.text="";

    if ( !this.key ) return;

    if ( this.modifierOptional === VG.Events.KeyCodes.Shift )
        this.text+="Shift+";

    if ( this.modifier === VG.Events.KeyCodes.AppleLeft )
        this.text+="Cmd";
    else
    if ( this.modifier === VG.Events.KeyCodes.Ctrl )
        this.text+="Ctrl";
    else
    if ( this.modifier === VG.Events.KeyCodes.Alt )
        this.text+="Alt";
    else
    if ( this.modifier === VG.Events.KeyCodes.Shift )
        this.text+="Shift";

    if ( this.text.length ) this.text+="+";
    this.text+=this.key;
};

VG.Shortcut.Manager=function()
{
    /** Manages key sequences mostly used in menu shortcuts. Creates default menu shortcuts for the underlying operating system (like New / Copy / Paste etc).
     **/

    if ( !(this instanceof VG.Shortcut.Manager ) ) return new VG.Shortcut.Manager();
};

VG.Shortcut.Defaults={ "Cut" : 0, "Copy" : 1, "Paste" : 2, "SelectAll" : 3, "InsertText" : 4, "InsertEncodedText" : 5, "Undo" : 6, "Redo" : 7, "Open" : 8, "SaveAs" : 9 };

VG.Shortcut.Manager.prototype.createDefault=function( def )
{
    var item=new VG.Shortcut.Item();

    switch( def )
    {
        case VG.Shortcut.Defaults.Open:
        {
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac && VG.context.workspace.platform === VG.HostProperty.PlatformDesktop ) {
                item.key="O";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
            }
        }
        break;

        case VG.Shortcut.Defaults.Save:
        {
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac && VG.context.workspace.platform === VG.HostProperty.PlatformDesktop ) {
                item.key="S";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
            }
        }
        break;

        case VG.Shortcut.Defaults.SaveAs:
        {
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac && VG.context.workspace.platform === VG.HostProperty.PlatformDesktop ) {
                item.key="S";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
                item.modifierOptional=VG.Events.KeyCodes.Shift;
            }
        }
        break;

        case VG.Shortcut.Defaults.Undo:
        {
            if ( VG.context.workspace.isElectron() ) return;
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac  ) {
                item.key="Z";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
            } else {
                item.key="Z";
                item.modifier=VG.Events.KeyCodes.Ctrl;
            }
        }
        break;

        case VG.Shortcut.Defaults.Redo:
        {
            if ( VG.context.workspace.isElectron() ) return;
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac ) {
                item.key="Z";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
                item.modifierOptional=VG.Events.KeyCodes.Shift;
            } else {
                item.key="Z";
                item.modifier=VG.Events.KeyCodes.Ctrl;
                item.modifierOptional=VG.Events.KeyCodes.Shift;
            }
        }
        break;

        case VG.Shortcut.Defaults.Cut:
        {
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac ) {
                item.key="X";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
            }
        }
        break;

        case VG.Shortcut.Defaults.Copy:
        {
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac ) {
                item.key="C";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
            }
        }
        break;

        case VG.Shortcut.Defaults.Paste:
        {
            if ( VG.context.workspace.operatingSystem === VG.HostProperty.OSMac ) {
                item.key="V";
                item.modifier=VG.Events.KeyCodes.AppleLeft;
            }
        }
        break;

        case VG.Shortcut.Defaults.SelectAll:
        {
            item.key="A";
            item.modifier=VG.Events.KeyCodes.Alt;
        }
        break;

        case VG.Shortcut.Defaults.InsertText:
        {
            item.key="I";
            item.modifier=VG.Events.KeyCodes.Alt;
        }
        break;

        case VG.Shortcut.Defaults.InsertEncodedText:
        {
            item.key="E";
            item.modifier=VG.Events.KeyCodes.Alt;
        }
        break;
    }

    item.createText();

    return item;
};

VG.Shortcut.Manager.prototype.verifyMenubar=function( text, keysDown, menubar )
{
    for( var m=0; m < menubar.items.length; ++m )
    {
        var menu=menubar.items[m];
        if ( this.verifyMenu( text, keysDown, menu ) ) return true;
    }

    return false;
};

VG.Shortcut.Manager.prototype.verifyToolBar=function( text, keysDown, toolbar )
{
    for( let m=0; m < toolbar.layout.children.length; ++m )
    {
        let object = toolbar.layout.children[m];

        // if ( object.shortcut )
            // console.log( text, keysDown, object.shortcut );

        if ( object && object.shortcut && this.verifyShortcut( text, keysDown, object.shortcut ) )
        {
            if ( !object.disabled ) object.clicked();
            return true;
        }
    }

    return false;
};

VG.Shortcut.Manager.prototype.verifyMenu=function( text, keysDown, menu )
{
    this.duplicateFromHost=false;

    for ( var mi=0; mi < menu.items.length; ++mi )
    {
        var menuItem=menu.items[mi];

        if ( menu.externalClickItem === menuItem )//&& ( Date.now() - menu.externalClickTime ) < 500 )
        {
            menu.externalClickItem=null;
            this.duplicateFromHost=true;
            return true;
        }

        if ( menuItem.shortcut && !menuItem.disabled )
        {
            if ( this.verifyShortcut( text, keysDown, menuItem.shortcut ) )
            {
                if ( menuItem.clicked ) menuItem.clicked();
                return true;
            }
        }
    }
    return false;
};

VG.Shortcut.Manager.prototype.verifyShortcut=function( text, keysDown, shortcut )
{
    if ( text.toUpperCase() === shortcut.key && !shortcut.modifier ) return true;

    if ( text.toUpperCase() === shortcut.key && keysDown.indexOf( shortcut.modifier ) !== -1 )
    {
        if ( !shortcut.modifierOptional || ( shortcut.modifierOptional && keysDown.indexOf( shortcut.modifierOptional ) !== -1 ) )
        {
            // --- If Shift is pressed and no optional modifier selected ignore this event
            if ( !shortcut.modifierOptional && keysDown.indexOf( VG.Events.KeyCodes.Shift ) !== -1 ) return false;

            return true;
        }
    }

    return false;
};
VG.FS = {};

VG.FS.readDir = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    let rc = ipc.sendSync( 'fs-readDir', { path: path } );
    return rc;
};

VG.FS.readFile = function( path, encoding = "utf8" )
{
    if ( !VG.context.workspace.isElectron() ) return;

    if ( encoding === "raw" ) encoding = undefined;

    const ipc = require('electron').ipcRenderer;
    let rc = ipc.sendSync( 'fs-readFile', { path: path, encoding: encoding } );
    return rc;
};

VG.FS.writeFile = function( path, data, encoding = "utf8" )
{
    if ( !VG.context.workspace.isElectron() ) return;

    if ( encoding === "raw" ) encoding = undefined;

    const ipc = require('electron').ipcRenderer;
    ipc.sendSync( 'fs-writeFile', { path: path, data: data, encoding: encoding } );
};

VG.FS.info = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-info', { path: path } );
};

VG.FS.exists = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-exists', { path: path } );
};

VG.FS.createDir = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-createDir', {path: path } );
};

VG.FS.createTempDir = function( prefix = "foo-" )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-createTempDir', {prefix: prefix } );
};

VG.FS.deleteFile = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-deleteFile', {path: path } );
};

VG.FS.deleteDir = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-deleteDir', {path: path } );
};

VG.FS.pathInfo = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-pathInfo', { path: path } );
};

VG.FS.joinPaths = function( ...args )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-joinPaths', { args: [...args] } );
};

VG.FS.absolutePath = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-absolutePath', { path: path } );
};

VG.FS.fileDialog = function( params, cb )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    ipc.send( 'fs-file-dialog', params );

    ipc.once( 'fs-file-dialog-result', ( event, files ) => {
        cb( files );
    } );
};

VG.FS.getSpecialPath = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-getspecialpath', { path: path } );
};

VG.FS.pathSeparator = function()
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-pathSeparator', {} );
};

VG.FS.relativePath = function( from, to )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-relativePath', { from: from, to: to } );
};

VG.FS.isAbsolutePath = function( path )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-isAbsolutePath', { path: path } );
};

VG.FS.rename = function( oldPath, newPath )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-rename', { old: oldPath, new: newPath } );
};

VG.FS.getMimeType = function( data )
{
    if ( !VG.context.workspace.isElectron() ) return;

    const ipc = require('electron').ipcRenderer;
    return ipc.sendSync( 'fs-getmimetype', { data: data } );
};

// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.3.4

// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4

// private property

VG.Utils = {

  keyStrBase64 : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
  keyStrUriSafe : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",
  baseReverseDic : {},

  getBaseValue : function(alphabet, character) {
    if (!VG.Utils.baseReverseDic[alphabet]) {
      VG.Utils.baseReverseDic[alphabet] = {};
      for (var i=0 ; i<alphabet.length ; i++) {
        VG.Utils.baseReverseDic[alphabet][alphabet.charAt(i)] = i;
      }
    }

    return VG.Utils.baseReverseDic[alphabet][character];
  },

  compressToBase64 : function (input) {
    if (input === null) return "";
    var res = VG.Utils._compress(input, 6, function(a){return VG.Utils.keyStrBase64.charAt(a);});
    switch (res.length % 4) { // To produce valid Base64
    default: // When could this happen ?
    case 0 : return res;
    case 1 : return res+"===";
    case 2 : return res+"==";
    case 3 : return res+"=";
    }
  },

  decompressFromBase64 : function (input) {
    if (input === null) return "";
    if (input === "") return null;
    return VG.Utils._decompress(input.length, 32, function(index) { return VG.Utils.getBaseValue(VG.Utils.keyStrBase64, input.charAt(index)); });
  },

  compressToUTF16 : function (input) {
    if (input === null) return "";
    return VG.Utils._compress(input, 15, function(a){return String.fromCharCode(a+32);}) + " ";
  },

  decompressFromUTF16: function (compressed) {
    if (compressed === null) return "";
    if (compressed === "") return null;
    return VG.Utils._decompress(compressed.length, 16384, function(index) { return compressed.charCodeAt(index) - 32; });
  },

  //compress into uint8array (UCS-2 big endian format)
  compressToUint8Array: function (uncompressed) {
    var compressed = VG.Utils.compress(uncompressed);
    var buf=new Uint8Array(compressed.length*2); // 2 bytes per character

    for (var i=0, TotalLen=compressed.length; i<TotalLen; i++) {
      var current_value = compressed.charCodeAt(i);
      buf[i*2] = current_value >>> 8;
      buf[i*2+1] = current_value % 256;
    }
    return buf;
  },

  //decompress from uint8array (UCS-2 big endian format)
  decompressFromUint8Array:function (compressed) {
    if (compressed===null || compressed===undefined){
        return VG.Utils.decompress(compressed);
    } else {
        var buf=new Array(compressed.length/2); // 2 bytes per character
        for (var i=0, TotalLen=buf.length; i<TotalLen; i++) {
          buf[i]=compressed[i*2]*256+compressed[i*2+1];
        }

        var result = [];
        buf.forEach(function (c) {
          result.push(String.fromCharCode(c));
        });
        return VG.Utils.decompress(result.join(''));

    }

  },


  //compress into a string that is already URI encoded
  compressToEncodedURIComponent: function (input) {
    if (input === null) return "";
    return VG.Utils._compress(input, 6, function(a){return VG.Utils.keyStrUriSafe.charAt(a);});
  },

  //decompress from an output of compressToEncodedURIComponent
  decompressFromEncodedURIComponent:function (input) {
    if (input === null) return "";
    if (input === "") return null;
    input = input.replace(/ /g, "+");
    return VG.Utils._decompress(input.length, 32, function(index) { return VG.Utils.getBaseValue(VG.Utils.keyStrUriSafe, input.charAt(index)); });
  },

  compress: function (uncompressed) {
    return VG.Utils._compress(uncompressed, 16, function(a){return String.fromCharCode(a);});
  },
  _compress: function (uncompressed, bitsPerChar, getCharFromInt) {
    if (uncompressed === null) return "";
    var i, value,
        context_dictionary= {},
        context_dictionaryToCreate= {},
        context_c="",
        context_wc="",
        context_w="",
        context_enlargeIn= 2, // Compensate for the first entry which should not count
        context_dictSize= 3,
        context_numBits= 2,
        context_data=[],
        context_data_val=0,
        context_data_position=0,
        ii;

    for (ii = 0; ii < uncompressed.length; ii += 1) {
      context_c = uncompressed.charAt(ii);
      if (!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)) {
        context_dictionary[context_c] = context_dictSize++;
        context_dictionaryToCreate[context_c] = true;
      }

      context_wc = context_w + context_c;
      if (Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)) {
        context_w = context_wc;
      } else {
        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {
          if (context_w.charCodeAt(0)<256) {
            for (i=0 ; i<context_numBits ; i++) {
              context_data_val = (context_data_val << 1);
              if (context_data_position == bitsPerChar-1) {
                context_data_position = 0;
                context_data.push(getCharFromInt(context_data_val));
                context_data_val = 0;
              } else {
                context_data_position++;
              }
            }
            value = context_w.charCodeAt(0);
            for (i=0 ; i<8 ; i++) {
              context_data_val = (context_data_val << 1) | (value&1);
              if (context_data_position == bitsPerChar-1) {
                context_data_position = 0;
                context_data.push(getCharFromInt(context_data_val));
                context_data_val = 0;
              } else {
                context_data_position++;
              }
              value = value >> 1;
            }
          } else {
            value = 1;
            for (i=0 ; i<context_numBits ; i++) {
              context_data_val = (context_data_val << 1) | value;
              if (context_data_position ==bitsPerChar-1) {
                context_data_position = 0;
                context_data.push(getCharFromInt(context_data_val));
                context_data_val = 0;
              } else {
                context_data_position++;
              }
              value = 0;
            }
            value = context_w.charCodeAt(0);
            for (i=0 ; i<16 ; i++) {
              context_data_val = (context_data_val << 1) | (value&1);
              if (context_data_position == bitsPerChar-1) {
                context_data_position = 0;
                context_data.push(getCharFromInt(context_data_val));
                context_data_val = 0;
              } else {
                context_data_position++;
              }
              value = value >> 1;
            }
          }
          context_enlargeIn--;
          if (context_enlargeIn === 0) {
            context_enlargeIn = Math.pow(2, context_numBits);
            context_numBits++;
          }
          delete context_dictionaryToCreate[context_w];
        } else {
          value = context_dictionary[context_w];
          for (i=0 ; i<context_numBits ; i++) {
            context_data_val = (context_data_val << 1) | (value&1);
            if (context_data_position == bitsPerChar-1) {
              context_data_position = 0;
              context_data.push(getCharFromInt(context_data_val));
              context_data_val = 0;
            } else {
              context_data_position++;
            }
            value = value >> 1;
          }


        }
        context_enlargeIn--;
        if (context_enlargeIn === 0) {
          context_enlargeIn = Math.pow(2, context_numBits);
          context_numBits++;
        }
        // Add wc to the dictionary.
        context_dictionary[context_wc] = context_dictSize++;
        context_w = String(context_c);
      }
    }

    // Output the code for w.
    if (context_w !== "") {
      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {
        if (context_w.charCodeAt(0)<256) {
          for (i=0 ; i<context_numBits ; i++) {
            context_data_val = (context_data_val << 1);
            if (context_data_position == bitsPerChar-1) {
              context_data_position = 0;
              context_data.push(getCharFromInt(context_data_val));
              context_data_val = 0;
            } else {
              context_data_position++;
            }
          }
          value = context_w.charCodeAt(0);
          for (i=0 ; i<8 ; i++) {
            context_data_val = (context_data_val << 1) | (value&1);
            if (context_data_position == bitsPerChar-1) {
              context_data_position = 0;
              context_data.push(getCharFromInt(context_data_val));
              context_data_val = 0;
            } else {
              context_data_position++;
            }
            value = value >> 1;
          }
        } else {
          value = 1;
          for (i=0 ; i<context_numBits ; i++) {
            context_data_val = (context_data_val << 1) | value;
            if (context_data_position == bitsPerChar-1) {
              context_data_position = 0;
              context_data.push(getCharFromInt(context_data_val));
              context_data_val = 0;
            } else {
              context_data_position++;
            }
            value = 0;
          }
          value = context_w.charCodeAt(0);
          for (i=0 ; i<16 ; i++) {
            context_data_val = (context_data_val << 1) | (value&1);
            if (context_data_position == bitsPerChar-1) {
              context_data_position = 0;
              context_data.push(getCharFromInt(context_data_val));
              context_data_val = 0;
            } else {
              context_data_position++;
            }
            value = value >> 1;
          }
        }
        context_enlargeIn--;
        if (context_enlargeIn === 0) {
          context_enlargeIn = Math.pow(2, context_numBits);
          context_numBits++;
        }
        delete context_dictionaryToCreate[context_w];
      } else {
        value = context_dictionary[context_w];
        for (i=0 ; i<context_numBits ; i++) {
          context_data_val = (context_data_val << 1) | (value&1);
          if (context_data_position == bitsPerChar-1) {
            context_data_position = 0;
            context_data.push(getCharFromInt(context_data_val));
            context_data_val = 0;
          } else {
            context_data_position++;
          }
          value = value >> 1;
        }


      }
      context_enlargeIn--;
      if (context_enlargeIn === 0) {
        context_enlargeIn = Math.pow(2, context_numBits);
        context_numBits++;
      }
    }

    // Mark the end of the stream
    value = 2;
    for (i=0 ; i<context_numBits ; i++) {
      context_data_val = (context_data_val << 1) | (value&1);
      if (context_data_position == bitsPerChar-1) {
        context_data_position = 0;
        context_data.push(getCharFromInt(context_data_val));
        context_data_val = 0;
      } else {
        context_data_position++;
      }
      value = value >> 1;
    }

    // Flush the last char
    while (true) {
      context_data_val = (context_data_val << 1);
      if (context_data_position == bitsPerChar-1) {
        context_data.push(getCharFromInt(context_data_val));
        break;
      }
      else context_data_position++;
    }
    return context_data.join('');
  },

  decompress: function (compressed) {
    if (compressed === null) return "";
    if (compressed === "") return null;
    return VG.Utils._decompress(compressed.length, 32768, function(index) { return compressed.charCodeAt(index); });
  },

  _decompress: function (length, resetValue, getNextValue) {
    var dictionary = [],
        next,
        enlargeIn = 4,
        dictSize = 4,
        numBits = 3,
        entry = "",
        result = [],
        i,
        w,
        bits, resb, maxpower, power,
        c,
        data = {val:getNextValue(0), position:resetValue, index:1};

    for (i = 0; i < 3; i += 1) {
      dictionary[i] = i;
    }

    bits = 0;
    maxpower = Math.pow(2,2);
    power=1;
    while (power!=maxpower) {
      resb = data.val & data.position;
      data.position >>= 1;
      if (data.position === 0) {
        data.position = resetValue;
        data.val = getNextValue(data.index++);
      }
      bits |= (resb>0 ? 1 : 0) * power;
      power <<= 1;
    }

    switch (next = bits) {
      case 0:
          bits = 0;
          maxpower = Math.pow(2,8);
          power=1;
          while (power!=maxpower) {
            resb = data.val & data.position;
            data.position >>= 1;
            if (data.position === 0) {
              data.position = resetValue;
              data.val = getNextValue(data.index++);
            }
            bits |= (resb>0 ? 1 : 0) * power;
            power <<= 1;
          }
        c = String.fromCharCode(bits);
        break;
      case 1:
          bits = 0;
          maxpower = Math.pow(2,16);
          power=1;
          while (power!=maxpower) {
            resb = data.val & data.position;
            data.position >>= 1;
            if (data.position === 0) {
              data.position = resetValue;
              data.val = getNextValue(data.index++);
            }
            bits |= (resb>0 ? 1 : 0) * power;
            power <<= 1;
          }
        c = String.fromCharCode(bits);
        break;
      case 2:
        return "";
    }
    dictionary[3] = c;
    w = c;
    result.push(c);
    while (true) {
      if (data.index > length) {
        return "";
      }

      bits = 0;
      maxpower = Math.pow(2,numBits);
      power=1;
      while (power!=maxpower) {
        resb = data.val & data.position;
        data.position >>= 1;
        if (data.position === 0) {
          data.position = resetValue;
          data.val = getNextValue(data.index++);
        }
        bits |= (resb>0 ? 1 : 0) * power;
        power <<= 1;
      }

      switch (c = bits) {
        case 0:
          bits = 0;
          maxpower = Math.pow(2,8);
          power=1;
          while (power!=maxpower) {
            resb = data.val & data.position;
            data.position >>= 1;
            if (data.position === 0) {
              data.position = resetValue;
              data.val = getNextValue(data.index++);
            }
            bits |= (resb>0 ? 1 : 0) * power;
            power <<= 1;
          }

          dictionary[dictSize++] = String.fromCharCode(bits);
          c = dictSize-1;
          enlargeIn--;
          break;
        case 1:
          bits = 0;
          maxpower = Math.pow(2,16);
          power=1;
          while (power!=maxpower) {
            resb = data.val & data.position;
            data.position >>= 1;
            if (data.position === 0) {
              data.position = resetValue;
              data.val = getNextValue(data.index++);
            }
            bits |= (resb>0 ? 1 : 0) * power;
            power <<= 1;
          }
          dictionary[dictSize++] = String.fromCharCode(bits);
          c = dictSize-1;
          enlargeIn--;
          break;
        case 2:
          return result.join('');
      }

      if (enlargeIn === 0) {
        enlargeIn = Math.pow(2, numBits);
        numBits++;
      }

      if (dictionary[c]) {
        entry = dictionary[c];
      } else {
        if (c === dictSize) {
          entry = w + w.charAt(0);
        } else {
          return null;
        }
      }
      result.push(entry);

      // Add w+entry[0] to the dictionary.
      dictionary[dictSize++] = w + entry.charAt(0);
      enlargeIn--;

      w = entry;

      if (enlargeIn === 0) {
        enlargeIn = Math.pow(2, numBits);
        numBits++;
      }

    }
  }
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.Utils.typedArrayToEMS=function( jsArray )
{
    var numBytes= jsArray.length * jsArray.BYTES_PER_ELEMENT;

    // malloc enough space for the data
    var ptr= Module._malloc(numBytes);

    // get a bytes-wise view on the newly allocated buffer
    var heapBytes= new Uint8Array(Module.HEAPU8.buffer, ptr, numBytes);

    // copy data into heapBytes
    heapBytes.set(new Uint8Array(jsArray.buffer));

    return { offset : heapBytes.byteOffset, length : jsArray.length };
    // call the c function which should modify the vals
    // my_emscripten_func(heapBytes.byteOffset, jsArray.length);

    // print out the results of the c function
    // var heapFloats= new Float32Array(heapBytes.buffer, heapBytes.byteOffset, floatData.length);
    // for (i= 0; i < heapFloats.length; i++) {
        // console.log(i + ": " + heapFloats[i]);
    // }

    // free the heap buffer
    // Module._free(heapBytes.byteOffset);
};

VG.Utils.loadAppImage=function( imageName )
{
    VG.sendBackendRequest( "/images/" + VG.AppSettings.name + "/" + imageName, {}, function( response ) {

        var data=JSON.parse( response );

        var image=new VG.Core.Image();
        image.name=data.name;

        VG.decompressImageData( data.content, image );
        VG.Core.imagePool.addImage( image );
        VG.update();

    }.bind( this ), "GET" );
};

VG.Utils.bytesToSize = function(bytes) {
   var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
   if (bytes === 0) return '0 Byte';
   var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
   return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];
};

VG.Utils.numberWithCommas = function(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
};

VG.Utils.getImageByName=function( name )
{
    for( i=0; i < VG.context.imagePool.images.length; ++i ) {
        if ( VG.context.imagePool.images[i].name === name )
            return VG.context.imagePool.images[i];
    }

    var prefixName=VG.UI.stylePool.current.skin.prefix + name;
    for( i=0; i < VG.context.imagePool.images.length; ++i ) {
        if ( VG.context.imagePool.images[i].name === prefixName )
            return VG.context.imagePool.images[i];
    }

    if ( VG.UI.stylePool.current.skin.fallbackPrefix ) {
        prefixName=VG.UI.stylePool.current.skin.fallbackPrefix + name;
        for( i=0; i < VG.context.imagePool.images.length; ++i ) {
            if ( VG.context.imagePool.images[i].name == prefixName )
                return VG.context.imagePool.images[i];
        }
    }

    return null;
};

VG.Utils.getSVGByName=function( name )
{
    if ( !VG.Core.SVG ) return null;

    for( i=0; i < VG.context.svgPool.svgs.length; ++i ) {
        if ( VG.context.svgPool.svgs[i].name === name )
            return VG.context.svgPool.svgs[i];
    }

    let prefixName = VG.UI.stylePool.current.skin.prefix + name;
    for( i=0; i < VG.context.svgPool.svgs.length; ++i ) {
        if ( VG.context.svgPool.svgs[i].name === prefixName )
            return VG.context.svgPool.svgs[i];
    }

    if ( VG.UI.stylePool.current.skin.fallbackPrefix ) {
        prefixName=VG.UI.stylePool.current.skin.fallbackPrefix + name;
        for( i=0; i < VG.context.svgPool.svgs.length; ++i ) {
            if ( VG.context.svgPool.svgs[i].name == prefixName )
                return VG.context.svgPool.svgs[i];
        }
    }

    return null;
};

VG.Utils.getSVGGroupByName=function( name, group )
{
    let svg = VG.Utils.getSVGByName( name );

    if ( svg ) return svg.getGroupByName( group );
    return null;
};

VG.Utils.getTextByName=function( name, split )
{
    if ( VG.App && VG.App.texts && VG.App.texts[name] )
    {
        var text=VG.Utils.decompressFromBase64( VG.App.texts[name] );
        if ( !split ) return text;
        else return text.split( ":::" );
    }

    return null;
};

VG.Utils.addDefaultFileMenu=function( menubar )
{
    var fileMenu=menubar.addMenu( "File" );
    VG.context.workspace.addMenuItemRole( fileMenu, VG.UI.ActionItemRole.New );
    fileMenu.addSeparator();
    VG.context.workspace.addMenuItemRole( fileMenu, VG.UI.ActionItemRole.Open );

    if ( VG.getHostProperty( VG.HostProperty.Platform ) === VG.HostProperty.PlatformWeb )
    {
        VG.context.workspace.addMenuItemRole( fileMenu, VG.UI.ActionItemRole.Open_Local );
    }

    fileMenu.addSeparator();
    VG.context.workspace.addMenuItemRole( fileMenu, VG.UI.ActionItemRole.Save );
    VG.context.workspace.addMenuItemRole( fileMenu, VG.UI.ActionItemRole.SaveAs );

    return fileMenu;
};

VG.Utils.addDefaultEditMenu=function( menubar )
{
    var editMenu=menubar.addMenu( "Edit" );
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.Undo );
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.Redo );
    editMenu.addSeparator();
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.Cut );
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.Copy );
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.Paste );
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.Delete );
    editMenu.addSeparator();
    VG.context.workspace.addMenuItemRole( editMenu, VG.UI.ActionItemRole.SelectAll );

    return editMenu;
};

VG.Utils.addDefaultDownloadMenu=function( menubar )
{
    var downloadMenu=menubar.addMenu( "Download" );

    var menuItem=new VG.UI.MenuItem( "Mac OS X Desktop Version", null, function() {
        VG.log( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/mac" );
        VG.gotoWebLink( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/mac" );
    }.bind( this ) );
    menuItem.statusTip="Download the native Mac OS X Version of this Application.";


    downloadMenu.addMenuItem( menuItem );
    menuItem=new VG.UI.MenuItem( "Windows: Coming Soon", null, null ); menuItem.disabled=true;
    downloadMenu.addMenuItem( menuItem );
    menuItem=new VG.UI.MenuItem( "Linux : Coming Soon", null, null ); menuItem.disabled=true;
    downloadMenu.addMenuItem( menuItem );

    return downloadMenu;
};

VG.Utils.addDefaultQuickDownloadMenu=function()
{
    var downloadItem=VG.context.workspace.addQuickMenuItem( "DOWNLOADS" );

    var macItem=downloadItem.addItem( "MAC OS X DESKTOP VERSION", function() {
        VG.log( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/mac" );
        VG.gotoUrl( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/mac" );
    }.bind( this ) );
    macItem.statusTip="Download the native Mac OS X Version of this Application.";

    var win64Item=downloadItem.addItem( "WINDOWS DESKTOP VERSION", function() {
        VG.log( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/win64" );
        VG.gotoUrl( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/win64" );
    }.bind( this ) );
    win64Item.statusTip="Download the native Windows 64-Bit Desktop Version of this Application.";

    var linuxItem=downloadItem.addItem( "LINUX VERSION COMING SOON", function() {
        VG.log( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/unix" );
        VG.gotoUrl( "https://visualgraphics.tv/app/download/" + VG.context.workspace.appId + "/unix" );
    }.bind( this ) );
    linuxItem.statusTip="Download the native Linux Desktop Version of this Application.";
    linuxItem.disabled=true;
};

VG.Utils.addDefaultViewMenu=function( menubar )
{
    var viewMenu=menubar.addMenu( "View" );

    for( var i=0; i < VG.UI.stylePool.styles.length; ++i )
    {
        var style=VG.UI.stylePool.styles[i];

        for( var s=0; s < style.skins.length; ++s )
        {
            var skin=style.skins[s];

            var menuItem=new VG.UI.MenuItem( style.name + " - " + skin.name, null, function() {

                VG.context.workspace.switchToStyle( this.style, this.skin );
            } );
            menuItem.statusTip="Activates this User Interface Style / Skin.";

            menuItem.style=style;
            menuItem.skin=skin;

            if ( style === VG.UI.stylePool.current && skin === VG.UI.stylePool.current.skin )
                menuItem.checked=menuItem.checkable=true;

            for ( var ex=0; ex < viewMenu.items.length; ++ex )
                menuItem.addExclusions( viewMenu.items[ex] );

            viewMenu.addMenuItem( menuItem );
        }
    }

    return viewMenu;
};

VG.Utils.addDefaultQuickViewMenu=function()
{
    var viewItem=VG.context.workspace.addQuickMenuItem( "SKINS" );
    viewItem.statusTip = "Change the application skin (skins change the colors and style of the user interface).";

    var style=VG.UI.stylePool.current;

    for( var s=0; s < style.skins.length; ++s )
    {
        var skin=style.skins[s];

        var skinItem=viewItem.addItem( skin.name.toUpperCase(), function() {
            VG.context.workspace.switchToStyle( this.style, this.skin );
        } );

        if ( style === VG.UI.stylePool.current && skin === VG.UI.stylePool.current.skin )
            skinItem.checked=skinItem.checkable=true;

        skinItem.style=style;
        skinItem.skin=skin;
        skinItem.statusTip="Activates this User Interface Style / Skin.";
    }

    return viewItem;
};

VG.Utils.dumpObject=function( object )
{
    VG.log( JSON.stringify( object, null, 4) );
};

VG.Utils.scheduleRedrawInMs=function( ms )
{
    VG.context.workspace.redrawList.push( Date.now() + ms );
};

VG.Utils.ensureRedrawWithinMs=function( ms )
{
    var redrawList=VG.context.workspace.redrawList;
    var time=Date.now();

    for( var i=0; i < redrawList.length; ++i )
    {
        if ( ( redrawList[i] + 1000.0/60.0 ) >= time && redrawList[i] < ( time + ms ) )
            return;
    }
    redrawList.push( time + ms - 1000.0/60.0 );
};

VG.Utils.fileNameFromPath=function( path, noSuffix )
{
    var rc=path.replace(/^.*(\\|\/|\:)/, '' );

    if ( noSuffix && rc.indexOf( '.' ) !== -1 )
        rc=rc.split( '.' )[0];

    return rc;
};

VG.Utils.suffixFromPath=function( path )
{
    var rc=path.replace(/^.*(\\|\/|\:)/, '' );

    if ( rc.indexOf( '.' ) !== -1 )
        rc=rc.split( '.' )[1];
    else rc="";

    return rc.toUpperCase();
};

VG.Utils.stripFileNameFromPath=function(path) {
  var dirPart;
  path.replace(/^(.*(\\|\/|\:))?([^/]*)$/, function(_, dir, file) {
    dirPart = dir;
  });
  return dirPart;
};

VG.Utils.createMaterial=function( className )
{
    var graph=VG.Nodes.Graph();
    var materialNode=graph.createNode( className );
    return materialNode.getTerminal( "out" );
};

VG.Utils.materialOutputFromGraph=function( graphData )
{
    var graph=VG.Nodes.Graph();
    var terminal=graph.load( graphData );

    var mtl;

    if ( terminal ) {
        var vector=new VG.Math.Vector3();
        mtl=terminal.onCall( vector );
    }

    graph.clear();

    return mtl;
};

VG.Utils.addSingleShotCallback=function( func )
{
    VG.context.workspace.singleShotCallbacks.push( func );
};

VG.Utils.canvasToImage=function( ctx, image )
{
    var width=ctx.canvas.width, height=ctx.canvas.height;

    if ( !image ) image = new VG.Core.Image( { width : width, height : height, forcePowerOfTwo : false } );

    let imageData = image.data;
    let pixelData = ctx.getImageData( 0, 0, width, height );
    let data = pixelData.data;

    for ( let h=0; h < height; ++h )
    {
        let sourceOffset = h * pixelData.width * 4;
        let destOffset = h * image.modulo;

        for ( let w=0; w < width; ++w ) {
            imageData[destOffset++] = data[sourceOffset++];
            imageData[destOffset++] = data[sourceOffset++];
            imageData[destOffset++] = data[sourceOffset++];
            imageData[destOffset++] = data[sourceOffset++];
        }
    }

    return image;
};

/**
 * Converts the given {VG.Core.Image} to an HTML5 image usable in the 2D Canvas.
 * @param {VG.Core.Image} image - The image to convert
 * @returns An HTML5 image
 */

VG.Utils.imageToHTML5Image=function( image, callback )
{
    let textureCanvas=document.getElementById( 'textureCanvas' );
    let ctx=textureCanvas.getContext('2d');

    ctx.canvas.width=image.width;
    ctx.canvas.height=image.height;

    ctx.putImageData( new ImageData( new Uint8ClampedArray( image.data ), image.width, image.height ), 0, 0);

    let imageEl = new Image();
    if ( callback) imageEl.onload = () => callback( imageEl );
    imageEl.src = textureCanvas.toDataURL();
    return imageEl;
};

/**
 * Converts an {VG.RenderTarget} to an HTML5 image usable in the 2D canvas.
 * @param {VG.RenderTarget} renderTarget - The renderTarget to convert
 * @returns An HTML5 image
 */

VG.Utils.renderTargetToHTML5Image=function( renderTarget, callback )
{
    let image = VG.Utils.renderTargetToImage( renderTarget, undefined, true );
    return VG.Utils.imageToHTML5Image( image, callback );
};

VG.Utils.svgToImage=function( { data, width, height, callback } = {} )
{
    var DOMURL = window.URL || window.webkitURL || window;

    var img = new Image();
    var svg = new Blob( [data], {type: 'image/svg+xml'});
    var url = DOMURL.createObjectURL(svg);

    img.onload = function () {

        let textureCanvas=document.getElementById( 'textureCanvas' );
        let ctx=textureCanvas.getContext('2d');

        ctx.canvas.width=width;
        ctx.canvas.height=height;

        ctx.drawImage( img, 0, 0 );
        DOMURL.revokeObjectURL(url);

        callback( VG.Utils.canvasToImage( ctx ) );
    };

    img.src = url;
};

VG.Utils.renderTargetToImage=function( renderTarget, image, wait )
{
    var width = renderTarget.getWidth();
    var height = renderTarget.getHeight();

    var frameW = renderTarget.getRealWidth();
    var frameH = renderTarget.getRealHeight();

    if ( !image ) {
        if ( !renderTarget.floatTexture ) image = new VG.Core.Image( width, height );
        else image = new VG.Core.Float32Image( width, height );
    }

    renderTarget.bind();
    renderTarget.fillPixelBuffer( { x : 0, y : 0, width : frameW, height : frameH }, image.data );
    renderTarget.unbind();

    if ( wait )
        renderTarget.checkStatusComplete();

    return image;
};

/**
 * Creates a digit token consisting of alphanumeric characters.
 * @returns {string} The created token.
 */

VG.Utils.createToken = function( length = 4 )
{
   let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');
   let token = [], rnd = Math.random, r;

   for (let i = 0; i < length; i++) {
        r = 0 | rnd()*chars.length;
        token[i] = chars[r];
   }
   return token.join('');
};

// --- Great and fast Polygon Triangulation, https://github.com/mapbox/earcut

VG.Utils.earcut=function(data, holeIndices, dim) {

/*
Copyright (c) 2015, Mapbox

Permission to use, copy, modify, and/or distribute this software for any purpose
with or without fee is hereby granted, provided that the above copyright notice
and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
THIS SOFTWARE.
*/

// create a circular doubly linked list from polygon points in the specified winding order
function linkedList(data, start, end, dim, clockwise) {
    var i, last;

    if (clockwise === (signedArea(data, start, end, dim) > 0)) {
        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);
    } else {
        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);
    }

    if (last && equals(last, last.next)) {
        removeNode(last);
        last = last.next;
    }

    return last;
}

// eliminate colinear or duplicate points
function filterPoints(start, end) {
    if (!start) return start;
    if (!end) end = start;

    var p = start,
        again;
    do {
        again = false;

        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {
            removeNode(p);
            p = end = p.prev;
            if (p === p.next) return null;
            again = true;

        } else {
            p = p.next;
        }
    } while (again || p !== end);

    return end;
}

// main ear slicing loop which triangulates a polygon (given as a linked list)
function earcutLinked(ear, triangles, dim, minX, minY, size, pass) {
    if (!ear) return;

    // interlink polygon nodes in z-order
    if (!pass && size) indexCurve(ear, minX, minY, size);

    var stop = ear,
        prev, next;

    // iterate through ears, slicing them one by one
    while (ear.prev !== ear.next) {
        prev = ear.prev;
        next = ear.next;

        if (size ? isEarHashed(ear, minX, minY, size) : isEar(ear)) {
            // cut off the triangle
            triangles.push(prev.i / dim);
            triangles.push(ear.i / dim);
            triangles.push(next.i / dim);

            removeNode(ear);

            // skipping the next vertice leads to less sliver triangles
            ear = next.next;
            stop = next.next;

            continue;
        }

        ear = next;

        // if we looped through the whole remaining polygon and can't find any more ears
        if (ear === stop) {
            // try filtering points and slicing again
            if (!pass) {
                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, size, 1);

            // if this didn't work, try curing all small self-intersections locally
            } else if (pass === 1) {
                ear = cureLocalIntersections(ear, triangles, dim);
                earcutLinked(ear, triangles, dim, minX, minY, size, 2);

            // as a last resort, try splitting the remaining polygon into two
            } else if (pass === 2) {
                splitEarcut(ear, triangles, dim, minX, minY, size);
            }

            break;
        }
    }
}

// check whether a polygon node forms a valid ear with adjacent nodes
function isEar(ear) {
    var a = ear.prev,
        b = ear,
        c = ear.next;

    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear

    // now make sure we don't have other points inside the potential ear
    var p = ear.next.next;

    while (p !== ear.prev) {
        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&
            area(p.prev, p, p.next) >= 0) return false;
        p = p.next;
    }

    return true;
}

function isEarHashed(ear, minX, minY, size) {
    var a = ear.prev,
        b = ear,
        c = ear.next;

    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear

    // triangle bbox; min & max are calculated like this for speed
    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),
        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),
        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),
        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);

    // z-order range for the current triangle bbox;
    var minZ = zOrder(minTX, minTY, minX, minY, size),
        maxZ = zOrder(maxTX, maxTY, minX, minY, size);

    // first look for points inside the triangle in increasing z-order
    var p = ear.nextZ;

    while (p && p.z <= maxZ) {
        if (p !== ear.prev && p !== ear.next &&
            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&
            area(p.prev, p, p.next) >= 0) return false;
        p = p.nextZ;
    }

    // then look for points in decreasing z-order
    p = ear.prevZ;

    while (p && p.z >= minZ) {
        if (p !== ear.prev && p !== ear.next &&
            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&
            area(p.prev, p, p.next) >= 0) return false;
        p = p.prevZ;
    }

    return true;
}

// go through all polygon nodes and cure small local self-intersections
function cureLocalIntersections(start, triangles, dim) {
    var p = start;
    do {
        var a = p.prev,
            b = p.next.next;

        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {

            triangles.push(a.i / dim);
            triangles.push(p.i / dim);
            triangles.push(b.i / dim);

            // remove two nodes involved
            removeNode(p);
            removeNode(p.next);

            p = start = b;
        }
        p = p.next;
    } while (p !== start);

    return p;
}

// try splitting polygon into two and triangulate them independently
function splitEarcut(start, triangles, dim, minX, minY, size) {
    // look for a valid diagonal that divides the polygon into two
    var a = start;
    do {
        var b = a.next.next;
        while (b !== a.prev) {
            if (a.i !== b.i && isValidDiagonal(a, b)) {
                // split the polygon in two by the diagonal
                var c = splitPolygon(a, b);

                // filter colinear points around the cuts
                a = filterPoints(a, a.next);
                c = filterPoints(c, c.next);

                // run earcut on each half
                earcutLinked(a, triangles, dim, minX, minY, size);
                earcutLinked(c, triangles, dim, minX, minY, size);
                return;
            }
            b = b.next;
        }
        a = a.next;
    } while (a !== start);
}

// link every hole into the outer loop, producing a single-ring polygon without holes
function eliminateHoles(data, holeIndices, outerNode, dim) {
    var queue = [],
        i, len, start, end, list;

    for (i = 0, len = holeIndices.length; i < len; i++) {
        start = holeIndices[i] * dim;
        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;
        list = linkedList(data, start, end, dim, false);
        if (list === list.next) list.steiner = true;
        queue.push(getLeftmost(list));
    }

    queue.sort(compareX);

    // process holes from left to right
    for (i = 0; i < queue.length; i++) {
        eliminateHole(queue[i], outerNode);
        outerNode = filterPoints(outerNode, outerNode.next);
    }

    return outerNode;
}

function compareX(a, b) {
    return a.x - b.x;
}

// find a bridge between vertices that connects hole with an outer ring and and link it
function eliminateHole(hole, outerNode) {
    outerNode = findHoleBridge(hole, outerNode);
    if (outerNode) {
        var b = splitPolygon(outerNode, hole);
        filterPoints(b, b.next);
    }
}

// David Eberly's algorithm for finding a bridge between hole and outer polygon
function findHoleBridge(hole, outerNode) {
    var p = outerNode,
        hx = hole.x,
        hy = hole.y,
        qx = -Infinity,
        m;

    // find a segment intersected by a ray from the hole's leftmost point to the left;
    // segment's endpoint with lesser x will be potential connection point
    do {
        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {
            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);
            if (x <= hx && x > qx) {
                qx = x;
                if (x === hx) {
                    if (hy === p.y) return p;
                    if (hy === p.next.y) return p.next;
                }
                m = p.x < p.next.x ? p : p.next;
            }
        }
        p = p.next;
    } while (p !== outerNode);

    if (!m) return null;

    if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint

    // look for points inside the triangle of hole point, segment intersection and endpoint;
    // if there are no points found, we have a valid connection;
    // otherwise choose the point of the minimum angle with the ray as connection point

    var stop = m,
        mx = m.x,
        my = m.y,
        tanMin = Infinity,
        tan;

    p = m.next;

    while (p !== stop) {
        if (hx >= p.x && p.x >= mx && hx !== p.x &&
                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {

            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential

            if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && locallyInside(p, hole)) {
                m = p;
                tanMin = tan;
            }
        }

        p = p.next;
    }

    return m;
}

// interlink polygon nodes in z-order
function indexCurve(start, minX, minY, size) {
    var p = start;
    do {
        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, size);
        p.prevZ = p.prev;
        p.nextZ = p.next;
        p = p.next;
    } while (p !== start);

    p.prevZ.nextZ = null;
    p.prevZ = null;

    sortLinked(p);
}

// Simon Tatham's linked list merge sort algorithm
// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html
function sortLinked(list) {
    var i, p, q, e, tail, numMerges, pSize, qSize,
        inSize = 1;

    do {
        p = list;
        list = null;
        tail = null;
        numMerges = 0;

        while (p) {
            numMerges++;
            q = p;
            pSize = 0;
            for (i = 0; i < inSize; i++) {
                pSize++;
                q = q.nextZ;
                if (!q) break;
            }

            qSize = inSize;

            while (pSize > 0 || (qSize > 0 && q)) {

                if (pSize === 0) {
                    e = q;
                    q = q.nextZ;
                    qSize--;
                } else if (qSize === 0 || !q) {
                    e = p;
                    p = p.nextZ;
                    pSize--;
                } else if (p.z <= q.z) {
                    e = p;
                    p = p.nextZ;
                    pSize--;
                } else {
                    e = q;
                    q = q.nextZ;
                    qSize--;
                }

                if (tail) tail.nextZ = e;
                else list = e;

                e.prevZ = tail;
                tail = e;
            }

            p = q;
        }

        tail.nextZ = null;
        inSize *= 2;

    } while (numMerges > 1);

    return list;
}

// z-order of a point given coords and size of the data bounding box
function zOrder(x, y, minX, minY, size) {
    // coords are transformed into non-negative 15-bit integer range
    x = 32767 * (x - minX) / size;
    y = 32767 * (y - minY) / size;

    x = (x | (x << 8)) & 0x00FF00FF;
    x = (x | (x << 4)) & 0x0F0F0F0F;
    x = (x | (x << 2)) & 0x33333333;
    x = (x | (x << 1)) & 0x55555555;

    y = (y | (y << 8)) & 0x00FF00FF;
    y = (y | (y << 4)) & 0x0F0F0F0F;
    y = (y | (y << 2)) & 0x33333333;
    y = (y | (y << 1)) & 0x55555555;

    return x | (y << 1);
}

// find the leftmost node of a polygon ring
function getLeftmost(start) {
    var p = start,
        leftmost = start;
    do {
        if (p.x < leftmost.x) leftmost = p;
        p = p.next;
    } while (p !== start);

    return leftmost;
}

// check if a point lies within a convex triangle
function pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {
    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&
           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&
           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;
}

// check if a diagonal between two polygon nodes is valid (lies in polygon interior)
function isValidDiagonal(a, b) {
    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) &&
           locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b);
}

// signed area of a triangle
function area(p, q, r) {
    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);
}

// check if two points are equal
function equals(p1, p2) {
    return p1.x === p2.x && p1.y === p2.y;
}

// check if two segments intersect
function intersects(p1, q1, p2, q2) {
    if ((equals(p1, q1) && equals(p2, q2)) ||
        (equals(p1, q2) && equals(p2, q1))) return true;
    return area(p1, q1, p2) > 0 !== area(p1, q1, q2) > 0 &&
           area(p2, q2, p1) > 0 !== area(p2, q2, q1) > 0;
}

// check if a polygon diagonal intersects any polygon segments
function intersectsPolygon(a, b) {
    var p = a;
    do {
        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&
                intersects(p, p.next, a, b)) return true;
        p = p.next;
    } while (p !== a);

    return false;
}

// check if a polygon diagonal is locally inside the polygon
function locallyInside(a, b) {
    return area(a.prev, a, a.next) < 0 ?
        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :
        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;
}

// check if the middle point of a polygon diagonal is inside the polygon
function middleInside(a, b) {
    var p = a,
        inside = false,
        px = (a.x + b.x) / 2,
        py = (a.y + b.y) / 2;
    do {
        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&
                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))
            inside = !inside;
        p = p.next;
    } while (p !== a);

    return inside;
}

// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;
// if one belongs to the outer ring and another to a hole, it merges it into a single ring
function splitPolygon(a, b) {
    var a2 = new Node(a.i, a.x, a.y),
        b2 = new Node(b.i, b.x, b.y),
        an = a.next,
        bp = b.prev;

    a.next = b;
    b.prev = a;

    a2.next = an;
    an.prev = a2;

    b2.next = a2;
    a2.prev = b2;

    bp.next = b2;
    b2.prev = bp;

    return b2;
}

// create a node and optionally link it with previous one (in a circular doubly linked list)
function insertNode(i, x, y, last) {
    var p = new Node(i, x, y);

    if (!last) {
        p.prev = p;
        p.next = p;

    } else {
        p.next = last.next;
        p.prev = last;
        last.next.prev = p;
        last.next = p;
    }
    return p;
}

function removeNode(p) {
    p.next.prev = p.prev;
    p.prev.next = p.next;

    if (p.prevZ) p.prevZ.nextZ = p.nextZ;
    if (p.nextZ) p.nextZ.prevZ = p.prevZ;
}

function Node(i, x, y) {
    // vertice index in coordinates array
    this.i = i;

    // vertex coordinates
    this.x = x;
    this.y = y;

    // previous and next vertice nodes in a polygon ring
    this.prev = null;
    this.next = null;

    // z-order curve value
    this.z = null;

    // previous and next nodes in z-order
    this.prevZ = null;
    this.nextZ = null;

    // indicates whether this is a steiner point
    this.steiner = false;
}

function signedArea(data, start, end, dim) {
    var sum = 0;
    for (var i = start, j = end - dim; i < end; i += dim) {
        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);
        j = i;
    }
    return sum;
}

// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts
VG.Utils.earcut.flatten = function (data) {
    var dim = data[0][0].length,
        result = {vertices: [], holes: [], dimensions: dim},
        holeIndex = 0;

    for (var i = 0; i < data.length; i++) {
        for (var j = 0; j < data[i].length; j++) {
            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);
        }
        if (i > 0) {
            holeIndex += data[i - 1].length;
            result.holes.push(holeIndex);
        }
    }
    return result;
};

    dim = dim || 2;

    var hasHoles = holeIndices && holeIndices.length,
        outerLen = hasHoles ? holeIndices[0] * dim : data.length,
        outerNode = linkedList(data, 0, outerLen, dim, true),
        triangles = [];

    if (!outerNode) return triangles;

    var minX, minY, maxX, maxY, x, y, size;

    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);

    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox
    if (data.length > 80 * dim) {
        minX = maxX = data[0];
        minY = maxY = data[1];

        for (var i = dim; i < outerLen; i += dim) {
            x = data[i];
            y = data[i + 1];
            if (x < minX) minX = x;
            if (y < minY) minY = y;
            if (x > maxX) maxX = x;
            if (y > maxY) maxY = y;
        }

        // minX, minY and size are later used to transform coords into integers for z-order calculation
        size = Math.max(maxX - minX, maxY - minY);
    }

    earcutLinked(outerNode, triangles, dim, minX, minY, size);

    return triangles;
};
/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

VG.DB = {};

VG.DB.getAppId=function( callback, url )
{
    /**Returns the appId of the current app, or of any app identified by its Url, go the given callback or does nothing if the appId could not be retrieved.
     * @param {function} Callback - The callback to be called with the found appId.
     * @param {string} url - Optional, the url of the application to retrieve the appId for. If not given, the appId of the current application is
     * returned if possible.
     */

	if ( !url ) {
    	if ( VG.App && VG.App.url ) url=VG.Utils.decompressFromBase64( VG.App.url );
	}

	var serverUrl="/app/check/?url=" + url;// + "&domain="

	VG.sendBackendRequest( serverUrl, "", function( responseText ) {
		var response=JSON.parse( responseText );
		var array=response.check;

        for( var i=0; i < array.length; ++i ) {
        	if ( array[i].name === "url" ) {
        		if ( array[i].exists )
        			if ( callback ) callback( array[i].appid );
        	}
        }
    }, "GET" );
};

VG.DB.userLogOut=function( callback )
{
    /**Logs out the currently logged in user from the Visual Graphics session.
     * @param {function} Callback - The callback to be called on success.
     */

	VG.sendBackendRequest( "/user/logout", "", function( responseText ) {
		if ( responseText === "OK" && callback ) callback();
    }, "GET" );
};

VG.DB.userChangePassword=function( password, callback )
{
    /**Changes the password of the currently logged in user.
     * @param {string} Password - The new password for the current user.
     * @param {function} Callback - The callback to be called when the operation finishes, either a true or false value is passed to the
     * function as its first argument, depending on the success of the password change.
     */

	VG.sendBackendRequest( "/user/password", JSON.stringify( { "password": password } ), function( responseText ) {
    	var response=JSON.parse( responseText );

    	if ( callback ) {
			if ( response.status === "ok" ) callback( true );
    		else callback( false );
    	}

    }, "PUT" );
};

VG.DB.userLogIn=function( userName, password, callback )
{
    /**Changes the password of the currently logged in user.
     * @param {string} Password - The new password for the current user.
     * @param {function} Callback - The callback to be called when the operation finishes, either a true or false value is passed to the
     * function as its first argument, depending on the success of the password change.
     */

    var parameters={username : userName, password : password};

	VG.sendBackendRequest( "/user/login", JSON.stringify( parameters ), function( responseText ) {
        let response = JSON.parse( responseText );

    	if ( callback ) {
			if ( response.status === "ok" && response.user.username && response.user.username.length )
			{
				callback( { success: true, userName: response.user.username, userId: response.user.id, isAppAdmin: response.user.admin } );
			}
    		else callback( { success: false, message: response.message } );
    	}

    }, "POST" );
};

VG.DB.userIsAppAdmin=function( appId, userId, callback )
{
    /**Checks if the given user is an admin of the given application.
     * @param {string} appId - The appId of the application.
     * @param {string} userId - The userId.
     * @param {function} Callback - The callback to be called when the operation finishes, either a true or false value is passed to the
     * function as its first argument, depending on whether the user is an admin or not.
     */

	VG.sendBackendRequest( "/group/app/" + appId, "", function( responseText ) {
		var response=JSON.parse( responseText );

		if ( response.status === "ok" )
		{
			for( var g=0; g < response.groups.length; ++g )
			{
				var group=response.groups[g];

				if ( group.app === appId )
				{
					var users=group.users;

        			for( var i=0; i < users.length; ++i ) {
        				if ( users[i]._id === userId && callback ) {
        					callback( true );
        					return;
        				}
        			}
        		}
        	}
        }
        if ( callback ) callback( false );
    }, "GET" );
};

VG.DB.sendEMailToAppAdmins=function( appId, name, email, subject, message, callback )
{
    /**Sends an eMail to the admins of the application with the given appId.
     * @param {string} appId - The application id of the app. The eMail will be send to the admins of that app.
     * @param {string} name - The name of the sender of the eMail.
     * @param {string} email - The email of the sender of the eMail.
     * @param {string} subject - The subject of the message.
     * @param {string} message - The message to send.
     * @param {function} callback - The callback to be called , either a true or false value is passed to the
     * function as its first argument depending on the success of the eMail sending.
     */

    var parameters={subject : subject, message : message, email : email, name : name };

    VG.sendBackendRequest( "/app/email/" + appId, JSON.stringify( parameters ), function( responseText ) {
        var response=JSON.parse( responseText );

        if ( callback ) {
            if ( response.status === "ok" ) callback( true );
            else callback( false );
        }

    }, "POST" );
};


VG.DB.getAppChatMessages=function( appId, callback, since )
{
    /**Retrieves all chat messages for the given Application, optionally since a given timestamp.
     * @param {string} appId - The id of the application.
     * @param {function} Callback - The callback to be called when the operation finishes. The callback will be passed the list of messages as its first argument.
     * @param {string} since - Optional, the ISO String Date timestamp indicating only to get messages since the given date. Otherwise get all messages.
     */

    var cmd="/chat/" + appId;
    if ( since ) cmd+="?msgdate=" + since;

    VG.sendBackendRequest( cmd, "", function( responseText ) {
        var response=JSON.parse( responseText );
        if ( callback ) callback( response );
    }, "GET" );
};

VG.DB.postAppChatMessage=function( appId, message )
{
    /**Posts a community chat message for the given Application.
     * @param {string} appId - The id of the application to receive the chat message.
     * @param {string} message - The chat message.
     */

    var parameters={ msg: message };
    VG.sendBackendRequest( "/chat/" + appId, JSON.stringify( parameters ), function( responseText ) {
        var response=JSON.parse( responseText );
    }, "POST" );
};

VG.DB.getAppSource=function( appId, callback )
{
    /**Retrieves the vide file for the given appId.
     * @param {string} appId - The id of the application.
     * @param {function} Callback - The callback to be called when the operation finishes. The callback will be passed the string containing the vide content as the first argument.
     */

    var cmd="/app/source/" + appId;

    VG.sendBackendRequest( cmd, "", function( responseText ) {
        var response=JSON.parse( responseText );
        //VG.log( responseText );
        if ( callback ) callback( response );
    }, "GET" );
};
/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

VG.DB.createFolder=function( appId, name, description, publicRead, publicWrite, callback )
{
    /**Creates a new Folder for the given application. Folders can contain any kind of data and is the primary way to store data in the Cloud for
     * Visual Graphics applications.
     * @param {string} name - The name of the new folder.
     * @param {string} description - A description of the new folder.
     * @param {boolean} publicRead - True if everybody can read the contents of the folder. If false, only admins or group members of this folder
     * can read from this folder.
     * @param {boolean} publicWrite - True if everybody can write new content for the folder. If false, only admins or group members of this folder
     * can write to this folder.
     * @param {function} Callback - The callback to be called when the operation finishes.
     */

    var folderObject={};

    folderObject.name=name;
    folderObject.description=description;
    folderObject.publicRead=publicRead;
    folderObject.publicWrite=publicWrite;

    folderObject.app=appId;

    VG.sendBackendRequest( "/folder", JSON.stringify( folderObject ), function( responseText ) {
        var response=JSON.parse( responseText );
        console.log( responseText );

        if ( response.status === "ok" ) {

        }

    }, "PUT" );
};

VG.DB.Folder=function( id, callback )
{
    /**Creates a new local Folder Object which can be used to read and write content to the remote Folder.
     * @param {string} id - The id of the Folder in the Database.
     * @param {function} Callback - The callback to be called when the operation finishes. The first argument of the callback
     * will be a pointer to the Folder object.
     * @constructor
     */

    this.id=id;

    if ( callback ) {
        VG.sendBackendRequest( "/folder/" + id, "", function( responseText ) {
            var response=JSON.parse( responseText );

            if ( response.status === "ok" ) {

                this.name=response.folder.name;
                this.description=response.folder.description;
                this.publicRead=response.folder.public.read;
                this.publicWrite=response.folder.public.write;

                this.isVerified=true;
            }

        callback( this );
        }.bind( this ), "GET" );
    }
};

VG.DB.Folder.prototype.getIndex=function( callback )
{
    VG.sendBackendRequest( "/folder/" + this.id + "/content/index", "", ( responseText ) => {
        if ( !responseText ) return;
        let response = JSON.parse( responseText );
        if ( callback ) callback( response.index );
    }, "GET" );
};

VG.DB.Folder.prototype.getAllContent=function( callback )
{
    /**Downloads all content of the Folder.
     * @param {function} Callback - The callback to be called when the operation finishes. The first argument of the callback
     * will contain an array of the content of the folder.
     */
    VG.sendBackendRequest( "/folder/" + this.id + "/content", "", function( responseText ) {
        if ( !responseText ) return;
        var response=JSON.parse( responseText );

        if ( response.status === "ok" ) {
            if ( callback ) callback( response.content );
        }
    }.bind( this ), "GET" );
};

VG.DB.Folder.prototype.getContent=function( id, callback )
{
    /**Downloads all content of the Folder.
     * @param {function} Callback - The callback to be called when the operation finishes. The first argument of the callback
     * will contain an array of the content of the folder.
     */
    VG.sendBackendRequest( "/folder/" + this.id + "/content/" + id, "", function( responseText ) {
        if ( !responseText ) return;
        var response=JSON.parse( responseText );
        if ( response.status === "ok" ) {
            if ( callback ) callback( response.content );
        }
    }.bind( this ), "GET" );
};

VG.DB.Folder.prototype.addContent=function( name, content, callback )
{
    /**Uploads new content to the Folder.
     * @param {string} name - The name of the new content.
     * @param {string} content - The content, has to be JSON.
     * @param {function} Callback - The callback to be called when the operation finishes. The first argument of the callback
     * will be true if the upload succeeded, false otherwise.
     */
    var params={ "name" : name, "data" : content };
    VG.sendBackendRequest( "/folder/" + this.id + "/content", JSON.stringify( params ), function( responseText ) {
        let response=JSON.parse( responseText );

        if ( response.status === "ok" ) {
            if ( callback ) callback( true );
        } else if ( callback ) callback( false );
    }.bind( this ), "PUT" );
};

VG.DB.Folder.prototype.removeContent=function( id, callback )
{
    /**Removes content identified by id from the Folder.
     * @param {number} id - The id of the content.
     * @param {function} Callback - The callback to be called when the operation finishes. The first argument of the callback
     * will be true if the upload succeeded, false otherwise.
     */
    VG.sendBackendRequest( "/folder/" + this.id + "/content/" + id, "", function( responseText ) {
        var response=JSON.parse( responseText );

        if ( response.status === "ok" ) {
            if ( callback ) callback( true );
        } else if ( callback ) callback( false );
    }.bind( this ), "DELETE" );
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains all UI related classes.
 * @namespace
 */

VG.UI = {};

/**
 * Horizontal alignment options.
 * @enum {number}
 * @type {number}
 */

VG.UI.HAlignment={ /** Left aligned */ "Left" : 0, /** Centered */ "Centered" : 1, /** Right aligned */ "Right" : 2 };

/**
 * Vertical alignment options.
 * @enum
 * @type {number}
 */

VG.UI.VAlignment={ /** Top aligned */ "Top" : 0, /** Centered */ "Centered" : 1, /** Bottom aligned */ "Bottom" : 2 };

VG.UI.DataCollectionRole={ "LoadSaveRole" : 1, "UndoRedoRole" : 2 };

/**
 * The different callback types which can be registered via {@link VG.UI.Workspace.registerCallback} and get called when the specified action is triggered
 * inside the Visual Graphics model.
 * @enum
 */
VG.UI.CallbackType={ /** @type {callback} Called when a New operation is triggered by the user. */ "New" : 0,
	/**  @type {callback} Called when an Undo/Redo operation is triggered by the user. A single argument is passed to the callback with the undo/redo path. Only needed if the app needs some special UI updates for certain paths. */"UndoRedo" : 1,
	/**  @type {callback} Called when the user selects open. This overrides the default Model behavior. Data to read into the app state is passed to the callback. */"Open" : 2,
	/**  @type {callback} Called when the user selects save. This overrides the default Model behavior. Data to save needs to be returned by this callback. */ "Save" : 3,
	/**  @type {callback} Called when the user logged state changes, i.e. logged in / logged out. Read out the arguments for details. */ "LoggedStateChanged" : 4,
	/**  @type {callback} Called before a new operation, gives the application to confirm cancel. The callback has a function pointer as argument which the app should call to confirm the new operation. */ "ConfirmNew" : 5,
	/**  @type {callback} Called when the application gains or looses focus. The function parameter will be true if the app gains focus and false if the application looses focus. */ "FocusChanged" : 6,
	/**  @type {callback} Called when a new window (not widget) is about to be displayed and allows for the given windows rectangle to be adjusted. */ "PlaceWindow" : 7
	 };

VG.UI.DockWidgetLocation={ "Left" : 0, "Right" : 1, "Floating" : 2 };

VG.UI.ActionItemRole={ "None" : 0, "New" : 1, "Open" : 2, "Save" : 3, "SaveAs" : 4, "Undo" : 5, "Redo" : 6, "Open_Local" : 7, "Cut" : 8, "Copy" : 9, "Paste" : 10, "Delete" : 11, "SelectAll" : 12,
	"Login" : 13, "Signup" : 14, "UserTool" : 15, "QuickMenu" : 16, "SkinCycyle" : 17 };

/** Maximum size for layours */

VG.UI.MaxLayoutSize=32768;

VG.UI.TableWidgetItemType={ "Label" : 0, "TextLineEdit" : 1, "PopupButton" : 2 };

VG.UI.FileDialog={
	"Image" : 0,
	"Text" : 1,
	"Project" : 2,
	"Binary" : 3
};

// --- Styles

VG.Styles={};
VG.Styles.pool=[];

// --------------------------------------------- VG.Core.StyleSkinPool

VG.UI.StylePool=function()
{
	if ( !(this instanceof VG.UI.StylePool) ) return new VG.UI.StylePool();
    this.styles=[];
};

// --- addStyle

VG.UI.StylePool.prototype.addStyle=function( style )
{
	this.styles.push( style );

	if ( !this.current ) this.current=style;
};

// --- getImageByName

VG.UI.StylePool.prototype.getStyleByName=function( name )
{
    for( var i=0; i < this.styles.length; ++i ) {
        if ( this.styles[i].name == name )
            return this.styles[i];
    }

    return null;
};

VG.UI.stylePool=new VG.UI.StylePool();


/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv>
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.UI.VisualGraphicsStyle=function()
{
    this.name="Visual Graphics";
    this.skins=[];

    this.prefix="vgstyle_";
    this.path="visualgraphics";

    this.rect1=VG.Core.Rect();
    this.rect2=VG.Core.Rect();
    this.rect3=VG.Core.Rect();
    this.rect4=VG.Core.Rect();
};

VG.UI.VisualGraphicsStyle.prototype.addSkin=function( skin )
{
    this.skins.push( skin );

    if ( !this.skin )
        this.skin=skin;

    skin.style=this;
    skin.activate();
};

VG.UI.VisualGraphicsStyle.prototype.copySkinObject=function( name, skin )
{
    function copy(source, deep) {
        var o, prop, type;

        if (typeof source != 'object' || source === null) {
            o = source;
            return o;
        }

        o = new source.constructor();

        for (prop in source) {

            if (source.hasOwnProperty(prop)) {
                type = typeof source[prop];

                if (deep && type == 'object' && source[prop] !== null && !(source[prop] instanceof VG.Font.Font) ) {
                    o[prop] = copy(source[prop]);
                } else {
                    o[prop] = source[prop];
                }
            }
       }
       return o;
    }

    return copy( this.skin[name], true );
    // return Object.assign( {}, this.skin[name] );
};

// --- Button

VG.UI.VisualGraphicsStyle.prototype.drawButton=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    // --- Border

    if ( widget.hasFocusState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, this.skin.Button.FocusBorderColor1 );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.Button.FocusBorderColor1 );

        if ( widget.checked || widget.mouseIsDown )
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.Button.FocusBorderCheckedColor2 );
        else canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.Button.FocusBorderColor2 );

        widget.contentRect.shrink( 1, 1, widget.contentRect );
    } else
    {
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.Button.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    }

    // --- Content

    if ( widget.hasHoverState && widget.checked || widget.mouseIsDown ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.Button.CheckedBackGradColor1, this.skin.Button.CheckedBackGradColor2 );
    } else
    if ( widget.hasHoverState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.Button.HoverBackGradColor1, this.skin.Button.HoverBackGradColor2 );
    } else
    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.Button.BackGradColor1, this.skin.Button.BackGradColor2 );

    if ( widget.big ) canvas.pushFont( this.skin.Button.Font );
    else canvas.pushFont( this.skin.Button.SmallFont );

    canvas.drawTextRect( widget.text, widget.contentRect, this.skin.Button.TextColor );
    canvas.popFont();

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- ButtonGroup

VG.UI.VisualGraphicsStyle.prototype.drawButtonGroup=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );

    this.rect1.copy( widget.rect );

    canvas.pushFont( this.skin.ButtonGroup.Font );

    for ( var i=0; i < widget.items.length; ++i )
    {
        var item=widget.items[i];

        this.rect1.width=item.textWidth + 16;
        this.rect1.height=item.textHeight;

        if ( !widget.__vgInsideToolBar ) this.rect1.height+=4;

        if ( item.icon ) this.rect1.width+=5 + item.icon.width;
        else if ( item.svgName ) this.rect1.width+=15;

        this.rect1.y=widget.rect.y + ( widget.rect.height - this.rect1.height ) / 2;

        var borderColor, backColor;

        if ( widget.activeButton === item ) {
            borderColor=this.skin.ButtonGroup.PressedBorderColor;
            backColor=this.skin.ButtonGroup.PressedBackColor;
        } else
        if ( widget.hoverButton === item ) {
            borderColor=this.skin.ButtonGroup.HoverBorderColor;
            backColor=this.skin.ButtonGroup.HoverBackColor;
            if ( item.statusTip ) widget.statusTip=item.statusTip;
        } else {
            borderColor=this.skin.ButtonGroup.NormalBorderColor;
            backColor=this.skin.ButtonGroup.NormalBackColor;
        }

        if ( !VG.context.workspace.mouseTrackerWidget && widget.hasHoverState && item.rect.contains( VG.context.workspace.mousePos) )
        {
            borderColor=this.skin.ButtonGroup.HoverBorderColor;
            backColor=this.skin.ButtonGroup.HoverBackColor;
            if ( item.statusTip ) widget.statusTip=item.statusTip;
        }

        // ---

        if ( i === 0 )
        {
            this.rect2.copy( this.rect1 );

            this.rect2.x+=1; this.rect2.width-=1;
            this.rect2.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.y+=this.rect1.height-1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.copy( this.rect1 );
            this.rect2.y+=1; this.rect2.height-=2;
            this.rect2.width=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.copy( this.rect1 );
            this.rect2.x+=1; this.rect2.width-=1;
            this.rect2.y+=1; this.rect2.height-=2;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, backColor );
        } else
        if ( i === widget.items.length - 1 )
        {
            this.rect2.copy( this.rect1 );

            this.rect2.width-=1;
            this.rect2.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.y+=this.rect1.height-1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.copy( this.rect1 );
            this.rect2.y+=1; this.rect2.height-=2;
            this.rect2.x+=this.rect1.width - 1; this.rect2.width=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.copy( this.rect1 );
            this.rect2.width-=1;
            this.rect2.y+=1; this.rect2.height-=2;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, backColor );
        } else
        {
            this.rect2.copy( this.rect1 );

            this.rect2.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.y+=this.rect1.height-1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, borderColor );

            this.rect2.copy( this.rect1 );
            this.rect2.y+=1; this.rect2.height-=2;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, backColor );
        }

        item.rect.copy( this.rect1 );

        this.rect2.copy( this.rect1 );

        var iconAdder=0;

        if ( item.icon ) {
            this.rect2.x+=5;
            this.rect2.y=widget.rect.y + (widget.rect.height - item.icon.height)/2;
            canvas.drawImage( this.rect2, item.icon );
        } else if ( item.svgName )
        {
            var svg=VG.Utils.getSVGByName( item.svgName );

            iconAdder=10;
            this.rect2.x+=5;
            this.rect2.y=widget.rect.y + (widget.rect.height - 15)/2;
            this.rect2.width=15;
            this.rect2.height=15;

            svgGroup=svg.getGroupByName( item.svgGroupName );
            canvas.drawSVG( svg, svgGroup, this.rect2, this.skin.Widget.TextColor );
        }

        this.rect2.copy( this.rect1 );

        this.rect2.x+=7 + iconAdder;
        this.rect2.width-=14 + iconAdder;

        canvas.drawTextRect( item.text, this.rect2, this.skin.ButtonGroup.TextColor, 1, 1 );

        this.rect1.x+=this.rect1.width + 1;
    }

    canvas.popFont();

    if ( widget.disabled ) canvas.setAlpha( 1 );
};


// --- CheckBox

VG.UI.VisualGraphicsStyle.prototype.drawCheckBox=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );

    var imageName="checkbox";

    if ( widget.hasFocusState ) imageName+="_focus";
    if ( widget.hasHoverState ) imageName+="_hover";

    if ( widget.checked ) imageName+="_checked";

    imageName+=".png";

    var image=VG.Utils.getImageByName( imageName );

    if ( image )
        canvas.drawImage( VG.Core.Point( widget.rect.x + (widget.rect.width-image.width)/2, widget.rect.y + (widget.rect.height-image.height)/2), image );

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- ContextMenu

VG.UI.VisualGraphicsStyle.prototype.drawContextMenu=function( widget, canvas )
{
    canvas.pushFont( this.skin.ContextMenu.Font );

    if ( canvas.twoD )
        canvas.clearGLRect( widget.rect );

    widget.rect.shrink( 1, 1, widget.contentRect );

    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, widget.rect, this.skin.ContextMenu.BorderColor );

    widget.rect.shrink( 1, 1, this.rect1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ContextMenu.BackColor );

    var itemHeight=canvas.getLineHeight() + 4;

    var rect=widget.contentRect;
    var y=widget.contentRect.y;

    for( var i=0; i < widget.items.length; ++i )
    {
        var item=widget.items[i];

        if ( !item.isSeparator ) {
            this.rect1.set( rect.x, y, rect.width, itemHeight );
            this.rect1.round();

            if ( item.disabled ) {
                canvas.drawTextRect( item.text, this.rect1.add( 10, 0, -10, 0, this.rect2 ), this.skin.ContextMenu.DisabledTextColor, 0, 1 );
            } else
            if ( item === widget.selected )  {
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ContextMenu.HighlightedBackColor );
                canvas.drawTextRect( item.text, this.rect1.add( 10, 0, -10, 0, this.rect2 ), this.skin.ContextMenu.HighlightedTextColor, 0, 1 );
            } else {
                canvas.drawTextRect( item.text, this.rect1.add( 10, 0, -10, 0, this.rect2 ), this.skin.ContextMenu.TextColor, 0, 1 );
            }

            if ( item.checkable && item.checked ) {
                var imageName="checkmark";
                if ( item.checked ) imageName+="_checked";
                imageName+=".png";

                var image=VG.context.imagePool.getImageByName( imageName );
                if ( image ) {
                    canvas.drawImage( VG.Core.Point( this.rect1.right() - image.width - 10, this.rect1.y + (this.rect1.height-image.height)/2), image );
                }
            }

            if ( item.shortcut ) {

                var textColor=this.skin.ContextMenu.TextColor;
                if ( item.disabled ) textColor=this.skin.ContextMenu.DisabledTextColor;
                var shortCutSize=canvas.getTextSize( item.shortcut.text );
                this.rect3.set( this.rect1.right() - shortCutSize.width - 10, this.rect1.y, shortCutSize.width, this.rect1.height );
                canvas.drawTextRect( item.shortcut.text, this.rect3, textColor, 0, 1 );
            }

            item._rect.set( this.rect1 );
            y+=itemHeight;
        } else {
            this.rect1.set( rect.x, y, rect.width, 1 );
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ContextMenu.SeparatorColor );

            y++;
        }
    }

    canvas.popFont();
};

// --- DecoratedToolBar

VG.UI.VisualGraphicsStyle.prototype.drawDecoratedToolBar=function( widget, canvas )
{
    // --- Background
    this.rect1.copy( widget.rect ); this.rect1.height=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.TopBorderColor );

    this.rect1.y+=widget.rect.height-1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.BottomBorderColor );

    widget.contentRect.set( widget.rect );
    widget.contentRect.y+=1; widget.contentRect.height-=2;

    this.rect1.copy( widget.contentRect );
    this.rect1.height/=2;
    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.DecoratedToolBar.BackGradColor1, this.skin.DecoratedToolBar.BackGradColor2 );
    this.rect1.y+=this.rect1.height;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.BackGradColor2 );
};

// --- DecoratedToolSeparator

VG.UI.VisualGraphicsStyle.prototype.drawDecoratedToolSeparator=function( widget, canvas )
{
    this.rect1.copy( widget.rect );
    this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.Separator.Color1 );
    this.rect1.x+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.Separator.Color2 );
};

// --- DecoratedQuickMenuButton

VG.UI.VisualGraphicsStyle.prototype.drawDecoratedQuickMenu=function( widget, canvas )
{
    // --- Draw SubMenu

    function drawSubMenu( rect, menu, style, rect1 )
    {
        var i, item;
        rect.height=0;
        for ( i=0; i < menu.items.length; ++i ) {
            item=menu.items[i];
            if ( item.text && item.text.length ) rect.height+=style.skin.DecoratedQuickMenu.Items.Size.height;
            else rect.height+=0;
        }

        rect.height-=menu.items.length-1;

        menu.itemsRect.copy( rect );

        if ( canvas.twoD )
            canvas.clearGLRect( rect );

        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, style.skin.DecoratedQuickMenu.SubMenuBorderColor );
        rect1.copy( rect );
        rect1.shrink( 1, 1, rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect1, style.skin.DecoratedQuickMenu.BackgroundColor );

        rect.height=style.skin.DecoratedQuickMenu.Items.Size.height;

        for ( i=0; i < menu.items.length; ++i )
        {
            item=menu.items[i];

            rect1.copy( rect );
            item.rect.copy( rect );

            if ( menu.index === i && !item.disabled && item.text && item.text.length ) {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, style.skin.DecoratedQuickMenu.BorderColor );

                rect1.shrink( 1, 1, rect1 );
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, rect1, style.skin.DecoratedQuickMenu.Items.BackGradSelectionColor1, style.skin.DecoratedQuickMenu.Items.BackGradSelectionColor2 );

                rect1.copy( rect );
            }

            rect1.x+=70; rect1.width=style.skin.DecoratedQuickMenu.Items.Size.width - 70;

            if ( item.text && item.text.length )
            {
                if ( !item.disabled ) canvas.drawTextRect( item.text, rect1, style.skin.DecoratedQuickMenu.Items.TextColor, 0, 1 );
                else canvas.drawTextRect( item.text, rect1, style.skin.DecoratedQuickMenu.Items.DisabledTextColor, 0, 1 );
                rect.y+=style.skin.DecoratedQuickMenu.Items.Size.height-1;
            } else {
                // --- Separator
                rect1.copy( rect );
                rect1.y+=0; rect1.height=1;
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect1, style.skin.DecoratedQuickMenu.Items.TextColor );

                rect.y+=-1;
            }
        }
    }

    // ---

    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );

    // --- Calc Height

    var contentHeight=this.skin.DecoratedQuickMenu.ContentMargin.top + this.skin.DecoratedQuickMenu.ContentMargin.bottom;
    var i, item;

    for ( i=0; i < widget.items.length; ++i ) {
        item=widget.items[i];
        if ( item.text && item.text.length ) contentHeight+=this.skin.DecoratedQuickMenu.Items.Size.height;
        else contentHeight+=0;
    }

    contentHeight-=widget.items.length-1;

    // --- Logo

    let appLogo = VG.context.workspace.appLogo, mousePos = VG.context.workspace.mousePos;

    this.rect1.x = 0; this.rect1.y = 0;
    this.rect1.width = appLogo.rect.width; this.rect1.height = appLogo.rect.height;

    if ( widget.open ) canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedQuickMenu.ButtonBackgroundSelectedColor );
    else if ( mousePos.x < appLogo.rect.width && mousePos.y < appLogo.rect.height && !VG.context.workspace.windows.length ) canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedQuickMenu.ButtonBackgroundHoverColor );
    else canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedQuickMenu.ButtonBackgroundColor );

    this.rect1.x = 0; this.rect1.y = appLogo.rect.height - 1;
    this.rect1.width = appLogo.rect.width; this.rect1.height = 1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.BottomBorderColor );

    this.rect1.x = appLogo.rect.width - 1; this.rect1.y = 0;
    this.rect1.width = 1; this.rect1.height = appLogo.rect.height;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedToolBar.BottomBorderColor );

    if ( appLogo.image.isValid() ) {
        let x = Math.round( ( appLogo.rect.width - appLogo.image.width ) / 2 ), y = Math.round( ( appLogo.rect.height - appLogo.image.height ) / 2 ) - 1;
        if ( !appLogo.canvasImage ) {
            canvas.drawImage( { x: x, y: y }, appLogo.image );
            VG.Utils.imageToHTML5Image( appLogo.image, ( image ) => {
                appLogo.canvasImage = image;
            } );
        } else {
            canvas.ctx.drawImage( appLogo.canvasImage, x, y );
        }
    }

    // --- Stripes

    this.rect1.x = appLogo.rect.width - 14;
    this.rect1.y = appLogo.rect.height - 11;
    this.rect1.width = 10;
    this.rect1.height = 1;

    for ( let i = 0; i < 3; ++i ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DecoratedQuickMenu.StripeColor );
        this.rect1.y += 3;
    }

    // --- Menu

    if ( widget.open )
    {
        canvas.pushFont( this.skin.DecoratedQuickMenu.Items.Font );

        this.rect2.x = 0; this.rect2.y = appLogo.rect.height;
        this.rect2.width = this.skin.DecoratedQuickMenu.Items.Size.width; this.rect2.height = contentHeight;

        widget.popupRect.copy( this.rect2 );

        if ( canvas.twoD )
            canvas.clearGLRect( this.rect2 );

        this.rect1.copy( this.rect2 );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect2, this.skin.DecoratedQuickMenu.BorderColor );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2.add( 1, 1, -2, -2 ), this.skin.DecoratedQuickMenu.BackgroundColor );

        this.rect1.add( this.skin.DecoratedQuickMenu.ContentMargin.left, this.skin.DecoratedQuickMenu.ContentMargin.top,
            -2 * this.skin.DecoratedQuickMenu.ContentMargin.right, 0, this.rect1 );
        this.rect1.height=this.skin.DecoratedQuickMenu.Items.Size.height;

        for ( i=0; i < widget.items.length; ++i )
        {
            item=widget.items[i];

            this.rect2.copy( this.rect1 );
            item.rect.copy( this.rect1 );

            var cy=this.rect2.y;

            if ( widget.index === i && !item.disabled && item.text && item.text.length ) {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect2, this.skin.DecoratedQuickMenu.BorderColor );

                this.rect2.shrink( 1, 1, this.rect2 );
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.DecoratedQuickMenu.Items.BackGradSelectionColor1, this.skin.DecoratedQuickMenu.Items.BackGradSelectionColor2 );

                this.rect2.copy( this.rect1 );
            }

            this.rect2.x+=70; this.rect2.width=this.skin.DecoratedQuickMenu.Items.Size.width - 70;

            if ( item.text && item.text.length )
            {
                if ( !item.disabled ) canvas.drawTextRect( item.text, this.rect2, this.skin.DecoratedQuickMenu.Items.TextColor, 0, 1 );
                else canvas.drawTextRect( item.text, this.rect2, this.skin.DecoratedQuickMenu.Items.DisabledTextColor, 0, 1 );
                this.rect1.y+=this.skin.DecoratedQuickMenu.Items.Size.height-1;
            } else {
                // --- Separator
                this.rect2.copy( this.rect1 );
                this.rect2.y+=0; this.rect2.height=1;
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.DecoratedQuickMenu.Items.TextColor );

                this.rect1.y+=-1;
            }

            if ( item.items.length && widget.index === i && !item.disabled && item.text && item.text.length ) {
                // --- SubMenu
                this.rect2.copy( this.rect1 );
                this.rect2.y=cy; this.rect2.x=widget.rect.right();
                drawSubMenu( this.rect2, item, this, this.rect3 );
            }
        }

        canvas.popFont();
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- DockWidget

VG.UI.VisualGraphicsStyle.prototype.drawDockWidget=function( widget, canvas )
{
    widget.contentRect.set( widget.rect );
    if ( widget.location === VG.UI.DockWidgetLocation.Floating ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, widget.contentRect, this.skin.DockWidget.FloatingBorderColor );
        widget.contentRect.shrink( 1,1, widget.contentRect );
    }

    // --- Draw Header

    this.rect1.set( widget.contentRect ); this.rect1.height=this.skin.DockWidget.HeaderHeight;
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect1, this.skin.DockWidget.HeaderBorderColor );
    this.rect1.shrink( 1, 1, this.rect1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.DockWidget.HeaderBackGradColor1, this.skin.DockWidget.HeaderBackGradColor2 );

    this.rect2.set( this.rect1 );
    canvas.pushFont( this.skin.DockWidget.HeaderFont );
    this.rect2.add( 30, 0, -30, 0, this.rect2 );
    canvas.drawTextRect( widget.text, this.rect2, this.skin.DockWidget.HeaderTextColor, 0, 1 );
    canvas.popFont();

    var imageName="darrow_";
    if ( widget.rightIndicator ) imageName+="right.png";
    else imageName+="left.png";

    var image=VG.context.imagePool.getImageByName( imageName );

    if ( image ) {
        this.rect2.set( this.rect1 );

        if ( widget.rightIndicator ) {
            this.rect2.x+=this.rect2.width - 14; this.rect2.width=image.width;
        } else {
            this.rect2.x+=6; this.rect2.width=image.width;
        }

        this.rect2.y+=(this.rect2.height-image.height)/2; this.rect2.height=image.height;
        canvas.drawImage( this.rect2, image );
    }

    // ---

    widget.contentRect.add( 0, this.skin.DockWidget.HeaderHeight, 0, -this.skin.DockWidget.HeaderHeight, widget.contentRect );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.DockWidget.BackColor );
};

// --- DropDownMenu

VG.UI.VisualGraphicsStyle.prototype.drawDropDownMenu=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    // --- Border
/*
    if ( widget.hasFocusState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, this.skin.DropDownMenu.FocusBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.DropDownMenu.FocusBorderColor );

        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.DropDownMenu.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    } else
    {
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        if ( widget.hasHoverState ) canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.DropDownMenu.HoverBorderColor );
        else canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.DropDownMenu.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    }

    // --- Background

    if ( widget.popup || widget.mouseIsDown ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.DropDownMenu.BackGradColor2, this.skin.DropDownMenu.BackGradColor1 );
    } else
    if ( widget.hasHoverState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.DropDownMenu.HoverBackGradColor1, this.skin.DropDownMenu.HoverBackGradColor2 );
    } else
    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.DropDownMenu.BackGradColor1, this.skin.DropDownMenu.BackGradColor2 );
*/

    widget.contentRect.shrink( 1, 1, widget.contentRect );

    let lingrad = canvas.ctx.createLinearGradient( 0, widget.contentRect.y,0, widget.contentRect.bottom() );

    if ( widget.popup || widget.mouseIsDown ) {
        lingrad.addColorStop( 0, this.skin.DropDownMenu.BackGradColor2.canvasStyle );
        lingrad.addColorStop( 1, this.skin.DropDownMenu.BackGradColor1.canvasStyle );
    } else
    if ( widget.hasHoverState ) {
        lingrad.addColorStop( 0, this.skin.DropDownMenu.HoverBackGradColor1.canvasStyle );
        lingrad.addColorStop( 1, this.skin.DropDownMenu.HoverBackGradColor2.canvasStyle );
    } else {
        lingrad.addColorStop( 0, this.skin.DropDownMenu.BackGradColor1.canvasStyle );
        lingrad.addColorStop( 1, this.skin.DropDownMenu.BackGradColor2.canvasStyle );
    }

    canvas.drawShape( "RoundedRect", widget.contentRect, {
        fillStyle: lingrad,
        strokeStyle: widget.hasFocusState ?  this.skin.DropDownMenu.FocusBorderColor.canvasStyle : this.skin.DropDownMenu.BorderColor.canvasStyle,
        strokeWidth : widget.hasFocusState ? 2 : 1,
        radius: 3 } );

    widget.contentRect.shrink( 2, 2, widget.contentRect );

    // --- Separator / Triangle

    this.rect1.copy( widget.contentRect );
    this.rect1.x+=this.rect1.width-16; this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DropDownMenu.SepColor1 );
    this.rect1.x+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DropDownMenu.SepColor2 );

    // --- Triangle

    this.rect1.copy( widget.contentRect );
    this.rect1.x+=this.rect1.width - 11; this.rect1.y+=6;
    this.rect1.width=9; this.rect1.height=6;
    canvas.draw2DShape( VG.Canvas.Shape2D.FlippedTriangle, this.rect1.round(), this.skin.DropDownMenu.TextColor );

    // --- List

    canvas.pushFont( this.skin.DropDownMenu.Font );

    this.rect1.copy( widget.rect );
    if ( widget.popup )
    {
        var itemHeight=canvas.getLineHeight() + 2;
        var popupHeight=widget.items.length * itemHeight + widget.items.length + 1;
        this.rect2.set( this.rect1.x, this.rect1.bottom(), this.rect1.width, popupHeight );

        // --- Check if Menu is beneath or above the button depending on workspace height

        widget.menuDown=!widget.menuIsUp;
        if ( ( popupHeight + widget.rect.bottom() ) > VG.context.workspace.rect.bottom() )
            widget.menuDown=false;

        if ( widget.menuDown ) this.rect2.set( this.rect1.x, this.rect1.bottom(), this.rect1.width, popupHeight );
        else this.rect2.set( this.rect1.x, this.rect1.y - popupHeight, this.rect1.width, popupHeight );

        // ---

        if ( canvas.twoD )
            canvas.clearGLRect( this.rect2 );

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.DropDownMenu.ItemBorderColor );
        widget.popupRect.copy( this.rect2 );

        this.rect2.height=itemHeight;
        this.rect2.shrink( 1, 0, this.rect2 );

        var y=this.rect2.y+1;

        for( var i=0; i < widget.items.length; ++i )
        {
            this.rect1.set( this.rect2 );
            this.rect1.y=y;

            if ( i === widget.index )
            {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect1, this.skin.DropDownMenu.FocusBorderColor );
                this.rect1.shrink( 1, 1, this.rect1 );
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DropDownMenu.ItemSelectedBackColor );

                this.rect1.shrink( 7, 0, this.rect1 );
                canvas.drawTextRect( widget.items[i], this.rect1, this.skin.DropDownMenu.ItemSelectedTextColor, 0, 1 );
            } else {
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DropDownMenu.ItemBackColor );

                this.rect1.shrink( 7, 0, this.rect1 );
                canvas.drawTextRect( widget.items[i], this.rect1, this.skin.DropDownMenu.ItemTextColor, 0, 1 );
            }

            y+=itemHeight + 1;
        }

        widget.itemHeight=itemHeight + 1;
    }

    // --- Main Text

    this.rect1.copy( widget.contentRect );
    this.rect1.x+=7; this.rect1.width-=7 + 16 +1;

    if ( widget.index !== -1 )
        canvas.drawTextRect( widget.items[widget.index], this.rect1, this.skin.DropDownMenu.TextColor, 0, 1 );

    canvas.popFont();

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- Frame

VG.UI.VisualGraphicsStyle.prototype.drawFrame=function( widget, canvas )
{
    widget.contentRect.set( widget.rect );

    if ( widget.frameType === VG.UI.Frame.Type.Box )
    {
        var color;

        if ( widget.hasFocusState ) color=this.skin.Widget.FocusColor;
        else color=this.skin.TextEdit.BorderColor1;
        canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangleOutline1px, widget.rect, color );

        widget.contentRect.shrink( 1, 1, this.contentRect );
    }
};

// --- IconWidget

VG.UI.VisualGraphicsStyle.prototype.drawIconWidget=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    // --- Border

    if ( widget.hasFocusState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, this.skin.IconWidget.FocusBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.IconWidget.FocusBorderColor );

        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.IconWidget.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    } else
    {
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        if ( widget.hasHoverState ) canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.IconWidget.HoverBorderColor );
        else canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.IconWidget.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    }

    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.IconWidget.BackColor );

    // ---

    if ( !widget.controller ) { if ( widget.disabled ) canvas.setAlpha( 1 ); return; }

    if ( widget.toolLayout.length > 0 ) widget.contentRect.height-=this.skin.IconWidget.ToolLayoutHeight;

    widget.contentRect.x+=this.skin.IconWidget.Margin.left;
    widget.contentRect.y+=this.skin.IconWidget.Margin.top;
    widget.contentRect.width-=2*this.skin.IconWidget.Margin.right;
    widget.contentRect.height-=2*this.skin.IconWidget.Margin.bottom;

    canvas.pushClipRect( widget.contentRect );

    if ( !widget.verified || canvas.hasBeenResized )
        widget.verifyScrollbar();

    // ---

    this.rect2.copy( widget.contentRect );
    var paintRect=this.rect2;
    paintRect.width=widget._itemSize.width;

    canvas.pushFont( this.skin.IconWidget.Font );

    paintRect.y=widget.contentRect.y - widget.offset;

    for ( var r=0; r < widget.rows; ++r )
    {
        var x=paintRect.x;

        for ( var i=0; i < widget.itemsPerRow; ++i )
        {
            var itemIndex=widget.itemsPerRow * r + i;
            if ( itemIndex >= widget.controller.count() ) break;

            var item=widget.controller.at( itemIndex );
            if ( !item.visible ) continue;

            var isSelected=widget.controller.isSelected( item );

            // ---

            if ( paintRect.y + widget._itemSize.height >= widget.contentRect.y )
            {
                this.rect1.copy( paintRect );
                this.rect1.height=91;

                if ( !isSelected ) {
                    // canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1, this.skin.IconWidget.ItemBackColor );
                    // canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1.shrink( 15, 15, this.rect1 ), this.skin.IconWidget.ItemBackColor );
                    // this.rect1.shrink( 1, 1, this.rect1 );

                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.IconWidget.ItemBackColor );
                    // canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1.shrink( 15, 15, this.rect1 ), this.skin.IconWidget.ItemBackColor );
                    this.rect1.shrink( widget._margin.width + 1, widget._margin.height + 1, this.rect1 );
                } else {
                    // canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1, this.skin.IconWidget.ItemSelectedBorderColor );
                    //canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1.shrink( 15, 15, this.rect1 ), this.skin.IconWidget.ItemSelectedBackColor );
                    // canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1.shrink( 1, 1, this.rect1 ), this.skin.IconWidget.ItemSelectedBackColor );


                    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1, this.skin.IconWidget.ItemSelectedBorderColor );
                    //canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1.shrink( 15, 15, this.rect1 ), this.skin.IconWidget.ItemSelectedBackColor );
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1.shrink( 1, 1, this.rect1 ), this.skin.IconWidget.ItemSelectedBackColor );
                    this.rect1.shrink( widget._margin.width, widget._margin.height, this.rect1 );
                }

                if ( widget.paintItemCallback ) widget.paintItemCallback( canvas, item, this.rect1, isSelected );
                else {

                }

                this.rect1.copy( paintRect ); this.rect1.y+=97; //this.rect1.height;
                canvas.drawTextRect( item.text, this.rect1, this.skin.IconWidget.TextColor, 1, 0 );
            }
            paintRect.x+=widget._itemSize.width + widget.spacing.width;
        }

        paintRect.x=x;
        paintRect.y+=widget._itemSize.height +  widget.spacing.height;
        if ( paintRect.y > widget.contentRect.bottom() ) break;
    }

    canvas.popFont();

    if ( widget.needsVScrollbar ) {
        widget.vScrollbar.rect=VG.Core.Rect( widget.contentRect.right() - this.skin.ScrollBar.Size,
            widget.contentRect.y, this.skin.ScrollBar.Size, widget.contentRect.height );

        // this.totalItemHeight == Total height of all Items in the list widget including spacing
        // visibleHeight == Total height of all currently visible items
        // this.contentRect.height == Height of the available area for the list items

        widget.vScrollbar.setScrollBarContentSize( widget.totalItemHeight, widget.contentRect.height );
        widget.vScrollbar.paintWidget( canvas );
    }

    canvas.popClipRect();

    // --- Draw Tools

    if ( widget.toolLayout.length > 0 ) {
        this.rect1.copy( widget.rect ); this.rect1.shrink( 2, 2, this.rect1 );
        this.rect1.y+=this.rect1.height - this.skin.IconWidget.ToolLayoutHeight;
        this.rect2.copy( this.rect1 );
        this.rect1.height=1;//this.skin.IconWidget.ToolLayoutHeight;

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.IconWidget.ToolTopBorderColor );

        this.rect1.y+=1; this.rect1.height=this.skin.IconWidget.ToolLayoutHeight-2;
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.IconWidget.ToolBackGradColor1, this.skin.IconWidget.ToolBackGradColor2 );

        this.rect1.y+=this.rect1.height; this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.IconWidget.ToolBottomBorderColor );

        this.rect2.height=this.skin.IconWidget.ToolLayoutHeight;
        this.rect2.shrink( 1, 1, this.rect2 );
        widget.toolLayout.rect.copy( this.rect2 );

        widget.toolLayout.layout( canvas );
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- ListWidget

VG.UI.VisualGraphicsStyle.prototype.drawListWidget=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    // --- Border

    if ( widget.hasFocusState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, this.skin.ListWidget.FocusBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.ListWidget.FocusBorderColor );

        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ListWidget.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    } else
    {
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        if ( widget.hasHoverState ) canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ListWidget.HoverBorderColor );
        else canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ListWidget.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
    }

    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ListWidget.BackColor );

    // ---

    if ( !widget.controller ) { if ( widget.disabled ) canvas.setAlpha( 1 ); return; }

    if ( widget.toolLayout.length > 0 ) widget.contentRect.height-=this.skin.ListWidget.ToolLayoutHeight;

    widget.contentRect.x+=this.skin.ListWidget.Margin.left;
    widget.contentRect.y+=this.skin.ListWidget.Margin.top;
    widget.contentRect.width-=2*this.skin.ListWidget.Margin.right;
    widget.contentRect.height-=2*this.skin.ListWidget.Margin.bottom;

    canvas.pushClipRect( widget.contentRect );

    if ( !widget.verified || canvas.hasBeenResized )
        widget.verifyScrollbar();

    // ---

    this.rect2.copy( widget.contentRect );
    var paintRect=this.rect2;
    paintRect.height=widget.itemHeight;

    if ( widget.needsVScrollbar ) paintRect.width-=this.skin.ScrollBar.Size;

    canvas.pushFont( this.skin.ListWidget.Font );

    paintRect.y=widget.contentRect.y - widget.offset;

    widget.childWidgets=[];
    for ( var i=0; i < widget.controller.count(); ++i ) {
        var item=widget.controller.at( i );
        if ( !item.visible ) continue;

        var isSelected=widget.controller.isSelected( item );

        // --- Insert Potential Child Widgets of Items

        if ( item.childWidgets ) {
            for ( var c=0; c < item.childWidgets.length; ++c ) {
                widget.childWidgets.push( item.childWidgets[c] );
            }
        }

        // ---

        if ( paintRect.y + widget.itemHeight >= widget.contentRect.y )
        {
            this.rect1.copy( paintRect );
            if ( !isSelected ) {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1, this.skin.ListWidget.ItemBackColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1.shrink( 1, 1, this.rect1 ), this.skin.ListWidget.ItemBackColor );
            } else {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1, this.skin.ListWidget.ItemSelectedBorderColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1.shrink( 1, 1, this.rect1 ), this.skin.ListWidget.ItemSelectedBackColor );
            }

            if ( !widget.paintItemCallback ) {
                this.rect1.copy( paintRect ); this.rect1.x+=8; this.rect1.width-=8;
                canvas.drawTextRect( item.text, this.rect1, this.skin.ListWidget.TextColor, 0, 1 );
            } else widget.paintItemCallback( canvas, item, paintRect, isSelected );
        }

        paintRect.y+=widget.itemHeight + widget.spacing;
        if ( paintRect.y > widget.contentRect.bottom() ) break;
    }

    canvas.popFont();

    if ( widget.needsVScrollbar ) {
        widget.vScrollbar.rect=VG.Core.Rect( widget.contentRect.right() - this.skin.ScrollBar.Size,
            widget.contentRect.y, this.skin.ScrollBar.Size, widget.contentRect.height );

        // this.totalItemHeight == Total height of all Items in the list widget including spacing
        // visibleHeight == Total height of all currently visible items
        // this.contentRect.height == Height of the available area for the list items

        widget.vScrollbar.setScrollBarContentSize( widget.totalItemHeight, widget.contentRect.height );
        widget.vScrollbar.paintWidget( canvas );
    }

    canvas.popClipRect();

    // --- Draw Tools

    if ( widget.toolLayout.length > 0 ) {
        this.rect1.copy( widget.rect ); this.rect1.shrink( 2, 2, this.rect1 );
        this.rect1.y+=this.rect1.height - this.skin.ListWidget.ToolLayoutHeight;
        this.rect2.copy( this.rect1 );
        this.rect1.height=1;//this.skin.ListWidget.ToolLayoutHeight;

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ListWidget.ToolTopBorderColor );

        this.rect1.y+=1; this.rect1.height=this.skin.ListWidget.ToolLayoutHeight-2;
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.ListWidget.ToolBackGradColor1, this.skin.ListWidget.ToolBackGradColor2 );

        this.rect1.y+=this.rect1.height; this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ListWidget.ToolBottomBorderColor );

        this.rect2.height=this.skin.ListWidget.ToolLayoutHeight;
        this.rect2.shrink( 1, 1, this.rect2 );
        widget.toolLayout.rect.copy( this.rect2 );

        widget.toolLayout.layout( canvas );
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- ScrollBar

VG.UI.VisualGraphicsStyle.prototype.drawMenu=function( widget, canvas )
{
    canvas.pushFont( this.skin.Menu.Font );

    widget.contentRect.x=widget.rect.x;
    widget.contentRect.y=widget.parent.rect.bottom() + 1;

    widget.contentRect.setSize( widget.calcSize( canvas ) );

    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, widget.contentRect, this.skin.Menu.BorderColor );
    widget.contentRect.shrink( 1, 1, widget.contentRect );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.Menu.BackColor );

    var itemHeight=canvas.getLineHeight() + 7;

    var rect=widget.contentRect;
    var y=widget.contentRect.y;

    for( var i=0; i < widget.items.length; ++i )
    {
        var item=widget.items[i];

        if ( !item.isSeparator ) {
            var itemRect=VG.Core.Rect( rect.x, y, rect.width, itemHeight ).round();

            if ( item.disabled ) {
                canvas.drawTextRect( item.text, itemRect.add( 10, 0, -10, 0, this.rect2), this.skin.Menu.DisabledTextColor, 0, 1 );
            } else
            if ( item === widget.selected )  {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, itemRect, this.skin.Menu.HighlightedBorderColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, itemRect.shrink(1, 1, this.rect2), this.skin.Menu.HighlightedBackColor );
                canvas.drawTextRect( item.text, itemRect.add( 10, 0, -10, 0, this.rect2 ), this.skin.Menu.HighlightedTextColor, 0, 1 );
            } else {
                canvas.drawTextRect( item.text, itemRect.add( 10, 0, -10, 0, this.rect2), this.skin.Menu.TextColor, 0, 1 );
            }

            if ( item.checkable ) {
                var iconName="checkmark";

                if ( item.checked ) iconName+="_checked";
                iconName+=".png";

                var image=VG.Utils.getImageByName( iconName );
                if ( image ) canvas.drawImage( VG.Core.Point( itemRect.right() - image.width - 10, itemRect.y + (itemRect.height-image.height)/2), image );
            }

            if ( item.shortcut ) {
                canvas.pushFont( this.skin.Menu.ShortcutFont );

                var textColor=this.skin.Menu.TextColor;
                if ( item.disabled ) textColor=this.skin.Menu.DisabledTextColor;
                var shortCutSize=canvas.getTextSize( item.shortcut.text );
                canvas.drawTextRect( item.shortcut.text, VG.Core.Rect( itemRect.right() - shortCutSize.width - 10, itemRect.y, shortCutSize.width, itemRect.height ), textColor, 0, 1 );

                canvas.popFont();
            }

            item._rect=itemRect;
            y+=itemHeight;
        } else {
            var sepRect=VG.Core.Rect( rect.x+1, y, rect.width-2, 1 ).round();
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, sepRect, this.skin.Menu.SeparatorColor );

            y++;
        }
    }

    this.itemHeight=itemHeight;

    canvas.popFont();
};

// --- MenuBar

VG.UI.VisualGraphicsStyle.prototype.drawMenuBar=function( widget, canvas )
{
    widget.contentRect.set( widget.rect );

    widget.contentRect.height=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.MenuBar.TopBorderColor );
    widget.contentRect.y+=widget.rect.height-1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.MenuBar.BottomBorderColor );

    widget.rect.shrink( 0, 1, widget.contentRect );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.MenuBar.BackColor );

    canvas.pushFont( this.skin.MenuBar.Font );

    var rect=this.rect1; widget.rect.shrink( 0, this.skin.MenuBar.BorderSize, this.rect1 );// this.rect1.set( widget.rect );
    var size=this.rect2;

    for( var i=0; i < widget.items.length; ++i )
    {
        var item=widget.items[i];

        rect.x+=12;
        rect.width=canvas.getTextSize( item.text, size ).width + 2 * 12;

        if ( item === widget.active ) {
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, this.skin.MenuBar.SelectedBackColor );
            canvas.drawTextRect( item.text, rect, this.skin.MenuBar.SelectedTextColor, 1, 1 );
        } else {
            canvas.drawTextRect( item.text, rect, this.skin.MenuBar.TextColor, 1, 1 );
        }

        item.rect.set( rect );
        rect.x+=size.width+12;
    }

    canvas.popFont();
};


// --- ScrollBar

VG.UI.VisualGraphicsStyle.prototype.drawScrollBar=function( widget, canvas, adjustAlpha )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    if ( adjustAlpha ) canvas.setAlpha( 0.5 );

    if ( VG.context.twoDOnTop ) {
        canvas.ctx.clearRect( widget.contentRect.x, widget.contentRect.y, widget.contentRect.width, widget.contentRect.height );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleGL, widget.contentRect, this.skin.ScrollBar.BackColor );
    } else {
        if ( !adjustAlpha )
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ScrollBar.BackColor );
    }

    if ( widget.direction === VG.UI.ScrollBar.Direction.Vertical )
    {
        if ( widget.contentRect.height <= 10 ) { if ( adjustAlpha ) canvas.setAlpha( 1.0 ); return; }

        // --- Vertical

        this.rect1.copy( widget.rect ); this.rect1.width=1;
        if ( !adjustAlpha )
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ScrollBar.BorderColor );

        seg1ImageName="scrollbar_vtop";
        seg2ImageName="scrollbar_vmiddle";
        seg3ImageName="scrollbar_vbottom";

        if (  VG.context.workspace.mouseTrackerWidget === widget ) {
            seg1ImageName+="_selected"; seg2ImageName+="_selected"; seg3ImageName+="_selected";
        } else
        if ( !VG.context.workspace.mouseTrackerWidget && widget.handleRect.contains( VG.context.workspace.mousePos ) ) {
            seg1ImageName+="_hover"; seg2ImageName+="_hover"; seg3ImageName+="_hover";
        }

        if ( !this.skin.ScrollBar[seg1ImageName] )
            this.skin.ScrollBar[seg1ImageName]=VG.context.imagePool.getImageByName( seg1ImageName + ".png" );
        if ( !this.skin.ScrollBar[seg2ImageName] )
            this.skin.ScrollBar[seg2ImageName]=VG.context.imagePool.getImageByName( seg2ImageName + ".png" );
        if ( !this.skin.ScrollBar[seg3ImageName] )
            this.skin.ScrollBar[seg3ImageName]=VG.context.imagePool.getImageByName( seg3ImageName + ".png" );

        // ---

        this.rect2.copy( widget.handleRect ); this.rect2.round();
        this.rect2.x+=2; this.rect2.width-=3;

        if ( this.rect2.height >= 10 ) {
            if ( this.skin.ScrollBar[seg1ImageName] ) canvas.drawImage( this.rect2, this.skin.ScrollBar[seg1ImageName] );

            this.rect2.y+=5; this.rect2.height-=10;
            if ( this.skin.ScrollBar[seg2ImageName] ) canvas.drawTiledImage( this.rect2, this.skin.ScrollBar[seg2ImageName], false, true );

            this.rect2.y+=this.rect2.height; this.rect2.height=5;
            if ( this.skin.ScrollBar[seg3ImageName] ) canvas.drawImage( this.rect2, this.skin.ScrollBar[seg3ImageName] );
        } else if ( this.skin.ScrollBar[seg2ImageName] ) canvas.drawTiledImage( this.rect2, this.skin.ScrollBar[seg2ImageName], false, true );
    } else
    if ( widget.direction === VG.UI.ScrollBar.Direction.Horizontal )
    {
        if ( widget.contentRect.width <= 10 ) { if ( adjustAlpha ) canvas.setAlpha( 1.0 ); return; }

        // --- Horizontal

        this.rect1.copy( widget.rect ); this.rect1.height=1;
        if ( !adjustAlpha )
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ScrollBar.BorderColor );

        seg1ImageName="scrollbar_hleft";
        seg2ImageName="scrollbar_hmiddle";
        seg3ImageName="scrollbar_hright";

        if (  VG.context.workspace.mouseTrackerWidget === widget ) {
            seg1ImageName+="_selected"; seg2ImageName+="_selected"; seg3ImageName+="_selected";
        } else
        if ( !VG.context.workspace.mouseTrackerWidget && widget.handleRect.contains( VG.context.workspace.mousePos ) ) {
            seg1ImageName+="_hover"; seg2ImageName+="_hover"; seg3ImageName+="_hover";
        }

        if ( !this.skin.ScrollBar[seg1ImageName] )
            this.skin.ScrollBar[seg1ImageName]=VG.context.imagePool.getImageByName( seg1ImageName + ".png" );
        if ( !this.skin.ScrollBar[seg2ImageName] )
            this.skin.ScrollBar[seg2ImageName]=VG.context.imagePool.getImageByName( seg2ImageName + ".png" );
        if ( !this.skin.ScrollBar[seg3ImageName] )
            this.skin.ScrollBar[seg3ImageName]=VG.context.imagePool.getImageByName( seg3ImageName + ".png" );

        // ---

        this.rect2.copy( widget.handleRect ); this.rect2.round();
        this.rect2.y+=2; this.rect2.height-=3;

        if ( this.rect2.width >= 10 ) {

            if ( this.skin.ScrollBar[seg1ImageName] ) canvas.drawImage( this.rect2, this.skin.ScrollBar[seg1ImageName] );

            this.rect2.x+=5; this.rect2.width-=10;
            if ( this.skin.ScrollBar[seg2ImageName] ) canvas.drawTiledImage( this.rect2, this.skin.ScrollBar[seg2ImageName], true, false );

            this.rect2.x+=this.rect2.width; this.rect2.width=5;
            if ( this.skin.ScrollBar[seg3ImageName] ) canvas.drawImage( this.rect2, this.skin.ScrollBar[seg3ImageName] );
        } else if ( this.skin.ScrollBar[seg2ImageName] ) canvas.drawTiledImage( this.rect2, this.skin.ScrollBar[seg2ImageName], true, false );
    }

    if ( widget.disabled || adjustAlpha ) canvas.setAlpha( 1 );
};

// --- SectionBar

VG.UI.VisualGraphicsStyle.prototype.drawSectionBar=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    // --- Draw Header

    this.rect1.set( widget.contentRect ); this.rect1.x+=3; this.rect1.width-=1; this.rect1.height=this.skin.SectionBar.HeaderHeight;
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect1, this.skin.SectionBar.HeaderBorderColor );
    this.rect1.shrink( 1, 1, this.rect1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SectionBar.HeaderBackGradColor1, this.skin.SectionBar.HeaderBackGradColor2 );

    this.rect2.set( this.rect1 );
    canvas.pushFont( this.skin.SectionBar.HeaderFont );
    this.rect2.add( 30, 0, -30, 0, this.rect2 );
    canvas.drawTextRect( widget.text, this.rect2, this.skin.SectionBar.HeaderTextColor, 0, 1 );
    canvas.popFont();

    var imageName="darrow_";
    if ( widget.rightIndicator ) imageName+="right.png";
    else imageName+="left.png";

    var image=VG.context.imagePool.getImageByName( imageName );

    if ( image ) {
        this.rect2.set( this.rect1 );

        if ( widget.rightIndicator ) {
            this.rect2.x+=this.rect2.width - 7 - image.width; this.rect2.width=image.width;
        } else {
            this.rect2.x+=6; this.rect2.width=image.width;
        }

        this.rect2.y+=(this.rect2.height-image.height)/2; this.rect2.height=image.height;
        canvas.drawImage( this.rect2, image );
    }

    // ---

    this.rect1.set( widget.contentRect ); this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SectionBar.BackColor );
    this.rect1.x+=1; this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SectionBar.BorderColor );
    this.rect1.x+=1; this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SectionBar.BackColor );

    widget.contentRect.add( 3, this.skin.SectionBar.HeaderHeight, -3, -this.skin.SectionBar.HeaderHeight, widget.contentRect );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.SectionBar.BackColor );

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- SectionBarButton

VG.UI.VisualGraphicsStyle.prototype.drawSectionBarButton=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    canvas.pushFont( this.skin.SectionBarButton.Font );

    this.rect1.copy( widget.rect );

    if ( widget.stripWidget.activeButton === widget )
    {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, this.rect1, this.skin.SectionBarButton.SelectedBorderColor );
        this.rect1.shrink( 1, 1, this.rect1 );

        this.rect2.copy( this.rect1 );
        this.rect2.height/=2;
        this.rect2.height = Math.round( this.rect2.height );
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.SectionBarButton.SelectedBackGradColor1, this.skin.SectionBarButton.SelectedBackGradColor2 );
        this.rect2.y+=this.rect2.height;
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.SectionBarButton.SelectedBackGradColor2, this.skin.SectionBarButton.SelectedBackGradColor1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, this.rect1, this.skin.SectionBarButton.SelectedBorderColor );

        if ( widget.textArray )
        {
            this.rect1.y-=8;
            canvas.drawTextRect( widget.textArray[0], this.rect1, this.skin.SectionBarButton.SelectedTextColor, 1, 1 );
            this.rect1.y+=16;
            canvas.drawTextRect( widget.textArray[1], this.rect1, this.skin.SectionBarButton.SelectedTextColor, 1, 1 );
        } else
            canvas.drawTextRect( widget.text, this.rect1, this.skin.SectionBarButton.SelectedTextColor, 1, 1 );
    } else
    if ( !VG.context.workspace.mouseTrackerWidget && widget.rect.contains( VG.context.workspace.mousePos ) )
    {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, this.rect1, this.skin.SectionBarButton.HoverBorderColor );
        this.rect1.shrink( 1, 1, this.rect1 );

        this.rect2.copy( this.rect1 );
        this.rect2.height/=2;
        this.rect2.height = Math.round( this.rect2.height );
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.SectionBarButton.HoverBackGradColor1, this.skin.SectionBarButton.HoverBackGradColor2 );
        this.rect2.y+=this.rect2.height;
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.SectionBarButton.HoverBackGradColor2, this.skin.SectionBarButton.HoverBackGradColor1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, this.rect1, this.skin.SectionBarButton.HoverBorderColor );

        if ( widget.textArray )
        {
            this.rect1.y-=8;
            canvas.drawTextRect( widget.textArray[0], this.rect1, this.skin.SectionBarButton.TextColor, 1, 1 );
            this.rect1.y+=16;
            canvas.drawTextRect( widget.textArray[1], this.rect1, this.skin.SectionBarButton.TextColor, 1, 1 );
        } else
            canvas.drawTextRect( widget.text, this.rect1, this.skin.SectionBarButton.TextColor, 1, 1 );
    } else {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, this.rect1, this.skin.SectionBarButton.BorderColor );
        this.rect1.shrink( 1, 1, this.rect1 );

        this.rect2.copy( this.rect1 );
        this.rect2.height/=2;
        this.rect2.height = Math.round( this.rect2.height );
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.SectionBarButton.BackGradColor1, this.skin.SectionBarButton.BackGradColor2 );
        this.rect2.y+=this.rect2.height;
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect2, this.skin.SectionBarButton.BackGradColor2, this.skin.SectionBarButton.BackGradColor1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, this.rect1, this.skin.SectionBarButton.BorderColor );

        if ( widget.textArray )
        {
            this.rect1.y-=8;
            canvas.drawTextRect( widget.textArray[0], this.rect1, this.skin.SectionBarButton.TextColor, 1, 1 );
            this.rect1.y+=16;
            canvas.drawTextRect( widget.textArray[1], this.rect1, this.skin.SectionBarButton.TextColor, 1, 1 );
        } else
            canvas.drawTextRect( widget.text, this.rect1, this.skin.SectionBarButton.TextColor, 1, 1 );
    }

    canvas.popFont();
    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- SectionBarSwitch

VG.UI.VisualGraphicsStyle.prototype.drawSectionBarSwitch=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    var style=this;
    function drawButton( rect, selected, text )
    {
        var borderColor=style.skin.SectionToolBarButton.BorderColor;
        var backColor;

        if ( selected ) {
            borderColor=style.skin.SectionToolBarButton.BorderSelectedColor;
            backColor=style.skin.SectionToolBarButton.BackSelectedColor;
        }
        else
        if ( !VG.context.workspace.mouseTrackerWidget && rect.contains( VG.context.workspace.mousePos ) ) {
            borderColor=style.skin.SectionToolBarButton.BorderHoverColor;
            backColor=style.skin.SectionToolBarButton.BackHoverColor;
        }

        if ( backColor ) canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, backColor );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, rect, borderColor );

        canvas.pushFont( style.skin.SectionBarSwitch.Font );
        canvas.drawTextRect( text, rect, style.skin.SectionBarSwitch.TextColor, 1, 1 );
        canvas.popFont();
    }

    var width=32;

    this.rect1.copy( widget.rect );
    this.rect1.width=width;
    widget.leftRect.copy( this.rect1 );

    drawButton( this.rect1, widget.left, widget.text1 );

    this.rect1.copy( widget.rect );
    this.rect1.x=this.rect1.right() - width;
    this.rect1.width=width;
    widget.rightRect.copy( this.rect1 );

    drawButton( this.rect1, !widget.left, widget.text2 );

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- SectionToolBar

VG.UI.VisualGraphicsStyle.prototype.drawSectionToolBar=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.rect, this.skin.SectionToolBar.BorderColor1 );
    widget.contentRect.set( widget.rect );
    widget.contentRect.add( 0, 0, -4, 0, widget.contentRect );

    this.rect1.set( widget.rect );
    this.rect1.x+=this.rect1.width-2; this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SectionToolBar.BorderColor2 );

    var that=this;
    function drawSectionHeader( rect, layout ) {
        that.rect2.copy( rect );
        that.rect2.height=1;

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, that.rect2, that.skin.SectionToolBar.HeaderTopBorderColor );

        that.rect2.y+=1;
        that.rect2.height=19;

        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, that.rect2, that.skin.SectionToolBar.HeaderGradColor1,
            that.skin.SectionToolBar.HeaderGradColor2 );
        canvas.pushFont( that.skin.SectionToolBar.HeaderFont );
        canvas.drawTextRect( layout.text, that.rect2, that.skin.SectionToolBar.HeaderTextColor, 1, 1 );
        canvas.popFont();

        that.rect2.y+=19;
        that.rect2.height=1;

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, that.rect2, that.skin.SectionToolBar.HeaderBottomBorderColor1 );
        that.rect2.y+=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, that.rect2, that.skin.SectionToolBar.HeaderBottomBorderColor2 );

        rect.y+=24; rect.height-=24;
    }

    // ---

    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.SectionToolBar.BackColor );

    var yOffset=0;
    for ( var i=0; i < widget.layout.length; ++i )
    {
        this.rect1.set( widget.contentRect );
        this.rect1.y+=yOffset; this.rect1.height-=yOffset;

        var layout=widget.layout.childAt( i );

        //VG.log( "here " +i, this.rect1.toString() );

        drawSectionHeader( this.rect1, layout );

        layout.rect.copy( this.rect1 );
        layout.layout( canvas );

        let visibleItems = 0;

        for ( let v = 0; v < layout.children.length; ++v )
            if ( layout.children[v].visible ) visibleItems++;

        let layoutHeight = visibleItems * (widget.small ? this.skin.SectionToolBarButton.SmallSize.height : this.skin.SectionToolBarButton.Size.height) + 4;
        if ( layout.length ) layoutHeight+=layout.length-1;

        yOffset+=24 + layoutHeight;
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- SectionBarButton

VG.UI.VisualGraphicsStyle.prototype.drawSectionToolBarButton=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    this.rect1.copy( widget.rect );

    var borderColor=this.skin.SectionToolBarButton.BorderColor;
    var backColor;

    if ( widget.sectionBarWidget.activeButton === widget ) {
        borderColor=this.skin.SectionToolBarButton.BorderSelectedColor;
        backColor=this.skin.SectionToolBarButton.BackSelectedColor;
    }
    else
    if ( !VG.context.workspace.mouseTrackerWidget && widget.rect.contains( VG.context.workspace.mousePos ) )
    {
        if ( !widget.disabled ) {
            borderColor=this.skin.SectionToolBarButton.BorderHoverColor;
            backColor=this.skin.SectionToolBarButton.BackHoverColor;
        }
    }

    if ( backColor ) canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, backColor );
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect1, borderColor );

    if ( widget.image )
    {
        let image = widget.image;
        if ( image && image.isValid() ) {

            this.rect2.copy( this.rect1 );

            this.rect2.x+=(this.rect2.width - image.width)/2;
            this.rect2.y+=(this.rect2.height - image.height)/2;
            canvas.drawImage( this.rect2, image );
        }
    } else
    if ( widget.iconName )
    {
        var imageName=widget.iconName;
        var image=VG.context.imagePool.getImageByName( imageName );

        if ( image && image.isValid() ) {

            this.rect2.copy( this.rect1 );

            this.rect2.x+=(this.rect2.width - image.width)/2;
            this.rect2.y+=(this.rect2.height - image.height)/2;
            canvas.drawImage( this.rect2, image );
        }
    } else
    if ( widget.svgName )
    {
        var svg=VG.Utils.getSVGByName( widget.svgName );

        this.rect1.shrink( 8, 8, this.rect1 ); // 2, 2
        svgGroup=svg.getGroupByName( widget.svgGroupName );
        canvas.drawSVG( svg, svgGroup, this.rect1, this.skin.Widget.TextColor );
    }
    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- ShiftWidget

VG.UI.VisualGraphicsStyle.prototype.drawShiftWidget=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );
    widget.contentRect.height=widget.itemHeight;

    if ( !widget.popup )
    {
        // --- Background

        this.rect1.set( widget.contentRect );
        this.rect1.shrink( 1, 0, this.rect1 );

        if ( widget.mouseIsDown )
        {
            this.rect1.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.SelectedTopBorderColor );
            this.rect1.y+=widget.contentRect.height-1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.SelectedBottomBorderColor );

            this.rect1.copy( widget.contentRect );
            this.rect1.shrink( 0, 1, this.rect1 );
            canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SnapperWidgetItem.SelectedBackGradColor1, this.skin.SnapperWidgetItem.SelectedBackGradColor2 );
        } else
        if ( !widget.hasHoverState )
        {
            this.rect1.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.TopBorderColor );
            this.rect1.y+=widget.contentRect.height-1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.BottomBorderColor );

            this.rect1.copy( widget.contentRect );
            this.rect1.shrink( 0, 1, this.rect1 );
            canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SnapperWidgetItem.BackGradColor1, this.skin.SnapperWidgetItem.BackGradColor2 );
        } else {
            this.rect1.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.HoverTopBorderColor );
            this.rect1.y+=widget.contentRect.height-1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.HoverBottomBorderColor );

            this.rect1.copy( widget.contentRect );
            this.rect1.shrink( 0, 1, this.rect1 );
            canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SnapperWidgetItem.HoverBackGradColor1, this.skin.SnapperWidgetItem.HoverBackGradColor2 );
        }


        // --- Arrows

        this.rect2.copy( this.rect1 );

        this.rect2.x+=10; this.rect2.y+=7;
        this.rect2.width=10; this.rect2.height=15;
        canvas.draw2DShape( VG.Canvas.Shape2D.ArrowLeft, this.rect2, this.skin.SnapperWidgetItem.TextColor );

        this.rect2.copy( this.rect1 );

        this.rect2.x+=this.rect2.width - 20; this.rect2.y+=7;
        this.rect2.width=10; this.rect2.height=15;
        canvas.draw2DShape( VG.Canvas.Shape2D.ArrowRight, this.rect2, this.skin.SnapperWidgetItem.TextColor );

        // --- Text

        canvas.pushFont( this.skin.SnapperWidgetItem.Font );

        if ( widget.index !== -1 )
            canvas.drawTextRect( widget.childs[widget.index].text, this.rect1, this.skin.SnapperWidgetItem.TextColor, 1, 1 );

        canvas.popFont();
    } else
    if ( widget.popup )
    {
        this.rect1.set( widget.contentRect );

        widget.itemsDown=widget.childs.length - widget.index - 1;
        if ( widget.itemsDown > widget.maxDown ) widget.itemsDown=widget.maxDown;

        widget.itemsUp=widget.index;
        if ( widget.itemsUp > widget.maxUp ) widget.itemsUp=widget.maxUp;

        canvas.pushFont( this.skin.SnapperWidgetItem.Font );

        // --- Draw Down

        var popupHeight=(widget.itemsDown+1+widget.itemsUp) * widget.itemHeight + widget.childs.length;
        this.rect2.set( this.rect1.x, this.rect1.y - widget.itemsUp * widget.itemHeight, this.rect1.width, popupHeight );

        // ---

        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect2, this.skin.Window.BorderColor2 );
        this.rect2.shrink( 1, 1, this.rect2 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.Window.BackColor );
        widget.popupRect.copy( this.rect2 );

        this.rect2.height=widget.itemHeight;

        // --- Draw Down
        y=this.rect2.y + widget.itemsUp * widget.itemHeight;
        for( i=0; i <= widget.itemsDown; ++i )
        {
            itemIndex=widget.index + i;
            itemIndex=itemIndex % widget.childs.length;

            this.rect1.set( this.rect2 );
            this.rect1.y=y;

            if ( itemIndex === widget.highlightedIndex )
            {
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DropDownMenu.ItemSelectedBackColor );
                canvas.drawTextRect( widget.childs[itemIndex].text, this.rect1, this.skin.DropDownMenu.ItemSelectedTextColor, 1, 1 );
            } else {
                canvas.drawTextRect( widget.childs[itemIndex].text, this.rect1, this.skin.Window.HeaderTextColor, 1, 1 );
            }

            y+=widget.itemHeight;
        }

        // --- Draw Up
        y=this.rect2.y;
        for( i=0; i < widget.itemsUp; ++i )
        {
            itemIndex=widget.index - widget.itemsUp + i;

            this.rect1.set( this.rect2 );
            this.rect1.y=y;

            if ( itemIndex === widget.highlightedIndex )
            {
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.DropDownMenu.ItemSelectedBackColor );
                canvas.drawTextRect(  widget.childs[itemIndex].text, this.rect1, this.skin.DropDownMenu.ItemSelectedTextColor, 1, 1 );
            } else {
                canvas.drawTextRect( widget.childs[itemIndex].text, this.rect1, this.skin.Window.HeaderTextColor, 1, 1 );
            }

            y+=widget.itemHeight;
        }

        canvas.popFont();
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- Slider

VG.UI.VisualGraphicsStyle.prototype.drawSlider=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.sliderRect.set( widget.contentRect );

    let leftSpace=Math.ceil( this.skin.Slider.HandleSize / 2 );
    widget.sliderRect.x+=leftSpace;
    widget.sliderRect.width-=leftSpace;
    widget.sliderRect.y=Math.floor( widget.sliderRect.y + (widget.sliderRect.height - this.skin.Slider.BarHeight)/2 );
    widget.sliderRect.height=1;

    let textColor=this.skin.Widget.TextColor;

    let valueText;

    if ( ( widget.step % 1 ) === 0 ) valueText=widget.value.toString();
    else valueText=widget.value.toFixed( 2 );

    let valueTextSize;

    if ( !widget.editable )
        valueTextSize=canvas.getTextSize( valueText );
    else {

        canvas.pushFont( widget.edit.font );
        valueTextSize=canvas.getTextSize( widget.edit.maxString );
        canvas.popFont();

        valueTextSize.width+=16;
        if ( widget.min < 0 ) valueTextSize.width+=6;

        if ( widget.edit.minimumSize.width > valueTextSize.width ) valueTextSize.width=widget.edit.minimumSize.width;
    }

    valueTextSize.width+=10;
    widget.sliderRect.width-=valueTextSize.width;

    let colorObject=this.skin.Slider.BarColors;
    if ( widget.hasHoverState || widget.hasFocusState ) colorObject=this.skin.Slider.FocusHoverBarColors;

    widget.sliderRect.x+=1; widget.sliderRect.width-=2; widget.sliderRect.y+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.sliderRect, colorObject.Color1 );
    widget.sliderRect.x-=1; widget.sliderRect.width+=2; widget.sliderRect.y+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.sliderRect, colorObject.Color2 );
    widget.sliderRect.x+=1; widget.sliderRect.width-=1; widget.sliderRect.y+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.sliderRect, colorObject.Color3 );
    widget.sliderRect.width-=1; widget.sliderRect.y+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.sliderRect, colorObject.Color4 );
    widget.sliderRect.x-=1; widget.sliderRect.width+=2;

    if ( !widget.editable )
        canvas.drawTextRect( valueText, VG.Core.Rect( widget.sliderRect.right(), widget.contentRect.y, valueTextSize.width, widget.contentRect.height ), textColor, 2, 1 );
    else {
        widget.edit.rect.set( widget.sliderRect.right()+10, widget.contentRect.y, valueTextSize.width-10, widget.contentRect.height );
        widget.edit.paintWidget( canvas );
    }

    // --- Draw the handle

    let offset;

    if ( !widget.halfWidthValue )
    {
        // --- Normal Mode

        distance=widget.max - widget.min;
        perPixel=widget.sliderRect.width / distance;
        valueOffset=widget.value - widget.min;

        offset=valueOffset * perPixel;
    } else
    {
        // --- A value is predefined at the middle of the slider

        if ( widget.value <= widget.halfWidthValue )
        {

            distance=widget.halfWidthValue - widget.min;
            perPixel=widget.sliderRect.width / 2 / distance;
            valueOffset=widget.value - widget.min;

            offset=valueOffset * perPixel;
        } else
        {
            distance=widget.max - widget.halfWidthValue;
            perPixel=widget.sliderRect.width / 2 / distance;
            valueOffset=widget.value - widget.halfWidthValue;

            offset=widget.sliderRect.width / 2 + valueOffset * perPixel;
        }
    }

    widget.sliderHandleRect.x=widget.sliderRect.x + offset - leftSpace;
    widget.sliderHandleRect.y=widget.contentRect.y + (widget.contentRect.height - this.skin.Slider.HandleSize)/2;
    widget.sliderHandleRect.width=this.skin.Slider.HandleSize;
    widget.sliderHandleRect.height=this.skin.Slider.HandleSize;

    let imageName="slider";
    //if ( widget.hasHoverState ) imageName+="_hover";
    if ( widget.hasFocusState ) imageName+="_focus";
    imageName+=".png";

    let image=VG.context.imagePool.getImageByName( imageName );

    if ( image ) canvas.drawImage( widget.sliderHandleRect, image );
    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- Round Slider

VG.UI.VisualGraphicsStyle.prototype.drawRoundSlider=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.sliderRect.set( widget.contentRect );

    let skin=this.skin.RoundSlider;

    let leftSpace=Math.ceil( skin.HandleSize / 2 );
    widget.sliderRect.x+=leftSpace;
    widget.sliderRect.width-=leftSpace;
    widget.sliderRect.y=Math.floor( widget.sliderRect.y + (widget.sliderRect.height - skin.BarHeight)/2 );
    widget.sliderRect.height=1;

    let textColor=this.skin.Widget.TextColor;

    let valueText;
    let valueTextSize;

    if ( !widget.noValue )
    {
        if ( ( widget.step % 1 ) === 0 ) valueText=widget.value.toString();
        else valueText=widget.value.toFixed( 2 );

        if ( !widget.editable )
            valueTextSize=canvas.getTextSize( valueText );
        else {

            canvas.pushFont( widget.edit.font );
            valueTextSize=canvas.getTextSize( widget.edit.maxString );
            canvas.popFont();

            valueTextSize.width+=16;
            if ( widget.min < 0 ) valueTextSize.width+=6;

            if ( widget.edit.minimumSize.width > valueTextSize.width ) valueTextSize.width=widget.edit.minimumSize.width;
        }

        valueTextSize.width+=10;
        widget.sliderRect.width -= valueTextSize.width;
    } else widget.sliderRect.width -= 10;

    if ( !widget.noValue )
    {
        if ( !widget.editable )
            canvas.drawTextRect( valueText, VG.Core.Rect( widget.sliderRect.right(), widget.contentRect.y, valueTextSize.width, widget.contentRect.height ).round(), textColor, 2, 1 );
        else {
            widget.edit.rect.set( Math.ceil( widget.sliderRect.right()+10 ), widget.contentRect.y, Math.ceil( valueTextSize.width-10 ), widget.contentRect.height );
            widget.edit.paintWidget( canvas );
        }
    }

    // --- Draw the handle

    let offset;

    if ( !widget.halfWidthValue )
    {
        // --- Normal Mode

        distance=widget.max - widget.min;
        perPixel=widget.sliderRect.width / distance;
        valueOffset=widget.value - widget.min;

        offset=valueOffset * perPixel;
    } else
    {
        // --- A value is predefined at the middle of the slider

        if ( widget.value <= widget.halfWidthValue )
        {

            distance=widget.halfWidthValue - widget.min;
            perPixel=widget.sliderRect.width / 2 / distance;
            valueOffset=widget.value - widget.min;

            offset=valueOffset * perPixel;
        } else
        {
            distance=widget.max - widget.halfWidthValue;
            perPixel=widget.sliderRect.width / 2 / distance;
            valueOffset=widget.value - widget.halfWidthValue;

            offset=widget.sliderRect.width / 2 + valueOffset * perPixel;
        }
    }

    let leftColors=skin.LeftTrackColors, rightColors=skin.RightTrackColors;
    // if ( widget.hasHoverState || widget.hasFocusState ) colorObject=this.skin.Slider.FocusHoverBarColors;

    this.rect1.copy( widget.sliderRect );
    this.rect1.x+=1; this.rect1.width=offset; this.rect1.y+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, leftColors.Color1 );
    this.rect1.x+=offset; this.rect1.width=widget.sliderRect.width - offset - 2;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, rightColors.Color1 );

    this.rect1.x=widget.sliderRect.x; this.rect1.width=offset; this.rect1.y+=1; this.rect1.height=2;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, leftColors.Color3 );
    this.rect1.x+=offset; this.rect1.width=widget.sliderRect.width - offset;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, rightColors.Color3 );

    this.rect1.x=widget.sliderRect.x + 1; this.rect1.width=offset; this.rect1.height=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, leftColors.Color2 );
    this.rect1.x+=offset; this.rect1.width=widget.sliderRect.width - offset - 2;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, rightColors.Color2 );

    widget.sliderHandleRect.x=widget.sliderRect.x + offset - leftSpace;
    widget.sliderHandleRect.y=widget.contentRect.y + (widget.contentRect.height - skin.HandleSize)/2;
    widget.sliderHandleRect.width=skin.HandleSize;
    widget.sliderHandleRect.height=skin.HandleSize;

    if ( widget.hasFocusState )
        canvas.draw2DShape( VG.Canvas.Shape2D.Circle, widget.sliderHandleRect, skin.SelectedOuterKnobColor );
    else canvas.draw2DShape( VG.Canvas.Shape2D.Circle, widget.sliderHandleRect, skin.OuterKnobColor );

    widget.sliderHandleRect.shrink( 2, 2, this.rect1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.rect1, skin.KnobColor );

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- Vertical SnaperWidget (the default)

VG.UI.VisualGraphicsStyle.prototype.drawSnapperWidgetItem=function( widget, canvas )
{
    // --- Background

    this.rect1.copy( widget.rect );
    this.rect1.shrink( 1, 0, this.rect1 );

    if ( widget.mouseIsDown )
    {
        this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.SelectedTopBorderColor );
        this.rect1.y+=widget.rect.height-1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.SelectedBottomBorderColor );

        this.rect1.copy( widget.rect );
        this.rect1.shrink( 0, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SnapperWidgetItem.SelectedBackGradColor1, this.skin.SnapperWidgetItem.SelectedBackGradColor2 );
    } else
    if ( !widget.hasHoverState )
    {
        this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.TopBorderColor );
        this.rect1.y+=widget.rect.height-1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.BottomBorderColor );

        this.rect1.copy( widget.rect );
        this.rect1.shrink( 0, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SnapperWidgetItem.BackGradColor1, this.skin.SnapperWidgetItem.BackGradColor2 );
    } else {
        this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.HoverTopBorderColor );
        this.rect1.y+=widget.rect.height-1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.HoverBottomBorderColor );

        this.rect1.copy( widget.rect );
        this.rect1.shrink( 0, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.SnapperWidgetItem.HoverBackGradColor1, this.skin.SnapperWidgetItem.HoverBackGradColor2 );
    }

    // --- Arrow

    this.rect2.copy( this.rect1 );

    if ( widget.open ) {
        this.rect2.x+=6; this.rect2.y+=7;
        this.rect2.width=10; this.rect2.height=5;
        canvas.draw2DShape( VG.Canvas.Shape2D.FlippedTriangle, this.rect2, this.skin.SnapperWidgetItem.TextColor );
    } else {
        this.rect2.x+=9; this.rect2.y+=5;
        this.rect2.width=5; this.rect2.height=10;
        canvas.draw2DShape( VG.Canvas.Shape2D.ArrowRight, this.rect2, this.skin.SnapperWidgetItem.TextColor );
    }

    // --- Enabler

    if ( widget.enablerCB )
    {
        widget.enablerCB.rect.copy( this.rect1 );
        widget.enablerCB.rect.x+=(this.rect1.width - widget.enablerCB.minimumSize.width) - 10;
        widget.enablerCB.rect.y+=(this.rect1.height - widget.enablerCB.minimumSize.height)/2;
        widget.enablerCB.rect.width=widget.enablerCB.minimumSize.width;
        widget.enablerCB.rect.height=widget.enablerCB.minimumSize.height;
        widget.enablerCB.paintWidget( canvas );
    }

    // --- Text

    this.rect1.x+=30; this.rect1.width-=30;
    this.rect1.height-=2;

    canvas.pushFont( this.skin.SnapperWidgetItem.Font );
    canvas.drawTextRect( widget.text, this.rect1, this.skin.SnapperWidgetItem.TextColor, 0, 1 );
    canvas.popFont();
};

// --- Horizontal SnaperWidget

VG.UI.VisualGraphicsStyle.prototype.drawHorizontalSnapperWidgetItem=function( widget, canvas )
{
    // --- Background

    this.rect1.copy( widget.rect );
    this.rect1.shrink( 1, 1, this.rect1 );

    if ( widget.mouseIsDown )
    {
        this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.SelectedTopBorderColor );
        this.rect1.y+=widget.rect.height-1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.SelectedBottomBorderColor );

        this.rect1.copy( widget.rect );
        this.rect1.shrink( 0, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.HorizontalGradient, this.rect1, this.skin.SnapperWidgetItem.SelectedBackGradColor1, this.skin.SnapperWidgetItem.SelectedBackGradColor2 );
    } else
    if ( !widget.hasHoverState )
    {
        this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.TopBorderColor );
        this.rect1.y+=widget.rect.height-1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.BottomBorderColor );

        this.rect1.copy( widget.rect );
        this.rect1.shrink( 0, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.HorizontalGradient, this.rect1, this.skin.SnapperWidgetItem.BackGradColor1, this.skin.SnapperWidgetItem.BackGradColor2 );
    } else {
        this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.HoverTopBorderColor );
        this.rect1.y+=widget.rect.height-1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.SnapperWidgetItem.HoverBottomBorderColor );

        this.rect1.copy( widget.rect );
        this.rect1.shrink( 0, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.HorizontalGradient, this.rect1, this.skin.SnapperWidgetItem.HoverBackGradColor1, this.skin.SnapperWidgetItem.HoverBackGradColor2 );
    }

    // --- Arrow

    this.rect2.copy( this.rect1 );

    if ( !widget.open ) {
        this.rect2.x+=6; this.rect2.y+=7;
        this.rect2.width=10; this.rect2.height=5;
        canvas.draw2DShape( VG.Canvas.Shape2D.FlippedTriangle, this.rect2, this.skin.SnapperWidgetItem.TextColor );
    } else {
        this.rect2.x+=9; this.rect2.y+=5;
        this.rect2.width=5; this.rect2.height=10;
        canvas.draw2DShape( VG.Canvas.Shape2D.ArrowRight, this.rect2, this.skin.SnapperWidgetItem.TextColor );
    }

    // --- Enabler

    if ( widget.enablerCB )
    {
        widget.enablerCB.rect.copy( this.rect1 );
        widget.enablerCB.rect.x+=(this.rect1.width - widget.enablerCB.minimumSize.width) - 10;
        widget.enablerCB.rect.y+=(this.rect1.height - widget.enablerCB.minimumSize.height)/2;
        widget.enablerCB.rect.width=widget.enablerCB.minimumSize.width;
        widget.enablerCB.rect.height=widget.enablerCB.minimumSize.height;
        widget.enablerCB.paintWidget( canvas );
    }

    // --- Text

    canvas.pushFont( this.skin.SnapperWidgetItem.Font );

    this.rect1.y += Math.round( this.rect1.height / 2 - canvas.getTextSize( widget.text ).width / 2 + 4 );
    this.rect1.width -= 2;

    canvas.drawTextRect( widget.text, this.rect1, this.skin.SnapperWidgetItem.TextColor, 0, 0, 90 );
    canvas.popFont();
};

// --- VG.UI.SplitLayout --- SplitHandle

VG.UI.VisualGraphicsStyle.prototype.drawSplitHandle=function( canvas, layout, pos, itemRect, childRect, dragging, hover, adjustY )
{
    itemRect[layout.primaryCoord]=pos + childRect[layout.primarySize];
    itemRect[layout.secondaryCoord]=layout.margin[layout.secondaryLesserMargin] + layout.rect[layout.secondaryCoord] - adjustY;
    itemRect[layout.primarySize]=layout.spacing;
    itemRect[layout.secondarySize]=layout.rect[layout.secondarySize] - layout.margin[layout.secondaryLesserMargin] - layout.margin[layout.secondaryGreaterMargin] + adjustY;

    this.rect1.copy( itemRect );

    let backColor, borderColor;

    if ( dragging ) {
        backColor=this.skin.SplitLayout.DragBackColor; borderColor=this.skin.SplitLayout.DragBorderColor;
    } else
    if ( hover ) {
        backColor=this.skin.SplitLayout.HoverBackColor; borderColor=this.skin.SplitLayout.HoverBorderColor;
    } else {
        backColor=this.skin.SplitLayout.BackColor; borderColor=this.skin.SplitLayout.BorderColor;
    }

    if ( layout.spacing > 1 ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, itemRect, backColor );
        if ( layout.vertical )
        {
            var lowerLine=this.rect1.y + this.rect1.height-1;
            this.rect1.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, borderColor );
            this.rect1.y=lowerLine;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, borderColor );
        } else
        {
            var rightLine=this.rect1.x + this.rect1.width-1;
            this.rect1.width=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, borderColor );
            this.rect1.x=rightLine;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, borderColor );
        }
    } else {
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, itemRect, borderColor );//new VG.Core.Color( 93, 93, 93 ) );
    }
};

// --- StatusBar

VG.UI.VisualGraphicsStyle.prototype.drawStatusBar=function( widget, canvas )
{
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.rect, this.skin.StatusBar.BorderColor );

    this.rect1.set( widget.rect ); this.rect1.y+=1; this.rect1.height-=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.StatusBar.BackColor );
};

// --- TabWidgetHeader

VG.UI.VisualGraphicsStyle.prototype.drawTabWidgetHeader=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );

    this.rect1.copy( widget.rect );

    if ( widget.small )
    {
        // --- Left Border

        var skin=this.skin.TabWidgetSmallHeader;

        this.rect1.width=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, skin.LeftBorderColor );

        // --- Universal Bottom Border

        this.rect1.width=widget.rect.width;
        this.rect1.y+=skin.Height+2; this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, skin.TabBorderColor );

        // --- Tabs

        this.rect2.copy( widget.rect );
        this.rect2.x+=1; this.rect2.height=23;
        this.rect2.y+=2;

        canvas.pushFont( skin.Font );

        for ( var i=0; i < widget.items.length; ++i )
        {
            var item=widget.items[i];
            this.rect2.width=canvas.getTextSize( item.text, this.rect4 ).width + 30;
            item.rect.copy( this.rect2 );

            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect2, skin.TabBorderColor );

            this.rect3.copy( this.rect2 );
            this.rect3.shrink( 1, 1, this.rect3 );

            if ( item.object === widget.layout.current )
            {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, this.rect3, skin.SelectedEdgeBorderColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect3, skin.SelectedTopBorderColor );

                this.rect3.y+=1;
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, skin.SelectedSideBorderColor1, skin.SelectedSideBorderColor2 );
                this.rect3.height+=2;
                this.rect3.y-=1;

                this.rect3.shrink( 1, 1, this.rect3 );
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, skin.SelectedBackGradientColor1, skin.SelectedBackGradientColor2 );
            } else
            if ( !VG.context.workspace.mouseTrackerWidget && this.rect2.contains( VG.context.workspace.mousePos ) ) {
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, skin.HoverBackGradientColor1, skin.HoverBackGradientColor2 );
            } else {
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, skin.BackGradientColor1, skin.BackGradientColor2 );
            }

            canvas.drawTextRect( item.text, this.rect2, skin.TextColor, 1, 1 );

            this.rect2.x+=this.rect2.width + 2;
        }

        canvas.popFont();

        // ---

        widget.contentRect.set( widget.rect );
        widget.contentRect.add( 0, skin.Height+2, 0, -skin.Height-2, widget.contentRect );
    } else
    {
        // --- Left Border

        this.rect1.width=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TabWidgetHeader.LeftBorderColor );

        // --- Universal Bottom Border

        this.rect1.width=widget.rect.width;
        this.rect1.y+=this.skin.TabWidgetHeader.Height - 5; this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TabWidgetHeader.TabBorderColor );
        this.rect1.y+=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TabWidgetHeader.BottomBorderColor1 );
        this.rect1.y+=1; this.rect1.height=3;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TabWidgetHeader.BottomBorderColor2 );

        // --- Tabs

        this.rect2.copy( widget.rect );
        this.rect2.x+=1; this.rect2.height=28;

        canvas.pushFont( this.skin.TabWidgetHeader.Font );

        for ( let i=0; i < widget.items.length; ++i )
        {
            let item=widget.items[i];
            this.rect2.width=canvas.getTextSize( item.text, this.rect4 ).width + 70;
            item.rect.copy( this.rect2 );

            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect2, this.skin.TabWidgetHeader.TabBorderColor );

            this.rect3.copy( this.rect2 );
            this.rect3.shrink( 1, 1, this.rect3 );

            if ( item.object === widget.layout.current )
            {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, this.rect3, this.skin.TabWidgetHeader.SelectedEdgeBorderColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect3, this.skin.TabWidgetHeader.SelectedTopBorderColor );

                this.rect3.y+=1;
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, this.skin.TabWidgetHeader.SelectedSideBorderColor1, this.skin.TabWidgetHeader.SelectedSideBorderColor2 );
                this.rect3.height+=3;
                this.rect3.y-=1;

                this.rect3.shrink( 1, 1, this.rect3 );
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, this.skin.TabWidgetHeader.SelectedBackGradientColor1, this.skin.TabWidgetHeader.SelectedBackGradientColor2 );
            } else
            if ( !VG.context.workspace.mouseTrackerWidget && this.rect2.contains( VG.context.workspace.mousePos ) ) {
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, this.skin.TabWidgetHeader.HoverBackGradientColor1, this.skin.TabWidgetHeader.HoverBackGradientColor2 );
            } else {
                canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3, this.skin.TabWidgetHeader.BackGradientColor1, this.skin.TabWidgetHeader.BackGradientColor2 );
            }

            canvas.drawTextRect( item.text, this.rect2, this.skin.TabWidgetHeader.TextColor, 1, 1 );

            this.rect2.x+=this.rect2.width + 4;
        }

        canvas.popFont();

        // ---

        widget.contentRect.set( widget.rect );
        widget.contentRect.add( 0, this.skin.TabWidgetHeader.Height, 0, -this.skin.TabWidgetHeader.Height, widget.contentRect );
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- TextEdit

VG.UI.VisualGraphicsStyle.prototype.drawTextEdit=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    if ( widget.dragging && widget.selectionIsValid )
        widget.autoScroll();

    if ( !widget.rect.equals( widget.previousRect ) ) widget.verified=false;

    widget.contentRect.set( widget.rect );
    if ( widget.hasFocusState ) {
        widget.contentRect.shrink( 3, 3, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TextEdit.FocusBackgroundColor );


        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, this.skin.TextEdit.FocusBorderColor1 );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.TextEdit.FocusBorderColor1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.TextEdit.FocusBorderColor2 );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.TextEdit.FocusBorderColor2 );

        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.TextEdit.FocusBorderColor3 );

        widget.contentRect.shrink( 2, 2, widget.contentRect );
    } else
    {
        widget.contentRect.shrink( 3, 3, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TextEdit.BackgroundColor );

        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.TextEdit.BorderColor1 );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, widget.contentRect, this.skin.TextEdit.BorderColor2 );

        widget.contentRect.shrink( 1, 1, widget.contentRect );
    }

    if ( !widget.textLines ) return;

    widget.font=VG.UI.stylePool.current.skin.TextEdit.Font;
    canvas.pushFont(widget.font);

    canvas.pushClipRect( widget.contentRect );
    widget.contentRect=widget.contentRect.add( 4, 2, -8, -4 );

    if ( !widget.verified || canvas.hasBeenResized )
        widget.verifyScrollbar();

    if ( widget.needsVScrollbar )
        widget.contentRect.width-=VG.UI.stylePool.current.skin.ScrollBar.Size;

    if ( widget.needsHScrollbar )
        widget.contentRect.height-=VG.UI.stylePool.current.skin.ScrollBar.Size;

    // ---

    var textColor=this.skin.TextEdit.TextColor;

    var paintRect=VG.Core.Rect();
    paintRect.x=widget.contentRect.x - widget.textOffset.x;
    paintRect.y=widget.contentRect.y - widget.textOffset.y;
    paintRect.width=widget.maxTextLineSize.width;
    paintRect.height=widget.maxTextLineSize.height;

    for ( var i=0; i < widget.textLines; ++i ) {

        if ( paintRect.y + widget.itemHeight >= widget.contentRect.y || paintRect.y < widget.contentRect.bottom() ) {

            var text=widget.textArray[i];

            if ( widget.selectionIsValid && widget.hasFocusState )
                widget.drawSelectionForLine( canvas, i, paintRect, text, this.skin.TextEdit.FocusBorderColor2 );
            else if ( widget.selectionIsValid )
                widget.drawSelectionForLine( canvas, i, paintRect, text, this.skin.TextEdit.BorderColor2 );


            canvas.drawTextRect( text, paintRect, textColor, widget.hAlignment, 1 );

            paintRect.y+=widget.itemHeight;
        }

        if ( paintRect.y > widget.contentRect.bottom() ) break;
    }

    if ( widget.needsVScrollbar ) {

        widget.setVScrollbarDimensions( canvas );
        widget.vScrollbar.paintWidget( canvas );
    }

    if ( widget.needsHScrollbar ) {

        widget.setHScrollbarDimensions( canvas );
        widget.hScrollbar.paintWidget( canvas );
    }

    if ( !widget.readOnly ) widget.blink( canvas );
    widget.previousRect.set( widget.rect );

    canvas.popFont();
    canvas.popClipRect();

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- TextLineEdit

VG.UI.VisualGraphicsStyle.prototype.drawTextLineEdit=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );

    // --- Border

    widget.contentRect.set( widget.rect );
    if ( !widget.embedded ) {
        if ( widget.hasFocusState ) {

            /*
            widget.contentRect.shrink( 2, 2, widget.contentRect );
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TextLineEdit.FocusBackgroundColor );

            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, this.skin.TextLineEdit.FocusBorderColor1 );
            widget.contentRect.shrink( 1, 1, widget.contentRect );
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.TextLineEdit.FocusBorderColor1 );
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.TextLineEdit.FocusBorderColor2 );
            widget.contentRect.shrink( 1, 1, widget.contentRect );
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, this.skin.TextLineEdit.FocusBorderColor2 );

            widget.contentRect.shrink( 1, 0, this.rect1 );
            this.rect1.height=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TextLineEdit.FocusBorderColor3 );

            widget.contentRect.shrink( 0, 1, this.rect1 );
            this.rect1.width=1;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TextLineEdit.FocusBorderColor3 );

            widget.contentRect.shrink( 1, 1, widget.contentRect );
            */

            widget.contentRect.shrink( 2, 2, widget.contentRect );

            canvas.drawShape( "RoundedRect", widget.contentRect, {
                fillStyle: this.skin.TextLineEdit.BackgroundColor.canvasStyle,
                strokeStyle: this.skin.TextLineEdit.FocusBorderColor2.canvasStyle,
                strokeWidth : 3,
                radius: 3 } );
        } else
        {
            widget.contentRect.shrink( 2, 2, widget.contentRect );
            /*
            widget.contentRect.shrink( 3, 3, this.rect1 );
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TextLineEdit.BackgroundColor );

            widget.contentRect.shrink( 1, 1, widget.contentRect );

            if ( widget.customBorderColor ) canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, widget.customBorderColor );
            else canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.TextLineEdit.BorderColor1 );
            //canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.TextLineEdit.BorderColor1 );
            widget.contentRect.shrink( 1, 1, widget.contentRect );

            //if ( widget.customBorderColor ) canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, widget.contentRect, widget.customBorderColor );
            //else
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, widget.contentRect, this.skin.TextLineEdit.BorderColor2 );

            widget.contentRect.shrink( 1, 1, widget.contentRect );
            */

            canvas.drawShape( "RoundedRect", widget.contentRect, {
                fillStyle: this.skin.TextLineEdit.BackgroundColor.canvasStyle,
                strokeStyle: widget.customBorderColor ? widget.customBorderColor.canvasStyle : this.skin.TextLineEdit.BorderColor1.canvasStyle,
                strokeWidth : 2,
                radius: 3 } );
        }
    }

    // ---

    widget.contentRect.shrink( 5, 0, widget.contentRect );

    var textLine;

    widget.font.setFont( this.skin.TextLineEdit.Font );
    canvas.pushFont(widget.font);

    if ( !widget.textLines || ( widget.textArray && !widget.textArray[0].length ) && !widget.hasFocusState )
    {
        if ( widget.defaultText ) {
            canvas.drawTextRect( widget.defaultText, widget.contentRect, this.skin.TextLineEdit.DefaultTextColor, 0, 1 );
        }
        canvas.popFont();
        if ( widget.disabled ) canvas.setAlpha( 1 );
        return;
    } else textLine=widget.textArray[0];

    var textColor=this.skin.TextLineEdit.TextColor;

    widget.textOffset.x=0;
    if ( textLine !== undefined ) {

        var size=VG.Core.Size();
        var offset=0;
        var text=textLine.slice( offset );
        canvas.getTextSize( text, size );

        while ( ( (size.width /*+ 3 */) > widget.contentRect.width ) && text.length )
        {
            // --- Text is too long for the contentRect, cut of chars at the front until it fits.

            if ( offset >= widget.cursorPosition.x ) break;

            ++offset;
            text=textLine.slice( offset );
            canvas.getTextSize( text, size );
        }


        if ( widget.selectionIsValid && widget.hasFocusState )
            widget.drawSelectionForLine( canvas, 0, widget.contentRect, text, this.skin.TextLineEdit.FocusBorderColor2 );
        else if ( widget.selectionIsValid )
            widget.drawSelectionForLine( canvas, 0, widget.contentRect, text, this.skin.TextLineEdit.BorderColor2 );

        if ( !widget.password )
            canvas.drawTextRect( text, widget.contentRect, textColor, 0, 1 );
        else
        {
            canvas.pushClipRect( widget.contentRect );

            var circleSize=10;
            var rect=VG.Core.Rect( widget.contentRect );
            rect.y=rect.y + ( widget.contentRect.height - circleSize ) /2;
            rect.width=circleSize; rect.height=circleSize;

            for ( var i=0; i < text.length; ++i )
            {
                canvas.draw2DShape( VG.Canvas.Shape2D.Circle, rect, textColor );
                rect.x+=circleSize + 2;
            }

            canvas.popClipRect();
        }
    }

    widget.blink( canvas, widget.contentRect.y+1, widget.contentRect.height-2 );
    canvas.popFont();
    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- TitleBar

VG.UI.VisualGraphicsStyle.prototype.drawTitleBar=function( canvas, rect, title )
{
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, this.skin.TitleBar.BorderColor );

    this.rect4.copy( rect );
    this.rect4.shrink( 1, 1, this.rect4 );

    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect4, this.skin.TitleBar.BackGradColor1, this.skin.TitleBar.BackGradColor2 );

    this.rect4.x+=4;
    canvas.pushFont( this.skin.TitleBar.Font );
    canvas.drawTextRect( title, this.rect4, this.skin.TitleBar.TextColor, 0, 1 );
    canvas.popFont();
};

// --- TitleBar

VG.UI.VisualGraphicsStyle.prototype.drawToolSettings = function( widget, canvas, svg )
{
    if ( canvas.twoD )
        canvas.clearGLRect( widget.contentRect );

    if ( widget.hasHoverState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolSettings.HoverBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolSettings.HoverBackColor );
    } else if ( widget.open ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolSettings.OpenBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolSettings.OpenBackColor );
    } else {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolSettings.BorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolSettings.BackColor );
    }

    if ( widget.label ) {
        widget.label.rect.copy( widget.rect );
        widget.label.paintWidget( canvas );
    }

    if ( widget.open )
    {
        this.rect1.x = widget.rect.x;
        // this.rect1.y = widget.parent.rect.bottom();
        this.rect1.y = widget.label.rect.bottom() + 1;
        this.rect1.width = widget.options.width || 435;
        this.rect1.height = widget.options.height || 512;

        if ( this.rect1.bottom() > VG.context.workspace.rect.height ) {
            // --- If not enough vertical space, check if widget is in toolbar (< 100 ) and if yes truncate its height, otherwise
            // move the widget up.
            if ( this.rect1.y < 100 ) this.rect1.height = VG.context.workspace.rect.height - this.rect1.y - 20;
            else {
                // --- If widget has header, just move it up, as it has its own close symbol
                if ( !widget.options.noHeader ) {
                    // this.rect1.y -= VG.context.workspace.rect.height - this.rect1.y;
                    this.rect1.y -= this.rect1.bottom() - VG.context.workspace.rect.height;
                }
                else // Otherwise align it on top of the opening symbol
                {
                    this.rect1.y = widget.parent.rect.y - this.rect1.height;// - widget.contentRect.height;
                }
            }
        }

        if ( widget.options.left || this.rect1.right() > VG.context.workspace.rect.width )
            this.rect1.x -= this.rect1.width - widget.rect.width;

        widget.popupRect.copy( this.rect1 );
        widget.widget.rect.copy( this.rect1 );

        if ( canvas.twoD )
            canvas.clearGLRect( this.rect1 );

        // --- Background
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect1, this.skin.ToolSettings.ContentBorderColor );
        this.rect1.shrink( 1, 1, this.rect1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ToolSettings.ContentBackColor );
        this.rect1.shrink( 1, 1, this.rect1 );

        if ( !widget.options.noHeader ) {

            if ( widget.options.text ) {
                this.rect2.copy( this.rect1 );
                this.rect2.y += 23;
                this.rect2.x = this.rect1.x + 6;

                canvas.pushFont( this.skin.ToolSettings.HeaderFont );
                canvas.drawTextRect( widget.options.text, this.rect2, this.skin.Widget.TextColor, 0, 0 );
                canvas.popFont();
            }

            // --- Close Button

            if ( !widget.options.noCloseButton ) {

                this.rect2.x=this.rect1.right() - 10 - 37;
                this.rect2.y=this.rect1.y + 10;
                this.rect2.width=this.rect2.height=37;

                widget.closeButtonRect.copy( this.rect2 );

                if ( this.rect2.contains( VG.context.workspace.mousePos ) ) {
                    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect2, this.skin.ToolSettings.HoverBorderColor );
                    this.rect2.shrink( 1, 1, this.rect2 );
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.ToolSettings.HoverBackColor );
                } else {
                    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect2, this.skin.ToolSettings.BorderColor );
                    this.rect2.shrink( 1, 1, this.rect2 );
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.ToolSettings.BackColor );
                }

                if ( svg ) {
                    this.rect2.shrink( 7, 7, this.rect2 );

                    let svgGroup = svg.getGroupByName( "Close" );
                    canvas.drawSVG( svg, svgGroup, this.rect2, this.skin.Widget.TextColor );
                }
            }

            // ---

            this.rect1.y+=46;
            this.rect1.height-=46;
        }

        if ( widget.widget.layout ) {
            widget.widget.layout.rect.copy( this.rect1 );
            widget.widget.layout.layout( canvas );
        }
    }
};

// --- ToolBar

VG.UI.VisualGraphicsStyle.prototype.drawToolBar=function( widget, canvas )
{
    this.rect1.copy( widget.rect ); this.rect1.height=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ToolBar.TopBorderColor );
    this.rect1.y+=widget.rect.height-1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ToolBar.BottomBorderColor );

    widget.contentRect.copy( widget.rect );
    widget.contentRect.shrink( 0, 1, widget.contentRect );
    //canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, widget.contentRect, this.skin.ToolBar.BackGradColor1, this.skin.ToolBar.BackGradColor2 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolBar.BackGradColor );
};

// --- ToolBarButton

VG.UI.VisualGraphicsStyle.prototype.drawToolBarButton=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.copy( widget.rect );

    // --- Border / Background

    if ( widget.mouseIsDown && !widget.disabled || widget.checked ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolBarButton.ClickedBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect);
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolBarButton.ClickedBackColor );
    } else
    if ( widget.hasHoverState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolBarButton.HoverBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect);
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolBarButton.HoverBackColor );
    } else {
        if ( widget.parent && !widget.parent.decorated && !widget.panelButton )
        {
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolBarButton.BorderColor );
            widget.contentRect.shrink( 1, 1, widget.contentRect);
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolBarButton.BackColor );
        }
    }

    canvas.pushClipRect( widget.contentRect );

    if ( widget.svgName || widget.svg ) {
        // --- SVG
        if ( !widget.svg )
            widget.svg=VG.Utils.getSVGByName( widget.svgName );
        if ( widget.svg )
        {
            svgGroup=widget.svg.getGroupByName( widget.svgGroupName );
            widget.rect.shrink( 3, 3, this.rect4 );
            canvas.drawSVG( widget.svg, svgGroup, this.rect4, this.skin.ToolBarButton.TextColor );
        }
    } else
    if ( widget.icon || widget.iconName ) {
        // --- Icon
        if ( !widget.icon ) widget.icon=VG.context.imagePool.getImageByName( widget.iconName );
        if ( widget.icon && widget.icon.isValid() )
        {
            let x=Math.round( widget.contentRect.x + (widget.contentRect.width - widget.icon.width)/2 );
            let y=Math.round( widget.contentRect.y + (widget.contentRect.height - widget.icon.height)/2);

            canvas.drawImage( { x : x, y : y }, widget.icon );
        }
    }  else {
        // --- Text
        canvas.pushFont( this.skin.ToolBarButton.Font );
        canvas.drawTextRect( widget.text, widget.contentRect, this.skin.ToolBarButton.TextColor, 1, 1 );
        canvas.popFont();
    }

    canvas.popClipRect();

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- ToolButton

VG.UI.VisualGraphicsStyle.prototype.drawToolButton=function( widget, canvas )
{
    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.copy( widget.rect );

    // --- Border / Background

    if ( widget.mouseIsDown && !widget.disabled || widget.checked ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolButton.ClickedBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect);
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolButton.ClickedBackColor );
    } else
    if ( widget.hasHoverState ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolButton.HoverBorderColor );
        widget.contentRect.shrink( 1, 1, widget.contentRect);
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolButton.HoverBackColor );
    } else {
        if ( widget.parent && !widget.parent.decorated )
        {
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, this.skin.ToolButton.BorderColor );
            widget.contentRect.shrink( 1, 1, widget.contentRect);
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, this.skin.ToolButton.BackColor );
        }
    }

    canvas.pushClipRect( widget.contentRect );

    if ( widget.svgName || widget.svg ) {
        // --- SVG
        if ( !widget.svg ) widget.svg=VG.Utils.getSVGByName( widget.svgName );
        if ( widget.svg )
        {
            svgGroup=widget.svg.getGroupByName( widget.svgGroupName );
            widget.rect.shrink( this.skin.ToolButton.Margin.width, this.skin.ToolButton.Margin.height, this.rect4 );
            canvas.drawSVG( widget.svg, svgGroup, this.rect4, this.skin.ToolButton.Color );
        }
    } else
    if ( widget.icon || widget.iconName ) {
        // --- Icon
        if ( !widget.icon ) widget.icon=VG.context.imagePool.getImageByName( widget.iconName );
        if ( widget.icon && widget.icon.isValid() )
        {
            var x=Math.round( widget.contentRect.x + (widget.contentRect.width - widget.icon.width)/2 );
            var y=Math.round( widget.contentRect.y + (widget.contentRect.height - widget.icon.height)/2 );

            canvas.drawImage( VG.Core.Point( x, y ), widget.icon );
        }
    }

    canvas.popClipRect();

    if ( widget.disabled ) canvas.setAlpha( 1 );
};


// --- ToolSeparator

VG.UI.VisualGraphicsStyle.prototype.drawToolSeparator=function( widget, canvas )
{
    this.rect1.copy( widget.rect );
    this.rect1.y+=(widget.rect.height - this.skin.ToolBar.Separator.Size.height)/2;
    this.rect1.height=this.skin.ToolBar.Separator.Size.height; this.rect1.width=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ToolBar.Separator.Color1 );
    this.rect1.x+=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ToolBar.Separator.Color2 );
};

// --- ListWidget

VG.UI.VisualGraphicsStyle.prototype.drawTreeWidget=function( widget, canvas )
{
    let itemHeight = widget.itemHeight;
    let skin = widget.customSkin ? widget.customSkin : this.skin.TreeWidget;

    // --- drawItemChildren

    function drawItemChildren( style, paintRect, item, selBackgroundRect )
    {
        if ( item.children && item.open )
        {
            let oldXOffset = paintRect.x;
            let oldWidth = paintRect.width;

            paintRect.x+=2*skin.ChildIndent;
            paintRect.width-=2*skin.ChildIndent;

            // --- Draw all childs

            for ( let i=0; i < item.children.length; ++i )
            {
                let child=item.children[i];

                ++widget._itemsCount;

                if ( 1 )//paintRect.y + this.itemHeight < ( this.rect.y+this.rect.height-2 ) )
                {
                    if ( 1 )//this._itemsCount >= this.offset )
                    {
                        widget.items.push( VG.UI.TreeWidgetItem( child, paintRect ) );
                        drawItem( style, child, widget.controller.isSelected( child ), paintRect, selBackgroundRect );

                        paintRect.y+=itemHeight + widget.spacing;
                    }

                    if ( child.children && child.open )
                        drawItemChildren( style, paintRect, child, selBackgroundRect );
                }
            }

            paintRect.x=oldXOffset;
            paintRect.width=oldWidth;
        }
    }

    // ---  drawItem

    function drawItem( style, item, isSelected, rect, contentRect, indentTop )
    {
        // --- Create the properly indented rectangle and set it to rect4

        style.rect3.copy( rect );

        if ( item.children )
        {
            style.rect3.add( skin.ChildIndent, 0, -skin.ChildIndent, 0, style.rect3 );

            if ( item.open ) {
                if ( !skin.UseTriangles ) {
                    style.rect4.x=rect.x + 5; style.rect4.width=11;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-2)/2); style.rect4.height=2;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect4, skin.ChildControlColor );
                } else {
                    style.rect4.x=rect.x + 5; style.rect4.width=10;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-2)/2); style.rect4.height=5;
                    canvas.draw2DShape( VG.Canvas.Shape2D.FlippedTriangle, style.rect4, skin.ChildControlColor );
                }
            } else {
                if ( !skin.UseTriangles ) {
                    style.rect4.x=rect.x + 5; style.rect4.width=10;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-2)/2); style.rect4.height=2;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect4, skin.ChildControlColor );

                    style.rect4.x=rect.x + 9; style.rect4.width=2;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-10)/2); style.rect4.height=10;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect4, skin.ChildControlColor );
                } else {
                    style.rect4.x=rect.x + 5; style.rect4.width=5;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-10)/2); style.rect4.height=10;
                    canvas.draw2DShape( VG.Canvas.Shape2D.ArrowRight, style.rect4, skin.ChildControlColor );
                }
            }
        } else {
            if ( indentTop ) style.rect3.add( skin.ChildIndent, 0, -skin.ChildIndent, 0, style.rect3 );
        }

        if ( skin.ItemOutline )
        {
            if ( !isSelected ) {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, style.rect3, skin.ItemBackColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect3.shrink( 1, 1, style.rect3 ), skin.ItemBackColor );
            } else {
                canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, style.rect3, skin.ItemSelectedBorderColor );
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect3.shrink( 1, 1, style.rect3 ), skin.ItemSelectedBackColor );
            }
        }

        // --- Insert Potential Child Widgets of Items
        if ( item.childWidgets ) {
            for ( let c=0; c < item.childWidgets.length; ++c ) {
                widget.childWidgets.push( item.childWidgets[c] );
            }
        }
        // ---

        if ( widget.paintItemCallback ) {
            widget.paintItemCallback( canvas, item, style.rect3, isSelected, rect );
        } else
        {
            if ( !widget.columns.length ) {
                style.rect3.x+=7; style.rect3.width-=7;
                canvas.drawTextRect( item.text, style.rect3, skin.TextColor, 0, 1 );
            } else
            {
                let offset = 0;
                for ( let i = 0; i < widget.columns.length; ++i )
                {
                    let column = widget.columns[i];

                    if ( offset > rect.width )
                        break;

                    let width = Math.floor( rect.width *  column.width / 100 );

                    if ( offset + width > rect.width )
                        width -= (offset + width) - rect.width;

                    style.rect3.x = rect.x + offset + 7;
                    style.rect3.width = width - 7;

                    canvas.drawTextRect( item[column.itemName], style.rect3, skin.TextColor, i === 0 ? 0 : 1, 1 );
                    offset += width;
                }
            }
        }

        style.rect3.copy( rect );

        if ( item.children )
        {
            style.rect3.add( skin.ChildIndent, 0, -skin.ChildIndent, 0, style.rect3 );

            if ( item.open ) {
                if ( !skin.UseTriangles ) {
                    style.rect4.x=rect.x + 5; style.rect4.width=11;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-2)/2); style.rect4.height=2;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect4, skin.ChildControlColor );
                } else {
                    style.rect4.x=rect.x + 5; style.rect4.width=10;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-2)/2); style.rect4.height=5;
                    canvas.draw2DShape( VG.Canvas.Shape2D.FlippedTriangle, style.rect4, skin.ChildControlColor );
                }
            } else {
                if ( !skin.UseTriangles ) {
                    style.rect4.x=rect.x + 5; style.rect4.width=10;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-2)/2); style.rect4.height=2;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect4, skin.ChildControlColor );

                    style.rect4.x=rect.x + 9; style.rect4.width=2;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-10)/2); style.rect4.height=10;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, style.rect4, skin.ChildControlColor );
                } else {
                    style.rect4.x=rect.x + 5; style.rect4.width=5;
                    style.rect4.y=rect.y + Math.floor( (itemHeight-10)/2); style.rect4.height=10;
                    canvas.draw2DShape( VG.Canvas.Shape2D.ArrowRight, style.rect4, skin.ChildControlColor );
                }
            }
        } else {
            if ( indentTop ) style.rect3.add( skin.ChildIndent, 0, -skin.ChildIndent, 0, style.rect3 );
        }
    }

    // ---

    if ( widget.disabled ) canvas.setAlpha( this.skin.Widget.DisabledAlpha );
    widget.contentRect.set( widget.rect );

    // --- Header

    let headerHeight = skin.Header.Height;
    if ( widget.columns.length && headerHeight ) {

        this.rect3.copy( widget.rect );
        this.rect3.height = headerHeight;

        if ( widget.paintHeaderCallback ) widget.paintHeaderCallback( canvas, this.rect3 );
        else {
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect3, skin.Header.BorderColor );
            canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect3.shrink(1,1), skin.Header.BackColor1, skin.Header.BackColor2 );
        }

        widget.contentRect.y += headerHeight;
        widget.contentRect.height -= headerHeight;
    }

    // --- Border

    if ( skin.HasBorder )
    {
        if ( widget.hasFocusState ) {
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin2px, widget.contentRect, skin.FocusBorderColor );
            widget.contentRect.shrink( 1, 1, widget.contentRect );
            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleCorners, widget.contentRect, skin.FocusBorderColor );

            canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, skin.BorderColor );
            widget.contentRect.shrink( 1, 1, widget.contentRect );
        } else
        {
            widget.contentRect.shrink( 1, 1, widget.contentRect );
            if ( widget.hasHoverState ) canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, skin.HoverBorderColor );
            else canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, widget.contentRect, skin.BorderColor );
            widget.contentRect.shrink( 1, 1, widget.contentRect );
        }
    }

    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, widget.contentRect, skin.BackColor );

    // ---

    // if ( !widget.controller || !widget.controller.length ) return;
    if ( !widget.controller ) return;

    if ( widget.toolLayout.length > 0 ) widget.contentRect.height-=this.skin.ListWidget.ToolLayoutHeight;

    canvas.pushClipRect( widget.contentRect );

    widget.contentRect.x+=this.skin.ListWidget.Margin.left;
    widget.contentRect.y+=this.skin.ListWidget.Margin.top;
    widget.contentRect.width-=2*this.skin.ListWidget.Margin.right;
    widget.contentRect.height-=2*this.skin.ListWidget.Margin.bottom;

    if ( !widget.verified || canvas.hasBeenResized )
        widget.verifyScrollbar();

    // ---

    widget.childWidgets=[];

    widget.items=null;
    widget.items=[];
    widget._itemsCount=-1;

    let selBackgroundRect=this.rect1; this.rect1.copy( widget.contentRect );
    if ( widget.needsVScrollbar ) selBackgroundRect.width-=this.skin.ScrollBar.Size;

    // ---

    let paintRect = new VG.Core.Rect( widget.contentRect );
    paintRect.height = itemHeight;

    if ( widget.needsVScrollbar ) paintRect.width-=this.skin.ScrollBar.Size;

    let oldWidth=paintRect.width;
    paintRect.y=widget.contentRect.y - widget.offset;

    // --- Check if top level items should be indented as there are other items with childs

    let indentTop=false;

    for ( let i=0; i < widget.controller.length; ++i )
    {
        // --- Iterate and Draw the Top Level Items

        item=widget.controller.at( i );
        if ( item.children ) { indentTop=true; break; }
    }

    canvas.pushFont( skin.Font );

    // --- Calc Column Dimensions

    let offset = 0;
    for ( let i = 0; i < widget.columns.length; ++i )
    {
        let column = widget.columns[i];

        if ( offset > paintRect.width )
            break;

        let width = column.fixedWidth ? column.width : (Math.floor( paintRect.width *  column.width / 100 ));

        if ( offset + width > paintRect.width )
            width -= (offset + width) - paintRect.width;

        column.pixelOffset = offset;
        column.pixelWidth = width;

        offset += width;
    }

    // ---

    for ( i=0; i < widget.controller.length; ++i )
    {
        // --- Iterate and Draw the Top Level Items

        item = widget.controller.at( i ) ;
        ++widget._itemsCount;

        if ( 1 )//paintRect.y + this.itemHeight <= this.contentRect.bottom() )
        {
            if ( 1 )//this._itemsCount >= this.offset )
            {
                widget.items.push( VG.UI.TreeWidgetItem( item, paintRect ) );
                drawItem( this, item, widget.controller.isSelected( item ), paintRect, selBackgroundRect, indentTop );

                paintRect.y += itemHeight + widget.spacing;
            }

            if ( item.children && item.open ) drawItemChildren( this, paintRect, item, selBackgroundRect );

            paintRect.x = widget.contentRect.x;
            paintRect.width = oldWidth;
        } else break;
    }

    canvas.popClipRect();

    // --- Columns Separator

    offset = 0;
    for ( let i = 0; i < widget.columns.length; ++i )
    {
        let column = widget.columns[i];

        if ( offset > paintRect.width || !headerHeight )
            break;

        let width = column.pixelWidth;

        this.rect3.x = paintRect.x + offset;
        this.rect3.y = widget.rect.y;
        this.rect3.width = width;
        this.rect3.height = headerHeight;

        if ( !column.hAlign ) {
            this.rect3.x += 7;
            this.rect3.width -= 7;
        }

        if ( !widget.paintHeaderCallback ) {
            canvas.pushFont( skin.Font );
            canvas.drawTextRect( column.name, this.rect3, skin.Header.TextColor, column.hAlign, 1 );
            canvas.popFont();
        }

        if ( i > 0 ) {
            this.rect3.x = paintRect.x + offset;
            this.rect3.y = widget.contentRect.y;
            this.rect3.width = 1;
            this.rect3.height = widget.contentRect.height;

            if ( skin.Header.ContentColumns )
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect3, skin.Header.BorderColor );

            this.rect3.y = widget.rect.y;
            this.rect3.height = headerHeight;

            if ( !widget.paintHeaderCallback )
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect3, skin.Header.BorderColor );
        }
        offset += width;
    }

    canvas.popFont();

    if ( widget.needsVScrollbar ) {
        widget.vScrollbar.rect=VG.Core.Rect( widget.rect.right() - this.skin.ScrollBar.Size - 3, widget.contentRect.y, this.skin.ScrollBar.Size, widget.contentRect.height );

        // this.totalItemHeight == Total height of all Items in the list widget including spacing
        // visibleHeight == Total height of all currently visible items
        // this.contentRect.height == Height of the available area for the list items

        widget.vScrollbar.setScrollBarContentSize( widget.totalItemHeight, widget.contentRect.height );
        widget.vScrollbar.paintWidget( canvas );
    }

    // --- Draw Tools

    if ( widget.toolLayout.length > 0 ) {
        this.rect1.copy( widget.rect ); this.rect1.shrink( 2, 2, this.rect1 );
        this.rect1.y+=this.rect1.height - this.skin.ListWidget.ToolLayoutHeight;
        this.rect2.copy( this.rect1 );
        this.rect1.height=1;//this.skin.ListWidget.ToolLayoutHeight;

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ListWidget.ToolTopBorderColor );

        this.rect1.y+=1; this.rect1.height=this.skin.ListWidget.ToolLayoutHeight-2;
        canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.ListWidget.ToolBackGradColor1, this.skin.ListWidget.ToolBackGradColor2 );

        this.rect1.y+=this.rect1.height; this.rect1.height=1;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.ListWidget.ToolBottomBorderColor );

        this.rect2.height=this.skin.ListWidget.ToolLayoutHeight;
        this.rect2.shrink( 1, 1, this.rect2 );
        widget.toolLayout.rect.copy( this.rect2 );

        widget.toolLayout.layout( canvas );
    }

    if ( widget.disabled ) canvas.setAlpha( 1 );
};

// --- drawWindow

VG.UI.VisualGraphicsStyle.prototype.drawWindow=function( widget, canvas )
{
    // --- Draw Frame and Title

    this.rect1.copy( widget.rect );
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect1, this.skin.Window.BorderColor1 );
    this.rect1.y+=this.rect1.height-2; this.rect1.height=1;
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect1, this.skin.Window.BorderColor1 );

    this.rect1.copy( widget.rect );
    this.rect1.add( 1, 1, -2, -3, this.rect1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.Window.BorderColor2 );

    this.rect1.shrink( 1, 1, this.rect1 );
    this.rect2.copy( this.rect1 );

    this.rect1.height=this.skin.Window.HeaderHeight;
    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.Window.HeaderBackGradColor1, this.skin.Window.HeaderBackGradColor2 );

    this.rect2.add( 0, this.skin.Window.HeaderHeight + 1, 0, -this.skin.Window.HeaderHeight-1, this.rect2 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.Window.BackColor );

    this.rect2.copy( this.rect1 );
    this.rect1.x+=12; this.rect1.width-=12;
    canvas.pushFont( this.skin.Window.HeaderFont );
    canvas.drawTextRect( widget.text, this.rect1, this.skin.Window.HeaderTextColor, 0, 1 );
    canvas.popFont();

    // --- Close Button

    if ( widget.supportsClose )
    {
        this.rect2.x+=this.rect2.width-21; this.rect2.y+=4;
        this.rect2.width=16; this.rect2.height=16;
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.rect2, this.skin.Window.HeaderTextColor );
        widget.closeRect.copy( this.rect2 );

        this.rect2.shrink( 1, 1, this.rect2 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect2, this.skin.Window.HeaderTextColor );

        this.rect2.shrink( 2, 2, this.rect2 );

        var imageName="windowclose";
        if ( widget.closeRect.contains( VG.context.workspace.mousePos ) ) imageName+="_hover";
        imageName+=".png";
        var image=VG.context.imagePool.getImageByName( imageName );
        if ( image ) canvas.drawImage( this.rect2, image );
    }

    // ---

    widget.contentRect.set( widget.rect.x+2, widget.rect.y + this.skin.Window.HeaderHeight + 2, widget.rect.width-2, widget.rect.height - this.skin.Window.HeaderHeight );
};

VG.UI.VisualGraphicsStyle.prototype.drawRoundedWindow=function( widget, canvas )
{
    let rect=widget.rect;

    canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangle2px, rect, this.skin.RoundedWindow.BorderColor1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangle2px, rect.shrink( 1, 1 ), this.skin.RoundedWindow.BorderColor2 );

    // ctx.fillStyle = this.skin.RoundedWindow.BackColor.toCanvasStyle();
    this.rect1.set( rect.x + 1, rect.y + this.skin.RoundedWindow.HeaderHeight, rect.width - 2, rect.height - this.skin.RoundedWindow.HeaderHeight - this.skin.RoundedWindow.FooterHeight );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.RoundedWindow.BackColor );

    canvas.pushFont( this.skin.Window.HeaderFont );
    this.rect1.set( rect.x + 12, rect.y + 1, rect.width - 2, this.skin.RoundedWindow.HeaderHeight );
    canvas.drawTextRect( widget.text, this.rect1, this.skin.Window.HeaderTextColor, 0, 1 );
    canvas.popFont();

    // --- Header Separator
    this.rect1.set( rect.x + 1, rect.y + this.skin.RoundedWindow.HeaderHeight, rect.width - 2, 1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.RoundedWindow.SepColor2 );

    this.rect1.set( rect.x + 1, rect.y + this.skin.RoundedWindow.HeaderHeight + 1, rect.width - 2, 1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.RoundedWindow.SepColor1 );

    // --- Footer Separator
    this.rect1.set( rect.x + 1, rect.y + rect.height - this.skin.RoundedWindow.FooterHeight - 1, rect.width - 2, 1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.RoundedWindow.SepColor2 );

    this.rect1.set( rect.x + 1, rect.y + rect.height - this.skin.RoundedWindow.FooterHeight, rect.width - 2, 1 );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.RoundedWindow.SepColor1 );

    // --- Close Button

    if ( widget.supportsClose ) {
        // --- Close Button

        this.rect2.x=widget.rect.right() - 10 - 10;
        this.rect2.y=widget.rect.y + 6;
        this.rect2.width=this.rect2.height=11;

        widget.closeRect.copy( this.rect2 );

        var svg=VG.Utils.getSVGByName( "glyphs.svg" );
        if ( svg ) {
            svgGroup=svg.getGroupByName( "Close" );

            let color = this.skin.Widget.TextColor;
            if ( this.rect2.contains( VG.context.workspace.mousePos ) )
                color = this.skin.ToolSettings.HoverBackColor;

            canvas.drawSVG( svg, svgGroup, this.rect2, color );
        }
    }

    // ---

    widget.contentRect.set( widget.rect.x+2, widget.rect.y + this.skin.RoundedWindow.HeaderHeight + 2, widget.rect.width-2, widget.rect.height - this.skin.RoundedWindow.FooterHeight );
};

// ----------------------------- TEMPORARY, HAS TO BE REMOVED

VG.UI.VisualGraphicsStyle.prototype.drawTableWidgetRowBackground=function( canvas, tableWidget, rowRect, layout, selected )
{
    this.rect1.copy( rowRect );
    this.rect1.x+=this.skin.TableWidget.Item.XMargin;
    this.rect1.width-=2*this.skin.TableWidget.Item.XMargin;

    if ( selected ) canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangleOutline1px, this.rect1, this.skin.TableWidget.Item.SelectedBorderColor );
    else canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangleOutline1px, this.rect1, this.skin.TableWidget.Item.BorderColor );

    this.rect1.x+=1; this.rect1.y+=1;
    this.rect1.width-=2; this.rect1.height-=4;

    if ( selected ) canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.TableWidget.Item.SelectedGradientColor1, this.skin.TableWidget.Item.SelectedGradientColor2 );
    else canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.TableWidget.Item.GradientColor1, this.skin.TableWidget.Item.GradientColor2 );

    this.rect1.y+=this.rect1.height; this.rect1.height=2;

    if ( selected ) canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TableWidget.Item.SelectedBottomColor );
    else canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TableWidget.Item.BottomColor );

    // --- Draw Separators

    for ( var i=0; i < layout.children.length; ++i )
    {
        var item=layout.children[i];

        if ( item.rect.width === 1 )
        {
            this.rect1.copy( rowRect );
            this.rect1.x=item.rect.x;
            this.rect1.width=item.rect.width;

            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect1, this.skin.TableWidget.Header.BorderColor );
        }
    }
};

VG.UI.VisualGraphicsStyle.prototype.drawTableWidgetHeaderBackground=function( canvas, rect )
{
    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, rect, this.skin.TableWidget.Header.BorderColor );

    this.rect1.copy( rect );
    this.rect1.x+=1; this.rect1.y+=1;
    this.rect1.width-=2; this.rect1.height-=2;

    canvas.draw2DShape( VG.Canvas.Shape2D.VerticalGradient, this.rect1, this.skin.TableWidget.Header.GradientColor1, this.skin.TableWidget.Header.GradientColor2 );
};

VG.UI.VisualGraphicsStyle.prototype.drawTableWidgetSeparator=function( canvas, separator )
{
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, VG.Core.Rect( separator.contentRect.x, separator.contentRect.y, 1, separator.contentRect.height ),
        this.skin.TableWidget.Header.SeparatorColor );
};

VG.UI.VisualGraphicsStyle.prototype.drawTableWidgetHeaderSeparator=function( canvas, widget )
{
};

VG.UI.VisualGraphicsStyle.prototype.drawTableWidgetFooterSeparator=function( canvas, widget )
{
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, VG.Core.Rect( widget.footerLayout.rect.x, widget.footerLayout.rect.y - this.skin.TableWidget.Footer.SeparatorHeight/2,
        widget.footerLayout.rect.width, 1 ), this.skin.TableWidget.Header.SeparatorColor );
};

// -----------------------------

VG.UI.stylePool.addStyle( new VG.UI.VisualGraphicsStyle() );
/*
 * Copyright (c) 2015-2016 Markus Moenig <markusm@visualgraphics.tv>
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.UI.VisualGraphicsGraySkin=function()
{
    this.name="Gray";
    this.path="desktop_gray";

    this.Widget={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

    	BackgroundColor : VG.Core.Color( 139, 139, 139 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),
        DisabledTextColor : VG.Core.Color( 122, 122, 122 ),
        FocusColor : VG.Core.Color( 129, 197, 242 ),

        DisabledAlpha : 0.5,
    };

    this.Label={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
    };

    this.Button={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        SmallFont : VG.Font.Font( "Open Sans Semibold", 12 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        FocusBorderColor1 : VG.Core.Color( 126, 197, 243 ),
        FocusBorderColor2 : VG.Core.Color( 128, 128, 128 ),
        FocusBorderCheckedColor2 : VG.Core.Color( 165, 165, 165 ),

        BorderColor : VG.Core.Color( 158, 158, 158 ),
        BackGradColor1 : VG.Core.Color( 185, 185, 185 ),
        BackGradColor2 : VG.Core.Color( 171, 171, 171 ),

        HoverBackGradColor1 : VG.Core.Color( 150, 150, 150 ),
        HoverBackGradColor2 : VG.Core.Color( 140, 140, 140 ),

        CheckedBackGradColor1 : VG.Core.Color( 180, 180, 180 ),
        CheckedBackGradColor2 : VG.Core.Color( 194, 194, 194 ),
    };

    this.ButtonGroup={

        Font : VG.Font.Font( "Roboto Regular", 14 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),

        NormalBorderColor : VG.Core.Color( 135, 135, 135 ),
        NormalBackColor : VG.Core.Color( 154, 154, 154 ),

        HoverBorderColor : VG.Core.Color( 224, 224, 224 ),
        HoverBackColor : VG.Core.Color( 196, 196, 196 ),

        PressedBorderColor : VG.Core.Color( 255, 255, 255 ),
        PressedBackColor : VG.Core.Color( 186, 186, 186 ),
    };

    this.CodeEdit={
        Font : VG.Font.Font( "Open Sans Semibold", 13.5 ),
        TopBorderColor : VG.Core.Color( 63, 75, 78 ),
        HeaderColor : VG.Core.Color( 63, 75, 78 ),
        HeaderTextColor : VG.Core.Color( 130, 151, 155 ),
        BackgroundColor : VG.Core.Color( 40, 48, 50 ),
        SelectionBackgroundColor : VG.Core.Color( 255, 255, 255, 120 ),
        SearchBackgroundColor : VG.Core.Color( 215, 206, 175 ),
        TextColor : VG.Core.Color( 240, 240, 240 ),
    };

    this.ContextMenu={
        Font : VG.Font.Font( "Roboto Regular", 14 ),

        TextColor : VG.Core.Color(),
        HighlightedTextColor : VG.Core.Color(),
        DisabledTextColor : VG.Core.Color( 128, 128, 128 ),

        BorderColor : VG.Core.Color( 204, 204, 204 ),
        BackColor : VG.Core.Color( 232, 232, 232 ),
        HighlightedBackColor : VG.Core.Color( 168, 211, 245 ),
        SeparatorColor : VG.Core.Color( 160, 160, 160 ),
    };

    this.DecoratedToolBar={
        Height : 44,//66,
        Spacing : 18,

        LogoColor : VG.Core.Color( 255, 255, 255 ),

        TopBorderColor : VG.Core.Color( 220, 220, 220 ),
        //TopBorderColor1 : VG.Core.Color( 171, 171, 171 ),
        //TopBorderColor2 : VG.Core.Color( 214, 214, 214 ),
        BottomBorderColor : VG.Core.Color( 114, 114, 114 ),

        BackGradColor1 : VG.Core.Color( 197, 197, 197 ),
        BackGradColor2 : VG.Core.Color( 167, 167, 167 ),

        Separator : {
            Color1 : VG.Core.Color( 136, 136, 136 ),
            Color2 : VG.Core.Color( 197, 197, 197 ),
            Size : VG.Core.Size( 2, 24 ),
        },
    };

    this.DecoratedQuickMenu={

        ButtonBackgroundColor : VG.Core.Color( 120, 120, 120 ),
        ButtonBackgroundHoverColor : VG.Core.Color( 157, 157, 157 ),
        ButtonBackgroundSelectedColor : VG.Core.Color( 111, 107, 107 ),

        StripeColor : VG.Core.Color( 55, 55, 55 ),

        HoverColor : VG.Core.Color( 255, 255, 255 ),
        Color : VG.Core.Color( 126, 126, 124 ),
        BorderColor : VG.Core.Color( 255, 255, 255 ),
        SubMenuBorderColor : VG.Core.Color( 182, 182, 182 ),
        BackgroundColor : VG.Core.Color( 88, 88, 88 ),
        ContentMargin : VG.Core.Margin( 0, 0, 0, 0 ),

        Size : VG.Core.Size( 74, 58 ),

        UsesCloseButton : false,

        Items : {

            BackGradSelectionColor1 : VG.Core.Color( 117, 117, 117 ),
            BackGradSelectionColor2 : VG.Core.Color( 85, 85, 85 ),

            Size : VG.Core.Size( 306, 42 ),
            TextColor : VG.Core.Color( 255, 255, 255 ),
            DisabledTextColor : VG.Core.Color( 128, 128, 128 ),
            Font : VG.Font.Font( "Open Sans Semibold", 14 ),
        }
    };

    this.DockWidget={

        BackColor : VG.Core.Color( 147, 147, 147 ),
        FloatingBorderColor : VG.Core.Color( 126, 197, 243 ),

        HeaderHeight : 21,
        HeaderFont : VG.Font.Font( "Open Sans Bold", 12 ),
        HeaderBorderColor : VG.Core.Color( 102, 102, 102 ),
        HeaderBackGradColor1 : VG.Core.Color( 125, 125, 125 ),
        HeaderBackGradColor2 : VG.Core.Color( 114, 114, 114 ),

        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.DropDownMenu={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),

        FocusBorderColor : VG.Core.Color( 126, 197, 243 ),
        BorderColor : VG.Core.Color( 213, 213, 213 ),
        HoverBorderColor : VG.Core.Color( 220, 220, 220 ),

        BackGradColor1 : VG.Core.Color( 193, 193, 193 ),
        BackGradColor2 : VG.Core.Color( 171, 171, 171 ),

        HoverBackGradColor1 : VG.Core.Color( 202, 202, 202 ),
        HoverBackGradColor2 : VG.Core.Color( 186, 186, 186 ),

        SepColor1 : VG.Core.Color( 213, 213, 213 ),
        SepColor2 : VG.Core.Color( 164, 164, 164 ),

        ItemBorderColor : VG.Core.Color( 239, 239, 239 ),
        ItemBackColor : VG.Core.Color( 194, 194, 194 ),
        ItemSelectedBackColor : VG.Core.Color( 168, 211, 245 ),
        ItemTextColor : VG.Core.Color( 255, 255, 255 ),
        ItemSelectedTextColor : VG.Core.Color( 85, 85, 85 ),
    };

    this.HtmlWidget={

        h1 : {
            Font : VG.Font.Font( "Open Sans Bold", 26 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 10, 10, 20, 10 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        h2 : {
            Font : VG.Font.Font( "Open Sans Bold", 18 ),
            Color : VG.Core.Color( "#e452ef" ),

            Margin : VG.Core.Margin( 10, 5, 10, 5 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        h4 : {
            Font : VG.Font.Font( "Open Sans Bold", 13 ),
            Color : VG.Core.Color( 204, 204, 204 ),

            Margin : VG.Core.Margin( 10, 10, 10, 10 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        p : {
            Font : VG.Font.Font( "Open Sans Semibold", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 10, 5, 10, 5 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        svg : {
            Color : VG.Core.Color( 244, 244, 244 ),
            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        img : {
            Margin : VG.Core.Margin( 10, 10, 10, 10 ),
            LineFeed : true,
        },
        b : {
            Font : VG.Font.Font( "Open Sans Bold", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        i : {
            Font : VG.Font.Font( "Open Sans Semibold Italic", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        a : {
            Font : VG.Font.Font( "Open Sans Semibold", 13 ),
            Color : VG.Core.Color( 126, 197, 243 ),
            Link : true,

            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        ul : {
            Margin : VG.Core.Margin( 30, 0, 5, 5 ),
            ResetLayout : true,
            LineFeed : true,
        },
        li : {
            Font : VG.Font.Font( "Open Sans Semibold", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 5, 5, 5, 5 ),
            LineFeed : true,
        },
        br : {
            Margin : VG.Core.Margin( 0, 15, 0, 0 ),
            LineFeed : true,
        }
    };

    this.HtmlView={
        FontName : "Open Sans Semibold",
        BoldFontName : "Open Sans Bold",
        ItalicFontName : "Open Sans Semibold Italic",
    };

    this.IconWidget={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 203, 203, 203 ),

        FocusBorderColor : VG.Core.Color( 126, 197, 243 ),
        BorderColor : VG.Core.Color( 213, 213, 213 ),
        HoverBorderColor : VG.Core.Color( 220, 220, 220 ),

        BackColor : VG.Core.Color( 120, 120, 120 ),

        Spacing : VG.Core.Size( 5, 5 ),
        Margin : VG.Core.Margin( 5, 5, 5, 5 ),

        ItemBackColor : VG.Core.Color( 192, 192, 192 ),
        ItemSelectedBorderColor : VG.Core.Color( 126, 197, 243 ),
        ItemSelectedBackColor : VG.Core.Color( 168, 211, 245 ),

        ItemCustomContentBorderColor : VG.Core.Color( 139, 139, 139 ),

        ToolLayoutHeight : 28,
        ToolTopBorderColor : VG.Core.Color( 194, 194, 194 ),
        ToolBottomBorderColor : VG.Core.Color( 111, 111, 111 ),
        ToolBackGradColor1 : VG.Core.Color( 174, 174, 174 ),
        ToolBackGradColor2 : VG.Core.Color( 131, 131, 131 ),
    };

    this.ListWidget={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 85, 81, 85 ),

        FocusBorderColor : VG.Core.Color( 126, 197, 243 ),
        BorderColor : VG.Core.Color( 213, 213, 213 ),
        HoverBorderColor : VG.Core.Color( 220, 220, 220 ),

        BackColor : VG.Core.Color( 120, 120, 120 ),

        Spacing : 2,
        Margin : VG.Core.Margin( 2, 2, 2, 2 ),

        ItemBackColor : VG.Core.Color( 192, 192, 192 ),
        ItemSelectedBorderColor : VG.Core.Color( 126, 197, 243 ),
        ItemSelectedBackColor : VG.Core.Color( 168, 211, 245 ),

        ItemCustomContentBorderColor : VG.Core.Color( 139, 139, 139 ),

        ToolLayoutHeight : 28,
        ToolTopBorderColor : VG.Core.Color( 194, 194, 194 ),
        ToolBottomBorderColor : VG.Core.Color( 111, 111, 111 ),
        ToolBackGradColor1 : VG.Core.Color( 174, 174, 174 ),
        ToolBackGradColor2 : VG.Core.Color( 131, 131, 131 ),
    };

    this.Menu={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        ShortcutFont : VG.Font.Font( "Open Sans Semibold", 13 ),
        BorderColor : VG.Core.Color( 239, 239, 239 ),
        SeparatorColor : VG.Core.Color( 224, 224, 224 ),
        BackColor : VG.Core.Color( 194, 194, 194 ),
        DisabledTextColor : VG.Core.Color( 128, 128, 128 ),
        HighlightedTextColor : VG.Core.Color( 85, 85, 85 ),
        HighlightedBackColor : VG.Core.Color( 168, 211, 245 ),
        HighlightedBorderColor : VG.Core.Color( 126, 197, 243 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.MenuBar={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        Height : 21,
        BorderSize : 0,

        TopBorderColor : VG.Core.Color( 172, 172, 172 ),
        BottomBorderColor : VG.Core.Color( 172, 172, 172 ),

        BackColor : VG.Core.Color( 172, 172, 172 ),
        SelectedBackColor : VG.Core.Color( 61, 61, 61 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),
        SelectedTextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.Nodes={

        Font : VG.Font.Font( "Open Sans Semibold", 12 ),

        BackColor : VG.Core.Color( 128, 128, 128 ),
        BackLineColor : VG.Core.Color( 74, 74, 74 ),
        GridSize : 45,

        BorderColor : VG.Core.Color( 244, 244, 244 ),
        TopColor : VG.Core.Color( 65, 65, 65 ),
        SeparatorColor : VG.Core.Color.Black,
        BodyColor : VG.Core.Color( 192, 192, 192 ),

        TitleTextColor : VG.Core.Color( 195, 195, 195 ),
        TerminalTextColor : VG.Core.Color( 76, 76, 76 ),

        TextureTerminalColor : VG.Core.Color( 0, 95, 185),//49, 136, 40 ),
        MaterialTerminalColor : VG.Core.Color( 190, 171, 0 ),
        VectorTerminalColor : VG.Core.Color(),//0, 95, 185 ),
        FloatTerminalColor : VG.Core.Color( 95, 54, 136 ),
    };

    this.ScrollBar={
        Size : 14,
        BorderColor : VG.Core.Color( 119, 119, 119 ),
        BackColor : VG.Core.Color( 139, 139, 139 ),
    };

    this.SectionBar={

        BackColor : VG.Core.Color( 163, 163, 163 ),
        BorderColor : VG.Core.Color( 133, 133, 133 ),

        HeaderHeight : 21,
        HeaderFont : VG.Font.Font( "Open Sans Bold", 12 ),
        HeaderBorderColor : VG.Core.Color( 102, 102, 102 ),
        HeaderBackGradColor1 : VG.Core.Color( 125, 125, 125 ),
        HeaderBackGradColor2 : VG.Core.Color( 114, 114, 114 ),

        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        Separator : {
            Height : 2,
            Color1 : VG.Core.Color( 136, 136, 136 ),
            Color2 : VG.Core.Color( 197, 197, 197 ),
        }
    };

    this.SectionBarButton={

        Font : VG.Font.Font( "Open Sans Bold", 12 ),

        Size : VG.Core.Size( 81, 47 ),

        BorderColor : VG.Core.Color( 94, 94, 94 ),
        BackGradColor1 : VG.Core.Color( 80, 80, 80 ),
        BackGradColor2 : VG.Core.Color( 72, 72, 72 ),

        HoverBorderColor : VG.Core.Color( 107, 107, 107 ),
        HoverBackGradColor1 : VG.Core.Color( 94, 94, 94 ),
        HoverBackGradColor2 : VG.Core.Color( 86, 86, 86 ),

        SelectedBorderColor : VG.Core.Color( 242, 242, 242 ),
        SelectedBackGradColor1 : VG.Core.Color( 242, 242, 242 ),
        SelectedBackGradColor2 : VG.Core.Color( 242, 242, 242 ),
        SelectedTextColor : VG.Core.Color( 96, 96, 96 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.SectionBarSwitch={

        Font : VG.Font.Font( "Open Sans Bold", 12 ),

        Size : VG.Core.Size( 81, 32 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.SectionToolBar={

        BackColor : VG.Core.Color( 163, 163, 163 ),
        BorderColor1 : VG.Core.Color( 126, 126, 126 ),
        BorderColor2 : VG.Core.Color( 160, 160, 160 ),

        HeaderTopBorderColor : VG.Core.Color( 194, 194, 194 ),
        HeaderGradColor1 : VG.Core.Color( 174, 174, 174 ),
        HeaderGradColor2 : VG.Core.Color( 139, 139, 139 ),
        HeaderBottomBorderColor1 : VG.Core.Color( 132, 132, 132 ),
        HeaderBottomBorderColor2 : VG.Core.Color( 111, 111, 111 ),

        HeaderFont : VG.Font.Font( "Open Sans Bold", 12 ),
        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        Separator : {
            Height : 2,
            Color1 : VG.Core.Color( 136, 136, 136 ),
            Color2 : VG.Core.Color( 197, 197, 197 ),
        }
    };

    this.SectionToolBarButton={

        Size : VG.Core.Size( 46, 43 ),

        BorderColor : VG.Core.Color( 135, 135, 135 ),
        BorderHoverColor : VG.Core.Color( 224, 224, 224 ),
        BorderSelectedColor : VG.Core.Color( 255, 255, 255 ),

        BackHoverColor : VG.Core.Color( 196, 196, 196 ),
        BackSelectedColor : VG.Core.Color( 186, 186, 186 ),
    };

    this.Slider={

        FocusHoverBarColors : {
        	Color1 : VG.Core.Color( 219, 219, 219 ),
            Color2 : VG.Core.Color( 190, 190, 190 ),
        	Color3 : VG.Core.Color( 218, 218, 218 ),
            Color4 : VG.Core.Color( 235, 235, 235 ),
        },

        BarColors : {
        	Color1 : VG.Core.Color( 187, 187, 187 ),
            Color2 : VG.Core.Color( 170, 170, 170 ),
        	Color3 : VG.Core.Color( 186, 186, 186 ),
            Color4 : VG.Core.Color( 197, 197, 197 ),
        },

    	HandleSize : 13,
    	BarHeight : 4
    };

    this.RoundSlider={

        FocusHoverBarColors : {
            Color1 : VG.Core.Color( 219, 219, 219 ),
            Color2 : VG.Core.Color( 190, 190, 190 ),
            Color3 : VG.Core.Color( 218, 218, 218 ),
        },

        LeftTrackColors : {
            Color1 : VG.Core.Color( 130, 130, 130 ),
            Color2 : VG.Core.Color( 139, 139, 139 ),
            Color3 : VG.Core.Color( 175, 175, 175 ),
        },

        RightTrackColors : {
            Color1 : VG.Core.Color( 75, 75, 75 ),
            Color2 : VG.Core.Color( 90, 90, 90 ),
            Color3 : VG.Core.Color( 149, 149, 149 ),
        },

        HandleSize : 14,
        BarHeight : 3,

        KnobColor : VG.Core.Color( 221, 221, 221 ),
        OuterKnobColor : VG.Core.Color( 221, 221, 221, 128 ),
        SelectedOuterKnobColor : VG.Core.Color( 126, 197, 243 )
    };

    this.SnapperWidgetItem={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        Height : 22,

        TopBorderColor : VG.Core.Color( 194, 194, 194 ),
        BottomBorderColor : VG.Core.Color( 111, 111, 111 ),
        BackGradColor1 : VG.Core.Color( 174, 174, 174 ),
        BackGradColor2 : VG.Core.Color( 132, 132, 132 ),

        HoverTopBorderColor : VG.Core.Color( 202, 202, 202 ),
        HoverBottomBorderColor : VG.Core.Color( 130, 130, 130 ),
        HoverBackGradColor1 : VG.Core.Color( 184, 184, 184 ),
        HoverBackGradColor2 : VG.Core.Color( 148, 148, 148 ),

        SelectedTopBorderColor : VG.Core.Color( 169, 169, 169 ),
        SelectedBottomBorderColor : VG.Core.Color( 97, 97, 97 ),
        SelectedBackGradColor1 : VG.Core.Color( 151, 151, 151 ),
        SelectedBackGradColor2 : VG.Core.Color( 116, 116, 116 ),
    };

    this.SplitLayout={

        Size : 7,

        BackColor : VG.Core.Color( 133, 133, 133 ),
        BorderColor : VG.Core.Color( 160, 160, 160 ),

        DragBackColor : VG.Core.Color( 132, 132, 132 ),
        DragBorderColor : VG.Core.Color( 239, 239, 239 ),

        HoverBackColor : VG.Core.Color( 185, 185, 185 ),
        HoverBorderColor : VG.Core.Color( 239, 239, 239 ),
    };

    this.StatusBar={

        BorderColor : VG.Core.Color( 132, 132, 132 ),
        BackColor : VG.Core.Color( 147, 147, 147 ),
        Height : 20,
    };

    this.TabWidgetHeader={

        Font : VG.Font.Font( "Open Sans Semibold", 14 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),
        Height : 32,

        SelectedEdgeBorderColor : VG.Core.Color( 171, 171, 171 ),
        SelectedTopBorderColor : VG.Core.Color( 184, 184, 184 ),
        SelectedSideBorderColor1 : VG.Core.Color( 179, 179, 179 ),
        SelectedSideBorderColor2 : VG.Core.Color( 165, 161, 161 ),

        SelectedBackGradientColor1 : VG.Core.Color( 186, 186, 186 ),
        SelectedBackGradientColor2 : VG.Core.Color( 178, 178, 178 ),

        HoverBackGradientColor1 : VG.Core.Color( 156, 156, 156 ),
        HoverBackGradientColor2 : VG.Core.Color( 139, 139, 139 ),

        BackGradientColor1 : VG.Core.Color( 165, 165, 165 ),
        BackGradientColor2 : VG.Core.Color( 149, 149, 149 ),

        LeftBorderColor : VG.Core.Color( 183, 183, 183 ),
        TabBorderColor : VG.Core.Color( 214, 214, 214 ),
        BottomBorderColor1 : VG.Core.Color( 153, 153, 153 ),
        BottomBorderColor2 : VG.Core.Color( 178, 178, 178 ),
    };


    this.TabWidgetSmallHeader={

        Font : VG.Font.Font( "Open Sans Semibold", 12 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),
        Height : 22,

        SelectedEdgeBorderColor : VG.Core.Color( 171, 171, 171 ),
        SelectedTopBorderColor : VG.Core.Color( 184, 184, 184 ),
        SelectedSideBorderColor1 : VG.Core.Color( 179, 179, 179 ),
        SelectedSideBorderColor2 : VG.Core.Color( 165, 161, 161 ),

        SelectedBackGradientColor1 : VG.Core.Color( 186, 186, 186 ),
        SelectedBackGradientColor2 : VG.Core.Color( 178, 178, 178 ),

        HoverBackGradientColor1 : VG.Core.Color( 156, 156, 156 ),
        HoverBackGradientColor2 : VG.Core.Color( 139, 139, 139 ),

        BackGradientColor1 : VG.Core.Color( 165, 165, 165 ),
        BackGradientColor2 : VG.Core.Color( 149, 149, 149 ),

        LeftBorderColor : VG.Core.Color( 183, 183, 183 ),
        TabBorderColor : VG.Core.Color( 214, 214, 214 ),
        BottomBorderColor1 : VG.Core.Color( 153, 153, 153 ),
        BottomBorderColor2 : VG.Core.Color( 178, 178, 178 ),
    };

    this.TextEdit={

        Font : VG.Font.Font( "Roboto Regular", 14 ),

        TextColor : VG.Core.Color( 242, 242, 242 ),
        DefaultTextColor : VG.Core.Color( 71, 71, 71 ),

        FocusBorderColor1 : VG.Core.Color( 168, 211, 245 ),
        FocusBorderColor2 : VG.Core.Color( 126, 197, 243 ),
        FocusBorderColor3 : VG.Core.Color( 119, 119, 119 ),
        FocusBackgroundColor : VG.Core.Color( 139, 139, 139 ),

        BackgroundColor : VG.Core.Color( 164, 164, 164 ),
        BorderColor1 : VG.Core.Color( 209, 209, 209 ),
        BorderColor2 : VG.Core.Color( 149, 149, 149 ),
    };

    this.TextLineEdit={

    	Font : VG.Font.Font( "Roboto Regular", 14 ),

    	TextColor : VG.Core.Color( 242, 242, 242 ),
        DefaultTextColor : VG.Core.Color( 71, 71, 71 ),

    	FocusBorderColor1 : VG.Core.Color( 168, 211, 245 ),
    	FocusBorderColor2 : VG.Core.Color( 126, 197, 243 ),
    	FocusBorderColor3 : VG.Core.Color( 147, 147, 147 ),
    	FocusBackgroundColor : VG.Core.Color( 139, 139, 139 ),

    	BackgroundColor : VG.Core.Color( 164, 164, 164 ),
    	BorderColor1 : VG.Core.Color( 209, 209, 209 ),
    	BorderColor2 : VG.Core.Color( 149, 149, 149 ),
    };

    this.TitleBar={

        Height : 20,
        Font : VG.Font.Font( "Open Sans Semibold", 12.5 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        BorderColor : VG.Core.Color( 102, 102, 102 ),

        BackGradColor1 : VG.Core.Color( 125, 125, 125 ),
        BackGradColor2 : VG.Core.Color( 114, 114, 114 ),
    };

    this.ToolBar={
        Height : 33,

        TopBorderColor : VG.Core.Color( 102, 102, 102 ),
        BottomBorderColor : VG.Core.Color( 160, 160, 160 ),

        BackGradColor : VG.Core.Color( 120, 120, 120 ),

        Separator : {
            Color1 : VG.Core.Color( 102, 102, 102 ),
            Color2 : VG.Core.Color( 148, 148, 148 ),
            Size : VG.Core.Size( 2, 28 ),
        },

        IconSize : VG.Core.Size( 32, 27 ),
    };

    this.ToolBarButton={

        Font : VG.Font.Font( "Roboto Regular", 14 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        BorderColor : VG.Core.Color( 158, 158, 158 ),
        BackColor : VG.Core.Color( 163, 163, 163 ),

        HoverBorderColor : VG.Core.Color( 224, 224, 224 ),
        HoverBackColor : VG.Core.Color( 163, 163, 163 ),

        ClickedBorderColor : VG.Core.Color( 255, 255, 255 ),
        ClickedBackColor : VG.Core.Color( 186, 186, 186 ),

        TextMargin : VG.Core.Size( 10, 0 ),
        IconSize : VG.Core.Size( 24, 24 ),

        MinimumWidth : 45,
    };

    this.ToolButton={

        Color : VG.Core.Color( 255, 255, 255 ),

        BorderColor : VG.Core.Color( 158, 158, 158 ),
        BackColor : VG.Core.Color( 163, 163, 163 ),

        HoverBorderColor : VG.Core.Color( 224, 224, 224 ),
        HoverBackColor : VG.Core.Color( 163, 163, 163 ),

        ClickedBorderColor : VG.Core.Color( 255, 255, 255 ),
        ClickedBackColor : VG.Core.Color( 186, 186, 186 ),

        Size : VG.Core.Size( 46, 43 ),
        Margin : VG.Core.Size( 3, 3 ),

        MinimumWidth : 45,
    };

    this.ToolSettings={

        HeaderFont : VG.Font.Font( "Open Sans Bold", 13 ),

        BackColor : VG.Core.Color( 123, 123, 123 ),
        BorderColor : VG.Core.Color( 108, 108, 108 ),

        HoverBackColor : VG.Core.Color( 157, 157, 157 ),
        HoverBorderColor : VG.Core.Color( 179, 179, 179 ),

        OpenBorderColor : VG.Core.Color( 204, 204, 204 ),
        OpenBackColor : VG.Core.Color( 149, 149, 149 ),

        ContentBorderColor : VG.Core.Color( 146, 146, 146 ),
        ContentBackColor : VG.Core.Color( 116, 116, 116 ),

        Size : VG.Core.Size( 21, 20 ),
    };

    this.ToolTip={

        TitleFont : VG.Font.Font( "Open Sans Bold", 14 ),
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        BorderColor : VG.Core.Color( 181, 181, 181 ),
        BackColor : VG.Core.Color( 123, 123, 123 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        BorderSize : VG.Core.Size( 11, 15 ),
    };

    this.TreeWidget={

        Header : {
            Height : 22,
            BorderColor : VG.Core.Color( 82, 82, 82 ),
            BackColor1 : VG.Core.Color( 134, 134, 134 ),
            BackColor2 : VG.Core.Color( 118, 118, 118 ),
            TextColor : VG.Core.Color( 236, 239, 243 ),
        },

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 85, 81, 85 ),

        FocusBorderColor : VG.Core.Color( 126, 197, 243 ),
        BorderColor : VG.Core.Color( 213, 213, 213 ),
        HoverBorderColor : VG.Core.Color( 220, 220, 220 ),

        BackColor : VG.Core.Color( 120, 120, 120 ),

        Spacing : 3,
        Margin : VG.Core.Margin( 2, 2, 2, 2 ),

        UseTriangles: false,
        HasBorder: true,

        ItemOutline: true,
        ItemBackColor : VG.Core.Color( 192, 192, 192 ),
        ItemSelectedBorderColor : VG.Core.Color( 126, 197, 243 ),
        ItemSelectedBackColor : VG.Core.Color( 168, 211, 245 ),

        ToolLayoutHeight : 28,

        ToolTopBorderColor : VG.Core.Color( 191, 191, 191 ),
        ToolBottomBorderColor : VG.Core.Color( 111, 111, 111 ),
        ToolBackGradColor1 : VG.Core.Color( 148, 148, 148 ),
        ToolBackGradColor2 : VG.Core.Color( 142, 142, 142 ),

        ChildIndent : 20,
        ChildControlColor : VG.Core.Color( 227, 227, 227 ),
    };

    this.Window={
        HeaderHeight : 25,

        HeaderFont : VG.Font.Font( "Open Sans Semibold", 14 ),
        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        BackColor : VG.Core.Color( 120, 120, 120 ),

        BorderColor1 : VG.Core.Color( 179, 179, 179 ),
        BorderColor2 : VG.Core.Color( 239, 239, 239 ),

        HeaderBackGradColor1 : VG.Core.Color( 219, 219, 219 ),
        HeaderBackGradColor2 : VG.Core.Color( 198, 198, 198 ),
    };

    this.RoundedWindow={
        HeaderHeight : 20,
        FooterHeight : 15,

        HeaderFont : VG.Font.Font( "Open Sans Semibold", 14 ),
        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        BackColor : VG.Core.Color( 116, 116, 116 ),

        BorderColor1 : VG.Core.Color( 182, 182, 182 ),
        BorderColor2 : VG.Core.Color( 130, 130, 130 ),

        SepColor1 : VG.Core.Color( 148, 148, 148 ),
        SepColor2 : VG.Core.Color( 102, 102, 102 ),
    };

    // --- TEMPORARY, TABLEWIDGET HAS TO BE REMOVED

    this.TableWidget = {
                Font : VG.Font.Font( "Roboto Regular", 14 ),
                TextColor : VG.Core.Color( 244, 244, 244 ),
                DisabledSeparatorColor : VG.Core.Color( 48, 48, 48 ),
                SelectionColor : VG.Core.Color(  44, 55, 71 ),
                SeparatorWidth : 1,
                ContentMargin : VG.Core.Margin( 0, 0, 0, 6 ),
                RowHeight : 28,

                Header : {
                    Font : VG.Font.Font( "Roboto Regular", 13 ),
                    SeparatorHeight : 3,
                    SeparatorColor : VG.Core.Color( 117, 117, 117 ),
                    Height : 23,
                    BorderColor : VG.Core.Color( 117, 117, 117 ),
                    GradientColor1 : VG.Core.Color( 169, 169, 169 ),
                    GradientColor2 : VG.Core.Color( 148, 148, 148 ),
                    TextXOffset : 10,
                },
                Footer : {
                    SeparatorHeight : 16,
                    Margin : VG.Core.Margin( 10, 0, 0, 0 ),
                    Height : 24,
                },

                Item : {

                    BorderColor : VG.Core.Color( 216, 216, 216 ),
                    SelectedBorderColor : VG.Core.Color( 186, 223, 248 ),

                    GradientColor1 : VG.Core.Color( 183, 183, 183 ),
                    GradientColor2 : VG.Core.Color( 186, 186, 186 ),
                    BottomColor : VG.Core.Color( 186, 186, 186 ),

                    SelectedGradientColor1 : VG.Core.Color( 128, 196, 242 ),
                    SelectedGradientColor2 : VG.Core.Color( 132, 198, 241 ),
                    SelectedBottomColor : VG.Core.Color( 132, 198, 241 ),

                    XMargin : 2,
                    Spacing : 2,
                },
            };


    // ---
};

VG.UI.VisualGraphicsGraySkin.prototype.activate=function()
{
	this.prefix=this.style.prefix + "gray_";

	let path=this.style.path + "/" + this.path;

    // --- ScrollBar

    VG.loadStyleImage( path, this.prefix + "scrollbar_vtop.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_vmiddle.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_vbottom.png" );

    VG.loadStyleImage( path, this.prefix + "scrollbar_vtop_selected.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_vmiddle_selected.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_vbottom_selected.png" );

    VG.loadStyleImage( path, this.prefix + "scrollbar_vtop_hover.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_vmiddle_hover.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_vbottom_hover.png" );

    VG.loadStyleImage( path, this.prefix + "scrollbar_hleft.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_hmiddle.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_hright.png" );

    VG.loadStyleImage( path, this.prefix + "scrollbar_hleft_selected.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_hmiddle_selected.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_hright_selected.png" );

    VG.loadStyleImage( path, this.prefix + "scrollbar_hleft_hover.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_hmiddle_hover.png" );
    VG.loadStyleImage( path, this.prefix + "scrollbar_hright_hover.png" );

    // --- Switch

    VG.loadStyleImage( path, this.prefix + "darrow_left.png" );
    VG.loadStyleImage( path, this.prefix + "darrow_right.png" );

	// --- CheckBox

	VG.loadStyleImage( path, this.prefix + "checkbox_focus.png" );
	VG.loadStyleImage( path, this.prefix + "checkbox_focus_checked.png" );

	VG.loadStyleImage( path, this.prefix + "checkbox_hover.png" );
	VG.loadStyleImage( path, this.prefix + "checkbox_hover_checked.png" );

	VG.loadStyleImage( path, this.prefix + "checkbox.png" );
	VG.loadStyleImage( path, this.prefix + "checkbox_checked.png" );

	// --- Slider

	// VG.loadStyleImage( path, this.prefix + "slider_focus.png" );
	// VG.loadStyleImage( path, this.prefix + "slider_hover.png" );
	// VG.loadStyleImage( path, this.prefix + "slider.png" );

    // --- Main bar icons

    VG.Shaders = { fs : [] };
    VG.Shaders.fs[ this.prefix + "undo.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <path fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" d="M16.081,12.62c-2.344-2.344-6.142-2.344-8.485,0l3.182,3.182
        l-7.071,0.001V8.731l2.475,2.475c3.125-3.124,8.182-3.115,11.306,0.009c0.78,0.781,1.774,1.658,2.091,2.091l-1.405,1.405
        C17.808,14.369,16.851,13.389,16.081,12.62z"/>
    <g opacity="0.1">
        <path d="M3.706,8.731l2.475,2.475c1.56-1.56,3.602-2.338,5.644-2.338c2.048,0,4.097,0.783,5.662,2.348
            c0.78,0.781,1.774,1.658,2.091,2.091l-1.405,1.405c-0.364-0.342-1.321-1.322-2.091-2.091c-1.172-1.172-2.707-1.758-4.243-1.758
            s-3.071,0.586-4.243,1.758l3.182,3.182l-7.071,0.001V8.731 M2.706,6.317v2.414v7.072v1h1l7.071-0.001h2.414l-1.707-1.707
            L9.08,12.69c0.811-0.539,1.763-0.828,2.758-0.828c1.335,0,2.591,0.52,3.536,1.465c0.276,0.275,0.575,0.578,0.863,0.868
            c0.525,0.53,1.012,1.021,1.25,1.245l0.707,0.662l0.685-0.685l1.405-1.405l0.605-0.605l-0.505-0.692
            c-0.26-0.354-0.767-0.838-1.354-1.398c-0.28-0.266-0.571-0.543-0.837-0.81c-1.703-1.703-3.965-2.641-6.369-2.641
            c-2.062,0-4.019,0.691-5.605,1.963L4.413,8.024L2.706,6.317L2.706,6.317z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "redo.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <path fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" d="M5.111,14.711l-1.405-1.405c0.316-0.433,1.311-1.31,2.091-2.091
        c3.124-3.124,8.181-3.133,11.306-0.009l2.475-2.475v7.072l-7.071-0.001l3.182-3.182c-2.344-2.344-6.142-2.344-8.485,0
        C6.433,13.389,5.476,14.369,5.111,14.711z"/>
    <g opacity="0.1">
        <path d="M19.577,8.731v7.072l-7.071-0.001l3.182-3.182c-1.172-1.172-2.707-1.758-4.243-1.758c-1.535,0-3.071,0.586-4.243,1.758
            c-0.77,0.769-1.727,1.749-2.091,2.091l-1.405-1.405c0.316-0.433,1.311-1.31,2.091-2.091C7.361,9.65,9.41,8.867,11.458,8.867
            c2.042,0,4.083,0.779,5.644,2.338L19.577,8.731 M20.577,6.317L18.87,8.024L17.063,9.83c-1.587-1.272-3.543-1.963-5.605-1.963
            c-2.404,0-4.666,0.938-6.369,2.641c-0.266,0.266-0.557,0.543-0.837,0.81c-0.587,0.56-1.095,1.043-1.354,1.398l-0.506,0.692
            l0.606,0.605l1.405,1.405l0.685,0.685l0.706-0.662c0.238-0.224,0.725-0.715,1.25-1.245c0.288-0.29,0.587-0.593,0.863-0.867
            c0.945-0.946,2.201-1.466,3.536-1.466c0.996,0,1.947,0.289,2.758,0.828l-2.404,2.404l-1.707,1.707h2.414l7.071,0.001h1v-1V8.731
            V6.317L20.577,6.317z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "new.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" points="21,10.999 14.42,10.999 19.073,6.345 17.655,4.928
        13.002,9.581 13.002,3 10.997,3 10.997,9.58 6.345,4.928 4.927,6.345 9.58,10.999 3,10.999 3,13.002 9.58,13.002 4.927,17.656
        6.345,19.073 10.997,14.421 10.997,21 13.002,21 13.002,14.42 17.655,19.073 19.073,17.656 14.42,13.002 21,13.002 "/>
    <g opacity="0.1">
        <path d="M13.002,3v6.581l4.653-4.653l1.418,1.417l-4.653,4.654H21v2.003h-6.58l4.653,4.654l-1.418,1.417l-4.653-4.653V21h-2.005
            v-6.579l-4.652,4.652l-1.418-1.417l4.653-4.654H3v-2.003h6.58L4.927,6.345l1.418-1.417l4.652,4.652V3H13.002 M14.002,2h-1h-2.005
            h-1v1v4.166L7.052,4.221L6.345,3.514L5.638,4.22L4.22,5.637L3.512,6.344L4.22,7.052l2.946,2.947H3H2v1v2.003v1h1h4.166L4.22,16.949
            l-0.708,0.707l0.708,0.707l1.418,1.417l0.707,0.707l0.707-0.707l2.945-2.945V21v1h1h2.005h1v-1v-4.166l2.946,2.946l0.707,0.707
            l0.707-0.707l1.418-1.417l0.707-0.707l-0.707-0.707l-2.946-2.947H21h1v-1v-2.003v-1h-1h-4.166l2.946-2.947l0.707-0.708L19.78,5.637
            L18.362,4.22l-0.707-0.707l-0.707,0.707l-2.946,2.946V3V2L14.002,2z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "open.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <g>
        <polygon fill="#DFDFDF" points="13.016,15.977 17,15.977 12,20.977 7,15.977 11.016,15.977 11.016,10.708 13.016,10.708 	"/>
        <polygon fill="#DFDFDF" points="18,10.999 16,10.999 16,4.999 8,4.999 8,10.999 6,10.999 6,2.999 6.984,2.999 8,2.999 16,2.999
            17,2.999 18,2.999 	"/>
        <g opacity="0.1">
            <path d="M13.016,10.708v5.271H17l-5,5l-5-5h4.016v-5.271H13.016 M14.016,9.708h-1h-2h-1v1v4.271H7H4.586l1.707,1.707l5,5
                L12,22.393l0.707-0.707l5-5l1.707-1.707H17h-2.984v-4.271V9.708L14.016,9.708z"/>
        </g>
        <g opacity="0.1">
            <path d="M18,2.999v8h-2v-6H8v6H6v-8h0.984H8h8h1H18 M19,1.999h-1h-1h-1H8H6.984H6H5v1v8v1h1h2h1v-1v-5h6v5v1h1h2h1v-1v-8V1.999
                L19,1.999z"/>
        </g>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "save.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <g>
        <polygon fill="#DFDFDF" points="13.016,8.008 17,8.008 12,3.008 7,8.008 11.016,8.008 11.016,13.279 13.016,13.279 	"/>
        <polygon fill="#DFDFDF" points="18,12.988 16,12.988 16,18.988 8,18.988 8,12.988 6,12.988 6,20.988 6.984,20.988 8,20.988
            16,20.988 17,20.988 18,20.988 	"/>
        <g opacity="0.1">
            <path d="M12,3.008l5,5h-3.984v5.271h-2V8.008H7L12,3.008 M12,1.594l-0.707,0.707l-5,5L4.586,9.008H7h3.016v4.271v1h1h2h1v-1V9.008
                H17h2.414l-1.707-1.707l-5-5L12,1.594L12,1.594z"/>
        </g>
        <g opacity="0.1">
            <path d="M18,12.988v8h-1h-1H8H6.984H6v-8h2v6h8v-6H18 M19,11.988h-1h-2h-1v1v5H9v-5v-1H8H6H5v1v8v1h1h0.984H8h8h1h1h1v-1v-8
                V11.988L19,11.988z"/>
        </g>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "saveas.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <g>
        <g>
            <polygon fill="#DFDFDF" points="12.962,7.986 16.946,7.986 11.946,2.986 6.946,7.986 10.962,7.986 10.962,13.256 12.962,13.256
                "/>
            <polygon fill="#DFDFDF" points="17.946,12.965 15.946,12.965 15.946,18.965 7.946,18.965 7.946,12.965 5.946,12.965 5.946,20.965
                6.931,20.965 7.946,20.965 15.946,20.965 16.946,20.965 17.946,20.965 		"/>
            <g opacity="0.1">
                <path d="M11.946,2.986l5,5h-3.984v5.271h-2V7.986H6.946L11.946,2.986 M11.946,1.572l-0.707,0.707l-5,5L4.532,8.986h2.414h3.016
                    v4.271v1h1h2h1v-1V8.986h2.984h2.414l-1.707-1.707l-5-5L11.946,1.572L11.946,1.572z"/>
            </g>
            <g opacity="0.1">
                <path d="M17.946,12.965v8h-1h-1h-8H6.931H5.946v-8h2v6h8v-6H17.946 M18.946,11.965h-1h-2h-1v1v5h-6v-5v-1h-1h-2h-1v1v8v1h1h0.984
                    h1.016h8h1h1h1v-1v-8V11.965L18.946,11.965z"/>
            </g>
        </g>
        <rect x="14.903" y="3" fill="#DFDFDF" width="7" height="1"/>
        <rect x="17.942" fill="#DFDFDF" width="1" height="7"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "user.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <path fill="#E4E4E4" d="M16.527,11.564c-0.939,1.524-2.608,2.55-4.527,2.55c-1.916,0-3.585-1.025-4.523-2.55
        c-1.919,1.401-3.178,3.648-3.178,6.205c0,4.253,15.403,4.253,15.403,0C19.702,15.213,18.443,12.966,16.527,11.564z"/>
    <path fill="#E4E4E4" d="M12,2.013c-2.486,0-4.511,2.024-4.511,4.511c0,0.862,0.257,1.659,0.676,2.345
        c0.795,1.295,2.211,2.166,3.835,2.166c1.628,0,3.041-0.871,3.835-2.166c0.423-0.686,0.676-1.482,0.676-2.345
        C16.511,4.037,14.489,2.013,12,2.013z"/>
    <g opacity="0.1">
        <path d="M16.527,11.564c1.916,1.401,3.175,3.648,3.175,6.205c0,2.126-3.851,3.189-7.702,3.189s-7.702-1.063-7.702-3.189
            c0-2.557,1.259-4.804,3.178-6.205c0.938,1.524,2.607,2.55,4.523,2.55C13.919,14.114,15.588,13.089,16.527,11.564 M16.244,10.118
            l-0.568,0.922c-0.8,1.299-2.175,2.074-3.676,2.074c-1.5,0-2.873-0.775-3.672-2.074l-0.567-0.921l-0.874,0.638
            c-2.28,1.665-3.588,4.222-3.588,7.013c0,3.093,4.688,4.189,8.702,4.189s8.702-1.097,8.702-4.189c0-2.79-1.307-5.346-3.584-7.012
            L16.244,10.118L16.244,10.118z"/>
    </g>
    <g opacity="0.1">
        <path d="M12,2.013c2.489,0,4.511,2.024,4.511,4.511c0,0.862-0.253,1.659-0.676,2.345c-0.794,1.295-2.207,2.166-3.835,2.166
            c-1.624,0-3.04-0.871-3.835-2.166C7.746,8.183,7.489,7.386,7.489,6.523C7.489,4.037,9.514,2.013,12,2.013 M12,1.013
            c-3.039,0-5.511,2.472-5.511,5.511c0,0.995,0.284,1.986,0.822,2.866c1.017,1.657,2.77,2.645,4.688,2.645
            c1.92,0,3.673-0.988,4.688-2.644c0.538-0.872,0.823-1.864,0.823-2.867C17.511,3.485,15.039,1.013,12,1.013L12,1.013z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "login.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" points="10.962,10.985 10.962,7 15.962,12 10.962,17
        10.962,12.985 3.006,13.012 3.006,11.011 "/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" points="11.009,2.996 11.009,4.996 20.023,4.996 20.023,19.004
        11.009,19.004 11.009,21.004 22.023,21.004 22.023,20.02 22.023,19.004 22.023,4.996 22.023,3.996 22.023,2.996 "/>
    <g opacity="0.1">
        <path d="M10.962,7l5,5l-5,5v-4.015l-7.956,0.027v-2l7.956-0.026V7 M9.962,4.586V7v2.988l-6.959,0.023l-0.997,0.003v0.997v2v1.003
            l1.003-0.003l6.953-0.023V17v2.414l1.707-1.707l5-5L17.376,12l-0.707-0.707l-5-5L9.962,4.586L9.962,4.586z"/>
    </g>
    <g opacity="0.1">
        <path d="M22.023,2.996v1v1v14.008v1.016v0.984H11.009v-2h9.015V4.996h-9.015v-2H22.023 M23.023,1.996h-1H11.009h-1v1v2v1h1h8.015
            v12.008h-8.015h-1v1v2v1h1h11.015h1v-1V20.02v-1.016V4.996v-1v-1V1.996L23.023,1.996z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "logout.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" points="7.982,10.958 7.982,6.974 2.982,11.974 7.982,16.974
        7.982,12.958 15.938,12.984 15.938,10.984 "/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" points="10.984,2.969 10.984,4.969 19.999,4.969 19.999,18.978
        10.984,18.978 10.984,20.978 21.999,20.978 21.999,19.993 21.999,18.978 21.999,4.969 21.999,3.969 21.999,2.969 "/>
    <g opacity="0.1">
        <path d="M7.982,6.974v3.984l7.956,0.026v2l-7.956-0.026v4.016l-5-5L7.982,6.974 M8.982,4.56L7.275,6.267l-5,5l-0.707,0.707
            l0.707,0.707l5,5l1.707,1.707v-2.414v-3.013l6.953,0.023l1.003,0.003v-1.003v-2V9.988l-0.997-0.003L8.982,9.961V6.974V4.56
            L8.982,4.56z"/>
    </g>
    <g opacity="0.1">
        <path d="M21.999,2.969v1v1v14.008v1.016v0.984H10.984v-2h9.015V4.969h-9.015v-2H21.999 M22.999,1.969h-1H10.984h-1v1v2v1h1h8.015
            v12.008h-8.015h-1v1v2v1h1h11.015h1v-1v-0.984v-1.016V4.969v-1v-1V1.969L22.999,1.969z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "quickmenu.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <rect x="3" y="11" fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" width="18" height="2"/>
    <rect x="3" y="5" fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" width="18" height="2"/>
    <rect x="3" y="17" fill-rule="evenodd" clip-rule="evenodd" fill="#E4E4E4" width="18" height="2"/>
    <g opacity="0.1">
        <path d="M21,11v2H3v-2H21 M22,10h-1H3H2v1v2v1h1h18h1v-1v-2V10L22,10z"/>
    </g>
    <g opacity="0.1">
        <path d="M21,5v2H3V5H21 M22,4h-1H3H2v1v2v1h1h18h1V7V5V4L22,4z"/>
    </g>
    <g opacity="0.1">
        <path d="M21,17v2H3v-2H21 M22,16h-1H3H2v1v2v1h1h18h1v-1v-2V16L22,16z"/>
    </g>
    </svg>`;

    VG.Shaders.fs[ this.prefix + "skin.svg" ] = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
    <g>
        <g>
            <path fill="#DFDFDF" d="M-346.25,103.518l2.588-2.588c-0.002-0.053-0.004-0.104-0.004-0.156c0-2.025,1.641-3.666,3.666-3.666
                c0.053,0,0.104,0.002,0.156,0.004l1.292-1.293c-0.44-0.07-0.896-0.109-1.367-0.109c-5.495,0-8.97,5.09-8.97,5.09
                S-347.939,102.189-346.25,103.518z"/>
            <path fill="#DFDFDF" d="M-336.04,96.592l3.021-3.02l-1.144-1.145l-14,14.002l1.143,1.143l2.769-2.77
                c1.239,0.635,2.696,1.088,4.333,1.088c5.494,0,8.807-5.092,8.807-5.092S-332.907,98.049-336.04,96.592z M-340,104.438
                c-1.068,0-2.029-0.457-2.7-1.188l1.669-1.668c0.284,0.275,0.672,0.445,1.098,0.445c0.875,0,1.583-0.711,1.583-1.586
                c0-0.426-0.168-0.812-0.441-1.098l1.27-1.271c0.73,0.67,1.188,1.631,1.188,2.699C-336.334,102.797-337.977,104.438-340,104.438z"
                />
        </g>
    </g>
    <g opacity="0.1">
        <g>
            <g>
                <path d="M-339.91,95.709c0.473,0,0.926,0.04,1.367,0.109l-1.292,1.293c-0.052-0.002-0.103-0.004-0.156-0.004
                    c-2.025,0-3.666,1.641-3.666,3.666c0,0.053,0.002,0.104,0.004,0.156l-2.588,2.588c-1.689-1.328-2.639-2.718-2.639-2.718
                    S-345.405,95.709-339.91,95.709 M-339.91,94.709c-5.955,0-9.642,5.301-9.796,5.527l-0.385,0.564l0.385,0.562
                    c0.042,0.062,1.058,1.533,2.847,2.939l0.698,0.549l0.627-0.628l2.588-2.588l0.309-0.31l-0.016-0.436l-0.004-0.119
                    c0-1.471,1.196-2.666,2.666-2.666l0.116,0.002l0.437,0.018l0.312-0.309l1.292-1.293l1.391-1.392l-1.942-0.304
                    C-338.909,94.749-339.405,94.709-339.91,94.709L-339.91,94.709z"/>
            </g>
            <g>
                <path d="M-334.153,92.429l1.143,1.144l-3.021,3.02c3.135,1.457,4.928,4.208,4.928,4.208s-3.312,5.091-8.806,5.091
                    c-1.637,0-3.093-0.453-4.333-1.088l-2.769,2.77l-1.143-1.143L-334.153,92.429 M-339.924,102.027c-0.426,0-0.814-0.17-1.098-0.443
                    l-1.669,1.668c0.67,0.729,1.632,1.186,2.7,1.186c2.023,0,3.666-1.64,3.666-3.664c0-1.067-0.457-2.029-1.188-2.699l-1.271,1.271
                    c0.274,0.285,0.442,0.672,0.442,1.098C-338.341,101.318-339.049,102.027-339.924,102.027 M-334.153,91.014l-0.707,0.708
                    l-14.001,14.001l-0.708,0.707l0.708,0.707l1.143,1.143l0.707,0.707l0.707-0.707l2.271-2.271c1.345,0.586,2.729,0.883,4.124,0.883
                    c5.967,0,9.497-5.318,9.645-5.546l0.355-0.545l-0.355-0.546c-0.069-0.105-1.523-2.307-4.11-3.903l2.072-2.071l0.707-0.707
                    l-0.707-0.707l-1.144-1.144L-334.153,91.014L-334.153,91.014z M-339.924,103.027c1.41,0,2.56-1.137,2.583-2.541
                    c0.01,0.095,0.016,0.189,0.016,0.287c0,1.469-1.195,2.664-2.666,2.664c-0.423,0-0.828-0.097-1.192-0.279l0.311-0.311
                    C-340.574,102.966-340.253,103.027-339.924,103.027L-339.924,103.027z"/>
            </g>
        </g>
    </g>
    <g>
        <g>
            <path fill="#DFDFDF" d="M5.75,15.518l2.588-2.588c-0.002-0.053-0.004-0.104-0.004-0.156c0-2.025,1.641-3.666,3.666-3.666
                c0.053,0,0.104,0.002,0.156,0.004l1.292-1.293c-0.439-0.07-0.895-0.109-1.366-0.109c-5.495,0-8.97,5.09-8.97,5.09
                S4.061,14.189,5.75,15.518z"/>
            <path fill="#DFDFDF" d="M15.961,8.592l3.02-3.02l-1.143-1.145L3.837,18.43l1.143,1.143l2.769-2.77
                c1.239,0.635,2.696,1.088,4.333,1.088c5.494,0,8.807-5.092,8.807-5.092S19.094,10.049,15.961,8.592z M12,16.438
                c-1.068,0-2.029-0.457-2.7-1.188l1.669-1.668c0.284,0.275,0.672,0.445,1.098,0.445c0.875,0,1.583-0.711,1.583-1.586
                c0-0.426-0.168-0.812-0.441-1.098l1.27-1.271c0.73,0.67,1.188,1.631,1.188,2.699C15.666,14.797,14.023,16.438,12,16.438z"/>
        </g>
    </g>
    <g opacity="0.1">
        <g>
            <g>
                <path d="M12.09,7.709c0.473,0,0.926,0.04,1.367,0.109l-1.292,1.293c-0.052-0.002-0.103-0.004-0.156-0.004
                    c-2.025,0-3.666,1.641-3.666,3.666c0,0.053,0.002,0.104,0.004,0.156l-2.588,2.588C4.07,14.189,3.12,12.8,3.12,12.8
                    S6.595,7.709,12.09,7.709 M12.09,6.709c-5.955,0-9.642,5.301-9.796,5.527l-0.385,0.564l0.385,0.562
                    c0.042,0.062,1.058,1.533,2.847,2.939l0.698,0.549l0.627-0.628l2.588-2.588l0.309-0.31l-0.016-0.436l-0.004-0.119
                    c0-1.471,1.196-2.666,2.666-2.666l0.116,0.002l0.437,0.018l0.312-0.309l1.292-1.293l1.391-1.392l-1.942-0.304
                    C13.091,6.749,12.595,6.709,12.09,6.709L12.09,6.709z"/>
            </g>
            <g>
                <path d="M17.847,4.429l1.143,1.144l-3.021,3.02c3.135,1.457,4.928,4.208,4.928,4.208s-3.312,5.091-8.806,5.091
                    c-1.637,0-3.093-0.453-4.333-1.088l-2.769,2.77L3.844,18.43L17.847,4.429 M12.076,14.027c-0.426,0-0.814-0.17-1.098-0.443
                    l-1.669,1.668c0.67,0.729,1.632,1.186,2.7,1.186c2.023,0,3.666-1.64,3.666-3.664c0-1.067-0.457-2.029-1.188-2.699l-1.271,1.271
                    c0.274,0.285,0.442,0.672,0.442,1.098C13.659,13.318,12.951,14.027,12.076,14.027 M17.847,3.014L17.14,3.722L3.138,17.723
                    L2.43,18.43l0.708,0.707l1.143,1.143l0.707,0.707l0.707-0.707l2.271-2.271c1.345,0.586,2.729,0.883,4.124,0.883
                    c5.967,0,9.497-5.318,9.645-5.546l0.355-0.545l-0.355-0.546c-0.069-0.105-1.523-2.307-4.11-3.903l2.072-2.071l0.707-0.707
                    l-0.707-0.707l-1.144-1.144L17.847,3.014L17.847,3.014z M12.076,15.027c1.41,0,2.56-1.137,2.583-2.541
                    c0.01,0.095,0.016,0.189,0.016,0.287c0,1.469-1.195,2.664-2.666,2.664c-0.423,0-0.828-0.097-1.192-0.279l0.311-0.311
                    C11.426,14.966,11.747,15.027,12.076,15.027L12.076,15.027z"/>
            </g>
        </g>
    </g>
    </svg>`;

    let glyphData = `<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 15.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="841.89px" height="595.28px" viewBox="0 0 841.89 595.28" enable-background="new 0 0 841.89 595.28" xml:space="preserve">

    <g id="New">
    <path d="M483.021,216.496l-8.699-0.016l6.181-6.158c0.485-0.484,0.487-1.27,0.003-1.755
        c-0.483-0.484-1.269-0.487-1.755-0.003l-6.055,6.032l-0.016-8.44c-0.002-0.685-0.556-1.239-1.24-1.239c-0.001,0-0.002,0-0.002,0
        c-0.686,0.002-1.24,0.559-1.238,1.244l0.016,8.521l-6.087-6.063c-0.486-0.484-1.271-0.482-1.755,0.002
        c-0.483,0.486-0.482,1.271,0.003,1.756l6.117,6.093l-3.29-0.006l-5.35,0.034c-0.686,0.004-1.238,0.562-1.233,1.248
        c0.005,0.683,0.56,1.232,1.24,1.232c0.003,0,0.006,0,0.009,0l5.34-0.033l3.118,0.006l-2.198,2.189l-3.76,3.807
        c-0.481,0.487-0.477,1.272,0.012,1.754c0.241,0.239,0.557,0.358,0.871,0.358c0.32,0,0.64-0.123,0.883-0.369l3.752-3.8l2.34-2.33
        l0.006,3.397l-0.033,5.351c-0.005,0.686,0.547,1.244,1.232,1.249c0.002,0,0.005,0,0.008,0c0.682,0,1.235-0.551,1.24-1.233
        l0.033-5.361l-0.006-3.295l2.277,2.269l3.76,3.807c0.242,0.247,0.562,0.369,0.882,0.369c0.314,0,0.63-0.119,0.872-0.358
        c0.487-0.481,0.492-1.266,0.012-1.754l-3.768-3.814l-2.231-2.224l8.505,0.016c0.001,0,0.001,0,0.002,0
        c0.685,0,1.239-0.554,1.24-1.238C484.261,217.054,483.707,216.497,483.021,216.496z"/>
    </g>
    <g id="Open">
    <path fill="#FFFFFF" d="M247.809,212.147c-0.481-0.488-1.267-0.493-1.755-0.013l-2.549,2.514l-3.18,3.168l-2.877,2.913l-2.884-2.92
        l-3.177-3.166l-2.544-2.509c-0.487-0.48-1.273-0.476-1.754,0.013c-0.481,0.487-0.476,1.272,0.012,1.754l2.54,2.505l3.166,3.153
        l3.76,3.808c0.001,0.002,0.004,0.003,0.006,0.005c0.002,0.001,0.003,0.004,0.005,0.005c0.031,0.031,0.066,0.055,0.1,0.081
        c0.03,0.024,0.059,0.052,0.09,0.073c0.04,0.026,0.083,0.045,0.124,0.065c0.031,0.016,0.06,0.035,0.091,0.048
        c0.048,0.02,0.1,0.031,0.15,0.045c0.027,0.007,0.053,0.018,0.08,0.023c0.078,0.015,0.158,0.022,0.237,0.022
        c0.08,0,0.159-0.008,0.237-0.022c0.022-0.004,0.044-0.015,0.067-0.02c0.055-0.014,0.11-0.028,0.163-0.049
        c0.027-0.012,0.052-0.028,0.078-0.041c0.046-0.023,0.093-0.044,0.137-0.073c0.03-0.02,0.057-0.046,0.085-0.068
        c0.035-0.028,0.071-0.053,0.104-0.085c0.002-0.001,0.003-0.004,0.005-0.005c0.002-0.002,0.004-0.003,0.006-0.005l3.752-3.801
        l3.168-3.156l2.544-2.509C248.284,213.42,248.289,212.635,247.809,212.147z"/>
    </g>
    <g id="Save">
    <path d="M292.107,219.069l-3.166-3.152l-3.759-3.808c-0.002-0.002-0.004-0.003-0.007-0.006
        c-0.001-0.001-0.002-0.003-0.004-0.005c-0.027-0.026-0.057-0.045-0.086-0.069c-0.034-0.028-0.067-0.06-0.104-0.084
        c-0.034-0.022-0.07-0.038-0.105-0.056c-0.037-0.02-0.072-0.042-0.109-0.058c-0.038-0.016-0.078-0.023-0.117-0.035
        c-0.038-0.011-0.074-0.025-0.113-0.033c-0.039-0.007-0.08-0.008-0.12-0.012c-0.039-0.004-0.078-0.011-0.117-0.011
        s-0.078,0.007-0.117,0.011c-0.04,0.004-0.08,0.005-0.12,0.012c-0.039,0.008-0.076,0.022-0.114,0.033
        c-0.039,0.012-0.078,0.021-0.116,0.035c-0.038,0.016-0.074,0.038-0.11,0.058c-0.036,0.019-0.072,0.034-0.105,0.056
        c-0.037,0.024-0.069,0.056-0.104,0.084c-0.028,0.023-0.059,0.043-0.086,0.069c-0.002,0.002-0.003,0.004-0.005,0.005
        c-0.001,0.003-0.004,0.004-0.006,0.006l-3.753,3.801l-3.168,3.155l-2.544,2.509c-0.488,0.481-0.493,1.267-0.013,1.755
        c0.243,0.247,0.563,0.37,0.883,0.37c0.314,0,0.629-0.119,0.872-0.357l2.549-2.514l3.18-3.168l2.877-2.914l2.884,2.922l3.177,3.165
        l2.544,2.509c0.242,0.238,0.557,0.357,0.871,0.357c0.32,0,0.641-0.123,0.883-0.37c0.481-0.488,0.476-1.273-0.012-1.755
        L292.107,219.069z"/>
    </g>
    <g id="SaveAs">
        <path d="M335.081,219.541l-3.166-3.152l-3.76-3.808c-0.002-0.002-0.004-0.003-0.006-0.006
            c-0.002-0.001-0.003-0.003-0.005-0.005c-0.026-0.027-0.058-0.046-0.087-0.07c-0.033-0.027-0.066-0.059-0.103-0.083
            c-0.034-0.022-0.072-0.038-0.108-0.058c-0.035-0.019-0.07-0.04-0.106-0.056c-0.039-0.016-0.079-0.024-0.119-0.035
            c-0.036-0.011-0.073-0.025-0.11-0.033c-0.041-0.007-0.08-0.008-0.121-0.012c-0.039-0.004-0.077-0.011-0.117-0.011
            c-0.039,0-0.077,0.007-0.116,0.011c-0.04,0.004-0.08,0.005-0.12,0.012c-0.038,0.008-0.074,0.022-0.113,0.033
            c-0.039,0.012-0.078,0.02-0.115,0.035c-0.039,0.016-0.074,0.038-0.109,0.058c-0.036,0.018-0.072,0.033-0.107,0.056
            c-0.036,0.024-0.068,0.056-0.103,0.083c-0.028,0.024-0.06,0.044-0.087,0.07c-0.002,0.002-0.003,0.004-0.004,0.005
            c-0.002,0.003-0.005,0.004-0.007,0.006l-3.753,3.801l-3.168,3.156l-2.544,2.509c-0.488,0.48-0.493,1.266-0.013,1.754
            c0.242,0.247,0.562,0.37,0.883,0.37c0.315,0,0.63-0.119,0.872-0.358l2.548-2.513l3.18-3.168l2.877-2.914l2.885,2.922l3.177,3.165
            l2.546,2.509c0.241,0.238,0.556,0.357,0.87,0.357c0.321,0,0.641-0.123,0.884-0.37c0.48-0.488,0.475-1.273-0.013-1.755
            L335.081,219.541z"/>
        <path d="M347.519,205.823l-2.893-0.019l-2.122,0.004l0.01-4.98c0.002-0.686-0.553-1.242-1.238-1.243h-0.002
            c-0.685,0-1.24,0.554-1.241,1.238l-0.009,4.989l-4.991,0.01c-0.685,0.002-1.239,0.558-1.237,1.243
            c0.001,0.684,0.556,1.238,1.24,1.238c0.001,0,0.002,0,0.002,0l4.981-0.01l-0.005,2.133l0.019,2.882
            c0.005,0.683,0.56,1.233,1.24,1.233c0.003,0,0.005,0,0.009,0c0.684-0.005,1.236-0.564,1.232-1.249l-0.019-2.872l0.004-2.131
            l2.121-0.005l2.882,0.019c0.004,0,0.006,0,0.009,0c0.681,0,1.236-0.551,1.241-1.232
            C348.756,206.386,348.204,205.826,347.519,205.823z"/>
    </g>
    <g id="Undo">
    <path fill="#FFFFFF" d="M388.607,216.497H370.93l1.666-1.644l3.16-3.174c0.483-0.485,0.481-1.27-0.004-1.754
        c-0.485-0.483-1.271-0.482-1.754,0.003l-3.153,3.166l-3.807,3.76c-0.01,0.01-0.017,0.02-0.025,0.029
        c-0.039,0.041-0.076,0.086-0.109,0.134c-0.014,0.018-0.026,0.035-0.038,0.053c-0.035,0.056-0.067,0.114-0.094,0.177
        c-0.004,0.006-0.008,0.012-0.01,0.019l0,0c-0.028,0.067-0.048,0.138-0.062,0.206c-0.005,0.021-0.008,0.043-0.011,0.064
        c-0.009,0.052-0.015,0.104-0.016,0.154c-0.002,0.023-0.002,0.046-0.002,0.068c0.002,0.059,0.006,0.115,0.016,0.173
        c0.002,0.015,0.002,0.029,0.005,0.043c0.015,0.069,0.034,0.138,0.06,0.204c0.009,0.02,0.017,0.038,0.026,0.059
        c0.021,0.048,0.045,0.095,0.073,0.141c0.012,0.021,0.024,0.04,0.038,0.061c0.035,0.052,0.075,0.1,0.118,0.146
        c0.008,0.008,0.012,0.017,0.02,0.023c0.001,0.002,0.004,0.003,0.006,0.005c0.001,0.002,0.003,0.004,0.006,0.007l3.8,3.753
        l3.16,3.172c0.242,0.243,0.561,0.365,0.879,0.365c0.316,0,0.633-0.121,0.875-0.362c0.485-0.482,0.487-1.269,0.004-1.754l-3.168-3.18
        l-1.658-1.637h16.436v4.343c0,0.685,0.556,1.24,1.241,1.24c0.685,0,1.24-0.556,1.24-1.24v-5.583
        C389.847,217.053,389.292,216.497,388.607,216.497z"/>
    </g>
    <g id="Redo">
    <path d="M436.466,278.245c-0.002-0.051-0.008-0.103-0.017-0.154c-0.003-0.021-0.006-0.043-0.011-0.064
        c-0.015-0.068-0.034-0.139-0.062-0.206l0,0c-0.003-0.007-0.008-0.013-0.01-0.019c-0.027-0.062-0.06-0.121-0.095-0.177
        c-0.012-0.018-0.024-0.035-0.038-0.053c-0.033-0.048-0.07-0.093-0.109-0.134c-0.009-0.01-0.015-0.02-0.024-0.029l-3.8-3.752
        l-3.161-3.174c-0.483-0.485-1.269-0.486-1.754-0.003c-0.485,0.484-0.486,1.269-0.004,1.754l3.168,3.181l1.657,1.637h-17.675
        c-0.686,0-1.241,0.556-1.241,1.24v5.583c0,0.685,0.556,1.24,1.241,1.24s1.241-0.556,1.241-1.24v-4.343h16.434l-1.664,1.644
        l-3.161,3.173c-0.482,0.485-0.481,1.271,0.004,1.754c0.242,0.241,0.559,0.362,0.875,0.362c0.318,0,0.637-0.122,0.879-0.365
        l3.153-3.166l3.808-3.759c0.002-0.003,0.004-0.005,0.005-0.007c0.003-0.002,0.005-0.003,0.006-0.005
        c0.008-0.007,0.012-0.016,0.02-0.023c0.044-0.047,0.083-0.095,0.118-0.146c0.014-0.021,0.026-0.04,0.038-0.061
        c0.028-0.046,0.053-0.093,0.074-0.141c0.008-0.021,0.018-0.039,0.025-0.059c0.025-0.066,0.046-0.135,0.06-0.204
        c0.003-0.014,0.003-0.028,0.006-0.043c0.009-0.058,0.014-0.114,0.015-0.173C436.467,278.291,436.467,278.269,436.466,278.245z"/>
    </g>
    <g id="User">
        <path fill="#070707" d="M30.925,30.529H1.076l-0.001-0.956c-0.001-1.021,0.055-4.455,0.844-5.728
            c2.457-3.99,5.327-5.975,8.581-5.975c0.216,0,0.378-0.04,0.435-0.108c0.052-0.062,0.09-0.202,0.093-0.393
            c-2.402-1.668-3.875-4.479-3.875-7.451c0-3.422,1.979-6.601,5.042-8.098c0.841-0.475,1.708-0.757,2.531-0.816
            c0.414-0.067,0.789-0.104,1.142-0.116c0.739,0.009,0.916,0.031,1.209,0.084l0.101,0.018c0.863,0.062,1.794,0.352,2.626,0.819
            c3.031,1.479,5.021,4.642,5.021,8.031c0,2.976-1.435,5.698-3.862,7.373c0.005,0.129,0.031,0.21,0.058,0.242
            c0.029,0.035,0.166,0.102,0.476,0.102c4.769,0,7.545,4.575,8.457,6.079l0.129,0.208c0.789,1.272,0.847,4.707,0.845,5.729
            L30.925,30.529z M3.005,28.615h25.99c-0.058-1.609-0.253-3.297-0.542-3.762l-0.136-0.225c-0.856-1.41-3.131-5.157-6.822-5.157
            c-1.066,0-1.648-0.432-1.948-0.794c-0.451-0.543-0.601-1.301-0.433-2.19l0.077-0.416l0.36-0.222
            c2.104-1.293,3.358-3.54,3.358-6.008c0-2.663-1.568-5.15-3.996-6.336c-0.651-0.364-1.313-0.57-1.91-0.607L16.73,2.856
            c-0.169-0.031-0.246-0.045-0.846-0.054c-0.238,0.008-0.545,0.041-0.894,0.099l-0.098,0.011c-0.548,0.033-1.156,0.236-1.81,0.603
            c-2.459,1.204-4.017,3.708-4.017,6.404c0,2.476,1.292,4.809,3.37,6.087l0.362,0.223l0.078,0.419c0.1,0.542,0.172,1.567-0.471,2.34
            c-0.303,0.364-0.879,0.798-1.906,0.798c-3.834,0-6.144,3.752-6.903,4.986l-0.051,0.082C3.257,25.319,3.062,27.007,3.005,28.615z"/>
    </g>
    <g id="Close"><path d="M17.5,82.5c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6l25-25l25,25c1,1,2.4,1.6,3.8,1.6s2.7-0.5,3.8-1.6c2.1-2.1,2.1-5.5,0-7.5  l-25-25l25-25c2.1-2.1,2.1-5.5,0-7.5c-2.1-2.1-5.4-2.1-7.5,0l-25,25l-25-25c-2.1-2.1-5.4-2.1-7.5,0c-2.1,2.1-2.1,5.5,0,7.5l25,25  l-25,25C15.4,77.1,15.4,80.4,17.5,82.5z"></path>
    </g>
    <g id="SignUp">
        <path d="M561.808,202.808v7.235h2.482v-4.754h5.91v24.896h-5.91v-4.809h-2.482v7.29h19.555v-29.859H561.808z
             M578.882,230.186h-6.199v-24.896h6.199V230.186z"/>
        <path d="M557.845,208.185c-0.451-0.517-1.234-0.569-1.75-0.118s-0.568,1.234-0.117,1.751l5.525,6.322h-12.23
            c-0.686,0-1.24,0.555-1.24,1.24s0.555,1.24,1.24,1.24h12.422l-5.703,6.308c-0.461,0.508-0.42,1.293,0.088,1.752
            c0.236,0.215,0.535,0.32,0.832,0.32c0.338,0,0.676-0.138,0.92-0.408l8.189-9.056L557.845,208.185z"/>
    </g>
    <g id="quickmenu">
        <path d="M560.792,295.034h-20.034c-0.573,0-1.037,0.465-1.037,1.037c0,0.574,0.464,1.038,1.037,1.038h20.034
            c0.573,0,1.038-0.464,1.038-1.038C561.83,295.499,561.365,295.034,560.792,295.034z"/>
        <path d="M560.792,301.684h-20.034c-0.573,0-1.037,0.465-1.037,1.037c0,0.574,0.464,1.038,1.037,1.038h20.034
            c0.573,0,1.038-0.464,1.038-1.038C561.83,302.148,561.365,301.684,560.792,301.684z"/>
        <path d="M540.758,290.492h20.034c0.573,0,1.038-0.464,1.038-1.036c0-0.574-0.465-1.038-1.038-1.038h-20.034
            c-0.573,0-1.037,0.464-1.037,1.038C539.721,290.028,540.185,290.492,540.758,290.492z"/>
    </g>
    <g id="exit">
        <rect x="14.535" y="144.625" width="43.85" height="43.759"/>
        <path fill="#FFFFFF" d="M40.924,169.773l-3.307-3.295l6.609-6.583c0.32-0.319,0.321-0.836,0.002-1.156
            c-0.318-0.319-0.836-0.32-1.155-0.002l-6.613,6.589l-6.614-6.589c-0.32-0.318-0.836-0.317-1.156,0.002
            c-0.318,0.32-0.317,0.837,0.002,1.156l6.609,6.583l-3.311,3.3l-3.302,3.344c-0.317,0.321-0.314,0.838,0.007,1.155
            c0.159,0.157,0.367,0.236,0.574,0.236c0.211,0,0.422-0.081,0.582-0.244l3.298-3.338l3.311-3.3l3.307,3.295l3.302,3.343
            c0.16,0.163,0.371,0.244,0.581,0.244c0.208,0,0.415-0.079,0.575-0.236c0.321-0.317,0.324-0.834,0.007-1.155L40.924,169.773z"/>
    </g>
    <g id="SkinCycle">
        <path d="M91.551,252.728l46.195-46.195c-0.04-0.924-0.07-1.848-0.07-2.783c0-36.135,29.295-65.428,65.431-65.428
            c0.932,0,1.856,0.031,2.78,0.07l23.075-23.075c-7.849-1.231-15.979-1.944-24.416-1.944c-98.082,0-160.104,90.87-160.104,90.87
            S61.399,229.041,91.551,252.728z"/>
        <path d="M273.794,129.123l53.917-53.917L307.315,54.81L57.398,304.727l20.396,20.396l49.424-49.424
            c22.126,11.328,48.111,19.413,77.328,19.413c98.081,0,157.219-90.869,157.219-90.869S329.742,155.123,273.794,129.123z
            M203.106,269.177c-19.069,0-36.226-8.164-48.185-21.182l29.777-29.777c5.088,4.899,11.987,7.925,19.604,7.925
            c15.621,0,28.287-12.666,28.287-28.287c0-7.617-3.026-14.517-7.925-19.604l22.684-22.683
            c13.018,11.956,21.185,29.112,21.185,48.181C268.534,239.89,239.241,269.177,203.106,269.177z"/>
    </g>
    </svg>`;

    VG.Core.SVG( this.prefix + "glyphs.svg", glyphData, 20 );

    // --- Window Close

    VG.loadStyleImage( path, this.prefix + "windowclose.png" );
    VG.loadStyleImage( path, this.prefix + "windowclose_hover.png" );

    // --- Menu Checkmark

    VG.loadStyleImage( path, this.prefix + "checkmark.png" );
    VG.loadStyleImage( path, this.prefix + "checkmark_checked.png" );

    // --- Status

    VG.loadStyleImage( path, this.prefix + "status_error.png" );
    VG.loadStyleImage( path, this.prefix + "status_question.png" );
    VG.loadStyleImage( path, this.prefix + "status_success.png" );
    VG.loadStyleImage( path, this.prefix + "status_warning.png" );

    VG.loadStyleImage( path, "vg_logo.png" );
    VG.loadStyleImage( path, "vg_text_logo.png" );
    VG.loadStyleImage( path, "vg_powered_bd.png" );
};

VG.UI.stylePool.getStyleByName( "Visual Graphics" ).addSkin( new VG.UI.VisualGraphicsGraySkin() );
/*
 * Copyright (c) 2015-2016 Markus Moenig <markusm@visualgraphics.tv>
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.UI.VisualGraphicsDarkGraySkin=function()
{
    this.name="Dark Gray";
    this.path="desktop_darkgray";

    this.Widget={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

    	BackgroundColor : VG.Core.Color( 93, 93, 93 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),
        DisabledTextColor : VG.Core.Color( 200, 200, 200 ),
        FocusColor : VG.Core.Color( 129, 197, 242 ),

        DisabledAlpha : 0.25,
    };

    this.Label={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
    };

    this.Button={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        SmallFont : VG.Font.Font( "Open Sans Semibold", 12 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        FocusBorderColor1 : VG.Core.Color( 207, 128, 231 ),
        FocusBorderColor2 : VG.Core.Color( 132, 132, 132 ),
        FocusBorderCheckedColor2 : VG.Core.Color( 165, 165, 165 ),

        BorderColor : VG.Core.Color( 126, 126, 126 ),
        BackGradColor1 : VG.Core.Color( 148, 148, 148 ),
        BackGradColor2 : VG.Core.Color( 138, 138, 138 ),

        HoverBackGradColor1 : VG.Core.Color( 120, 120, 120 ),
        HoverBackGradColor2 : VG.Core.Color( 112, 112, 112 ),

        CheckedBackGradColor1 : VG.Core.Color( 180, 180, 180 ),
        CheckedBackGradColor2 : VG.Core.Color( 194, 194, 194 ),
    };

    this.ButtonGroup={

        Font : VG.Font.Font( "Roboto Regular", 13 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),

        NormalBorderColor : VG.Core.Color( 108, 108, 108 ),
        NormalBackColor : VG.Core.Color( 123, 123, 123 ),

        HoverBorderColor : VG.Core.Color( 179, 179, 179 ),
        HoverBackColor : VG.Core.Color( 157, 157, 157 ),

        PressedBorderColor : VG.Core.Color( 204, 204, 204 ),
        PressedBackColor : VG.Core.Color( 149, 149, 149 ),
    };

    this.CodeEdit={
        Font : VG.Font.Font( "Open Sans Semibold", 14 ),
        TopBorderColor : VG.Core.Color( 63, 75, 78 ),
        HeaderColor : VG.Core.Color( 63, 75, 78 ),
        HeaderTextColor : VG.Core.Color( 130, 151, 155 ),
        BackgroundColor : VG.Core.Color( 40, 48, 50 ),
        SelectionBackgroundColor : VG.Core.Color( 255, 255, 255, 120 ),
        SearchBackgroundColor : VG.Core.Color( 215, 206, 175 ),
        TextColor : VG.Core.Color( 240, 240, 240 ),
    };

    this.Menu={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        ShortcutFont : VG.Font.Font( "Open Sans Semibold", 13 ),
        BorderColor : VG.Core.Color( 130, 130, 130 ),
        SeparatorColor : VG.Core.Color( 102, 102, 102 ),
        BackColor : VG.Core.Color( 149, 149, 149 ),
        DisabledTextColor : VG.Core.Color( 128, 128, 128 ),
        HighlightedTextColor : VG.Core.Color( 85, 85, 85 ),
        HighlightedBackColor : VG.Core.Color( 194, 135, 212 ),
        HighlightedBorderColor : VG.Core.Color( 194, 135, 212 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
    };


    this.ContextMenu={
        Font : VG.Font.Font( "Roboto Regular", 13 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
        DisabledTextColor : VG.Core.Color( 128, 128, 128 ),

        BorderColor : VG.Core.Color( 130, 130, 130 ),
        BackColor : VG.Core.Color( 149, 149, 149 ),
        SeparatorColor : VG.Core.Color( 102, 102, 102 ),

        HighlightedBackColor : VG.Core.Color( 194, 135, 212 ),
        HighlightedTextColor : VG.Core.Color( 85, 85, 85 ),
    };

    this.DecoratedToolBar={
        Height : 44,//66,
        Spacing : 12,

        LogoColor : VG.Core.Color( 255, 255, 255 ),

        TopBorderColor : VG.Core.Color( 142, 142, 142 ),
        //TopBorderColor1 : VG.Core.Color( 171, 171, 171 ),
        //TopBorderColor2 : VG.Core.Color( 214, 214, 214 ),
        BottomBorderColor : VG.Core.Color( 81, 81, 81 ),

        BackGradColor1 : VG.Core.Color( 129, 129, 129 ),
        BackGradColor2 : VG.Core.Color( 105, 105, 105 ),

        Separator : {
            Color1 : VG.Core.Color( "#666666" ),
            Color2 : VG.Core.Color( "#949494" ),
            Size : VG.Core.Size( 2, 24 ),
        },
    };

    this.DecoratedQuickMenu={

        ButtonBackgroundColor : VG.Core.Color( 120, 120, 120 ),
        ButtonBackgroundHoverColor : VG.Core.Color( 157, 157, 157 ),
        ButtonBackgroundSelectedColor : VG.Core.Color( 111, 107, 107 ),

        StripeColor : VG.Core.Color( 55, 55, 55 ),

        HoverColor : VG.Core.Color( 255, 255, 255 ),
        Color : VG.Core.Color( 180, 180, 180 ),
        BorderColor : VG.Core.Color( 255, 255, 255 ),
        SubMenuBorderColor : VG.Core.Color( 182, 182, 182 ),
        BackgroundColor : VG.Core.Color( 88, 88, 88 ),
        ContentMargin : VG.Core.Margin( 0, 0, 0, 0 ),

        Size : VG.Core.Size( 74, 58 ),

        UsesCloseButton : false,

        Items : {

            BackGradSelectionColor1 : VG.Core.Color( 117, 117, 117 ),
            BackGradSelectionColor2 : VG.Core.Color( 85, 85, 85 ),

            Size : VG.Core.Size( 306, 42 ),
            TextColor : VG.Core.Color( 255, 255, 255 ),
            DisabledTextColor : VG.Core.Color( 128, 128, 128 ),
            Font : VG.Font.Font( "Open Sans Semibold", 14 ),
        }
    };

    this.DockWidget={

        BackColor : VG.Core.Color( 99, 99, 99 ),
        FloatingBorderColor : VG.Core.Color( 126, 197, 243 ),

        HeaderHeight : 21,
        HeaderFont : VG.Font.Font( "Open Sans Bold", 12 ),
        HeaderBorderColor : VG.Core.Color( 86, 86, 86 ),
        HeaderBackGradColor1 : VG.Core.Color( 105, 105, 105 ),
        HeaderBackGradColor2 : VG.Core.Color( 96, 96, 96 ),

        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.DropDownMenu={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),

        FocusBorderColor : VG.Core.Color( 207, 128, 231 ),
        HoverBorderColor : VG.Core.Color( 107, 107, 107 ),
        BorderColor : VG.Core.Color( 122, 122, 122 ),

        HoverBackGradColor1 : VG.Core.Color( 98, 98, 98 ),
        HoverBackGradColor2 : VG.Core.Color( 89, 89, 89 ),

        BackGradColor1 : VG.Core.Color( 113, 113, 113 ),
        BackGradColor2 : VG.Core.Color( 105, 105, 105 ),

        SepColor1 : VG.Core.Color( 122, 122, 122 ),
        SepColor2 : VG.Core.Color( 103, 103, 103 ),

        ItemBorderColor : VG.Core.Color( 153, 153, 153 ),
        ItemBackColor : VG.Core.Color( 124, 124, 124 ),
        ItemSelectedBackColor : VG.Core.Color( 194, 135, 212 ),

        ItemTextColor : VG.Core.Color( 255, 255, 255 ),
        ItemSelectedTextColor : VG.Core.Color( 85, 85, 85 ),
    };

    this.HtmlWidget={

        h1 : {
            Font : VG.Font.Font( "Open Sans Bold", 26 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 10, 10, 20, 10 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        h2 : {
            Font : VG.Font.Font( "Open Sans Bold", 18 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 10, 5, 10, 5 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        h4 : {
            Font : VG.Font.Font( "Open Sans Bold", 13 ),
            Color : VG.Core.Color( 204, 204, 204 ),

            Margin : VG.Core.Margin( 10, 10, 10, 10 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        p : {
            Font : VG.Font.Font( "Open Sans Semibold", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 10, 5, 10, 5 ),
            ResetLayout : true,
            LineFeed : true,
            Spacing : 2,
        },
        svg : {
            Color : VG.Core.Color( 244, 244, 244 ),
            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        img : {
            Margin : VG.Core.Margin( 10, 10, 10, 10 ),
            LineFeed : true,
        },
        b : {
            Font : VG.Font.Font( "Open Sans Bold", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        i : {
            Font : VG.Font.Font( "Open Sans Semibold Italic", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        a : {
            Font : VG.Font.Font( "Open Sans Semibold", 13 ),
            Color : VG.Core.Color( "#e452ef" ),
            Link : true,

            Margin : VG.Core.Margin( 0, 0, 0, 0 ),
        },
        ul : {
            Margin : VG.Core.Margin( 30, 0, 5, 5 ),
            ResetLayout : true,
            LineFeed : true,
        },
        li : {
            Font : VG.Font.Font( "Open Sans Semibold", 13 ),
            Color : VG.Core.Color( 244, 244, 244 ),

            Margin : VG.Core.Margin( 5, 5, 5, 5 ),
            LineFeed : true,
        },
        br : {
            Margin : VG.Core.Margin( 0, 15, 0, 0 ),
            LineFeed : true,
        }
    };

    this.HtmlView={
        FontName : "Open Sans Semibold",
        BoldFontName : "Open Sans Bold",
        ItalicFontName : "Open Sans Semibold Italic",
    };

    this.IconWidget={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 203, 203, 203 ),

        FocusBorderColor : VG.Core.Color( 207, 128, 231 ),
        BorderColor : VG.Core.Color( 107, 107, 107 ),
        HoverBorderColor : VG.Core.Color( 122, 122, 122 ),

        BackColor : VG.Core.Color( 82, 82, 82 ),

        Spacing : VG.Core.Size( 5, 5 ),
        Margin : VG.Core.Margin( 5, 5, 5, 5 ),

        ItemBackColor : VG.Core.Color( 177, 177, 177 ),
        ItemSelectedBorderColor : VG.Core.Color( 207, 128, 231 ),
        ItemSelectedBackColor : VG.Core.Color( 194, 135, 212 ),

        ItemCustomContentBorderColor : VG.Core.Color( 139, 139, 139 ),

        ToolLayoutHeight : 28,
        ToolTopBorderColor : VG.Core.Color( 155, 155, 155 ),
        ToolBottomBorderColor : VG.Core.Color( 89, 89, 89 ),
        ToolBackGradColor1 : VG.Core.Color( 139, 139, 139 ),
        ToolBackGradColor2 : VG.Core.Color( 105, 105, 105 ),
    };

    this.ListWidget={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 85, 81, 85 ),

        FocusBorderColor : VG.Core.Color( 207, 128, 231 ),
        BorderColor : VG.Core.Color( 107, 107, 107 ),
        HoverBorderColor : VG.Core.Color( 122, 122, 122 ),

        BackColor : VG.Core.Color( 82, 82, 82 ),

        Spacing : 2,
        Margin : VG.Core.Margin( 2, 2, 2, 2 ),

        ItemBackColor : VG.Core.Color( 177, 177, 177 ),

        ItemSelectedBorderColor : VG.Core.Color( 207, 128, 231 ),
        ItemSelectedBackColor : VG.Core.Color( 194, 135, 212 ),

        ItemCustomContentBorderColor : VG.Core.Color( 139, 139, 139 ),

        ToolLayoutHeight : 28,
        ToolTopBorderColor : VG.Core.Color( 155, 155, 155 ),
        ToolBottomBorderColor : VG.Core.Color( 89, 89, 89 ),
        ToolBackGradColor1 : VG.Core.Color( 139, 139, 139 ),
        ToolBackGradColor2 : VG.Core.Color( 105, 105, 105 ),
    };

    this.Menu={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        ShortcutFont : VG.Font.Font( "Open Sans Semibold", 13 ),
        BorderColor : VG.Core.Color( 130, 130, 130 ),
        SeparatorColor : VG.Core.Color( 102, 102, 102 ),
        BackColor : VG.Core.Color( 149, 149, 149 ),
        DisabledTextColor : VG.Core.Color( 128, 128, 128 ),
        HighlightedTextColor : VG.Core.Color( 85, 85, 85 ),
        HighlightedBackColor : VG.Core.Color( 194, 135, 212 ),
        HighlightedBorderColor : VG.Core.Color( 194, 135, 212 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.MenuBar={
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        Height : 21,
        BorderSize : 1,

        TopBorderColor : VG.Core.Color( 180, 180, 180 ),
        BottomBorderColor : VG.Core.Color( 91, 91, 91 ),

        BackColor : VG.Core.Color( 137, 137, 137 ),
        SelectedBackColor : VG.Core.Color( 61, 61, 61 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),
        SelectedTextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.Nodes={

        Font : VG.Font.Font( "Open Sans Semibold", 12 ),

        BackColor : VG.Core.Color( 128, 128, 128 ),
        BackLineColor : VG.Core.Color( 74, 74, 74 ),
        GridSize : 45,

        BorderColor : VG.Core.Color( 244, 244, 244 ),
        TopColor : VG.Core.Color( 65, 65, 65 ),
        SeparatorColor : VG.Core.Color.Black,
        BodyColor : VG.Core.Color( 192, 192, 192 ),

        TitleTextColor : VG.Core.Color( 195, 195, 195 ),
        TerminalTextColor : VG.Core.Color( 76, 76, 76 ),

        TextureTerminalColor : VG.Core.Color( "#318828" ),
        MaterialTerminalColor : VG.Core.Color( 190, 171, 0 ),
        FloatTerminalColor : VG.Core.Color( 95, 54, 136),//0, 95, 185 ),
        Vector2TerminalColor : VG.Core.Color("#9a151d"),//0, 95, 185 ),
        Vector3TerminalColor : VG.Core.Color("#005fb9"),//0, 95, 185 ),
        Vector4TerminalColor : VG.Core.Color(),//0, 95, 185 ),
    };

    this.ScrollBar={
        Size : 14,
        BorderColor : VG.Core.Color( 119, 119, 119 ),
        BackColor : VG.Core.Color( 139, 139, 139 ),
    };

    this.SectionBar={

        BorderColor : VG.Core.Color( 75, 75, 75 ),
        BackColor : VG.Core.Color( 130, 130, 130 ),

        HeaderHeight : 21,
        HeaderFont : VG.Font.Font( "Open Sans Bold", 12 ),
        HeaderBorderColor : VG.Core.Color( 82, 82, 82 ),
        HeaderBackGradColor1 : VG.Core.Color( 100, 100, 100 ),
        HeaderBackGradColor2 : VG.Core.Color( 91, 91, 91 ),

        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        Separator : {
            Height : 2,
            Color1 : VG.Core.Color( 109, 109, 109 ),
            Color2 : VG.Core.Color( 158, 158, 158 ),
        }
    };

    this.SectionBarButton={

        Font : VG.Font.Font( "Open Sans Bold", 12 ),

        Size : VG.Core.Size( 81, 47 ),

        BorderColor : VG.Core.Color( 80, 80, 80 ),
        BackGradColor1 : VG.Core.Color( 80, 80, 80 ),
        BackGradColor2 : VG.Core.Color( 72, 72, 72 ),

        HoverBorderColor : VG.Core.Color( 107, 107, 107 ),
        HoverBackGradColor1 : VG.Core.Color( 94, 94, 94 ),
        HoverBackGradColor2 : VG.Core.Color( 86, 86, 86 ),

        SelectedBorderColor : VG.Core.Color( 245, 245, 245 ),
        SelectedBackGradColor1 : VG.Core.Color( 242, 242, 242 ),
        SelectedBackGradColor2 : VG.Core.Color( 242, 242, 242 ),
        SelectedTextColor : VG.Core.Color( 96, 96, 96 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.SectionBarSwitch={

        Font : VG.Font.Font( "Open Sans Bold", 12 ),

        Size : VG.Core.Size( 81, 32 ),

        TextColor : VG.Core.Color( 255, 255, 255 ),
    };

    this.SectionToolBar={

        BackColor : VG.Core.Color( 130, 130, 130 ),
        BorderColor1 : VG.Core.Color( 82, 82, 82 ),
        BorderColor2 : VG.Core.Color( 130, 130, 130 ),

        HeaderTopBorderColor : VG.Core.Color( 155, 155, 155 ),
        HeaderGradColor1 : VG.Core.Color( 139, 139, 139 ),
        HeaderGradColor2 : VG.Core.Color( 110, 110, 110 ),
        HeaderBottomBorderColor1 : VG.Core.Color( 105, 105, 105 ),
        HeaderBottomBorderColor2 : VG.Core.Color( 89, 89, 89 ),

        HeaderFont : VG.Font.Font( "Open Sans Bold", 12 ),
        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        Separator : {
            Height : 2,
            Color1 : VG.Core.Color( 136, 136, 136 ),
            Color2 : VG.Core.Color( 197, 197, 197 ),
        }
    };

    this.SectionToolBarButton={

        Size : VG.Core.Size( 46, 43 ),
        // Size : VG.Core.Size( 46, 38 ),
        SmallSize : VG.Core.Size( 36, 34 ),

        BorderColor : VG.Core.Color( 108, 108, 108 ),
        BorderHoverColor : VG.Core.Color( 179, 179, 179 ),
        BorderSelectedColor : VG.Core.Color( 204, 204, 204 ),

        BackHoverColor : VG.Core.Color( 157, 157, 157 ),
        BackSelectedColor : VG.Core.Color( 149, 149, 149 ),
    };

    this.Slider={

        FocusHoverBarColors : {
            Color1 : VG.Core.Color( 219, 219, 219 ),
            Color2 : VG.Core.Color( 190, 190, 190 ),
            Color3 : VG.Core.Color( 218, 218, 218 ),
            Color4 : VG.Core.Color( 235, 235, 235 ),
        },

        BarColors : {
            Color1 : VG.Core.Color( 187, 187, 187 ),
            Color2 : VG.Core.Color( 170, 170, 170 ),
            Color3 : VG.Core.Color( 186, 186, 186 ),
            Color4 : VG.Core.Color( 197, 197, 197 ),
        },

        HandleSize : 13,
        BarHeight : 4
    };

    this.RoundSlider={

        FocusHoverBarColors : {
            Color1 : VG.Core.Color( 219, 219, 219 ),
            Color2 : VG.Core.Color( 190, 190, 190 ),
            Color3 : VG.Core.Color( 218, 218, 218 ),
        },

        LeftTrackColors : {
            Color1 : VG.Core.Color( 130, 130, 130 ),
            Color2 : VG.Core.Color( 139, 139, 139 ),
            Color3 : VG.Core.Color( 175, 175, 175 ),
        },

        RightTrackColors : {
            Color1 : VG.Core.Color( 75, 75, 75 ),
            Color2 : VG.Core.Color( 90, 90, 90 ),
            Color3 : VG.Core.Color( 149, 149, 149 ),
        },

        HandleSize : 14,
        BarHeight : 3,

        KnobColor : VG.Core.Color( 221, 221, 221 ),
        OuterKnobColor : VG.Core.Color( 221, 221, 221, 128 ),
        SelectedOuterKnobColor : VG.Core.Color( 207, 128, 231, 128 )
    };

    this.SnapperWidgetItem={

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        Height : 22,

        TopBorderColor : VG.Core.Color( 155, 155, 155 ),
        BottomBorderColor : VG.Core.Color( 89, 89, 89 ),
        BackGradColor1 : VG.Core.Color( 139, 139, 139 ),
        BackGradColor2 : VG.Core.Color( 106, 106, 106 ),

        HoverTopBorderColor : VG.Core.Color( 162, 162, 162 ),
        HoverBottomBorderColor : VG.Core.Color( 104, 104, 104 ),
        HoverBackGradColor1 : VG.Core.Color( 147, 147, 147 ),
        HoverBackGradColor2 : VG.Core.Color( 118, 118, 118 ),

        SelectedTopBorderColor : VG.Core.Color( 135, 135, 135 ),
        SelectedBottomBorderColor : VG.Core.Color( 78, 78, 78 ),
        SelectedBackGradColor1 : VG.Core.Color( 121, 121, 121 ),
        SelectedBackGradColor2 : VG.Core.Color( 93, 93, 93 ),
    };

    this.SplitLayout={

        Size : 7,

        BackColor : VG.Core.Color( 133, 133, 133 ),
        BorderColor : VG.Core.Color( 160, 160, 160 ),

        DragBackColor : VG.Core.Color( 132, 132, 132 ),
        DragBorderColor : VG.Core.Color( 239, 239, 239 ),

        HoverBackColor : VG.Core.Color( 148, 148, 148 ),
        HoverBorderColor : VG.Core.Color( 191, 191, 191 ),
    };

    this.StatusBar={

        BorderColor : VG.Core.Color( 76, 76, 76 ),
        BackColor : VG.Core.Color( 120, 120, 120 ),
        Height : 20,
    };

    this.TabWidgetHeader={

        Font : VG.Font.Font( "Open Sans Semibold", 14 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),
        Height : 32,

        SelectedEdgeBorderColor : VG.Core.Color( 110, 110, 110 ),
        SelectedTopBorderColor : VG.Core.Color( 118, 118, 118 ),
        SelectedSideBorderColor1 : VG.Core.Color( 114, 114, 114 ),
        SelectedSideBorderColor2 : VG.Core.Color( 103, 103, 103 ),

        SelectedBackGradientColor1 : VG.Core.Color( 119, 119, 119 ),
        SelectedBackGradientColor2 : VG.Core.Color( 114, 114, 114 ),

        HoverBackGradientColor1 : VG.Core.Color( 100, 100, 100 ),
        HoverBackGradientColor2 : VG.Core.Color( 89, 89, 89 ),

        BackGradientColor1 : VG.Core.Color( 106, 106, 106 ),
        BackGradientColor2 : VG.Core.Color( 95, 95, 95 ),

        LeftBorderColor : VG.Core.Color( 117, 117, 117 ),
        TabBorderColor : VG.Core.Color( 137, 137, 137 ),
        BottomBorderColor1 : VG.Core.Color( 98, 98, 98 ),
        BottomBorderColor2 : VG.Core.Color( 114, 114, 114 ),
    };

    this.TabWidgetSmallHeader={

        Font : VG.Font.Font( "Open Sans Semibold", 12 ),
        TextColor : VG.Core.Color( 244, 244, 244 ),
        Height : 22,

        SelectedEdgeBorderColor : VG.Core.Color( 110, 110, 110 ),
        SelectedTopBorderColor : VG.Core.Color( 118, 118, 118 ),
        SelectedSideBorderColor1 : VG.Core.Color( 114, 114, 114 ),
        SelectedSideBorderColor2 : VG.Core.Color( 103, 103, 103 ),

        SelectedBackGradientColor1 : VG.Core.Color( 119, 119, 119 ),
        SelectedBackGradientColor2 : VG.Core.Color( 114, 114, 114 ),

        HoverBackGradientColor1 : VG.Core.Color( 100, 100, 100 ),
        HoverBackGradientColor2 : VG.Core.Color( 89, 89, 89 ),

        BackGradientColor1 : VG.Core.Color( 106, 106, 106 ),
        BackGradientColor2 : VG.Core.Color( 95, 95, 95 ),

        LeftBorderColor : VG.Core.Color( 117, 117, 117 ),
        TabBorderColor : VG.Core.Color( 137, 137, 137 ),
        BottomBorderColor1 : VG.Core.Color( 98, 98, 98 ),
        BottomBorderColor2 : VG.Core.Color( 114, 114, 114 ),
    };

    this.TextEdit={

        Font : VG.Font.Font( "Roboto Regular", 14 ),

        TextColor : VG.Core.Color( 242, 242, 242 ),
        DefaultTextColor : VG.Core.Color( 71, 71, 71 ),

        FocusBorderColor1 : VG.Core.Color( 207, 128, 231 ),
        FocusBorderColor2 : VG.Core.Color( 194, 135, 212 ),

        FocusBorderColor3 : VG.Core.Color( 119, 119, 119 ),
        FocusBackgroundColor : VG.Core.Color( 148, 148, 148 ),

        BackgroundColor : VG.Core.Color( 148, 148, 148 ),
        BorderColor1 : VG.Core.Color( 209, 209, 209 ),
        BorderColor2 : VG.Core.Color( 149, 149, 149 ),
    };

    this.TextLineEdit={

    	Font : VG.Font.Font( "Roboto Regular", 14 ),

    	TextColor : VG.Core.Color( 242, 242, 242 ),
        DefaultTextColor : VG.Core.Color( 71, 71, 71 ),

        FocusBorderColor1 : VG.Core.Color( 207, 128, 231 ),
        FocusBorderColor2 : VG.Core.Color( 194, 135, 212 ),
    	FocusBorderColor3 : VG.Core.Color( 148, 148, 148 ),
    	FocusBackgroundColor : VG.Core.Color( 148, 148, 148 ),

    	BackgroundColor : VG.Core.Color( 148, 148, 148 ),
    	BorderColor1 : VG.Core.Color( 209, 209, 209 ),
    	BorderColor2 : VG.Core.Color( 148, 148, 148 ),
    };

    this.Timeline={

        LayerFont : VG.Font.Font( "Open Sans Semibold", 13 ),
        ObjectFont : VG.Font.Font( "Open Sans Semibold", 11 ),

        TrackBackColor1 : VG.Core.Color( 46, 46, 48 ),
        TrackBackColor2 : VG.Core.Color( 57, 57, 57 ),

        TrackSepColor : VG.Core.Color( 34, 34, 34 ),

        TextColor : VG.Core.Color( 85, 81, 85 ),

        FocusBorderColor : VG.Core.Color( 207, 128, 231 ),
        BorderColor : VG.Core.Color( 107, 107, 107 ),
        HoverBorderColor : VG.Core.Color( 122, 122, 122 ),

        BackColor : VG.Core.Color( 82, 82, 82 ),

        Spacing : 2,
        Margin : VG.Core.Margin( 2, 2, 2, 2 ),

        LayerBackColor : VG.Core.Color( 177, 177, 177 ),

        LayerSelectedBorderColor : VG.Core.Color( 207, 128, 231 ),
        LayerSelectedBackColor : VG.Core.Color( 194, 135, 212 ),

        ItemCustomContentBorderColor : VG.Core.Color( 139, 139, 139 ),

        ToolLayoutHeight : 28,
        ToolTopBorderColor : VG.Core.Color( 155, 155, 155 ),
        ToolBottomBorderColor : VG.Core.Color( 89, 89, 89 ),
        ToolBackGradColor1 : VG.Core.Color( 139, 139, 139 ),
        ToolBackGradColor2 : VG.Core.Color( 105, 105, 105 ),
    };

    this.TitleBar={

        Height : 20,
        Font : VG.Font.Font( "Open Sans Semibold", 12.5 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        BorderColor : VG.Core.Color( 102, 102, 102 ),

        BackGradColor1 : VG.Core.Color( 125, 125, 125 ),
        BackGradColor2 : VG.Core.Color( 114, 114, 114 ),
    };

    this.ToolBar={

        Height : 33,

        TopBorderColor : VG.Core.Color( 102, 102, 102 ),
        BottomBorderColor : VG.Core.Color( 160, 160, 160 ),

        BackGradColor : VG.Core.Color( 120, 120, 120 ),

        Separator : {
            Color1 : VG.Core.Color( 102, 102, 102 ),
            Color2 : VG.Core.Color( 148, 148, 148 ),
            Size : VG.Core.Size( 2, 28 ),
        },

        IconSize : VG.Core.Size( 32, 27 ),
    };

    this.ToolBarButton={

        Font : VG.Font.Font( "Roboto Regular", 14 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        BorderColor : VG.Core.Color( 108, 108, 108 ),
        BackColor : VG.Core.Color( 130, 130, 130 ),

        HoverBorderColor : VG.Core.Color( 179, 179, 179 ),
        HoverBackColor : VG.Core.Color( 157, 157, 157 ),

        ClickedBorderColor : VG.Core.Color( 204, 204, 204 ),
        ClickedBackColor : VG.Core.Color( 149, 149, 149 ),

        TextMargin : VG.Core.Size( 10, 0 ),
        IconSize : VG.Core.Size( 24, 24 ),

        MinimumWidth : 45,
    };

    this.ToolButton={

        Color : VG.Core.Color( 255, 255, 255 ),

        BorderColor : VG.Core.Color( 158, 158, 158 ),
        BackColor : VG.Core.Color( 163, 163, 163 ),

        HoverBorderColor : VG.Core.Color( 224, 224, 224 ),
        HoverBackColor : VG.Core.Color( 163, 163, 163 ),

        ClickedBorderColor : VG.Core.Color( 255, 255, 255 ),
        ClickedBackColor : VG.Core.Color( 186, 186, 186 ),

        Size : VG.Core.Size( 46, 43 ),
        Margin : VG.Core.Size( 3, 3 ),

        MinimumWidth : 45,
    };

    this.ToolSettings={

        HeaderFont : VG.Font.Font( "Open Sans Bold", 13 ),

        BackColor : VG.Core.Color( 123, 123, 123 ),
        BorderColor : VG.Core.Color( 108, 108, 108 ),

        HoverBackColor : VG.Core.Color( 157, 157, 157 ),
        HoverBorderColor : VG.Core.Color( 179, 179, 179 ),

        OpenBorderColor : VG.Core.Color( 204, 204, 204 ),
        OpenBackColor : VG.Core.Color( 149, 149, 149 ),

        ContentBorderColor : VG.Core.Color( 146, 146, 146 ),
        ContentBackColor : VG.Core.Color( 116, 116, 116 ),

        Size : VG.Core.Size( 21, 20 ),
    };

    this.ToolTip={

        TitleFont : VG.Font.Font( "Open Sans Bold", 14 ),
        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        BorderColor : VG.Core.Color( 181, 181, 181 ),
        BackColor : VG.Core.Color( 123, 123, 123 ),
        TextColor : VG.Core.Color( 255, 255, 255 ),

        BorderSize : VG.Core.Size( 11, 15 ),
    };

    this.TreeWidget={

        Header : {
            Height : 22,
            ContentColumns: true,
            BorderColor : VG.Core.Color( 82, 82, 82 ),
            BackColor1 : VG.Core.Color( 134, 134, 134 ),
            BackColor2 : VG.Core.Color( 118, 118, 118 ),
            TextColor : VG.Core.Color( 236, 239, 243 ),
        },

        Font : VG.Font.Font( "Open Sans Semibold", 13 ),

        TextColor : VG.Core.Color( 85, 81, 85 ),

        FocusBorderColor : VG.Core.Color( 207, 128, 231 ),
        BorderColor : VG.Core.Color( 107, 107, 107 ),
        HoverBorderColor : VG.Core.Color( 122, 122, 122 ),

        BackColor : VG.Core.Color( 82, 82, 82 ),

        Spacing : 3,
        Margin : VG.Core.Margin( 2, 2, 2, 2 ),

        UseTriangles: false,
        HasBorder: true,

        ItemOutline: true,
        ItemBackColor : VG.Core.Color( 177, 177, 177 ),
        ItemSelectedBorderColor : VG.Core.Color( 207, 128, 231 ),
        ItemSelectedBackColor : VG.Core.Color( 194, 135, 212 ),

        ToolLayoutHeight : 28,

        ToolTopBorderColor : VG.Core.Color( 155, 155, 155 ),
        ToolBottomBorderColor : VG.Core.Color( 89, 89, 89 ),
        ToolBackGradColor1 : VG.Core.Color( 139, 139, 139 ),
        ToolBackGradColor2 : VG.Core.Color( 105, 105, 105 ),

        ChildIndent : 20,
        ChildControlColor : VG.Core.Color( 227, 227, 227 ),
    };

    this.Window={
        HeaderHeight : 25,

        HeaderFont : VG.Font.Font( "Open Sans Semibold", 14 ),
        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        BackColor : VG.Core.Color( 82, 82, 82 ),

        BorderColor1 : VG.Core.Color( 147, 147, 147 ),
        BorderColor2 : VG.Core.Color( 197, 197, 197 ),

        HeaderBackGradColor1 : VG.Core.Color( 156, 156, 156 ),
        HeaderBackGradColor2 : VG.Core.Color( 143, 143, 143 ),
    };

    this.RoundedWindow={
        HeaderHeight : 20,
        FooterHeight : 15,

        HeaderFont : VG.Font.Font( "Open Sans Semibold", 14 ),
        HeaderTextColor : VG.Core.Color( 255, 255, 255 ),

        BackColor : VG.Core.Color( 116, 116, 116 ),

        BorderColor1 : VG.Core.Color( 182, 182, 182 ),
        BorderColor2 : VG.Core.Color( 130, 130, 130 ),

        SepColor1 : VG.Core.Color( 148, 148, 148 ),
        SepColor2 : VG.Core.Color( 102, 102, 102 ),
    };

    // --- TEMPORARY, TABLEWIDGET HAS TO BE REMOVED

    this.TableWidget = {
                Font : VG.Font.Font( "Roboto Regular", 14 ),
                TextColor : VG.Core.Color( 244, 244, 244 ),
                DisabledSeparatorColor : VG.Core.Color( 48, 48, 48 ),
                SelectionColor : VG.Core.Color(  44, 55, 71 ),
                SeparatorWidth : 1,
                ContentMargin : VG.Core.Margin( 0, 0, 0, 6 ),
                RowHeight : 28,

                Header : {
                    Font : VG.Font.Font( "Roboto Regular", 13 ),
                    SeparatorHeight : 3,
                    SeparatorColor : VG.Core.Color( 117, 117, 117 ),
                    Height : 23,
                    BorderColor : VG.Core.Color( 117, 117, 117 ),
                    GradientColor1 : VG.Core.Color( 169, 169, 169 ),
                    GradientColor2 : VG.Core.Color( 148, 148, 148 ),
                    TextXOffset : 10,
                },
                Footer : {
                    SeparatorHeight : 16,
                    Margin : VG.Core.Margin( 10, 0, 0, 0 ),
                    Height : 24,
                },

                Item : {

                    BorderColor : VG.Core.Color( 216, 216, 216 ),
                    SelectedBorderColor : VG.Core.Color( 186, 223, 248 ),

                    GradientColor1 : VG.Core.Color( 183, 183, 183 ),
                    GradientColor2 : VG.Core.Color( 186, 186, 186 ),
                    BottomColor : VG.Core.Color( 186, 186, 186 ),

                    SelectedGradientColor1 : VG.Core.Color( 128, 196, 242 ),
                    SelectedGradientColor2 : VG.Core.Color( 132, 198, 241 ),
                    SelectedBottomColor : VG.Core.Color( 132, 198, 241 ),

                    XMargin : 2,
                    Spacing : 2,
                },
            };

    // ---
};

VG.UI.VisualGraphicsDarkGraySkin.prototype.activate=function()
{
    this.prefix=this.style.prefix + "darkgray_";
    this.fallbackPrefix=this.style.prefix + "gray_";

    var path=this.style.path + "/" + this.path;

    VG.loadStyleImage( path, this.prefix + "checkbox_focus.png" );
    VG.loadStyleImage( path, this.prefix + "checkbox_focus_checked.png" );

    // VG.loadStyleImage( path, this.prefix + "slider_focus.png" );
};

VG.UI.stylePool.getStyleByName( "Visual Graphics" ).addSkin( new VG.UI.VisualGraphicsDarkGraySkin() );
(function(){function o(n){var i=e;n&&(e[n]||(e[n]={}),i=e[n]);if(!i.define||!i.define.packaged)t.original=i.define,i.define=t,i.define.packaged=!0;if(!i.require||!i.require.packaged)r.original=i.require,i.require=r,i.require.packaged=!0}var ACE_NAMESPACE = "ace",e=function(){return this}();!e&&typeof window!="undefined"&&(e=window);if(!ACE_NAMESPACE&&typeof requirejs!="undefined")return;var t=function(e,n,r){if(typeof e!="string"){t.original?t.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace());return}arguments.length==2&&(r=n),t.modules[e]||(t.payloads[e]=r,t.modules[e]=null)};t.modules={},t.payloads={};var n=function(e,t,n){if(typeof t=="string"){var i=s(e,t);if(i!=undefined)return n&&n(),i}else if(Object.prototype.toString.call(t)==="[object Array]"){var o=[];for(var u=0,a=t.length;u<a;++u){var f=s(e,t[u]);if(f==undefined&&r.original)return;o.push(f)}return n&&n.apply(null,o)||!0}},r=function(e,t){var i=n("",e,t);return i==undefined&&r.original?r.original.apply(this,arguments):i},i=function(e,t){if(t.indexOf("!")!==-1){var n=t.split("!");return i(e,n[0])+"!"+i(e,n[1])}if(t.charAt(0)=="."){var r=e.split("/").slice(0,-1).join("/");t=r+"/"+t;while(t.indexOf(".")!==-1&&s!=t){var s=t;t=t.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}}return t},s=function(e,r){r=i(e,r);var s=t.modules[r];if(!s){s=t.payloads[r];if(typeof s=="function"){var o={},u={id:r,uri:"",exports:o,packaged:!0},a=function(e,t){return n(r,e,t)},f=s(a,o,u);o=f||u.exports,t.modules[r]=o,delete t.payloads[r]}s=t.modules[r]=o||s}return s};o(ACE_NAMESPACE)})(),ace.define("ace/lib/regexp",["require","exports","module"],function(e,t,n){"use strict";function o(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":"")}function u(e,t,n){if(Array.prototype.indexOf)return e.indexOf(t,n);for(var r=n||0;r<e.length;r++)if(e[r]===t)return r;return-1}var r={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},i=r.exec.call(/()??/,"")[1]===undefined,s=function(){var e=/^/g;return r.test.call(e,""),!e.lastIndex}();if(s&&i)return;RegExp.prototype.exec=function(e){var t=r.exec.apply(this,arguments),n,a;if(typeof e=="string"&&t){!i&&t.length>1&&u(t,"")>-1&&(a=RegExp(this.source,r.replace.call(o(this),"g","")),r.replace.call(e.slice(t.index),a,function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===undefined&&(t[e]=undefined)}));if(this._xregexp&&this._xregexp.captureNames)for(var f=1;f<t.length;f++)n=this._xregexp.captureNames[f-1],n&&(t[n]=t[f]);!s&&this.global&&!t[0].length&&this.lastIndex>t.index&&this.lastIndex--}return t},s||(RegExp.prototype.test=function(e){var t=r.exec.call(this,e);return t&&this.global&&!t[0].length&&this.lastIndex>t.index&&this.lastIndex--,!!t})}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(e,t,n){function r(){}function w(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}function H(e){return e=+e,e!==e?e=0:e!==0&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function B(e){var t=typeof e;return e===null||t==="undefined"||t==="boolean"||t==="number"||t==="string"}function j(e){var t,n,r;if(B(e))return e;n=e.valueOf;if(typeof n=="function"){t=n.call(e);if(B(t))return t}r=e.toString;if(typeof r=="function"){t=r.call(e);if(B(t))return t}throw new TypeError}Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError("Function.prototype.bind called on incompatible "+n);var i=u.call(arguments,1),s=function(){if(this instanceof s){var e=n.apply(this,i.concat(u.call(arguments)));return Object(e)===e?e:this}return n.apply(t,i.concat(u.call(arguments)))};return n.prototype&&(r.prototype=n.prototype,s.prototype=new r,r.prototype=null),s});var i=Function.prototype.call,s=Array.prototype,o=Object.prototype,u=s.slice,a=i.bind(o.toString),f=i.bind(o.hasOwnProperty),l,c,h,p,d;if(d=f(o,"__defineGetter__"))l=i.bind(o.__defineGetter__),c=i.bind(o.__defineSetter__),h=i.bind(o.__lookupGetter__),p=i.bind(o.__lookupSetter__);if([1,2].splice(0).length!=2)if(!function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t=[],n;t.splice.apply(t,e(20)),t.splice.apply(t,e(26)),n=t.length,t.splice(5,0,"XXX"),n+1==t.length;if(n+1==t.length)return!0}())Array.prototype.splice=function(e,t){var n=this.length;e>0?e>n&&(e=n):e==void 0?e=0:e<0&&(e=Math.max(n+e,0)),e+t<n||(t=n-e);var r=this.slice(e,e+t),i=u.call(arguments,2),s=i.length;if(e===n)s&&this.push.apply(this,i);else{var o=Math.min(t,n-e),a=e+o,f=a+s-o,l=n-a,c=n-o;if(f<a)for(var h=0;h<l;++h)this[f+h]=this[a+h];else if(f>a)for(h=l;h--;)this[f+h]=this[a+h];if(s&&e===c)this.length=c,this.push.apply(this,i);else{this.length=c+s;for(h=0;h<s;++h)this[e+h]=i[h]}}return r};else{var v=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?v.apply(this,[e===void 0?0:e,t===void 0?this.length-e:t].concat(u.call(arguments,2))):[]}}Array.isArray||(Array.isArray=function(t){return a(t)=="[object Array]"});var m=Object("a"),g=m[0]!="a"||!(0 in m);Array.prototype.forEach||(Array.prototype.forEach=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=arguments[1],s=-1,o=r.length>>>0;if(a(t)!="[object Function]")throw new TypeError;while(++s<o)s in r&&t.call(i,r[s],s,n)}),Array.prototype.map||(Array.prototype.map=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=r.length>>>0,s=Array(i),o=arguments[1];if(a(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var u=0;u<i;u++)u in r&&(s[u]=t.call(o,r[u],u,n));return s}),Array.prototype.filter||(Array.prototype.filter=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=r.length>>>0,s=[],o,u=arguments[1];if(a(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var f=0;f<i;f++)f in r&&(o=r[f],t.call(u,o,f,n)&&s.push(o));return s}),Array.prototype.every||(Array.prototype.every=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=r.length>>>0,s=arguments[1];if(a(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var o=0;o<i;o++)if(o in r&&!t.call(s,r[o],o,n))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=r.length>>>0,s=arguments[1];if(a(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var o=0;o<i;o++)if(o in r&&t.call(s,r[o],o,n))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=r.length>>>0;if(a(t)!="[object Function]")throw new TypeError(t+" is not a function");if(!i&&arguments.length==1)throw new TypeError("reduce of empty array with no initial value");var s=0,o;if(arguments.length>=2)o=arguments[1];else do{if(s in r){o=r[s++];break}if(++s>=i)throw new TypeError("reduce of empty array with no initial value")}while(!0);for(;s<i;s++)s in r&&(o=t.call(void 0,o,r[s],s,n));return o}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var n=F(this),r=g&&a(this)=="[object String]"?this.split(""):n,i=r.length>>>0;if(a(t)!="[object Function]")throw new TypeError(t+" is not a function");if(!i&&arguments.length==1)throw new TypeError("reduceRight of empty array with no initial value");var s,o=i-1;if(arguments.length>=2)s=arguments[1];else do{if(o in r){s=r[o--];break}if(--o<0)throw new TypeError("reduceRight of empty array with no initial value")}while(!0);do o in this&&(s=t.call(void 0,s,r[o],o,n));while(o--);return s});if(!Array.prototype.indexOf||[0,1].indexOf(1,2)!=-1)Array.prototype.indexOf=function(t){var n=g&&a(this)=="[object String]"?this.split(""):F(this),r=n.length>>>0;if(!r)return-1;var i=0;arguments.length>1&&(i=H(arguments[1])),i=i>=0?i:Math.max(0,r+i);for(;i<r;i++)if(i in n&&n[i]===t)return i;return-1};if(!Array.prototype.lastIndexOf||[0,1].lastIndexOf(0,-3)!=-1)Array.prototype.lastIndexOf=function(t){var n=g&&a(this)=="[object String]"?this.split(""):F(this),r=n.length>>>0;if(!r)return-1;var i=r-1;arguments.length>1&&(i=Math.min(i,H(arguments[1]))),i=i>=0?i:r-Math.abs(i);for(;i>=0;i--)if(i in n&&t===n[i])return i;return-1};Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.__proto__||(t.constructor?t.constructor.prototype:o)});if(!Object.getOwnPropertyDescriptor){var y="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,n){if(typeof t!="object"&&typeof t!="function"||t===null)throw new TypeError(y+t);if(!f(t,n))return;var r,i,s;r={enumerable:!0,configurable:!0};if(d){var u=t.__proto__;t.__proto__=o;var i=h(t,n),s=p(t,n);t.__proto__=u;if(i||s)return i&&(r.get=i),s&&(r.set=s),r}return r.value=t[n],r}}Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)});if(!Object.create){var b;Object.prototype.__proto__===null?b=function(){return{__proto__:null}}:b=function(){var e={};for(var t in e)e[t]=null;return e.constructor=e.hasOwnProperty=e.propertyIsEnumerable=e.isPrototypeOf=e.toLocaleString=e.toString=e.valueOf=e.__proto__=null,e},Object.create=function(t,n){var r;if(t===null)r=b();else{if(typeof t!="object")throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var i=function(){};i.prototype=t,r=new i,r.__proto__=t}return n!==void 0&&Object.defineProperties(r,n),r}}if(Object.defineProperty){var E=w({}),S=typeof document=="undefined"||w(document.createElement("div"));if(!E||!S)var x=Object.defineProperty}if(!Object.defineProperty||x){var T="Property description must be an object: ",N="Object.defineProperty called on non-object: ",C="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(t,n,r){if(typeof t!="object"&&typeof t!="function"||t===null)throw new TypeError(N+t);if(typeof r!="object"&&typeof r!="function"||r===null)throw new TypeError(T+r);if(x)try{return x.call(Object,t,n,r)}catch(i){}if(f(r,"value"))if(d&&(h(t,n)||p(t,n))){var s=t.__proto__;t.__proto__=o,delete t[n],t[n]=r.value,t.__proto__=s}else t[n]=r.value;else{if(!d)throw new TypeError(C);f(r,"get")&&l(t,n,r.get),f(r,"set")&&c(t,n,r.set)}return t}}Object.defineProperties||(Object.defineProperties=function(t,n){for(var r in n)f(n,r)&&Object.defineProperty(t,r,n[r]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze(function(){})}catch(k){Object.freeze=function(t){return function(n){return typeof n=="function"?n:t(n)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(t){return!1}),Object.isFrozen||(Object.isFrozen=function(t){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)===t)throw new TypeError;var n="";while(f(t,n))n+="?";t[n]=!0;var r=f(t,n);return delete t[n],r});if(!Object.keys){var L=!0,A=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],O=A.length;for(var M in{toString:null})L=!1;Object.keys=function I(e){if(typeof e!="object"&&typeof e!="function"||e===null)throw new TypeError("Object.keys called on a non-object");var I=[];for(var t in e)f(e,t)&&I.push(t);if(L)for(var n=0,r=O;n<r;n++){var i=A[n];f(e,i)&&I.push(i)}return I}}Date.now||(Date.now=function(){return(new Date).getTime()});var _="	\n\x0b\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff";if(!String.prototype.trim||_.trim()){_="["+_+"]";var D=new RegExp("^"+_+_+"*"),P=new RegExp(_+_+"*$");String.prototype.trim=function(){return String(this).replace(D,"").replace(P,"")}}var F=function(e){if(e==null)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],function(e,t,n){"use strict";e("./regexp"),e("./es5-shim")}),ace.define("ace/lib/dom",["require","exports","module"],function(e,t,n){"use strict";var r="http://www.w3.org/1999/xhtml";t.buildDom=function s(e,t,n){if(typeof e=="string"&&e){var r=document.createTextNode(e);return t&&t.appendChild(r),r}if(!Array.isArray(e))return e;if(typeof e[0]!="string"||!e[0]){var i=[];for(var o=0;o<e.length;o++){var u=s(e[o],t,n);u&&i.push(u)}return i}var a=document.createElement(e[0]),f=e[1],l=1;f&&typeof f=="object"&&!Array.isArray(f)&&(l=2);for(var o=l;o<e.length;o++)s(e[o],a,n);return l==2&&Object.keys(f).forEach(function(e){var t=f[e];e==="class"?a.className=Array.isArray(t)?t.join(" "):t:typeof t=="function"||e=="value"?a[e]=t:e==="ref"?n&&(n[t]=a):t!=null&&a.setAttribute(e,t)}),t&&t.appendChild(a),a},t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||r,e):document.createElement(e)},t.hasCssClass=function(e,t){var n=(e.className+"").split(/\s+/g);return n.indexOf(t)!==-1},t.addCssClass=function(e,n){t.hasCssClass(e,n)||(e.className+=" "+n)},t.removeCssClass=function(e,t){var n=e.className.split(/\s+/g);for(;;){var r=n.indexOf(t);if(r==-1)break;n.splice(r,1)}e.className=n.join(" ")},t.toggleCssClass=function(e,t){var n=e.className.split(/\s+/g),r=!0;for(;;){var i=n.indexOf(t);if(i==-1)break;r=!1,n.splice(i,1)}return r&&n.push(t),e.className=n.join(" "),r},t.setCssClass=function(e,n,r){r?t.addCssClass(e,n):t.removeCssClass(e,n)},t.hasCssString=function(e,t){var n=0,r;t=t||document;if(r=t.querySelectorAll("style"))while(n<r.length)if(r[n++].id===e)return!0},t.importCssString=function(n,r,i){var s=i&&i.getRootNode?i.getRootNode():i||document,o=s.ownerDocument||s;if(r&&t.hasCssString(r,s))return null;r&&(n+="\n/*# sourceURL=ace/css/"+r+" */");var u=t.createElement("style");u.appendChild(o.createTextNode(n)),r&&(u.id=r),s==o&&(s=t.getDocumentHead(o)),s.appendChild(u)},t.importCssStylsheet=function(e,n){t.buildDom("link",{rel:"stylesheet",href:e},t.getDocumentHead(n))},t.scrollbarWidth=function(e){var n=t.createElement("ace_inner");n.style.width="100%",n.style.minWidth="0px",n.style.height="200px",n.style.display="block";var r=t.createElement("ace_outer"),i=r.style;i.position="absolute",i.left="-10000px",i.overflow="hidden",i.width="200px",i.minWidth="0px",i.height="150px",i.display="block",r.appendChild(n);var s=e.documentElement;s.appendChild(r);var o=n.offsetWidth;i.overflow="scroll";var u=n.offsetWidth;return o==u&&(u=r.clientWidth),s.removeChild(r),o-u},typeof document=="undefined"&&(t.importCssString=function(){}),t.computedStyle=function(e,t){return window.getComputedStyle(e,"")||{}},t.HAS_CSS_ANIMATION=!1;if(typeof document!="undefined"){var i=document.createElement("div");typeof i.style.animationName!="undefined"&&(t.HAS_CSS_ANIMATION=!0)}}),ace.define("ace/lib/oop",["require","exports","module"],function(e,t,n){"use strict";t.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},t.mixin=function(e,t){for(var n in t)e[n]=t[n];return e},t.implement=function(e,n){t.mixin(e,n)}}),ace.define("ace/lib/keys",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop"],function(e,t,n){"use strict";e("./fixoldbrowsers");var r=e("./oop"),i=function(){var e={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,"super":8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}},t,n;for(n in e.FUNCTION_KEYS)t=e.FUNCTION_KEYS[n].toLowerCase(),e[t]=parseInt(n,10);for(n in e.PRINTABLE_KEYS)t=e.PRINTABLE_KEYS[n].toLowerCase(),e[t]=parseInt(n,10);return r.mixin(e,e.MODIFIER_KEYS),r.mixin(e,e.PRINTABLE_KEYS),r.mixin(e,e.FUNCTION_KEYS),e.enter=e["return"],e.escape=e.esc,e.del=e["delete"],e[173]="-",function(){var t=["cmd","ctrl","alt","shift"];for(var n=Math.pow(2,t.length);n--;)e.KEY_MODS[n]=t.filter(function(t){return n&e.KEY_MODS[t]}).join("-")+"-"}(),e.KEY_MODS[0]="",e.KEY_MODS[-1]="input-",e}();r.mixin(t,i),t.keyCodeToString=function(e){var t=i[e];return typeof t!="string"&&(t=String.fromCharCode(e)),t.toLowerCase()}}),ace.define("ace/lib/useragent",["require","exports","module"],function(e,t,n){"use strict";t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS};if(typeof navigator!="object")return;var r=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),i=navigator.userAgent;t.isWin=r=="win",t.isMac=r=="mac",t.isLinux=r=="linux",t.isIE=navigator.appName=="Microsoft Internet Explorer"||navigator.appName.indexOf("MSAppHost")>=0?parseFloat((i.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((i.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=i.match(/ Gecko\/\d+/),t.isOpera=window.opera&&Object.prototype.toString.call(window.opera)=="[object Opera]",t.isWebKit=parseFloat(i.split("WebKit/")[1])||undefined,t.isChrome=parseFloat(i.split(" Chrome/")[1])||undefined,t.isAIR=i.indexOf("AdobeAIR")>=0,t.isIPad=i.indexOf("iPad")>=0,t.isChromeOS=i.indexOf(" CrOS ")>=0,t.isIOS=/iPad|iPhone|iPod/.test(i)&&!window.MSStream,t.isIOS&&(t.isMac=!0)}),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(e,t,n){"use strict";function a(e,t,n){var a=u(t);if(!i.isMac&&s){t.getModifierState&&(t.getModifierState("OS")||t.getModifierState("Win"))&&(a|=8);if(s.altGr){if((3&a)==3)return;s.altGr=0}if(n===18||n===17){var f="location"in t?t.location:t.keyLocation;if(n===17&&f===1)s[n]==1&&(o=t.timeStamp);else if(n===18&&a===3&&f===2){var l=t.timeStamp-o;l<50&&(s.altGr=!0)}}}n in r.MODIFIER_KEYS&&(n=-1),a&8&&n>=91&&n<=93&&(n=-1);if(!a&&n===13){var f="location"in t?t.location:t.keyLocation;if(f===3){e(t,a,-n);if(t.defaultPrevented)return}}if(i.isChromeOS&&a&8){e(t,a,n);if(t.defaultPrevented)return;a&=-9}return!!a||n in r.FUNCTION_KEYS||n in r.PRINTABLE_KEYS?e(t,a,n):!1}function f(){s=Object.create(null)}var r=e("./keys"),i=e("./useragent"),s=null,o=0;t.addListener=function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent){var r=function(){n.call(e,window.event)};n._wrapper=r,e.attachEvent("on"+t,r)}},t.removeListener=function(e,t,n){if(e.removeEventListener)return e.removeEventListener(t,n,!1);e.detachEvent&&e.detachEvent("on"+t,n._wrapper||n)},t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},t.getButton=function(e){return e.type=="dblclick"?0:e.type=="contextmenu"||i.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},t.capture=function(e,n,r){function i(e){n&&n(e),r&&r(e),t.removeListener(document,"mousemove",n,!0),t.removeListener(document,"mouseup",i,!0),t.removeListener(document,"dragstart",i,!0)}return t.addListener(document,"mousemove",n,!0),t.addListener(document,"mouseup",i,!0),t.addListener(document,"dragstart",i,!0),i},t.addTouchMoveListener=function(e,n){var r,i;t.addListener(e,"touchstart",function(e){var t=e.touches,n=t[0];r=n.clientX,i=n.clientY}),t.addListener(e,"touchmove",function(e){var t=e.touches;if(t.length>1)return;var s=t[0];e.wheelX=r-s.clientX,e.wheelY=i-s.clientY,r=s.clientX,i=s.clientY,n(e)})},t.addMouseWheelListener=function(e,n){"onmousewheel"in e?t.addListener(e,"mousewheel",function(e){var t=8;e.wheelDeltaX!==undefined?(e.wheelX=-e.wheelDeltaX/t,e.wheelY=-e.wheelDeltaY/t):(e.wheelX=0,e.wheelY=-e.wheelDelta/t),n(e)}):"onwheel"in e?t.addListener(e,"wheel",function(e){var t=.35;switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=e.deltaX*t||0,e.wheelY=e.deltaY*t||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=(e.deltaX||0)*5,e.wheelY=(e.deltaY||0)*5}n(e)}):t.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=(e.detail||0)*5,e.wheelY=0):(e.wheelX=0,e.wheelY=(e.detail||0)*5),n(e)})},t.addMultiMouseDownListener=function(e,n,r,s){function c(e){t.getButton(e)!==0?o=0:e.detail>1?(o++,o>4&&(o=1)):o=1;if(i.isIE){var c=Math.abs(e.clientX-u)>5||Math.abs(e.clientY-a)>5;if(!f||c)o=1;f&&clearTimeout(f),f=setTimeout(function(){f=null},n[o-1]||600),o==1&&(u=e.clientX,a=e.clientY)}e._clicks=o,r[s]("mousedown",e);if(o>4)o=0;else if(o>1)return r[s](l[o],e)}function h(e){o=2,f&&clearTimeout(f),f=setTimeout(function(){f=null},n[o-1]||600),r[s]("mousedown",e),r[s](l[o],e)}var o=0,u,a,f,l={2:"dblclick",3:"tripleclick",4:"quadclick"};Array.isArray(e)||(e=[e]),e.forEach(function(e){t.addListener(e,"mousedown",c),i.isOldIE&&t.addListener(e,"dblclick",h)})};var u=!i.isMac||!i.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};t.getModifierString=function(e){return r.KEY_MODS[u(e)]},t.addCommandKeyListener=function(e,n){var r=t.addListener;if(i.isOldGecko||i.isOpera&&!("KeyboardEvent"in window)){var o=null;r(e,"keydown",function(e){o=e.keyCode}),r(e,"keypress",function(e){return a(n,e,o)})}else{var u=null;r(e,"keydown",function(e){s[e.keyCode]=(s[e.keyCode]||0)+1;var t=a(n,e,e.keyCode);return u=e.defaultPrevented,t}),r(e,"keypress",function(e){u&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),u=null)}),r(e,"keyup",function(e){s[e.keyCode]=null}),s||(f(),r(window,"focus",f))}};if(typeof window=="object"&&window.postMessage&&!i.isOldIE){var l=1;t.nextTick=function(e,n){n=n||window;var r="zero-timeout-message-"+l;t.addListener(n,"message",function i(s){s.data==r&&(t.stopPropagation(s),t.removeListener(n,"message",i),e())}),n.postMessage(r,"*")}}t.$idleBlocked=!1,t.onIdle=function(e,n){return setTimeout(function r(){t.$idleBlocked?setTimeout(r,100):e()},n)},t.$idleBlockId=null,t.blockIdle=function(e){t.$idleBlockId&&clearTimeout(t.$idleBlockId),t.$idleBlocked=!0,t.$idleBlockId=setTimeout(function(){t.$idleBlocked=!1},e||100)},t.nextFrame=typeof window=="object"&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}}),ace.define("ace/range",["require","exports","module"],function(e,t,n){"use strict";var r=function(e,t){return e.row-t.row||e.column-t.column},i=function(e,t,n,r){this.start={row:e,column:t},this.end={row:n,column:r}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return this.compare(e,t)==0},this.compareRange=function(e){var t,n=e.end,r=e.start;return t=this.compare(n.row,n.column),t==1?(t=this.compare(r.row,r.column),t==1?2:t==0?1:0):t==-1?-2:(t=this.compare(r.row,r.column),t==-1?-1:t==1?42:0)},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return this.comparePoint(e.start)==0&&this.comparePoint(e.end)==0},this.intersects=function(e){var t=this.compareRange(e);return t==-1||t==0||t==1},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){typeof e=="object"?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){typeof e=="object"?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return this.compare(e,t)==0?this.isEnd(e,t)||this.isStart(e,t)?!1:!0:!1},this.insideStart=function(e,t){return this.compare(e,t)==0?this.isEnd(e,t)?!1:!0:!1},this.insideEnd=function(e,t){return this.compare(e,t)==0?this.isStart(e,t)?!1:!0:!1},this.compare=function(e,t){return!this.isMultiLine()&&e===this.start.row?t<this.start.column?-1:t>this.end.column?1:0:e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var n={row:t+1,column:0};else if(this.end.row<e)var n={row:e,column:0};if(this.start.row>t)var r={row:t+1,column:0};else if(this.start.row<e)var r={row:e,column:0};return i.fromPoints(r||this.start,n||this.end)},this.extend=function(e,t){var n=this.compare(e,t);if(n==0)return this;if(n==-1)var r={row:e,column:t};else var s={row:e,column:t};return i.fromPoints(r||this.start,s||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return i.fromPoints(this.start,this.end)},this.collapseRows=function(){return this.end.column==0?new i(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new i(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),n=e.documentToScreenPosition(this.end);return new i(t.row,t.column,n.row,n.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(i.prototype),i.fromPoints=function(e,t){return new i(e.row,e.column,t.row,t.column)},i.comparePoints=r,i.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=i}),ace.define("ace/lib/lang",["require","exports","module"],function(e,t,n){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){var n="";while(t>0){t&1&&(n+=e);if(t>>=1)e+=e}return n};var r=/^\s\s*/,i=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(r,"")},t.stringTrimRight=function(e){return e.replace(i,"")},t.copyObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.copyArray=function(e){var t=[];for(var n=0,r=e.length;n<r;n++)e[n]&&typeof e[n]=="object"?t[n]=this.copyObject(e[n]):t[n]=e[n];return t},t.deepCopy=function s(e){if(typeof e!="object"||!e)return e;var t;if(Array.isArray(e)){t=[];for(var n=0;n<e.length;n++)t[n]=s(e[n]);return t}if(Object.prototype.toString.call(e)!=="[object Object]")return e;t={};for(var n in e)t[n]=s(e[n]);return t},t.arrayToMap=function(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,function(e){n.push({offset:arguments[arguments.length-2],length:e.length})}),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function(e){return r.cancel(),t=setTimeout(n,e||0),r};return r.schedule=r,r.call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},i=function(e){n==null&&(n=setTimeout(r,e||t))};return i.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},i.schedule=i,i.call=function(){this.cancel(),e()},i.cancel=function(){n&&clearTimeout(n),n=null},i.isPending=function(){return n},i}}),ace.define("ace/keyboard/textinput_ios",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/lib/keys"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=e("../lib/dom"),o=e("../lib/lang"),u=e("../lib/keys"),a=u.KEY_MODS,f=i.isChrome<18,l=i.isIE,c=function(e,t){function x(e){if(m)return;m=!0;if(k)t=0,n=e?0:c.value.length-1;else var t=4,n=5;try{c.setSelectionRange(t,n)}catch(r){}m=!1}function T(){if(m)return;c.value=h,i.isWebKit&&S.schedule()}function R(){clearTimeout(q),q=setTimeout(function(){g&&(c.style.cssText=g,g=""),t.renderer.$keepTextAreaAtCursor==null&&(t.renderer.$keepTextAreaAtCursor=!0,t.renderer.$moveTextAreaToCursor())},0)}var n=this,c=s.createElement("textarea");c.className=i.isIOS?"ace_text-input ace_text-input-ios":"ace_text-input",i.isTouchPad&&c.setAttribute("x-palm-disable-auto-cap",!0),c.setAttribute("wrap","off"),c.setAttribute("autocorrect","off"),c.setAttribute("autocapitalize","off"),c.setAttribute("spellcheck",!1),c.style.opacity="0",e.insertBefore(c,e.firstChild);var h="\n aaaa a\n",p=!1,d=!1,v=!1,m=!1,g="",y=!0;try{var b=document.activeElement===c}catch(w){}r.addListener(c,"blur",function(e){t.onBlur(e),b=!1}),r.addListener(c,"focus",function(e){b=!0,t.onFocus(e),x()}),this.focus=function(){if(g)return c.focus();c.style.position="fixed",c.focus()},this.blur=function(){c.blur()},this.isFocused=function(){return b};var E=o.delayedCall(function(){b&&x(y)}),S=o.delayedCall(function(){m||(c.value=h,b&&x())});i.isWebKit||t.addEventListener("changeSelection",function(){t.selection.isEmpty()!=y&&(y=!y,E.schedule())}),T(),b&&t.onFocus();var N=function(e){return e.selectionStart===0&&e.selectionEnd===e.value.length},C=function(e){N(c)?(t.selectAll(),x()):k&&x(t.selection.isEmpty())},k=null;this.setInputHandler=function(e){k=e},this.getInputHandler=function(){return k};var L=!1,A=function(e){if(c.selectionStart===4&&c.selectionEnd===5)return;k&&(e=k(e),k=null),v?(x(),e&&t.onPaste(e),v=!1):e==h.substr(0)&&c.selectionStart===4?L?t.execCommand("del",{source:"ace"}):t.execCommand("backspace",{source:"ace"}):p||(e.substring(0,9)==h&&e.length>h.length?e=e.substr(9):e.substr(0,4)==h.substr(0,4)?e=e.substr(4,e.length-h.length+1):e.charAt(e.length-1)==h.charAt(0)&&(e=e.slice(0,-1)),e!=h.charAt(0)&&e.charAt(e.length-1)==h.charAt(0)&&(e=e.slice(0,-1)),e&&t.onTextInput(e)),p&&(p=!1),L&&(L=!1)},O=function(e){if(m)return;var t=c.value;A(t),T()},M=function(e,t,n){var r=e.clipboardData||window.clipboardData;if(!r||f)return;var i=l||n?"Text":"text/plain";try{return t?r.setData(i,t)!==!1:r.getData(i)}catch(e){if(!n)return M(e,t,!0)}},_=function(e,n){var s=t.getCopyText();if(!s)return r.preventDefault(e);M(e,s)?(i.isIOS&&(d=n,c.value="\n aa"+s+"a a\n",c.setSelectionRange(4,4+s.length),p={value:s}),n?t.onCut():t.onCopy(),i.isIOS||r.preventDefault(e)):(p=!0,c.value=s,c.select(),setTimeout(function(){p=!1,T(),x(),n?t.onCut():t.onCopy()}))},D=function(e){_(e,!0)},P=function(e){_(e,!1)},H=function(e){var n=M(e);typeof n=="string"?(n&&t.onPaste(n,e),i.isIE&&setTimeout(x),r.preventDefault(e)):(c.value="",v=!0)};r.addCommandKeyListener(c,t.onCommandKey.bind(t)),r.addListener(c,"select",C),r.addListener(c,"input",O),r.addListener(c,"cut",D),r.addListener(c,"copy",P),r.addListener(c,"paste",H);var B=function(e){if(m||!t.onCompositionStart||t.$readOnly)return;m={},m.canUndo=t.session.$undoManager,t.onCompositionStart(),setTimeout(j,0),t.on("mousedown",F),m.canUndo&&!t.selection.isEmpty()&&(t.insert(""),t.session.markUndoGroup(),t.selection.clearSelection()),t.session.markUndoGroup()},j=function(){if(!m||!t.onCompositionUpdate||t.$readOnly)return;var e=c.value.replace(/\x01/g,"");if(m.lastValue===e)return;t.onCompositionUpdate(e),m.lastValue&&t.undo(),m.canUndo&&(m.lastValue=e);if(m.lastValue){var n=t.selection.getRange();t.insert(m.lastValue),t.session.markUndoGroup(),m.range=t.selection.getRange(),t.selection.setRange(n),t.selection.clearSelection()}},F=function(e){if(!t.onCompositionEnd||t.$readOnly)return;var n=m;m=!1;var r=setTimeout(function(){r=null;var e=c.value.replace(/\x01/g,"");if(m)return;e==n.lastValue?T():!n.lastValue&&e&&(T(),A(e))});k=function(i){return r&&clearTimeout(r),i=i.replace(/\x01/g,""),i==n.lastValue?"":(n.lastValue&&r&&t.undo(),i)},t.onCompositionEnd(),t.removeListener("mousedown",F),e.type=="compositionend"&&n.range&&t.selection.setRange(n.range);var s=!!i.isChrome&&i.isChrome>=53||!!i.isWebKit&&i.isWebKit>=603;s&&O()},I=o.delayedCall(j,50);r.addListener(c,"compositionstart",B),r.addListener(c,"compositionupdate",function(){I.schedule()}),r.addListener(c,"keyup",function(){I.schedule()}),r.addListener(c,"keydown",function(){I.schedule()}),r.addListener(c,"compositionend",F),this.getElement=function(){return c},this.setReadOnly=function(e){c.readOnly=e},this.onContextMenu=function(e){L=!0,x(t.selection.isEmpty()),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,n){g||(g=c.style.cssText),c.style.cssText=(n?"z-index:100000;":"")+"height:"+c.style.height+";"+(i.isIE?"opacity:0.1;":"");var o=t.container.getBoundingClientRect(),u=s.computedStyle(t.container),a=o.top+(parseInt(u.borderTopWidth)||0),f=o.left+(parseInt(o.borderLeftWidth)||0),l=o.bottom-a-c.clientHeight-2,h=function(e){c.style.left=e.clientX-f-2+"px",c.style.top=Math.min(e.clientY-a-2,l)+"px"};h(e);if(e.type!="mousedown")return;t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=null),clearTimeout(q),i.isWin&&r.capture(t.container,h,R)},this.onContextMenuClose=R;var q,U=function(e){t.textInput.onContextMenu(e),R()};r.addListener(c,"mouseup",U),r.addListener(c,"mousedown",function(e){e.preventDefault(),R()}),r.addListener(t.renderer.scroller,"contextmenu",U),r.addListener(c,"contextmenu",U);if(i.isIOS){var z=null,W=!1;e.addEventListener("keydown",function(e){z&&clearTimeout(z),W=!0}),e.addEventListener("keyup",function(e){z=setTimeout(function(){W=!1},100)});var X=function(e){if(document.activeElement!==c)return;if(W)return;if(d)return setTimeout(function(){d=!1},100);var n=c.selectionStart,r=c.selectionEnd;c.setSelectionRange(4,5);if(n==r)switch(n){case 0:t.onCommandKey(null,0,u.up);break;case 1:t.onCommandKey(null,0,u.home);break;case 2:t.onCommandKey(null,a.option,u.left);break;case 4:t.onCommandKey(null,0,u.left);break;case 5:t.onCommandKey(null,0,u.right);break;case 7:t.onCommandKey(null,a.option,u.right);break;case 8:t.onCommandKey(null,0,u.end);break;case 9:t.onCommandKey(null,0,u.down)}else{switch(r){case 6:t.onCommandKey(null,a.shift,u.right);break;case 7:t.onCommandKey(null,a.shift|a.option,u.right);break;case 8:t.onCommandKey(null,a.shift,u.end);break;case 9:t.onCommandKey(null,a.shift,u.down)}switch(n){case 0:t.onCommandKey(null,a.shift,u.up);break;case 1:t.onCommandKey(null,a.shift,u.home);break;case 2:t.onCommandKey(null,a.shift|a.option,u.left);break;case 3:t.onCommandKey(null,a.shift,u.left)}}};document.addEventListener("selectionchange",X),t.on("destroy",function(){document.removeEventListener("selectionchange",X)})}};t.TextInput=c}),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/keyboard/textinput_ios"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=e("../lib/dom"),o=e("../lib/lang"),u=i.isChrome<18,a=i.isIE,f=i.isChrome>63,l=e("./textinput_ios").TextInput,c=function(e,t){function T(e){e=y?!1:e;if(v)return;v=!0;if(L)var t=0,r=e?0:n.value.length-1;else var t=e?2:1,r=2;try{n.setSelectionRange(t,r)}catch(i){}v=!1}function N(){if(v)return;n.value=c,i.isWebKit&&x.schedule()}function U(){clearTimeout(R),R=setTimeout(function(){m&&(n.style.cssText=m,m=""),t.renderer.$keepTextAreaAtCursor==null&&(t.renderer.$keepTextAreaAtCursor=!0,t.renderer.$moveTextAreaToCursor())},0)}if(i.isIOS)return l.call(this,e,t);var n=s.createElement("textarea");n.className="ace_text-input",n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck",!1),n.style.opacity="0",e.insertBefore(n,e.firstChild);var c=i.isIE?"\x01\x01":"\u2028\u2028",h=i.isIE?/\x01/g:/\u2028/g,p=!1,d=!1,v=!1,m="",g=!0,y=!1,b=!1;try{var w=document.activeElement===n}catch(E){}r.addListener(n,"blur",function(e){t.onBlur(e),w=!1}),r.addListener(n,"focus",function(e){w=!0,t.onFocus(e),T()}),this.$focusScroll=!1,this.focus=function(){if(m||f||this.$focusScroll=="browser")return n.focus({preventScroll:!0});var e=n.style.top;n.style.position="fixed",n.style.top="0px";var t=n.getBoundingClientRect().top!=0,r=[];if(t){var i=n.parentElement;while(i&&i.nodeType==1)r.push(i),i.setAttribute("ace_nocontext",!0),!i.parentElement&&i.getRootNode?i=i.getRootNode().host:i=i.parentElement}n.focus({preventScroll:!0}),t&&r.forEach(function(e){e.removeAttribute("ace_nocontext")}),setTimeout(function(){n.style.position="",n.style.top=="0px"&&(n.style.top=e)},0)},this.blur=function(){n.blur()},this.isFocused=function(){return w};var S=o.delayedCall(function(){w&&T(g)}),x=o.delayedCall(function(){v||(n.value=c,w&&T())});i.isWebKit||t.addEventListener("changeSelection",function(){t.selection.isEmpty()!=g&&(g=!g,S.schedule())}),N(),w&&t.onFocus();var C=function(e){return e.selectionStart===0&&e.selectionEnd===e.value.length},k=function(e){p?p=!1:C(n)?(t.selectAll(),T()):L&&T(t.selection.isEmpty())},L=null;this.setInputHandler=function(e){L=e},this.getInputHandler=function(){return L};var A=!1,O=function(e){L&&(e=L(e),L=null),d?(T(),e&&t.onPaste(e),d=!1):e==c.charAt(0)?A?t.execCommand("del",{source:"ace"}):t.execCommand("backspace",{source:"ace"}):(e.substring(0,2)==c?e=e.substr(2):e.charAt(0)==c.charAt(0)?e=e.substr(1):e.charAt(e.length-1)==c.charAt(0)&&(e=e.slice(0,-1)),e.charAt(e.length-1)==c.charAt(0)&&(e=e.slice(0,-1)),e&&t.onTextInput(e)),A&&(A=!1)},M=function(e){if(v)return;var t=n.value;O(t),N()},_=function(e,t,n){var r=e.clipboardData||window.clipboardData;if(!r||u)return;var i=a||n?"Text":"text/plain";try{return t?r.setData(i,t)!==!1:r.getData(i)}catch(e){if(!n)return _(e,t,!0)}},D=function(e,i){var s=t.getCopyText();if(!s)return r.preventDefault(e);_(e,s)?(i?t.onCut():t.onCopy(),r.preventDefault(e)):(p=!0,n.value=s,n.select(),setTimeout(function(){p=!1,N(),T(),i?t.onCut():t.onCopy()}))},P=function(e){D(e,!0)},H=function(e){D(e,!1)},B=function(e){var s=_(e);typeof s=="string"?(s&&t.onPaste(s,e),i.isIE&&setTimeout(T),r.preventDefault(e)):(n.value="",d=!0)};r.addCommandKeyListener(n,t.onCommandKey.bind(t)),r.addListener(n,"select",k),r.addListener(n,"input",M),r.addListener(n,"cut",P),r.addListener(n,"copy",H),r.addListener(n,"paste",B),(!("oncut"in n)||!("oncopy"in n)||!("onpaste"in n))&&r.addListener(e,"keydown",function(e){if(i.isMac&&!e.metaKey||!e.ctrlKey)return;switch(e.keyCode){case 67:H(e);break;case 86:B(e);break;case 88:P(e)}});var j=function(e){if(v||!t.onCompositionStart||t.$readOnly)return;v={},v.canUndo=t.session.$undoManager,t.onCompositionStart(),setTimeout(F,0),t.on("mousedown",I),v.canUndo&&!t.selection.isEmpty()&&(t.insert(""),t.session.markUndoGroup(),t.selection.clearSelection()),t.session.markUndoGroup()},F=function(){if(!v||!t.onCompositionUpdate||t.$readOnly)return;var e=n.value.replace(h,"");if(v.lastValue===e)return;t.onCompositionUpdate(e),v.lastValue&&t.undo(),v.canUndo&&(v.lastValue=e);if(v.lastValue){var r=t.selection.getRange();t.insert(v.lastValue),t.session.markUndoGroup(),v.range=t.selection.getRange(),t.selection.setRange(r),t.selection.clearSelection()}},I=function(e){if(!t.onCompositionEnd||t.$readOnly)return;var r=v;v=!1;var s=setTimeout(function(){s=null;var e=n.value.replace(h,"");if(v)return;e==r.lastValue?N():!r.lastValue&&e&&(N(),O(e))});L=function(n){return s&&clearTimeout(s),n=n.replace(h,""),n==r.lastValue?"":(r.lastValue&&s&&t.undo(),n)},t.onCompositionEnd(),t.removeListener("mousedown",I),e.type=="compositionend"&&r.range&&t.selection.setRange(r.range);var o=i.isIE||i.isChrome&&i.isChrome>=53||i.isWebKit&&i.isWebKit>=603;o&&M()},q=o.delayedCall(F,50);r.addListener(n,"compositionstart",j),r.addListener(n,"compositionupdate",function(){q.schedule()}),r.addListener(n,"keyup",function(){q.schedule()}),r.addListener(n,"keydown",function(){q.schedule()}),r.addListener(n,"compositionend",I),this.getElement=function(){return n},this.setCommandMode=function(e){b=e,n.readOnly=!1},this.setReadOnly=function(e){b||(n.readOnly=e)},this.setCopyWithEmptySelection=function(e){y=e},this.onContextMenu=function(e){A=!0,T(t.selection.isEmpty()),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,o){m||(m=n.style.cssText),n.style.cssText=(o?"z-index:100000;":"")+"height:"+n.style.height+";"+(i.isIE?"opacity:0.1;":"");var u=t.container.getBoundingClientRect(),a=s.computedStyle(t.container),f=u.top+(parseInt(a.borderTopWidth)||0),l=u.left+(parseInt(u.borderLeftWidth)||0),c=u.bottom-f-n.clientHeight-2,h=function(e){n.style.left=e.clientX-l-2+"px",n.style.top=Math.min(e.clientY-f-2,c)+"px"};h(e);if(e.type!="mousedown")return;t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=null),clearTimeout(R),i.isWin&&r.capture(t.container,h,U)},this.onContextMenuClose=U;var R,z=function(e){t.textInput.onContextMenu(e),U()};r.addListener(n,"mouseup",z),r.addListener(n,"mousedown",function(e){e.preventDefault(),U()}),r.addListener(t.renderer.scroller,"contextmenu",z),r.addListener(n,"contextmenu",z)};t.TextInput=c}),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,n){"use strict";function a(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e)),t.setDefaultHandler("touchmove",this.onTouchMove.bind(e));var n=["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"];n.forEach(function(t){e[t]=this[t]},this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function f(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))}function l(e,t){if(e.start.row==e.end.row)var n=2*t.column-e.start.column-e.end.column;else if(e.start.row==e.end.row-1&&!e.start.column&&!e.end.column)var n=t.column-4;else var n=2*t.row-e.start.row-e.end.row;return n<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}var r=e("../lib/dom"),i=e("../lib/event"),s=e("../lib/useragent"),o=0,u=250;(function(){this.onMouseDown=function(e){var t=e.inSelection(),n=e.getDocumentPosition();this.mousedownEvent=e;var r=this.editor,i=e.getButton();if(i!==0){var o=r.getSelectionRange(),u=o.isEmpty();(u||i==1)&&r.selection.moveToPosition(n),i==2&&(r.textInput.onContextMenu(e.domEvent),s.isMozilla||e.preventDefault());return}this.mousedownEvent.time=Date.now();if(t&&!r.isFocused()){r.focus();if(this.$focusTimeout&&!this.$clickSelection&&!r.inMultiSelectMode){this.setState("focusWait"),this.captureMouse(e);return}}return this.captureMouse(e),this.startSelect(n,e.domEvent._clicks>1),e.preventDefault()},this.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var n=this.editor;this.mousedownEvent.getShiftKey()?n.selection.selectToPosition(e):t||n.selection.moveToPosition(e),t||this.select(),n.renderer.scroller.setCapture&&n.renderer.scroller.setCapture(),n.setStyle("ace_selecting"),this.setState("select")},this.select=function(){var e,t=this.editor,n=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var r=this.$clickSelection.comparePoint(n);if(r==-1)e=this.$clickSelection.end;else if(r==1)e=this.$clickSelection.start;else{var i=l(this.$clickSelection,n);n=i.cursor,e=i.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(n),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,n=this.editor,r=n.renderer.screenToTextCoordinates(this.x,this.y),i=n.selection[e](r.row,r.column);if(this.$clickSelection){var s=this.$clickSelection.comparePoint(i.start),o=this.$clickSelection.comparePoint(i.end);if(s==-1&&o<=0){t=this.$clickSelection.end;if(i.end.row!=r.row||i.end.column!=r.column)r=i.start}else if(o==1&&s>=0){t=this.$clickSelection.start;if(i.start.row!=r.row||i.start.column!=r.column)r=i.end}else if(s==-1&&o==1)r=i.end,t=i.start;else{var u=l(this.$clickSelection,r);r=u.cursor,t=u.anchor}n.selection.setSelectionAnchor(t.row,t.column)}n.selection.selectToPosition(r),n.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e=f(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y),t=Date.now();(e>o||t-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),n=this.editor,r=n.session,i=r.getBracketRange(t);i?(i.isEmpty()&&(i.start.column--,i.end.column++),this.setState("select")):(i=n.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=i,this.select()},this.onTripleClick=function(e){var t=e.getDocumentPosition(),n=this.editor;this.setState("selectByLines");var r=n.getSelectionRange();r.isMultiLine()&&r.contains(t.row,t.column)?(this.$clickSelection=n.selection.getLineRange(r.start.row),this.$clickSelection.end=n.selection.getLineRange(r.end.row).end):this.$clickSelection=n.selection.getLineRange(t.row),this.select()},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(e.getAccelKey())return;e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var n=this.$lastScroll,r=e.domEvent.timeStamp,i=r-n.t,s=i?e.wheelX/i:n.vx,o=i?e.wheelY/i:n.vy;i<u&&(s=(s+n.vx)/2,o=(o+n.vy)/2);var a=Math.abs(s/o),f=!1;a>=1&&t.renderer.isScrollableBy(e.wheelX*e.speed,0)&&(f=!0),a<=1&&t.renderer.isScrollableBy(0,e.wheelY*e.speed)&&(f=!0);if(f)n.allowed=r;else if(r-n.allowed<u){var l=Math.abs(s)<=1.1*Math.abs(n.vx)&&Math.abs(o)<=1.1*Math.abs(n.vy);l?(f=!0,n.allowed=r):n.allowed=0}n.t=r,n.vx=s,n.vy=o;if(f)return t.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()},this.onTouchMove=function(e){this.editor._emit("mousewheel",e)}}).call(a.prototype),t.DefaultHandlers=a}),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],function(e,t,n){"use strict";function s(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}var r=e("./lib/oop"),i=e("./lib/dom");(function(){this.$init=function(){return this.$element=i.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){this.getElement().textContent=e},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(e){i.addCssClass(this.getElement(),e)},this.show=function(e,t,n){e!=null&&this.setText(e),t!=null&&n!=null&&this.setPosition(t,n),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(s.prototype),t.Tooltip=s}),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],function(e,t,n){"use strict";function u(e){function l(){var r=u.getDocumentPosition().row,s=n.$annotations[r];if(!s)return c();var o=t.session.getLength();if(r==o){var a=t.renderer.pixelToScreenCoordinates(0,u.y).row,l=u.$pos;if(a>t.session.documentToScreenRow(l.row,l.column))return c()}if(f==s)return;f=s.text.join("<br/>"),i.setHtml(f),i.show(),t._signal("showGutterTooltip",i),t.on("mousewheel",c);if(e.$tooltipFollowsMouse)h(u);else{var p=u.domEvent.target,d=p.getBoundingClientRect(),v=i.getElement().style;v.left=d.right+"px",v.top=d.bottom+"px"}}function c(){o&&(o=clearTimeout(o)),f&&(i.hide(),f=null,t._signal("hideGutterTooltip",i),t.removeEventListener("mousewheel",c))}function h(e){i.setPosition(e.x,e.y)}var t=e.editor,n=t.renderer.$gutterLayer,i=new a(t.container);e.editor.setDefaultHandler("guttermousedown",function(r){if(!t.isFocused()||r.getButton()!=0)return;var i=n.getRegion(r);if(i=="foldWidgets")return;var s=r.getDocumentPosition().row,o=t.session.selection;if(r.getShiftKey())o.selectTo(s,0);else{if(r.domEvent.detail==2)return t.selectAll(),r.preventDefault();e.$clickSelection=t.selection.getLineRange(s)}return e.setState("selectByLines"),e.captureMouse(r),r.preventDefault()});var o,u,f;e.editor.setDefaultHandler("guttermousemove",function(t){var n=t.domEvent.target||t.domEvent.srcElement;if(r.hasCssClass(n,"ace_fold-widget"))return c();f&&e.$tooltipFollowsMouse&&h(t),u=t;if(o)return;o=setTimeout(function(){o=null,u&&!e.isMousePressed?l():c()},50)}),s.addListener(t.renderer.$gutter,"mouseout",function(e){u=null;if(!f||o)return;o=setTimeout(function(){o=null,c()},50)}),t.on("changeSession",c)}function a(e){o.call(this,e)}var r=e("../lib/dom"),i=e("../lib/oop"),s=e("../lib/event"),o=e("../tooltip").Tooltip;i.inherits(a,o),function(){this.setPosition=function(e,t){var n=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,i=this.getWidth(),s=this.getHeight();e+=15,t+=15,e+i>n&&(e-=e+i-n),t+s>r&&(t-=20+s),o.prototype.setPosition.call(this,e,t)}}.call(a.prototype),t.GutterHandler=u}),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){r.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){r.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY),this.$pos)},this.inSelection=function(){if(this.$inSelection!==null)return this.$inSelection;var e=this.editor,t=e.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var n=this.getDocumentPosition();this.$inSelection=t.contains(n.row,n.column)}return this.$inSelection},this.getButton=function(){return r.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=i.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(s.prototype)}),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,n){"use strict";function f(e){function T(e,n){var r=Date.now(),i=!n||e.row!=n.row,s=!n||e.column!=n.column;if(!S||i||s)t.moveCursorToPosition(e),S=r,x={x:p,y:d};else{var o=l(x.x,x.y,p,d);o>a?S=null:r-S>=u&&(t.renderer.scrollCursorIntoView(),S=null)}}function N(e,n){var r=Date.now(),i=t.renderer.layerConfig.lineHeight,s=t.renderer.layerConfig.characterWidth,u=t.renderer.scroller.getBoundingClientRect(),a={x:{left:p-u.left,right:u.right-p},y:{top:d-u.top,bottom:u.bottom-d}},f=Math.min(a.x.left,a.x.right),l=Math.min(a.y.top,a.y.bottom),c={row:e.row,column:e.column};f/s<=2&&(c.column+=a.x.left<a.x.right?-3:2),l/i<=1&&(c.row+=a.y.top<a.y.bottom?-1:1);var h=e.row!=c.row,v=e.column!=c.column,m=!n||e.row!=n.row;h||v&&!m?E?r-E>=o&&t.renderer.scrollCursorIntoView(c):E=r:E=null}function C(){var e=g;g=t.renderer.screenToTextCoordinates(p,d),T(g,e),N(g,e)}function k(){m=t.selection.toOrientedRange(),h=t.session.addMarker(m,"ace_selection",t.getSelectionStyle()),t.clearSelection(),t.isFocused()&&t.renderer.$cursorLayer.setBlinking(!1),clearInterval(v),C(),v=setInterval(C,20),y=0,i.addListener(document,"mousemove",O)}function L(){clearInterval(v),t.session.removeMarker(h),h=null,t.selection.fromOrientedRange(m),t.isFocused()&&!w&&t.renderer.$cursorLayer.setBlinking(!t.getReadOnly()),m=null,g=null,y=0,E=null,S=null,i.removeListener(document,"mousemove",O)}function O(){A==null&&(A=setTimeout(function(){A!=null&&h&&L()},20))}function M(e){var t=e.types;return!t||Array.prototype.some.call(t,function(e){return e=="text/plain"||e=="Text"})}function _(e){var t=["copy","copymove","all","uninitialized"],n=["move","copymove","linkmove","all","uninitialized"],r=s.isMac?e.altKey:e.ctrlKey,i="uninitialized";try{i=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var o="none";return r&&t.indexOf(i)>=0?o="copy":n.indexOf(i)>=0?o="move":t.indexOf(i)>=0&&(o="copy"),o}var t=e.editor,n=r.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",s.isOpera&&(n.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");var f=["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"];f.forEach(function(t){e[t]=this[t]},this),t.addEventListener("mousedown",this.onMouseDown.bind(e));var c=t.container,h,p,d,v,m,g,y=0,b,w,E,S,x;this.onDragStart=function(e){if(this.cancelDrag||!c.draggable){var r=this;return setTimeout(function(){r.startSelect(),r.captureMouse(e)},0),e.preventDefault()}m=t.getSelectionRange();var i=e.dataTransfer;i.effectAllowed=t.getReadOnly()?"copy":"copyMove",s.isOpera&&(t.container.appendChild(n),n.scrollTop=0),i.setDragImage&&i.setDragImage(n,0,0),s.isOpera&&t.container.removeChild(n),i.clearData(),i.setData("Text",t.session.getTextRange()),w=!0,this.setState("drag")},this.onDragEnd=function(e){c.draggable=!1,w=!1,this.setState(null);if(!t.getReadOnly()){var n=e.dataTransfer.dropEffect;!b&&n=="move"&&t.session.remove(t.getSelectionRange()),t.renderer.$cursorLayer.setBlinking(!0)}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(t.getReadOnly()||!M(e.dataTransfer))return;return p=e.clientX,d=e.clientY,h||k(),y++,e.dataTransfer.dropEffect=b=_(e),i.preventDefault(e)},this.onDragOver=function(e){if(t.getReadOnly()||!M(e.dataTransfer))return;return p=e.clientX,d=e.clientY,h||(k(),y++),A!==null&&(A=null),e.dataTransfer.dropEffect=b=_(e),i.preventDefault(e)},this.onDragLeave=function(e){y--;if(y<=0&&h)return L(),b=null,i.preventDefault(e)},this.onDrop=function(e){if(!g)return;var n=e.dataTransfer;if(w)switch(b){case"move":m.contains(g.row,g.column)?m={start:g,end:g}:m=t.moveText(m,g);break;case"copy":m=t.moveText(m,g,!0)}else{var r=n.getData("Text");m={start:g,end:t.session.insert(g,r)},t.focus(),b=null}return L(),i.preventDefault(e)},i.addListener(c,"dragstart",this.onDragStart.bind(e)),i.addListener(c,"dragend",this.onDragEnd.bind(e)),i.addListener(c,"dragenter",this.onDragEnter.bind(e)),i.addListener(c,"dragover",this.onDragOver.bind(e)),i.addListener(c,"dragleave",this.onDragLeave.bind(e)),i.addListener(c,"drop",this.onDrop.bind(e));var A=null}function l(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))}var r=e("../lib/dom"),i=e("../lib/event"),s=e("../lib/useragent"),o=200,u=200,a=5;(function(){this.dragWait=function(){var e=Date.now()-this.mousedownEvent.time;e>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){var e=this.editor.container;e.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly()),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor,t=e.container;t.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var n=s.isWin?"default":"move";e.renderer.setCursorStyle(n),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;if(s.isIE&&this.state=="dragReady"){var n=l(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);n>3&&t.dragDrop()}if(this.state==="dragWait"){var n=l(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);n>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))}},this.onMouseDown=function(e){if(!this.$dragEnabled)return;this.mousedownEvent=e;var t=this.editor,n=e.inSelection(),r=e.getButton(),i=e.domEvent.detail||1;if(i===1&&r===0&&n){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var o=e.domEvent.target||e.domEvent.srcElement;"unselectable"in o&&(o.unselectable="on");if(t.getDragDelay()){if(s.isWebKit){this.cancelDrag=!0;var u=t.container;u.draggable=!0}this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}).call(f.prototype),t.DragdropHandler=f}),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],function(e,t,n){"use strict";var r=e("./dom");t.get=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){n.readyState===4&&t(n.responseText)},n.send(null)},t.loadScript=function(e,t){var n=r.getDocumentHead(),i=document.createElement("script");i.src=e,n.appendChild(i),i.onload=i.onreadystatechange=function(e,n){if(n||!i.readyState||i.readyState=="loaded"||i.readyState=="complete")i=i.onload=i.onreadystatechange=null,n||t()}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(e,t,n){"use strict";var r={},i=function(){this.propagationStopped=!0},s=function(){this.defaultPrevented=!0};r._emit=r._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var n=this._eventRegistry[e]||[],r=this._defaultHandlers[e];if(!n.length&&!r)return;if(typeof t!="object"||!t)t={};t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=i),t.preventDefault||(t.preventDefault=s),n=n.slice();for(var o=0;o<n.length;o++){n[o](t,this);if(t.propagationStopped)break}if(r&&!t.defaultPrevented)return r(t,this)},r._signal=function(e,t){var n=(this._eventRegistry||{})[e];if(!n)return;n=n.slice();for(var r=0;r<n.length;r++)n[r](t,this)},r.once=function(e,t){var n=this;t&&this.addEventListener(e,function r(){n.removeEventListener(e,r),t.apply(null,arguments)})},r.setDefaultHandler=function(e,t){var n=this._defaultHandlers;n||(n=this._defaultHandlers={_disabled_:{}});if(n[e]){var r=n[e],i=n._disabled_[e];i||(n._disabled_[e]=i=[]),i.push(r);var s=i.indexOf(t);s!=-1&&i.splice(s,1)}n[e]=t},r.removeDefaultHandler=function(e,t){var n=this._defaultHandlers;if(!n)return;var r=n._disabled_[e];if(n[e]==t){var i=n[e];r&&this.setDefaultHandler(e,r.pop())}else if(r){var s=r.indexOf(t);s!=-1&&r.splice(s,1)}},r.on=r.addEventListener=function(e,t,n){this._eventRegistry=this._eventRegistry||{};var r=this._eventRegistry[e];return r||(r=this._eventRegistry[e]=[]),r.indexOf(t)==-1&&r[n?"unshift":"push"](t),t},r.off=r.removeListener=r.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];if(!n)return;var r=n.indexOf(t);r!==-1&&n.splice(r,1)},r.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},t.EventEmitter=r}),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,n){"no use strict";function o(e){typeof console!="undefined"&&console.warn&&console.warn.apply(console,arguments)}function u(e,t){var n=new Error(e);n.data=t,typeof console=="object"&&console.error&&console.error(n),setTimeout(function(){throw n})}var r=e("./oop"),i=e("./event_emitter").EventEmitter,s={setOptions:function(e){Object.keys(e).forEach(function(t){this.setOption(t,e[t])},this)},getOptions:function(e){var t={};if(!e){var n=this.$options;e=Object.keys(n).filter(function(e){return!n[e].hidden})}else Array.isArray(e)||(t=e,e=Object.keys(t));return e.forEach(function(e){t[e]=this.getOption(e)},this),t},setOption:function(e,t){if(this["$"+e]===t)return;var n=this.$options[e];if(!n)return o('misspelled option "'+e+'"');if(n.forwardTo)return this[n.forwardTo]&&this[n.forwardTo].setOption(e,t);n.handlesSet||(this["$"+e]=t),n&&n.set&&n.set.call(this,t)},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:o('misspelled option "'+e+'"')}},a=function(){this.$defaultOptions={}};(function(){r.implement(this,i),this.defineOptions=function(e,t,n){return e.$options||(this.$defaultOptions[t]=e.$options={}),Object.keys(n).forEach(function(t){var r=n[t];typeof r=="string"&&(r={forwardTo:r}),r.name||(r.name=t),e.$options[r.name]=r,"initialValue"in r&&(e["$"+r.name]=r.initialValue)}),r.implement(e,s),this},this.resetOptions=function(e){Object.keys(e.$options).forEach(function(t){var n=e.$options[t];"value"in n&&e.setOption(t,n.value)})},this.setDefaultValue=function(e,t,n){var r=this.$defaultOptions[e]||(this.$defaultOptions[e]={});r[t]&&(r.forwardTo?this.setDefaultValue(r.forwardTo,t,n):r[t].value=n)},this.setDefaultValues=function(e,t){Object.keys(t).forEach(function(n){this.setDefaultValue(e,n,t[n])},this)},this.warn=o,this.reportError=u}).call(a.prototype),t.AppConfig=a}),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],function(e,t,n){"no use strict";function f(r){if(!u||!u.document)return;a.packaged=r||e.packaged||n.packaged||u.define&&define.packaged;var i={},s="",o=document.currentScript||document._currentScript,f=o&&o.ownerDocument||document,c=f.getElementsByTagName("script");for(var h=0;h<c.length;h++){var p=c[h],d=p.src||p.getAttribute("src");if(!d)continue;var v=p.attributes;for(var m=0,g=v.length;m<g;m++){var y=v[m];y.name.indexOf("data-ace-")===0&&(i[l(y.name.replace(/^data-ace-/,""))]=y.value)}var b=d.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);b&&(s=b[1])}s&&(i.base=i.base||s,i.packaged=!0),i.basePath=i.base,i.workerPath=i.workerPath||i.base,i.modePath=i.modePath||i.base,i.themePath=i.themePath||i.base,delete i.base;for(var w in i)typeof i[w]!="undefined"&&t.set(w,i[w])}function l(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}var r=e("./lib/lang"),i=e("./lib/oop"),s=e("./lib/net"),o=e("./lib/app_config").AppConfig;n.exports=t=new o;var u=function(){return this||typeof window!="undefined"&&window}(),a={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};t.get=function(e){if(!a.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return a[e]},t.set=function(e,t){if(!a.hasOwnProperty(e))throw new Error("Unknown config key: "+e);a[e]=t},t.all=function(){return r.copyObject(a)},t.moduleUrl=function(e,t){if(a.$moduleUrls[e])return a.$moduleUrls[e];var n=e.split("/");t=t||n[n.length-2]||"";var r=t=="snippets"?"/":"-",i=n[n.length-1];if(t=="worker"&&r=="-"){var s=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");i=i.replace(s,"")}(!i||i==t)&&n.length>1&&(i=n[n.length-2]);var o=a[t+"Path"];return o==null?o=a.basePath:r=="/"&&(t=r=""),o&&o.slice(-1)!="/"&&(o+="/"),o+t+r+i+this.get("suffix")},t.setModuleUrl=function(e,t){return a.$moduleUrls[e]=t},t.$loading={},t.loadModule=function(n,r){var i,o;Array.isArray(n)&&(o=n[0],n=n[1]);try{i=e(n)}catch(u){}if(i&&!t.$loading[n])return r&&r(i);t.$loading[n]||(t.$loading[n]=[]),t.$loading[n].push(r);if(t.$loading[n].length>1)return;var a=function(){e([n],function(e){t._emit("load.module",{name:n,module:e});var r=t.$loading[n];t.$loading[n]=null,r.forEach(function(t){t&&t(e)})})};if(!t.get("packaged"))return a();s.loadScript(t.moduleUrl(n,o),a)},t.init=f}),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/config"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=e("./default_handlers").DefaultHandlers,o=e("./default_gutter_handler").GutterHandler,u=e("./mouse_event").MouseEvent,a=e("./dragdrop_handler").DragdropHandler,f=e("../config"),l=function(e){var t=this;this.editor=e,new s(this),new o(this),new a(this);var n=function(t){var n=!document.hasFocus||!document.hasFocus()||!e.isFocused()&&document.activeElement==(e.textInput&&e.textInput.getElement());n&&window.focus(),e.focus()},u=e.renderer.getMouseEventTarget();r.addListener(u,"click",this.onMouseEvent.bind(this,"click")),r.addListener(u,"mousemove",this.onMouseMove.bind(this,"mousemove")),r.addMultiMouseDownListener([u,e.renderer.scrollBarV&&e.renderer.scrollBarV.inner,e.renderer.scrollBarH&&e.renderer.scrollBarH.inner,e.textInput&&e.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent"),r.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel")),r.addTouchMoveListener(e.container,this.onTouchMove.bind(this,"touchmove"));var f=e.renderer.$gutter;r.addListener(f,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),r.addListener(f,"click",this.onMouseEvent.bind(this,"gutterclick")),r.addListener(f,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),r.addListener(f,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),r.addListener(u,"mousedown",n),r.addListener(f,"mousedown",n),i.isIE&&e.renderer.scrollBarV&&(r.addListener(e.renderer.scrollBarV.element,"mousedown",n),r.addListener(e.renderer.scrollBarH.element,"mousedown",n)),e.on("mousemove",function(n){if(t.state||t.$dragDelay||!t.$dragEnabled)return;var r=e.renderer.screenToTextCoordinates(n.x,n.y),i=e.session.selection.getRange(),s=e.renderer;!i.isEmpty()&&i.insideStart(r.row,r.column)?s.setCursorStyle("default"):s.setCursorStyle("")})};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new u(t,this.editor))},this.onMouseMove=function(e,t){var n=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;if(!n||!n.length)return;this.editor._emit(e,new u(t,this.editor))},this.onMouseWheel=function(e,t){var n=new u(t,this.editor);n.speed=this.$scrollSpeed*2,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.onTouchMove=function(e,t){var n=new u(t,this.editor);n.speed=1,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var n=this.editor,s=this.editor.renderer;s.$keepTextAreaAtCursor&&(s.$keepTextAreaAtCursor=null);var o=this,a=function(e){if(!e)return;if(i.isWebKit&&!e.which&&o.releaseMouse)return o.releaseMouse();o.x=e.clientX,o.y=e.clientY,t&&t(e),o.mouseEvent=new u(e,o.editor),o.$mouseMoved=!0},f=function(e){n.off("beforeEndOperation",c),clearInterval(h),l(),o[o.state+"End"]&&o[o.state+"End"](e),o.state="",s.$keepTextAreaAtCursor==null&&(s.$keepTextAreaAtCursor=!0,s.$moveTextAreaToCursor()),o.isMousePressed=!1,o.$onCaptureMouseMove=o.releaseMouse=null,e&&o.onMouseEvent("mouseup",e)},l=function(){o[o.state]&&o[o.state](),o.$mouseMoved=!1};if(i.isOldIE&&e.domEvent.type=="dblclick")return setTimeout(function(){f(e)});var c=function(e){n.curOp.command.name&&n.curOp.selectionChanged&&(o[o.state+"End"]&&o[o.state+"End"](),o.state="",o.releaseMouse())};n.on("beforeEndOperation",c),o.$onCaptureMouseMove=a,o.releaseMouse=r.capture(this.editor.container,a,f);var h=setInterval(l,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var e=function(t){if(t&&t.domEvent&&t.domEvent.type!="contextmenu")return;this.editor.off("nativecontextmenu",e),t&&t.domEvent&&r.stopEvent(t.domEvent)}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)}}).call(l.prototype),f.defineOptions(l.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:i.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=l}),ace.define("ace/mouse/fold_handler",["require","exports","module","ace/lib/dom"],function(e,t,n){"use strict";function i(e){e.on("click",function(t){var n=t.getDocumentPosition(),i=e.session,s=i.getFoldAt(n.row,n.column,1);s&&(t.getAccelKey()?i.removeFold(s):i.expandFold(s),t.stop());var o=t.domEvent&&t.domEvent.target;o&&r.hasCssClass(o,"ace_inline_button")&&r.hasCssClass(o,"ace_toggle_wrap")&&(i.setOption("wrap",!0),e.renderer.scrollCursorIntoView())}),e.on("gutterclick",function(t){var n=e.renderer.$gutterLayer.getRegion(t);if(n=="foldWidgets"){var r=t.getDocumentPosition().row,i=e.session;i.foldWidgets&&i.foldWidgets[r]&&e.session.onFoldWidgetClick(r,t),e.isFocused()||e.focus(),t.stop()}}),e.on("gutterdblclick",function(t){var n=e.renderer.$gutterLayer.getRegion(t);if(n=="foldWidgets"){var r=t.getDocumentPosition().row,i=e.session,s=i.getParentFoldRangeData(r,!0),o=s.range||s.firstRange;if(o){r=o.start.row;var u=i.getFoldAt(r,i.getLine(r).length,1);u?i.removeFold(u):(i.addFold("...",o),e.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}t.stop()}})}var r=e("../lib/dom");t.FoldHandler=i}),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],function(e,t,n){"use strict";var r=e("../lib/keys"),i=e("../lib/event"),s=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]==e)return;while(t[t.length-1]&&t[t.length-1]!=this.$defaultHandler)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)},this.addKeyboardHandler=function(e,t){if(!e)return;typeof e=="function"&&!e.handleKeyboard&&(e.handleKeyboard=e);var n=this.$handlers.indexOf(e);n!=-1&&this.$handlers.splice(n,1),t==undefined?this.$handlers.push(e):this.$handlers.splice(t,0,e),n==-1&&e.attach&&e.attach(this.$editor)},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return t==-1?!1:(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var e=this.$data,t=e.editor;return this.$handlers.map(function(n){return n.getStatusText&&n.getStatusText(t,e)||""}).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(e,t,n,r){var s,o=!1,u=this.$editor.commands;for(var a=this.$handlers.length;a--;){s=this.$handlers[a].handleKeyboard(this.$data,e,t,n,r);if(!s||!s.command)continue;s.command=="null"?o=!0:o=u.exec(s.command,this.$editor,s.args,r),o&&r&&e!=-1&&s.passEvent!=1&&s.command.passEvent!=1&&i.stopEvent(r);if(o)break}return!o&&e==-1&&(s={command:"insertstring"},o=u.exec("insertstring",this.$editor,t)),o&&this.$editor._signal&&this.$editor._signal("keyboardActivity",s),o},this.onCommandKey=function(e,t,n){var i=r.keyCodeToString(n);this.$callKeyboardHandlers(t,i,n,e)},this.onTextInput=function(e){this.$callKeyboardHandlers(-1,e)}}).call(s.prototype),t.KeyBinding=s}),ace.define("ace/lib/bidiutil",["require","exports","module"],function(e,t,n){"use strict";function F(e,t,n,r){var i=s?d:p,c=null,h=null,v=null,m=0,g=null,y=null,b=-1,w=null,E=null,T=[];if(!r)for(w=0,r=[];w<n;w++)r[w]=R(e[w]);o=s,u=!1,a=!1,f=!1,l=!1;for(E=0;E<n;E++){c=m,T[E]=h=q(e,r,T,E),m=i[c][h],g=m&240,m&=15,t[E]=v=i[m][5];if(g>0)if(g==16){for(w=b;w<E;w++)t[w]=1;b=-1}else b=-1;y=i[m][6];if(y)b==-1&&(b=E);else if(b>-1){for(w=b;w<E;w++)t[w]=v;b=-1}r[E]==S&&(t[E]=0),o|=v}if(l)for(w=0;w<n;w++)if(r[w]==x){t[w]=s;for(var C=w-1;C>=0;C--){if(r[C]!=N)break;t[C]=s}}}function I(e,t,n){if(o<e)return;if(e==1&&s==m&&!f){n.reverse();return}var r=n.length,i=0,u,a,l,c;while(i<r){if(t[i]>=e){u=i+1;while(u<r&&t[u]>=e)u++;for(a=i,l=u-1;a<l;a++,l--)c=n[a],n[a]=n[l],n[l]=c;i=u}i++}}function q(e,t,n,r){var i=t[r],o,c,h,p;switch(i){case g:case y:u=!1;case E:case w:return i;case b:return u?w:b;case T:return u=!0,a=!0,y;case N:return E;case C:if(r<1||r+1>=t.length||(o=n[r-1])!=b&&o!=w||(c=t[r+1])!=b&&c!=w)return E;return u&&(c=w),c==o?c:E;case k:o=r>0?n[r-1]:S;if(o==b&&r+1<t.length&&t[r+1]==b)return b;return E;case L:if(r>0&&n[r-1]==b)return b;if(u)return E;p=r+1,h=t.length;while(p<h&&t[p]==L)p++;if(p<h&&t[p]==b)return b;return E;case A:h=t.length,p=r+1;while(p<h&&t[p]==A)p++;if(p<h){var d=e[r],v=d>=1425&&d<=2303||d==64286;o=t[p];if(v&&(o==y||o==T))return y}if(r<1||(o=t[r-1])==S)return E;return n[r-1];case S:return u=!1,f=!0,s;case x:return l=!0,E;case O:case M:case D:case P:case _:u=!1;case H:return E}}function R(e){var t=e.charCodeAt(0),n=t>>8;return n==0?t>191?g:B[t]:n==5?/[\u0591-\u05f4]/.test(e)?y:g:n==6?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(e)?A:/[\u0660-\u0669\u066b-\u066c]/.test(e)?w:t==1642?L:/[\u06f0-\u06f9]/.test(e)?b:T:n==32&&t<=8287?j[t&255]:n==254?t>=65136?T:E:E}function U(e){return e>="\u064b"&&e<="\u0655"}var r=["\u0621","\u0641"],i=["\u063a","\u064a"],s=0,o=0,u=!1,a=!1,f=!1,l=!1,c=!1,h=!1,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v=0,m=1,g=0,y=1,b=2,w=3,E=4,S=5,x=6,T=7,N=8,C=9,k=10,L=11,A=12,O=13,M=14,_=15,D=16,P=17,H=18,B=[H,H,H,H,H,H,H,H,H,x,S,x,N,S,H,H,H,H,H,H,H,H,H,H,H,H,H,H,S,S,S,x,N,E,E,L,L,L,E,E,E,E,E,k,C,k,C,C,b,b,b,b,b,b,b,b,b,b,C,E,E,E,E,E,E,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,E,E,E,E,E,E,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,E,E,E,E,H,H,H,H,H,H,S,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,C,E,L,L,L,L,E,E,E,E,g,E,E,H,E,E,L,L,b,b,E,g,E,E,E,b,g,E,E,E,E,E],j=[N,N,N,N,N,N,N,N,N,N,N,H,H,H,g,y,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,N,S,O,M,_,D,P,C,L,L,L,L,L,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,C,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,N];t.L=g,t.R=y,t.EN=b,t.ON_R=3,t.AN=4,t.R_H=5,t.B=6,t.DOT="\u00b7",t.doBidiReorder=function(e,n,r){if(e.length<2)return{};var i=e.split(""),o=new Array(i.length),u=new Array(i.length),a=[];s=r?m:v,F(i,a,i.length,n);for(var f=0;f<o.length;o[f]=f,f++);I(2,a,o),I(1,a,o);for(var f=0;f<o.length-1;f++)n[f]===w?a[f]=t.AN:a[f]===y&&(n[f]>T&&n[f]<O||n[f]===E||n[f]===H)?a[f]=t.ON_R:f>0&&i[f-1]==="\u0644"&&/\u0622|\u0623|\u0625|\u0627/.test(i[f])&&(a[f-1]=a[f]=t.R_H,f++);i[i.length-1]===t.DOT&&(a[i.length-1]=t.B);for(var f=0;f<o.length;f++)u[f]=a[o[f]];return{logicalFromVisual:o,bidiLevels:u}},t.hasBidiCharacters=function(e,t){var n=!1;for(var r=0;r<e.length;r++)t[r]=R(e.charAt(r)),!n&&(t[r]==y||t[r]==T)&&(n=!0);return n},t.getVisualFromLogicalIdx=function(e,t){for(var n=0;n<t.logicalFromVisual.length;n++)if(t.logicalFromVisual[n]==e)return n;return 0}}),ace.define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang","ace/lib/useragent"],function(e,t,n){"use strict";var r=e("./lib/bidiutil"),i=e("./lib/lang"),s=e("./lib/useragent"),o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,u=function(e){this.session=e,this.bidiMap={},this.currentRow=null,this.bidiUtil=r,this.charWidths=[],this.EOL="\u00ac",this.showInvisibles=!0,this.isRtlDir=!1,this.line="",this.wrapIndent=0,this.isLastRow=!1,this.EOF="\u00b6",this.seenBidi=!1};(function(){this.isBidiRow=function(e,t,n){return this.seenBidi?(e!==this.currentRow&&(this.currentRow=e,this.updateRowLine(t,n),this.updateBidiMap()),this.bidiMap.bidiLevels):!1},this.onChange=function(e){this.seenBidi?this.currentRow=null:e.action=="insert"&&o.test(e.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var n=this.session.$getRowCacheIndex(t,this.currentRow);n>=0&&(e=this.session.$docRowCache[n])}return e},this.getSplitIndex=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var n,r=this.session.$getRowCacheIndex(t,this.currentRow);while(this.currentRow-e>0){n=this.session.$getRowCacheIndex(t,this.currentRow-e-1);if(n!==r)break;r=n,e++}}return e},this.updateRowLine=function(e,t){e===undefined&&(e=this.getDocumentRow()),this.wrapIndent=0,this.isLastRow=e===this.session.getLength()-1,this.line=this.session.getLine(e);if(this.session.$useWrapMode){var n=this.session.$wrapData[e];n&&(t===undefined&&(t=this.getSplitIndex()),t>0&&n.length?(this.wrapIndent=n.indent,this.line=t<n.length?this.line.substring(n[t-1],n[n.length-1]):this.line.substring(n[n.length-1])):this.line=this.line.substring(0,n[t]))}var s=this.session,o=0,u;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,function(e,t){return e==="	"||s.isFullWidth(e.charCodeAt(0))?(u=e==="	"?s.getScreenTabSize(t+o):2,o+=u-1,i.stringRepeat(r.DOT,u)):e})},this.updateBidiMap=function(){var e=[],t=this.isLastRow?this.EOF:this.EOL,n=this.line+(this.showInvisibles?t:r.DOT);r.hasBidiCharacters(n,e)?this.bidiMap=r.doBidiReorder(n,e,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(e){if(!this.seenBidi)return;if(this.characterWidth===e.$characterSize.width)return;var t=this.characterWidth=e.$characterSize.width,n=e.$measureCharWidth("\u05d4");this.charWidths[r.L]=this.charWidths[r.EN]=this.charWidths[r.ON_R]=t,this.charWidths[r.R]=this.charWidths[r.AN]=n,this.charWidths[r.R_H]=s.isChrome?n:n*.45,this.charWidths[r.B]=0,this.currentRow=null},this.getShowInvisibles=function(){return this.showInvisibles},this.setShowInvisibles=function(e){this.showInvisibles=e,this.currentRow=null},this.setEolChar=function(e){this.EOL=e},this.setTextDir=function(e){this.isRtlDir=e},this.getPosLeft=function(e){e-=this.wrapIndent;var t=r.getVisualFromLogicalIdx(e>0?e-1:0,this.bidiMap),n=this.bidiMap.bidiLevels,i=0;e===0&&n[t]%2!==0&&t++;for(var s=0;s<t;s++)i+=this.charWidths[n[s]];return e!==0&&n[t]%2===0&&(i+=this.charWidths[n[t]]),this.wrapIndent&&(i+=this.wrapIndent*this.charWidths[r.L]),i},this.getSelections=function(e,t){var n=this.bidiMap,i=n.bidiLevels,s,o=this.wrapIndent*this.charWidths[r.L],u=[],a=Math.min(e,t)-this.wrapIndent,f=Math.max(e,t)-this.wrapIndent,l=!1,c=!1,h=0;for(var p,d=0;d<i.length;d++)p=n.logicalFromVisual[d],s=i[d],l=p>=a&&p<f,l&&!c?h=o:!l&&c&&u.push({left:h,width:o-h}),o+=this.charWidths[s],c=l;return l&&d===i.length&&u.push({left:h,width:o-h}),u},this.offsetToCol=function(e){var t=0,e=Math.max(e,0),n=0,i=0,s=this.bidiMap.bidiLevels,o=this.charWidths[s[i]];this.wrapIndent&&(e-=this.wrapIndent*this.charWidths[r.L]);while(e>n+o/2){n+=o;if(i===s.length-1){o=0;break}o=this.charWidths[s[++i]]}return i>0&&s[i-1]%2!==0&&s[i]%2===0?(e<n&&i--,t=this.bidiMap.logicalFromVisual[i]):i>0&&s[i-1]%2===0&&s[i]%2!==0?t=1+(e>n?this.bidiMap.logicalFromVisual[i]:this.bidiMap.logicalFromVisual[i-1]):this.isRtlDir&&i===s.length-1&&o===0&&s[i-1]%2===0||!this.isRtlDir&&i===0&&s[i]%2!==0?t=1+this.bidiMap.logicalFromVisual[i]:(i>0&&s[i-1]%2!==0&&o!==0&&i--,t=this.bidiMap.logicalFromVisual[i]),t+this.wrapIndent}}).call(u.prototype),t.BidiHandler=u}),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/lang"),s=e("./lib/event_emitter").EventEmitter,o=e("./range").Range,u=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var t=this;this.cursor.on("change",function(e){t.$cursorChanged=!0,t.$silent||t._emit("changeCursor"),!t.$isEmpty&&!t.$silent&&t._emit("changeSelection"),!t.$keepDesiredColumnOnChange&&e.old.column!=e.value.column&&(t.$desiredColumn=null)}),this.anchor.on("change",function(){t.$anchorChanged=!0,!t.$isEmpty&&!t.$silent&&t._emit("changeSelection")})};(function(){r.implement(this,s),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.$isEmpty=!1,this.anchor.setPosition(e,t)},this.getAnchor=this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.$isEmpty?o.fromPoints(t,t):this.isBackwards()?o.fromPoints(t,e):o.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},this.setRange=this.setSelectionRange=function(e,t){var n=t?e.end:e.start,r=t?e.start:e.end;this.$setSelection(n.row,n.column,r.row,r.column)},this.$setSelection=function(e,t,n,r){var i=this.$isEmpty,s=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(e,t),this.cursor.setPosition(n,r),this.$isEmpty=!o.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||i!=this.$isEmpty||s)&&this._emit("changeSelection")},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection(function(){this.moveCursorTo(e,t)})},this.selectToPosition=function(e){this.$moveSelection(function(){this.moveCursorToPosition(e)})},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if(typeof t=="undefined"){var n=e||this.lead;e=n.row,t=n.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var n=typeof e=="number"?e:this.lead.row,r,i=this.session.getFoldLine(n);return i?(n=i.start.row,r=i.end.row):r=n,t===!0?new o(n,0,r,this.session.getLine(r).length):new o(n,0,r+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(e,t,n){var r=e.column,i=e.column+t;return n<0&&(r=e.column-t,i=e.column),this.session.isTabStop(e)&&this.doc.getLine(e.row).slice(r,i).split(" ").length-1==t},this.moveCursorLeft=function(){var e=this.lead.getPosition(),t;if(t=this.session.getFoldAt(e.row,e.column,-1))this.moveCursorTo(t.start.row,t.start.column);else if(e.column===0)e.row>0&&this.moveCursorTo(e.row-1,this.doc.getLine(e.row-1).length);else{var n=this.session.getTabSize();this.wouldMoveIntoSoftTab(e,n,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-n):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e=this.lead.getPosition(),t;if(t=this.session.getFoldAt(e.row,e.column,1))this.moveCursorTo(t.end.row,t.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var n=this.session.getTabSize(),e=this.lead;this.wouldMoveIntoSoftTab(e,n,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,n):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,n=this.session.documentToScreenRow(e,t),r=this.session.screenToDocumentPosition(n,0),i=this.session.getDisplayLine(e,null,r.row,r.column),s=i.match(/^\s*/);s[0].length!=t&&!this.session.$useEmacsStyleLineStart&&(r.column+=s[0].length),this.moveCursorToPosition(r)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var n=this.session.getLine(t.row);if(t.column==n.length){var r=n.search(/\s+$/);r>0&&(t.column=r)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),r=n.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var i=this.session.getFoldAt(e,t,1);if(i){this.moveCursorTo(i.end.row,i.end.column);return}this.session.nonTokenRe.exec(r)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,r=n.substring(t));if(t>=n.length){this.moveCursorTo(e,n.length),this.moveCursorRight(),e<this.doc.getLength()-1&&this.moveCursorWordRight();return}this.session.tokenRe.exec(r)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)},this.moveCursorLongWordLeft=function(){var e=this.lead.row,t=this.lead.column,n;if(n=this.session.getFoldAt(e,t,-1)){this.moveCursorTo(n.start.row,n.start.column);return}var r=this.session.getFoldStringAt(e,t,-1);r==null&&(r=this.doc.getLine(e).substring(0,t));var s=i.stringReverse(r);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(s)&&(t-=this.session.nonTokenRe.lastIndex,s=s.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0);if(t<=0){this.moveCursorTo(e,0),this.moveCursorLeft(),e>0&&this.moveCursorWordLeft();return}this.session.tokenRe.exec(s)&&(t-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)},this.$shortWordEndIndex=function(e){var t=0,n,r=/\s/,i=this.session.tokenRe;i.lastIndex=0;if(this.session.tokenRe.exec(e))t=this.session.tokenRe.lastIndex;else{while((n=e[t])&&r.test(n))t++;if(t<1){i.lastIndex=0;while((n=e[t])&&!i.test(n)){i.lastIndex=0,t++;if(r.test(n)){if(t>2){t--;break}while((n=e[t])&&r.test(n))t++;if(t>2)break}}}}return i.lastIndex=0,t},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),r=n.substring(t),i=this.session.getFoldAt(e,t,1);if(i)return this.moveCursorTo(i.end.row,i.end.column);if(t==n.length){var s=this.doc.getLength();do e++,r=this.doc.getLine(e);while(e<s&&/^\s*$/.test(r));/^\s+/.test(r)||(r=""),t=0}var o=this.$shortWordEndIndex(r);this.moveCursorTo(e,t+o)},this.moveCursorShortWordLeft=function(){var e=this.lead.row,t=this.lead.column,n;if(n=this.session.getFoldAt(e,t,-1))return this.moveCursorTo(n.start.row,n.start.column);var r=this.session.getLine(e).substring(0,t);if(t===0){do e--,r=this.doc.getLine(e);while(e>0&&/^\s*$/.test(r));t=r.length,/\s+$/.test(r)||(r="")}var s=i.stringReverse(r),o=this.$shortWordEndIndex(s);return this.moveCursorTo(e,t-o)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var n=this.session.documentToScreenPosition(this.lead.row,this.lead.column),r;t===0&&(e!==0&&(this.session.$bidiHandler.isBidiRow(n.row,this.lead.row)?(r=this.session.$bidiHandler.getPosLeft(n.column),n.column=Math.round(r/this.session.$bidiHandler.charWidths[0])):r=n.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?n.column=this.$desiredColumn:this.$desiredColumn=n.column);var i=this.session.screenToDocumentPosition(n.row+e,n.column,r);e!==0&&t===0&&i.row===this.lead.row&&i.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[i.row]&&(i.row>0||e>0)&&i.row++,this.moveCursorTo(i.row,i.column+t,t===0)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,n){var r=this.session.getFoldAt(e,t,1);r&&(e=r.start.row,t=r.start.column),this.$keepDesiredColumnOnChange=!0;var i=this.session.getLine(e);/[\uDC00-\uDFFF]/.test(i.charAt(t))&&i.charAt(t-1)&&(this.lead.row==e&&this.lead.column==t+1?t-=1:t+=1),this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,n||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,n){var r=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(r.row,r.column,n)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e(this);var n=this.getCursor();return o.fromPoints(t,n)}catch(r){return o.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map(function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t});else{var e=this.getRange();e.isBackwards=this.isBackwards()}return e},this.fromJSON=function(e){if(e.start==undefined){if(this.rangeList){this.toSingleRange(e[0]);for(var t=e.length;t--;){var n=o.fromPoints(e[t].start,e[t].end);e[t].isBackwards&&(n.cursor=n.start),this.addRange(n,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(u.prototype),t.Selection=u}),ace.define("ace/tokenizer",["require","exports","module","ace/config"],function(e,t,n){"use strict";var r=e("./config"),i=2e3,s=function(e){this.states=e,this.regExps={},this.matchMappings={};for(var t in this.states){var n=this.states[t],r=[],i=0,s=this.matchMappings[t]={defaultToken:"text"},o="g",u=[];for(var a=0;a<n.length;a++){var f=n[a];f.defaultToken&&(s.defaultToken=f.defaultToken),f.caseInsensitive&&(o="gi");if(f.regex==null)continue;f.regex instanceof RegExp&&(f.regex=f.regex.toString().slice(1,-1));var l=f.regex,c=(new RegExp("(?:("+l+")|(.))")).exec("a").length-2;Array.isArray(f.token)?f.token.length==1||c==1?f.token=f.token[0]:c-1!=f.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:f,groupCount:c-1}),f.token=f.token[0]):(f.tokenArray=f.token,f.token=null,f.onMatch=this.$arrayTokens):typeof f.token=="function"&&!f.onMatch&&(c>1?f.onMatch=this.$applyToken:f.onMatch=f.token),c>1&&(/\\\d/.test(f.regex)?l=f.regex.replace(/\\([0-9]+)/g,function(e,t){return"\\"+(parseInt(t,10)+i+1)}):(c=1,l=this.removeCapturingGroups(f.regex)),!f.splitRegex&&typeof f.token!="string"&&u.push(f)),s[i]=a,i+=c,r.push(l),f.onMatch||(f.onMatch=null)}r.length||(s[0]=0,r.push("$")),u.forEach(function(e){e.splitRegex=this.createSplitterRegexp(e.regex,o)},this),this.regExps[t]=new RegExp("("+r.join(")|(")+")|($)",o)}};(function(){this.$setMaxTokenCount=function(e){i=e|0},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),n=this.token.apply(this,t);if(typeof n=="string")return[{type:n,value:e}];var r=[];for(var i=0,s=n.length;i<s;i++)t[i]&&(r[r.length]={type:n[i],value:t[i]});return r},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";var n=[],r=this.tokenArray;for(var i=0,s=r.length;i<s;i++)t[i+1]&&(n[n.length]={type:r[i],value:t[i+1]});return n},this.removeCapturingGroups=function(e){var t=e.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,function(e,t){return t?"(?:":e});return t},this.createSplitterRegexp=function(e,t){if(e.indexOf("(?=")!=-1){var n=0,r=!1,i={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(e,t,s,o,u,a){return r?r=u!="]":u?r=!0:o?(n==i.stack&&(i.end=a+1,i.stack=-1),n--):s&&(n++,s.length!=1&&(i.stack=n,i.start=a)),e}),i.end!=null&&/^\)*$/.test(e.substr(i.end))&&(e=e.substring(0,i.start)+e.substr(i.end))}return e.charAt(0)!="^"&&(e="^"+e),e.charAt(e.length-1)!="$"&&(e+="$"),new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&typeof t!="string"){var n=t.slice(0);t=n[0],t==="#tmp"&&(n.shift(),t=n.shift())}else var n=[];var r=t||"start",s=this.states[r];s||(r="start",s=this.states[r]);var o=this.matchMappings[r],u=this.regExps[r];u.lastIndex=0;var a,f=[],l=0,c=0,h={type:null,value:""};while(a=u.exec(e)){var p=o.defaultToken,d=null,v=a[0],m=u.lastIndex;if(m-v.length>l){var g=e.substring(l,m-v.length);h.type==p?h.value+=g:(h.type&&f.push(h),h={type:p,value:g})}for(var y=0;y<a.length-2;y++){if(a[y+1]===undefined)continue;d=s[o[y]],d.onMatch?p=d.onMatch(v,r,n,e):p=d.token,d.next&&(typeof d.next=="string"?r=d.next:r=d.next(r,n),s=this.states[r],s||(this.reportError("state doesn't exist",r),r="start",s=this.states[r]),o=this.matchMappings[r],l=m,u=this.regExps[r],u.lastIndex=m),d.consumeLineEnd&&(l=m);break}if(v)if(typeof p=="string")!!d&&d.merge===!1||h.type!==p?(h.type&&f.push(h),h={type:p,value:v}):h.value+=v;else if(p){h.type&&f.push(h),h={type:null,value:""};for(var y=0;y<p.length;y++)f.push(p[y])}if(l==e.length)break;l=m;if(c++>i){c>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:t,line:e});while(l<e.length)h.type&&f.push(h),h={value:e.substring(l,l+=2e3),type:"overflow"};r="start",n=[];break}}return h.type&&f.push(h),n.length>1&&n[0]!==r&&n.unshift("#tmp",r),{tokens:f,state:n.length?n:r}},this.reportError=r.reportError}).call(s.prototype),t.Tokenizer=s}),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],function(e,t,n){"use strict";var r=e("../lib/lang"),i=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(!t){for(var n in e)this.$rules[n]=e[n];return}for(var n in e){var r=e[n];for(var i=0;i<r.length;i++){var s=r[i];if(s.next||s.onMatch)typeof s.next=="string"&&s.next.indexOf(t)!==0&&(s.next=t+s.next),s.nextState&&s.nextState.indexOf(t)!==0&&(s.nextState=t+s.nextState)}this.$rules[t+n]=r}},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,n,i,s){var o=typeof e=="function"?(new e).getRules():e;if(i)for(var u=0;u<i.length;u++)i[u]=t+i[u];else{i=[];for(var a in o)i.push(t+a)}this.addRules(o,t);if(n){var f=Array.prototype[s?"push":"unshift"];for(var u=0;u<i.length;u++)f.apply(this.$rules[i[u]],r.deepCopy(n))}this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return(e!="start"||t.length)&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){function i(s){var o=r[s];o.processed=!0;for(var u=0;u<o.length;u++){var a=o[u],f=null;Array.isArray(a)&&(f=a,a={}),!a.regex&&a.start&&(a.regex=a.start,a.next||(a.next=[]),a.next.push({defaultToken:a.token},{token:a.token+".end",regex:a.end||a.start,next:"pop"}),a.token=a.token+".start",a.push=!0);var l=a.next||a.push;if(l&&Array.isArray(l)){var c=a.stateName;c||(c=a.token,typeof c!="string"&&(c=c[0]||""),r[c]&&(c+=n++)),r[c]=l,a.next=c,i(c)}else l=="pop"&&(a.next=t);a.push&&(a.nextState=a.next||a.push,a.next=e,delete a.push);if(a.rules)for(var h in a.rules)r[h]?r[h].push&&r[h].push.apply(r[h],a.rules[h]):r[h]=a.rules[h];var p=typeof a=="string"?a:a.include;p&&(Array.isArray(p)?f=p.map(function(e){return r[e]}):f=r[p]);if(f){var d=[u,1].concat(f);a.noEscape&&(d=d.filter(function(e){return!e.next})),o.splice.apply(o,d),u--}a.keywordMap&&(a.token=this.createKeywordMapper(a.keywordMap,a.defaultToken||"text",a.caseInsensitive),delete a.defaultToken)}}var n=0,r=this.$rules;Object.keys(r).forEach(i,this)},this.createKeywordMapper=function(e,t,n,r){var i=Object.create(null);return Object.keys(e).forEach(function(t){var s=e[t];n&&(s=s.toLowerCase());var o=s.split(r||"|");for(var u=o.length;u--;)i[o[u]]=t}),Object.getPrototypeOf(i)&&(i.__proto__=null),this.$keywordList=Object.keys(i),e=null,n?function(e){return i[e.toLowerCase()]||t}:function(e){return i[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(i.prototype),t.TextHighlightRules=i}),ace.define("ace/mode/behaviour",["require","exports","module"],function(e,t,n){"use strict";var r=function(){this.$behaviours={}};(function(){this.add=function(e,t,n){switch(undefined){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=n},this.addBehaviours=function(e){for(var t in e)for(var n in e[t])this.add(t,n,e[t][n])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if(typeof e=="function")var n=(new e).getBehaviours(t);else var n=e.getBehaviours(t);this.addBehaviours(n)},this.getBehaviours=function(e){if(!e)return this.$behaviours;var t={};for(var n=0;n<e.length;n++)this.$behaviours[e[n]]&&(t[e[n]]=this.$behaviours[e[n]]);return t}}).call(r.prototype),t.Behaviour=r}),ace.define("ace/token_iterator",["require","exports","module","ace/range"],function(e,t,n){"use strict";var r=e("./range").Range,i=function(e,t,n){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var r=e.getTokenAt(t,n);this.$tokenIndex=r?r.index:-1};(function(){this.stepBackward=function(){this.$tokenIndex-=1;while(this.$tokenIndex<0){this.$row-=1;if(this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){this.$tokenIndex+=1;var e;while(this.$tokenIndex>=this.$rowTokens.length){this.$row+=1,e||(e=this.$session.getLength());if(this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,n=e[t].start;if(n!==undefined)return n;n=0;while(t>0)t-=1,n+=e[t].value.length;return n},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var e=this.$rowTokens[this.$tokenIndex],t=this.getCurrentTokenColumn();return new r(this.$row,t,this.$row,t+e.value.length)}}).call(i.prototype),t.TokenIterator=i}),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(e,t,n){"use strict";var r=e("../../lib/oop"),i=e("../behaviour").Behaviour,s=e("../../token_iterator").TokenIterator,o=e("../../lib/lang"),u=["text","paren.rparen","punctuation.operator"],a=["text","paren.rparen","punctuation.operator","comment"],f,l={},c={'"':'"',"'":"'"},h=function(e){var t=-1;e.multiSelect&&(t=e.selection.index,l.rangeCount!=e.multiSelect.rangeCount&&(l={rangeCount:e.multiSelect.rangeCount}));if(l[t])return f=l[t];f=l[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},p=function(e,t,n,r){var i=e.end.row-e.start.row;return{text:n+t+r,selection:[0,e.start.column+1,i,e.end.column+(i?0:1)]}},d=function(e){this.add("braces","insertion",function(t,n,r,i,s){var u=r.getCursorPosition(),a=i.doc.getLine(u.row);if(s=="{"){h(r);var l=r.getSelectionRange(),c=i.doc.getTextRange(l);if(c!==""&&c!=="{"&&r.getWrapBehavioursEnabled())return p(l,c,"{","}");if(d.isSaneInsertion(r,i))return/[\]\}\)]/.test(a[u.column])||r.inMultiSelectMode||e&&e.braces?(d.recordAutoInsert(r,i,"}"),{text:"{}",selection:[1,1]}):(d.recordMaybeInsert(r,i,"{"),{text:"{",selection:[1,1]})}else if(s=="}"){h(r);var v=a.substring(u.column,u.column+1);if(v=="}"){var m=i.$findOpeningBracket("}",{column:u.column+1,row:u.row});if(m!==null&&d.isAutoInsertedClosing(u,a,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if(s=="\n"||s=="\r\n"){h(r);var g="";d.isMaybeInsertedClosing(u,a)&&(g=o.stringRepeat("}",f.maybeInsertedBrackets),d.clearMaybeInsertedClosing());var v=a.substring(u.column,u.column+1);if(v==="}"){var y=i.findMatchingBracket({row:u.row,column:u.column+1},"}");if(!y)return null;var b=this.$getIndent(i.getLine(y.row))}else{if(!g){d.clearMaybeInsertedClosing();return}var b=this.$getIndent(a)}var w=b+i.getTabString();return{text:"\n"+w+"\n"+b+g,selection:[1,w.length,1,w.length]}}d.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(e,t,n,r,i){var s=r.doc.getTextRange(i);if(!i.isMultiLine()&&s=="{"){h(n);var o=r.doc.getLine(i.start.row),u=o.substring(i.end.column,i.end.column+1);if(u=="}")return i.end.column++,i;f.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,n,r,i){if(i=="("){h(n);var s=n.getSelectionRange(),o=r.doc.getTextRange(s);if(o!==""&&n.getWrapBehavioursEnabled())return p(s,o,"(",")");if(d.isSaneInsertion(n,r))return d.recordAutoInsert(n,r,")"),{text:"()",selection:[1,1]}}else if(i==")"){h(n);var u=n.getCursorPosition(),a=r.doc.getLine(u.row),f=a.substring(u.column,u.column+1);if(f==")"){var l=r.$findOpeningBracket(")",{column:u.column+1,row:u.row});if(l!==null&&d.isAutoInsertedClosing(u,a,i))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,n,r,i){var s=r.doc.getTextRange(i);if(!i.isMultiLine()&&s=="("){h(n);var o=r.doc.getLine(i.start.row),u=o.substring(i.start.column+1,i.start.column+2);if(u==")")return i.end.column++,i}}),this.add("brackets","insertion",function(e,t,n,r,i){if(i=="["){h(n);var s=n.getSelectionRange(),o=r.doc.getTextRange(s);if(o!==""&&n.getWrapBehavioursEnabled())return p(s,o,"[","]");if(d.isSaneInsertion(n,r))return d.recordAutoInsert(n,r,"]"),{text:"[]",selection:[1,1]}}else if(i=="]"){h(n);var u=n.getCursorPosition(),a=r.doc.getLine(u.row),f=a.substring(u.column,u.column+1);if(f=="]"){var l=r.$findOpeningBracket("]",{column:u.column+1,row:u.row});if(l!==null&&d.isAutoInsertedClosing(u,a,i))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,n,r,i){var s=r.doc.getTextRange(i);if(!i.isMultiLine()&&s=="["){h(n);var o=r.doc.getLine(i.start.row),u=o.substring(i.start.column+1,i.start.column+2);if(u=="]")return i.end.column++,i}}),this.add("string_dquotes","insertion",function(e,t,n,r,i){var s=r.$mode.$quotes||c;if(i.length==1&&s[i]){if(this.lineCommentStart&&this.lineCommentStart.indexOf(i)!=-1)return;h(n);var o=i,u=n.getSelectionRange(),a=r.doc.getTextRange(u);if(a!==""&&(a.length!=1||!s[a])&&n.getWrapBehavioursEnabled())return p(u,a,o,o);if(!a){var f=n.getCursorPosition(),l=r.doc.getLine(f.row),d=l.substring(f.column-1,f.column),v=l.substring(f.column,f.column+1),m=r.getTokenAt(f.row,f.column),g=r.getTokenAt(f.row,f.column+1);if(d=="\\"&&m&&/escape/.test(m.type))return null;var y=m&&/string|escape/.test(m.type),b=!g||/string|escape/.test(g.type),w;if(v==o)w=y!==b,w&&/string\.end/.test(g.type)&&(w=!1);else{if(y&&!b)return null;if(y&&b)return null;var E=r.$mode.tokenRe;E.lastIndex=0;var S=E.test(d);E.lastIndex=0;var x=E.test(d);if(S||x)return null;if(v&&!/[\s;,.})\]\\]/.test(v))return null;w=!0}return{text:w?o+o:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,n,r,i){var s=r.doc.getTextRange(i);if(!i.isMultiLine()&&(s=='"'||s=="'")){h(n);var o=r.doc.getLine(i.start.row),u=o.substring(i.start.column+1,i.start.column+2);if(u==s)return i.end.column++,i}})};d.isSaneInsertion=function(e,t){var n=e.getCursorPosition(),r=new s(t,n.row,n.column);if(!this.$matchTokenType(r.getCurrentToken()||"text",u)){var i=new s(t,n.row,n.column+1);if(!this.$matchTokenType(i.getCurrentToken()||"text",u))return!1}return r.stepForward(),r.getCurrentTokenRow()!==n.row||this.$matchTokenType(r.getCurrentToken()||"text",a)},d.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},d.recordAutoInsert=function(e,t,n){var r=e.getCursorPosition(),i=t.doc.getLine(r.row);this.isAutoInsertedClosing(r,i,f.autoInsertedLineEnd[0])||(f.autoInsertedBrackets=0),f.autoInsertedRow=r.row,f.autoInsertedLineEnd=n+i.substr(r.column),f.autoInsertedBrackets++},d.recordMaybeInsert=function(e,t,n){var r=e.getCursorPosition(),i=t.doc.getLine(r.row);this.isMaybeInsertedClosing(r,i)||(f.maybeInsertedBrackets=0),f.maybeInsertedRow=r.row,f.maybeInsertedLineStart=i.substr(0,r.column)+n,f.maybeInsertedLineEnd=i.substr(r.column),f.maybeInsertedBrackets++},d.isAutoInsertedClosing=function(e,t,n){return f.autoInsertedBrackets>0&&e.row===f.autoInsertedRow&&n===f.autoInsertedLineEnd[0]&&t.substr(e.column)===f.autoInsertedLineEnd},d.isMaybeInsertedClosing=function(e,t){return f.maybeInsertedBrackets>0&&e.row===f.maybeInsertedRow&&t.substr(e.column)===f.maybeInsertedLineEnd&&t.substr(0,e.column)==f.maybeInsertedLineStart},d.popAutoInsertedClosing=function(){f.autoInsertedLineEnd=f.autoInsertedLineEnd.substr(1),f.autoInsertedBrackets--},d.clearMaybeInsertedClosing=function(){f&&(f.maybeInsertedBrackets=0,f.maybeInsertedRow=-1)},r.inherits(d,i),t.CstyleBehaviour=d}),ace.define("ace/unicode",["require","exports","module"],function(e,t,n){"use strict";var r=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],i=0,s=[];for(var o=0;o<r.length;o+=2)s.push(i+=r[o]),r[o+1]&&s.push(45,i+=r[o+1]);t.wordChars=String.fromCharCode.apply(null,s)}),ace.define("ace/mode/text",["require","exports","module","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],function(e,t,n){"use strict";var r=e("../tokenizer").Tokenizer,i=e("./text_highlight_rules").TextHighlightRules,s=e("./behaviour/cstyle").CstyleBehaviour,o=e("../unicode"),u=e("../lib/lang"),a=e("../token_iterator").TokenIterator,f=e("../range").Range,l=function(){this.HighlightRules=i};(function(){this.$defaultBehaviour=new s,this.tokenRe=new RegExp("^["+o.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+o.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new r(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,n,r){function w(e){for(var t=n;t<=r;t++)e(i.getLine(t),t)}var i=t.doc,s=!0,o=!0,a=Infinity,f=t.getTabSize(),l=!1;if(!this.lineCommentStart){if(!this.blockComment)return!1;var c=this.blockComment.start,h=this.blockComment.end,p=new RegExp("^(\\s*)(?:"+u.escapeRegExp(c)+")"),d=new RegExp("(?:"+u.escapeRegExp(h)+")\\s*$"),v=function(e,t){if(g(e,t))return;if(!s||/\S/.test(e))i.insertInLine({row:t,column:e.length},h),i.insertInLine({row:t,column:a},c)},m=function(e,t){var n;(n=e.match(d))&&i.removeInLine(t,e.length-n[0].length,e.length),(n=e.match(p))&&i.removeInLine(t,n[1].length,n[0].length)},g=function(e,n){if(p.test(e))return!0;var r=t.getTokens(n);for(var i=0;i<r.length;i++)if(r[i].type==="comment")return!0}}else{if(Array.isArray(this.lineCommentStart))var p=this.lineCommentStart.map(u.escapeRegExp).join("|"),c=this.lineCommentStart[0];else var p=u.escapeRegExp(this.lineCommentStart),c=this.lineCommentStart;p=new RegExp("^(\\s*)(?:"+p+") ?"),l=t.getUseSoftTabs();var m=function(e,t){var n=e.match(p);if(!n)return;var r=n[1].length,s=n[0].length;!b(e,r,s)&&n[0][s-1]==" "&&s--,i.removeInLine(t,r,s)},y=c+" ",v=function(e,t){if(!s||/\S/.test(e))b(e,a,a)?i.insertInLine({row:t,column:a},y):i.insertInLine({row:t,column:a},c)},g=function(e,t){return p.test(e)},b=function(e,t,n){var r=0;while(t--&&e.charAt(t)==" ")r++;if(r%f!=0)return!1;var r=0;while(e.charAt(n++)==" ")r++;return f>2?r%f!=f-1:r%f==0}}var E=Infinity;w(function(e,t){var n=e.search(/\S/);n!==-1?(n<a&&(a=n),o&&!g(e,t)&&(o=!1)):E>e.length&&(E=e.length)}),a==Infinity&&(a=E,s=!1,o=!1),l&&a%f!=0&&(a=Math.floor(a/f)*f),w(o?m:v)},this.toggleBlockComment=function(e,t,n,r){var i=this.blockComment;if(!i)return;!i.start&&i[0]&&(i=i[0]);var s=new a(t,r.row,r.column),o=s.getCurrentToken(),u=t.selection,l=t.selection.toOrientedRange(),c,h;if(o&&/comment/.test(o.type)){var p,d;while(o&&/comment/.test(o.type)){var v=o.value.indexOf(i.start);if(v!=-1){var m=s.getCurrentTokenRow(),g=s.getCurrentTokenColumn()+v;p=new f(m,g,m,g+i.start.length);break}o=s.stepBackward()}var s=new a(t,r.row,r.column),o=s.getCurrentToken();while(o&&/comment/.test(o.type)){var v=o.value.indexOf(i.end);if(v!=-1){var m=s.getCurrentTokenRow(),g=s.getCurrentTokenColumn()+v;d=new f(m,g,m,g+i.end.length);break}o=s.stepForward()}d&&t.remove(d),p&&(t.remove(p),c=p.start.row,h=-i.start.length)}else h=i.start.length,c=n.start.row,t.insert(n.end,i.end),t.insert(n.start,i.start);l.start.row==c&&(l.start.column+=h),l.end.row==c&&(l.end.column+=h),t.selection.fromOrientedRange(l)},this.getNextLineIndent=function(e,t,n){return this.$getIndent(t)},this.checkOutdent=function(e,t,n){return!1},this.autoOutdent=function(e,t,n){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){this.$embeds=[],this.$modes={};for(var t in e)e[t]&&(this.$embeds.push(t),this.$modes[t]=new e[t]);var n=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(var t=0;t<n.length;t++)(function(e){var r=n[t],i=e[r];e[n[t]]=function(){return this.$delegator(r,arguments,i)}})(this)},this.$delegator=function(e,t,n){var r=t[0];typeof r!="string"&&(r=r[0]);for(var i=0;i<this.$embeds.length;i++){if(!this.$modes[this.$embeds[i]])continue;var s=r.split(this.$embeds[i]);if(!s[0]&&s[1]){t[0]=s[1];var o=this.$modes[this.$embeds[i]];return o[e].apply(o,t)}}var u=n.apply(this,t);return n?u:undefined},this.transformAction=function(e,t,n,r,i){if(this.$behaviour){var s=this.$behaviour.getBehaviours();for(var o in s)if(s[o][t]){var u=s[o][t].apply(this,arguments);if(u)return u}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,n=[];for(var r in t){var i=t[r];for(var s=0,o=i.length;s<o;s++)if(typeof i[s].token=="string")/keyword|support|storage/.test(i[s].token)&&n.push(i[s].regex);else if(typeof i[s].token=="object")for(var u=0,a=i[s].token.length;u<a;u++)if(/keyword|support|storage/.test(i[s].token[u])){var r=i[s].regex.match(/\(.+?\)/g)[u];n.push(r.substr(1,r.length-2))}}this.completionKeywords=n}return e?n.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,n,r){var i=this.$keywordList||this.$createKeywordList();return i.map(function(e){return{name:e,value:e,score:0,meta:"keyword"}})},this.$id="ace/mode/text"}).call(l.prototype),t.Mode=l}),ace.define("ace/apply_delta",["require","exports","module"],function(e,t,n){"use strict";function r(e,t){throw console.log("Invalid Delta:",e),"Invalid Delta: "+t}function i(e,t){return t.row>=0&&t.row<e.length&&t.column>=0&&t.column<=e[t.row].length}function s(e,t){t.action!="insert"&&t.action!="remove"&&r(t,"delta.action must be 'insert' or 'remove'"),t.lines instanceof Array||r(t,"delta.lines must be an Array"),(!t.start||!t.end)&&r(t,"delta.start/end must be an present");var n=t.start;i(e,t.start)||r(t,"delta.start must be contained in document");var s=t.end;t.action=="remove"&&!i(e,s)&&r(t,"delta.end must contained in document for 'remove' actions");var o=s.row-n.row,u=s.column-(o==0?n.column:0);(o!=t.lines.length-1||t.lines[o].length!=u)&&r(t,"delta.range must match delta lines")}t.applyDelta=function(e,t,n){var r=t.start.row,i=t.start.column,s=e[r]||"";switch(t.action){case"insert":var o=t.lines;if(o.length===1)e[r]=s.substring(0,i)+t.lines[0]+s.substring(i);else{var u=[r,1].concat(t.lines);e.splice.apply(e,u),e[r]=s.substring(0,i)+e[r],e[r+t.lines.length-1]+=s.substring(i)}break;case"remove":var a=t.end.column,f=t.end.row;r===f?e[r]=s.substring(0,i)+s.substring(a):e.splice(r,f-r+1,s.substring(0,i)+e[f].substring(a))}}}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/event_emitter").EventEmitter,s=t.Anchor=function(e,t,n){this.$onChange=this.onChange.bind(this),this.attach(e),typeof n=="undefined"?this.setPosition(t.row,t.column):this.setPosition(t,n)};(function(){function e(e,t,n){var r=n?e.column<=t.column:e.column<t.column;return e.row<t.row||e.row==t.row&&r}function t(t,n,r){var i=t.action=="insert",s=(i?1:-1)*(t.end.row-t.start.row),o=(i?1:-1)*(t.end.column-t.start.column),u=t.start,a=i?u:t.end;return e(n,u,r)?{row:n.row,column:n.column}:e(a,n,!r)?{row:n.row+s,column:n.column+(n.row==a.row?o:0)}:{row:u.row,column:u.column}}r.implement(this,i),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){if(e.start.row==e.end.row&&e.start.row!=this.row)return;if(e.start.row>this.row)return;var n=t(e,{row:this.row,column:this.column},this.$insertRight);this.setPosition(n.row,n.column,!0)},this.setPosition=function(e,t,n){var r;n?r={row:e,column:t}:r=this.$clipPositionToDocument(e,t);if(this.row==r.row&&this.column==r.column)return;var i={row:this.row,column:this.column};this.row=r.row,this.column=r.column,this._signal("change",{old:i,value:r})},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var n={};return e>=this.document.getLength()?(n.row=Math.max(0,this.document.getLength()-1),n.column=this.document.getLine(n.row).length):e<0?(n.row=0,n.column=0):(n.row=e,n.column=Math.min(this.document.getLine(n.row).length,Math.max(0,t))),t<0&&(n.column=0),n}}).call(s.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./apply_delta").applyDelta,s=e("./lib/event_emitter").EventEmitter,o=e("./range").Range,u=e("./anchor").Anchor,a=function(e){this.$lines=[""],e.length===0?this.$lines=[""]:Array.isArray(e)?this.insertMergedLines({row:0,column:0},e):this.insert({row:0,column:0},e)};(function(){r.implement(this,s),this.setValue=function(e){var t=this.getLength()-1;this.remove(new o(0,0,t,this.getLine(t).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new u(this,e,t)},"aaa".split(/a/).length===0?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){if(this.$newLineMode===e)return;this.$newLineMode=e,this._signal("changeNewLineMode")},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return e=="\r\n"||e=="\r"||e=="\n"},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){return this.getLinesForRange(e).join(this.getNewLineCharacter())},this.getLinesForRange=function(e){var t;if(e.start.row===e.end.row)t=[this.getLine(e.start.row).substring(e.start.column,e.end.column)];else{t=this.getLines(e.start.row,e.end.row),t[0]=(t[0]||"").substring(e.start.column);var n=t.length-1;e.end.row-e.start.row==n&&(t[n]=t[n].substring(0,e.end.column))}return t},this.insertLines=function(e,t){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(e,t)},this.removeLines=function(e,t){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(e,t)},this.insertNewLine=function(e){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(e,["",""])},this.insert=function(e,t){return this.getLength()<=1&&this.$detectNewLine(t),this.insertMergedLines(e,this.$split(t))},this.insertInLine=function(e,t){var n=this.clippedPos(e.row,e.column),r=this.pos(e.row,e.column+t.length);return this.applyDelta({start:n,end:r,action:"insert",lines:[t]},!0),this.clonePos(r)},this.clippedPos=function(e,t){var n=this.getLength();e===undefined?e=n:e<0?e=0:e>=n&&(e=n-1,t=undefined);var r=this.getLine(e);return t==undefined&&(t=r.length),t=Math.min(Math.max(t,0),r.length),{row:e,column:t}},this.clonePos=function(e){return{row:e.row,column:e.column}},this.pos=function(e,t){return{row:e,column:t}},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):(e.row=Math.max(0,e.row),e.column=Math.min(Math.max(e.column,0),this.getLine(e.row).length)),e},this.insertFullLines=function(e,t){e=Math.min(Math.max(e,0),this.getLength());var n=0;e<this.getLength()?(t=t.concat([""]),n=0):(t=[""].concat(t),e--,n=this.$lines[e].length),this.insertMergedLines({row:e,column:n},t)},this.insertMergedLines=function(e,t){var n=this.clippedPos(e.row,e.column),r={row:n.row+t.length-1,column:(t.length==1?n.column:0)+t[t.length-1].length};return this.applyDelta({start:n,end:r,action:"insert",lines:t}),this.clonePos(r)},this.remove=function(e){var t=this.clippedPos(e.start.row,e.start.column),n=this.clippedPos(e.end.row,e.end.column);return this.applyDelta({start:t,end:n,action:"remove",lines:this.getLinesForRange({start:t,end:n})}),this.clonePos(t)},this.removeInLine=function(e,t,n){var r=this.clippedPos(e,t),i=this.clippedPos(e,n);return this.applyDelta({start:r,end:i,action:"remove",lines:this.getLinesForRange({start:r,end:i})},!0),this.clonePos(r)},this.removeFullLines=function(e,t){e=Math.min(Math.max(0,e),this.getLength()-1),t=Math.min(Math.max(0,t),this.getLength()-1);var n=t==this.getLength()-1&&e>0,r=t<this.getLength()-1,i=n?e-1:e,s=n?this.getLine(i).length:0,u=r?t+1:t,a=r?0:this.getLine(u).length,f=new o(i,s,u,a),l=this.$lines.slice(e,t+1);return this.applyDelta({start:f.start,end:f.end,action:"remove",lines:this.getLinesForRange(f)}),l},this.removeNewLine=function(e){e<this.getLength()-1&&e>=0&&this.applyDelta({start:this.pos(e,this.getLine(e).length),end:this.pos(e+1,0),action:"remove",lines:["",""]})},this.replace=function(e,t){e instanceof o||(e=o.fromPoints(e.start,e.end));if(t.length===0&&e.isEmpty())return e.start;if(t==this.getTextRange(e))return e.end;this.remove(e);var n;return t?n=this.insert(e.start,t):n=e.start,n},this.applyDeltas=function(e){for(var t=0;t<e.length;t++)this.applyDelta(e[t])},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--)this.revertDelta(e[t])},this.applyDelta=function(e,t){var n=e.action=="insert";if(n?e.lines.length<=1&&!e.lines[0]:!o.comparePoints(e.start,e.end))return;n&&e.lines.length>2e4?this.$splitAndapplyLargeDelta(e,2e4):(i(this.$lines,e,t),this._signal("change",e))},this.$splitAndapplyLargeDelta=function(e,t){var n=e.lines,r=n.length-t+1,i=e.start.row,s=e.start.column;for(var o=0,u=0;o<r;o=u){u+=t-1;var a=n.slice(o,u);a.push(""),this.applyDelta({start:this.pos(i+o,s),end:this.pos(i+u,s=0),action:e.action,lines:a},!0)}e.lines=n.slice(o),e.start.row=i+o,e.start.column=s,this.applyDelta(e,!0)},this.revertDelta=function(e){this.applyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:e.action=="insert"?"remove":"insert",lines:e.lines.slice()})},this.indexToPosition=function(e,t){var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length;for(var i=t||0,s=n.length;i<s;i++){e-=n[i].length+r;if(e<0)return{row:i,column:e+n[i].length+r}}return{row:s-1,column:e+n[s-1].length+r}},this.positionToIndex=function(e,t){var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length,i=0,s=Math.min(e.row,n.length);for(var o=t||0;o<s;++o)i+=n[o].length+r;return i+e.column}}).call(a.prototype),t.Document=a}),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/event_emitter").EventEmitter,s=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var n=this;this.$worker=function(){if(!n.running)return;var e=new Date,t=n.currentLine,r=-1,i=n.doc,s=t;while(n.lines[t])t++;var o=i.getLength(),u=0;n.running=!1;while(t<o){n.$tokenizeRow(t),r=t;do t++;while(n.lines[t]);u++;if(u%5===0&&new Date-e>20){n.running=setTimeout(n.$worker,20);break}}n.currentLine=t,r==-1&&(r=t),s<=r&&n.fireUpdateEvent(s,r)}};(function(){r.implement(this,i),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var n={first:e,last:t};this._signal("update",{data:n})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.start.row,n=e.end.row-t;if(n===0)this.lines[t]=null;else if(e.action=="remove")this.lines.splice(t,n+1,null),this.states.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.lines.splice.apply(this.lines,r),this.states.splice.apply(this.states,r)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),n=this.states[e-1],r=this.tokenizer.getLineTokens(t,n,e);return this.states[e]+""!=r.state+""?(this.states[e]=r.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=r.tokens}}).call(s.prototype),t.BackgroundTokenizer=s}),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(e,t,n){"use strict";var r=e("./lib/lang"),i=e("./lib/oop"),s=e("./range").Range,o=function(e,t,n){this.setRegexp(e),this.clazz=t,this.type=n||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){if(this.regExp+""==e+"")return;this.regExp=e,this.cache=[]},this.update=function(e,t,n,i){if(!this.regExp)return;var o=i.firstRow,u=i.lastRow;for(var a=o;a<=u;a++){var f=this.cache[a];f==null&&(f=r.getMatchOffsets(n.getLine(a),this.regExp),f.length>this.MAX_RANGES&&(f=f.slice(0,this.MAX_RANGES)),f=f.map(function(e){return new s(a,e.offset,a,e.offset+e.length)}),this.cache[a]=f.length?f:"");for(var l=f.length;l--;)t.drawSingleLineMarker(e,f[l].toScreenRange(n),this.clazz,i)}}}).call(o.prototype),t.SearchHighlight=o}),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],function(e,t,n){"use strict";function i(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var n=t[t.length-1];this.range=new r(t[0].start.row,t[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach(function(e){e.setFoldLine(this)},this)}var r=e("../range").Range;(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach(function(t){t.start.row+=e,t.end.row+=e})},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort(function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)}),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,n){var r=0,i=this.folds,s,o,u,a=!0;t==null&&(t=this.end.row,n=this.end.column);for(var f=0;f<i.length;f++){s=i[f],o=s.range.compareStart(t,n);if(o==-1){e(null,t,n,r,a);return}u=e(null,s.start.row,s.start.column,r,a),u=!u&&e(s.placeholder,s.start.row,s.start.column,r);if(u||o===0)return;a=!s.sameRow,r=s.end.column}e(null,t,n,r,a)},this.getNextFoldTo=function(e,t){var n,r;for(var i=0;i<this.folds.length;i++){n=this.folds[i],r=n.range.compareEnd(e,t);if(r==-1)return{fold:n,kind:"after"};if(r===0)return{fold:n,kind:"inside"}}return null},this.addRemoveChars=function(e,t,n){var r=this.getNextFoldTo(e,t),i,s;if(r){i=r.fold;if(r.kind=="inside"&&i.start.column!=t&&i.start.row!=e)window.console&&window.console.log(e,t,i);else if(i.start.row==e){s=this.folds;var o=s.indexOf(i);o===0&&(this.start.column+=n);for(o;o<s.length;o++){i=s[o],i.start.column+=n;if(!i.sameRow)return;i.end.column+=n}this.end.column+=n}}},this.split=function(e,t){var n=this.getNextFoldTo(e,t);if(!n||n.kind=="inside")return null;var r=n.fold,s=this.folds,o=this.foldData,u=s.indexOf(r),a=s[u-1];this.end.row=a.end.row,this.end.column=a.end.column,s=s.splice(u,s.length-u);var f=new i(o,s);return o.splice(o.indexOf(this)+1,0,f),f},this.merge=function(e){var t=e.folds;for(var n=0;n<t.length;n++)this.addFold(t[n]);var r=this.foldData;r.splice(r.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach(function(t){e.push("  "+t.toString())}),e.push("]"),e.join("\n")},this.idxToPosition=function(e){var t=0;for(var n=0;n<this.folds.length;n++){var r=this.folds[n];e-=r.start.column-t;if(e<0)return{row:r.start.row,column:r.start.column+e};e-=r.placeholder.length;if(e<0)return r.start;t=r.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(i.prototype),t.FoldLine=i}),ace.define("ace/range_list",["require","exports","module","ace/range"],function(e,t,n){"use strict";var r=e("./range").Range,i=r.comparePoints,s=function(){this.ranges=[]};(function(){this.comparePoints=i,this.pointIndex=function(e,t,n){var r=this.ranges;for(var s=n||0;s<r.length;s++){var o=r[s],u=i(e,o.end);if(u>0)continue;var a=i(e,o.start);return u===0?t&&a!==0?-s-2:s:a>0||a===0&&!t?s:-s-1}return-s-1},this.add=function(e){var t=!e.isEmpty(),n=this.pointIndex(e.start,t);n<0&&(n=-n-1);var r=this.pointIndex(e.end,t,n);return r<0?r=-r-1:r++,this.ranges.splice(n,r-n,e)},this.addList=function(e){var t=[];for(var n=e.length;n--;)t.push.apply(t,this.add(e[n]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges.splice(t,1)},this.merge=function(){var e=[],t=this.ranges;t=t.sort(function(e,t){return i(e.start,t.start)});var n=t[0],r;for(var s=1;s<t.length;s++){r=n,n=t[s];var o=i(r.end,n.start);if(o<0)continue;if(o==0&&!r.isEmpty()&&!n.isEmpty())continue;i(r.end,n.end)<0&&(r.end.row=n.end.row,r.end.column=n.end.column),t.splice(s,1),e.push(n),n=r,s--}return this.ranges=t,e},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges[t]},this.clipRows=function(e,t){var n=this.ranges;if(n[0].start.row>t||n[n.length-1].start.row<e)return[];var r=this.pointIndex({row:e,column:0});r<0&&(r=-r-1);var i=this.pointIndex({row:t,column:0},r);i<0&&(i=-i-1);var s=[];for(var o=r;o<i;o++)s.push(n[o]);return s},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){if(!this.session)return;this.session.removeListener("change",this.onChange),this.session=null},this.$onChange=function(e){var t=e.start,n=e.end,r=t.row,i=n.row,s=this.ranges;for(var o=0,u=s.length;o<u;o++){var a=s[o];if(a.end.row>=r)break}if(e.action=="insert"){var f=i-r,l=-t.column+n.column;for(;o<u;o++){var a=s[o];if(a.start.row>r)break;a.start.row==r&&a.start.column>=t.column&&(a.start.column!=t.column||!this.$insertRight)&&(a.start.column+=l,a.start.row+=f);if(a.end.row==r&&a.end.column>=t.column){if(a.end.column==t.column&&this.$insertRight)continue;a.end.column==t.column&&l>0&&o<u-1&&a.end.column>a.start.column&&a.end.column==s[o+1].start.column&&(a.end.column-=l),a.end.column+=l,a.end.row+=f}}}else{var f=r-i,l=t.column-n.column;for(;o<u;o++){var a=s[o];if(a.start.row>i)break;a.end.row<i&&(a.end.row=r,a.end.column=t.column);if(a.start.row<i||a.start.row==i&&a.start.column<=n.colum)a.start.row=r,a.start.column=t.column;if(a.end.row==i)if(a.end.column<=n.column){if(f||a.end.column>t.column)a.end.column=t.column,a.end.row=t.row}else a.end.column+=l,a.end.row+=f;if(a.start.row==i)if(a.start.column<=n.column){if(f||a.start.column>t.column)a.start.column=t.column,a.start.row=t.row}else a.start.column+=l,a.start.row+=f}}if(f!=0&&o<u)for(;o<u;o++){var a=s[o];a.start.row+=f,a.end.row+=f}}}).call(s.prototype),t.RangeList=s}),ace.define("ace/edit_session/fold",["require","exports","module","ace/range","ace/range_list","ace/lib/oop"],function(e,t,n){"use strict";function u(e,t){e.row-=t.row,e.row==0&&(e.column-=t.column)}function a(e,t){u(e.start,t),u(e.end,t)}function f(e,t){e.row==0&&(e.column+=t.column),e.row+=t.row}function l(e,t){f(e.start,t),f(e.end,t)}var r=e("../range").Range,i=e("../range_list").RangeList,s=e("../lib/oop"),o=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};s.inherits(o,i),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach(function(t){t.setFoldLine(e)})},this.clone=function(){var e=this.range.clone(),t=new o(e,this.placeholder);return this.subFolds.forEach(function(e){t.subFolds.push(e.clone())}),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(this.range.isEqual(e))return;if(!this.range.containsRange(e))throw new Error("A fold can't intersect already existing fold"+e.range+this.range);a(e,this.start);var t=e.start.row,n=e.start.column;for(var r=0,i=-1;r<this.subFolds.length;r++){i=this.subFolds[r].range.compare(t,n);if(i!=1)break}var s=this.subFolds[r];if(i==0)return s.addSubFold(e);var t=e.range.end.row,n=e.range.end.column;for(var o=r,i=-1;o<this.subFolds.length;o++){i=this.subFolds[o].range.compare(t,n);if(i!=1)break}var u=this.subFolds[o];if(i==0)throw new Error("A fold can't intersect already existing fold"+e.range+this.range);var f=this.subFolds.splice(r,o-r,e);return e.setFoldLine(this.foldLine),e},this.restoreRange=function(e){return l(e,this.start)}}.call(o.prototype)}),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],function(e,t,n){"use strict";function u(){this.getFoldAt=function(e,t,n){var r=this.getFoldLine(e);if(!r)return null;var i=r.folds;for(var s=0;s<i.length;s++){var o=i[s];if(o.range.contains(e,t)){if(n==1&&o.range.isEnd(e,t))continue;if(n==-1&&o.range.isStart(e,t))continue;return o}}},this.getFoldsInRange=function(e){var t=e.start,n=e.end,r=this.$foldData,i=[];t.column+=1,n.column-=1;for(var s=0;s<r.length;s++){var o=r[s].range.compareRange(e);if(o==2)continue;if(o==-2)break;var u=r[s].folds;for(var a=0;a<u.length;a++){var f=u[a];o=f.range.compareRange(e);if(o==-2)break;if(o==2)continue;if(o==42)break;i.push(f)}}return t.column-=1,n.column+=1,i},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){t=t.concat(this.getFoldsInRange(e))},this)}else var t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){var e=[],t=this.$foldData;for(var n=0;n<t.length;n++)for(var r=0;r<t[n].folds.length;r++)e.push(t[n].folds[r]);return e},this.getFoldStringAt=function(e,t,n,r){r=r||this.getFoldLine(e);if(!r)return null;var i={end:{column:0}},s,o;for(var u=0;u<r.folds.length;u++){o=r.folds[u];var a=o.range.compareEnd(e,t);if(a==-1){s=this.getLine(o.start.row).substring(i.end.column,o.start.column);break}if(a===0)return null;i=o}return s||(s=this.getLine(o.start.row).substring(i.end.column)),n==-1?s.substring(0,t-i.end.column):n==1?s.substring(t-i.end.column):s},this.getFoldLine=function(e,t){var n=this.$foldData,r=0;t&&(r=n.indexOf(t)),r==-1&&(r=0);for(r;r<n.length;r++){var i=n[r];if(i.start.row<=e&&i.end.row>=e)return i;if(i.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var n=this.$foldData,r=0;t&&(r=n.indexOf(t)),r==-1&&(r=0);for(r;r<n.length;r++){var i=n[r];if(i.end.row>=e)return i}return null},this.getFoldedRowCount=function(e,t){var n=this.$foldData,r=t-e+1;for(var i=0;i<n.length;i++){var s=n[i],o=s.end.row,u=s.start.row;if(o>=t){u<t&&(u>=e?r-=t-u:r=0);break}o>=e&&(u>=e?r-=o-u:r-=o-e+1)}return r},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort(function(e,t){return e.start.row-t.start.row}),e},this.addFold=function(e,t){var n=this.$foldData,r=!1,o;e instanceof s?o=e:(o=new s(t,e),o.collapseChildren=t.collapseChildren),this.$clipRangeToDocument(o.range);var u=o.start.row,a=o.start.column,f=o.end.row,l=o.end.column;if(u<f||u==f&&a<=l-2){var c=this.getFoldAt(u,a,1),h=this.getFoldAt(f,l,-1);if(c&&h==c)return c.addSubFold(o);c&&!c.range.isStart(u,a)&&this.removeFold(c),h&&!h.range.isEnd(f,l)&&this.removeFold(h);var p=this.getFoldsInRange(o.range);p.length>0&&(this.removeFolds(p),p.forEach(function(e){o.addSubFold(e)}));for(var d=0;d<n.length;d++){var v=n[d];if(f==v.start.row){v.addFold(o),r=!0;break}if(u==v.end.row){v.addFold(o),r=!0;if(!o.sameRow){var m=n[d+1];if(m&&m.start.row==f){v.merge(m);break}}break}if(f<=v.start.row)break}return r||(v=this.$addFoldLine(new i(this.$foldData,o))),this.$useWrapMode?this.$updateWrapData(v.start.row,v.start.row):this.$updateRowLengthCache(v.start.row,v.start.row),this.$modified=!0,this._signal("changeFold",{data:o,action:"add"}),o}throw new Error("The range has to be at least 2 characters width")},this.addFolds=function(e){e.forEach(function(e){this.addFold(e)},this)},this.removeFold=function(e){var t=e.foldLine,n=t.start.row,r=t.end.row,i=this.$foldData,s=t.folds;if(s.length==1)i.splice(i.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))s.pop(),t.end.row=s[s.length-1].end.row,t.end.column=s[s.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))s.shift(),t.start.row=s[0].start.row,t.start.column=s[0].start.column;else if(e.sameRow)s.splice(s.indexOf(e),1);else{var o=t.split(e.start.row,e.start.column);s=o.folds,s.shift(),o.start.row=s[0].start.row,o.start.column=s[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(n,r):this.$updateRowLengthCache(n,r)),this.$modified=!0,this._signal("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){var t=[];for(var n=0;n<e.length;n++)t.push(e[n]);t.forEach(function(e){this.removeFold(e)},this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach(function(t){e.restoreRange(t),this.addFold(t)},this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach(function(e){this.expandFold(e)},this)},this.unfold=function(e,t){var n,i;e==null?(n=new r(0,0,this.getLength(),0),t=!0):typeof e=="number"?n=new r(e,0,e,this.getLine(e).length):"row"in e?n=r.fromPoints(e,e):n=e,i=this.getFoldsInRangeList(n);if(t)this.removeFolds(i);else{var s=i;while(s.length)this.expandFolds(s),s=this.getFoldsInRangeList(n)}if(i.length)return i},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var n=this.getFoldLine(e,t);return n?n.end.row:e},this.getRowFoldStart=function(e,t){var n=this.getFoldLine(e,t);return n?n.start.row:e},this.getFoldDisplayLine=function(e,t,n,r,i){r==null&&(r=e.start.row),i==null&&(i=0),t==null&&(t=e.end.row),n==null&&(n=this.getLine(t).length);var s=this.doc,o="";return e.walk(function(e,t,n,u){if(t<r)return;if(t==r){if(n<i)return;u=Math.max(i,u)}e!=null?o+=e:o+=s.getLine(t).substring(u,n)},t,n),o},this.getDisplayLine=function(e,t,n,r){var i=this.getFoldLine(e);if(!i){var s;return s=this.doc.getLine(e),s.substring(r||0,t||s.length)}return this.getFoldDisplayLine(i,e,t,n,r)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map(function(t){var n=t.folds.map(function(e){return e.clone()});return new i(e,n)}),e},this.toggleFold=function(e){var t=this.selection,n=t.getRange(),r,i;if(n.isEmpty()){var s=n.start;r=this.getFoldAt(s.row,s.column);if(r){this.expandFold(r);return}(i=this.findMatchingBracket(s))?n.comparePoint(i)==1?n.end=i:(n.start=i,n.start.column++,n.end.column--):(i=this.findMatchingBracket({row:s.row,column:s.column+1}))?(n.comparePoint(i)==1?n.end=i:n.start=i,n.start.column++):n=this.getCommentFoldRange(s.row,s.column)||n}else{var o=this.getFoldsInRange(n);if(e&&o.length){this.expandFolds(o);return}o.length==1&&(r=o[0])}r||(r=this.getFoldAt(n.start.row,n.start.column));if(r&&r.range.toString()==n.toString()){this.expandFold(r);return}var u="...";if(!n.isMultiLine()){u=this.getTextRange(n);if(u.length<4)return;u=u.trim().substring(0,2)+".."}this.addFold(u,n)},this.getCommentFoldRange=function(e,t,n){var i=new o(this,e,t),s=i.getCurrentToken(),u=s.type;if(s&&/^comment|string/.test(u)){u=u.match(/comment|string/)[0],u=="comment"&&(u+="|doc-start");var a=new RegExp(u),f=new r;if(n!=1){do s=i.stepBackward();while(s&&a.test(s.type));i.stepForward()}f.start.row=i.getCurrentTokenRow(),f.start.column=i.getCurrentTokenColumn()+2,i=new o(this,e,t);if(n!=-1){var l=-1;do{s=i.stepForward();if(l==-1){var c=this.getState(i.$row);a.test(c)||(l=i.$row)}else if(i.$row>l)break}while(s&&a.test(s.type));s=i.stepBackward()}else s=i.getCurrentToken();return f.end.row=i.getCurrentTokenRow(),f.end.column=i.getCurrentTokenColumn()+s.value.length-2,f}},this.foldAll=function(e,t,n){n==undefined&&(n=1e5);var r=this.foldWidgets;if(!r)return;t=t||this.getLength(),e=e||0;for(var i=e;i<t;i++){r[i]==null&&(r[i]=this.getFoldWidget(i));if(r[i]!="start")continue;var s=this.getFoldWidgetRange(i);if(s&&s.isMultiLine()&&s.end.row<=t&&s.start.row>=e){i=s.end.row;try{var o=this.addFold("...",s);o&&(o.collapseChildren=n)}catch(u){}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle==e)return;this.$foldStyle=e,e=="manual"&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)},this.$setFolding=function(e){if(this.$foldMode==e)return;this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation");if(!e||this.$foldStyle=="manual"){this.foldWidgets=null;return}this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)},this.getParentFoldRangeData=function(e,t){var n=this.foldWidgets;if(!n||t&&n[e])return{};var r=e-1,i;while(r>=0){var s=n[r];s==null&&(s=n[r]=this.getFoldWidget(r));if(s=="start"){var o=this.getFoldWidgetRange(r);i||(i=o);if(o&&o.end.row>=e)break}r--}return{range:r!==-1&&o,firstRange:i}},this.onFoldWidgetClick=function(e,t){t=t.domEvent;var n={children:t.shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey},r=this.$toggleFoldWidget(e,n);if(!r){var i=t.target||t.srcElement;i&&/ace_fold-widget/.test(i.className)&&(i.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(!this.getFoldWidget)return;var n=this.getFoldWidget(e),r=this.getLine(e),i=n==="end"?-1:1,s=this.getFoldAt(e,i===-1?0:r.length,i);if(s)return t.children||t.all?this.removeFold(s):this.expandFold(s),s;var o=this.getFoldWidgetRange(e,!0);if(o&&!o.isMultiLine()){s=this.getFoldAt(o.start.row,o.start.column,1);if(s&&o.isEqual(s.range))return this.removeFold(s),s}if(t.siblings){var u=this.getParentFoldRangeData(e);if(u.range)var a=u.range.start.row+1,f=u.range.end.row;this.foldAll(a,f,t.all?1e4:0)}else t.children?(f=o?o.end.row:this.getLength(),this.foldAll(e+1,f,t.all?1e4:0)):o&&(t.all&&(o.collapseChildren=1e4),this.addFold("...",o));return o},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var n=this.$toggleFoldWidget(t,{});if(n)return;var r=this.getParentFoldRangeData(t,!0);n=r.range||r.firstRange;if(n){t=n.start.row;var i=this.getFoldAt(t,this.getLine(t).length,1);i?this.removeFold(i):this.addFold("...",n)}},this.updateFoldWidgets=function(e){var t=e.start.row,n=e.end.row-t;if(n===0)this.foldWidgets[t]=null;else if(e.action=="remove")this.foldWidgets.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.foldWidgets.splice.apply(this.foldWidgets,r)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}var r=e("../range").Range,i=e("./fold_line").FoldLine,s=e("./fold").Fold,o=e("../token_iterator").TokenIterator;t.Folding=u}),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],function(e,t,n){"use strict";function s(){this.findMatchingBracket=function(e,t){if(e.column==0)return null;var n=t||this.getLine(e.row).charAt(e.column-1);if(n=="")return null;var r=n.match(/([\(\[\{])|([\)\]\}])/);return r?r[1]?this.$findClosingBracket(r[1],e):this.$findOpeningBracket(r[2],e):null},this.getBracketRange=function(e){var t=this.getLine(e.row),n=!0,r,s=t.charAt(e.column-1),o=s&&s.match(/([\(\[\{])|([\)\]\}])/);o||(s=t.charAt(e.column),e={row:e.row,column:e.column+1},o=s&&s.match(/([\(\[\{])|([\)\]\}])/),n=!1);if(!o)return null;if(o[1]){var u=this.$findClosingBracket(o[1],e);if(!u)return null;r=i.fromPoints(e,u),n||(r.end.column++,r.start.column--),r.cursor=r.end}else{var u=this.$findOpeningBracket(o[2],e);if(!u)return null;r=i.fromPoints(u,e),n||(r.start.column++,r.end.column--),r.cursor=r.start}return r},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"},this.$findOpeningBracket=function(e,t,n){var i=this.$brackets[e],s=1,o=new r(this,t.row,t.column),u=o.getCurrentToken();u||(u=o.stepForward());if(!u)return;n||(n=new RegExp("(\\.?"+u.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));var a=t.column-o.getCurrentTokenColumn()-2,f=u.value;for(;;){while(a>=0){var l=f.charAt(a);if(l==i){s-=1;if(s==0)return{row:o.getCurrentTokenRow(),column:a+o.getCurrentTokenColumn()}}else l==e&&(s+=1);a-=1}do u=o.stepBackward();while(u&&!n.test(u.type));if(u==null)break;f=u.value,a=f.length-1}return null},this.$findClosingBracket=function(e,t,n){var i=this.$brackets[e],s=1,o=new r(this,t.row,t.column),u=o.getCurrentToken();u||(u=o.stepForward());if(!u)return;n||(n=new RegExp("(\\.?"+u.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));var a=t.column-o.getCurrentTokenColumn();for(;;){var f=u.value,l=f.length;while(a<l){var c=f.charAt(a);if(c==i){s-=1;if(s==0)return{row:o.getCurrentTokenRow(),column:a+o.getCurrentTokenColumn()}}else c==e&&(s+=1);a+=1}do u=o.stepForward();while(u&&!n.test(u.type));if(u==null)break;a=0}return null}}var r=e("../token_iterator").TokenIterator,i=e("../range").Range;t.BracketMatch=s}),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/lang"),s=e("./bidihandler").BidiHandler,o=e("./config"),u=e("./lib/event_emitter").EventEmitter,a=e("./selection").Selection,f=e("./mode/text").Mode,l=e("./range").Range,c=e("./document").Document,h=e("./background_tokenizer").BackgroundTokenizer,p=e("./search_highlight").SearchHighlight,d=function(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++d.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this);if(typeof e!="object"||!e.getLine)e=new c(e);this.$bidiHandler=new s(this),this.setDocument(e),this.selection=new a(this),o.resetOptions(this),this.setMode(t),o._signal("session",this)};d.$uid=0,function(){function m(e){return e<4352?!1:e>=4352&&e<=4447||e>=4515&&e<=4519||e>=4602&&e<=4607||e>=9001&&e<=9002||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12283||e>=12288&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12589||e>=12593&&e<=12686||e>=12688&&e<=12730||e>=12736&&e<=12771||e>=12784&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=13054||e>=13056&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=55216&&e<=55238||e>=55243&&e<=55291||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510}r.implement(this,u),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e){this.$docRowCache=[],this.$screenRowCache=[];return}var t=this.$docRowCache.length,n=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>n&&(this.$docRowCache.splice(n,t),this.$screenRowCache.splice(n,t))},this.$getRowCacheIndex=function(e,t){var n=0,r=e.length-1;while(n<=r){var i=n+r>>1,s=e[i];if(t>s)n=i+1;else{if(!(t<s))return i;r=i-1}}return n-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){this.$modified=!0,this.$bidiHandler.onChange(e),this.$resetRowCache(e.start.row);var t=this.$updateInternalDataOnChange(e);!this.$fromUndo&&this.$undoManager&&(t&&t.length&&(this.$undoManager.add({action:"removeFolds",folds:t},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(e,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(e),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var n=this.bgTokenizer.getTokens(e),r,i=0;if(t==null){var s=n.length-1;i=this.getLine(e).length}else for(var s=0;s<n.length;s++){i+=n[s].value.length;if(i>=t)break}return r=n[s],r?(r.index=s,r.start=i-r.value.length,r):null},this.setUndoManager=function(e){this.$undoManager=e,this.$informUndoManager&&this.$informUndoManager.cancel();if(e){var t=this;e.addSession(this),this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.mergeUndoDeltas=!1},this.$informUndoManager=i.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?i.stringRepeat(" ",this.getTabSize()):"	"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize===0},this.setNavigateWithinSoftTabs=function(e){this.setOption("navigateWithinSoftTabs",e)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){t===undefined&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,n,r){var i=this.$markerId++,s={range:e,type:n||"line",renderer:typeof n=="function"?n:null,clazz:t,inFront:!!r,id:i};return r?(this.$frontMarkers[i]=s,this._signal("changeFrontMarker")):(this.$backMarkers[i]=s,this._signal("changeBackMarker")),i},this.addDynamicMarker=function(e,t){if(!e.update)return;var n=this.$markerId++;return e.id=n,e.inFront=!!t,t?(this.$frontMarkers[n]=e,this._signal("changeFrontMarker")):(this.$backMarkers[n]=e,this._signal("changeBackMarker")),e},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];if(!t)return;var n=t.inFront?this.$frontMarkers:this.$backMarkers;delete n[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker")},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new p(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,n,r){typeof t!="number"&&(n=t,t=e),n||(n="ace_step");var i=new l(e,0,t,Infinity);return i.id=this.addMarker(i,n,"fullLine",r),i},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);t?this.$autoNewLine=t[1]:this.$autoNewLine="\n"},this.getWordRange=function(e,t){var n=this.getLine(e),r=!1;t>0&&(r=!!n.charAt(t-1).match(this.tokenRe)),r||(r=!!n.charAt(t).match(this.tokenRe));if(r)var i=this.tokenRe;else if(/^\s+$/.test(n.slice(t-1,t+1)))var i=/\s/;else var i=this.nonTokenRe;var s=t;if(s>0){do s--;while(s>=0&&n.charAt(s).match(i));s++}var o=t;while(o<n.length&&n.charAt(o).match(i))o++;return new l(e,s,e,o)},this.getAWordRange=function(e,t){var n=this.getWordRange(e,t),r=this.getLine(n.end.row);while(r.charAt(n.end.column).match(/[ \t]/))n.end.column+=1;return n},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes={},this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&typeof e=="object"){if(e.getTokenizer)return this.$onChangeMode(e);var n=e,r=n.path}else r=e||"ace/mode/text";this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new f);if(this.$modes[r]&&!n){this.$onChangeMode(this.$modes[r]),t&&t();return}this.$modeId=r,o.loadModule(["mode",r],function(e){if(this.$modeId!==r)return t&&t();this.$modes[r]&&!n?this.$onChangeMode(this.$modes[r]):e&&e.Mode&&(e=new e.Mode(n),n||(this.$modes[r]=e,e.$id=r),this.$onChangeMode(e)),t&&t()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(e,t){t||(this.$modeId=e.$id);if(this.$mode===e)return;this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var n=e.getTokenizer();if(n.addEventListener!==undefined){var r=this.onReloadTokenizer.bind(this);n.addEventListener("update",r)}if(!this.bgTokenizer){this.bgTokenizer=new h(n);var i=this;this.bgTokenizer.addEventListener("update",function(e){i._signal("tokenizerUpdate",e)})}else this.bgTokenizer.setTokenizer(n);this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){o.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){if(this.$scrollTop===e||isNaN(e))return;this.$scrollTop=e,this._signal("changeScrollTop",e)},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){if(this.$scrollLeft===e||isNaN(e))return;this.$scrollLeft=e,this._signal("changeScrollLeft",e)},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(this.lineWidgetsWidth!=null)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach(function(t){t&&t.screenWidth>e&&(e=t.screenWidth)}),this.lineWidgetWidth=e},this.$computeWidth=function(e){if(this.$modified||e){this.$modified=!1;if(this.$useWrapMode)return this.screenWidth=this.$wrapLimit;var t=this.doc.getAllLines(),n=this.$rowLengthCache,r=0,i=0,s=this.$foldData[i],o=s?s.start.row:Infinity,u=t.length;for(var a=0;a<u;a++){if(a>o){a=s.end.row+1;if(a>=u)break;s=this.$foldData[i++],o=s?s.start.row:Infinity}n[a]==null&&(n[a]=this.$getStringScreenWidth(t[a])[0]),n[a]>r&&(r=n[a])}this.screenWidth=r}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.removeFullLines=function(e,t){return this.doc.removeFullLines(e,t)},this.undoChanges=function(e,t){if(!e.length)return;this.$fromUndo=!0;for(var n=e.length-1;n!=-1;n--){var r=e[n];r.action=="insert"||r.action=="remove"?this.doc.revertDelta(r):r.folds&&this.addFolds(r.folds)}!t&&this.$undoSelect&&(e.selectionBefore?this.selection.fromJSON(e.selectionBefore):this.selection.setRange(this.$getUndoSelection(e,!0))),this.$fromUndo=!1},this.redoChanges=function(e,t){if(!e.length)return;this.$fromUndo=!0;for(var n=0;n<e.length;n++){var r=e[n];(r.action=="insert"||r.action=="remove")&&this.doc.applyDelta(r)}!t&&this.$undoSelect&&(e.selectionAfter?this.selection.fromJSON(e.selectionAfter):this.selection.setRange(this.$getUndoSelection(e,!1))),this.$fromUndo=!1},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t){function n(e){return t?e.action!=="insert":e.action==="insert"}var r,i,s;for(var o=0;o<e.length;o++){var u=e[o];if(!u.start)continue;if(!r){n(u)?(r=l.fromPoints(u.start,u.end),s=!0):(r=l.fromPoints(u.start,u.start),s=!1);continue}n(u)?(i=u.start,r.compare(i.row,i.column)==-1&&r.setStart(i),i=u.end,r.compare(i.row,i.column)==1&&r.setEnd(i),s=!0):(i=u.start,r.compare(i.row,i.column)==-1&&(r=l.fromPoints(u.start,u.start)),s=!1)}return r},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,n){var r=this.getTextRange(e),i=this.getFoldsInRange(e),s=l.fromPoints(t,t);if(!n){this.remove(e);var o=e.start.row-e.end.row,u=o?-e.end.column:e.start.column-e.end.column;u&&(s.start.row==e.end.row&&s.start.column>e.end.column&&(s.start.column+=u),s.end.row==e.end.row&&s.end.column>e.end.column&&(s.end.column+=u)),o&&s.start.row>=e.end.row&&(s.start.row+=o,s.end.row+=o)}s.end=this.insert(s.start,r);if(i.length){var a=e.start,f=s.start,o=f.row-a.row,u=f.column-a.column;this.addFolds(i.map(function(e){return e=e.clone(),e.start.row==a.row&&(e.start.column+=u),e.end.row==a.row&&(e.end.column+=u),e.start.row+=o,e.end.row+=o,e}))}return s},this.indentRows=function(e,t,n){n=n.replace(/\t/g,this.getTabString());for(var r=e;r<=t;r++)this.doc.insertInLine({row:r,column:0},n)},this.outdentRows=function(e){var t=e.collapseRows(),n=new l(0,0,0,0),r=this.getTabSize();for(var i=t.start.row;i<=t.end.row;++i){var s=this.getLine(i);n.start.row=i,n.end.row=i;for(var o=0;o<r;++o)if(s.charAt(o)!=" ")break;o<r&&s.charAt(o)=="	"?(n.start.column=o,n.end.column=o+1):(n.start.column=0,n.end.column=o),this.remove(n)}},this.$moveLines=function(e,t,n){e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t);if(n<0){var r=this.getRowFoldStart(e+n);if(r<0)return 0;var i=r-e}else if(n>0){var r=this.getRowFoldEnd(t+n);if(r>this.doc.getLength()-1)return 0;var i=r-t}else{e=this.$clipRowToDocument(e),t=this.$clipRowToDocument(t);var i=t-e+1}var s=new l(e,0,t,Number.MAX_VALUE),o=this.getFoldsInRange(s).map(function(e){return e=e.clone(),e.start.row+=i,e.end.row+=i,e}),u=n==0?this.doc.getLines(e,t):this.doc.removeFullLines(e,t);return this.doc.insertFullLines(e+i,u),o.length&&this.addFolds(o),i},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){t=Math.max(0,t);if(e<0)e=0,t=0;else{var n=this.doc.getLength();e>=n?(e=n-1,t=this.doc.getLine(n-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0);if(e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){if(this.$wrapLimitRange.min!==e||this.$wrapLimitRange.max!==t)this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode")},this.adjustWrapLimit=function(e,t){var n=this.$wrapLimitRange;n.max<0&&(n={min:t,max:t});var r=this.$constrainWrapLimit(e,n.min,n.max);return r!=this.$wrapLimit&&r>1?(this.$wrapLimit=r,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0):!1},this.$constrainWrapLimit=function(e,t,n){return t&&(e=Math.max(t,e)),n&&(e=Math.min(n,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t=this.$useWrapMode,n=e.action,r=e.start,i=e.end,s=r.row,o=i.row,u=o-s,a=null;this.$updating=!0;if(u!=0)if(n==="remove"){this[t?"$wrapData":"$rowLengthCache"].splice(s,u);var f=this.$foldData;a=this.getFoldsInRange(e),this.removeFolds(a);var l=this.getFoldLine(i.row),c=0;if(l){l.addRemoveChars(i.row,i.column,r.column-i.column),l.shiftRow(-u);var h=this.getFoldLine(s);h&&h!==l&&(h.merge(l),l=h),c=f.indexOf(l)+1}for(c;c<f.length;c++){var l=f[c];l.start.row>=i.row&&l.shiftRow(-u)}o=s}else{var p=Array(u);p.unshift(s,0);var d=t?this.$wrapData:this.$rowLengthCache;d.splice.apply(d,p);var f=this.$foldData,l=this.getFoldLine(s),c=0;if(l){var v=l.range.compareInside(r.row,r.column);v==0?(l=l.split(r.row,r.column),l&&(l.shiftRow(u),l.addRemoveChars(o,0,i.column-r.column))):v==-1&&(l.addRemoveChars(s,0,i.column-r.column),l.shiftRow(u)),c=f.indexOf(l)+1}for(c;c<f.length;c++){var l=f[c];l.start.row>=s&&l.shiftRow(u)}}else{u=Math.abs(e.start.column-e.end.column),n==="remove"&&(a=this.getFoldsInRange(e),this.removeFolds(a),u=-u);var l=this.getFoldLine(s);l&&l.addRemoveChars(s,r.column,u)}return t&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,t?this.$updateWrapData(s,o):this.$updateRowLengthCache(s,o),a},this.$updateRowLengthCache=function(e,t,n){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(e,t){var r=this.doc.getAllLines(),i=this.getTabSize(),o=this.$wrapData,u=this.$wrapLimit,a,f,l=e;t=Math.min(t,r.length-1);while(l<=t)f=this.getFoldLine(l,f),f?(a=[],f.walk(function(e,t,i,o){var u;if(e!=null){u=this.$getDisplayTokens(e,a.length),u[0]=n;for(var f=1;f<u.length;f++)u[f]=s}else u=this.$getDisplayTokens(r[t].substring(o,i),a.length);a=a.concat(u)}.bind(this),f.end.row,r[f.end.row].length+1),o[f.start.row]=this.$computeWrapSplits(a,u,i),l=f.end.row+1):(a=this.$getDisplayTokens(r[l]),o[l]=this.$computeWrapSplits(a,u,i),l++)};var e=1,t=2,n=3,s=4,a=9,c=10,d=11,v=12;this.$computeWrapSplits=function(e,r,i){function g(){var t=0;if(m===0)return t;if(p)for(var n=0;n<e.length;n++){var r=e[n];if(r==c)t+=1;else{if(r!=d){if(r==v)continue;break}t+=i}}return h&&p!==!1&&(t+=i),Math.min(t,m)}function y(t){var n=e.slice(f,t),r=n.length;n.join("").replace(/12/g,function(){r-=1}).replace(/2/g,function(){r-=1}),o.length||(b=g(),o.indent=b),l+=r,o.push(l),f=t}if(e.length==0)return[];var o=[],u=e.length,f=0,l=0,h=this.$wrapAsCode,p=this.$indentedSoftWrap,m=r<=Math.max(2*i,8)||p===!1?0:Math.floor(r/2),b=0;while(u-f>r-b){var w=f+r-b;if(e[w-1]>=c&&e[w]>=c){y(w);continue}if(e[w]==n||e[w]==s){for(w;w!=f-1;w--)if(e[w]==n)break;if(w>f){y(w);continue}w=f+r;for(w;w<e.length;w++)if(e[w]!=s)break;if(w==e.length)break;y(w);continue}var E=Math.max(w-(r-(r>>2)),f-1);while(w>E&&e[w]<n)w--;if(h){while(w>E&&e[w]<n)w--;while(w>E&&e[w]==a)w--}else while(w>E&&e[w]<c)w--;if(w>E){y(++w);continue}w=f+r,e[w]==t&&w--,y(w-b)}return o},this.$getDisplayTokens=function(n,r){var i=[],s;r=r||0;for(var o=0;o<n.length;o++){var u=n.charCodeAt(o);if(u==9){s=this.getScreenTabSize(i.length+r),i.push(d);for(var f=1;f<s;f++)i.push(v)}else u==32?i.push(c):u>39&&u<48||u>57&&u<64?i.push(a):u>=4352&&m(u)?i.push(e,t):i.push(e)}return i},this.$getStringScreenWidth=function(e,t,n){if(t==0)return[0,0];t==null&&(t=Infinity),n=n||0;var r,i;for(i=0;i<e.length;i++){r=e.charCodeAt(i),r==9?n+=this.getScreenTabSize(n):r>=4352&&m(r)?n+=2:n+=1;if(n>t)break}return[n,i]},this.lineWidgets=null,this.getRowLength=function(e){if(this.lineWidgets)var t=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0;else t=0;return!this.$useWrapMode||!this.$wrapData[e]?1+t:this.$wrapData[e].length+1+t},this.getRowLineCount=function(e){return!this.$useWrapMode||!this.$wrapData[e]?1:this.$wrapData[e].length+1},this.getRowWrapIndent=function(e){if(this.$useWrapMode){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE),n=this.$wrapData[t.row];return n.length&&n[0]<t.column?n.indent:0}return 0},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var n=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(n)},this.getDocumentLastRowColumnPosition=function(e,t){var n=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(n,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:undefined},this.getScreenTabSize=function(e){return this.$tabSize-e%this.$tabSize},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t,n){if(e<0)return{row:0,column:0};var r,i=0,s=0,o,u=0,a=0,f=this.$screenRowCache,l=this.$getRowCacheIndex(f,e),c=f.length;if(c&&l>=0)var u=f[l],i=this.$docRowCache[l],h=e>f[c-1];else var h=!c;var p=this.getLength()-1,d=this.getNextFoldLine(i),v=d?d.start.row:Infinity;while(u<=e){a=this.getRowLength(i);if(u+a>e||i>=p)break;u+=a,i++,i>v&&(i=d.end.row+1,d=this.getNextFoldLine(i,d),v=d?d.start.row:Infinity),h&&(this.$docRowCache.push(i),this.$screenRowCache.push(u))}if(d&&d.start.row<=i)r=this.getFoldDisplayLine(d),i=d.start.row;else{if(u+a<=e||i>p)return{row:p,column:this.getLine(p).length};r=this.getLine(i),d=null}var m=0,g=Math.floor(e-u);if(this.$useWrapMode){var y=this.$wrapData[i];y&&(o=y[g],g>0&&y.length&&(m=y.indent,s=y[g-1]||y[y.length-1],r=r.substring(s)))}return n!==undefined&&this.$bidiHandler.isBidiRow(u+g,i,g)&&(t=this.$bidiHandler.offsetToCol(n)),s+=this.$getStringScreenWidth(r,t-m)[1],this.$useWrapMode&&s>=o&&(s=o-1),d?d.idxToPosition(s):{row:i,column:s}},this.documentToScreenPosition=function(e,t){if(typeof t=="undefined")var n=this.$clipPositionToDocument(e.row,e.column);else n=this.$clipPositionToDocument(e,t);e=n.row,t=n.column;var r=0,i=null,s=null;s=this.getFoldAt(e,t,1),s&&(e=s.start.row,t=s.start.column);var o,u=0,a=this.$docRowCache,f=this.$getRowCacheIndex(a,e),l=a.length;if(l&&f>=0)var u=a[f],r=this.$screenRowCache[f],c=e>a[l-1];else var c=!l;var h=this.getNextFoldLine(u),p=h?h.start.row:Infinity;while(u<e){if(u>=p){o=h.end.row+1;if(o>e)break;h=this.getNextFoldLine(o,h),p=h?h.start.row:Infinity}else o=u+1;r+=this.getRowLength(u),u=o,c&&(this.$docRowCache.push(u),this.$screenRowCache.push(r))}var d="";h&&u>=p?(d=this.getFoldDisplayLine(h,e,t),i=h.start.row):(d=this.getLine(e).substring(0,t),i=e);var v=0;if(this.$useWrapMode){var m=this.$wrapData[i];if(m){var g=0;while(d.length>=m[g])r++,g++;d=d.substring(m[g-1]||0,d.length),v=g>0?m.indent:0}}return{row:r,column:v+this.$getStringScreenWidth(d)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(!this.$useWrapMode){e=this.getLength();var n=this.$foldData;for(var r=0;r<n.length;r++)t=n[r],e-=t.end.row-t.start.row}else{var i=this.$wrapData.length,s=0,r=0,t=this.$foldData[r++],o=t?t.start.row:Infinity;while(s<i){var u=this.$wrapData[s];e+=u?u.length+1:1,s++,s>o&&(s=t.end.row+1,t=this.$foldData[r++],o=t?t.start.row:Infinity)}}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){if(!this.$enableVarChar)return;this.$getStringScreenWidth=function(t,n,r){if(n===0)return[0,0];n||(n=Infinity),r=r||0;var i,s;for(s=0;s<t.length;s++){i=t.charAt(s),i==="	"?r+=this.getScreenTabSize(r):r+=e.getCharacterWidth(i);if(r>n)break}return[r,s]}},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()},this.isFullWidth=m}.call(d.prototype),e("./edit_session/folding").Folding.call(d.prototype),e("./edit_session/bracket_match").BracketMatch.call(d.prototype),o.defineOptions(d.prototype,"session",{wrap:{set:function(e){!e||e=="off"?e=!1:e=="free"?e=!0:e=="printMargin"?e=-1:typeof e=="string"&&(e=parseInt(e,10)||!1);if(this.$wrap==e)return;this.$wrap=e;if(!e)this.setUseWrapMode(!1);else{var t=typeof e=="number"?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}},get:function(){return this.getUseWrapMode()?this.$wrap==-1?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){e=e=="auto"?this.$mode.type!="text":e!="text",e!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$modified=!0,this.$resetRowCache(0),this.$updateWrapData(0,this.getLength()-1)))},initialValue:"auto"},indentedSoftWrap:{initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){if(isNaN(e)||this.$tabSize===e)return;this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize")},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(e){this.setFoldStyle(e)},handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId},handlesSet:!0}}),t.EditSession=d}),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(e,t,n){"use strict";function u(e,t){function n(e){return/\w/.test(e)||t.regExp?"\\b":""}return n(e[0])+e+n(e[e.length-1])}var r=e("./lib/lang"),i=e("./lib/oop"),s=e("./range").Range,o=function(){this.$options={}};(function(){this.set=function(e){return i.mixin(this.$options,e),this},this.getOptions=function(){return r.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$options,n=this.$matchIterator(e,t);if(!n)return!1;var r=null;return n.forEach(function(e,n,i,o){return r=new s(e,n,i,o),n==o&&t.start&&t.start.start&&t.skipCurrent!=0&&r.isEqual(t.start)?(r=null,!1):!0}),r},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var n=t.range,i=n?e.getLines(n.start.row,n.end.row):e.doc.getAllLines(),o=[],u=t.re;if(t.$isMultiLine){var a=u.length,f=i.length-a,l;e:for(var c=u.offset||0;c<=f;c++){for(var h=0;h<a;h++)if(i[c+h].search(u[h])==-1)continue e;var p=i[c],d=i[c+a-1],v=p.length-p.match(u[0])[0].length,m=d.match(u[a-1])[0].length;if(l&&l.end.row===c&&l.end.column>v)continue;o.push(l=new s(c,v,c+a-1,m)),a>2&&(c=c+a-2)}}else for(var g=0;g<i.length;g++){var y=r.getMatchOffsets(i[g],u);for(var h=0;h<y.length;h++){var b=y[h];o.push(new s(g,b.offset,g,b.offset+b.length))}}if(n){var w=n.start.column,E=n.start.column,g=0,h=o.length-1;while(g<h&&o[g].start.column<w&&o[g].start.row==n.start.row)g++;while(g<h&&o[h].end.column>E&&o[h].end.row==n.end.row)h--;o=o.slice(g,h+1);for(g=0,h=o.length;g<h;g++)o[g].start.row+=n.start.row,o[g].end.row+=n.start.row}return o},this.replace=function(e,t){var n=this.$options,r=this.$assembleRegExp(n);if(n.$isMultiLine)return t;if(!r)return;var i=r.exec(e);if(!i||i[0].length!=e.length)return null;t=e.replace(r,t);if(n.preserveCase){t=t.split("");for(var s=Math.min(e.length,e.length);s--;){var o=e[s];o&&o.toLowerCase()!=o?t[s]=t[s].toUpperCase():t[s]=t[s].toLowerCase()}t=t.join("")}return t},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var n=e.needle;if(!e.needle)return e.re=!1;e.regExp||(n=r.escapeRegExp(n)),e.wholeWord&&(n=u(n,e));var i=e.caseSensitive?"gm":"gmi";e.$isMultiLine=!t&&/[\n\r]/.test(n);if(e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(n,i);try{var s=new RegExp(n,i)}catch(o){s=!1}return e.re=s},this.$assembleMultilineRegExp=function(e,t){var n=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),r=[];for(var i=0;i<n.length;i++)try{r.push(new RegExp(n[i],t))}catch(s){return!1}return r},this.$matchIterator=function(e,t){var n=this.$assembleRegExp(t);if(!n)return!1;var r=t.backwards==1,i=t.skipCurrent!=0,s=t.range,o=t.start;o||(o=s?s[r?"end":"start"]:e.selection.getRange()),o.start&&(o=o[i!=r?"end":"start"]);var u=s?s.start.row:0,a=s?s.end.row:e.getLength()-1;if(r)var f=function(e){var n=o.row;if(c(n,o.column,e))return;for(n--;n>=u;n--)if(c(n,Number.MAX_VALUE,e))return;if(t.wrap==0)return;for(n=a,u=o.row;n>=u;n--)if(c(n,Number.MAX_VALUE,e))return};else var f=function(e){var n=o.row;if(c(n,o.column,e))return;for(n+=1;n<=a;n++)if(c(n,0,e))return;if(t.wrap==0)return;for(n=u,a=o.row;n<=a;n++)if(c(n,0,e))return};if(t.$isMultiLine)var l=n.length,c=function(t,i,s){var o=r?t-l+1:t;if(o<0)return;var u=e.getLine(o),a=u.search(n[0]);if(!r&&a<i||a===-1)return;for(var f=1;f<l;f++){u=e.getLine(o+f);if(u.search(n[f])==-1)return}var c=u.match(n[l-1])[0].length;if(r&&c>i)return;if(s(o,a,o+l-1,c))return!0};else if(r)var c=function(t,r,i){var s=e.getLine(t),o=[],u,a=0;n.lastIndex=0;while(u=n.exec(s)){var f=u[0].length;a=u.index;if(!f){if(a>=s.length)break;n.lastIndex=a+=1}if(u.index+f>r)break;o.push(u.index,f)}for(var l=o.length-1;l>=0;l-=2){var c=o[l-1],f=o[l];if(i(t,c,t,c+f))return!0}};else var c=function(t,r,i){var s=e.getLine(t),o,u;n.lastIndex=r;while(u=n.exec(s)){var a=u[0].length;o=u.index;if(i(t,o,t,o+a))return!0;if(!a){n.lastIndex=o+=1;if(o>=s.length)return!1}}};return{forEach:f}}}).call(o.prototype),t.Search=o}),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(e,t,n){"use strict";function o(e,t){this.platform=t||(i.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=!0}function u(e,t){o.call(this,e,t),this.$singleCommand=!1}var r=e("../lib/keys"),i=e("../lib/useragent"),s=r.KEY_MODS;u.prototype=o.prototype,function(){function e(e){return typeof e=="object"&&e.bindKey&&e.bindKey.position||(e.isDefault?-100:0)}this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e,t){var n=e&&(typeof e=="string"?e:e.name);e=this.commands[n],t||delete this.commands[n];var r=this.commandKeyBinding;for(var i in r){var s=r[i];if(s==e)delete r[i];else if(Array.isArray(s)){var o=s.indexOf(e);o!=-1&&(s.splice(o,1),s.length==1&&(r[i]=s[0]))}}},this.bindKey=function(e,t,n){typeof e=="object"&&e&&(n==undefined&&(n=e.position),e=e[this.platform]);if(!e)return;if(typeof t=="function")return this.addCommand({exec:t,bindKey:e,name:t.name||e});e.split("|").forEach(function(e){var r="";if(e.indexOf(" ")!=-1){var i=e.split(/\s+/);e=i.pop(),i.forEach(function(e){var t=this.parseKeys(e),n=s[t.hashId]+t.key;r+=(r?" ":"")+n,this._addCommandToBinding(r,"chainKeys")},this),r+=" "}var o=this.parseKeys(e),u=s[o.hashId]+o.key;this._addCommandToBinding(r+u,t,n)},this)},this._addCommandToBinding=function(t,n,r){var i=this.commandKeyBinding,s;if(!n)delete i[t];else if(!i[t]||this.$singleCommand)i[t]=n;else{Array.isArray(i[t])?(s=i[t].indexOf(n))!=-1&&i[t].splice(s,1):i[t]=[i[t]],typeof r!="number"&&(r=e(n));var o=i[t];for(s=0;s<o.length;s++){var u=o[s],a=e(u);if(a>r)break}o.splice(s,0,n)}},this.addCommands=function(e){e&&Object.keys(e).forEach(function(t){var n=e[t];if(!n)return;if(typeof n=="string")return this.bindKey(n,t);typeof n=="function"&&(n={exec:n});if(typeof n!="object")return;n.name||(n.name=t),this.addCommand(n)},this)},this.removeCommands=function(e){Object.keys(e).forEach(function(t){this.removeCommand(e[t])},this)},this.bindKeys=function(e){Object.keys(e).forEach(function(t){this.bindKey(t,e[t])},this)},this._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},this.parseKeys=function(e){var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(e){return e}),n=t.pop(),i=r[n];if(r.FUNCTION_KEYS[i])n=r.FUNCTION_KEYS[i].toLowerCase();else{if(!t.length)return{key:n,hashId:-1};if(t.length==1&&t[0]=="shift")return{key:n.toUpperCase(),hashId:-1}}var s=0;for(var o=t.length;o--;){var u=r.KEY_MODS[t[o]];if(u==null)return typeof console!="undefined"&&console.error("invalid modifier "+t[o]+" in "+e),!1;s|=u}return{key:n,hashId:s}},this.findKeyCommand=function(t,n){var r=s[t]+n;return this.commandKeyBinding[r]},this.handleKeyboard=function(e,t,n,r){if(r<0)return;var i=s[t]+n,o=this.commandKeyBinding[i];e.$keyChain&&(e.$keyChain+=" "+i,o=this.commandKeyBinding[e.$keyChain]||o);if(o)if(o=="chainKeys"||o[o.length-1]=="chainKeys")return e.$keyChain=e.$keyChain||i,{command:"null"};if(e.$keyChain)if(!!t&&t!=4||n.length!=1){if(t==-1||r>0)e.$keyChain=""}else e.$keyChain=e.$keyChain.slice(0,-i.length-1);return{command:o}},this.getStatusText=function(e,t){return t.$keyChain||""}}.call(o.prototype),t.HashHandler=o,t.MultiHashHandler=u}),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../keyboard/hash_handler").MultiHashHandler,s=e("../lib/event_emitter").EventEmitter,o=function(e,t){i.call(this,t,e),this.byName=this.commands,this.setDefaultHandler("exec",function(e){return e.command.exec(e.editor,e.args||{})})};r.inherits(o,i),function(){r.implement(this,s),this.exec=function(e,t,n){if(Array.isArray(e)){for(var r=e.length;r--;)if(this.exec(e[r],t,n))return!0;return!1}typeof e=="string"&&(e=this.commands[e]);if(!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;if(e.isAvailable&&!e.isAvailable(t))return!1;var i={editor:t,command:e,args:n};return i.returnValue=this._emit("exec",i),this._signal("afterExec",i),i.returnValue===!1?!1:!0},this.toggleRecording=function(e){if(this.$inReplay)return;return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(e){if(this.$inReplay||!this.macro)return;if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach(function(t){typeof t=="string"?this.exec(t,e):this.exec(t[0],e,t[1])},this)}finally{this.$inReplay=!1}},this.trimMacro=function(e){return e.map(function(e){return typeof e[0]!="string"&&(e[0]=e[0].name),e[1]||(e=e[0]),e})}}.call(o.prototype),t.CommandManager=o}),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],function(e,t,n){"use strict";function o(e,t){return{win:e,mac:t}}var r=e("../lib/lang"),i=e("../config"),s=e("../range").Range;t.commands=[{name:"showSettingsMenu",bindKey:o("Ctrl-,","Command-,"),exec:function(e){i.loadModule("ace/ext/settings_menu",function(t){t.init(e),e.showSettingsMenu()})},readOnly:!0},{name:"goToNextError",bindKey:o("Alt-E","F4"),exec:function(e){i.loadModule("./ext/error_marker",function(t){t.showErrorMarker(e,1)})},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:o("Alt-Shift-E","Shift-F4"),exec:function(e){i.loadModule("./ext/error_marker",function(t){t.showErrorMarker(e,-1)})},scrollIntoView:"animate",readOnly:!0},{name:"selectall",bindKey:o("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",bindKey:o(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:o("Ctrl-L","Command-L"),exec:function(e,t){typeof t!="number"&&(t=parseInt(prompt("Enter line number:"),10)),isNaN(t)||e.gotoLine(t)},readOnly:!0},{name:"fold",bindKey:o("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:o("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:o("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:o("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:o(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:o("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:o("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:o("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",bindKey:o("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",bindKey:o("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:o("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",bindKey:o("Ctrl-F","Command-F"),exec:function(e){i.loadModule("ace/ext/searchbox",function(t){t.Search(e)})},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:o("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:o("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:o("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",bindKey:o("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",bindKey:o("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:o("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:o("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:o("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:o("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:o("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:o("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:o("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:o("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:o("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:o("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:o("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:o("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:o("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:o("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:o("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:o(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:o("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:o(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:o("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:o("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",bindKey:o("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",bindKey:o("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",bindKey:o("Ctrl-P","Ctrl-P"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",bindKey:o("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",bindKey:o("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",bindKey:o(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",exec:function(e){},readOnly:!0},{name:"cut",exec:function(e){var t=e.$copyWithEmptySelection&&e.selection.isEmpty(),n=t?e.selection.getLineRange():e.selection.getRange();e._emit("cut",n),n.isEmpty()||e.session.remove(n),e.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",exec:function(e,t){e.$handlePaste(t)},scrollIntoView:"cursor"},{name:"removeline",bindKey:o("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:o("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:o("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:o("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:o("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:o("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:o("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",bindKey:o("Ctrl-H","Command-Option-F"),exec:function(e){i.loadModule("ace/ext/searchbox",function(t){t.Search(e,!0)})}},{name:"undo",bindKey:o("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",bindKey:o("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",bindKey:o("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:o("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:o("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:o("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",bindKey:o("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:o("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:o("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:o("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:o("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",bindKey:o("Ctrl-Shift-Backspace",null),exec:function(e){var t=e.selection.getRange();t.start.column=0,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",bindKey:o("Ctrl-Shift-Delete",null),exec:function(e){var t=e.selection.getRange();t.end.column=Number.MAX_VALUE,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:o("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:o("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:o("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:o("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:o("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:o("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(e,t){e.insert(r.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:o(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:o("Alt-Shift-X","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",bindKey:o("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:o("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:o("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",bindKey:o(null,null),exec:function(e){var t=e.selection.isBackwards(),n=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),i=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),o=e.session.doc.getLine(n.row).length,u=e.session.doc.getTextRange(e.selection.getRange()),a=u.replace(/\n\s*/," ").length,f=e.session.doc.getLine(n.row);for(var l=n.row+1;l<=i.row+1;l++){var c=r.stringTrimLeft(r.stringTrimRight(e.session.doc.getLine(l)));c.length!==0&&(c=" "+c),f+=c}i.row+1<e.session.doc.getLength()-1&&(f+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new s(n.row,0,i.row+2,0),f),a>0?(e.selection.moveCursorTo(n.row,n.column),e.selection.selectTo(n.row,n.column+a)):(o=e.session.doc.getLine(n.row).length>o?o+1:o,e.selection.moveCursorTo(n.row,o))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",bindKey:o(null,null),exec:function(e){var t=e.session.doc.getLength()-1,n=e.session.doc.getLine(t).length,r=e.selection.rangeList.ranges,i=[];r.length<1&&(r=[e.selection.getRange()]);for(var o=0;o<r.length;o++)o==r.length-1&&(r[o].end.row!==t||r[o].end.column!==n)&&i.push(new s(r[o].end.row,r[o].end.column,t,n)),o===0?(r[o].start.row!==0||r[o].start.column!==0)&&i.push(new s(0,0,r[o].start.row,r[o].start.column)):i.push(new s(r[o-1].end.row,r[o-1].end.column,r[o].start.row,r[o].start.column));e.exitMultiSelectMode(),e.clearSelection();for(var o=0;o<i.length;o++)e.selection.addRange(i[o],!1)},readOnly:!0,scrollIntoView:"none"}]}),ace.define("ace/clipboard",["require","exports","module"],function(e,t,n){"use strict";n.exports={lineMode:!1}}),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator","ace/clipboard"],function(e,t,n){"use strict";e("./lib/fixoldbrowsers");var r=e("./lib/oop"),i=e("./lib/dom"),s=e("./lib/lang"),o=e("./lib/useragent"),u=e("./keyboard/textinput").TextInput,a=e("./mouse/mouse_handler").MouseHandler,f=e("./mouse/fold_handler").FoldHandler,l=e("./keyboard/keybinding").KeyBinding,c=e("./edit_session").EditSession,h=e("./search").Search,p=e("./range").Range,d=e("./lib/event_emitter").EventEmitter,v=e("./commands/command_manager").CommandManager,m=e("./commands/default_commands").commands,g=e("./config"),y=e("./token_iterator").TokenIterator,b=e("./clipboard"),w=function(e,t,n){var r=e.getContainerElement();this.container=r,this.renderer=e,this.id="editor"+ ++w.$uid,this.commands=new v(o.isMac?"mac":"win",m),typeof document=="object"&&(this.textInput=new u(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new a(this),new f(this)),this.keyBinding=new l(this),this.$search=(new h).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=s.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",function(e,t){t._$emitInputEvent.schedule(31)}),this.setSession(t||n&&n.session||new c("")),g.resetOptions(this),n&&this.setOptions(n),g._signal("editor",this)};w.$uid=0,function(){r.implement(this,d),this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=s.delayedCall(this.endOperation.bind(this)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},this.endOperation=function(e){if(this.curOp){if(e&&e.returnValue===!1)return this.curOp=null;this._signal("beforeEndOperation");var t=this.curOp.command,n=t&&t.scrollIntoView;if(n){switch(n){case"center-animate":n="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var r=this.selection.getRange(),i=this.renderer.layerConfig;(r.start.row>=i.lastRow||r.end.row<=i.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead);break;default:}n=="animate"&&this.renderer.animateScrolling(this.curOp.scrollTop)}var s=this.selection.toJSON();this.curOp.selectionAfter=s,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(s),this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(!this.$mergeUndoDeltas)return;var t=this.prevOp,n=this.$mergeableCommands,r=t.command&&e.command.name==t.command.name;if(e.command.name=="insertstring"){var i=e.args;this.mergeNextCommand===undefined&&(this.mergeNextCommand=!0),r=r&&this.mergeNextCommand&&(!/\s/.test(i)||/\s/.test(t.args)),this.mergeNextCommand=!0}else r=r&&n.indexOf(e.command.name)!==-1;this.$mergeUndoDeltas!="always"&&Date.now()-this.sequenceStartTime>2e3&&(r=!1),r?this.session.mergeUndoDeltas=!0:n.indexOf(e.command.name)!==-1&&(this.sequenceStartTime=Date.now())},this.setKeyboardHandler=function(e,t){if(e&&typeof e=="string"&&e!="ace"){this.$keybindingId=e;var n=this;g.loadModule(["keybinding",e],function(r){n.$keybindingId==e&&n.keyBinding.setKeyboardHandler(r&&r.handler),t&&t()})}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e),t&&t()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session==e)return;this.curOp&&this.endOperation(),this.curOp={};var t=this.session;if(t){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var n=this.session.getSelection();n.off("changeCursor",this.$onCursorChange),n.off("changeSelection",this.$onSelectionChange)}this.session=e,e?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.on("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&e.bgTokenizer&&e.bgTokenizer.scheduleStart()},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?t==1?this.navigateFileEnd():t==-1&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||i.computedStyle(this.container).fontSize},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null);if(this.$highlightPending)return;var e=this;this.$highlightPending=!0,setTimeout(function(){e.$highlightPending=!1;var t=e.session;if(!t||!t.bgTokenizer)return;var n=t.findMatchingBracket(e.getCursorPosition());if(n)var r=new p(n.row,n.column,n.row,n.column+1);else if(t.$mode.getMatching)var r=t.$mode.getMatching(e.session);r&&(t.$bracketHighlight=t.addMarker(r,"ace_bracket","text"))},50)},this.$highlightTags=function(){if(this.$highlightTagPending)return;var e=this;this.$highlightTagPending=!0,setTimeout(function(){e.$highlightTagPending=!1;var t=e.session;if(!t||!t.bgTokenizer)return;var n=e.getCursorPosition(),r=new y(e.session,n.row,n.column),i=r.getCurrentToken();if(!i||!/\b(?:tag-open|tag-name)/.test(i.type)){t.removeMarker(t.$tagHighlight),t.$tagHighlight=null;return}if(i.type.indexOf("tag-open")!=-1){i=r.stepForward();if(!i)return}var s=i.value,o=0,u=r.stepBackward();if(u.value=="<"){do u=i,i=r.stepForward(),i&&i.value===s&&i.type.indexOf("tag-name")!==-1&&(u.value==="<"?o++:u.value==="</"&&o--);while(i&&o>=0)}else{do i=u,u=r.stepBackward(),i&&i.value===s&&i.type.indexOf("tag-name")!==-1&&(u.value==="<"?o++:u.value==="</"&&o--);while(u&&o<=0);r.stepForward()}if(!i){t.removeMarker(t.$tagHighlight),t.$tagHighlight=null;return}var a=r.getCurrentTokenRow(),f=r.getCurrentTokenColumn(),l=new p(a,f,a,f+i.value.length),c=t.$backMarkers[t.$tagHighlight];t.$tagHighlight&&c!=undefined&&l.compareRange(c.range)!==0&&(t.removeMarker(t.$tagHighlight),t.$tagHighlight=null),t.$tagHighlight||(t.$tagHighlight=t.addMarker(l,"ace_bracket","text"))},50)},this.focus=function(){var e=this;setTimeout(function(){e.isFocused()||e.textInput.focus()}),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){if(this.$isFocused)return;this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e)},this.onBlur=function(e){if(!this.$isFocused)return;this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e)},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t=this.session.$useWrapMode,n=e.start.row==e.end.row?e.end.row:Infinity;this.renderer.updateLines(e.start.row,n,t),this._signal("change",e),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e=this.getSession(),t;if(this.$highlightActiveLine){if(this.$selectionStyle!="line"||!this.selection.isMultiLine())t=this.getCursorPosition();this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(t=!1),this.renderer.$maxLines&&this.session.getLength()===1&&!(this.renderer.$minLines>1)&&(t=!1)}if(e.$highlightLineMarker&&!t)e.removeMarker(e.$highlightLineMarker.id),e.$highlightLineMarker=null;else if(!e.$highlightLineMarker&&t){var n=new p(t.row,t.column,t.row,Infinity);n.id=e.addMarker(n,"ace_active-line","screenLine"),e.$highlightLineMarker=n}else t&&(e.$highlightLineMarker.start.row=t.row,e.$highlightLineMarker.end.row=t.row,e.$highlightLineMarker.start.column=t.column,e._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null;if(!this.selection.isEmpty()){var n=this.selection.getRange(),r=this.getSelectionStyle();t.$selectionMarker=t.addMarker(n,"ace_selection",r)}else this.$updateHighlightActiveLine();var i=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(i),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(t.isEmpty()||t.isMultiLine())return;var n=t.start.column,r=t.end.column,i=e.getLine(t.start.row),s=i.substring(n,r);if(s.length>5e3||!/[\w\d]/.test(s))return;var o=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:s}),u=i.substring(n-1,r+1);if(!o.test(u))return;return o},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText(),t=this.session.doc.getNewLineCharacter(),n=!1;if(!e&&this.$copyWithEmptySelection){n=!0;var r=this.selection.getAllRanges();for(var i=0;i<r.length;i++){var s=r[i];if(i&&r[i-1].start.row==s.start.row)continue;e+=this.session.getLine(s.start.row)+t}}var o={text:e};return this._signal("copy",o),b.lineMode=n?o.text:"",o.text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e,t){var n={text:e,event:t};this.commands.exec("paste",this,n)},this.$handlePaste=function(e){typeof e=="string"&&(e={text:e}),this._signal("paste",e);var t=e.text,n=t==b.lineMode,r=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)n?r.insert({row:this.selection.lead.row,column:0},t):this.insert(t);else if(n)this.selection.rangeList.ranges.forEach(function(e){r.insert({row:e.start.row,column:0},t)});else{var i=t.split(/\r\n|\r|\n/),s=this.selection.rangeList.ranges;if(i.length>s.length||i.length<2||!i[1])return this.commands.exec("insertstring",this,t);for(var o=s.length;o--;){var u=s[o];u.isEmpty()||r.remove(u),r.insert(u.start,i[o])}}},this.execCommand=function(e,t){return this.commands.exec(e,this,t)},this.insert=function(e,t){var n=this.session,r=n.getMode(),i=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var s=r.transformAction(n.getState(i.row),"insertion",this,n,e);s&&(e!==s.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),e=s.text)}e=="	"&&(e=this.session.getTabString());if(!this.selection.isEmpty()){var o=this.getSelectionRange();i=this.session.remove(o),this.clearSelection()}else if(this.session.getOverwrite()&&e.indexOf("\n")==-1){var o=new p.fromPoints(i,i);o.end.column+=e.length,this.session.remove(o)}if(e=="\n"||e=="\r\n"){var u=n.getLine(i.row);if(i.column>u.search(/\S|$/)){var a=u.substr(i.column).search(/\S|$/);n.doc.removeInLine(i.row,i.column,i.column+a)}}this.clearSelection();var f=i.column,l=n.getState(i.row),u=n.getLine(i.row),c=r.checkOutdent(l,u,e),h=n.insert(i,e);s&&s.selection&&(s.selection.length==2?this.selection.setSelectionRange(new p(i.row,f+s.selection[0],i.row,f+s.selection[1])):this.selection.setSelectionRange(new p(i.row+s.selection[0],s.selection[1],i.row+s.selection[2],s.selection[3])));if(n.getDocument().isNewLine(e)){var d=r.getNextLineIndent(l,u.slice(0,i.column),n.getTabString());n.insert({row:i.row+1,column:0},d)}c&&r.autoOutdent(l,n,i.row)},this.onTextInput=function(e){this.keyBinding.onTextInput(e)},this.onCommandKey=function(e,t,n){this.keyBinding.onCommandKey(e,t,n)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&(e=="left"?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var n=this.session,r=n.getState(t.start.row),i=n.getMode().transformAction(r,"deletion",this,n,t);if(t.end.column===0){var s=n.getTextRange(t);if(s[s.length-1]=="\n"){var o=n.getLine(t.end.row);/^\s+$/.test(o)&&(t.end.column=o.length)}}i&&(t=i)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(!this.selection.isEmpty())return;var e=this.getCursorPosition(),t=e.column;if(t===0)return;var n=this.session.getLine(e.row),r,i;t<n.length?(r=n.charAt(t)+n.charAt(t-1),i=new p(e.row,t-1,e.row,t+1)):(r=n.charAt(t-1)+n.charAt(t-2),i=new p(e.row,t-2,e.row,t)),this.session.replace(i,r),this.session.selection.moveToPosition(i.end)},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(t.start.row<t.end.row){var n=this.$getSelectedRows();e.indentRows(n.first,n.last,"	");return}if(t.start.column<t.end.column){var r=e.getTextRange(t);if(!/^\s+$/.test(r)){var n=this.$getSelectedRows();e.indentRows(n.first,n.last,"	");return}}var i=e.getLine(t.start.row),o=t.start,u=e.getTabSize(),a=e.documentToScreenColumn(o.row,o.column);if(this.session.getUseSoftTabs())var f=u-a%u,l=s.stringRepeat(" ",f);else{var f=a%u;while(i[t.start.column-1]==" "&&f)t.start.column--,f--;this.selection.setSelectionRange(t),l="	"}return this.insert(l)},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"	")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){var e=this.$getSelectedRows(),t=this.session,n=[];for(var r=e.first;r<=e.last;r++)n.push(t.getLine(r));n.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0});var i=new p(0,0,0,0);for(var r=e.first;r<=e.last;r++){var s=t.getLine(r);i.start.row=r,i.end.row=r,i.end.column=s.length,t.replace(i,n[r-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),n=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,n,e)},this.getNumberAt=function(e,t){var n=/[\-]?[0-9]+(?:\.[0-9]+)?/g;n.lastIndex=0;var r=this.session.getLine(e);while(n.lastIndex<t){var i=n.exec(r);if(i.index<=t&&i.index+i[0].length>=t){var s={value:i[0],start:i.index,end:i.index+i[0].length};return s}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,n=this.selection.getCursor().column,r=new p(t,n-1,t,n),i=this.session.getTextRange(r);if(!isNaN(parseFloat(i))&&isFinite(i)){var s=this.getNumberAt(t,n);if(s){var o=s.value.indexOf(".")>=0?s.start+s.value.indexOf(".")+1:s.end,u=s.start+s.value.length-o,a=parseFloat(s.value);a*=Math.pow(10,u),o!==s.end&&n<o?e*=Math.pow(10,s.end-n-1):e*=Math.pow(10,s.end-n),a+=e,a/=Math.pow(10,u);var f=a.toFixed(u),l=new p(t,s.start,t,s.end);this.session.replace(l,f),this.moveCursorTo(t,Math.max(s.start+1,n+f.length-s.value.length))}}},this.removeLines=function(){var e=this.$getSelectedRows();this.session.removeFullLines(e.first,e.last),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,n=e.getRange(),r=e.isBackwards();if(n.isEmpty()){var i=n.start.row;t.duplicateLines(i,i)}else{var s=r?n.start:n.end,o=t.insert(s,t.getTextRange(n),!1);n.start=s,n.end=o,e.setSelectionRange(n,r)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(e,t,n){return this.session.moveText(e,t,n)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(e,t){var n,r,i=this.selection;if(!i.inMultiSelectMode||this.inVirtualSelectionMode){var s=i.toOrientedRange();n=this.$getSelectedRows(s),r=this.session.$moveLines(n.first,n.last,t?0:e),t&&e==-1&&(r=0),s.moveBy(r,0),i.fromOrientedRange(s)}else{var o=i.rangeList.ranges;i.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;var u=0,a=0,f=o.length;for(var l=0;l<f;l++){var c=l;o[l].moveBy(u,0),n=this.$getSelectedRows(o[l]);var h=n.first,p=n.last;while(++l<f){a&&o[l].moveBy(a,0);var d=this.$getSelectedRows(o[l]);if(t&&d.first!=p)break;if(!t&&d.first>p+1)break;p=d.last}l--,u=this.session.$moveLines(h,p,t?0:e),t&&e==-1&&(c=l+1);while(c<=l)o[c].moveBy(u,0),c++;t||(u=0),a+=u}i.fromOrientedRange(i.ranges[0]),i.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(this.getCursorPosition())},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var n=this.renderer,r=this.renderer.layerConfig,i=e*Math.floor(r.height/r.lineHeight);t===!0?this.selection.$moveSelection(function(){this.moveCursorBy(i,0)}):t===!1&&(this.selection.moveCursorBy(i,0),this.selection.clearSelection());var s=n.scrollTop;n.scrollBy(0,i*r.lineHeight),t!=null&&n.scrollCursorIntoView(null,.5),n.animateScrolling(s)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,n,r){this.renderer.scrollToLine(e,t,n,r)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.selection.selectAll()},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e,t){var n=this.getCursorPosition(),r=new y(this.session,n.row,n.column),i=r.getCurrentToken(),s=i||r.stepForward();if(!s)return;var o,u=!1,a={},f=n.column-s.start,l,c={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(s.value.match(/[{}()\[\]]/g))for(;f<s.value.length&&!u;f++){if(!c[s.value[f]])continue;l=c[s.value[f]]+"."+s.type.replace("rparen","lparen"),isNaN(a[l])&&(a[l]=0);switch(s.value[f]){case"(":case"[":case"{":a[l]++;break;case")":case"]":case"}":a[l]--,a[l]===-1&&(o="bracket",u=!0)}}else s.type.indexOf("tag-name")!==-1&&(isNaN(a[s.value])&&(a[s.value]=0),i.value==="<"?a[s.value]++:i.value==="</"&&a[s.value]--,a[s.value]===-1&&(o="tag",u=!0));u||(i=s,s=r.stepForward(),f=0)}while(s&&!u);if(!o)return;var h,d;if(o==="bracket"){h=this.session.getBracketRange(n);if(!h){h=new p(r.getCurrentTokenRow(),r.getCurrentTokenColumn()+f-1,r.getCurrentTokenRow(),r.getCurrentTokenColumn()+f-1),d=h.start;if(t||d.row===n.row&&Math.abs(d.column-n.column)<2)h=this.session.getBracketRange(d)}}else if(o==="tag"){if(!s||s.type.indexOf("tag-name")===-1)return;var v=s.value;h=new p(r.getCurrentTokenRow(),r.getCurrentTokenColumn()-2,r.getCurrentTokenRow(),r.getCurrentTokenColumn()-2);if(h.compare(n.row,n.column)===0){u=!1;do s=i,i=r.stepBackward(),i&&(i.type.indexOf("tag-close")!==-1&&h.setEnd(r.getCurrentTokenRow(),r.getCurrentTokenColumn()+1),s.value===v&&s.type.indexOf("tag-name")!==-1&&(i.value==="<"?a[v]++:i.value==="</"&&a[v]--,a[v]===0&&(u=!0)));while(i&&!u)}s&&s.type.indexOf("tag-name")&&(d=h.start,d.row==n.row&&Math.abs(d.column-n.column)<2&&(d=h.end))}d=h&&h.cursor||d,d&&(e?h&&t?this.selection.setRange(h):h&&h.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(d.row,d.column):this.selection.moveTo(d.row,d.column))},this.gotoLine=function(e,t,n){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,n)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(!this.selection.isEmpty()){var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}else{e=e||1;while(e--)this.selection.moveCursorLeft()}this.clearSelection()},this.navigateRight=function(e){if(!this.selection.isEmpty()){var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}else{e=e||1;while(e--)this.selection.moveCursorRight()}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var n=this.$search.find(this.session),r=0;return n?(this.$tryReplace(n,e)&&(r=1),this.selection.setSelectionRange(n),this.renderer.scrollSelectionIntoView(n.start,n.end),r):r},this.replaceAll=function(e,t){t&&this.$search.set(t);var n=this.$search.findAll(this.session),r=0;if(!n.length)return r;var i=this.getSelectionRange();this.selection.moveTo(0,0);for(var s=n.length-1;s>=0;--s)this.$tryReplace(n[s],e)&&r++;return this.selection.setSelectionRange(i),r},this.$tryReplace=function(e,t){var n=this.session.getTextRange(e);return t=this.$search.replace(n,t),t!==null?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,n){t||(t={}),typeof e=="string"||e instanceof RegExp?t.needle=e:typeof e=="object"&&r.mixin(t,e);var i=this.selection.getRange();t.needle==null&&(e=this.session.getTextRange(i)||this.$search.$options.needle,e||(i=this.session.getWordRange(i.start.row,i.start.column),e=this.session.getTextRange(i)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:i});var s=this.$search.find(this.session);if(t.preventScroll)return s;if(s)return this.revealRange(s,n),s;t.backwards?i.start=i.end:i.end=i.start,this.selection.setRange(i)},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.session.unfold(e),this.selection.setSelectionRange(e);var n=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),t!==!1&&this.renderer.animateScrolling(n)},this.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(e){if(!e)return;var t,n=this,r=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var i=this.$scrollAnchor;i.style.cssText="position:absolute",this.container.insertBefore(i,this.container.firstChild);var s=this.on("changeSelection",function(){r=!0}),o=this.renderer.on("beforeRender",function(){r&&(t=n.renderer.container.getBoundingClientRect())}),u=this.renderer.on("afterRender",function(){if(r&&t&&(n.isFocused()||n.searchBox&&n.searchBox.isFocused())){var e=n.renderer,s=e.$cursorLayer.$pixelPos,o=e.layerConfig,u=s.top-o.offset;s.top>=0&&u+t.top<0?r=!0:s.top<o.height&&s.top+t.top+o.lineHeight>window.innerHeight?r=!1:r=null,r!=null&&(i.style.top=u+"px",i.style.left=s.left+"px",i.style.height=o.lineHeight+"px",i.scrollIntoView(r)),r=t=null}});this.setAutoScrollEditorIntoView=function(e){if(e)return;delete this.setAutoScrollEditorIntoView,this.off("changeSelection",s),this.renderer.off("afterRender",u),this.renderer.off("beforeRender",o)}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;if(!t)return;t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&e!="wide",i.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e))}}.call(w.prototype),g.defineOptions(w.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.textInput.setReadOnly(e),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(e){this.textInput.setCopyWithEmptySelection(e)},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},keyboardHandler:{set:function(e){this.setKeyboardHandler(e)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(e){this.session.setValue(e)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(e){this.setSession(e)},get:function(){return this.session},handlesSet:!0,hidden:!0},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showLineNumbers:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"}),t.Editor=w}),ace.define("ace/undomanager",["require","exports","module","ace/range"],function(e,t,n){"use strict";function i(e,t){for(var n=t;n--;){var r=e[n];if(r&&!r[0].ignore){while(n<t-1){var i=d(e[n],e[n+1]);e[n]=i[0],e[n+1]=i[1],n++}return!0}}}function a(e){var t=e.action=="insert",n=e.start,r=e.end,i=(r.row-n.row)*(t?1:-1),s=(r.column-n.column)*(t?1:-1);t&&(r=n);for(var o in this.marks){var a=this.marks[o],f=u(a,n);if(f<0)continue;if(f===0&&t){if(a.bias!=1){a.bias==-1;continue}f=1}var l=t?f:u(a,r);if(l>0){a.row+=i,a.column+=a.row==r.row?s:0;continue}!t&&l<=0&&(a.row=n.row,a.column=n.column,l===0&&(a.bias=1))}}function f(e){return{row:e.row,column:e.column}}function l(e){return{start:f(e.start),end:f(e.end),action:e.action,lines:e.lines.slice()}}function c(e){e=e||this;if(Array.isArray(e))return e.map(c).join("\n");var t="";e.action?(t=e.action=="insert"?"+":"-",t+="["+e.lines+"]"):e.value&&(Array.isArray(e.value)?t=e.value.map(h).join("\n"):t=h(e.value)),e.start&&(t+=h(e));if(e.id||e.rev)t+="	("+(e.id||e.rev)+")";return t}function h(e){return e.start.row+":"+e.start.column+"=>"+e.end.row+":"+e.end.column}function p(e,t){var n=e.action=="insert",r=t.action=="insert";if(n&&r)if(o(t.start,e.end)>=0)m(t,e,-1);else{if(!(o(t.start,e.start)<=0))return null;m(e,t,1)}else if(n&&!r)if(o(t.start,e.end)>=0)m(t,e,-1);else{if(!(o(t.end,e.start)<=0))return null;m(e,t,-1)}else if(!n&&r)if(o(t.start,e.start)>=0)m(t,e,1);else{if(!(o(t.start,e.start)<=0))return null;m(e,t,1)}else if(!n&&!r)if(o(t.start,e.start)>=0)m(t,e,1);else{if(!(o(t.end,e.start)<=0))return null;m(e,t,-1)}return[t,e]}function d(e,t){for(var n=e.length;n--;)for(var r=0;r<t.length;r++)if(!p(e[n],t[r])){while(n<e.length){while(r--)p(t[r],e[n]);r=t.length,n++}return[e,t]}return e.selectionBefore=t.selectionBefore=e.selectionAfter=t.selectionAfter=null,[t,e]}function v(e,t){var n=e.action=="insert",r=t.action=="insert";if(n&&r)o(e.start,t.start)<0?m(t,e,1):m(e,t,1);else if(n&&!r)o(e.start,t.end)>=0?m(e,t,-1):o(e.start,t.start)<=0?m(t,e,1):(m(e,s.fromPoints(t.start,e.start),-1),m(t,e,1));else if(!n&&r)o(t.start,e.end)>=0?m(t,e,-1):o(t.start,e.start)<=0?m(e,t,1):(m(t,s.fromPoints(e.start,t.start),-1),m(e,t,1));else if(!n&&!r)if(o(t.start,e.end)>=0)m(t,e,-1);else{if(!(o(t.end,e.start)<=0)){var i,u;return o(e.start,t.start)<0&&(i=e,e=y(e,t.start)),o(e.end,t.end)>0&&(u=y(e,t.end)),g(t.end,e.start,e.end,-1),u&&!i&&(e.lines=u.lines,e.start=u.start,e.end=u.end,u=e),[t,i,u].filter(Boolean)}m(e,t,-1)}return[t,e]}function m(e,t,n){g(e.start,t.start,t.end,n),g(e.end,t.start,t.end,n)}function g(e,t,n,r){e.row==(r==1?t:n).row&&(e.column+=r*(n.column-t.column)),e.row+=r*(n.row-t.row)}function y(e,t){var n=e.lines,r=e.end;e.end=f(t);var i=e.end.row-e.start.row,s=n.splice(i,n.length),o=i?t.column:t.column-e.start.column;n.push(s[0].substring(0,o)),s[0]=s[0].substr(o);var u={start:f(t),end:r,lines:s,action:e.action};return u}function b(e,t){t=l(t);for(var n=e.length;n--;){var r=e[n];for(var i=0;i<r.length;i++){var s=r[i],o=v(s,t);t=o[0],o.length!=2&&(o[2]?(r.splice(i+1,1,o[1],o[2]),i++):o[1]||(r.splice(i,1),i--))}r.length||e.splice(n,1)}return e}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];for(var i=0;i<r.length;i++)b(e,r[i])}}var r=function(){this.$maxRev=0,this.$fromUndo=!1,this.reset()};(function(){this.addSession=function(e){this.$session=e},this.add=function(e,t,n){if(this.$fromUndo)return;if(e==this.$lastDelta)return;if(t===!1||!this.lastDeltas)this.lastDeltas=[],this.$undoStack.push(this.lastDeltas),e.id=this.$rev=++this.$maxRev;if(e.action=="remove"||e.action=="insert")this.$lastDelta=e;this.lastDeltas.push(e)},this.addSelection=function(e,t){this.selections.push({value:e,rev:t||this.$rev})},this.startNewGroup=function(){return this.lastDeltas=null,this.$rev},this.markIgnored=function(e,t){t==null&&(t=this.$rev+1);var n=this.$undoStack;for(var r=n.length;r--;){var i=n[r][0];if(i.id<=e)break;i.id<t&&(i.ignore=!0)}this.lastDeltas=null},this.getSelection=function(e,t){var n=this.selections;for(var r=n.length;r--;){var i=n[r];if(i.rev<e)return t&&(i=n[r+1]),i}},this.getRevision=function(){return this.$rev},this.getDeltas=function(e,t){t==null&&(t=this.$rev+1);var n=this.$undoStack,r=null,i=0;for(var s=n.length;s--;){var o=n[s][0];o.id<t&&!r&&(r=s+1);if(o.id<=e){i=s+1;break}}return n.slice(i,r)},this.getChangedRanges=function(e,t){t==null&&(t=this.$rev+1)},this.getChangedLines=function(e,t){t==null&&(t=this.$rev+1)},this.undo=function(e,t){this.lastDeltas=null;var n=this.$undoStack;if(!i(n,n.length))return;e||(e=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var r=n.pop(),s=null;return r&&r.length&&(s=e.undoChanges(r,t),this.$redoStack.push(r),this.$syncRev()),this.$fromUndo=!1,s},this.redo=function(e,t){this.lastDeltas=null,e||(e=this.$session),this.$fromUndo=!0;if(this.$redoStackBaseRev!=this.$rev){var n=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);w(this.$redoStack,n),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach(function(e){e[0].id=++this.$maxRev},this)}var r=this.$redoStack.pop(),i=null;return r&&(i=e.redoChanges(r,t),this.$undoStack.push(r),this.$syncRev()),this.$fromUndo=!1,i},this.$syncRev=function(){var e=this.$undoStack,t=e[e.length-1],n=t&&t[0].id||0;this.$redoStackBaseRev=n,this.$rev=n},this.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},this.canUndo=function(){return this.$undoStack.length>0},this.canRedo=function(){return this.$redoStack.length>0},this.bookmark=function(e){e==undefined&&(e=this.$rev),this.mark=e},this.isAtBookmark=function(){return this.$rev===this.mark},this.toJSON=function(){},this.fromJSON=function(){},this.hasUndo=this.canUndo,this.hasRedo=this.canRedo,this.isClean=this.isAtBookmark,this.markClean=this.bookmark,this.$prettyPrint=function(e){return e?c(e):c(this.$undoStack)+"\n---\n"+c(this.$redoStack)}}).call(r.prototype);var s=e("./range").Range,o=s.comparePoints,u=s.comparePoints;t.UndoManager=r}),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("../lib/dom"),i=e("../lib/oop"),s=e("../lib/lang"),o=e("../lib/event_emitter").EventEmitter,u=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$cells=[]};(function(){i.implement(this,o),this.setSession=function(e){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=e,e&&e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var n=e[t],r=n.row,i=this.$annotations[r];i||(i=this.$annotations[r]={text:[]});var o=n.text;o=o?s.escapeHTML(o):n.html||"",i.text.indexOf(o)===-1&&i.text.push(o);var u=n.type;u=="error"?i.className=" ace_error":u=="warning"&&i.className!=" ace_error"?i.className=" ace_warning":u=="info"&&!i.className&&(i.className=" ace_info")}},this.$updateAnnotations=function(e){if(!this.$annotations.length)return;var t=e.start.row,n=e.end.row-t;if(n!==0)if(e.action=="remove")this.$annotations.splice(t,n+1,null);else{var r=new Array(n+1);r.unshift(t,1),this.$annotations.splice.apply(this.$annotations,r)}},this.update=function(e){var t=this.session,n=e.firstRow,i=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1),s=t.getNextFoldLine(n),o=s?s.start.row:Infinity,u=this.$showFoldWidgets&&t.foldWidgets,a=t.$breakpoints,f=t.$decorations,l=t.$firstLineNumber,c=0,h=t.gutterRenderer||this.$renderer,p=null,d=-1,v=n;for(;;){v>o&&(v=s.end.row+1,s=t.getNextFoldLine(v,s),o=s?s.start.row:Infinity);if(v>i){while(this.$cells.length>d+1)p=this.$cells.pop(),this.element.removeChild(p.element);break}p=this.$cells[++d],p||(p={element:null,textNode:null,foldWidget:null},p.element=r.createElement("div"),p.textNode=document.createTextNode(""),p.element.appendChild(p.textNode),this.element.appendChild(p.element),this.$cells[d]=p);var m="ace_gutter-cell ";a[v]&&(m+=a[v]),f[v]&&(m+=f[v]),this.$annotations[v]&&(m+=this.$annotations[v].className),p.element.className!=m&&(p.element.className=m);var g=t.getRowLength(v)*e.lineHeight+"px";g!=p.element.style.height&&(p.element.style.height=g);if(u){var y=u[v];y==null&&(y=u[v]=t.getFoldWidget(v))}if(y){p.foldWidget||(p.foldWidget=r.createElement("span"),p.element.appendChild(p.foldWidget));var m="ace_fold-widget ace_"+y;y=="start"&&v==o&&v<s.end.row?m+=" ace_closed":m+=" ace_open",p.foldWidget.className!=m&&(p.foldWidget.className=m);var g=e.lineHeight+"px";p.foldWidget.style.height!=g&&(p.foldWidget.style.height=g)}else p.foldWidget&&(p.element.removeChild(p.foldWidget),p.foldWidget=null);var b=c=h?h.getText(t,v):v+l;b!==p.textNode.data&&(p.textNode.data=b),v++}this.element.style.height=e.minHeight+"px";if(this.$fixedWidth||t.$useWrapMode)c=t.getLength()+l;var w=h?h.getWidth(t,c,e):c.toString().length*e.characterWidth,E=this.$padding||this.$computePadding();w+=E.left+E.right,w!==this.gutterWidth&&!isNaN(w)&&(this.gutterWidth=w,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",w))},this.$fixedWidth=!1,this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return""},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?r.addCssClass(this.element,"ace_folding-enabled"):r.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=r.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(e.paddingLeft)+1||0,this.$padding.right=parseInt(e.paddingRight)||0,this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),n=this.element.getBoundingClientRect();if(e.x<t.left+n.left)return"markers";if(this.$showFoldWidgets&&e.x>n.right-t.right)return"foldWidgets"}}).call(u.prototype),t.Gutter=u}),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],function(e,t,n){"use strict";var r=e("../range").Range,i=e("../lib/dom"),s=function(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){function e(e,t,n,r){return(e?1:0)|(t?2:0)|(n?4:0)|(r?8:0)}this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.update=function(e){if(!e)return;this.config=e;var t=[];for(var n in this.markers){var r=this.markers[n];if(!r.range){r.update(t,this,this.session,e);continue}var i=r.range.clipRows(e.firstRow,e.lastRow);if(i.isEmpty())continue;i=i.toScreenRange(this.session);if(r.renderer){var s=this.$getTop(i.start.row,e),o=this.$padding+(this.session.$bidiHandler.isBidiRow(i.start.row)?this.session.$bidiHandler.getPosLeft(i.start.column):i.start.column*e.characterWidth);r.renderer(t,i,o,s,e)}else r.type=="fullLine"?this.drawFullLineMarker(t,i,r.clazz,e):r.type=="screenLine"?this.drawScreenLineMarker(t,i,r.clazz,e):i.isMultiLine()?r.type=="text"?this.drawTextMarker(t,i,r.clazz,e):this.drawMultiLineMarker(t,i,r.clazz,e):this.session.$bidiHandler.isBidiRow(i.start.row)?this.drawBidiSingleLineMarker(t,i,r.clazz+" ace_start"+" ace_br15",e):this.drawSingleLineMarker(t,i,r.clazz+" ace_start"+" ace_br15",e)}this.element.innerHTML=t.join("")},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(t,n,i,s,o){var u=this.session,a=n.start.row,f=n.end.row,l=a,c=0,h=0,p=u.getScreenLastRowColumn(l),d=null,v=new r(l,n.start.column,l,h);for(;l<=f;l++)v.start.row=v.end.row=l,v.start.column=l==a?n.start.column:u.getRowWrapIndent(l),v.end.column=p,c=h,h=p,p=l+1<f?u.getScreenLastRowColumn(l+1):l==f?0:n.end.column,d=i+(l==a?" ace_start":"")+" ace_br"+e(l==a||l==a+1&&n.start.column,c<h,h>p,l==f),this.session.$bidiHandler.isBidiRow(l)?this.drawBidiSingleLineMarker(t,v,d,s,l==f?0:1,o):this.drawSingleLineMarker(t,v,d,s,l==f?0:1,o)},this.drawMultiLineMarker=function(e,t,n,r,i){var s=this.$padding,o,u,a;i=i||"";if(this.session.$bidiHandler.isBidiRow(t.start.row)){var f=t.clone();f.end.row=f.start.row,f.end.column=this.session.getLine(f.start.row).length,this.drawBidiSingleLineMarker(e,f,n+" ace_br1 ace_start",r,null,i)}else o=r.lineHeight,u=this.$getTop(t.start.row,r),a=s+t.start.column*r.characterWidth,e.push("<div class='",n," ace_br1 ace_start' style='","height:",o,"px;","right:0;","top:",u,"px;","left:",a,"px;",i,"'></div>");if(this.session.$bidiHandler.isBidiRow(t.end.row)){var f=t.clone();f.start.row=f.end.row,f.start.column=0,this.drawBidiSingleLineMarker(e,f,n+" ace_br12",r,null,i)}else{var l=t.end.column*r.characterWidth;o=r.lineHeight,u=this.$getTop(t.end.row,r),e.push("<div class='",n," ace_br12' style='","height:",o,"px;","width:",l,"px;","top:",u,"px;","left:",s,"px;",i,"'></div>")}o=(t.end.row-t.start.row-1)*r.lineHeight;if(o<=0)return;u=this.$getTop(t.start.row+1,r);var c=(t.start.column?1:0)|(t.end.column?0:8);e.push("<div class='",n,c?" ace_br"+c:"","' style='","height:",o,"px;","right:0;","top:",u,"px;","left:",s,"px;",i,"'></div>")},this.drawSingleLineMarker=function(e,t,n,r,i,s){var o=r.lineHeight,u=(t.end.column+(i||0)-t.start.column)*r.characterWidth,a=this.$getTop(t.start.row,r),f=this.$padding+t.start.column*r.characterWidth;e.push("<div class='",n,"' style='","height:",o,"px;","width:",u,"px;","top:",a,"px;","left:",f,"px;",s||"","'></div>")},this.drawBidiSingleLineMarker=function(e,t,n,r,i,s){var o=r.lineHeight,u=this.$getTop(t.start.row,r),a=this.$padding,f=this.session.$bidiHandler.getSelections(t.start.column,t.end.column);f.forEach(function(t){e.push("<div class='",n,"' style='","height:",o,"px;","width:",t.width+(i||0),"px;","top:",u,"px;","left:",a+t.left,"px;",s||"","'></div>")})},this.drawFullLineMarker=function(e,t,n,r,i){var s=this.$getTop(t.start.row,r),o=r.lineHeight;t.start.row!=t.end.row&&(o+=this.$getTop(t.end.row,r)-s),e.push("<div class='",n,"' style='","height:",o,"px;","top:",s,"px;","left:0;right:0;",i||"","'></div>")},this.drawScreenLineMarker=function(e,t,n,r,i){var s=this.$getTop(t.start.row,r),o=r.lineHeight;e.push("<div class='",n,"' style='","height:",o,"px;","top:",s,"px;","left:0;right:0;",i||"","'></div>")}}).call(s.prototype),t.Marker=s}),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../lib/dom"),s=e("../lib/lang"),o=e("../lib/useragent"),u=e("../lib/event_emitter").EventEmitter,a=function(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this)};(function(){r.implement(this,u),this.EOF_CHAR="\u00b6",this.EOL_CHAR_LF="\u00ac",this.EOL_CHAR_CRLF="\u00a4",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="\u2014",this.SPACE_CHAR="\u00b7",this.$padding=0,this.MAX_LINE_LENGTH=1e4,this.$updateEolChar=function(){var e=this.session.doc.getNewLineCharacter()=="\n"?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=e)return this.EOL_CHAR=e,!0},this.setPadding=function(e){this.$padding=e,this.element.style.padding="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){this.session=e,e&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(e){return this.showInvisibles==e?!1:(this.showInvisibles=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides==e?!1:(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;var t=this.$tabStrings=[0];for(var n=1;n<e+1;n++)this.showInvisibles?t.push("<span class='ace_invisible ace_invisible_tab'>"+s.stringRepeat(this.TAB_CHAR,n)+"</span>"):t.push(s.stringRepeat(" ",n));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var r="ace_indent-guide",i="",o="";if(this.showInvisibles){r+=" ace_invisible",i=" ace_invisible_space",o=" ace_invisible_tab";var u=s.stringRepeat(this.SPACE_CHAR,this.tabSize),a=s.stringRepeat(this.TAB_CHAR,this.tabSize)}else var u=s.stringRepeat(" ",this.tabSize),a=u;this.$tabStrings[" "]="<span class='"+r+i+"'>"+u+"</span>",this.$tabStrings["	"]="<span class='"+r+o+"'>"+a+"</span>"}},this.updateLines=function(e,t,n){(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)&&this.scrollLines(e),this.config=e;var r=Math.max(t,e.firstRow),i=Math.min(n,e.lastRow),s=this.element.childNodes,o=0;for(var u=e.firstRow;u<r;u++){var a=this.session.getFoldLine(u);if(a){if(a.containsRow(r)){r=a.start.row;break}u=a.end.row}o++}var u=r,a=this.session.getNextFoldLine(u),f=a?a.start.row:Infinity;for(;;){u>f&&(u=a.end.row+1,a=this.session.getNextFoldLine(u,a),f=a?a.start.row:Infinity);if(u>i)break;var l=s[o++];if(l){var c=[];this.$renderLine(c,u,!this.$useLineGroups(),u==f?a:!1),l.style.height=e.lineHeight*this.session.getRowLength(u)+"px",l.innerHTML=c.join("")}u++}},this.scrollLines=function(e){var t=this.config;this.config=e;if(!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);var n=this.element;if(t.firstRow<e.firstRow)for(var r=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);r>0;r--)n.removeChild(n.firstChild);if(t.lastRow>e.lastRow)for(var r=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);r>0;r--)n.removeChild(n.lastChild);if(e.firstRow<t.firstRow){var i=this.$renderLinesFragment(e,e.firstRow,t.firstRow-1);n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)}if(e.lastRow>t.lastRow){var i=this.$renderLinesFragment(e,t.lastRow+1,e.lastRow);n.appendChild(i)}},this.$renderLinesFragment=function(e,t,n){var r=this.element.ownerDocument.createDocumentFragment(),s=t,o=this.session.getNextFoldLine(s),u=o?o.start.row:Infinity;for(;;){s>u&&(s=o.end.row+1,o=this.session.getNextFoldLine(s,o),u=o?o.start.row:Infinity);if(s>n)break;var a=i.createElement("div"),f=[];this.$renderLine(f,s,!1,s==u?o:!1),a.innerHTML=f.join("");if(this.$useLineGroups())a.className="ace_line_group",r.appendChild(a),a.style.height=e.lineHeight*this.session.getRowLength(s)+"px";else while(a.firstChild)r.appendChild(a.firstChild);s++}return r},this.update=function(e){this.config=e;var t=[],n=e.firstRow,r=e.lastRow,i=n,s=this.session.getNextFoldLine(i),o=s?s.start.row:Infinity;for(;;){i>o&&(i=s.end.row+1,s=this.session.getNextFoldLine(i,s),o=s?s.start.row:Infinity);if(i>r)break;this.$useLineGroups()&&t.push("<div class='ace_line_group' style='height:",e.lineHeight*this.session.getRowLength(i),"px'>"),this.$renderLine(t,i,!1,i==o?s:!1),this.$useLineGroups()&&t.push("</div>"),i++}this.element.innerHTML=t.join("")},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,t,n,r){var i=this,o=/\t|&|<|>|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=function(e,n,r,o,u){if(n)return i.showInvisibles?"<span class='ace_invisible ace_invisible_space'>"+s.stringRepeat(i.SPACE_CHAR,e.length)+"</span>":e;if(e=="&")return"&#38;";if(e=="<")return"&#60;";if(e==">")return"&#62;";if(e=="	"){var a=i.session.getScreenTabSize(t+o);return t+=a-1,i.$tabStrings[a]}if(e=="\u3000"){var f=i.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",l=i.showInvisibles?i.SPACE_CHAR:"";return t+=1,"<span class='"+f+"' style='width:"+i.config.characterWidth*2+"px'>"+l+"</span>"}return r?"<span class='ace_invisible ace_invisible_space ace_invalid'>"+i.SPACE_CHAR+"</span>":(t+=1,"<span class='ace_cjk' style='width:"+i.config.characterWidth*2+"px'>"+e+"</span>")},a=r.replace(o,u);if(!this.$textToken[n.type]){var f="ace_"+n.type.replace(/\./g," ace_"),l="";n.type=="fold"&&(l=" style='width:"+n.value.length*this.config.characterWidth+"px;' "),e.push("<span class='",f,"'",l,">",a,"</span>")}else e.push(a);return t+r.length},this.renderIndentGuide=function(e,t,n){var r=t.search(this.$indentGuideRe);return r<=0||r>=n?t:t[0]==" "?(r-=r%this.tabSize,e.push(s.stringRepeat(this.$tabStrings[" "],r/this.tabSize)),t.substr(r)):t[0]=="	"?(e.push(s.stringRepeat(this.$tabStrings["	"],r)),t.substr(r)):t},this.$renderWrappedLine=function(e,t,n,r){var i=0,o=0,u=n[0],a=0;for(var f=0;f<t.length;f++){var l=t[f],c=l.value;if(f==0&&this.displayIndentGuides){i=c.length,c=this.renderIndentGuide(e,c,u);if(!c)continue;i-=c.length}if(i+c.length<u)a=this.$renderToken(e,a,l,c),i+=c.length;else{while(i+c.length>=u)a=this.$renderToken(e,a,l,c.substring(0,u-i)),c=c.substring(u-i),i=u,r||e.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),e.push(s.stringRepeat("\u00a0",n.indent)),o++,a=0,u=n[o]||Number.MAX_VALUE;c.length!=0&&(i+=c.length,a=this.$renderToken(e,a,l,c))}}},this.$renderSimpleLine=function(e,t){var n=0,r=t[0],i=r.value;this.displayIndentGuides&&(i=this.renderIndentGuide(e,i)),i&&(n=this.$renderToken(e,n,r,i));for(var s=1;s<t.length;s++){r=t[s],i=r.value;if(n+i.length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(e,n,r,i);n=this.$renderToken(e,n,r,i)}},this.$renderOverflowMessage=function(e,t,n,r){this.$renderToken(e,t,n,r.slice(0,this.MAX_LINE_LENGTH-t)),e.push("<span style='position:absolute;right:0' class='ace_inline_button ace_keyword ace_toggle_wrap'>&lt;click to see more...&gt;</span>")},this.$renderLine=function(e,t,n,r){!r&&r!=0&&(r=this.session.getFoldLine(t));if(r)var i=this.$getFoldLineTokens(t,r);else var i=this.session.getTokens(t);n||e.push("<div class='ace_line' style='height:",this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(t)),"px'>");if(i.length){var s=this.session.getRowSplitData(t);s&&s.length?this.$renderWrappedLine(e,i,s,n):this.$renderSimpleLine(e,i)}this.showInvisibles&&(r&&(t=r.end.row),e.push("<span class='ace_invisible ace_invisible_eol'>",t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>")),n||e.push("</div>")},this.$getFoldLineTokens=function(e,t){function i(e,t,n){var i=0,s=0;while(s+e[i].value.length<t){s+=e[i].value.length,i++;if(i==e.length)return}if(s!=t){var o=e[i].value.substring(t-s);o.length>n-t&&(o=o.substring(0,n-t)),r.push({type:e[i].type,value:o}),s=t+o.length,i+=1}while(s<n&&i<e.length){var o=e[i].value;o.length+s>n?r.push({type:e[i].type,value:o.substring(0,n-s)}):r.push(e[i]),s+=o.length,i+=1}}var n=this.session,r=[],s=n.getTokens(e);return t.walk(function(e,t,o,u,a){e!=null?r.push({type:"fold",value:e}):(a&&(s=n.getTokens(t)),s.length&&i(s,u,o))},t.end.row,this.session.getLine(t.end.row).length),r},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode),delete this.$measureNode}}).call(a.prototype),t.Text=a}),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],function(e,t,n){"use strict";var r=e("../lib/dom"),i,s=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),i===undefined&&(i=!("opacity"in this.element.style)),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),r.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=(i?this.$updateVisibility:this.$updateOpacity).bind(this)};(function(){this.$updateVisibility=function(e){var t=this.cursors;for(var n=t.length;n--;)t[n].style.visibility=e?"":"hidden"},this.$updateOpacity=function(e){var t=this.cursors;for(var n=t.length;n--;)t[n].style.opacity=e?"":"0"},this.$startCssAnimation=function(){var e=this.cursors;for(var t=e.length;t--;)e[t].style.animationDuration=this.blinkInterval+"ms";setTimeout(function(){r.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},this.$stopCssAnimation=function(){r.removeCssClass(this.element,"ace_animate-blinking")},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e!=this.smoothBlinking&&!i&&(this.smoothBlinking=e,r.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.$updateCursors=this.$updateOpacity.bind(this),this.restartTimer())},this.addCursor=function(){var e=r.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,r.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,r.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var e=this.$updateCursors;clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&r.removeCssClass(this.element,"ace_smooth-blinking"),e(!0);if(!this.isBlinking||!this.blinkInterval||!this.isVisible)return;this.smoothBlinking&&setTimeout(function(){r.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));if(r.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var t=function(){this.timeoutId=setTimeout(function(){e(!1)},.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){e(!0),t()},this.blinkInterval),t()}},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var n=this.session.documentToScreenPosition(e),r=this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e.row)?this.session.$bidiHandler.getPosLeft(n.column):n.column*this.config.characterWidth),i=(n.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight;return{left:r,top:i}},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,n=0,r=0;if(t===undefined||t.length===0)t=[{cursor:null}];for(var n=0,i=t.length;n<i;n++){var s=this.getPixelPosition(t[n].cursor,!0);if((s.top>e.height+e.offset||s.top<0)&&n>1)continue;var o=(this.cursors[r++]||this.addCursor()).style;this.drawCursor?this.drawCursor(o,s,e,t[n],this.session):(o.left=s.left+"px",o.top=s.top+"px",o.width=e.characterWidth+"px",o.height=e.lineHeight+"px")}while(this.cursors.length>r)this.removeCursor();var u=this.session.getOverwrite();this.$setOverwrite(u),this.$pixelPos=s,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?r.addCssClass(this.element,"ace_overwrite-cursors"):r.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(s.prototype),t.Cursor=s}),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/dom"),s=e("./lib/event"),o=e("./lib/event_emitter").EventEmitter,u=32768,a=function(e){this.element=i.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=i.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,s.addListener(this.element,"scroll",this.onScroll.bind(this)),s.addListener(this.element,"mousedown",s.preventDefault)};(function(){r.implement(this,o),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1}}).call(a.prototype);var f=function(e,t){a.call(this,e),this.scrollTop=0,this.scrollHeight=0,t.$scrollbarWidth=this.width=i.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};r.inherits(f,a),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){this.scrollTop=this.element.scrollTop;if(this.coeff!=1){var e=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-e)/(this.coeff-e)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=this.setScrollHeight=function(e){this.scrollHeight=e,e>u?(this.coeff=u/e,e=u):this.coeff!=1&&(this.coeff=1),this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=e,this.element.scrollTop=e*this.coeff)}}.call(f.prototype);var l=function(e,t){a.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};r.inherits(l,a),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(l.prototype),t.ScrollBar=f,t.ScrollBarV=f,t.ScrollBarH=l,t.VScrollBar=f,t.HScrollBar=l}),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],function(e,t,n){"use strict";var r=e("./lib/event"),i=function(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.window=t||window};(function(){this.schedule=function(e){this.changes=this.changes|e;if(this.changes){var t=this;r.nextFrame(function(e){var n=t.changes;n&&(r.blockIdle(100),t.changes=0,t.onRender(n)),t.changes&&t.schedule()})}}}).call(i.prototype),t.RenderLoop=i}),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/lib/useragent","ace/lib/event_emitter"],function(e,t,n){var r=e("../lib/oop"),i=e("../lib/dom"),s=e("../lib/lang"),o=e("../lib/event"),u=e("../lib/useragent"),a=e("../lib/event_emitter").EventEmitter,f=256,l=typeof ResizeObserver=="function",c=200,h=t.FontMetrics=function(e){this.el=i.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=i.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=i.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),this.$measureNode.innerHTML=s.stringRepeat("X",f),this.$characterSize={width:0,height:0},l?this.$addObserver():this.checkForSizeChanges()};(function(){r.implement(this,a),this.$characterSize={width:0,height:0},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",u.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(e){e===undefined&&(e=this.$measureSizes());if(e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$addObserver=function(){var e=this;this.$observer=new window.ResizeObserver(function(t){var n=t[0].contentRect;e.checkForSizeChanges({height:n.height,width:n.width/f})}),this.$observer.observe(this.$measureNode)},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=o.onIdle(function t(){e.checkForSizeChanges(),o.onIdle(t,500)},500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(e){var t={height:(e||this.$measureNode).clientHeight,width:(e||this.$measureNode).clientWidth/f};return t.width===0||t.height===0?null:t},this.$measureCharWidth=function(e){this.$main.innerHTML=s.stringRepeat(e,f);var t=this.$main.getBoundingClientRect();return t.width/f},this.getCharacterWidth=function(e){var t=this.charSizes[e];return t===undefined&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},this.$getZoom=function e(t){return t?(window.getComputedStyle(t).zoom||1)*e(t.parentElement):1},this.$initTransformMeasureNodes=function(){var e=function(e,t){return["div",{style:"position: absolute;top:"+e+"px;left:"+t+"px;"}]};this.els=i.buildDom([e(0,0),e(c,0),e(0,c),e(c,c)],this.el)},this.transformCoordinates=function(e,t){function r(e,t,n){var r=e[1]*t[0]-e[0]*t[1];return[(-t[1]*n[0]+t[0]*n[1])/r,(+e[1]*n[0]-e[0]*n[1])/r]}function i(e,t){return[e[0]-t[0],e[1]-t[1]]}function s(e,t){return[e[0]+t[0],e[1]+t[1]]}function o(e,t){return[e*t[0],e*t[1]]}function u(e){var t=e.getBoundingClientRect();return[t.left,t.top]}if(e){var n=this.$getZoom(this.el);e=o(1/n,e)}this.els||this.$initTransformMeasureNodes();var a=u(this.els[0]),f=u(this.els[1]),l=u(this.els[2]),h=u(this.els[3]),p=r(i(h,f),i(h,l),i(s(f,l),s(h,a))),d=o(1+p[0],i(f,a)),v=o(1+p[1],i(l,a));if(t){var m=t,g=p[0]*m[0]/c+p[1]*m[1]/c+1,y=s(o(m[0],d),o(m[1],v));return s(o(1/g/c,y),a)}var b=i(e,a),w=r(i(d,o(p[0],b)),i(v,o(p[1],b)),b);return o(c,w)}}).call(h.prototype)}),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/dom"),s=e("./config"),o=e("./lib/useragent"),u=e("./layer/gutter").Gutter,a=e("./layer/marker").Marker,f=e("./layer/text").Text,l=e("./layer/cursor").Cursor,c=e("./scrollbar").HScrollBar,h=e("./scrollbar").VScrollBar,p=e("./renderloop").RenderLoop,d=e("./layer/font_metrics").FontMetrics,v=e("./lib/event_emitter").EventEmitter,m='.ace_editor {position: relative;overflow: hidden;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}[ace_nocontext=true] {transform: none!important;filter: none!important;perspective: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_text-input-ios {position: absolute !important;top: -100000px !important;left: -100000px !important;}';i.importCssString(m,"ace_editor.css");var g=function(e,t){var n=this;this.container=e||i.createElement("div"),i.addCssClass(this.container,"ace_editor"),this.setTheme(t),this.$gutter=i.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=i.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=i.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new u(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new a(this.content);var r=this.$textLayer=new f(this.content);this.canvas=r.element,this.$markerFront=new a(this.content),this.$cursorLayer=new l(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new h(this.container,this),this.scrollBarH=new c(this.container,this),this.scrollBarV.addEventListener("scroll",function(e){n.$scrollAnimation||n.session.setScrollTop(e.data-n.scrollMargin.top)}),this.scrollBarH.addEventListener("scroll",function(e){n.$scrollAnimation||n.session.setScrollLeft(e.data-n.scrollMargin.left)}),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new d(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",function(e){n.updateCharacterSize(),n.onResize(!0,n.gutterWidth,n.$size.width,n.$size.height),n._signal("changeCharacterSize",e)}),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$loop=new p(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),s.resetOptions(this),s._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,r.implement(this,v),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e);if(!e)return;this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode)},this.updateLines=function(e,t,n){t===undefined&&(t=Infinity),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t};if(this.$changedLines.lastRow<this.layerConfig.firstRow){if(!n)return;this.$changedLines.lastRow=this.layerConfig.lastRow}if(this.$changedLines.firstRow>this.layerConfig.lastRow)return;this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,n,r){if(this.resizing>2)return;this.resizing>0?this.resizing++:this.resizing=e?1:0;var i=this.container;r||(r=i.clientHeight||i.scrollHeight),n||(n=i.clientWidth||i.scrollWidth);var s=this.$updateCachedSize(e,t,n,r);if(!this.$size.scrollerHeight||!n&&!r)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(s|this.$changes,!0):this.$loop.schedule(s|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null},this.$updateCachedSize=function(e,t,n,r){r-=this.$extraHeight||0;var i=0,s=this.$size,o={width:s.width,height:s.height,scrollerHeight:s.scrollerHeight,scrollerWidth:s.scrollerWidth};r&&(e||s.height!=r)&&(s.height=r,i|=this.CHANGE_SIZE,s.scrollerHeight=s.height,this.$horizScroll&&(s.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",i|=this.CHANGE_SCROLL);if(n&&(e||s.width!=n)){i|=this.CHANGE_SIZE,s.width=n,t==null&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,this.scrollBarH.element.style.left=this.scroller.style.left=t+"px",s.scrollerWidth=Math.max(0,n-t-this.scrollBarV.getWidth()),this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px",this.scroller.style.bottom=this.scrollBarH.getHeight()+"px";if(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)i|=this.CHANGE_FULL}return s.$dirty=!n||!r,i&&this._signal("resize",o),i},this.onGutterResize=function(){var e=this.$showGutter?this.$gutter.offsetWidth:0;e!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,e,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):(this.$computeLayerConfig(),this.$loop.schedule(this.CHANGE_MARKER))},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-this.$padding*2,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e),this.session.$bidiHandler.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updateGutterLineHighlight=function(){var e=this.$cursorLayer.$pixelPos,t=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var n=this.session.selection.getCursor();n.column=0,e=this.$cursorLayer.getPixelPosition(n,!0),t*=this.session.getRowLength(n.row)}this.$gutterLineHighlight.style.top=e.top-this.layerConfig.offset+"px",this.$gutterLineHighlight.style.height=t+"px"},this.$updatePrintMargin=function(){if(!this.$showPrintMargin&&!this.$printMarginEl)return;if(!this.$printMarginEl){var e=i.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=i.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&this.session.$wrap==-1&&this.adjustWrapLimit()},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){var e=this.textarea.style;if(!this.$keepTextAreaAtCursor){e.left="-100px";return}var t=this.layerConfig,n=this.$cursorLayer.$pixelPos.top,r=this.$cursorLayer.$pixelPos.left;n-=t.offset;var i=this.lineHeight;if(n<0||n>t.height-i){e.top=e.left="0";return}var s=this.characterWidth;if(this.$composition){var o=this.textarea.value.replace(/^\x01+/,"");s*=this.session.$getStringScreenWidth(o)[0]+2,i+=2}r-=this.scrollLeft,r>this.$size.scrollerWidth-s&&(r=this.$size.scrollerWidth-s),r+=this.gutterWidth,e.height=i+"px",e.width=s+"px",e.left=Math.min(r,this.$size.scrollerWidth-s)+"px",e.top=Math.min(n,this.$size.height-i)+"px"},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(this.layerConfig.offset===0?0:1)},this.getLastFullyVisibleRow=function(){var e=this.layerConfig,t=e.lastRow,n=this.session.documentToScreenRow(t,0)*e.lineHeight;return n-this.session.getScrollTop()>e.height-e.lineHeight?t-1:t},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,n,r){var i=this.scrollMargin;i.top=e|0,i.bottom=t|0,i.right=r|0,i.left=n|0,i.v=i.top+i.bottom,i.h=i.left+i.right,i.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-i.top),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,t){this.$changes&&(e|=this.$changes,this.$changes=0);if(!this.session||!this.container.offsetWidth||this.$frozen||!e&&!t){this.$changes|=e;return}if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender"),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var n=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){e|=this.$computeLayerConfig();if(n.firstRow!=this.layerConfig.firstRow&&n.firstRowScreen==this.layerConfig.firstRowScreen){var r=this.scrollTop+(n.firstRow-this.layerConfig.firstRow)*this.lineHeight;r>0&&(this.scrollTop=r,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig())}n=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),this.$gutterLayer.element.style.marginTop=-n.offset+"px",this.content.style.marginTop=-n.offset+"px",this.content.style.width=n.width+2*this.$padding+"px",this.content.style.height=n.minHeight+"px"}e&this.CHANGE_H_SCROLL&&(this.content.style.marginLeft=-this.scrollLeft+"px",this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left");if(e&this.CHANGE_FULL){this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this._signal("afterRender");return}if(e&this.CHANGE_SCROLL){e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(n):this.$textLayer.scrollLines(n),this.$showGutter&&this.$gutterLayer.update(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this.$moveTextAreaToCursor(),this._signal("afterRender");return}e&this.CHANGE_TEXT?(this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(n):(e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(n),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(n),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(n),this._signal("afterRender")},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,n=Math.min(t,Math.max((this.$minLines||1)*this.lineHeight,e))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(n+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&n>this.$maxPixelHeight&&(n=this.$maxPixelHeight);var r=n<=2*this.lineHeight,i=!r&&e>t;if(n!=this.desiredHeight||this.$size.height!=this.desiredHeight||i!=this.$vScroll){i!=this.$vScroll&&(this.$vScroll=i,this.scrollBarV.setVisible(i));var s=this.container.clientWidth;this.container.style.height=n+"px",this.$updateCachedSize(!0,this.$gutterWidth,s,n),this.desiredHeight=n,this._signal("autosize")}},this.$computeLayerConfig=function(){var e=this.session,t=this.$size,n=t.height<=2*this.lineHeight,r=this.session.getScreenLength(),i=r*this.lineHeight,s=this.$getLongestLine(),o=!n&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-s-2*this.$padding<0),u=this.$horizScroll!==o;u&&(this.$horizScroll=o,this.scrollBarH.setVisible(o));var a=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var f=this.scrollTop%this.lineHeight,l=t.scrollerHeight+this.lineHeight,c=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;i+=c;var h=this.scrollMargin;this.session.setScrollTop(Math.max(-h.top,Math.min(this.scrollTop,i-t.scrollerHeight+h.bottom))),this.session.setScrollLeft(Math.max(-h.left,Math.min(this.scrollLeft,s+2*this.$padding-t.scrollerWidth+h.right)));var p=!n&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-i+c<0||this.scrollTop>h.top),d=a!==p;d&&(this.$vScroll=p,this.scrollBarV.setVisible(p));var v=Math.ceil(l/this.lineHeight)-1,m=Math.max(0,Math.round((this.scrollTop-f)/this.lineHeight)),g=m+v,y,b,w=this.lineHeight;m=e.screenToDocumentRow(m,0);var E=e.getFoldLine(m);E&&(m=E.start.row),y=e.documentToScreenRow(m,0),b=e.getRowLength(m)*w,g=Math.min(e.screenToDocumentRow(g,0),e.getLength()-1),l=t.scrollerHeight+e.getRowLength(g)*w+b,f=this.scrollTop-y*w;var S=0;if(this.layerConfig.width!=s||u)S=this.CHANGE_H_SCROLL;if(u||d)S=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),d&&(s=this.$getLongestLine());return this.layerConfig={width:s,padding:this.$padding,firstRow:m,firstRowScreen:y,lastRow:g,lineHeight:w,characterWidth:this.characterWidth,minHeight:l,maxHeight:i,offset:f,gutterOffset:w?Math.max(0,Math.ceil((f+t.height-t.scrollerHeight)/w)):0,height:this.$size.scrollerHeight},S},this.$updateLines=function(){if(!this.$changedLines)return;var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var n=this.layerConfig;if(e>n.lastRow+1)return;if(t<n.firstRow)return;if(t===Infinity){this.$showGutter&&this.$gutterLayer.update(n),this.$textLayer.update(n);return}return this.$textLayer.updateLines(n,e,t),!0},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),this.$textLayer&&e>this.$textLayer.MAX_LINE_LENGTH&&(e=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,n){this.scrollCursorIntoView(e,n),this.scrollCursorIntoView(t,n)},this.scrollCursorIntoView=function(e,t,n){if(this.$size.scrollerHeight===0)return;var r=this.$cursorLayer.getPixelPosition(e),i=r.left,s=r.top,o=n&&n.top||0,u=n&&n.bottom||0,a=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;a+o>s?(t&&a+o>s+this.lineHeight&&(s-=t*this.$size.scrollerHeight),s===0&&(s=-this.scrollMargin.top),this.session.setScrollTop(s)):a+this.$size.scrollerHeight-u<s+this.lineHeight&&(t&&a+this.$size.scrollerHeight-u<s-this.lineHeight&&(s+=t*this.$size.scrollerHeight),this.session.setScrollTop(s+this.lineHeight-this.$size.scrollerHeight));var f=this.scrollLeft;f>i?(i<this.$padding+2*this.layerConfig.characterWidth&&(i=-this.scrollMargin.left),this.session.setScrollLeft(i)):f+this.$size.scrollerWidth<i+this.characterWidth?this.session.setScrollLeft(Math.round(i+this.characterWidth-this.$size.scrollerWidth)):f<=this.$padding&&i-f<this.characterWidth&&this.session.setScrollLeft(0)},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){typeof e=="number"&&(e={row:e,column:0});var n=this.$cursorLayer.getPixelPosition(e),r=this.$size.scrollerHeight-this.lineHeight,i=n.top-r*(t||0);return this.session.setScrollTop(i),i},this.STEPS=8,this.$calcSteps=function(e,t){var n=0,r=this.STEPS,i=[],s=function(e,t,n){return n*(Math.pow(e-1,3)+1)+t};for(n=0;n<r;++n)i.push(s(n/this.STEPS,e,t-e));return i},this.scrollToLine=function(e,t,n,r){var i=this.$cursorLayer.getPixelPosition({row:e,column:0}),s=i.top;t&&(s-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(s),n!==!1&&this.animateScrolling(o,r)},this.animateScrolling=function(e,t){var n=this.scrollTop;if(!this.$animatedScroll)return;var r=this;if(e==n)return;if(this.$scrollAnimation){var i=this.$scrollAnimation.steps;if(i.length){e=i[0];if(e==n)return}}var s=r.$calcSteps(e,n);this.$scrollAnimation={from:e,to:n,steps:s},clearInterval(this.$timer),r.session.setScrollTop(s.shift()),r.session.$scrollTop=n,this.$timer=setInterval(function(){s.length?(r.session.setScrollTop(s.shift()),r.session.$scrollTop=n):n!=null?(r.session.$scrollTop=-1,r.session.setScrollTop(n),n=null):(r.$timer=clearInterval(r.$timer),r.$scrollAnimation=null,t&&t())},10)},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){if(t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top)return!0;if(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom)return!0;if(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left)return!0;if(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right)return!0},this.pixelToScreenCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var r=this.$fontMetrics.transformCoordinates([e,t]);e=r[1]-this.gutterWidth,t=r[0]}else n=this.scroller.getBoundingClientRect();var i=e+this.scrollLeft-n.left-this.$padding,s=i/this.characterWidth,o=Math.floor((t+this.scrollTop-n.top)/this.lineHeight),u=this.$blockCursor?Math.floor(s):Math.round(s);return{row:o,column:u,side:s-u>0?1:-1,offsetX:i}},this.screenToTextCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var r=this.$fontMetrics.transformCoordinates([e,t]);e=r[1]-this.gutterWidth,t=r[0]}else n=this.scroller.getBoundingClientRect();var i=e+this.scrollLeft-n.left-this.$padding,s=i/this.characterWidth,o=this.$blockCursor?Math.floor(s):Math.round(s),u=(t+this.scrollTop-n.top)/this.lineHeight;return this.session.screenToDocumentPosition(u,Math.max(o,0),i)},this.textToScreenCoordinates=function(e,t){var n=this.scroller.getBoundingClientRect(),r=this.session.documentToScreenPosition(e,t),i=this.$padding+(this.session.$bidiHandler.isBidiRow(r.row,e)?this.session.$bidiHandler.getPosLeft(r.column):Math.round(r.column*this.characterWidth)),s=r.row*this.lineHeight;return{pageX:n.left+i-this.scrollLeft,pageY:n.top+s-this.scrollTop}},this.visualizeFocus=function(){i.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){i.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText}),this.$keepTextAreaAtCursor=!0,i.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor()},this.setCompositionText=function(e){this.$moveTextAreaToCursor()},this.hideComposition=function(){if(!this.$composition)return;i.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null},this.setTheme=function(e,t){function o(r){if(n.$themeId!=e)return t&&t();if(!r||!r.cssClass)throw new Error("couldn't load module "+e+" or it didn't call define");r.$id&&(n.$themeId=r.$id),i.importCssString(r.cssText,r.cssClass,n.container),n.theme&&i.removeCssClass(n.container,n.theme.cssClass);var s="padding"in r?r.padding:"padding"in(n.theme||{})?4:n.$padding;n.$padding&&s!=n.$padding&&n.setPadding(s),n.$theme=r.cssClass,n.theme=r,i.addCssClass(n.container,r.cssClass),i.setCssClass(n.container,"ace_dark",r.isDark),n.$size&&(n.$size.width=0,n.$updateSizeAsync()),n._dispatchEvent("themeLoaded",{theme:r}),t&&t()}var n=this;this.$themeId=e,n._dispatchEvent("themeChange",{theme:e});if(!e||typeof e=="string"){var r=e||this.$options.theme.initialValue;s.loadModule(["theme",r],o)}else o(e)},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,t){i.setCssClass(this.container,e,t!==!1)},this.unsetStyle=function(e){i.removeCssClass(this.container,e)},this.setCursorStyle=function(e){this.scroller.style.cursor!=e&&(this.scroller.style.cursor=e)},this.setMouseCursor=function(e){this.scroller.style.cursor=e},this.attachToShadowRoot=function(){i.importCssString(m,"ace_editor.css",this.container)},this.destroy=function(){this.$textLayer.destroy(),this.$cursorLayer.destroy()}}).call(g.prototype),s.defineOptions(g.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){typeof e=="number"&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){i.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e)},initialValue:!0},showLineNumbers:{set:function(e){this.$gutterLayer.setShowLineNumbers(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){if(!this.$gutterLineHighlight){this.$gutterLineHighlight=i.createElement("div"),this.$gutterLineHighlight.className="ace_gutter-active-line",this.$gutter.appendChild(this.$gutterLineHighlight);return}this.$gutterLineHighlight.style.display=e?"":"none",this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight()},initialValue:!1,value:!0},hScrollBarAlwaysVisible:{set:function(e){(!this.$hScrollBarAlwaysVisible||!this.$horizScroll)&&this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){(!this.$vScrollBarAlwaysVisible||!this.$vScroll)&&this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){typeof e=="number"&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.updateFull()}},maxPixelHeight:{set:function(e){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(e){e=+e||0;if(this.$scrollPastEnd==e)return;this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{}}),t.VirtualRenderer=g}),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],function(e,t,n){"use strict";function u(e){var t="importScripts('"+i.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(n){var r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,s=new r;return s.append(t),s.getBlob("application/javascript")}}function a(e){if(typeof Worker=="undefined")return{postMessage:function(){},terminate:function(){}};var t=u(e),n=window.URL||window.webkitURL,r=n.createObjectURL(t);return new Worker(r)}var r=e("../lib/oop"),i=e("../lib/net"),s=e("../lib/event_emitter").EventEmitter,o=e("../config"),f=function(t,n,r,i,s){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl);if(o.get("packaged")||!e.toUrl)i=i||o.moduleUrl(n,"worker");else{var u=this.$normalizePath;i=i||u(e.toUrl("ace/worker/worker.js",null,"_"));var f={};t.forEach(function(t){f[t]=u(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}this.$worker=a(i),s&&this.send("importScripts",s),this.$worker.postMessage({init:!0,tlns:f,module:n,classname:r}),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){r.implement(this,s),this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var n=this.callbacks[t.id];n&&(n(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return i.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,n){if(n){var r=this.callbackId++;this.callbacks[r]=n,t.push(r)}this.send(e,t)},this.emit=function(e,t){try{this.$worker.postMessage({event:e,data:{data:t.data}})}catch(n){console.error(n.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),e.action=="insert"?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;if(!e)return;this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e})}}).call(f.prototype);var l=function(e,t,n){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var r=null,i=!1,u=Object.create(s),a=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(e){a.messageBuffer.push(e),r&&(i?setTimeout(f):f())},this.setEmitSync=function(e){i=e};var f=function(){var e=a.messageBuffer.shift();e.command?r[e.command].apply(r,e.args):e.event&&u._signal(e.event,e.data)};u.postMessage=function(e){a.onMessage({data:e})},u.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},u.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},o.loadModule(["worker",t],function(e){r=new e[n](u);while(a.messageBuffer.length)f()})};l.prototype=f.prototype,t.UIWorkerClient=l,t.WorkerClient=f,t.createWorker=a}),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],function(e,t,n){"use strict";var r=e("./range").Range,i=e("./lib/event_emitter").EventEmitter,s=e("./lib/oop"),o=function(e,t,n,r,i,s){var o=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=i,this.othersClass=s,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=r,this.$onCursorChange=function(){setTimeout(function(){o.onCursorChange()})},this.$pos=n;var u=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=u.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){s.implement(this,i),this.setup=function(){var e=this,t=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=t.createAnchor(this.$pos.row,this.$pos.column);var i=this.pos;i.$insertRight=!0,i.detach(),i.markerId=n.addMarker(new r(i.row,i.column,i.row,i.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach(function(n){var r=t.createAnchor(n.row,n.column);r.$insertRight=!0,r.detach(),e.others.push(r)}),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(this.othersActive)return;var e=this.session,t=this;this.othersActive=!0,this.others.forEach(function(n){n.markerId=e.addMarker(new r(n.row,n.column,n.row,n.column+t.length),t.othersClass,null,!1)})},this.hideOtherMarkers=function(){if(!this.othersActive)return;this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)},this.onUpdate=function(e){if(this.$updating)return this.updateAnchors(e);var t=e;if(t.start.row!==t.end.row)return;if(t.start.row!==this.pos.row)return;this.$updating=!0;var n=e.action==="insert"?t.end.column-t.start.column:t.start.column-t.end.column,i=t.start.column>=this.pos.column&&t.start.column<=this.pos.column+this.length+1,s=t.start.column-this.pos.column;this.updateAnchors(e),i&&(this.length+=n);if(i&&!this.session.$fromUndo)if(e.action==="insert")for(var o=this.others.length-1;o>=0;o--){var u=this.others[o],a={row:u.row,column:u.column+s};this.doc.insertMergedLines(a,e.lines)}else if(e.action==="remove")for(var o=this.others.length-1;o>=0;o--){var u=this.others[o],a={row:u.row,column:u.column+s};this.doc.remove(new r(a.row,a.column,a.row,a.column-n))}this.$updating=!1,this.updateMarkers()},this.updateAnchors=function(e){this.pos.onChange(e);for(var t=this.others.length;t--;)this.others[t].onChange(e);this.updateMarkers()},this.updateMarkers=function(){if(this.$updating)return;var e=this,t=this.session,n=function(n,i){t.removeMarker(n.markerId),n.markerId=t.addMarker(new r(n.row,n.column,n.row,n.column+e.length),i,null,!1)};n(this.pos,this.mainClass);for(var i=this.others.length;i--;)n(this.others[i],this.othersClass)},this.onCursorChange=function(e){if(this.$updating||!this.session)return;var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(this.$undoStackDepth===-1)return;var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth;for(var n=0;n<t;n++)e.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}).call(o.prototype),t.PlaceHolder=o}),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,n){function s(e,t){return e.row==t.row&&e.column==t.column}function o(e){var t=e.domEvent,n=t.altKey,o=t.shiftKey,u=t.ctrlKey,a=e.getAccelKey(),f=e.getButton();u&&i.isMac&&(f=t.button);if(e.editor.inMultiSelectMode&&f==2){e.editor.textInput.onContextMenu(e.domEvent);return}if(!u&&!n&&!a){f===0&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode();return}if(f!==0)return;var l=e.editor,c=l.selection,h=l.inMultiSelectMode,p=e.getDocumentPosition(),d=c.getCursor(),v=e.inSelection()||c.isEmpty()&&s(p,d),m=e.x,g=e.y,y=function(e){m=e.clientX,g=e.clientY},b=l.session,w=l.renderer.pixelToScreenCoordinates(m,g),E=w,S;if(l.$mouseHandler.$enableJumpToDef)u&&n||a&&n?S=o?"block":"add":n&&l.$blockSelectEnabled&&(S="block");else if(a&&!n){S="add";if(!h&&o)return}else n&&l.$blockSelectEnabled&&(S="block");S&&i.isMac&&t.ctrlKey&&l.$mouseHandler.cancelContextMenu();if(S=="add"){if(!h&&v)return;if(!h){var x=c.toOrientedRange();l.addSelectionMarker(x)}var T=c.rangeList.rangeAtPoint(p);l.inVirtualSelectionMode=!0,o&&(T=null,x=c.ranges[0]||x,l.removeSelectionMarker(x)),l.once("mouseup",function(){var e=c.toOrientedRange();T&&e.isEmpty()&&s(T.cursor,e.cursor)?c.substractPoint(e.cursor):(o?c.substractPoint(x.cursor):x&&(l.removeSelectionMarker(x),c.addRange(x)),c.addRange(e)),l.inVirtualSelectionMode=!1})}else if(S=="block"){e.stop(),l.inVirtualSelectionMode=!0;var N,C=[],k=function(){var e=l.renderer.pixelToScreenCoordinates(m,g),t=b.screenToDocumentPosition(e.row,e.column,e.offsetX);if(s(E,e)&&s(t,c.lead))return;E=e,l.selection.moveToPosition(t),l.renderer.scrollCursorIntoView(),l.removeSelectionMarkers(C),C=c.rectangularRangeBlock(E,w),l.$mouseHandler.$clickSelection&&C.length==1&&C[0].isEmpty()&&(C[0]=l.$mouseHandler.$clickSelection.clone()),C.forEach(l.addSelectionMarker,l),l.updateSelectionMarkers()};h&&!a?c.toSingleRange():!h&&a&&(N=c.toOrientedRange(),l.addSelectionMarker(N)),o?w=b.documentToScreenPosition(c.lead):c.moveToPosition(p),E={row:-1,column:-1};var L=function(e){clearInterval(O),l.removeSelectionMarkers(C),C.length||(C=[c.toOrientedRange()]),N&&(l.removeSelectionMarker(N),c.toSingleRange(N));for(var t=0;t<C.length;t++)c.addRange(C[t]);l.inVirtualSelectionMode=!1,l.$mouseHandler.$clickSelection=null},A=k;r.capture(l.container,y,L);var O=setInterval(function(){A()},20);return e.preventDefault()}}var r=e("../lib/event"),i=e("../lib/useragent");t.onMouseDown=o}),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],function(e,t,n){t.defaultCommands=[{name:"addCursorAbove",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"splitIntoLines",exec:function(e){e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"alignCursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],t.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var r=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new r(t.multiSelectCommands)}),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],function(e,t,n){function h(e,t,n){return c.$options.wrap=!0,c.$options.needle=t,c.$options.backwards=n==-1,c.find(e)}function v(e,t){return e.row==t.row&&e.column==t.column}function m(e){if(e.$multiselectOnSessionChange)return;e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",o),e.commands.addCommands(f.defaultCommands),g(e)}function g(e){function r(t){n&&(e.renderer.setMouseCursor(""),n=!1)}var t=e.textInput.getElement(),n=!1;u.addListener(t,"keydown",function(t){var i=t.keyCode==18&&!(t.ctrlKey||t.shiftKey||t.metaKey);e.$blockSelectEnabled&&i?n||(e.renderer.setMouseCursor("crosshair"),n=!0):n&&r()}),u.addListener(t,"keyup",r),u.addListener(t,"blur",r)}var r=e("./range_list").RangeList,i=e("./range").Range,s=e("./selection").Selection,o=e("./mouse/multi_select_handler").onMouseDown,u=e("./lib/event"),a=e("./lib/lang"),f=e("./commands/multi_select_commands");t.commands=f.defaultCommands.concat(f.multiSelectCommands);var l=e("./search").Search,c=new l,p=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(p.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(!e)return;if(!this.inMultiSelectMode&&this.rangeCount===0){var n=this.toOrientedRange();this.rangeList.add(n),this.rangeList.add(e);if(this.rangeList.ranges.length!=2)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(n),this.$onAddRange(n)}e.cursor||(e.cursor=e.end);var r=this.rangeList.add(e);return this.$onAddRange(e),r.length&&this.$onRemoveRange(r),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length?this.$onRemoveRange(e):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){this.rangeCount=this.rangeList.ranges.length;if(this.rangeCount==1&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var n=e.length;n--;){var r=this.ranges.indexOf(e[n]);this.ranges.splice(r,1)}this._signal("removeRange",{ranges:e}),this.rangeCount===0&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),t=t||this.ranges[0],t&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){if(this.rangeList)return;this.rangeList=new r,this.ranges=[],this.rangeCount=0},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=i.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{var n=this.getRange(),r=this.isBackwards(),s=n.start.row,o=n.end.row;if(s==o){if(r)var u=n.end,a=n.start;else var u=n.start,a=n.end;this.addRange(i.fromPoints(a,a)),this.addRange(i.fromPoints(u,u));return}var f=[],l=this.getLineRange(s,!0);l.start.column=n.start.column,f.push(l);for(var c=s+1;c<o;c++)f.push(this.getLineRange(c,!0));l=this.getLineRange(o,!0),l.end.column=n.end.column,f.push(l),f.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=i.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{var r=this.session.documentToScreenPosition(this.cursor),s=this.session.documentToScreenPosition(this.anchor),o=this.rectangularRangeBlock(r,s);o.forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,n){var r=[],s=e.column<t.column;if(s)var o=e.column,u=t.column,a=e.offsetX,f=t.offsetX;else var o=t.column,u=e.column,a=t.offsetX,f=e.offsetX;var l=e.row<t.row;if(l)var c=e.row,h=t.row;else var c=t.row,h=e.row;o<0&&(o=0),c<0&&(c=0),c==h&&(n=!0);var p;for(var d=c;d<=h;d++){var m=i.fromPoints(this.session.screenToDocumentPosition(d,o,a),this.session.screenToDocumentPosition(d,u,f));if(m.isEmpty()){if(p&&v(m.end,p))break;p=m.end}m.cursor=s?m.start:m.end,r.push(m)}l&&r.reverse();if(!n){var g=r.length-1;while(r[g].isEmpty()&&g>0)g--;if(g>0){var y=0;while(r[y].isEmpty())y++}for(var b=g;b>=y;b--)r[b].isEmpty()&&r.splice(b,1)}return r}}.call(s.prototype);var d=e("./editor").Editor;(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(!e.marker)return;this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);t!=-1&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length},this.removeSelectionMarkers=function(e){var t=this.session.$selectionMarkers;for(var n=e.length;n--;){var r=e[n];if(!r.marker)continue;this.session.removeMarker(r.marker);var i=t.indexOf(r);i!=-1&&t.splice(i,1)}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){if(this.inMultiSelectMode)return;this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(f.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onSingleSelect=function(e){if(this.session.multiSelect.inVirtualMode)return;this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(f.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection")},this.$onMultiSelectExec=function(e){var t=e.command,n=e.editor;if(!n.multiSelect)return;if(!t.multiSelectAction){var r=t.exec(n,e.args||{});n.multiSelect.addRange(n.multiSelect.toOrientedRange()),n.multiSelect.mergeOverlappingRanges()}else t.multiSelectAction=="forEach"?r=n.forEachSelection(t,e.args):t.multiSelectAction=="forEachLine"?r=n.forEachSelection(t,e.args,!0):t.multiSelectAction=="single"?(n.exitMultiSelectMode(),r=t.exec(n,e.args||{})):r=t.multiSelectAction(n,e.args||{});return r},this.forEachSelection=function(e,t,n){if(this.inVirtualSelectionMode)return;var r=n&&n.keepOrder,i=n==1||n&&n.$byLines,o=this.session,u=this.selection,a=u.rangeList,f=(r?u:a).ranges,l;if(!f.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var c=u._eventRegistry;u._eventRegistry={};var h=new s(o);this.inVirtualSelectionMode=!0;for(var p=f.length;p--;){if(i)while(p>0&&f[p].start.row==f[p-1].end.row)p--;h.fromOrientedRange(f[p]),h.index=p,this.selection=o.selection=h;var d=e.exec?e.exec(this,t||{}):e(this,t||{});!l&&d!==undefined&&(l=d),h.toOrientedRange(f[p])}h.detach(),this.selection=o.selection=u,this.inVirtualSelectionMode=!1,u._eventRegistry=c,u.mergeOverlappingRanges();var v=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),v&&v.from==v.to&&this.renderer.animateScrolling(v.from),l},this.exitMultiSelectMode=function(){if(!this.inMultiSelectMode||this.inVirtualSelectionMode)return;this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var t=this.multiSelect.rangeList.ranges,n=[];for(var r=0;r<t.length;r++)n.push(this.session.getTextRange(t[r]));var i=this.session.getDocument().getNewLineCharacter();e=n.join(i),e.length==(n.length-1)*i.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var n=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var r=t==this.multiSelect.anchor?n.cursor==n.start?n.end:n.start:n.cursor;r.row!=t.row||this.session.$clipPositionToDocument(r.row,r.column).column!=t.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(e,t,n){t=t||{},t.needle=e||t.needle;if(t.needle==undefined){var r=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(r)}this.$search.set(t);var i=this.$search.findAll(this.session);if(!i.length)return 0;var s=this.multiSelect;n||s.toSingleRange(i[0]);for(var o=i.length;o--;)s.addRange(i[o],!0);return r&&s.rangeList.rangeAtPoint(r.start)&&s.addRange(r,!0),i.length},this.selectMoreLines=function(e,t){var n=this.selection.toOrientedRange(),r=n.cursor==n.end,s=this.session.documentToScreenPosition(n.cursor);this.selection.$desiredColumn&&(s.column=this.selection.$desiredColumn);var o=this.session.screenToDocumentPosition(s.row+e,s.column);if(!n.isEmpty())var u=this.session.documentToScreenPosition(r?n.end:n.start),a=this.session.screenToDocumentPosition(u.row+e,u.column);else var a=o;if(r){var f=i.fromPoints(o,a);f.cursor=f.start}else{var f=i.fromPoints(a,o);f.cursor=f.end}f.desiredColumn=s.column;if(!this.selection.inMultiSelectMode)this.selection.addRange(n);else if(t)var l=n.cursor;this.selection.addRange(f),l&&this.selection.substractPoint(l)},this.transposeSelections=function(e){var t=this.session,n=t.multiSelect,r=n.ranges;for(var i=r.length;i--;){var s=r[i];if(s.isEmpty()){var o=t.getWordRange(s.start.row,s.start.column);s.start.row=o.start.row,s.start.column=o.start.column,s.end.row=o.end.row,s.end.column=o.end.column}}n.mergeOverlappingRanges();var u=[];for(var i=r.length;i--;){var s=r[i];u.unshift(t.getTextRange(s))}e<0?u.unshift(u.pop()):u.push(u.shift());for(var i=r.length;i--;){var s=r[i],o=s.clone();t.replace(s,u[i]),s.start.row=o.start.row,s.start.column=o.start.column}},this.selectMore=function(e,t,n){var r=this.session,i=r.multiSelect,s=i.toOrientedRange();if(s.isEmpty()){s=r.getWordRange(s.start.row,s.start.column),s.cursor=e==-1?s.start:s.end,this.multiSelect.addRange(s);if(n)return}var o=r.getTextRange(s),u=h(r,o,e);u&&(u.cursor=e==-1?u.start:u.end,this.session.unfold(u),this.multiSelect.addRange(u),this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(s.cursor)},this.alignCursors=function(){var e=this.session,t=e.multiSelect,n=t.ranges,r=-1,s=n.filter(function(e){if(e.cursor.row==r)return!0;r=e.cursor.row});if(!n.length||s.length==n.length-1){var o=this.selection.getRange(),u=o.start.row,f=o.end.row,l=u==f;if(l){var c=this.session.getLength(),h;do h=this.session.getLine(f);while(/[=:]/.test(h)&&++f<c);do h=this.session.getLine(u);while(/[=:]/.test(h)&&--u>0);u<0&&(u=0),f>=c&&(f=c-1)}var p=this.session.removeFullLines(u,f);p=this.$reAlignText(p,l),this.session.insert({row:u,column:0},p.join("\n")+"\n"),l||(o.start.column=0,o.end.column=p[p.length-1].length),this.selection.setRange(o)}else{s.forEach(function(e){t.substractPoint(e.cursor)});var d=0,v=Infinity,m=n.map(function(t){var n=t.cursor,r=e.getLine(n.row),i=r.substr(n.column).search(/\S/g);return i==-1&&(i=0),n.column>d&&(d=n.column),i<v&&(v=i),i});n.forEach(function(t,n){var r=t.cursor,s=d-r.column,o=m[n]-v;s>o?e.insert(r,a.stringRepeat(" ",s-o)):e.remove(new i(r.row,r.column,r.row,r.column-s+o)),t.start.column=t.end.column=d,t.start.row=t.end.row=r.row,t.cursor=t.end}),t.fromOrientedRange(n[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}},this.$reAlignText=function(e,t){function u(e){return a.stringRepeat(" ",e)}function f(e){return e[2]?u(i)+e[2]+u(s-e[2].length+o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}function l(e){return e[2]?u(i+s-e[2].length)+e[2]+u(o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}function c(e){return e[2]?u(i)+e[2]+u(o)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}var n=!0,r=!0,i,s,o;return e.map(function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?i==null?(i=t[1].length,s=t[2].length,o=t[3].length,t):(i+s+o!=t[1].length+t[2].length+t[3].length&&(r=!1),i!=t[1].length&&(n=!1),i>t[1].length&&(i=t[1].length),s<t[2].length&&(s=t[2].length),o>t[3].length&&(o=t[3].length),t):[e]}).map(t?f:n?r?l:f:c)}}).call(d.prototype),t.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var n=e.oldSession;n&&(n.multiSelect.off("addRange",this.$onAddRange),n.multiSelect.off("removeRange",this.$onRemoveRange),n.multiSelect.off("multiSelect",this.$onMultiSelect),n.multiSelect.off("singleSelect",this.$onSingleSelect),n.multiSelect.lead.off("change",this.$checkMultiselectChange),n.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=m,e("./config").defineOptions(d.prototype,"editor",{enableMultiselect:{set:function(e){m(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",o)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",o))},value:!0},enableBlockSelect:{set:function(e){this.$blockSelectEnabled=e},value:!0}})}),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],function(e,t,n){"use strict";var r=e("../../range").Range,i=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,n){var r=e.getLine(n);return this.foldingStartMarker.test(r)?"start":t=="markbeginend"&&this.foldingStopMarker&&this.foldingStopMarker.test(r)?"end":""},this.getFoldWidgetRange=function(e,t,n){return null},this.indentationBlock=function(e,t,n){var i=/\S/,s=e.getLine(t),o=s.search(i);if(o==-1)return;var u=n||s.length,a=e.getLength(),f=t,l=t;while(++t<a){var c=e.getLine(t).search(i);if(c==-1)continue;if(c<=o)break;l=t}if(l>f){var h=e.getLine(l).length;return new r(f,u,l,h)}},this.openingBracketBlock=function(e,t,n,i,s){var o={row:n,column:i+1},u=e.$findClosingBracket(t,o,s);if(!u)return;var a=e.foldWidgets[u.row];return a==null&&(a=e.getFoldWidget(u.row)),a=="start"&&u.row>o.row&&(u.row--,u.column=e.getLine(u.row).length),r.fromPoints(o,u)},this.closingBracketBlock=function(e,t,n,i,s){var o={row:n,column:i},u=e.$findOpeningBracket(t,o);if(!u)return;return u.column++,o.column--,r.fromPoints(u,o)}}).call(i.prototype)}),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],function(e,t,n){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t.$id="ace/theme/textmate";var r=e("../lib/dom");r.importCssString(t.cssText,t.cssClass)}),ace.define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],function(e,t,n){"use strict";function o(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}var r=e("./lib/oop"),i=e("./lib/dom"),s=e("./range").Range;(function(){this.getRowLength=function(e){var t;return this.lineWidgets?t=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0:t=0,!this.$useWrapMode||!this.$wrapData[e]?1+t:this.$wrapData[e].length+1+t},this.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach(function(t){t&&t.rowCount&&!t.hidden&&(e+=t.rowCount)}),e},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach();if(this.editor==e)return;this.detach(),this.editor=e,e&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets))},this.detach=function(e){var t=this.editor;if(!t)return;this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var n=this.session.lineWidgets;n&&n.forEach(function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))})},this.updateOnFold=function(e,t){var n=t.lineWidgets;if(!n||!e.action)return;var r=e.data,i=r.start.row,s=r.end.row,o=e.action=="add";for(var u=i+1;u<s;u++)n[u]&&(n[u].hidden=o);n[s]&&(o?n[i]?n[s].hidden=o:n[i]=n[s]:(n[i]==n[s]&&(n[i]=undefined),n[s].hidden=o))},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(!t)return;var n=e.start.row,r=e.end.row-n;if(r!==0)if(e.action=="remove"){var i=t.splice(n+1,r);i.forEach(function(e){e&&this.removeLineWidget(e)},this),this.$updateRows()}else{var s=new Array(r);s.unshift(n,0),t.splice.apply(t,s),this.$updateRows()}},this.$updateRows=function(){var e=this.session.lineWidgets;if(!e)return;var t=!0;e.forEach(function(e,n){if(e){t=!1,e.row=n;while(e.$oldWidget)e.$oldWidget.row=n,e=e.$oldWidget}}),t&&(this.session.lineWidgets=null)},this.addLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var t=this.session.lineWidgets[e.row];t&&(e.$oldWidget=t,t.el&&t.el.parentNode&&(t.el.parentNode.removeChild(t.el),t._inDocument=!1)),this.session.lineWidgets[e.row]=e,e.session=this.session;var n=this.editor.renderer;e.html&&!e.el&&(e.el=i.createElement("div"),e.el.innerHTML=e.html),e.el&&(i.addCssClass(e.el,"ace_lineWidgetContainer"),e.el.style.position="absolute",e.el.style.zIndex=5,n.container.appendChild(e.el),e._inDocument=!0),e.coverGutter||(e.el.style.zIndex=3),e.pixelHeight==null&&(e.pixelHeight=e.el.offsetHeight),e.rowCount==null&&(e.rowCount=e.pixelHeight/n.layerConfig.lineHeight);var r=this.session.getFoldAt(e.row,0);e.$fold=r;if(r){var s=this.session.lineWidgets;e.row==r.end.row&&!s[r.start.row]?s[r.start.row]=e:e.hidden=!0}return this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,n),this.onWidgetChanged(e),e},this.removeLineWidget=function(e){e._inDocument=!1,e.session=null,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el);if(e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(t){}if(this.session.lineWidgets){var n=this.session.lineWidgets[e.row];if(n==e)this.session.lineWidgets[e.row]=e.$oldWidget,e.$oldWidget&&this.onWidgetChanged(e.$oldWidget);else while(n){if(n.$oldWidget==e){n.$oldWidget=e.$oldWidget;break}n=n.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(e){var t=this.session.lineWidgets,n=t&&t[e],r=[];while(n)r.push(n),n=n.$oldWidget;return r},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var n=this.session._changedWidgets,r=t.layerConfig;if(!n||!n.length)return;var i=Infinity;for(var s=0;s<n.length;s++){var o=n[s];if(!o||!o.el)continue;if(o.session!=this.session)continue;if(!o._inDocument){if(this.session.lineWidgets[o.row]!=o)continue;o._inDocument=!0,t.container.appendChild(o.el)}o.h=o.el.offsetHeight,o.fixedWidth||(o.w=o.el.offsetWidth,o.screenWidth=Math.ceil(o.w/r.characterWidth));var u=o.h/r.lineHeight;o.coverLine&&(u-=this.session.getRowLineCount(o.row),u<0&&(u=0)),o.rowCount!=u&&(o.rowCount=u,o.row<i&&(i=o.row))}i!=Infinity&&(this.session._emit("changeFold",{data:{start:{row:i}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]},this.renderWidgets=function(e,t){var n=t.layerConfig,r=this.session.lineWidgets;if(!r)return;var i=Math.min(this.firstRow,n.firstRow),s=Math.max(this.lastRow,n.lastRow,r.length);while(i>0&&!r[i])i--;this.firstRow=n.firstRow,this.lastRow=n.lastRow,t.$cursorLayer.config=n;for(var o=i;o<=s;o++){var u=r[o];if(!u||!u.el)continue;if(u.hidden){u.el.style.top=-100-(u.pixelHeight||0)+"px";continue}u._inDocument||(u._inDocument=!0,t.container.appendChild(u.el));var a=t.$cursorLayer.getPixelPosition({row:o,column:0},!0).top;u.coverLine||(a+=n.lineHeight*this.session.getRowLineCount(u.row)),u.el.style.top=a-n.offset+"px";var f=u.coverGutter?0:t.gutterWidth;u.fixedWidth||(f-=t.scrollLeft),u.el.style.left=f+"px",u.fullWidth&&u.screenWidth&&(u.el.style.minWidth=n.width+2*n.padding+"px"),u.fixedWidth?u.el.style.right=t.scrollBar.getWidth()+"px":u.el.style.right=""}}}).call(o.prototype),t.LineWidgets=o}),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],function(e,t,n){"use strict";function o(e,t,n){var r=0,i=e.length-1;while(r<=i){var s=r+i>>1,o=n(t,e[s]);if(o>0)r=s+1;else{if(!(o<0))return s;i=s-1}}return-(r+1)}function u(e,t,n){var r=e.getAnnotations().sort(s.comparePoints);if(!r.length)return;var i=o(r,{row:t,column:-1},s.comparePoints);i<0&&(i=-i-1),i>=r.length?i=n>0?0:r.length-1:i===0&&n<0&&(i=r.length-1);var u=r[i];if(!u||!n)return;if(u.row===t){do u=r[i+=n];while(u&&u.row===t);if(!u)return r.slice()}var a=[];t=u.row;do a[n<0?"unshift":"push"](u),u=r[i+=n];while(u&&u.row==t);return a.length&&a}var r=e("../line_widgets").LineWidgets,i=e("../lib/dom"),s=e("../range").Range;t.showErrorMarker=function(e,t){var n=e.session;n.widgetManager||(n.widgetManager=new r(n),n.widgetManager.attach(e));var s=e.getCursorPosition(),o=s.row,a=n.widgetManager.getWidgetsAtRow(o).filter(function(e){return e.type=="errorMarker"})[0];a?a.destroy():o-=t;var f=u(n,o,t),l;if(f){var c=f[0];s.column=(c.pos&&typeof c.column!="number"?c.pos.sc:c.column)||0,s.row=c.row,l=e.renderer.$gutterLayer.$annotations[s.row]}else{if(a)return;l={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(s.row),e.selection.moveToPosition(s);var h={row:s.row,fixedWidth:!0,coverGutter:!0,el:i.createElement("div"),type:"errorMarker"},p=h.el.appendChild(i.createElement("div")),d=h.el.appendChild(i.createElement("div"));d.className="error_widget_arrow "+l.className;var v=e.renderer.$cursorLayer.getPixelPosition(s).left;d.style.left=v+e.renderer.gutterWidth-5+"px",h.el.className="error_widget_wrapper",p.className="error_widget "+l.className,p.innerHTML=l.text.join("<br>"),p.appendChild(i.createElement("div"));var m=function(e,t,n){if(t===0&&(n==="esc"||n==="return"))return h.destroy(),{command:"null"}};h.destroy=function(){if(e.$mouseHandler.isMousePressed)return;e.keyBinding.removeKeyboardHandler(m),n.widgetManager.removeLineWidget(h),e.off("changeSelection",h.destroy),e.off("changeSession",h.destroy),e.off("mouseup",h.destroy),e.off("change",h.destroy)},e.keyBinding.addKeyboardHandler(m),e.on("changeSelection",h.destroy),e.on("changeSession",h.destroy),e.on("mouseup",h.destroy),e.on("change",h.destroy),e.session.widgetManager.addLineWidget(h),h.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:h.el.offsetHeight})},i.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")}),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/range","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],function(e,t,n){"use strict";e("./lib/fixoldbrowsers");var r=e("./lib/dom"),i=e("./lib/event"),s=e("./range").Range,o=e("./editor").Editor,u=e("./edit_session").EditSession,a=e("./undomanager").UndoManager,f=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),t.config=e("./config"),t.require=e,typeof define=="function"&&(t.define=define),t.edit=function(e,n){if(typeof e=="string"){var s=e;e=document.getElementById(s);if(!e)throw new Error("ace.edit can't find div #"+s)}if(e&&e.env&&e.env.editor instanceof o)return e.env.editor;var u="";if(e&&/input|textarea/i.test(e.tagName)){var a=e;u=a.value,e=r.createElement("pre"),a.parentNode.replaceChild(e,a)}else e&&(u=e.textContent,e.innerHTML="");var l=t.createEditSession(u),c=new o(new f(e),l,n),h={document:l,editor:c,onResize:c.resize.bind(c,null)};return a&&(h.textarea=a),i.addListener(window,"resize",h.onResize),c.on("destroy",function(){i.removeListener(window,"resize",h.onResize),h.editor.container.env=null}),c.container.env=c.env=h,c},t.createEditSession=function(e,t){var n=new u(e,t);return n.setUndoManager(new a),n},t.Range=s,t.EditSession=u,t.UndoManager=a,t.VirtualRenderer=f,t.version="1.3.3"});
            (function() {
                ace.require(["ace/ace"], function(a) {
                    if (a) {
                        a.config.init(true);
                        a.define = ace.define;
                    }
                    if (!window.ace)
                        window.ace = a;
                    for (var key in a) if (a.hasOwnProperty(key))
                        window.ace[key] = a[key];
                    window.ace["default"] = window.ace;
                    if (typeof module == "object" && typeof exports == "object" && module) {
                        module.exports = window.ace;
                    }
                });
            })();

ace.define("ace/theme/monokai",["require","exports","module","ace/lib/dom"],function(e,t,n){t.isDark=!0,t.cssClass="ace-monokai",t.cssText=".ace-monokai .ace_gutter {background: #2F3129;color: #8F908A}.ace-monokai .ace_print-margin {width: 1px;background: #555651}.ace-monokai {background-color: #272822;color: #F8F8F2}.ace-monokai .ace_cursor {color: #F8F8F0}.ace-monokai .ace_marker-layer .ace_selection {background: #49483E}.ace-monokai.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #272822;}.ace-monokai .ace_marker-layer .ace_step {background: rgb(102, 82, 0)}.ace-monokai .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #49483E}.ace-monokai .ace_marker-layer .ace_active-line {background: #202020}.ace-monokai .ace_gutter-active-line {background-color: #272727}.ace-monokai .ace_marker-layer .ace_selected-word {border: 1px solid #49483E}.ace-monokai .ace_invisible {color: #52524d}.ace-monokai .ace_entity.ace_name.ace_tag,.ace-monokai .ace_keyword,.ace-monokai .ace_meta.ace_tag,.ace-monokai .ace_storage {color: #F92672}.ace-monokai .ace_punctuation,.ace-monokai .ace_punctuation.ace_tag {color: #fff}.ace-monokai .ace_constant.ace_character,.ace-monokai .ace_constant.ace_language,.ace-monokai .ace_constant.ace_numeric,.ace-monokai .ace_constant.ace_other {color: #AE81FF}.ace-monokai .ace_invalid {color: #F8F8F0;background-color: #F92672}.ace-monokai .ace_invalid.ace_deprecated {color: #F8F8F0;background-color: #AE81FF}.ace-monokai .ace_support.ace_constant,.ace-monokai .ace_support.ace_function {color: #66D9EF}.ace-monokai .ace_fold {background-color: #A6E22E;border-color: #F8F8F2}.ace-monokai .ace_storage.ace_type,.ace-monokai .ace_support.ace_class,.ace-monokai .ace_support.ace_type {font-style: italic;color: #66D9EF}.ace-monokai .ace_entity.ace_name.ace_function,.ace-monokai .ace_entity.ace_other,.ace-monokai .ace_entity.ace_other.ace_attribute-name,.ace-monokai .ace_variable {color: #A6E22E}.ace-monokai .ace_variable.ace_parameter {font-style: italic;color: #FD971F}.ace-monokai .ace_string {color: #E6DB74}.ace-monokai .ace_comment {color: #75715E}.ace-monokai .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWPQ0FD0ZXBzd/wPAAjVAoxeSgNeAAAAAElFTkSuQmCC) right repeat-y}";var r=e("../lib/dom");r.importCssString(t.cssText,t.cssClass)});
(function() {
    ace.require(["ace/theme/monokai"], function(m) {
        if (typeof module == "object" && typeof exports == "object" && module) {
            module.exports = m;
        }
    });
})();


ace.define("ace/mode/doc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./text_highlight_rules").TextHighlightRules,s=function(){this.$rules={start:[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},s.getTagRule(),{defaultToken:"comment.doc",caseInsensitive:!0}]}};r.inherits(s,i),s.getTagRule=function(e){return{token:"comment.doc.tag.storage.type",regex:"\\b(?:TODO|FIXME|XXX|HACK)\\b"}},s.getStartRule=function(e){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:e}},s.getEndRule=function(e){return{token:"comment.doc",regex:"\\*\\/",next:e}},t.DocCommentHighlightRules=s}),ace.define("ace/mode/javascript_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],function(e,t,n){"use strict";function a(){var e=o.replace("\\d","\\d\\-"),t={onMatch:function(e,t,n){var r=e.charAt(1)=="/"?2:1;if(r==1)t!=this.nextState?n.unshift(this.next,this.nextState,0):n.unshift(this.next),n[2]++;else if(r==2&&t==this.nextState){n[1]--;if(!n[1]||n[1]<0)n.shift(),n.shift()}return[{type:"meta.tag.punctuation."+(r==1?"":"end-")+"tag-open.xml",value:e.slice(0,r)},{type:"meta.tag.tag-name.xml",value:e.substr(r)}]},regex:"</?"+e+"",next:"jsxAttributes",nextState:"jsx"};this.$rules.start.unshift(t);var n={regex:"{",token:"paren.quasi.start",push:"start"};this.$rules.jsx=[n,t,{include:"reference"},{defaultToken:"string"}],this.$rules.jsxAttributes=[{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",onMatch:function(e,t,n){return t==n[0]&&n.shift(),e.length==2&&(n[0]==this.nextState&&n[1]--,(!n[1]||n[1]<0)&&n.splice(0,2)),this.next=n[0]||"start",[{type:this.token,value:e}]},nextState:"jsx"},n,f("jsxAttributes"),{token:"entity.other.attribute-name.xml",regex:e},{token:"keyword.operator.attribute-equals.xml",regex:"="},{token:"text.tag-whitespace.xml",regex:"\\s+"},{token:"string.attribute-value.xml",regex:"'",stateName:"jsx_attr_q",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',stateName:"jsx_attr_qq",push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},t],this.$rules.reference=[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}]}function f(e){return[{token:"comment",regex:/\/\*/,next:[i.getTagRule(),{token:"comment",regex:"\\*\\/",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]},{token:"comment",regex:"\\/\\/",next:[i.getTagRule(),{token:"comment",regex:"$|^",next:e||"pop"},{defaultToken:"comment",caseInsensitive:!0}]}]}var r=e("../lib/oop"),i=e("./doc_comment_highlight_rules").DocCommentHighlightRules,s=e("./text_highlight_rules").TextHighlightRules,o="[a-zA-Z\\$_\u00a1-\uffff][a-zA-Z\\d\\$_\u00a1-\uffff]*",u=function(e){var t=this.createKeywordMapper({"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|isNaN|parseFloat|parseInt|JSON|Math|this|arguments|prototype|window|document",keyword:"const|yield|import|get|set|async|await|break|case|catch|continue|default|delete|do|else|finally|for|function|if|in|of|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|__parent__|__count__|escape|unescape|with|__proto__|class|enum|extends|super|export|implements|private|public|interface|package|protected|static","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},"identifier"),n="case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void",r="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|u{[0-9a-fA-F]{1,6}}|[0-2][0-7]{0,2}|3[0-7][0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[i.getStartRule("doc-start"),f("no_regex"),{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+o+")(\\.)(prototype)(\\.)("+o+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+o+")(\\.)("+o+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+o+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+o+")(\\.)("+o+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+o+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+o+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"from(?=\\s*('|\"))"},{token:"keyword",regex:"(?:"+n+")\\b",next:"start"},{token:["support.constant"],regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|time|trace|timeEnd|assert)\b/},{token:t,regex:o},{token:"punctuation.operator",regex:/[.](?![.])/,next:"property"},{token:"storage.type",regex:/=>/},{token:"keyword.operator",regex:/--|\+\+|\.{3}|===|==|=|!=|!==|<+=?|>+=?|!|&&|\|\||\?:|[!$%&*+\-~\/^]=?/,next:"start"},{token:"punctuation.operator",regex:/[?:,;.]/,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"comment",regex:/^#!.*$/}],property:[{token:"text",regex:"\\s+"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+o+")(\\.)("+o+")(\\s*)(=)(\\s*)(function)(?:(\\s+)(\\w+))?(\\s*)(\\()",next:"function_arguments"},{token:"punctuation.operator",regex:/[.](?![.])/},{token:"support.function",regex:/(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:"support.function.dom",regex:/(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName|ClassName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:"support.constant",regex:/(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:"identifier",regex:o},{regex:"",token:"empty",next:"no_regex"}],start:[i.getStartRule("doc-start"),f("start"),{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.charclass.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],function_arguments:[{token:"variable.parameter",regex:o},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],qqstring:[{token:"constant.language.escape",regex:r},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:r},{token:"string",regex:"\\\\$",consumeLineEnd:!0},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]};if(!e||!e.noES6)this.$rules.no_regex.unshift({regex:"[{}]",onMatch:function(e,t,n){this.next=e=="{"?this.nextState:"";if(e=="{"&&n.length)n.unshift("start",t);else if(e=="}"&&n.length){n.shift(),this.next=n.shift();if(this.next.indexOf("string")!=-1||this.next.indexOf("jsx")!=-1)return"paren.quasi.end"}return e=="{"?"paren.lparen":"paren.rparen"},nextState:"start"},{token:"string.quasi.start",regex:/`/,push:[{token:"constant.language.escape",regex:r},{token:"paren.quasi.start",regex:/\${/,push:"start"},{token:"string.quasi.end",regex:/`/,next:"pop"},{defaultToken:"string.quasi"}]}),(!e||e.jsx!=0)&&a.call(this);this.embedRules(i,"doc-",[i.getEndRule("no_regex")]),this.normalizeRules()};r.inherits(u,s),t.JavaScriptHighlightRules=u}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,n){"use strict";var r=e("../range").Range,i=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var n=e.getLine(t),i=n.match(/^(\s*\})/);if(!i)return 0;var s=i[1].length,o=e.findMatchingBracket({row:t,column:s});if(!o||o.row==t)return 0;var u=this.$getIndent(e.getLine(o.row));e.replace(new r(t,0,t,s-1),u)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(i.prototype),t.MatchingBraceOutdent=i}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,n){"use strict";var r=e("../../lib/oop"),i=e("../../range").Range,s=e("./fold_mode").FoldMode,o=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};r.inherits(o,s),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,n){var r=e.getLine(n);if(this.singleLineBlockCommentRe.test(r)&&!this.startRegionRe.test(r)&&!this.tripleStarBlockCommentRe.test(r))return"";var i=this._getFoldWidgetBase(e,t,n);return!i&&this.startRegionRe.test(r)?"start":i},this.getFoldWidgetRange=function(e,t,n,r){var i=e.getLine(n);if(this.startRegionRe.test(i))return this.getCommentRegionBlock(e,i,n);var s=i.match(this.foldingStartMarker);if(s){var o=s.index;if(s[1])return this.openingBracketBlock(e,s[1],n,o);var u=e.getCommentFoldRange(n,o+s[0].length,1);return u&&!u.isMultiLine()&&(r?u=this.getSectionRange(e,n):t!="all"&&(u=null)),u}if(t==="markbegin")return;var s=i.match(this.foldingStopMarker);if(s){var o=s.index+s[0].length;return s[1]?this.closingBracketBlock(e,s[1],n,o):e.getCommentFoldRange(n,o,-1)}},this.getSectionRange=function(e,t){var n=e.getLine(t),r=n.search(/\S/),s=t,o=n.length;t+=1;var u=t,a=e.getLength();while(++t<a){n=e.getLine(t);var f=n.search(/\S/);if(f===-1)continue;if(r>f)break;var l=this.getFoldWidgetRange(e,"all",t);if(l){if(l.start.row<=s)break;if(l.isMultiLine())t=l.end.row;else if(r==f)break}u=t}return new i(s,o,u,e.getLine(u).length)},this.getCommentRegionBlock=function(e,t,n){var r=t.search(/\s*$/),s=e.getLength(),o=n,u=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,a=1;while(++n<s){t=e.getLine(n);var f=u.exec(t);if(!f)continue;f[1]?a--:a++;if(!a)break}var l=n;if(l>o)return new i(o,r,l,t.length)}}.call(o.prototype)}),ace.define("ace/mode/javascript",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript_highlight_rules","ace/mode/matching_brace_outdent","ace/worker/worker_client","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./text").Mode,s=e("./javascript_highlight_rules").JavaScriptHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,u=e("../worker/worker_client").WorkerClient,a=e("./behaviour/cstyle").CstyleBehaviour,f=e("./folding/cstyle").FoldMode,l=function(){this.HighlightRules=s,this.$outdent=new o,this.$behaviour=new a,this.foldingRules=new f};r.inherits(l,i),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.$quotes={'"':'"',"'":"'","`":"`"},this.getNextLineIndent=function(e,t,n){var r=this.$getIndent(t),i=this.getTokenizer().getLineTokens(t,e),s=i.tokens,o=i.state;if(s.length&&s[s.length-1].type=="comment")return r;if(e=="start"||e=="no_regex"){var u=t.match(/^.*(?:\bcase\b.*:|[\{\(\[])\s*$/);u&&(r+=n)}else if(e=="doc-start"){if(o=="start"||o=="no_regex")return"";var u=t.match(/^\s*(\/?)\*/);u&&(u[1]&&(r+=" "),r+="* ")}return r},this.checkOutdent=function(e,t,n){return this.$outdent.checkOutdent(t,n)},this.autoOutdent=function(e,t,n){this.$outdent.autoOutdent(t,n)},this.createWorker=function(e){var t=new u(["ace"],"ace/mode/javascript_worker","JavaScriptWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/javascript"}.call(l.prototype),t.Mode=l});
(function() {
    ace.require(["ace/mode/javascript"], function(m) {
        if (typeof module == "object" && typeof exports == "object" && module) {
            module.exports = m;
        }
    });
})();


ace.define("ace/mode/doc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./text_highlight_rules").TextHighlightRules,s=function(){this.$rules={start:[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},s.getTagRule(),{defaultToken:"comment.doc",caseInsensitive:!0}]}};r.inherits(s,i),s.getTagRule=function(e){return{token:"comment.doc.tag.storage.type",regex:"\\b(?:TODO|FIXME|XXX|HACK)\\b"}},s.getStartRule=function(e){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:e}},s.getEndRule=function(e){return{token:"comment.doc",regex:"\\*\\/",next:e}},t.DocCommentHighlightRules=s}),ace.define("ace/mode/c_cpp_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./doc_comment_highlight_rules").DocCommentHighlightRules,s=e("./text_highlight_rules").TextHighlightRules,o=t.cFunctions="\\b(?:hypot(?:f|l)?|s(?:scanf|ystem|nprintf|ca(?:nf|lb(?:n(?:f|l)?|ln(?:f|l)?))|i(?:n(?:h(?:f|l)?|f|l)?|gn(?:al|bit))|tr(?:s(?:tr|pn)|nc(?:py|at|mp)|c(?:spn|hr|oll|py|at|mp)|to(?:imax|d|u(?:l(?:l)?|max)|k|f|l(?:d|l)?)|error|pbrk|ftime|len|rchr|xfrm)|printf|et(?:jmp|vbuf|locale|buf)|qrt(?:f|l)?|w(?:scanf|printf)|rand)|n(?:e(?:arbyint(?:f|l)?|xt(?:toward(?:f|l)?|after(?:f|l)?))|an(?:f|l)?)|c(?:s(?:in(?:h(?:f|l)?|f|l)?|qrt(?:f|l)?)|cos(?:h(?:f)?|f|l)?|imag(?:f|l)?|t(?:ime|an(?:h(?:f|l)?|f|l)?)|o(?:s(?:h(?:f|l)?|f|l)?|nj(?:f|l)?|pysign(?:f|l)?)|p(?:ow(?:f|l)?|roj(?:f|l)?)|e(?:il(?:f|l)?|xp(?:f|l)?)|l(?:o(?:ck|g(?:f|l)?)|earerr)|a(?:sin(?:h(?:f|l)?|f|l)?|cos(?:h(?:f|l)?|f|l)?|tan(?:h(?:f|l)?|f|l)?|lloc|rg(?:f|l)?|bs(?:f|l)?)|real(?:f|l)?|brt(?:f|l)?)|t(?:ime|o(?:upper|lower)|an(?:h(?:f|l)?|f|l)?|runc(?:f|l)?|gamma(?:f|l)?|mp(?:nam|file))|i(?:s(?:space|n(?:ormal|an)|cntrl|inf|digit|u(?:nordered|pper)|p(?:unct|rint)|finite|w(?:space|c(?:ntrl|type)|digit|upper|p(?:unct|rint)|lower|al(?:num|pha)|graph|xdigit|blank)|l(?:ower|ess(?:equal|greater)?)|al(?:num|pha)|gr(?:eater(?:equal)?|aph)|xdigit|blank)|logb(?:f|l)?|max(?:div|abs))|di(?:v|fftime)|_Exit|unget(?:c|wc)|p(?:ow(?:f|l)?|ut(?:s|c(?:har)?|wc(?:har)?)|error|rintf)|e(?:rf(?:c(?:f|l)?|f|l)?|x(?:it|p(?:2(?:f|l)?|f|l|m1(?:f|l)?)?))|v(?:s(?:scanf|nprintf|canf|printf|w(?:scanf|printf))|printf|f(?:scanf|printf|w(?:scanf|printf))|w(?:scanf|printf)|a_(?:start|copy|end|arg))|qsort|f(?:s(?:canf|e(?:tpos|ek))|close|tell|open|dim(?:f|l)?|p(?:classify|ut(?:s|c|w(?:s|c))|rintf)|e(?:holdexcept|set(?:e(?:nv|xceptflag)|round)|clearexcept|testexcept|of|updateenv|r(?:aiseexcept|ror)|get(?:e(?:nv|xceptflag)|round))|flush|w(?:scanf|ide|printf|rite)|loor(?:f|l)?|abs(?:f|l)?|get(?:s|c|pos|w(?:s|c))|re(?:open|e|ad|xp(?:f|l)?)|m(?:in(?:f|l)?|od(?:f|l)?|a(?:f|l|x(?:f|l)?)?))|l(?:d(?:iv|exp(?:f|l)?)|o(?:ngjmp|cal(?:time|econv)|g(?:1(?:p(?:f|l)?|0(?:f|l)?)|2(?:f|l)?|f|l|b(?:f|l)?)?)|abs|l(?:div|abs|r(?:int(?:f|l)?|ound(?:f|l)?))|r(?:int(?:f|l)?|ound(?:f|l)?)|gamma(?:f|l)?)|w(?:scanf|c(?:s(?:s(?:tr|pn)|nc(?:py|at|mp)|c(?:spn|hr|oll|py|at|mp)|to(?:imax|d|u(?:l(?:l)?|max)|k|f|l(?:d|l)?|mbs)|pbrk|ftime|len|r(?:chr|tombs)|xfrm)|to(?:b|mb)|rtomb)|printf|mem(?:set|c(?:hr|py|mp)|move))|a(?:s(?:sert|ctime|in(?:h(?:f|l)?|f|l)?)|cos(?:h(?:f|l)?|f|l)?|t(?:o(?:i|f|l(?:l)?)|exit|an(?:h(?:f|l)?|2(?:f|l)?|f|l)?)|b(?:s|ort))|g(?:et(?:s|c(?:har)?|env|wc(?:har)?)|mtime)|r(?:int(?:f|l)?|ound(?:f|l)?|e(?:name|alloc|wind|m(?:ove|quo(?:f|l)?|ainder(?:f|l)?))|a(?:nd|ise))|b(?:search|towc)|m(?:odf(?:f|l)?|em(?:set|c(?:hr|py|mp)|move)|ktime|alloc|b(?:s(?:init|towcs|rtowcs)|towc|len|r(?:towc|len))))\\b",u=function(){var e="break|case|continue|default|do|else|for|goto|if|_Pragma|return|switch|while|catch|operator|try|throw|using",t="asm|__asm__|auto|bool|_Bool|char|_Complex|double|enum|float|_Imaginary|int|long|short|signed|struct|typedef|union|unsigned|void|class|wchar_t|template|char16_t|char32_t",n="const|extern|register|restrict|static|volatile|inline|private|protected|public|friend|explicit|virtual|export|mutable|typename|constexpr|new|delete|alignas|alignof|decltype|noexcept|thread_local",r="and|and_eq|bitand|bitor|compl|not|not_eq|or|or_eq|typeid|xor|xor_eq|const_cast|dynamic_cast|reinterpret_cast|static_cast|sizeof|namespace",s="NULL|true|false|TRUE|FALSE|nullptr",u=this.$keywords=this.createKeywordMapper({"keyword.control":e,"storage.type":t,"storage.modifier":n,"keyword.operator":r,"variable.language":"this","constant.language":s},"identifier"),a="[a-zA-Z\\$_\u00a1-\uffff][a-zA-Z\\d\\$_\u00a1-\uffff]*\\b",f=/\\(?:['"?\\abfnrtv]|[0-7]{1,3}|x[a-fA-F\d]{2}|u[a-fA-F\d]{4}U[a-fA-F\d]{8}|.)/.source,l="%"+/(\d+\$)?/.source+/[#0\- +']*/.source+/[,;:_]?/.source+/((-?\d+)|\*(-?\d+\$)?)?/.source+/(\.((-?\d+)|\*(-?\d+\$)?)?)?/.source+/(hh|h|ll|l|j|t|z|q|L|vh|vl|v|hv|hl)?/.source+/(\[[^"\]]+\]|[diouxXDOUeEfFgGaACcSspn%])/.source;this.$rules={start:[{token:"comment",regex:"//$",next:"start"},{token:"comment",regex:"//",next:"singleLineComment"},i.getStartRule("doc-start"),{token:"comment",regex:"\\/\\*",next:"comment"},{token:"string",regex:"'(?:"+f+"|.)?'"},{token:"string.start",regex:'"',stateName:"qqstring",next:[{token:"string",regex:/\\\s*$/,next:"qqstring"},{token:"constant.language.escape",regex:f},{token:"constant.language.escape",regex:l},{token:"string.end",regex:'"|$',next:"start"},{defaultToken:"string"}]},{token:"string.start",regex:'R"\\(',stateName:"rawString",next:[{token:"string.end",regex:'\\)"',next:"start"},{defaultToken:"string"}]},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+(L|l|UL|ul|u|U|F|f|ll|LL|ull|ULL)?\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?(L|l|UL|ul|u|U|F|f|ll|LL|ull|ULL)?\\b"},{token:"keyword",regex:"#\\s*(?:include|import|pragma|line|define|undef)\\b",next:"directive"},{token:"keyword",regex:"#\\s*(?:endif|if|ifdef|else|elif|ifndef)\\b"},{token:"support.function.C99.c",regex:o},{token:u,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*"},{token:"keyword.operator",regex:/--|\+\+|<<=|>>=|>>>=|<>|&&|\|\||\?:|[*%\/+\-&\^|~!<>=]=?/},{token:"punctuation.operator",regex:"\\?|\\:|\\,|\\;|\\."},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],comment:[{token:"comment",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}],singleLineComment:[{token:"comment",regex:/\\$/,next:"singleLineComment"},{token:"comment",regex:/$/,next:"start"},{defaultToken:"comment"}],directive:[{token:"constant.other.multiline",regex:/\\/},{token:"constant.other.multiline",regex:/.*\\/},{token:"constant.other",regex:"\\s*<.+?>",next:"start"},{token:"constant.other",regex:'\\s*["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]',next:"start"},{token:"constant.other",regex:"\\s*['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']",next:"start"},{token:"constant.other",regex:/[^\\\/]+/,next:"start"}]},this.embedRules(i,"doc-",[i.getEndRule("start")]),this.normalizeRules()};r.inherits(u,s),t.c_cppHighlightRules=u}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,n){"use strict";var r=e("../range").Range,i=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var n=e.getLine(t),i=n.match(/^(\s*\})/);if(!i)return 0;var s=i[1].length,o=e.findMatchingBracket({row:t,column:s});if(!o||o.row==t)return 0;var u=this.$getIndent(e.getLine(o.row));e.replace(new r(t,0,t,s-1),u)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(i.prototype),t.MatchingBraceOutdent=i}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,n){"use strict";var r=e("../../lib/oop"),i=e("../../range").Range,s=e("./fold_mode").FoldMode,o=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};r.inherits(o,s),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,n){var r=e.getLine(n);if(this.singleLineBlockCommentRe.test(r)&&!this.startRegionRe.test(r)&&!this.tripleStarBlockCommentRe.test(r))return"";var i=this._getFoldWidgetBase(e,t,n);return!i&&this.startRegionRe.test(r)?"start":i},this.getFoldWidgetRange=function(e,t,n,r){var i=e.getLine(n);if(this.startRegionRe.test(i))return this.getCommentRegionBlock(e,i,n);var s=i.match(this.foldingStartMarker);if(s){var o=s.index;if(s[1])return this.openingBracketBlock(e,s[1],n,o);var u=e.getCommentFoldRange(n,o+s[0].length,1);return u&&!u.isMultiLine()&&(r?u=this.getSectionRange(e,n):t!="all"&&(u=null)),u}if(t==="markbegin")return;var s=i.match(this.foldingStopMarker);if(s){var o=s.index+s[0].length;return s[1]?this.closingBracketBlock(e,s[1],n,o):e.getCommentFoldRange(n,o,-1)}},this.getSectionRange=function(e,t){var n=e.getLine(t),r=n.search(/\S/),s=t,o=n.length;t+=1;var u=t,a=e.getLength();while(++t<a){n=e.getLine(t);var f=n.search(/\S/);if(f===-1)continue;if(r>f)break;var l=this.getFoldWidgetRange(e,"all",t);if(l){if(l.start.row<=s)break;if(l.isMultiLine())t=l.end.row;else if(r==f)break}u=t}return new i(s,o,u,e.getLine(u).length)},this.getCommentRegionBlock=function(e,t,n){var r=t.search(/\s*$/),s=e.getLength(),o=n,u=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,a=1;while(++n<s){t=e.getLine(n);var f=u.exec(t);if(!f)continue;f[1]?a--:a++;if(!a)break}var l=n;if(l>o)return new i(o,r,l,t.length)}}.call(o.prototype)}),ace.define("ace/mode/c_cpp",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/c_cpp_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./text").Mode,s=e("./c_cpp_highlight_rules").c_cppHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,u=e("../range").Range,a=e("./behaviour/cstyle").CstyleBehaviour,f=e("./folding/cstyle").FoldMode,l=function(){this.HighlightRules=s,this.$outdent=new o,this.$behaviour=new a,this.foldingRules=new f};r.inherits(l,i),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,n){var r=this.$getIndent(t),i=this.getTokenizer().getLineTokens(t,e),s=i.tokens,o=i.state;if(s.length&&s[s.length-1].type=="comment")return r;if(e=="start"){var u=t.match(/^.*[\{\(\[]\s*$/);u&&(r+=n)}else if(e=="doc-start"){if(o=="start")return"";var u=t.match(/^\s*(\/?)\*/);u&&(u[1]&&(r+=" "),r+="* ")}return r},this.checkOutdent=function(e,t,n){return this.$outdent.checkOutdent(t,n)},this.autoOutdent=function(e,t,n){this.$outdent.autoOutdent(t,n)},this.$id="ace/mode/c_cpp"}.call(l.prototype),t.Mode=l}),ace.define("ace/mode/glsl_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/c_cpp_highlight_rules"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./c_cpp_highlight_rules").c_cppHighlightRules,s=function(){var e="attribute|const|uniform|varying|break|continue|do|for|while|if|else|in|out|inout|float|int|void|bool|true|false|lowp|mediump|highp|precision|invariant|discard|return|mat2|mat3|mat4|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|sampler2D|samplerCube|struct",t="radians|degrees|sin|cos|tan|asin|acos|atan|pow|exp|log|exp2|log2|sqrt|inversesqrt|abs|sign|floor|ceil|fract|mod|min|max|clamp|mix|step|smoothstep|length|distance|dot|cross|normalize|faceforward|reflect|refract|matrixCompMult|lessThan|lessThanEqual|greaterThan|greaterThanEqual|equal|notEqual|any|all|not|dFdx|dFdy|fwidth|texture2D|texture2DProj|texture2DLod|texture2DProjLod|textureCube|textureCubeLod|gl_MaxVertexAttribs|gl_MaxVertexUniformVectors|gl_MaxVaryingVectors|gl_MaxVertexTextureImageUnits|gl_MaxCombinedTextureImageUnits|gl_MaxTextureImageUnits|gl_MaxFragmentUniformVectors|gl_MaxDrawBuffers|gl_DepthRangeParameters|gl_DepthRange|gl_Position|gl_PointSize|gl_FragCoord|gl_FrontFacing|gl_PointCoord|gl_FragColor|gl_FragData",n=this.createKeywordMapper({"variable.language":"this",keyword:e,"constant.language":t},"identifier");this.$rules=(new i).$rules,this.$rules.start.forEach(function(e){typeof e.token=="function"&&(e.token=n)})};r.inherits(s,i),t.glslHighlightRules=s}),ace.define("ace/mode/glsl",["require","exports","module","ace/lib/oop","ace/mode/c_cpp","ace/mode/glsl_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("./c_cpp").Mode,s=e("./glsl_highlight_rules").glslHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,u=e("../range").Range,a=e("./behaviour/cstyle").CstyleBehaviour,f=e("./folding/cstyle").FoldMode,l=function(){this.HighlightRules=s,this.$outdent=new o,this.$behaviour=new a,this.foldingRules=new f};r.inherits(l,i),function(){this.$id="ace/mode/glsl"}.call(l.prototype),t.Mode=l});
(function() {
    ace.require(["ace/mode/glsl"], function(m) {
        if (typeof module == "object" && typeof exports == "object" && module) {
            module.exports = m;
        }
    });
})();

ace.define("ace/ext/searchbox",["require","exports","module","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/keyboard/hash_handler","ace/lib/keys"],function(e,t,n){"use strict";var r=e("../lib/dom"),i=e("../lib/lang"),s=e("../lib/event"),o='.ace_search {background-color: #ddd;color: #666;border: 1px solid #cbcbcb;border-top: 0 none;overflow: hidden;margin: 0;padding: 4px 6px 0 4px;position: absolute;top: 0;z-index: 99;white-space: normal;}.ace_search.left {border-left: 0 none;border-radius: 0px 0px 5px 0px;left: 0;}.ace_search.right {border-radius: 0px 0px 0px 5px;border-right: 0 none;right: 0;}.ace_search_form, .ace_replace_form {margin: 0 20px 4px 0;overflow: hidden;line-height: 1.9;}.ace_replace_form {margin-right: 0;}.ace_search_form.ace_nomatch {outline: 1px solid red;}.ace_search_field {border-radius: 3px 0 0 3px;background-color: white;color: black;border: 1px solid #cbcbcb;border-right: 0 none;outline: 0;padding: 0;font-size: inherit;margin: 0;line-height: inherit;padding: 0 6px;min-width: 17em;vertical-align: top;min-height: 1.8em;box-sizing: content-box;}.ace_searchbtn {border: 1px solid #cbcbcb;line-height: inherit;display: inline-block;padding: 0 6px;background: #fff;border-right: 0 none;border-left: 1px solid #dcdcdc;cursor: pointer;margin: 0;position: relative;color: #666;}.ace_searchbtn:last-child {border-radius: 0 3px 3px 0;border-right: 1px solid #cbcbcb;}.ace_searchbtn:disabled {background: none;cursor: default;}.ace_searchbtn:hover {background-color: #eef1f6;}.ace_searchbtn.prev, .ace_searchbtn.next {padding: 0px 0.7em}.ace_searchbtn.prev:after, .ace_searchbtn.next:after {content: "";border: solid 2px #888;width: 0.5em;height: 0.5em;border-width:  2px 0 0 2px;display:inline-block;transform: rotate(-45deg);}.ace_searchbtn.next:after {border-width: 0 2px 2px 0 ;}.ace_searchbtn_close {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAZ0lEQVR42u2SUQrAMAhDvazn8OjZBilCkYVVxiis8H4CT0VrAJb4WHT3C5xU2a2IQZXJjiQIRMdkEoJ5Q2yMqpfDIo+XY4k6h+YXOyKqTIj5REaxloNAd0xiKmAtsTHqW8sR2W5f7gCu5nWFUpVjZwAAAABJRU5ErkJggg==) no-repeat 50% 0;border-radius: 50%;border: 0 none;color: #656565;cursor: pointer;font: 16px/16px Arial;padding: 0;height: 14px;width: 14px;top: 9px;right: 7px;position: absolute;}.ace_searchbtn_close:hover {background-color: #656565;background-position: 50% 100%;color: white;}.ace_button {margin-left: 2px;cursor: pointer;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;overflow: hidden;opacity: 0.7;border: 1px solid rgba(100,100,100,0.23);padding: 1px;box-sizing:    border-box!important;color: black;}.ace_button:hover {background-color: #eee;opacity:1;}.ace_button:active {background-color: #ddd;}.ace_button.checked {border-color: #3399ff;opacity:1;}.ace_search_options{margin-bottom: 3px;text-align: right;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;clear: both;}.ace_search_counter {float: left;font-family: arial;padding: 0 8px;}',u=e("../keyboard/hash_handler").HashHandler,a=e("../lib/keys"),f=999;r.importCssString(o,"ace_searchbox");var l='<div class="ace_search right">    <span action="hide" class="ace_searchbtn_close"></span>    <div class="ace_search_form">        <input class="ace_search_field" placeholder="Search for" spellcheck="false"></input>        <span action="findPrev" class="ace_searchbtn prev"></span>        <span action="findNext" class="ace_searchbtn next"></span>        <span action="findAll" class="ace_searchbtn" title="Alt-Enter">All</span>    </div>    <div class="ace_replace_form">        <input class="ace_search_field" placeholder="Replace with" spellcheck="false"></input>        <span action="replaceAndFindNext" class="ace_searchbtn">Replace</span>        <span action="replaceAll" class="ace_searchbtn">All</span>    </div>    <div class="ace_search_options">        <span action="toggleReplace" class="ace_button" title="Toggle Replace mode"            style="float:left;margin-top:-2px;padding:0 5px;">+</span>        <span class="ace_search_counter"></span>        <span action="toggleRegexpMode" class="ace_button" title="RegExp Search">.*</span>        <span action="toggleCaseSensitive" class="ace_button" title="CaseSensitive Search">Aa</span>        <span action="toggleWholeWords" class="ace_button" title="Whole Word Search">\\b</span>        <span action="searchInSelection" class="ace_button" title="Search In Selection">S</span>    </div></div>'.replace(/> +/g,">"),c=function(e,t,n){var i=r.createElement("div");i.innerHTML=l,this.element=i.firstChild,this.setSession=this.setSession.bind(this),this.$init(),this.setEditor(e),r.importCssString(o,"ace_searchbox",e.container)};(function(){this.setEditor=function(e){e.searchBox=this,e.renderer.scroller.appendChild(this.element),this.editor=e},this.setSession=function(e){this.searchRange=null,this.$syncOptions(!0)},this.$initElements=function(e){this.searchBox=e.querySelector(".ace_search_form"),this.replaceBox=e.querySelector(".ace_replace_form"),this.searchOption=e.querySelector("[action=searchInSelection]"),this.replaceOption=e.querySelector("[action=toggleReplace]"),this.regExpOption=e.querySelector("[action=toggleRegexpMode]"),this.caseSensitiveOption=e.querySelector("[action=toggleCaseSensitive]"),this.wholeWordOption=e.querySelector("[action=toggleWholeWords]"),this.searchInput=this.searchBox.querySelector(".ace_search_field"),this.replaceInput=this.replaceBox.querySelector(".ace_search_field"),this.searchCounter=e.querySelector(".ace_search_counter")},this.$init=function(){var e=this.element;this.$initElements(e);var t=this;s.addListener(e,"mousedown",function(e){setTimeout(function(){t.activeInput.focus()},0),s.stopPropagation(e)}),s.addListener(e,"click",function(e){var n=e.target||e.srcElement,r=n.getAttribute("action");r&&t[r]?t[r]():t.$searchBarKb.commands[r]&&t.$searchBarKb.commands[r].exec(t),s.stopPropagation(e)}),s.addCommandKeyListener(e,function(e,n,r){var i=a.keyCodeToString(r),o=t.$searchBarKb.findKeyCommand(n,i);o&&o.exec&&(o.exec(t),s.stopEvent(e))}),this.$onChange=i.delayedCall(function(){t.find(!1,!1)}),s.addListener(this.searchInput,"input",function(){t.$onChange.schedule(20)}),s.addListener(this.searchInput,"focus",function(){t.activeInput=t.searchInput,t.searchInput.value&&t.highlight()}),s.addListener(this.replaceInput,"focus",function(){t.activeInput=t.replaceInput,t.searchInput.value&&t.highlight()})},this.$closeSearchBarKb=new u([{bindKey:"Esc",name:"closeSearchBar",exec:function(e){e.searchBox.hide()}}]),this.$searchBarKb=new u,this.$searchBarKb.bindKeys({"Ctrl-f|Command-f":function(e){var t=e.isReplace=!e.isReplace;e.replaceBox.style.display=t?"":"none",e.replaceOption.checked=!1,e.$syncOptions(),e.searchInput.focus()},"Ctrl-H|Command-Option-F":function(e){e.replaceOption.checked=!0,e.$syncOptions(),e.replaceInput.focus()},"Ctrl-G|Command-G":function(e){e.findNext()},"Ctrl-Shift-G|Command-Shift-G":function(e){e.findPrev()},esc:function(e){setTimeout(function(){e.hide()})},Return:function(e){e.activeInput==e.replaceInput&&e.replace(),e.findNext()},"Shift-Return":function(e){e.activeInput==e.replaceInput&&e.replace(),e.findPrev()},"Alt-Return":function(e){e.activeInput==e.replaceInput&&e.replaceAll(),e.findAll()},Tab:function(e){(e.activeInput==e.replaceInput?e.searchInput:e.replaceInput).focus()}}),this.$searchBarKb.addCommands([{name:"toggleRegexpMode",bindKey:{win:"Alt-R|Alt-/",mac:"Ctrl-Alt-R|Ctrl-Alt-/"},exec:function(e){e.regExpOption.checked=!e.regExpOption.checked,e.$syncOptions()}},{name:"toggleCaseSensitive",bindKey:{win:"Alt-C|Alt-I",mac:"Ctrl-Alt-R|Ctrl-Alt-I"},exec:function(e){e.caseSensitiveOption.checked=!e.caseSensitiveOption.checked,e.$syncOptions()}},{name:"toggleWholeWords",bindKey:{win:"Alt-B|Alt-W",mac:"Ctrl-Alt-B|Ctrl-Alt-W"},exec:function(e){e.wholeWordOption.checked=!e.wholeWordOption.checked,e.$syncOptions()}},{name:"toggleReplace",exec:function(e){e.replaceOption.checked=!e.replaceOption.checked,e.$syncOptions()}},{name:"searchInSelection",exec:function(e){e.searchOption.checked=!e.searchRange,e.setSearchRange(e.searchOption.checked&&e.editor.getSelectionRange()),e.$syncOptions()}}]),this.setSearchRange=function(e){this.searchRange=e,e?this.searchRangeMarker=this.editor.session.addMarker(e,"ace_active-line"):this.searchRangeMarker&&(this.editor.session.removeMarker(this.searchRangeMarker),this.searchRangeMarker=null)},this.$syncOptions=function(e){r.setCssClass(this.replaceOption,"checked",this.searchRange),r.setCssClass(this.searchOption,"checked",this.searchOption.checked),this.replaceOption.textContent=this.replaceOption.checked?"-":"+",r.setCssClass(this.regExpOption,"checked",this.regExpOption.checked),r.setCssClass(this.wholeWordOption,"checked",this.wholeWordOption.checked),r.setCssClass(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked),this.replaceBox.style.display=this.replaceOption.checked?"":"none",this.find(!1,!1,e)},this.highlight=function(e){this.editor.session.highlight(e||this.editor.$search.$options.re),this.editor.renderer.updateBackMarkers()},this.find=function(e,t,n){var i=this.editor.find(this.searchInput.value,{skipCurrent:e,backwards:t,wrap:!0,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked,preventScroll:n,range:this.searchRange}),s=!i&&this.searchInput.value;r.setCssClass(this.searchBox,"ace_nomatch",s),this.editor._emit("findSearchBox",{match:!s}),this.highlight(),this.updateCounter()},this.updateCounter=function(){var e=this.editor,t=e.$search.$options.re,n=0,r=0;if(t){var i=this.searchRange?e.session.getTextRange(this.searchRange):e.getValue(),s=e.session.doc.positionToIndex(e.selection.anchor);this.searchRange&&(s-=e.session.doc.positionToIndex(this.searchRange.start));var o=t.lastIndex=0,u;while(u=t.exec(i)){n++,o=u.index,o<=s&&r++;if(n>f)break;if(!u[0]){t.lastIndex=o+=1;if(o>=i.length)break}}}this.searchCounter.textContent=r+" of "+(n>f?f+"+":n)},this.findNext=function(){this.find(!0,!1)},this.findPrev=function(){this.find(!0,!0)},this.findAll=function(){var e=this.editor.findAll(this.searchInput.value,{regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked}),t=!e&&this.searchInput.value;r.setCssClass(this.searchBox,"ace_nomatch",t),this.editor._emit("findSearchBox",{match:!t}),this.highlight(),this.hide()},this.replace=function(){this.editor.getReadOnly()||this.editor.replace(this.replaceInput.value)},this.replaceAndFindNext=function(){this.editor.getReadOnly()||(this.editor.replace(this.replaceInput.value),this.findNext())},this.replaceAll=function(){this.editor.getReadOnly()||this.editor.replaceAll(this.replaceInput.value)},this.hide=function(){this.active=!1,this.setSearchRange(null),this.editor.off("changeSession",this.setSession),this.element.style.display="none",this.editor.keyBinding.removeKeyboardHandler(this.$closeSearchBarKb),this.editor.focus()},this.show=function(e,t){this.active=!0,this.editor.on("changeSession",this.setSession),this.element.style.display="",this.replaceOption.checked=t,e&&(this.searchInput.value=e),this.searchInput.focus(),this.searchInput.select(),this.editor.keyBinding.addKeyboardHandler(this.$closeSearchBarKb),this.$syncOptions(!0)},this.isFocused=function(){var e=document.activeElement;return e==this.searchInput||e==this.replaceInput}}).call(c.prototype),t.SearchBox=c,t.Search=function(e,t){var n=e.searchBox||new c(e);n.show(e.session.getTextRange(),t)}});
                (function() {
                    ace.require(["ace/ext/searchbox"], function(m) {
                        if (typeof module == "object" && typeof exports == "object" && module) {
                            module.exports = m;
                        }
                    });
                })();
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Creates a Widget object.<br>
 * The Widget class is the base class for all user interface elements inside VG.UI.Workspace. Mostly, widgets are part of Layouts, however widgets can also
 * contain other widgets.<br>
 * A widget paints its user interface during paintWidget() according to its rect property which has been set by its parent prior to calling paintWidget().
 * @constructor
 * @tutorial Widget Class
 */

VG.UI.Widget=function()
{
    if ( !(this instanceof VG.UI.Widget) ) return new VG.UI.Widget();

    this.name="Widget";
    this.rect=VG.Core.Rect();
    this.contentRect=VG.Core.Rect();

    /**The optional layout of the Widget, only used by widgets which contain a sub-layout, default is null.
     * @member {object} */
    this.layout=0;

    /**The visual state of the Widget as defined in {@link VG.UI.Widget.VisualState}, set by {@link VG.UI.Workspace}.
     * @member {VG.UI.Widget.VisualState} VG.UI.Widget.visualState */
    this.visualState=VG.UI.Widget.VisualState.Normal;

    /** True if the widget has focus state. An easier and quicker to use alternative than to read out {@link VG.UI.Widget.VisualState}
    * @member {bool}
    */
    this.hasFocusState=false;
    /** True if the widget has hover state. An easier and quicker to use alternative than to read out {@link VG.UI.Widget.VisualState}
    * @member {bool}
    */
    this.hasHoverState=false;

    /**The disabled state of the object, false by default.
     * @member {bool} VG.UI.Widget.disabled */
    this._disabled=false;

    /**The visible state of the object, true by default. If false, the object will not be shown inside layouts.
     * @member {bool} VG.UI.Widget.visible */
    this._visible=true;

    /**If true indicates that the Widgets supports focus, i.e. accepts mouse and keyboard events. Default is false.
     * @member {bool} */
    this.supportsFocus=false;

    /**If true indicates that the Widgets supports auto focus, i.e. accepts mouse and keyboard events automatically when the mouse is over the widget. Useful for Widgets on
     * Website and Teblets. Default is false.
     * @member {bool} */
    this.supportsAutoFocus=false;
    this.noFocusDrawing=false;

    /**If the widget is part of a layout, this property indicates to the Layout that the Widget supports expanding in the horizontal direction and does not have a fixed width.
     * If not expanding it has a fixed width which is set to the size calculated by calcSize().
     * The default state depends on the Widget implementation.
     * @member {bool} VG.UI.Widget.horizontalExpanding */
    this._horizontalExpanding=true;

    /**If the widget is part of a layout, this property indicates to the Layout that the Widget supports expanding in the vertical direction and does not have a fixed height.
     * If not expanding it has a fixed height which is set to the size calculated by calcSize().
     * The default state depends on the Widget implementation.
     * @member {bool} VG.UI.Widget.verticalExpanding */
    this._verticalExpanding=true;

    this.canvas=0;
    this.parent=0;

    /**The minimumSize of the widget, defaults to 0, 0. Used in layouts to identify the minimum size for the Widget.
    * @member {VG.Core.Size} */
    this.minimumSize=VG.Core.Size( 0, 0 );

    /**The maximumSize of the widget, defaults to {@link VG.UI.MaxLayoutSize}.
    * @member {VG.Core.Size} */
    this.maximumSize=VG.Core.Size( 32768, 32768 );

    /**The preferredSize of the widget, defaults to 100, 100. Used in layouts to identify the preferred size for the Widget. This size is returned by calcSize() by default.
    * @member {VG.Core.Size} */
    this.preferredSize=VG.Core.Size( 100, 100 );

    /**If the Widget contains other VG.UI.Widget derived Widgets at fixed positions, which also need keyboard or mouse events, the Widget can assign an array to childWidgets
     * containing the references to these child widgets. The Workspace will than take these widget into consideration for all user based events. The Widget however has to handle
     * all paintWidget() calls for it's child widget itself, including setting their rect. Defaults to null.
     * @member {array} */
    this.childWidgets=null;

    this.isWidget=true;
    this.isLayout=false;

    this.dragSourceId=undefined;
};

/**
 * Enum for the visible state of a widget stored in {@link VG.UI.Widget.visualState}
 * @enum
 */

VG.UI.Widget.VisualState={ /** @type {number} Widget has normal state */ "Normal" : 0,
    /** @type {number} Mouse is on top of the widget */ "Hover" : 1,
    /** @type {number} Widget is being clicked */ "Clicked" : 2,
    /** @type {number} Widget has focus*/ "Focus" : 3 };

Object.defineProperty( VG.UI.Widget.prototype, "disabled",
{
    get: function() {
        if ( !this.parent ) return this._disabled;
        else  return  this._disabled | this.parent.disabled;
    },
    set: function( disabled ) {
        this._disabled=disabled;
        if ( disabled ) {
            if ( this.visualState === VG.UI.Widget.VisualState.Focus )
                VG.context.workspace.widgetLostFocus( this );
        }
    }
});

Object.defineProperty( VG.UI.Widget.prototype, "visible",
{
    get: function() {
        return this._visible;
        //if ( !this.parent ) return this._visible;
        //else  return  this._visible | this.parent.visible;
    },
    set: function( visible ) {
        this._visible=visible;
        VG.update();
    }
});

Object.defineProperty( VG.UI.Widget.prototype, "horizontalExpanding",
{
    get: function() {
        return this._horizontalExpanding;
    },
    set: function( expanding ) {
        this._horizontalExpanding=expanding;
    }
});

Object.defineProperty( VG.UI.Widget.prototype, "verticalExpanding",
{
    get: function() {
        return this._verticalExpanding;
    },
    set: function( expanding ) {
        this._verticalExpanding=expanding;
    }
});

/** Sets keyboard and mouse focus to this Widget.*/

VG.UI.Widget.prototype.setFocus=function()
{
    VG.context.workspace.setFocus( this );
};

/** Implement in your sub-class to dispose allocated resources like textures etc.*/

VG.UI.Widget.prototype.dispose=function()
{
};

/**Key down event, send to the widget when it has focus and the user is pressing a key. The keycode together with an array containing all currently pressed keys are passed as arguments.
 * @param {VG.Events.KeyCodes} keyCode - Keycode of the key
 * @param {array} keysDown - An array containing a list of all currently pressed keys
 */

VG.UI.Widget.prototype.keyDown=function( keyCode, keysDown )
{
    if ( this.supportsFocus && keyCode === VG.Events.KeyCodes.Tab )
        VG.context.workspace.cycleFocus( this );
};

/**Key up event, send to the widget when it has focus and the user is releasing a key. The keycode together with an array containing all currently pressed keys are passed as arguments.
 * @param {VG.Events.KeyCodes} keyCode - Keycode of the released key
 * @param {array} keysDown - An array containing a list of all currently pressed keys
 */

VG.UI.Widget.prototype.keyUp=function( keyCode, keysDown )
{
};

/**Mouse move event, send to the widget when it has focus and the user is moving the mouse.
 * @param {VG.Events.MouseMoveEvent} event - Event containing the mouse position
 */

VG.UI.Widget.prototype.mouseMove=function( event )
{
};

 /**Mouse down event, send to the widget when one of the mouse buttons has been pressed and the widget has focus.
  * @param {VG.Events.MouseDownEvent} event - Event containing information about the mouse state
  */

VG.UI.Widget.prototype.mouseDown=function( event )
{
};

/**Mouse up event, send to the widget when one of the mouse buttons has been released and the widget has focus.
 * @param {VG.Events.MouseUpEvent} event - Event containing information about the mouse state
 */

VG.UI.Widget.prototype.mouseUp=function( event )
{
};

VG.UI.Widget.prototype.showContextMenu=function( event )
{
    if ( this.contextMenu && this.rect.contains( event.pos ) )
        this.contextMenu.activate( event.pos );
};

/**Paints the widget. Called by the parent when the widget should be painted. The rect member of the widget has been set to the valid
 * dimensions for the Widget before this call. All paint operations should be clipped to this rectangle.
 * @param {VG.Canvas} canvas - Canvas object providing convenience 2D draw functions
 */

VG.UI.Widget.prototype.paintWidget=function( canvas )
{
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect, VG.UI.stylePool.current.skin.Widget.BackgroundColor );

    if ( this.layout ) this.layout.layout( canvas );
};

/**Returns the recommended size for the Widget. Used by Layouts to calculate the Widget dimensions. If the Widget is not expanding
 * vertically or horizontally the Layout will fix the widget to the returned size. If the Widget is expanding, the Layout will consider
 * the returned size relatively to the sizes of the other Widgets in the layout. <br>The minimumSize and maximumSize dimensions can also be set
 * inside calcSize(), these are used to restrict dimensions of expanding widgets.
 * The default implementation returns {@link VG.UI.Widget.preferredSize}. This function only needs to be overriden if the widget is adjusting its size dynamically depending on its state.
 * @returns {VG.Core.Size}
 */

VG.UI.Widget.prototype.calcSize=function( canvas )
{
     return this.preferredSize;
};

/**Sets a fixed size for the Widget. Convenience function which adjusts the minimumSize, maximumSize and preferredSize properties as well as setting
 * horizontalExpanding and verticalExpanding to false.
 * @param {number} width - The fixed width
 * @param {number} width - The fixed height
 */

VG.UI.Widget.prototype.setFixedSize=function( width, height )
{
     this.minimumSize.width=this.maximumSize.width=this.preferredSize.width=width;
     this.minimumSize.height=this.maximumSize.height=this.preferredSize.height=height;
     this.horizontalExpanding=false; this.verticalExpanding=false;
};

VG.UI.Widget.prototype.checkSizeDimensionsMinMax=function( size )
{
    if ( !this.horizontalExpanding )
        if ( this.minimumSize.width < size.width )
            this.minimumSize.width=size.width;

    if ( !this.verticalExpanding )
        if ( this.minimumSize.height < size.height )
            this.minimumSize.height=size.height;

    if ( !this.horizontalExpanding )
        if ( this.minimumSize.width > size.width )
            size.width=this.minimumSize.width;

    if ( !this.verticalExpanding )
        if ( this.minimumSize.height > size.height )
            size.height=this.minimumSize.height;

    if ( !this.horizontalExpanding )
        if ( this.maximumSize.width < size.width )
            size.width=this.maximumSize.width;

    if ( !this.verticalExpanding )
        if ( this.maximumSize.height < size.height )
            size.height=this.maximumSize.height;
};

VG.UI.Widget.prototype.valueFromModel=function( value )
{
    //console.log( "received " + value );
};

VG.UI.Widget.prototype.setDragSourceId=function( id )
{
    this.dragSourceId=id;
};

/**
 * Creates an RenderWidget to perform arbitrary realtime 2D/3D rendering.
 *
 * The method render() is called to perform the rendering and needs to be overriden. The widget receives
 * calls to render() in 60 fps per second.
 * @constructor
 */

VG.UI.RenderWidget=function( noRealtime )
{
    if ( !(this instanceof VG.UI.RenderWidget) ) return new VG.UI.RenderWidget( noRealtime );

    VG.UI.Widget.call( this );

    this.supportsFocus=true;
    this.clearColor=false;

    this._timer = new VG.Core.Timer();

    this._mainRT = VG.Renderer().mainRT;

    this.clearBackground=true;
    if ( !noRealtime ) VG.context.workspace.autoRedrawInterval=0;
};

VG.UI.RenderWidget.prototype=VG.UI.Widget();

/** Called to perform rendering, must be overrided, otherwise this does nothing
 * @param {number} delta - The time passed in seconds from the last call to this method
 */

VG.UI.RenderWidget.prototype.render=function(delta)
{
};

VG.UI.RenderWidget.prototype.paintWidget=function( canvas )
{
    // canvas.pushClipRect( this.rect );

    var clearColor = this.clearColor || canvas.style.skin.Widget.BackgroundColor;

    //fakes a hardware clear by rendering a quad as background
    //if ( this.clearBackground ) canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect, clearColor );
    // if ( this.clearBackground ) this._mainRT.clear( clearColor, true );
    canvas.flush();

    this._mainRT.setViewport(this.rect);

    var delta = VG.Math.clamp(this._timer.getDelta(), 0.0001, 0.2);
    this.render(delta);

    if ( VG.context.workspace.mainRect ) this._mainRT.setViewport( VG.context.workspace.mainRect );
    else this._mainRT.setViewport(VG.context.workspace.rect);
    // canvas.popClipRect();
};

// ----------------------------------------------------------------- VG.UI.Frame

VG.UI.Frame=function()
{
    if ( !(this instanceof VG.UI.Frame) ) return new VG.UI.Frame();

    VG.UI.Widget.call( this );

    this.frameType=VG.UI.Frame.Type.None;
    this._image=VG.Core.Image();
};

VG.UI.Frame.Type={ "None" : 0, "Box" : 1 };

VG.UI.Frame.prototype=VG.UI.Widget();

VG.UI.Frame.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawFrame( this, canvas );
};

/**
 * Displays an image.
 *
 * @property {VG.Core.Image} image - The image object to show.
 * @property {string} imageName - The name of the image to load from the applications image pool.
 * @constructor
 * @param image {VG.Core.Image|string} image - The image to display, can either be an image object or the name of the image which will be retrieved from the applications {@link VG.Core.ImagePool|image pool}.
 */

VG.UI.Image=function( image )
{
    if ( !(this instanceof VG.UI.Image) ) return new VG.UI.Image( image );

    VG.UI.Frame.call( this );

    this.frameType=VG.UI.Frame.Type.None;
    this._verticalExpanding=true;
    this._horizontalExpanding=true;
    this.upScaling=false;

    if ( image && image instanceof VG.Core.Image )
    {
        this.image=image;
    } else
    if ( image && typeof image === 'string' )
    {
        this.imageName=image;
        image=VG.Utils.getImageByName( this.imageName );
        if ( image && !image.locked ) this._image.set( image );

    } else
    this._image=VG.Core.Image();

    this.adjustSizeToImage=true;
};

VG.UI.Image.prototype=VG.UI.Frame();

Object.defineProperty( VG.UI.Image.prototype, "image", {
    get: function() {
        return this._image;
    },
    set: function( image ) {

        this._image.set( image );

        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : this._image.imageData } );
    }
});

VG.UI.Image.prototype.calcSize=function()
{
    if ( this.adjustSizeToImage === false )
        return this.preferredSize;

    var size=VG.Core.Size( 0, 0 );

    if ( this._image.isValid() ) {
        size.set( this._image.width, this._image.height );
    }

    this.checkSizeDimensionsMinMax( size );

    this.minimumSize.width=size.width/10;
    this.minimumSize.height=size.height/10;

    return size;
};

/**
 * Binds the widget to the data model. This widget has to be bound to a VG.Core.Image object (or null).
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.Image.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.Image.prototype.valueFromModel=function( value )
{
    //console.log( "Image.valueFromModel: ", value );

    if ( value === null ) this._image.clear();
    else VG.decompressImageData( value, this._image );
};

VG.UI.Image.prototype.isValid=function()
{
    return this._image.isValid();
};

VG.UI.Image.prototype.mouseDown=function( event )
{
    this.mouseIsDown=true;
};

VG.UI.Image.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.Image.prototype.paintWidget=function( canvas )
{
    VG.UI.Frame.prototype.paintWidget.call( this, canvas );
    let image;

    if ( !this._image.isValid() )
    {
        // --- Check if this image is based on an imageName and if yes, try to load it
        if ( this.imageName ) {
            image=VG.Utils.getImageByName( this.imageName );

            if ( image && !image.locked ) this._image.set( image );
            else return;
        } else return;
    }

    if ( !this.rect.width || !this.rect.height ) return;

    image=this._image;

    if ( this.clickedImage && this.mouseIsDown ) image=this.clickedImage;
    else
    if ( this.hoverImage && this.visualState === VG.UI.Widget.VisualState.Hover ) image=this.hoverImage;

    // --- Draw It

    if ( this.rect.width >= image.width && this.rect.height >= image.height )
    {
        if ( !this.upScaling ) {
            let x=this.contentRect.x + (this.contentRect.width - image.width) / 2;
            let y=this.contentRect.y + (this.contentRect.height - image.height) / 2;
            canvas.drawImage( VG.Core.Point( x, y ), image );
        } else canvas.drawImage( this.contentRect.pos(), image, this.contentRect.size() );
    } else canvas.drawScaledImage( this.contentRect, image );
};

/**
 * Displays an clickable button widget.
 *
 *
 * @param {string} text - The text to display.
 * @property {string} text - The text to display.
 * @property {bool} checkable - Indicates if the button supports a checked state.
 * @property {bool} checked - If the button is checkable, indicates if the button is currently checked.
 * @property {callback} clicked - Set this property to a callback function which gets called when the users clicks (mouse-press and release) the button.
 * @constructor
 */

VG.UI.Button=function( text )
{
    if ( !(this instanceof VG.UI.Button) ) return new VG.UI.Button( text );
    this.text=arguments[0];

    VG.UI.Widget.call( this );
    this.name="Button";

    this.minimumSize.set( 80, 20 );

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.supportsFocus=true;
    this.mouseIsDown=false;
    this.big=true;

    this.checkable=false;
    this.checked=false;

    this._icon=0;
};

VG.UI.Button.prototype=VG.UI.Widget();
/*
Object.defineProperty( VG.UI.Button.prototype, "icon", {
    get: function() {
        return this._icon;
    },
    set: function( icon ) {
        this._icon=icon;
    }
});*/

VG.UI.Button.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    if ( this.big )
    {
        canvas.pushFont( VG.UI.stylePool.current.skin.Button.Font );

        VG.context.workspace.canvas.getTextSize( this.text, size );

        if ( size.width < 80 ) size.width=80;

        size.width+=20;

        if ( !this.__vgInsideToolBar ) size.height+=15;
        else size.height+=11;

        this.minimumSize.set( size );
    } else {
        canvas.pushFont( VG.UI.stylePool.current.skin.Button.SmallFont );

        VG.context.workspace.canvas.getTextSize( this.text, size );

        if ( size.width < 80 ) size.width=80;

        if ( size.height < 17 )
            size.height=17;

        size.width+=10;
        this.minimumSize.set( size );
    }

    this.checkSizeDimensionsMinMax( size );

    canvas.popFont();

    return size;
};

VG.UI.Button.prototype.mouseDown=function( event )
{
    if ( this.rect.contains( event.pos) && !this.disabled )
        this.mouseIsDown=true;
};

VG.UI.Button.prototype.mouseUp=function( event )
{
    if ( this.rect.contains( event.pos) )
    {
        if ( this.checkable && this.mouseIsDown ) {
            this.checked=true;

            // --- Uncheck other checkable VG.UI.Buttons if the parent is a VG.UI.Layout

            if ( this.parent && this.parent instanceof VG.UI.Layout ) {
                for ( var i=0; i <= this.parent.children.length; ++i ) {
                    var obj=this.parent.children[i];
                    if ( obj instanceof VG.UI.Button && obj !== this )
                        obj.checked=false;
                }
            }
        }
    }
    this.mouseIsDown=false;
};

VG.UI.Button.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawButton( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.Scrollbar

VG.UI.ScrollBar=function()
{
    if ( !(this instanceof VG.UI.ScrollBar) ) return new VG.UI.ScrollBar();

    VG.UI.Widget.call( this );
    this.name="ScrollBar";

    this.direction=VG.UI.ScrollBar.Direction.Vertical;

    this.handleRect=VG.Core.Rect();

    this.dragOpStartPos=VG.Core.Point();
    this.dragHandleOffset=0;
    this.handleOffset=0;

    this.offset=0;
    this.callbackObject=0;
};

VG.UI.ScrollBar.Direction={ "Vertical" : 0, "Horizontal" : 1 };

VG.UI.ScrollBar.prototype=VG.UI.Widget();

VG.UI.ScrollBar.prototype.setScrollBarContentSize=function( totalSize, visibleSize )
{
    this.totalSize=totalSize;
    this.visibleSize=visibleSize;
};

VG.UI.ScrollBar.prototype.scrollTo=function( offset )
{
    offset=Math.max( offset, 0 );

    this.calibrateHandleOffset();
    this.handleOffset=offset / this.totalSize * this.visibleSize;
    this.verifyHandleRect();

    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical ) this.callbackObject.vHandleMoved( this.handleRect.y - this.rect.y );
    else this.callbackObject.hHandleMoved( this.handleRect.x - this.rect.x );

    VG.update();
};

VG.UI.ScrollBar.prototype.calibrateHandleOffset=function( offset )
{
    // --- Reset the handle offset to its valid range

    if ( this.handleOffset < 0 ) this.handleOffset=0;

    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical ) {
        if ( this.handleOffset > (this.rect.height - this.handleRect.height) ) this.handleOffset=this.rect.height - this.handleRect.height;
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal ) {
        if ( this.handleOffset > (this.rect.width - this.handleRect.width) ) this.handleOffset=this.rect.width - this.handleRect.width;
    }
    this.dragHandleOffset=0;
};

VG.UI.ScrollBar.prototype.verifyHandleRect=function()
{
    this.handleRect.set( this.rect );
    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical ) {

        this.handleRect.y+=this.handleOffset + this.dragHandleOffset;
        this.handleRect.height=this.rect.height / this.totalSize * this.visibleSize;

        if ( this.handleRect.y < this.rect.y )
            this.handleRect.y=this.rect.y;

        if ( this.handleRect.bottom() > this.rect.bottom() )
            this.handleRect.y=this.rect.bottom() - this.handleRect.height;
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal ) {

        this.handleRect.x+=this.dragHandleOffset + this.handleOffset;
        this.handleRect.width=this.rect.width / this.totalSize * this.visibleSize;

        if ( this.handleRect.x < this.rect.x )
            this.handleRect.x=this.rect.x;

        if ( this.handleRect.right() > this.rect.right() )
            this.handleRect.x=this.rect.right() - this.handleRect.width;
    }
};

VG.UI.ScrollBar.prototype.mouseMove=function( event )
{
    if ( VG.context.workspace.mouseTrackerWidget !== this )
        return;

    var offset;
    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical )
    {
        offset=event.pos.y - this.dragOpStartPos.y;

        if ( offset != this.handleOffset ) {

            this.handleOffset=offset;

            if ( this.callbackObject && this.callbackObject.vHandleMoved ) {
                this.verifyHandleRect();
                this.callbackObject.vHandleMoved( this.handleRect.y - this.rect.y );
            }
            VG.update();
        }
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal )
    {
        offset=event.pos.x - this.dragOpStartPos.x;

        if ( offset != this.handleOffset ) {

            this.handleOffset=offset;

            if ( this.callbackObject && this.callbackObject.hHandleMoved ) {
                this.verifyHandleRect();
                this.callbackObject.hHandleMoved( this.handleRect.x - this.rect.x );
            }
            VG.update();
        }
    }
};

VG.UI.ScrollBar.prototype.getHandleOffset=function()
{
    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical )
    {
        return this.handleRect.y - this.rect.y;
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal )
    {
        return this.handleRect.x - this.rect.x;
    }
};

VG.UI.ScrollBar.prototype.setHandleOffset=function( offset )
{
    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical )
    {
        if ( offset != this.handleOffset ) {

            this.handleOffset=offset;

            if ( this.callbackObject && this.callbackObject.vHandleMoved ) {
                this.verifyHandleRect();
                this.callbackObject.vHandleMoved( this.handleRect.y - this.rect.y );
            }
            VG.update();
        }
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal )
    {
        if ( offset != this.handleOffset ) {

            this.handleOffset=offset;

            if ( this.callbackObject && this.callbackObject.hHandleMoved ) {
                this.verifyHandleRect();
                this.callbackObject.hHandleMoved( this.handleRect.x - this.rect.x );
            }
            VG.update();
        }
    }
};

VG.UI.ScrollBar.prototype.mouseDown=function( event )
{
    this.calibrateHandleOffset();

    if ( this.handleRect.contains( event.pos ) ) {
        VG.context.workspace.mouseTrackerWidget=this;

        this.dragOpStartPos.set( event.pos );
        this.handleOffset=0;

        if ( this.direction === VG.UI.ScrollBar.Direction.Vertical ) {
            this.dragHandleOffset=this.handleRect.y - this.rect.y;
        } else
        if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal ) {
            this.dragHandleOffset=this.handleRect.x - this.rect.x;
        }
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical )
    {
        this.dragHandleOffset=0;

        if ( event.pos.y < this.handleRect.y ) {
            // --- User clicks above the ScrollBar

            this.handleOffset-=this.handleRect.height;
        }  else
        if ( event.pos.y > this.handleRect.bottom() ) {
            // --- User clicks below the ScrollBar

            this.handleOffset+=this.handleRect.height;
        }

        if ( this.callbackObject && this.callbackObject.vHandleMoved ) {
            this.verifyHandleRect();
            this.callbackObject.vHandleMoved( this.handleRect.y - this.rect.y );
        }
        VG.update();
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal )
    {
        this.dragHandleOffset=0;

        if ( event.pos.x < this.handleRect.x ) {
            // --- User clicks left of the ScrollBar

            this.handleOffset-=this.handleRect.width;
        }  else
        if ( event.pos.x > this.handleRect.right() ) {
            // --- User clicks right of the ScrollBar

            this.handleOffset+=this.handleRect.width;
        }

        if ( this.callbackObject && this.callbackObject.hHandleMoved ) {
            this.verifyHandleRect();
            this.callbackObject.hHandleMoved( this.handleRect.x - this.rect.x );
        }
        VG.update();
    }
};

VG.UI.ScrollBar.prototype.autoScrollStart=function( event )
{
    this.calibrateHandleOffset();

    VG.context.workspace.mouseTrackerWidget=this;

    this.dragOpStartPos.set( event.pos );
    this.handleOffset=0;

    if ( this.direction === VG.UI.ScrollBar.Direction.Vertical ) {
        this.dragHandleOffset=this.handleRect.y - this.rect.y;
    } else
    if ( this.direction === VG.UI.ScrollBar.Direction.Horizontal ) {
        this.dragHandleOffset=this.handleRect.x - this.rect.x;
    }

    this.autoScrolling=true;
};

VG.UI.ScrollBar.prototype.mouseUp=function( event )
{
    if ( VG.context.workspace.mouseTrackerWidget === this )
        VG.context.workspace.mouseTrackerWidget=0;

    this.autoScrolling=false;

    VG.update();
};

VG.UI.ScrollBar.prototype.paintWidget=function( canvas, adjustAlpha )
{
    this.contentRect.set( this.rect );

    this.verifyHandleRect( this.handleOffset );
    if ( this.handleRect.width <= 0 || this.handleRect.height <= 0 ) return;

    VG.UI.stylePool.current.drawScrollBar( this, canvas, adjustAlpha );
};

/**
 * Displays a clickable check box widget.
 *
 * @param {bool} checked - The initial checked state of the button.
 * @property {bool} checked - The checked state of the button.
 * @property {callback} clicked - Set this property to a callback function which gets called when the users clicks (mouse-press and release) the check box.
 * @constructor
 */

VG.UI.CheckBox=function( checked )
{
    if ( !(this instanceof VG.UI.CheckBox) ) return new VG.UI.CheckBox( checked );

    VG.UI.Widget.call( this );
    this.name="Checkbox";

    this.setFixedSize( 16, 14 ); // 19,19
    this.supportsFocus=true;

    this.checked=checked;
    this.preferredSize.copy( this.minimumSize );
    this.preferredSize.height += 4;
};

VG.UI.CheckBox.prototype=VG.UI.Widget();

/**
 * Binds the widget to the data model. This widget has to be bound to a boolean Number value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.CheckBox.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.CheckBox.prototype.valueFromModel=function( value )
{
    //console.log( "TextEdit.valueFromModel: " + value );

    if ( value === null ) this.checked=false;
    else this.checked=value;

    if ( this.changed )
        this.changed( this.checked );

    VG.update();
};

VG.UI.CheckBox.prototype.mouseDown=function( event )
{
    if ( !this.rect.contains( event.pos ) ) return;

    if ( this.checked ) this.checked=false;
    else this.checked=true;

    if ( this.collection && this.path )
        this.collection.storeDataForPath( { path : this.path, value : this.checked, undoText : this.undoText } );

    if ( this.changed )
        this.changed( this.checked, this );

    VG.update();
};

VG.UI.CheckBox.prototype.mouseUp=function( event )
{
};

VG.UI.CheckBox.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawCheckBox( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.ShiftWidget

VG.UI.ShiftWidgetItem=function( text, widget )
{
    this.text=text;
    this.widget=widget;
};

VG.UI.ShiftWidget=function()
{
    if ( !(this instanceof VG.UI.ShiftWidget) ) return VG.UI.ShiftWidget.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="ShiftWidget";

    this.horizontalExpanding=true;
    this.verticalExpanding=true;

    this.minimumSize.set( 60, 40 );
    this.maximumSize.set( 32768, 32768 );
    this.preferredSize.set( 60, 40 );

    this.supportsFocus=false;

    this.childs=[];
    this.index=-1;
    this.popup=false;

    this.popupRect=VG.Core.Rect();
    this.layout=VG.UI.StackedLayout();

    this.maxUp=5; this.maxDown=5;
    this.itemHeight=30;

    for( var i=0; i < arguments.length; i+=2 )
        if ( String( arguments[i] ).length ) this.addChild( arguments[i], arguments[i+1] );
};

VG.UI.ShiftWidget.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.ShiftWidget.prototype, "index", {
    get: function() {
        return this._index;
    },
    set: function( index ) {
        this._index=index;

        if ( index === -1 )
            this.layout.current=undefined;
        else
            this.layout.current=this.childs[index].widget;
    }
});

VG.UI.ShiftWidget.prototype.clear=function( text )
{
    this.childs=[];
    this.index=-1;
};

VG.UI.ShiftWidget.prototype.text=function()
{
    var text="";
    if ( this.index !== -1 ) text=this.childs[this.index];
    return text;
};

VG.UI.ShiftWidget.prototype.addChild=function( text, widget )
{
    this.layout.addChild( widget );
    this.childs.push( new VG.UI.ShiftWidgetItem( text, widget ) );
    if ( this.index === -1 ) this.index=0;
};

VG.UI.ShiftWidget.prototype.addChilds=function()
{
    for( var i=0; i < arguments.length; i+=2 )
        this.addItem( arguments[i], arguments[i+1] );
};

VG.UI.ShiftWidget.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;
    return size;
};

VG.UI.ShiftWidget.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.ShiftWidget.prototype.valueFromModel=function( value )
{
    //VG.log( "TextEdit.valueFromModel: " + value );

    if ( value === null ) this.index=0;
    else this.index=value;

    if ( this.changed )
        this.changed( this.index, this.childs[this.index], this );
};

VG.UI.ShiftWidget.prototype.applyNewIndex=function( index )
{
    this.index=index;
    if ( this.collection && this.path )
        this.collection.storeDataForPath( { path : this.path, value : this.index } );

    if ( this.changed )
        this.changed( index, this.childs[index].widget, this );
};

VG.UI.ShiftWidget.prototype.focusIn=function()
{
    if ( this.focusInCallback )
        this.focusInCallback( this );
};

VG.UI.ShiftWidget.prototype.keyDown=function( keyCode )
{
    if ( VG.UI.Widget.prototype.keyDown.call( this, keyCode ) )
        return;

    if ( this.popup )
    {
        if ( keyCode == VG.Events.KeyCodes.Esc )
        {
            this.index=this.oldIndex;
            this.popup=false;
            VG.update();
        }
    } else
    {
        if ( keyCode == VG.Events.KeyCodes.ArrowUp )
        {
            if ( this.index > 0 ) {
                this.applyNewIndex( this.index -1 );
                VG.update();
            }
        } else
        if ( keyCode == VG.Events.KeyCodes.ArrowDown )
        {
            if ( this.index < (this.childs.length -1 )) {
                this.applyNewIndex( this.index + 1 );
                VG.update();
            }
        }
    }
};

VG.UI.ShiftWidget.prototype.mouseMove=function( event )
{
    if ( this.popup && this.popupRect && this.popupRect.contains( event.pos ) )
    {
        var y=event.pos.y - this.popupRect.y;
        var index= Math.floor( y / this.itemHeight );

        this.highlightedIndex=(this.index - this.itemsUp + index );
        this.highlightedIndex=VG.Math.clamp( this.highlightedIndex, 0, this.childs.length-1 );
        VG.update();
    }
};

VG.UI.ShiftWidget.prototype.mouseDown=function( event )
{
    var index;
    if ( event.pos.x - this.rect.x < 25 )
    {
        if ( this.index === 0 ) index=this.childs.length-1;
        else index=this.index-1;

        this.applyNewIndex( index );
    } else
    if ( this.rect.right() - event.pos.x < 25 )
    {
        index=(this.index + 1 ) % this.childs.length;
        this.applyNewIndex( index );
    } else
    if ( this.rect.contains( event.pos ) ) {
        VG.context.workspace.mouseTrackerWidget=this;

        this.highlightedIndex=this.index;
        this.popup=true;
        this.oldIndex=this.index;
    }
};

VG.UI.ShiftWidget.prototype.mouseUp=function( event )
{
    VG.context.workspace.mouseTrackerWidget=null;

    if ( this.popup && this.highlightedIndex !== this.oldIndex )
        this.applyNewIndex( this.highlightedIndex );

    this.popup=false;

    VG.update();
};

VG.UI.ShiftWidget.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );

    if ( this.popup && canvas.delayedPaintWidgets.indexOf( this ) === -1 ) {
        canvas.delayedPaintWidgets.push( this );
    } else
    {
        if ( this.index !== -1 ) {

            this.layout.rect.copy( this.rect );
            this.layout.rect.y+=this.itemHeight; this.layout.rect.height-=this.itemHeight;
            this.layout.layout( canvas );
        }

        VG.UI.stylePool.current.drawShiftWidget( this, canvas );
    }
};

/**
 * Displays a drop down menu widget, offering several selectable choices to the user.
 *
 * @param {string} Texts - Initial content of the widget.
 * @property {callback} changed - Called when the current string item changes, parameters are: index, text, this.
 * @constructor
 */

VG.UI.DropDownMenu=function()
{
    if ( !(this instanceof VG.UI.DropDownMenu) ) return VG.UI.DropDownMenu.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="DropDownMenu";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.minimumSize.set( 60, 20 );
    this.maximumSize.set( 32768, 40 );

    this.supportsFocus=true;

    this.items=[];
    this.index=-1;
    this.popup=false;

    this.popupRect=VG.Core.Rect();

    for( var i=0; i < arguments.length; ++i )
        if ( String( arguments[i] ).length ) this.addItem( arguments[i] );
};

VG.UI.DropDownMenu.prototype=VG.UI.Widget();

/**
 * Clears the content of the widget.
 */

VG.UI.DropDownMenu.prototype.clear=function( text )
{
    this.items=[];
    this.index=-1;
};

/**
 * Returns the currently displayed text.
 * @returns {string} The currently displayed text.
 */

VG.UI.DropDownMenu.prototype.text=function()
{
    var text="";
    if ( this.index !== -1 ) text=this.items[this.index];
    return text;
};

/**
 * Adds a text to the drop down menu list.
 *
 * @param {string} Text - The text to add.
 */

VG.UI.DropDownMenu.prototype.addItem=function( text )
{
    this.items.push( text );
    if ( this.index === -1 ) this.index=0;
};

/**
 * Adds all text arguments to the drop down menu list.
 *
 * @param {string} Texts - The list of text to add.
 */

VG.UI.DropDownMenu.prototype.addItems=function()
{
    for( var i=0; i < arguments.length; ++i )
        this.addItem( arguments[i] );
};

VG.UI.DropDownMenu.prototype.calcSize=function( canvas )
{
    let size = this.preferredSize;
    let minWidth = 80;

    VG.context.workspace.canvas.pushFont( VG.UI.stylePool.current.skin.DropDownMenu.Font );

    for( var i=0; i < this.items.length; ++i ) {
        canvas.getTextSize( this.items[i], size );
        if ( size.width > minWidth ) minWidth=size.width;
    }

    size.set( minWidth, VG.context.workspace.canvas.getLineHeight() );

    size.add( 40, 3, size );

    size.width = Math.min( size.width, this.maximumSize.width );

    //size.height=VG.UI.stylePool.current.skin.DropDownMenu.Height;
    this.minimumSize.set( size );

    if ( this.parent && size.height > this.parent.rect.height ) size.height=this.parent.rect.height;

    VG.context.workspace.canvas.popFont();

    return size;
};

/**
 * Binds the widget to the data model. This widget has to be bound to a String value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.DropDownMenu.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.DropDownMenu.prototype.valueFromModel=function( value )
{
    //VG.log( "TextEdit.valueFromModel: " + value );

    if ( value === null ) this.index=0;
    else this.index=value;

    if ( this.changed )
        this.changed( this.index, this.items[this.index], this, true );
};

VG.UI.DropDownMenu.prototype.applyNewIndex=function( index )
{
    this.index=index;
    if ( this.collection && this.path )
        this.collection.storeDataForPath( { path : this.path, value : this.index, undoText : this.undoText } );

    if ( this.changed )
        this.changed( index, this.items[index], this );
};

VG.UI.DropDownMenu.prototype.focusIn=function()
{
    if ( this.focusInCallback )
        this.focusInCallback( this );
};

VG.UI.DropDownMenu.prototype.keyDown=function( keyCode )
{
    if ( VG.UI.Widget.prototype.keyDown.call( this, keyCode ) )
        return;

    if ( this.popup )
    {
        if ( keyCode == VG.Events.KeyCodes.Esc )
        {
            this.index=this.oldIndex;
            this.popup=false;
            VG.context.workspace.mouseTrackerWidget=null;

            VG.update();
        } else
        if ( keyCode == VG.Events.KeyCodes.ArrowUp )
        {
            if ( this.index > 0 ) {
                this.index--;
                VG.update();
            }
        } else
        if ( keyCode == VG.Events.KeyCodes.ArrowDown )
        {
            if ( this.index < (this.items.length -1 )) {
                this.index++;
                VG.update();
            }
        } else
        if ( keyCode == VG.Events.KeyCodes.Enter )
        {
            if ( this.index !== this.oldIndex )
                this.applyNewIndex( this.index );

            this.popup=false;
            VG.context.workspace.mouseTrackerWidget=null;
            VG.update();
        }
    } else
    {
        if ( keyCode == VG.Events.KeyCodes.ArrowUp )
        {
            if ( this.index > 0 ) {
                this.applyNewIndex( this.index -1 );
                VG.update();
            }
        } else
        if ( keyCode == VG.Events.KeyCodes.ArrowDown )
        {
            if ( this.index < (this.items.length -1 )) {
                this.applyNewIndex( this.index + 1 );
                VG.update();
            }
        }
    }
};

VG.UI.DropDownMenu.prototype.mouseMove=function( event )
{
    if ( this.popup && this.popupRect && this.popupRect.contains( event.pos ) )
    {
        var y=event.pos.y - this.popupRect.y;
        var index=y / this.itemHeight;

        if ( index < this.items.length ) {
            this.index=Math.floor( index );
            VG.update();
        }
    }
};

VG.UI.DropDownMenu.prototype.mouseDown=function( event )
{
    if ( this.popup === false )
    {
        if ( this.rect.contains( event.pos ) )
        {
            VG.context.workspace.mouseTrackerWidget=this;

            this.popup=true;
            this.oldIndex=this.index;
        }
    } else
    {
        if ( this.popupRect.contains( event.pos ) )
        {
            if ( this.index !== this.oldIndex )
                this.applyNewIndex( this.index );
        } else this.index=this.oldIndex;

        this.popup=false;
        VG.context.workspace.mouseTrackerWidget=null;
    }
};

VG.UI.DropDownMenu.prototype.mouseUp=function( event )
{
/*
    this.popup=false;
    VG.context.workspace.mouseTrackerWidget=null;

    if ( this.index !== this.oldIndex )
        this.applyNewIndex( this.index );
*/
};

VG.UI.DropDownMenu.prototype.paintWidget=function( canvas )
{
    this.contentRect.set( this.rect );

    if ( this.popup && canvas.delayedPaintWidgets.indexOf( this ) === -1 ) canvas.delayedPaintWidgets.push( this );
    else VG.UI.stylePool.current.drawDropDownMenu( this, canvas );
};

/**
 * Status bar widget. Create a status bar and set it to the {@link VG.UI.Workspace|workspace} via the {@link VG.UI.Workspace.statusBar} property.
 *
 * @property {VG.UI.Layout} layout - Modify this layout with the content you want to add to the status bar. By default this layout is empty.
 * @constructor
 */

VG.UI.StatusBar=function()
{
    if ( !(this instanceof VG.UI.StatusBar) ) return new VG.UI.StatusBar();

    VG.UI.Widget.call( this );
    this.name="StatusBar";

    // ---

    this.layout=VG.UI.Layout();

    this.layout.margin.left=10;
    this.layout.margin.top=10;

    // ---

    this.messageLayout=VG.UI.Layout();

    this.messageLayout.margin.left=10;
    this.messageLayout.margin.top=10;

    this.messageLabel=VG.UI.Label( "" );
    this.messageLabel.hAlignment=VG.UI.HAlignment.Left;
    this.messageLabel.vAlignment=VG.UI.HAlignment.Bottom;

    this.messageLayout.addChild( this.messageLabel );

    this.spacer=VG.UI.LayoutHSpacer();
    this.messageLayout.addChild( this.spacer );
};

VG.UI.StatusBar.prototype=VG.UI.Widget();

/**
 * Displays a temporary message on the status bar, clearing all other content. The timeout indicates how long the message should be displayed.
 * @param {string} message - The message to display.
 * @param {number} timeout - The timeout in milliseconds.
 */

VG.UI.StatusBar.prototype.message=function( message, timeout )
{
    this.messageLabel.text=message;
    if ( timeout ) this.messageTimeOutTime=Date.now() + timeout;
    else this.messageTimeOutTime=0;
    VG.update();
};

VG.UI.StatusBar.prototype.addWidget=function( widget )
{
    this.layout.addChild( widget );
};

VG.UI.StatusBar.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawStatusBar( this, canvas );

    if ( this.messageTimeOutTime && this.messageTimeOutTime < Date.now() )
        this.messageLabel.text="";

    if ( this.messageLabel.text === "" )
    {
        this.layout.rect.set( this.rect );
        this.layout.layout( canvas );
    } else
    {
        this.messageLayout.rect.set( this.rect );
        this.messageLayout.layout( canvas );
    }
};

// ----------------------------------------------------------------- VG.UI.TabWidget

VG.UI.TabWidgetItem=function( text, object )
{
    this.text=text;
    this.object=object;
    this.rect=VG.Core.Rect();
};

/**
 * Creates a tab widget, the tabs are listed at the top of the widget. Each tab points to a layout or widget which will be displayed if the tab is selected.
 *
 * @param {string} text - The initial text of the tab.
 * @param {object} object - The initial content object for the tab.
 * @property {callback} changed - Callback will be called when the current tab changes, will suppy the content object of the current tab as parameter.
 * @constructor
 */

VG.UI.TabWidget=function( text )
{
    if ( !(this instanceof VG.UI.TabWidget) ) return VG.UI.TabWidget.creator( arguments );
    VG.UI.Widget.call( this );
    this.name="TabWidget";
    this.text=text === undefined ? "" : text;

    this.layout=VG.UI.StackedLayout();
    this.layout.vertical=true;
    this.layout.margin.set( 0, 0, 0, 0 );
    this.layout.spacing=0;
    this.layout.parent=this;

    this.supportsFocus=true;

    this.items=[];

    for( var i=0; i < arguments.length; i+=2 )
        this.addItem( arguments[i], arguments[i+1] );
};

VG.UI.TabWidget.prototype=VG.UI.Widget();

/**
 * Adds a new tab item.
 *
 * @param {string} text - The text of the tab.
 * @param {object} object - The content object for the tab.
 */

VG.UI.TabWidget.prototype.addItem=function( text, object )
{
    let item = new VG.UI.TabWidgetItem( text, object );

    if ( !this.layout.current ) {
        this.layout.current=object;
        this.currentItem = item;
        if ( this.changed ) this.changed( object );
    }

    this.items.push( item );
    this.layout.addChild( object );

    VG.update();
};

/**
 * Adds several new new tab item.
 *
 * @param {string} text - The text of the tab.
 * @param {object} object - The content object for the tab.
 */

VG.UI.TabWidget.prototype.addItems=function()
{
    for( let i=0; i < arguments.length; i+=2 )
        this.addItem( arguments[i], arguments[i+1] );
};

VG.UI.TabWidget.prototype.mouseMove=function( event )
{
    let headerHeight = this.small ? VG.UI.stylePool.current.skin.TabWidgetSmallHeader.Height : VG.UI.stylePool.current.skin.TabWidgetHeader.Height;
    if ( event.pos.y >= this.rect.y && event.pos.y <= this.rect.y + headerHeight )
        VG.update();
};

VG.UI.TabWidget.prototype.mouseDown=function( event )
{
    let headerHeight = this.small ? VG.UI.stylePool.current.skin.TabWidgetSmallHeader.Height : VG.UI.stylePool.current.skin.TabWidgetHeader.Height;
    if ( event.pos.y >= this.rect.y && event.pos.y <= this.rect.y + headerHeight )
    {
        for ( let i=0; i < this.items.length; ++i )
        {
            let item=this.items[i];

            if ( event.pos.x >= item.rect.x && event.pos.x <= item.rect.x + item.rect.width ) {
                this.layout.current=item.object;
                this.currentItem = item;
                if ( this.changed ) this.changed( item.object, i );
            }
        }
    }
};

VG.UI.TabWidget.prototype.mouseUp=function( event )
{
};

VG.UI.TabWidget.prototype.calcSize=function( canvas )
{
    var size=this.layout.calcSize( canvas );
    this.minimumSize.set( this.layout.minimumSize );
    return size;
};

VG.UI.TabWidget.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawTabWidgetHeader( this, canvas );

    this.layout.rect.set( this.contentRect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.SnapperWidgetItem

VG.UI.SnapperWidgetItem=function( text, object, open, enabler, horizontal )
{
    VG.UI.Widget.call( this );

    this.text = text;
    this.object = object;
    this.open = open === undefined ? true : open;
    this.object.visible = this.open;
    this.rect = new VG.Core.Rect();
    this.horizontal = horizontal;

    if ( !horizontal ) {
        this.horizontalExpanding = true;
        this.verticalExpanding = false;

        this.minimumSize.height = VG.UI.stylePool.current.skin.SnapperWidgetItem.Height;
        this.maximumSize.height = VG.UI.stylePool.current.skin.SnapperWidgetItem.Height;
        this.preferredSize.height = VG.UI.stylePool.current.skin.SnapperWidgetItem.Height;
    } else {
        this.horizontalExpanding = false;
        this.verticalExpanding = true;

        this.minimumSize.width = VG.UI.stylePool.current.skin.SnapperWidgetItem.Height;
        this.maximumSize.width = VG.UI.stylePool.current.skin.SnapperWidgetItem.Height;
        this.preferredSize.width = VG.UI.stylePool.current.skin.SnapperWidgetItem.Height;
    }

    if ( enabler ) {
        this.enablerCB = VG.UI.CheckBox();
        this.enablerCB.undoText = enabler.undoText;
        this.enablerCB.bind( enabler.dc, enabler.path );
        this.enablerCB.changed = enabler.changed;

        this.childWidgets = [ this.enablerCB ];
    }
};

VG.UI.SnapperWidgetItem.prototype=VG.UI.Widget();

VG.UI.SnapperWidgetItem.prototype.calcSize=function( canvas )
{
    return this.preferredSize;
};

VG.UI.SnapperWidgetItem.prototype.mouseMove=function( event )
{
};

VG.UI.SnapperWidgetItem.prototype.mouseDown=function( event )
{
    this.open = !this.open;
    this.object.visible = this.open;
    this.mouseIsDown = true;

    VG.update();
};

VG.UI.SnapperWidgetItem.prototype.mouseUp=function( event )
{
    this.mouseIsDown = false;
};

VG.UI.SnapperWidgetItem.prototype.paintWidget=function( canvas )
{
    if ( !this.horizontal ) VG.UI.stylePool.current.drawSnapperWidgetItem( this, canvas );
    else VG.UI.stylePool.current.drawHorizontalSnapperWidgetItem( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.SnapperWidget

VG.UI.SnapperWidget=function( { text, horizontal = false } = {} )
{
    if ( !(this instanceof VG.UI.SnapperWidget) ) return new VG.UI.SnapperWidget( { text, horizontal } );
    VG.UI.Widget.call( this );

    this.name="SnapperWidget";
    this.text=text === undefined ? "" : text;

    this._horizontal = horizontal;

    this.layout=VG.UI.Layout();
    this.layout.vertical = !this._horizontal;
    this.layout.margin.set( 0, 0, 0, 0 );
    this.layout.spacing=0;
    this.layout.parent=this;

    this.supportsFocus=false;

    this.items=[];

    for( var i=1; i < arguments.length; i+=2 )
        this.addItem( arguments[i], arguments[i+1] );
};

VG.UI.SnapperWidget.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.SnapperWidget.prototype, "disabled", {
    get: function() {
        return this._disabled;
    },
    set: function( value ) {
        this._disabled=value;
        for( var i=0; i < this.layout.children.length; ++i )
        {
            this.layout.children[i].disabled=value;
        }
    }
});

VG.UI.SnapperWidget.prototype.addItem=function( text, object, open, enabler )
{
    let item = new VG.UI.SnapperWidgetItem( text, object, open, enabler, this._horizontal );
    item.widget = this;

    this.items.push( item );
    this.layout.addChild( item );
    this.layout.addChild( object );

    VG.update();
    return item;
};

VG.UI.SnapperWidget.prototype.addItems=function()
{
    for( let i=0; i < arguments.length; i+=2 )
        this.addItem( arguments[i], arguments[i+1] );
};

VG.UI.SnapperWidget.prototype.mouseMove=function( event )
{
};

VG.UI.SnapperWidget.prototype.mouseDown=function( event )
{
};

VG.UI.SnapperWidget.prototype.mouseUp=function( event )
{
};

VG.UI.SnapperWidget.prototype.calcSize=function( canvas )
{
    let size = this.layout.calcSize( canvas );
    this.minimumSize.set( this.layout.minimumSize );
    return size;
};

VG.UI.SnapperWidget.prototype.paintWidget=function( canvas )
{
    this.layout.rect.set( this.rect );
    this.layout.layout( canvas );
};

/**
 * Creates a slider widget.
 *
 * @param {number} min - The initial minimum value of the slider.
 * @param {number} max - The initial maximum value of the slider.
 * @param {number} step - The initial step size of the slider.
 * @param {bool} editable - True if the current value should be editable.
 * @param {number} precision - Indicates how many floating point values should be used for the slider.
 * @property {number} min - The minimum value of the slider.
 * @property {number} max - The maximum value of the slider.
 * @property {number} step - The step size of the slider.
 * @property {number} value - The current value of the slider.
 * @property {callback} changed - Callback will be called when the current value changes, will suppy the current value as parameter.
 * @constructor
 */
/*
VG.UI.Slider=function( min, max, step, editable, precision )
{
    if ( !(this instanceof VG.UI.Slider) ) return new VG.UI.Slider( min, max, step, editable, precision );

    VG.UI.Widget.call( this );
    this.name="Slider";

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.minimumSize.set( 100, 20 );

    this.supportsFocus=true;
    this.min=min;
    this.max=max;
    this.step=step;
    this._value=min;

    this.sliderRect=VG.Core.Rect();
    this.sliderHandleRect=VG.Core.Rect();

    this.checked=false;
    this.dragging=false;

    if ( editable ) {
        this.editable=true;
        this.edit=VG.UI.NumberEdit( min, min, max, precision );
        this.edit.changed=function( value, cont, object, fromModel ) {
            this.value=value;

            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.value, undoText : this.undoText } );

            if ( this.changed )
                this.changed.call( VG.context, this.value, false, this, fromModel );
        }.bind( this );
        this.childWidgets=[ this.edit ];
    }
};

VG.UI.Slider.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.Slider.prototype, "value", {
    get: function() {
        return this._value;
    },
    set: function( value ) {
        this._value=value;
        if ( this.edit )
            this.edit.value=value;
    }
});

Object.defineProperty( VG.UI.Slider.prototype, "toolTip", {
    get: function() {
        return this._toolTip;
    },
    set: function( value ) {
        this._toolTip=value;
        if ( this.edit )
            this.edit.toolTip=value;
    }
});
*/
/**
 * Binds the widget to the data model. This widget has to be bound to a Number value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */
/*
VG.UI.Slider.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.Slider.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.value=this.min;
    else this.value=value;

    if ( this.changed )
        this.changed.call( VG.context, value, false, this, true );

    if ( this.edit )
        this.edit.value=value;

    VG.update();
};

VG.UI.Slider.prototype.calcSize=function( canvas )
{
    this.preferredSize.set( 100, canvas.getLineHeight() );
    return this.preferredSize;
};

VG.UI.Slider.prototype.mouseDown=function( event )
{
    if ( !this.rect.contains( event.pos ) ) return;

    if ( this.sliderHandleRect.contains( event.pos ) )
    {
        this.startValue=this.value;
        this.dragging=true;

        VG.context.workspace.mouseTrackerWidget=this;
    } else
    if ( event.pos.x >= this.sliderRect.x && event.pos.x <= (this.sliderRect.x + this.sliderRect.width) )
    {
        this.startValue=this.value;
        var offset=event.pos.x - this.sliderRect.x;
        this.gotoPixelOffset( offset );
        this.dragging=true;
    }

    VG.update();
};

VG.UI.Slider.prototype.mouseMove=function( event )
{
    if ( this.dragging )
    {
        var offset=event.pos.x - this.sliderRect.x;
        this.gotoPixelOffset( offset );
        VG.update();
    }
};

VG.UI.Slider.prototype.gotoPixelOffset=function( offset )
{
    if ( offset < 0 ) offset=0;
    if ( offset >= this.sliderRect.width ) offset=this.sliderRect.width;

    var oldValue=this.value;
    var distance, perPixel;

    if ( !this.halfWidthValue )
    {
        distance=this.max - this.min;
        perPixel=distance / this.sliderRect.width;

        if ( this.step == Math.round( this.step ) )
            this.value=this.min + Math.round( offset * perPixel );
        else
            this.value=this.min + offset * perPixel;
    } else
    {
        if ( offset <= this.sliderRect.width / 2 )
        {
            distance=this.halfWidthValue - this.min;
            perPixel=distance / this.sliderRect.width * 2;

            if ( this.step == Math.round( this.step ) )
                this.value=this.min + Math.round( offset * perPixel );
            else
                this.value=this.min + offset * perPixel;
        } else
        {
            offset-=this.sliderRect.width / 2;
            distance=this.max - this.halfWidthValue;
            perPixel=distance / this.sliderRect.width * 2;

            if ( this.step == Math.round( this.step ) )
                this.value=this.halfWidthValue + Math.round( offset * perPixel );
            else
                this.value=this.halfWidthValue + offset * perPixel;
        }
    }

    if ( oldValue !== this.value ) {
        if ( this.changed )
            this.changed.call( VG.context, this.value, true, this );

        if ( this.edit )
            this.edit.value=this.value;
    }
};

VG.UI.Slider.prototype.mouseUp=function( event )
{
    if ( this.dragging ) {

        if ( this.changed )
            this.changed.call( VG.context, this.value, false, this );

        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : this.value, undoText : this.undoText } );
    }
    this.dragging=false;
    VG.context.workspace.mouseTrackerWidget=null;
};

VG.UI.Slider.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );

    VG.UI.stylePool.current.drawSlider( this, canvas );
};
*/
/**
 * Creates a slider widget.
 *
 * @param {number} min - The initial minimum value of the slider.
 * @param {number} max - The initial maximum value of the slider.
 * @param {number} step - The initial step size of the slider.
 * @param {bool} editable - True if the current value should be editable.
 * @param {number} precision - Indicates how many floating point values should be used for the slider.
 * @property {number} min - The minimum value of the slider.
 * @property {number} max - The maximum value of the slider.
 * @property {number} step - The step size of the slider.
 * @property {number} value - The current value of the slider.
 * @property {callback} changed - Callback will be called when the current value changes, will suppy the current value as parameter.
 * @constructor
 */

VG.UI.Slider=function( { min=0, max=100, step=1, editable=true, precision=0, noValue, value, halfWidthValue } = {} )
{
    if ( !(this instanceof VG.UI.Slider) ) return new VG.UI.Slider( { min : min, max : max, step : step, editable : editable, precision : precision, noValue : noValue, value : value, halfWidthValue: halfWidthValue } );

    VG.UI.Widget.call( this );
    this.name="Slider";

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.minimumSize.set( 100, 20 );

    this.supportsFocus=true;
    this.min=min;
    this.max=max;
    this.step=step;
    this._value=value !== undefined ? value : min;
    this.noValue=noValue;
    this.halfWidthValue=halfWidthValue;

    this.sliderRect=VG.Core.Rect();
    this.sliderHandleRect=VG.Core.Rect();

    this.checked=false;
    this.dragging=false;

    if ( editable ) {
        this.editable=true;
        this.edit=VG.UI.NumberEdit( min, min, max, precision );
        this.edit.value = this._value;
        this.edit.changed=function( value, cont, object, fromModel ) {
            this.value=value;

            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.value, undoText : this.undoText } );

            if ( this.changed )
                this.changed.call( VG.context, this.value, false, this, fromModel );
        }.bind( this );
        this.childWidgets=[ this.edit ];
    }
};

VG.UI.Slider.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.Slider.prototype, "value", {
    get: function() {
        return this._value;
    },
    set: function( value ) {
        this._value=value;
        if ( this.edit )
            this.edit.value=value;
    }
});

Object.defineProperty( VG.UI.Slider.prototype, "toolTip", {
    get: function() {
        return this._toolTip;
    },
    set: function( value ) {
        this._toolTip=value;
        if ( this.edit )
            this.edit.toolTip=value;
    }
});

/**
 * Binds the widget to the data model. This widget has to be bound to a Number value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.Slider.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.Slider.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.value=this.min;
    else this.value=value;

    if ( this.changed )
        this.changed.call( VG.context, value, false, this, true );

    if ( this.edit )
        this.edit.value=value;

    VG.update();
};

VG.UI.Slider.prototype.calcSize=function( canvas )
{
    this.preferredSize.set( 100, canvas.getLineHeight() );
    return this.preferredSize;
};

VG.UI.Slider.prototype.mouseDown=function( event )
{
    if ( !this.rect.contains( event.pos ) ) return;

    if ( this.sliderHandleRect.contains( event.pos ) )
    {
        this.startValue=this.value;
        this.dragging=true;

        VG.context.workspace.mouseTrackerWidget=this;
    } else
    if ( event.pos.x >= this.sliderRect.x && event.pos.x <= (this.sliderRect.x + this.sliderRect.width) )
    {
        this.startValue=this.value;
        var offset=event.pos.x - this.sliderRect.x;
        this.gotoPixelOffset( offset );
        this.dragging=true;
    }

    VG.update();
};

VG.UI.Slider.prototype.mouseMove=function( event )
{
    if ( this.dragging )
    {
        var offset=event.pos.x - this.sliderRect.x;
        this.gotoPixelOffset( offset );
        VG.update();
    }
};

VG.UI.Slider.prototype.gotoPixelOffset=function( offset )
{
    if ( offset < 0 ) offset=0;
    if ( offset >= this.sliderRect.width ) offset=this.sliderRect.width;

    var oldValue=this.value;
    var distance, perPixel;

    if ( !this.halfWidthValue )
    {
        distance=this.max - this.min;
        perPixel=distance / this.sliderRect.width;

        if ( this.step == Math.round( this.step ) )
            this.value=this.min + Math.round( offset * perPixel );
        else
            this.value=this.min + offset * perPixel;
    } else
    {
        if ( offset <= this.sliderRect.width / 2 )
        {
            distance=this.halfWidthValue - this.min;
            perPixel=distance / this.sliderRect.width * 2;

            if ( this.step == Math.round( this.step ) )
                this.value=this.min + Math.round( offset * perPixel );
            else
                this.value=this.min + offset * perPixel;
        } else
        {
            offset-=this.sliderRect.width / 2;
            distance=this.max - this.halfWidthValue;
            perPixel=distance / this.sliderRect.width * 2;

            if ( this.step == Math.round( this.step ) )
                this.value=this.halfWidthValue + Math.round( offset * perPixel );
            else
                this.value=this.halfWidthValue + offset * perPixel;
        }
    }

    if ( oldValue !== this.value ) {
        if ( this.changed )
            this.changed.call( VG.context, this.value, true, this );

        if ( this.edit )
            this.edit.value=this.value;
    }
};

VG.UI.Slider.prototype.mouseUp=function( event )
{
    if ( this.dragging ) {

        if ( this.changed )
            this.changed.call( VG.context, this.value, false, this );

        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : this.value, undoText : this.undoText } );
    }
    this.dragging=false;
    VG.context.workspace.mouseTrackerWidget=null;
};

VG.UI.Slider.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );

    VG.UI.stylePool.current.drawRoundSlider( this, canvas );
};

/**
 * Creates a color wheel widget.
 * @param {bool} expanding - True if the wheel should adjust to the size of the widget, false if the default widget size should be fixed (by default 80x80).
 * @property {number} hue - The current hue value.
 * @property {number} saturation - The current saturation value.
 * @property {number} lightness - The current lightness value.
 * @property {VG.Core.Color} color - The current RGB values.
 * @property {callback} changed - The callback will be called with the color object when the color wheel changes.
 * @constructor
 */

VG.UI.ColorWheel=function( expanding )
{
    if ( !(this instanceof VG.UI.ColorWheel) ) return new VG.UI.ColorWheel( expanding );

    VG.UI.Widget.call(this);
    this.name="ColorWheel";
    this.supportsFocus=true;

    this.horizontalExpanding=true;
    this.verticalExpanding=true;

    this._hue=0;
    this._saturation=1.0;
    this._lightness=0.5;

    this.hueDot=new VG.Math.Vector2();

    this._color=VG.Core.Color();

    // --- Triangle Colors
    this.ls1=VG.Core.Color();
    this.ls2=VG.Core.Color();
    this.ls3=VG.Core.Color();

    // --- Triangle Points
    this.ls1Pt=new VG.Math.Vector2();
    this.ls2Pt=new VG.Math.Vector2();
    this.ls3Pt=new VG.Math.Vector2();

    this.toRGBA();

    this.borderColor=VG.Core.Color( 128, 128, 128 );
    this.centerColor=VG.Core.Color( 70, 70, 70 );

    this.hueSize=12;

    if ( !expanding )
    {
        this.setFixedSize( 80, 80 );
        this.hueSize=8;
    }

    this.lastRect=VG.Core.Rect();
};

VG.UI.ColorWheel.prototype=VG.UI.Widget();

Object.defineProperty(VG.UI.ColorWheel.prototype, "hue",
{
    get: function() {
        return this._hue;
    },
    set: function(hue) {

        this._hue = hue;

        this.toRGBA();
    }
});

Object.defineProperty(VG.UI.ColorWheel.prototype, "saturation",
{
    get: function() {
        return this._saturation;
    },
    set: function(sat) {

        this._saturation = VG.Math.clamp(sat, 0.0, 1.0);
        this.toRGBA();
    }
});

Object.defineProperty(VG.UI.ColorWheel.prototype, "lightness",
{
    get: function() {
        return this._ligtness;
    },
    set: function(lit) {

        this._ligtness = VG.Math.clamp(lit, 0.0, 1.0);
        this.toRGBA();
    }
});

Object.defineProperty(VG.UI.ColorWheel.prototype, "color",
{
    get: function() {
        return this._color;
    },
    set: function(color) {
        this._color.copy(color);

        var hsl = this._color.toHSL();

        this.hue = hsl.h * 360;
        this._saturation = hsl.s;
        this._lightness = hsl.l;

        this.toRGBA();
    }
});

VG.UI.ColorWheel.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.ColorWheel.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.color=VG.Core.Color.Black;
    else this.color=VG.Core.Color( value );

    if ( this.changed )
        this.changed.call( VG.context, this._color, false, this, true );

    VG.update();
};

VG.UI.ColorWheel.prototype.toRGBA=function()
{
    var h = this._hue;
    var s = this._saturation;
    var l = this._lightness;

    this._color.setHSL(h, s, l);

    this.ls1.setHSL(h, 0.0, 0.0);
    this.ls2.setHSL(h, 1.0, 0.5);
    this.ls3.setHSL(h, 0.0, 1.0);

    this.dirty=true;
};

VG.UI.ColorWheel.prototype.calcSize=function( canvas )
{
    return this.minimumSize;
};

VG.UI.ColorWheel.prototype.mouseMove=function(event)
{
    if ( this.hueDrag ) {
        this.computeHueFromEvent( event );
        this.toRGBA();

        if ( this.changed )
            this.changed( this._color, true, this );

        VG.update();
    } else
    if ( this.slDrag )
    {
        this.computeSLFromEvent( event );
        this.toRGBA();

        if ( this.changed )
            this.changed( this._color, true, this );

        VG.update();
    }
};

VG.UI.ColorWheel.prototype.mouseUp=function(event)
{
    if ( this.hueDrag || this.slDrag )
    {
        if ( this.collection && this.path )
            VG.context.dc.storeDataForPath( { path : this.path, value : this._color.toHex(), undoText : this.undoText } );

        if ( this.changed )
            this.changed( this._color, false, this );
    }

    VG.context.workspace.mouseTrackerWidget=null;

    this.hueDrag=false;
    this.slDrag=false;
};

VG.UI.ColorWheel.prototype.mouseDown=function(event)
{
    VG.context.workspace.mouseTrackerWidget=this;

    var centerX=this.rect.x + this.rect.width / 2, centerY=this.rect.y + this.rect.height / 2;

    var dCX=centerX - event.pos.x, dCY=centerY - event.pos.y;
    var dToCenter=Math.sqrt( dCX * dCX + dCY * dCY );

    this.hueDrag=false;

    if ( dToCenter >= this.circleSize/2 - this.hueSize )
    {
        this.hueDrag=true;
        this.computeHueFromEvent( event );

        this.toRGBA();

        if ( this.changed )
            this.changed( this._color, true, this );

        VG.update();
    } else
    {
        this.slDrag=true;
        this.computeSLFromEvent( event );

        this.toRGBA();

        if ( this.changed )
            this.changed( this._color, true, this );

        VG.update();
    }
};

VG.UI.ColorWheel.prototype.computeHueFromEvent=function( event )
{
    var localX = event.pos.x - this.rect.x;
    var localY = event.pos.y - this.rect.y;

    //the center
    var center = new VG.Math.Vector2( this.circleSize /2, this.circleSize / 2 );

    //mouse click position
    var mouse = new VG.Math.Vector2( localX, localY );

    var vD = mouse.clone().sub( center );
    vD.normalize();

    vD.mul( this.circleSize / 2 - this.hueSize / 2 );

    var v1 = center.clone().add( vD );

    this._hue = VG.Math.deg( center.angleTo( v1 ) ) + 180;
};

VG.UI.ColorWheel.prototype.computeSLFromEvent=function( event )
{
    function pDistance(x, y, x1, y1, x2, y2)
    {
      var A = x - x1;
      var B = y - y1;
      var C = x2 - x1;
      var D = y2 - y1;

      var dot = A * C + B * D;
      var len_sq = C * C + D * D;
      var param = -1;
      if (len_sq !== 0) //in case of 0 length line
          param = dot / len_sq;

      var xx, yy;

      if (param < 0) {
        xx = x1;
        yy = y1;
      }
      else if (param > 1) {
        xx = x2;
        yy = y2;
      }
      else {
        xx = x1 + param * C;
        yy = y1 + param * D;
      }

      var dx = x - xx;
      var dy = y - yy;
      return Math.sqrt(dx * dx + dy * dy);
    }

    function isLeft( a, b, c) {
        return ((b.x - a.x)*(c.y - a.y) - (b.y - a.y)*(c.x - a.x)) > 0;
    }

    var dSL13X=this.ls3Pt.x - this.ls1Pt.x;
    var dSL13Y=this.ls3Pt.y - this.ls1Pt.y;

    var midX=this.ls3Pt.x - dSL13X * 0.5;
    var midY=this.ls3Pt.y - dSL13Y * 0.5;

    var dWidthX=midX - this.ls2Pt.x;
    var dWidthY=midY - this.ls2Pt.y;

    var rectWidth=Math.sqrt( dWidthX * dWidthX + dWidthY * dWidthY );
    var rectHeight=Math.sqrt( dSL13X * dSL13X + dSL13Y * dSL13Y );

    // --- Get Saturation and Lightness

    /**
     * Is p1 on the left side of p2p3?
     * @param p1
     * @param p2
     * @param p3
     * @returns {Number}
     */
    function signOf(p1, p2, p3){
        "use strict";
        return (p2.x-p1.x) * (p3.y-p1.y) - (p2.y-p1.y) * (p3.x-p1.x);
    }

    function limit(v){
        "use strict";
        if(v<0) return 0;
        if(v>1) return 1;
        return v;
    }

    var ev = new VG.Math.Vector2(event.pos.x, event.pos.y);

    var b1 = signOf(ev, this.ls1Pt, this.ls2Pt) >= 0;
    var b2 = signOf(ev, this.ls2Pt, this.ls3Pt) >= 0;
    var b3 = signOf(ev, this.ls3Pt, this.ls1Pt) >= 0;

    var fail = false;
    // in this case coordinate axis is clockwise
    if(b1 && b2 && b3) { // inside triangle
        ev.sub(this.ls1Pt);
    } else if(b2 && b3) {
        let line = this.ls2Pt.clone().sub(this.ls1Pt);
        ev.sub(this.ls1Pt);
        ev.copy(line.mul(limit(line.dot(ev)/(line.length()*line.length()))));
    } else if (b1 && b2){
        let line = this.ls3Pt.clone().sub(this.ls1Pt);
        ev.sub(this.ls1Pt);
        ev.copy(line.mul(limit(line.dot(ev)/(line.length()*line.length()))));
    } else if (b1 && b3){
        var line = this.ls2Pt.clone().sub(this.ls3Pt);
        ev.sub(this.ls3Pt);
        ev.copy(line.mul(limit(line.dot(ev)/(line.length()*line.length()))));
        ev.add(this.ls3Pt).sub(this.ls1Pt);
    } else {
        fail = true;
    }
    if(!fail) {
        // at this point ev is wrt. p1
        var p3 = this.ls3Pt.clone().sub(this.ls1Pt);
        var side = p3.length();
        this._lightness = p3.dot(ev) / (side * side);
        if (this._lightness > 0.01 && this._lightness < 0.99) {
            var up = this.ls3Pt.clone().add(this.ls1Pt).mul(-0.5).add(this.ls2Pt);
            this._saturation = ev.clone().dot(up) / up.length() / up.length() * 0.5 / ((this._lightness < 0.5 ? this._lightness : 1 - this._lightness));
        }
    }

};

VG.UI.ColorWheel.prototype.computeUI=function(canvas)
{
    this.circleSize=Math.min( this.rect.width, this.rect.height );

    // --- Hue Dot

    var vC = new VG.Math.Vector2(this.circleSize / 2, this.circleSize / 2);

    var vD = new VG.Math.Vector2();
    vD.dirFromAngle(VG.Math.rad(this._hue - 180));
    vD.normalize();

    vD.mul( this.circleSize /2 - this.hueSize / 2 );

    this.hueDot.copy( vC );
    this.hueDot.add( vD );

    // --- SL Triangle

    vD = new VG.Math.Vector2();
    vD.dirFromAngle(VG.Math.rad(this._hue - 180));
    vD.normalize();

    vD.mul( this.circleSize /2 - this.hueSize - 2 );

    this.ls2Pt.copy( vC );
    this.ls2Pt.x+=this.rect.x; this.ls2Pt.y+=this.rect.y;
    this.ls2Pt.add(vD);

    //

    vD = new VG.Math.Vector2();
    vD.dirFromAngle(VG.Math.rad(this._hue - 180 + 120));
    vD.normalize();

    vD.mul( this.circleSize /2 - this.hueSize - 2 );

    this.ls1Pt.copy( vC );
    this.ls1Pt.x+=this.rect.x; this.ls1Pt.y+=this.rect.y;
    this.ls1Pt.add(vD);

    //

    vD = new VG.Math.Vector2();
    vD.dirFromAngle(VG.Math.rad(this._hue - 180 - 120));
    vD.normalize();

    vD.mul( this.circleSize /2 - this.hueSize - 2 );

    this.ls3Pt.copy( vC );
    this.ls3Pt.x+=this.rect.x; this.ls3Pt.y+=this.rect.y;
    this.ls3Pt.add(vD);

    // --- SL Dot

    // assume iso-sides triangle, with peak at p2
    // assume we work in coordinate with P1 as origin
    var base = this.ls3Pt.clone().sub(this.ls1Pt).mul(this._lightness);
    var up = this.ls3Pt.clone().add(this.ls1Pt).mul(-0.5).add(this.ls2Pt);
    this.slDot = base.add(
        up.mul(
            (this._lightness < 0.5 ? this._lightness : 1-this._lightness) *2.0*this._saturation )
    ).add(this.ls1Pt);

    // ---

    this.dirty=false;
};

VG.UI.ColorWheel.prototype.paintWidget=function(canvas)
{
    if ( !this.lastRect.equals( this.rect ) ) this.dirty=true;
    if ( this.disabled ) canvas.setAlpha( 0.8 );

    if ( this.dirty )
        this.computeUI();

    var rect=this.contentRect;
    rect.copy( this.rect );

    canvas.draw2DShape( VG.Canvas.Shape2D.CircleHue, rect );
    canvas.draw2DShape( VG.Canvas.Shape2D.CircleOutline, rect, this.borderColor );

    rect.shrink( this.hueSize, this.hueSize, rect );
    canvas.draw2DShapeGL( VG.Canvas.Shape2D.Circle, rect, this.centerColor );

    // --- Hue Dot

    rect.x = this.rect.x + ( this.hueDot.x - this.hueSize/2 );
    rect.y = this.rect.y + ( this.hueDot.y - this.hueSize/2 );

    rect.width = this.hueSize;
    rect.height = this.hueSize;

    canvas.draw2DShapeGL( VG.Canvas.Shape2D.Circle, rect, VG.Core.Color.Black );
    canvas.draw2DShapeGL( VG.Canvas.Shape2D.Circle, rect.shrink(1,1), VG.Core.Color.White );

    // --- SL Triangle

    canvas.addTriangle2D( this.ls1Pt.x, this.ls1Pt.y,
        this.ls2Pt.x, this.ls2Pt.y, this.ls3Pt.x, this.ls3Pt.y, this.ls1, this.ls2, this.ls3 );

    // --- SL Dot

    rect.x=this.slDot.x - 4;
    rect.y=this.slDot.y - 4;

    rect.width = 8;
    rect.height = 8;

    canvas.draw2DShapeGL( VG.Canvas.Shape2D.Circle, rect, VG.Core.Color.White );
    rect.shrink( 1, 1, rect );
    canvas.draw2DShapeGL( VG.Canvas.Shape2D.Circle, rect, VG.Core.Color.Black );

    this.lastRect.copy( this.rect );
    if ( this.disabled ) canvas.setAlpha( 1 );
};

// ----------------------------------------------------------------- VG.UI.ColorEdit

VG.UI.ColorEdit=function( { alpha = false } = {} )
{
    if ( !(this instanceof VG.UI.ColorEdit) ) return new VG.UI.ColorEdit( { alpha }  );

    VG.UI.Widget.call(this);
    this.name="ColorEdit";

    this.supportsFocus=true;
    this._color=VG.Core.Color();

    this.minimumSize.height = 26;
    this.maximumSize.height = 26;
    this.preferredSize.height = 26;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.colorEdit=VG.UI.TextLineEdit( this.color.toHex() );
    this.colorEdit.maximumSize.width=80;
    this.colorEdit.textChanged=function( value, continous ) {
        this._color.setHex( value );
        this.color=this._color;
        if ( this.changed ) this.changed( this._color, false, this );
    }.bind( this );

    this.colorWheel=VG.UI.ColorWheel();
    this.colorWheel.color=this._color;
    this.colorWheel.changed=function( value, continous ) {
        if ( continous ) return;
        this._color.copy( value );
        // this.color=this._color;
        this.colorEdit.text=this.color.toHex();
        if ( this.changed ) this.changed( this._color, false, this );
    }.bind( this );

    if ( alpha ) {
        this.alphaSlider = new VG.UI.Slider( { min : 0, max : 1, step: 0.01, editable : true, precision: 2 } );
        this.alphaSlider.toolTip="Alpha (transparency) value of the color.";
        this.alphaSlider.text="Alpha";
        this.alphaSlider.changed=function( value, cont ) {
            this._material.a = value;
            this.material.color.a = value;
            this.material=this._material;
            if ( this.changed ) this.changed( this._material, cont, this );
        }.bind( this );
    }

    this.colorLayout = VG.UI.LabelLayout( "Color", this.colorWheel );
    if ( alpha ) this.colorLayout.addChild( this.alphaSlider );

    this.toolSettings = new VG.UI.ToolSettings( VG.UI.Label( { svgName : "icons.svg", svgGroupName : "ToolSettings", color : this._color } ),
        { layout : this.colorLayout, width: 150, height: 110, noHeader: true, text : "Color Settings", autoClose: true } );

    this.layout = new VG.UI.Layout( this.colorEdit, this.toolSettings );
    this.layout.margin.left = 0;

    Object.defineProperty( this.layout, "disabled", {
        get: () => this.parent ? this.parent._disabled : this._disabled
    } );
};

VG.UI.ColorEdit.prototype=VG.UI.Widget();

Object.defineProperty(VG.UI.ColorEdit.prototype, "color",
{
    get: function() {
        return this._color;
    },
    set: function(color) {

        this._color.copy(color);

        this.colorWheel.color=color;
        this.colorEdit.text=this.color.toHex();
    }
});

Object.defineProperty(VG.UI.ColorEdit.prototype, "disabled",
{
    get: function() {
        if ( !this.parent ) return this.colorEdit.disabled;
        else  return this.colorEdit.disabled | this.parent.disabled;
    },
    set: function(disabled) {
        this.colorWheel.disabled=disabled;
        this.colorEdit.disabled=disabled;
    }
});

Object.defineProperty(VG.UI.ColorEdit.prototype, "toolTip",
{
    get: function() {
        return this.colorEdit.toolTip;
    },
    set: function(value) {

        this.colorWheel.toolTip=value;
        this.colorEdit.toolTip=value;
    }
});

VG.UI.ColorEdit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    this.colorWheel.bind( collection, path );
    this.colorEdit.bind( collection, path );
};

VG.UI.ColorEdit.prototype.paintWidget=function(canvas)
{
    this.layout.rect.copy( this.rect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.MaterialEdit

VG.UI.MaterialEdit=function( { alpha = false } = {} )
{
    if ( !(this instanceof VG.UI.MaterialEdit) ) return new VG.UI.MaterialEdit( { alpha } );

    VG.UI.Widget.call(this);
    this.name="MaterialEdit";

    this.preferredSize.height = 26;
    this.minimumSize.height = 26;
    this.maximumSize.height = 26;
    this.supportsFocus=true;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this._material=VG.Core.Material();

    this.colorWheel=VG.UI.ColorWheel();
    this.colorWheel.color=this._material.color;
    this.colorWheel.changed=function( value, continous ) {
        this._material.copy( value );
        this.material=this._material;
        if ( this.changed ) this.changed( this._material, continous, this );
    }.bind( this );

    this.colorEdit=VG.UI.TextLineEdit( this._material.color.toHex() );
    this.colorEdit.maximumSize.width=80;
    this.colorEdit.textChanged=function( value, continous ) {
        this._material.color.setHex( value );
        this.material=this._material;
        if ( this.changed ) this.changed( this._material, false, this );
    }.bind( this );

    if ( alpha ) {
        this.alphaSlider = new VG.UI.Slider( { min : 0, max : 1, step: 0.01, editable : true, precision: 2 } );
        this.alphaSlider.toolTip="Alpha (transparency) value of the color.";
        this.alphaSlider.text="Alpha";
        this.alphaSlider.changed=function( value, cont ) {
            this._material.a = value;
            this.material.color.a = value;
            this.material=this._material;
            if ( this.changed ) this.changed( this._material, cont, this );
        }.bind( this );
    }

    this.metallicSlider = new VG.UI.Slider( { min : 0, max : 1, step: 0.01, editable : true, precision: 2 } );
    this.metallicSlider.toolTip="Metallic property of the Material.";
    this.metallicSlider.text="Metallic";
    this.metallicSlider.changed=function( value, cont ) {
        this._material.metallic=value;
        if ( this.changed ) this.changed( this._material, cont, this );
    }.bind( this );

    this.smoothnessSlider = new VG.UI.Slider( { min : 0, max : 1, step: 0.01, editable : true, precision: 2 } );
    this.smoothnessSlider.toolTip="Smoothness property of the Material.";
    this.smoothnessSlider.text="Smoothness";
    this.smoothnessSlider.changed=function( value, cont ) {
        this._material.smoothness=value;
        if ( this.changed ) this.changed( this._material, cont, this );
    }.bind( this );

    this.reflectanceSlider = new VG.UI.Slider( { min : 0, max : 1, step: 0.01, editable : true, precision: 2 } );
    this.reflectanceSlider.toolTip="Reflectance property of the Material.";
    this.reflectanceSlider.text="Reflectance";
    this.reflectanceSlider.changed=function( value, cont ) {
        this._material.reflectance=value;
        if ( this.changed ) this.changed( this._material, cont, this );
    }.bind( this );

    this.materialLayout=VG.UI.LabelLayout( "Color", this.colorWheel );
    if ( alpha ) this.materialLayout.addChild( "Alpha", this.alphaSlider );
    this.materialLayout.addDivider();
    this.materialLayout.addChild( "Metallic", this.metallicSlider );
    this.materialLayout.addChild( "Smoothness", this.smoothnessSlider );
    this.materialLayout.addChild( "Reflectance", this.reflectanceSlider );

    this.toolSettings = new VG.UI.ToolSettings( VG.UI.Label( { svgName : "icons.svg", svgGroupName : "ToolSettings", color : this._material.color } ),
        { layout : this.materialLayout, width: 260, height: 224, noHeader: true, text : "Material Settings" } );

    this.layout = new VG.UI.Layout( this.colorEdit, this.toolSettings );
    this.layout.margin.left = 0;
};

VG.UI.MaterialEdit.prototype=VG.UI.Widget();

Object.defineProperty(VG.UI.MaterialEdit.prototype, "material",
{
    get: function() {
        return this._material;
    },
    set: function(material) {

        this._material.copy( material );

        this.metallicSlider.value = material.metallic;
        this.smoothnessSlider.value = material.smoothness;
        this.reflectanceSlider.value = material.reflectance;

        if ( this.alphaSlider ) this.alphaSlider.value = material.color.a;
        this.colorWheel.color = material.color;
        this.colorEdit.text = material.color.toHex();
    }
});

Object.defineProperty(VG.UI.MaterialEdit.prototype, "disabled",
{
    get: function() {
        return this.colorEdit.disabled;
    },
    set: function(disabled) {

        this.colorWheel.disabled=disabled;
        this.colorEdit.disabled=disabled;
    }
});

VG.UI.MaterialEdit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    this.colorWheel.bind( collection, path );
    this.colorEdit.bind( collection, path );
};

VG.UI.MaterialEdit.prototype.paintWidget=function(canvas)
{
    this.layout.rect.copy( this.rect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolTipWidget

VG.UI.ToolTipWidget=function()
{
    if ( !(this instanceof VG.UI.ToolTipWidget) ) return new VG.UI.ToolTipWidget();

    VG.UI.Widget.call( this );
    this.name="ToolTip";

    this.offset=0;

    this.minimumSize.set( 100, 100 );
    this.supportsFocus=true;

    this.spacing=0;
};

VG.UI.ToolTipWidget.prototype=VG.UI.Widget();

VG.UI.ToolTipWidget.prototype.setToolTip=function( canvas, widget )
{
    this.textLines=[];

    canvas.wordWrap( widget.toolTip, 0, 300, this.textLines );
    this.width=0;
    this.height=0;
    this.title=undefined;

    if ( widget.text && widget.text.length && isNaN( widget.text ) ) {

        this.title=widget.text;

        canvas.pushFont( canvas.style.skin.ToolTip.TitleFont );
        this.height=canvas.getLineHeight() + 10;
        canvas.popFont();
    }

    canvas.pushFont( canvas.style.skin.ToolTip.Font );
    this.height+=canvas.getLineHeight() * this.textLines.length + 2 * canvas.style.skin.ToolTip.BorderSize.height;

    var size=VG.Core.Size();

    for( var i=0; i < this.textLines.length; ++i ) {
        canvas.getTextSize( this.textLines[i], size );
        if ( size.width > this.width ) this.width=size.width;
    }

    this.width+=2 * canvas.style.skin.ToolTip.BorderSize.width + 2;
    canvas.popFont();
};

VG.UI.ToolTipWidget.prototype.paintWidget=function( canvas )
{
    this.rect.width=this.width;
    this.rect.height=this.height;

    if ( !this.rect.width || !this.rect.height ) return;
    this.rect.round();

    let rect = VG.context.workspace.getVisibleScreenRect( this.contentRect );

    if ( this.rect.bottom() > rect.bottom() ) this.rect.y-=this.rect.height;
    if ( this.rect.right() > rect.right() ) this.rect.x-=this.rect.width;

    if ( canvas.twoD ) canvas.clearGLRect( this.rect );

    canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutline, this.rect, canvas.style.skin.ToolTip.BorderColor );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect.shrink( 1, 1, this.contentRect ), canvas.style.skin.ToolTip.BackColor );

    this.contentRect.shrink( canvas.style.skin.ToolTip.BorderSize.width, canvas.style.skin.ToolTip.BorderSize.height, this.contentRect );

    if ( this.title ) {
        canvas.pushFont( canvas.style.skin.ToolTip.TitleFont );
        canvas.drawTextRect( this.title, this.contentRect, canvas.style.skin.ToolTip.TextColor, 0, 0 );
        this.contentRect.y+=canvas.getLineHeight() + 10;
        canvas.popFont();
    }

    canvas.pushFont( canvas.style.skin.ToolTip.Font );

    for( var i=0; i < this.textLines.length; ++i ) {
        canvas.drawTextRect( this.textLines[i], this.contentRect, canvas.style.skin.ToolTip.TextColor, 0, 0 );
        this.contentRect.y+=canvas.getLineHeight();
    }

    canvas.popFont();
};

// ----------------------------------------------------------------- VG.UI.ChatWidget

VG.UI.ChatWidget=function()
{
    if ( !(this instanceof VG.UI.ChatWidget) ) return new VG.UI.ChatWidget();

    VG.UI.Widget.call( this );

    this.htmlView=VG.UI.HtmlView();
    this.htmlView.readOnly=true;

    this.htmlView.elements.body.margin.left=5;
    this.htmlView.elements.body.margin.top=5;
    this.htmlView.elements.br.lineHeight=0;
    this.htmlView.elements.body.spacing=3;
    this.htmlView.elements.body.font=VG.Font.Font( "Open Sans Semibold", 13 );
    this.htmlView.elements.b.font=VG.Font.Font( "Open Sans Bold", 13 );

    this.htmlView.html="Please Login to use the Community Chat Feature.";

    this.textLineEdit=VG.UI.TextLineEdit();
    this.textLineEdit.disabled=true;

    this.postButton=VG.UI.Button( "Post" );
    this.postButton.disabled=true;
    this.postButton.clicked=function() {
        VG.DB.postAppChatMessage( VG.context.workspace.appId, "<b>" + this.userName + "</b>" + ": " + this.textLineEdit.text );
        this.textLineEdit.text="";
        VG.update();
    }.bind( this );

    this.bottomLayout=VG.UI.Layout( this.textLineEdit, this.postButton );
    this.bottomLayout.margin.set( 0, 1, 0, 0 );

    this.layout=VG.UI.Layout( this.htmlView, this.bottomLayout );
    this.layout.margin.clear();
    this.layout.vertical=true;

    this.requestSendAt=0;
    this.requestSendAtString=(new Date()).toISOString();
    this.messages="";
};

VG.UI.ChatWidget.prototype=VG.UI.Widget();

VG.UI.ChatWidget.prototype.setUserInfo=function( userName, appId )
{
    this.userName=userName;
    this.appId=appId;

    this.textLineEdit.disabled=!appId;
    this.postButton.disabled=!appId;

    if ( appId ) this.htmlView.html=this.messages;
    else this.htmlView.html="Please Login to use the Community Chat Feature.";
};

VG.UI.ChatWidget.prototype.paintWidget=function( canvas )
{
    if ( !this.requestSend && this.appId )
    {
        if ( Date.now() - this.requestSendAt > 3000 )
        {
            this.requestSend=true;
            this.requestSendAt=Date.now();

            VG.DB.getAppChatMessages( this.appId, function( messages ) {
                this.requestSend=false;

                for ( var i=0; i < messages.length; ++i )
                {
                    if ( messages[i].data && messages[i].data.msg ) {
                        var msg=messages[i].data.msg;

                        if ( msg ) {
                            this.messages+=msg + "<br>";
                            this.htmlView.html=this.messages;
                        }
                    }
                }
            }.bind( this ), this.requestSendAtString );

            this.requestSendAtString=(new Date()).toISOString();
        }
    }

    this.layout.rect.copy( this.rect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.AppWidget

VG.UI.AppWidget=function()
{
    if ( !(this instanceof VG.UI.AppWidget) ) return new VG.UI.AppWidget();

    VG.UI.Widget.call( this );

    this.supportsAutoFocus=true;
    this.childWidgets=[];
};

VG.UI.AppWidget.prototype=VG.UI.Widget();

VG.UI.AppWidget.prototype.setAppSource=function( type, content )
{
    //VG.log( type, content );

    var mainContext=VG.context;

    var appContext={ workspace : VG.UI.Workspace() };

    appContext.canvas=appContext.workspace.canvas;
    appContext.imagePool=mainContext.imagePool;
    appContext.svgPool=mainContext.svgPool;
    appContext.workspace.mainRect=VG.Core.Rect( mainContext.workspace.rect );
    appContext.style=VG.UI.stylePool.current;

    VG.context=appContext;

    if ( type === "Function" )
    {
        content( VG.context.workspace );
    } else
    if ( type === "Source" )
    {
        var success=true;
        try {
            eval( content );
        } catch ( e )
        {
            success=false;
        }

        if ( success ) vgMain.call( VG.context, VG.context.workspace );
    } else
    if ( type === "RemoteVIDE" )
    {
        this.loading=true;

        VG.DB.getAppSource( content, function( object ) {

            VG.context=appContext;
            var oldStyle=this.switchStyle( VG.UI.stylePool.styles[0] );

            VG.App=object.source;
            this.processVIDE( null, true );

            VG.context=mainContext;
            this.switchStyle( oldStyle );

            this.loading=false;
        }.bind( this ) );
    } else
    if ( type === "LocalVIDE" )
    {
        this.processVIDE( content );
    }

    VG.context=mainContext;
    this.appContext=appContext;
};

VG.UI.AppWidget.prototype.processVIDE=function( data, dontProcessData )
{
    if ( !dontProcessData ) {
        var appString="VG.App=";
        if ( data.search( appString ) === 0 ) {
            data=appString + data;
        }

        eval( data );
    }

    // --- Add the images of the project to the image pool
    for (var imageName in VG.App.images )  {
        var image=new VG.Core.Image();
        image.name=imageName;

        VG.decompressImageData( VG.App.images[imageName], image );
        VG.context.imagePool.addImage( image );
    }

    // --- Eval the sources of the App stored in the VG.App Namespace
    for (var sourceName in VG.App.sources )  {

        var decodedSource=VG.Utils.decompressFromBase64( VG.App.sources[sourceName] );

        try {
            eval( decodedSource );
        } catch ( e ) {
            success=false;
        }
    }

    // --- Add the SVGs of the project to the pool
    for (var svgName in VG.App.svg )  {
        var decodedSVG=VG.Utils.decompressFromBase64( VG.App.svg[svgName] );

        var svg=VG.Core.SVG( svgName, decodedSVG );
        VG.context.svgPool.addSVG( svg );
    }

    // ---

    var arg=[];
    vgMain.call( VG.context, VG.context.workspace, arg.length, arg );
};

VG.UI.AppWidget.prototype.paintWidget=function( canvas )
{
    if ( !this.appContext ) return;

    this.switchFromMain();

    if ( this.loading )
    {
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect, VG.UI.stylePool.current.skin.Widget.BackgroundColor );
        canvas.drawTextRect( "Loading Application from Database...", this.rect, VG.UI.stylePool.current.skin.Widget.TextColor, 1, 1 );
    } else
    {

        VG.context.workspace.mainRect.copy( this.mainContext.workspace.rect );

        VG.context.workspace.rect.copy( this.rect );
        VG.context.workspace.contentRect.copy( this.rect );

        VG.context.workspace.paintWidget();
    }

    this.switchToMain();
};

VG.UI.AppWidget.prototype.mouseMove=function( event )
{
    if ( this.appContext && this.appContext.workspace.rect.contains( event.pos ) ) {
        this.switchFromMain();
        this.appContext.workspace.mouseMove( event.pos.x, event.pos.y );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.mouseDown=function( event )
{
    if ( this.appContext && this.appContext.workspace.rect.contains( event.pos ) ) {
        this.switchFromMain();
        this.appContext.workspace.mouseDown( event.button );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.showContextMenu=function()
{
    if ( this.appContext ) {
        this.switchFromMain();
        this.appContext.workspace.showContextMenu();
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.mouseUp=function( event )
{
    if ( this.appContext && this.appContext.workspace.rect.contains( event.pos ) ) {
        this.switchFromMain();
        this.appContext.workspace.mouseUp( event.button );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.mouseDoubleClick=function( event )
{
    if ( this.appContext && this.appContext.workspace.rect.contains( event.pos ) ) {
        this.switchFromMain();
        this.appContext.workspace.mouseDoubleClick( event );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.mouseWheel=function( step )
{
    if ( this.appContext ) {
        this.switchFromMain();
        this.appContext.workspace.mouseWheel( step );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.keyDown=function( keyCode )
{
    if ( this.appContext ) {
        this.switchFromMain();
        this.appContext.workspace.keyDown( keyCode );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.keyUp=function( keyCode )
{
    if ( this.appContext ) {
        this.switchFromMain();
        this.appContext.workspace.keyUp( keyCode );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.textInput=function( text )
{
    if ( this.appContext ) {
        this.switchFromMain();
        this.appContext.workspace.textInput( text );
        this.switchToMain();
    }
};

VG.UI.AppWidget.prototype.switchFromMain=function()
{
    VG.context.workspace.canvas.flush();

    this.mainContext=VG.context;
    VG.context=this.appContext;

    this.switchStyle( VG.UI.stylePool.styles[0] );
};

VG.UI.AppWidget.prototype.switchToMain=function()
{
    VG.context.workspace.canvas.flush();
    VG.context=this.mainContext;

    this.switchStyle( this.appContext.style );
};

VG.UI.AppWidget.prototype.switchStyle=function( style )
{
    var oldStyle=VG.UI.stylePool.current;
    VG.context.workspace.switchToStyle( style );
    return oldStyle;
};

// ----------------------------------------------------------------- VG.UI.AppEditWidget

VG.UI.AppEditWidget=function( code )
{
    if ( !(this instanceof VG.UI.AppEditWidget) ) return new VG.UI.AppEditWidget( code );

    VG.UI.Widget.call( this );

    this.supportsAutoFocus=true;
    this.childWidgets=[];
    this.code=code ? code : "";

    this.codeEdit=VG.UI.CodeEdit( code );
    this.codeEdit.readOnly=false;

    // ---

    this.appWidget=VG.UI.AppWidget();

    this.runButton=VG.UI.Button( "Start" );
    this.runButton.clicked=function()
    {
        if ( !this.running )
        {
            this.appWidget.setAppSource( "Source", this.codeEdit.text );

            this.runButton.text="Stop";
            this.stackedLayout.current=this.appWidget;
            this.running=true;

            this.codeEdit.visible=true;
            this.appWidget.visible=false;
        } else
        {
            this.runButton.text="Start";
            this.stackedLayout.current=this.codeEdit;
            this.running=false;

            this.codeEdit.visible=false;
            this.appWidget.visible=true;
        }
    }.bind( this );

    this.running=false;
    this.runLayout=VG.UI.Layout( this.runButton );
    this.runLayout.margin.clear();
    this.stackedLayout=VG.UI.StackedLayout( this.codeEdit, this.appWidget );
    this.mainLayout=VG.UI.Layout( this.stackedLayout, this.runLayout );
    this.mainLayout.vertical=true;
    this.mainLayout.margin.clear();

    this.codeEdit.visible=true;
    this.appWidget.visible=false;

    this.childWidgets=[ this.codeEdit,  this.appWidget, this.runButton ];
};

VG.UI.AppEditWidget.prototype=VG.UI.Widget();

VG.UI.AppEditWidget.prototype.paintWidget=function( canvas )
{
    this.mainLayout.rect.copy( this.rect );
    this.mainLayout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.HistoryWidgetController

VG.UI.HistoryWidgetController=function()
{
    this.name="HistoryWidgetController";

    this.emptyProject={ text : "Last Available State", visible : true };
};

Object.defineProperty( VG.UI.HistoryWidgetController.prototype, "selected",
{
    get: function() {
        return this._visible;
    },
    set: function( visible ) {
    }
});

VG.UI.HistoryWidgetController.prototype=VG.UI.Widget();

VG.UI.HistoryWidgetController.prototype.at=function( index )
{
    //VG.log( "HistoryWidgetController at", index );

    if ( index === 0 ) return this.emptyProject;

    var dc=VG.context.workspace.dataCollectionForUndoRedo;
    var steps=dc.__vgUndo.steps;
    return steps[index-1];
};

VG.UI.HistoryWidgetController.prototype.count=function( index )
{
    //VG.log( "HistoryWidgetController count" );

    var dc=VG.context.workspace.dataCollectionForUndoRedo;

    if ( dc ) {
        var undo=dc.__vgUndo;
        if ( undo ) return undo.steps.length+1;
        else return 0;
    } else return 0;
};

VG.UI.HistoryWidgetController.prototype.isSelected=function( item )
{
    //VG.log( "HistoryWidgetController isSelected", item );

    var dc=VG.context.workspace.dataCollectionForUndoRedo;
    var undo=dc.__vgUndo;

    if ( undo.stepIndex === 0 ) {
        return item === this.emptyProject;
    } else {
        return undo.steps[undo.stepIndex-1] === item;
    }
};

VG.UI.HistoryWidgetController.prototype.setSelected=function( item )
{
    var dc=VG.context.workspace.dataCollectionForUndoRedo;
    var undo=dc.__vgUndo;

    var offset=0, i, diff;

    if ( item !== this.emptyProject ) {
        offset=undo.steps.indexOf( item ) + 1;
    }

    if ( offset > undo.stepIndex )
    {
        diff=offset - undo.stepIndex;
        //VG.log( diff, "forwards" );

        for ( i=0; i < diff; ++i ) {
            undo.redo();
        }
    } else {
        diff=undo.stepIndex - offset;
        //VG.log( diff, "backwards" );

        for ( i=0; i < diff; ++i ) {
            undo.undo();
        }
    }
};

// ----------------------------------------------------------------- VG.UI.HistoryWidget

VG.UI.HistoryWidget=function()
{
    if ( !(this instanceof VG.UI.HistoryWidget) ) return new VG.UI.HistoryWidget();

    VG.UI.Widget.call( this );

    this.listWidget=VG.UI.ListWidget();
    this.listWidget.controller=new VG.UI.HistoryWidgetController();

    this.childWidgets=[ this.listWidget ];
};

VG.UI.HistoryWidget.prototype=VG.UI.Widget();

VG.UI.HistoryWidget.prototype.paintWidget=function( canvas )
{
    canvas.hasBeenResized=true;
    this.listWidget.rect.copy( this.rect );
    this.listWidget.paintWidget( canvas );
    canvas.hasBeenResized=false;
};

// ----------------------------------------------------------------- VG.UI.ButtonGroup

VG.UI.ButtonGroupItem=function( text, icon, statusTip )
{
    this.text=text;
    this.icon=icon;
    this.rect=VG.Core.Rect();
    this.statusTip=statusTip;

    var canvas=VG.context.workspace.canvas;
    canvas.pushFont( VG.UI.stylePool.current.skin.ButtonGroup.Font );
    this.textWidth=canvas.getTextSize( this.text ).width + 8;
    this.textHeight=canvas.getLineHeight();
    canvas.popFont();
};

VG.UI.ButtonGroup=function()
{
    if ( !(this instanceof VG.UI.ButtonGroup) ) return VG.UI.ButtonGroup.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="ButtonGroup";

    this.supportsFocus=true;
    this.items=[];

    for( var i=0; i < arguments.length; i+=3 )
        this.addButton( arguments[i], arguments[i+1], arguments[i+2] );
};

VG.UI.ButtonGroup.prototype=VG.UI.Widget();

VG.UI.ButtonGroup.prototype.addButton=function( text, icon, statusTip )
{
    var button=new VG.UI.ButtonGroupItem( text, icon, statusTip );
    this.items.push( button );

    if ( this.activeButton === undefined ) {
        this.activeButton=button;
        this.index=this.items.indexOf( this.activeButton );

        if ( this.selected )
            this.selected( this.items.indexOf( this.activeButton ) );
    }

    VG.update();
    return button;
};

VG.UI.ButtonGroup.prototype.addSVGButton=function( text, svgName, svgGroupName, statusTip )
{
    var button=new VG.UI.ButtonGroupItem( text, undefined, statusTip );

    button.svgName=svgName;
    button.svgGroupName=svgGroupName;

    this.items.push( button );

    if ( this.activeButton === undefined ) {
        this.activeButton=button;
        this.index=this.items.indexOf( this.activeButton );

        if ( this.selected )
            this.selected( this.items.indexOf( this.activeButton ) );
    }

    VG.update();
    return button;
};

VG.UI.ButtonGroup.prototype.addButtons=function()
{
    for( var i=0; i < arguments.length; i+=3 )
        this.addButton( arguments[i], arguments[i+1], arguments[i+2] );
};

VG.UI.ButtonGroup.prototype.focusIn=function()
{
    for ( var i=0; i < this.items.length; ++i )
    {
        var item=this.items[i];

        if ( item.rect.contains( VG.context.workspace.mousePos ) )
        {
            this.hoverButton=item;
            this.activeButton=this.hoverButton;
            this.index=this.items.indexOf( this.activeButton );

            if ( this.activeButton && this.changed )
                this.changed( this.items.indexOf( this.activeButton ) );

            this.activeButtonNotified = true;

            VG.update();
        }
    }
};

VG.UI.ButtonGroup.prototype.mouseMove=function( event )
{
    this.hoverButton=undefined;

    for ( var i=0; i < this.items.length; ++i )
    {
        var item=this.items[i];

        if ( item.rect.contains( event.pos ) ) {

            this.hoverButton=item;
            break;
        }
    }

    VG.update();
};

VG.UI.ButtonGroup.prototype.mouseDown=function( event )
{
    this.activeButton=this.hoverButton;
    this.index=this.items.indexOf( this.activeButton );

    if ( this.activeButtonNotified ) {
        this.activeButtonNotified = false;
        return;
    }

    if ( this.activeButton && this.changed )
        this.changed( this.items.indexOf( this.activeButton ) );

    VG.update();
};

VG.UI.ButtonGroup.prototype.mouseUp=function( event )
{
    this.activeButtonNotified = false;
};

VG.UI.ButtonGroup.prototype.calcSize=function( canvas )
{
    this.preferredSize.width=0;

    for ( var i=0; i < this.items.length; ++i ) {
        var item=this.items[i];

        this.preferredSize.width+=item.textWidth + 16;
        if ( item.icon ) this.preferredSize.width+=5 + item.icon.width;
        else if ( item.svgName ) this.preferredSize.width+=15;
        this.preferredSize.height=item.textHeight;
    }

    this.preferredSize.width+=(this.items.length-1);

    this.maximumSize.width=this.preferredSize.width;
    this.maximumSize.height=this.preferredSize.height + 4;

    return this.preferredSize;
};

VG.UI.ButtonGroup.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawButtonGroup( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.DropArea

VG.handleImageDropEvent_DropArea=function( event )
{
    event.stopPropagation();
    event.preventDefault();

    var files = event.dataTransfer.files;
    var file = files[0];
    var fileType;

    var match=true;

    if ( match )
    {
        var reader=new FileReader();

        reader.onload = function( e )
        {
            VG.dropArea.fileDropped( file.name, reader.result );
        };

        if ( VG.dropArea.typeName === "Image" || VG.dropArea.typeName === "Binary" )
            reader.readAsDataURL( file );
        else reader.readAsText( file );
    }
};

VG.handleDragOver_DropArea=function( event )
{
    event.stopPropagation();
    event.preventDefault();
    event.dataTransfer.dropEffect='copy';
};

/**
 * Creates a drop area, i.e. an area where users can drop files from the Desktop to, like for example an image.
 * @param {string} type - The file type name this drop area should support, like "Image", "Text", or "Binary".
 * @param {callback} paintCallback - The optional paint callback (called with the {@link VG.Canvas|canvas} argument). By default the drop area is drawn with a border and a centered "Drop (Filetype) here" text.
 * @param {callback} droppedCallback - The optional dropped callback when a file was dropped on the area, arguments are the name and data. If the type is an image also an {@link VG.Core.Image|image} object is passed.
 * @property {callback} paintCallback - Same as the paintCallback parameter.
 * @property {callback} droppedCallback - Same as the droppedCallback parameter.
 * @example
 * var imageDropWidget=VG.UI.DropArea( "Image", undefined, function( name, data, image ) {
 *    VG.log( "Image", name, "is", image.width, "pixel wide and", image.height, "pixels high" );
 *    this.image=image;
 * }.bind( this ) );
 * @constructor
 */

VG.UI.DropArea=function( typeName, paintCallback, droppedCallback )
{
    if ( !(this instanceof VG.UI.DropArea) ) return VG.UI.DropArea.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="DropArea";

    this.typeName=typeName;

    this.supportsFocus=true;
    this.platform=VG.context.workspace.platform;
    this.paintCallback=paintCallback;
    this.droppedCallback=droppedCallback;

    this.horizontalExpanding=true;
    this.verticalExpanding=true;

    if ( this.platform === VG.HostProperty.PlatformWeb )
    {
        // --- Web, initialize DnD area

        VG.dropArea=this;
        VG.handleImageDropEvent=VG.handleImageDropEvent_DropArea;
        VG.handleDragOver=VG.handleDragOver_DropArea;

        VG.dropZone.addEventListener('dragover', VG.handleDragOver, false);
        VG.dropZone.addEventListener('drop', VG.handleImageDropEvent, false);

        this.makeVisible=true;

        this.button=VG.UI.Button( "Select " + typeName + " ...");
        this.button.clicked = () => {

            let chooseFile = (name) => {
                let chooser = document.querySelector( name );
                let changeEvent = ( evt ) => {
                    chooser.removeEventListener( "change", changeEvent );

                    let reader = new FileReader();
                    let file = evt.target.files[0];

                    reader.onload = ( e ) => {
                        this.fileDropped( file.name, reader.result );
                    };

                    if ( typeName === "Image" ) reader.readAsDataURL( file );
                    else reader.readAsText( file );

                };
                chooser.addEventListener( "change", changeEvent, false );
                chooser.click();
            };
            chooseFile('#fileDialog');
        };
    } else
    {
        this.button=VG.UI.Button( "Import " + typeName + " ...");
        this.button.clicked=function() {

            if ( typeName === "Image" ) {

                var fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Image, function( name, image ) {
                    this.image=image;
                    image.name=name;
                    this.droppedCallback( name, image.imageData, image );
                }.bind( this ) );
            }
        }.bind( this );
    }
};

VG.UI.DropArea.prototype=VG.UI.Widget();

VG.UI.DropArea.prototype.fileDropped=function( name, data )
{
    if ( this.typeName !== 'Image' && this.droppedCallback )
        this.droppedCallback( name, data );

    if ( this.typeName === 'Image' && !this.paintCallback )
    {
        if ( !this.image ) this.image=VG.Core.Image();

        this.image.name=name;
        this.image.forcePowerOfTwo=false;

        VG.decompressImageData( data, this.image, function() {
            this.droppedCallback( name, data, this.image );
            VG.update();
        }.bind( this ) );

        if ( this.platform !== VG.HostProperty.PlatformWeb ) {
            this.droppedCallback( name, data, this.image );
            VG.update();
        }
    }
};

VG.UI.DropArea.prototype.disableDropZone=function()
{
    if ( this.platform === VG.HostProperty.PlatformWeb )
    {
        VG.dropZone.style.display="none";
        this.makeVisible=true;
    }
};

VG.UI.DropArea.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;

    this.contentRect.copy( this.rect );

    if ( this.paintCallback )
        this.paintCallback( canvas );
    else
    {

        if ( this.typeName === "Image" && this.image && this.image.isValid() )
        {
            canvas.drawScaledImage( this.contentRect, this.image, this.contentRect );
        } else
        if ( this.platform === VG.HostProperty.PlatformWeb ) {

            var text=this.customText ? this.customText : "Drop " + this.typeName + " Here";

            canvas.drawTextRect( text, this.contentRect, VG.UI.stylePool.current.skin.Widget.TextColor, 1, 1 );
        }


    }

    if ( this.platform === VG.HostProperty.PlatformWeb )
    {
        VG.dropZone.style.left=String( this.contentRect.x ) + "px";
        VG.dropZone.style.top=String( this.contentRect.y ) + "px";
        VG.dropZone.style.width=String( this.contentRect.width ) + "px";
        VG.dropZone.style.height=String( this.contentRect.height ) + "px";

        if ( this.makeVisible ) {
            VG.dropZone.style.display="inline";
            this.makeVisible=false;
        }
    }

    canvas.draw2DShapeGL( VG.Canvas.Shape2D.RectangleOutlineMin1px, this.contentRect, VG.UI.stylePool.current.skin.TextEdit.BorderColor1 );
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.UI.MenuItem

VG.UI.MenuItem=function( text, iconName, clicked, shortcut )
{
    if ( !(this instanceof VG.UI.MenuItem) ) return VG.UI.MenuItem.creator( arguments );

    this.text=text;
    this.iconName=iconName;
    this.clicked=clicked;
    this.shortcut=shortcut;

    this._disabled=false;
    this.exclusions=[];
    this.checkable=false;
    this._checked=false;

    this._rect=VG.Core.Rect();

    this.id=-1;
};

Object.defineProperty( VG.UI.MenuItem.prototype, "disabled",
{
    get: function() {
        return this._disabled;
    },
    set: function( disabled ) {
        this._disabled=disabled;
        if ( VG.setNativeMenuItemState ) VG.setNativeMenuItemState( this.id, disabled, this._checked );
    }
});

Object.defineProperty( VG.UI.MenuItem.prototype, "checked",
{
    get: function() {
        return this._checked;
    },
    set: function( checked ) {
        this._checked=checked;
        if ( VG.setNativeMenuItemState ) VG.setNativeMenuItemState( this.id, this._disabled, checked );
    }
});

VG.UI.MenuItem.prototype.addExclusions=function()
{
    this.checkable=true;

    for ( var i=0; i < arguments.length; ++i ) {
        if ( this.exclusions.indexOf( arguments[i] ) === -1 ) this.exclusions.push( arguments[i] );

        if ( arguments[i].exclusions.indexOf( this ) === -1 )
        {
            arguments[i].exclusions.push( this );
            arguments[i].checkable=true;
        }

        for ( var k=0; k < arguments.length; ++k )
            if ( arguments[i] !== arguments[k] && arguments[i].exclusions.indexOf( arguments[k] ) === -1 ) arguments[i].exclusions.push( arguments[k] );
    }
};

// ----------------------------------------------------------------- VG.UI.Menubar

VG.UI.MenuBar=function()
{
    if ( !(this instanceof VG.UI.MenuBar) ) return new VG.UI.MenuBar();

    VG.UI.Widget.call( this );
    this.name="MenuBar";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.minimumSize.set( 0, 26 );
    this.maximumSize.set( 32768, 20 );

    this.supportsFocus=false;

    this.items=[];
    this.active=null;

    this.itemIdCounter=1;
};

VG.UI.MenuBar.prototype=VG.UI.Widget();

VG.UI.MenuBar.prototype.addMenu=function( text, callback )
{
    var menu=new VG.UI.Menu( text, callback, this );

    if ( VG.addNativeMenu ) VG.addNativeMenu( menu );

    this.items.push( menu );

    return menu;
};

VG.UI.MenuBar.prototype.activateMenu=function( menu )
{
    this.active=menu;

    if ( menu.aboutToShow ) menu.aboutToShow();
    VG.update();
};

VG.UI.MenuBar.prototype.mouseMove=function( event )
{
    if ( this.active )
    {
        for( var i=0; i < this.items.length; ++i )
        {
            var item=this.items[i];

            if ( item.rect.contains( event.pos ) ) {
                if ( this.active !== item ) {
                    this.activateMenu( item );
                }
            }
        }
    }
};

VG.UI.MenuBar.prototype.mouseDown=function( event )
{
    if ( !this.active )
    {
        for( var i=0; i < this.items.length; ++i )
        {
            var item=this.items[i];

            if ( item.rect.contains( event.pos ) ) {
                this.activateMenu( item );
            }
        }
    } else
    {
        this.active=null;
        VG.context.workspace.mouseTrackerWidget=null;
    }
};

VG.UI.MenuBar.prototype.mouseUp=function( event )
{
};

VG.UI.MenuBar.prototype.menuItemById=function( id )
{
    for( var i=0; i < this.items.length; ++i )
    {
        var menu=this.items[i];

        for( var m=0; m < menu.items.length; ++m )
        {
            var menuItem=menu.items[m];

            if ( menuItem.id !== -1 && menuItem.id === id )
                return menuItem;
        }
    }
    return -1;
};

VG.UI.MenuBar.prototype.clickMenuItemById=function( id )
{
    for( var i=0; i < this.items.length; ++i )
    {
        var menu=this.items[i];

        for( var m=0; m < menu.items.length; ++m )
        {
            var menuItem=menu.items[m];

            if ( menuItem.id !== -1 && menuItem.id === id )
            {
                menu.externalClickItem=menuItem;
                //menu.externalClickTime=Date.now();

                menu.clickItem( menuItem );
            }
        }
    }
    return -1;
};

VG.UI.MenuBar.prototype.calcSize=function( canvas )
{
    var size=VG.Core.Size( VG.UI.MaxLayoutSize, 26 );
    return size;
};

VG.UI.MenuBar.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;
    VG.UI.stylePool.current.drawMenuBar( this, canvas );

    if ( this.active && canvas.delayedPaintWidgets.indexOf( this.active ) === -1 )  {

        this.active.visible=true;
        canvas.delayedPaintWidgets.push( this.active );
        VG.context.workspace.mouseTrackerWidget=this.active;
    }
};

// ----------------------------------------------------------------- VG.UI.Menu

VG.UI.Menu=function( text, callback, menubar )
{
    if ( !(this instanceof VG.UI.Menu) ) return VG.UI.Menu.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="Menu";

    this.text=text;
    this.aboutToShow=callback;
    this.parent=menubar;

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.minimumSize.set( 60, 20 );
    this.maximumSize.set( 32768, 20 );

    this.supportsFocus=true;

    this.items=[];
    this.selected=null;
    this.separatorCount=0;
};

VG.UI.Menu.prototype=VG.UI.Widget();

VG.UI.Menu.prototype.addItem=function( text, icon, callback, shortcut )
{
    var item=VG.UI.MenuItem( text, icon, callback, shortcut );
    this.addMenuItem( item );

    return item;
};

VG.UI.Menu.prototype.addMenuItem=function( menuItem )
{
    this.items.push( menuItem );

    if ( this.parent) menuItem.id=this.parent.itemIdCounter++;
    if ( VG.addNativeMenuItem ) VG.addNativeMenuItem( this, menuItem );

    return menuItem;
};

VG.UI.Menu.prototype.insertMenuItem=function( index, menuItem )
{
    this.items.splice( index, 0, menuItem );

    if ( this.parent) menuItem.id=this.parent.itemIdCounter++;
    if ( VG.addNativeMenuItem ) VG.addNativeMenuItem( this, menuItem );

    return menuItem;
};

VG.UI.Menu.prototype.addSeparator=function()
{
    var item=VG.UI.MenuItem();
    item.isSeparator=true;
    ++this.separatorCount;
    this.items.push( item );

    if ( VG.addNativeMenuItem ) VG.addNativeMenuItem( this, item );

    return item;
};

VG.UI.Menu.prototype.insertSeparator=function( index )
{
    var item=VG.UI.MenuItem();
    item.isSeparator=true;
    ++this.separatorCount;
    this.items.splice( index, 0, item );

    if ( VG.addNativeMenuItem ) VG.addNativeMenuItem( this, item );

    return item;
};

VG.UI.Menu.prototype.clickItem=function( item )
{
    if ( item.clicked ) item.clicked();

    // --- Apply checkable state ?

    if ( item.checkable )
    {
        item.checked=true;

        for ( var i=0; i < item.exclusions.length; ++i )
            item.exclusions[i].checked=false;
    }
};

VG.UI.Menu.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    var minWidth=80;

    VG.context.workspace.canvas.pushFont( VG.UI.stylePool.current.skin.Menu.Font );

    for( var i=0; i < this.items.length; ++i ) {
        if ( !this.items[i].isSeparator ) {
            VG.context.workspace.canvas.getTextSize( this.items[i].text, size );
            if ( size.width > minWidth ) minWidth=size.width;
        }
    }

    size.set( minWidth, (VG.context.workspace.canvas.getLineHeight()+7) * (this.items.length-this.separatorCount) + 2 + this.separatorCount );

    size=size.add( 100, 0 );
    this.minimumSize.set( size );

    VG.context.workspace.canvas.popFont();

    return size;
};

VG.UI.Menu.prototype.mouseMove=function( event )
{
    var selected;

    if ( !this.contentRect.contains( event.pos ) )
    {
        selected=null;
        this.parent.mouseMove( event );
    }
    else
    {
        for( var i=0; i < this.items.length; ++i )
        {
            var item=this.items[i];

            if ( !item.isSeparator ) {
                if ( item._rect.contains( event.pos ) ) {
                    selected=item;
                    break;
                }
            }
        }
    }

    if ( selected !== this.selected ) {
        this.selected=selected;

        // --- StatusTip
        if ( VG.context.workspace.statusBar )
        {
            if ( selected && selected.statusTip && !selected.disabled ) VG.context.workspace.statusBar.message( selected.statusTip, 4000 );
            else VG.context.workspace.statusBar.message( "" );
        }

        VG.update();
    }
};

VG.UI.Menu.prototype.mouseDown=function( event )
{
    if ( this.selected && this.contentRect.contains( event.pos ) && this.visible && event.button === VG.Events.MouseButton.Left ) {

    } else this.parent.mouseDown( event );
};

VG.UI.Menu.prototype.mouseUp=function( event )
{
    if ( this.selected && this.contentRect.contains( event.pos ) && this.visible && event.button === VG.Events.MouseButton.Left ) {

        if ( this.selected.clicked )
            this.selected.clicked();

        // --- Apply checkable state ?

        if ( this.selected.checkable )
        {
            this.selected.checked=true;

            for ( var i=0; i < this.selected.exclusions.length; ++i )
                this.selected.exclusions[i].checked=false;
        }

        // --- Dismiss menu

        this.visible=false;
        this.parent.active=null;
        VG.context.workspace.mouseTrackerWidget=null;
    } else
    if ( !this.parent.rect.contains( event.pos ) )
    {
        // --- Dismiss menu

        this.visible=false;
        this.parent.active=null;
        VG.context.workspace.mouseTrackerWidget=null;
    }
};

VG.UI.Menu.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;
    VG.UI.stylePool.current.drawMenu( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.ContextMenu

VG.UI.ContextMenu=function()
{
    if ( !(this instanceof VG.UI.ContextMenu) ) return new VG.UI.ContextMenu();

    VG.UI.Widget.call( this );
    this.name="ContextMenu";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.minimumSize.set( 60, 20 );
    this.maximumSize.set( 32768, 20 );

    this.supportsFocus=true;

    this.items=[];
    this.selected=null;
    this.separatorCount=0;

    this.aboutToShow=null;
};

VG.UI.ContextMenu.prototype=VG.UI.Widget();

VG.UI.ContextMenu.prototype.addItem=function( text, icon, callback, shortcut )
{
    var item=VG.UI.MenuItem( text, icon, callback, shortcut );
    this.items.push( item );

    return item;
};

VG.UI.ContextMenu.prototype.insertItem=function( index, text, icon, callback, shortcut )
{
    var item=VG.UI.MenuItem( text, icon, callback, shortcut );
    this.items.splice( index, 0, item );

    return item;
};

VG.UI.ContextMenu.prototype.addSeparator=function()
{
    var item=VG.UI.MenuItem();
    item.isSeparator=true;
    ++this.separatorCount;
    this.items.push( item );

    return item;
};

VG.UI.ContextMenu.prototype.keyDown=function( keyCode )
{
    if ( VG.UI.Widget.prototype.keyDown.call( this, keyCode ) )
        return;

    if ( this.popup )
    {
        if ( keyCode == VG.Events.KeyCodes.Esc )
        {
            this.index=this.oldIndex;
            this.popup=false;
            VG.update();
        }
    } else
    {
        if ( keyCode == VG.Events.KeyCodes.ArrowUp )
        {
            if ( this.index > 0 ) {
                this.applyNewIndex( this.index -1 );
                VG.update();
            }
        } else
        if ( keyCode == VG.Events.KeyCodes.ArrowDown )
        {
            if ( this.index < (this.items.length -1 )) {
                this.applyNewIndex( this.index + 1 );
                VG.update();
            }
        }
    }
};

VG.UI.ContextMenu.prototype.mouseMove=function( event )
{
    var selected;

    if ( !this.rect.contains( event.pos ) ) selected=null;
    else
    {
        for( var i=0; i < this.items.length; ++i )
        {
            var item=this.items[i];

            if ( !item.isSeparator ) {
                if ( item._rect.contains( event.pos ) ) {
                    selected=item;

                    break;
                }
            }
        }
    }

    if ( selected !== this.selected ) {
        this.selected=selected;

        // --- StatusTip
        if ( VG.context.workspace.statusBar )
        {
            if ( selected && selected.statusTip && !selected.disabled ) VG.context.workspace.statusBar.message( selected.statusTip, 4000 );
            else VG.context.workspace.statusBar.message( "" );
        }
        VG.update();
    }
};

VG.UI.ContextMenu.prototype.mouseDown=function( event )
{
    if ( this.rect.contains( event.pos ) && event.button === VG.Events.MouseButton.Left ) {
        this.popup=true;
        this.oldIndex=this.index;
    }
};

VG.UI.ContextMenu.prototype.mouseUp=function( event )
{
    if ( this.selected && this.visible && event.button === VG.Events.MouseButton.Left ) {

        if ( this.selected.clicked )
            this.selected.clicked();

        // --- Apply checkable state ?

        if ( this.selected.checkable )
        {
            this.selected.checked=true;

            for ( var i=0; i < this.selected.exclusions.length; ++i )
                this.selected.exclusions[i].checked=false;
        }

        // --- Dismiss context menu

        this.visible=false;
        VG.context.workspace.contextMenu=undefined;
        VG.context.workspace.mouseTrackerWidget=undefined;
    }
};

VG.UI.ContextMenu.prototype.activate=function( pos )
{
    if ( this.aboutToShow )
        this.aboutToShow();

    this.rect.setPos( pos );
    this.rect.setSize( this.calcSize( VG.context.workspace.canvas ) );

    this.visible=true;
    VG.context.workspace.contextMenu=this;
    VG.context.workspace.mouseTrackerWidget=this;
};

VG.UI.ContextMenu.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    var minWidth=80;

    VG.context.workspace.canvas.pushFont( canvas.style.skin.ContextMenu.Font );

    for( var i=0; i < this.items.length; ++i ) {
        if ( !this.items[i].isSeparator ) {
            VG.context.workspace.canvas.getTextSize( this.items[i].text, size );
            if ( size.width > minWidth ) minWidth=size.width;
        }
    }

    size.set( minWidth, (VG.context.workspace.canvas.getLineHeight()+4) * (this.items.length-this.separatorCount) + 2 + this.separatorCount );

    size=size.add( 100, 0 );
    this.minimumSize.set( size );

    VG.context.workspace.canvas.popFont();

    return size;
};

VG.UI.ContextMenu.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;
    VG.UI.stylePool.current.drawContextMenu( this, canvas );
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Creates an VG.UI.ListWidget. A list widget displays a flat (not nested) list of items.
 *
 * A list widget has to be bound to a path inside a {@link VG.Data.Collection}.
 *
 * @example
 * var dc=VG.Data.Collection( "MainData" );
 * dc.items=[];
 *
 * var listWidget=VG.UI.ListWidget();
 *
 * var controller=listWidget.bind( dc, "items" );
 * controller.addObserver( "selectionChanged", function() {
 *     var item=this.controller.selected;
 *     VG.log( "Selected \"" + item.text + "\" at index " + this.controller.indexOf( item ) );
 * }.bind( this ) );
 *
 * function item( text ) {
 *     this.text=text;
 * }
 *
 * controller.add( new item( "First Item" ) );
 * controller.add( new item( "Second Item" ) );
 * controller.add( new item( "Third Item" ) );
 * @constructor
 */

VG.UI.ListWidget=function()
{
    if ( !(this instanceof VG.UI.ListWidget) ) return new VG.UI.ListWidget();

    VG.UI.Widget.call( this );
    this.name="ListWidget";

    this.offset=0;

    this.previousRect=VG.Core.Rect();

    this.minimumSize.set( 100, 100 );
    this.supportsFocus=true;

    this.vScrollbar=0;
    this.needsVScrollbar=false;
    this.verified=false;
    this._itemHeight=-1;

    this.toolLayout=VG.UI.Layout();
    this.layout=this.toolLayout;
    this.toolLayout.margin.set( 1, 1, 1, 1 );

    // --- Setup Default Context Menu

    this.contextMenu=VG.UI.ContextMenu();

    this.addMenuItem=this.contextMenu.addItem( "Add", null, function() {
        if ( this.controller && this.controller.contentClassName ) this.controller.add();
    }.bind( this ));

    this.removeMenuItem=this.contextMenu.addItem( "Remove", null, function() {
        if ( this.controller && this.controller.canRemove() ) this.controller.remove( this.controller.selected );
    }.bind( this ));

    //this.contextMenu.addSeparator();

    this.contextMenu.aboutToShow=function() {
        // --- Disable / Enable the add and remove context menu items based on controller state
        this.addMenuItem.disabled=true;
        this.removeMenuItem.disabled=true;

        if ( this.controller ) {
            if ( this.controller.contentClassName ) this.addMenuItem.disabled=false;
            if ( this.controller.canRemove() ) this.removeMenuItem.disabled=false;
        }
    }.bind( this );
};

VG.UI.ListWidget.prototype=VG.UI.Widget();

/**
 * Binds the widget to the data model.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @returns {VG.Controller.Array} The array controller created for this widget.
 * @tutorial Data Model
 */

VG.UI.ListWidget.prototype.bind=function( collection, path )
{
    this.controller=collection.controllerForPath( path );
    if ( !this.controller ) {
        this.controller=VG.Controller.Array( collection, path );
        collection.addControllerForPath( this.controller, path );
    }

    this.controller.addObserver( "changed", this.changed.bind( this ) );
    this.controller.addObserver( "selectionChanged", this.selectionChanged.bind( this ) );

    return this.controller;
};

Object.defineProperty( VG.UI.ListWidget.prototype, "itemHeight",
{
    get: function() {
        if ( this._itemHeight === -1 ) {
            VG.context.workspace.canvas.pushFont( VG.UI.stylePool.current.skin.ListWidget.Font );
            var fontHeight=VG.context.workspace.canvas.getLineHeight();
            VG.context.workspace.canvas.popFont();
            return fontHeight + 4;
        } else return this._itemHeight;
    },
    set: function( itemHeight ) {
        this._itemHeight=itemHeight;
    }
});

VG.UI.ListWidget.prototype.addToolWidget=function( widget )
{
    widget.supportsFocus=false;
    widget.panelButton = true;
    this.toolLayout.addChild( widget );
};

VG.UI.ListWidget.prototype.removeToolWidget=function( widget )
{
    this.toolLayout.removeChild( widget );
};

VG.UI.ListWidget.prototype.focusIn=function()
{
};

VG.UI.ListWidget.prototype.focusOut=function()
{
};

VG.UI.ListWidget.prototype.keyDown=function( keyCode )
{
    if ( !this.controller.selected ) return;

    var index=this.controller.indexOf( this.controller.selected );
    if ( index === -1 ) return;

    if ( keyCode === VG.Events.KeyCodes.ArrowUp && index > 0 )
    {
        index -= 1;
        this.controller.selected=this.controller.at( index );
        while ( !this.controller.selected.visible && index > 0 ) {
            index -= 1;
            this.controller.selected = this.controller.at( index );
        }

        while ( this.controller.selected && !this.controller.selected.visible ) {
            index += 1;
            this.controller.selected = this.controller.at( index );
        }

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line up if necessary
            y=this.contentRect.y - this.offset + (index-1) * (this.itemHeight + this.spacing);

            if ( y < this.contentRect.y ) {
                this.offset-=this.itemHeight + this.spacing;
                this.vScrollbar.scrollTo( this.offset );
            }
        }
    } else
    if ( keyCode === VG.Events.KeyCodes.ArrowDown && index < this.controller.length-1 )
    {
        index += 1;
        this.controller.selected = this.controller.at( index );
        while ( !this.controller.selected.visible && index < this.controller.length-1 ) {
            index += 1;
            this.controller.selected = this.controller.at( index );
        }

        while ( this.controller.selected && !this.controller.selected.visible ) {
            index -= 1;
            this.controller.selected = this.controller.at( index );
        }

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line down if necessary
            y=this.contentRect.y - this.offset + index * (this.itemHeight + this.spacing);

            if ( y + this.itemHeight > this.contentRect.bottom() ) {
                this.offset+=this.itemHeight + this.spacing;
                this.vScrollbar.scrollTo( this.offset );
            }
        }
    }
};

VG.UI.ListWidget.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return;

    if ( step < 0 ) {
        this.offset -= Math.round( step * (this.itemHeight + this.spacing) );
        this.vScrollbar.scrollTo( this.offset );
    } else
    {
        this.offset -= Math.round( step * (this.itemHeight + this.spacing) );
        this.vScrollbar.scrollTo( this.offset );
    }
};

VG.UI.ListWidget.prototype.mouseMove=function( event )
{
    if ( this.mouseIsDown && this.dragSourceId && this.possibleDnDSource )
    {
        VG.context.workspace.dragOperationStarted( this, this.dragSourceId, this.possibleDnDSource );
    }
};

VG.UI.ListWidget.prototype.mouseDown=function( event )
{
    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    if ( !this.rect.contains( event.pos ) ) return;

    let selectedIndex=-1;
    let y=this.contentRect.y - this.offset;

    for ( let i=0; i < this.controller.count(); ++i ) {
        let item=this.controller.at( i ) ;
        if ( !item.visible ) continue;

        if ( y + (item.minimized ? this.itemMinHeight : this.itemHeight) + this.spacing >= event.pos.y && y <= event.pos.y ) {
            selectedIndex=i;
            break;
        }
        y += (item.minimized ? this.itemMinHeight : this.itemHeight) + this.spacing;
    }

    let item;
    if ( selectedIndex >=0 && selectedIndex < this.controller.count() )
        item = this.controller.at( selectedIndex );

    if ( this.controller.multiSelection )
    {
        if ( event.keysDown.indexOf( VG.Events.KeyCodes.Shift ) >= 0 )
        {
            if ( !this.controller.isSelected( item ) ) this.controller.addToSelection( item );
            else this.controller.removeFromSelection( item );
        } else
        if ( item ) {
            this.controller.setSelected( item );
            if ( event.button === VG.Events.MouseButton.Left )
                this.possibleDnDSource=item;
        }
    } else
    if ( item ) {
        this.controller.setSelected( item );
        if ( event.button === VG.Events.MouseButton.Left )
            this.possibleDnDSource=item;
    }

    this.mouseIsDown=true;
};

VG.UI.ListWidget.prototype.mouseUp=function( event )
{
    this.possibleDnDSource=undefined;
    VG.context.workspace.dndOperation=undefined;
    VG.context.workspace.dndValidDragTarget=undefined;

    this.mouseIsDown=false;
};

VG.UI.ListWidget.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    this.offset=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.ListWidget.prototype.verifyScrollbar=function()
{
    this.needsVScrollbar = false;
    this.totalItemHeight = 0;

    this.visibleCount=0;
    for ( var i=0; i < this.controller.count(); ++i ) {
        var item=this.controller.at( i );
        if ( item.visible ) {
            this.visibleCount++;
            this.totalItemHeight += item.minimized ? this.itemMinHeight : this.itemHeight;
        }
    }
    this.totalItemHeight += (this.visibleCount-1) * this.spacing;
    this.heightPerItem=this.totalItemHeight / this.visibleCount;
    this.visibleItems=this.contentRect.height / this.heightPerItem;
    this.lastTopItem=Math.ceil( this.controller.count() - this.visibleItems );

    if ( this.totalItemHeight > this.contentRect.height )
        this.needsVScrollbar=true;
    else this.offset=0;

    if ( this.needsVScrollbar && !this.vScrollbar ) {
        this.vScrollbar=VG.UI.ScrollBar( "ListWidget Scrollbar" );
        this.vScrollbar.callbackObject=this;
    }

    this.verified=true;
};

VG.UI.ListWidget.prototype.changed=function()
{
    this.verified=false;
    VG.update();
};

VG.UI.ListWidget.prototype.selectionChanged=function()
{
    VG.update();
};

VG.UI.ListWidget.prototype.paintWidget=function( canvas )
{
    this.spacing = VG.UI.stylePool.current.skin.ListWidget.Spacing;

    if ( !this.rect.equals( this.previousRect ) ) this.verified=false;
    VG.UI.stylePool.current.drawListWidget( this, canvas );
    this.previousRect.set( this.rect );
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Creates an VG.UI.IconWidget. An icon widget displays a flat (not nested) list of items.
 *
 * A list widget has to be bound to a path inside a {@link VG.Data.Collection}.
 *
 * @example
 * var dc=VG.Data.Collection( "MainData" );
 * dc.items=[];
 *
 * var listWidget=VG.UI.ListWidget();
 *
 * var controller=listWidget.bind( dc, "items" );
 * controller.addObserver( "selectionChanged", function() {
 *     var item=this.controller.selected;
 *     VG.log( "Selected \"" + item.text + "\" at index " + this.controller.indexOf( item ) );
 * }.bind( this ) );
 *
 * function item( text ) {
 *     this.text=text;
 * }
 *
 * controller.add( new item( "First Item" ) );
 * controller.add( new item( "Second Item" ) );
 * controller.add( new item( "Third Item" ) );
 * @constructor
 */

VG.UI.IconWidget=function()
{
    if ( !(this instanceof VG.UI.IconWidget) ) return new VG.UI.IconWidget();

    VG.UI.Widget.call( this );
    this.name="IconWidget";

    this.offset=0;

    this._margin = VG.Core.Size( 9 + 8, 9 + 8 );
    this.previousRect=VG.Core.Rect();

    this.minimumSize.set( 100, 100 );
    this.supportsFocus=true;

    this.vScrollbar=0;
    this.needsVScrollbar=false;
    this.verified=false;
    this._itemSize=VG.Core.Size( 91, 117 );

    this.toolLayout=VG.UI.Layout();
    this.layout=this.toolLayout;
    this.toolLayout.margin.set( 1, 1, 1, 1 );

    // --- Setup Default Context Menu

    this.contextMenu=VG.UI.ContextMenu();

    this.addMenuItem=this.contextMenu.addItem( "Add", null, function() {
        if ( this.controller && this.controller.contentClassName ) this.controller.add();
    }.bind( this ));

    this.removeMenuItem=this.contextMenu.addItem( "Remove", null, function() {
        if ( this.controller && this.controller.canRemove() ) this.controller.remove( this.controller.selected );
    }.bind( this ));

    //this.contextMenu.addSeparator();

    this.contextMenu.aboutToShow=function() {
        // --- Disable / Enable the add and remove context menu items based on controller state
        this.addMenuItem.disabled=true;
        this.removeMenuItem.disabled=true;

        if ( this.controller ) {
            if ( this.controller.contentClassName ) this.addMenuItem.disabled=false;
            if ( this.controller.canRemove() ) this.removeMenuItem.disabled=false;
        }
    }.bind( this );
};

VG.UI.IconWidget.prototype=VG.UI.Widget();

/**
 * Binds the widget to the data model.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @returns {VG.Controller.Array} The array controller created for this widget.
 * @tutorial Data Model
 */

VG.UI.IconWidget.prototype.bind=function( collection, path )
{
    this.controller=collection.controllerForPath( path );
    if ( !this.controller ) {
        this.controller=VG.Controller.Array( collection, path );
        collection.addControllerForPath( this.controller, path );
    }

    this.controller.addObserver( "changed", this.changed.bind( this ) );
    this.controller.addObserver( "selectionChanged", this.selectionChanged.bind( this ) );

    return this.controller;
};

Object.defineProperty( VG.UI.IconWidget.prototype, "itemSize",
{
    get: function() {
        return this._itemSize;
    },
    set: function( itemSize ) {
        this._itemSize.copy( itemSize );
    }
});

Object.defineProperty( VG.UI.IconWidget.prototype, "itemMargin", {
    get: function() {
        return this._margin;
    },
    set: function( newMargin ) {
        this._margin.copy( newMargin );
    }
});

VG.UI.IconWidget.prototype.addToolWidget=function( widget )
{
    widget.supportsFocus=false;
    this.toolLayout.addChild( widget );
};

VG.UI.IconWidget.prototype.removeToolWidget=function( widget )
{
    this.toolLayout.removeChild( widget );
};

VG.UI.IconWidget.prototype.focusIn=function()
{
};

VG.UI.IconWidget.prototype.focusOut=function()
{
};

VG.UI.IconWidget.prototype.keyDown=function( keyCode )
{
    if ( !this.controller.selected ) return;

    var index=this.controller.indexOf( this.controller.selected );
    if ( index === -1 ) return;

    if ( keyCode === VG.Events.KeyCodes.ArrowLeft && index > 0 )
    {
        this.controller.selected=this.controller.at( index - 1 );

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line up if necessary
            y=this.contentRect.y - this.offset + (index-1) * (this._itemSize.height + this.spacing.height);

            if ( y < this.contentRect.y ) {
                this.offset-=this._itemSize.height + this.spacing;
                this.vScrollbar.scrollTo( this.offset );
            }
        }
    } else
    if ( keyCode === VG.Events.KeyCodes.ArrowRight && index < this.controller.length-1 )
    {
        this.controller.selected=this.controller.at( index + 1 );

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line down if necessary
            y=this.contentRect.y - this.offset + (index+1) * (this._itemSize.height + this.spacing.height);

            if ( y + this.itemHeight > this.contentRect.bottom() ) {
                this.offset+=this._itemSize.height + this.spacing.height;
                this.vScrollbar.scrollTo( this.offset );
            }
        }
    } else
    if ( keyCode === VG.Events.KeyCodes.ArrowUp && index >= this.itemsPerRow )
    {
        this.controller.selected=this.controller.at( index - this.itemsPerRow );

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line up if necessary
            y=this.contentRect.y - this.offset + (index-this.itemsPerRow) * (this._itemSize.height + this.spacing.height);

            if ( y < this.contentRect.y ) {
                this.offset-=this._itemSize.height + this.spacing.height;
                this.vScrollbar.scrollTo( this.offset );
            }
        }
    } else
    if ( keyCode === VG.Events.KeyCodes.ArrowDown && index < this.controller.length-this.itemsPerRow )
    {
        this.controller.selected=this.controller.at( index + this.itemsPerRow );

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line down if necessary
            y=this.contentRect.y - this.offset + (index+this.itemsPerRow) * (this._itemSize.height + this.spacing.height);

            if ( y + this._itemSize.height > this.contentRect.bottom() ) {
                this.offset+=this._itemSize.height + this.spacing.height;
                this.vScrollbar.scrollTo( this.offset );
            }
        }
    }
};

VG.UI.IconWidget.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return;

    if ( step > 0 ) {
        this.offset-=this._itemSize.height + this.spacing.height;
        this.vScrollbar.scrollTo( this.offset );
    } else
    {
        this.offset+=this._itemSize.height + this.spacing.height;
        this.vScrollbar.scrollTo( this.offset );
    }
};

VG.UI.IconWidget.prototype.mouseMove=function( event )
{
    if ( this.mouseIsDown && this.dragSourceId && this.possibleDnDSource )
    {
        VG.context.workspace.dragOperationStarted( this, this.dragSourceId, this.possibleDnDSource );
    }
};

VG.UI.IconWidget.prototype.mouseDown=function( event )
{
    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    if ( !this.rect.contains( event.pos ) ) return;

    var selectedIndex=-1;
    var y=this.contentRect.y - this.offset;
    var item, rect=VG.Core.Rect();

    var skin=VG.UI.stylePool.current.skin.IconWidget;

    rect.y=skin.Margin.top;
    rect.width=this._itemSize.width;
    rect.height=this._itemSize.height;

    for ( var r=0; r < this.rows; ++r )
    {
        rect.x=skin.Margin.left;

        for ( var i=0; i < this.itemsPerRow; ++i )
        {
            var itemIndex=this.itemsPerRow * r + i;
            if ( itemIndex >= this.controller.count() ) break;

            if ( rect.contains( event.pos.x - this.rect.x, event.pos.y - this.rect.y + this.offset ) ) {
                selectedIndex=itemIndex;
                break;
            }

            rect.x+=this._itemSize.width + this.spacing.width;
        }

        if ( selectedIndex >= 0 ) break;
        rect.y+=this._itemSize.height + this.spacing.height;
    }

    if ( selectedIndex >=0 && selectedIndex < this.controller.count() )
        item=this.controller.at( selectedIndex );

    if ( this.controller.multiSelection )
    {
        if ( event.keysDown.indexOf( VG.Events.KeyCodes.Shift ) >= 0 )
        {
            if ( !this.controller.isSelected( item ) ) this.controller.addToSelection( item );
            else this.controller.removeFromSelection( item );
        } else
        if ( item ) {
            this.controller.setSelected( item );
            this.possibleDnDSource=item;
        }
    } else
    if ( item ) {
        this.controller.setSelected( item );
        this.possibleDnDSource=item;
    }

    this.mouseIsDown=true;
};

VG.UI.IconWidget.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.IconWidget.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    this.offset=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.IconWidget.prototype.verifyScrollbar=function( text )
{
    // --- Check if we have enough vertical space for all items

    var skin=VG.UI.stylePool.current.skin;

    this.needsVScrollbar=false;

    var availableWidth=this.rect.width - skin.IconWidget.Margin.left - skin.IconWidget.Margin.right - skin.ScrollBar.Size - 4;
    this.itemsPerRow=Math.floor( availableWidth / this._itemSize.width );
    availableWidth-=(this.itemsPerRow-1) * skin.IconWidget.Spacing.width;
    this.itemsPerRow=Math.floor( availableWidth / this._itemSize.width );
    this.rows=Math.ceil( this.controller.count() / this.itemsPerRow );

    this.totalItemHeight=this.rows * this._itemSize.height + (this.rows-1) * this.spacing.height;
    this.heightPerItem=this.totalItemHeight / this.rows;
    this.visibleItems=this.contentRect.height / this.heightPerItem;
    this.lastTopItem=Math.ceil( this.rows - this.visibleItems );

    if ( this.totalItemHeight > this.contentRect.height )
        this.needsVScrollbar=true;
    else this.offset=0;

    if ( this.needsVScrollbar && !this.vScrollbar ) {
        this.vScrollbar=VG.UI.ScrollBar( "IconWidget Scrollbar" );
        this.vScrollbar.callbackObject=this;
    }

    this.verified=true;
};

VG.UI.IconWidget.prototype.changed=function()
{
    this.verified=false;
    VG.update();
};

VG.UI.IconWidget.prototype.selectionChanged=function()
{
    VG.update();
};

VG.UI.IconWidget.prototype.paintWidget=function( canvas )
{
    this.spacing=VG.UI.stylePool.current.skin.IconWidget.Spacing;

    if ( !this.rect.equals( this.previousRect ) ) this.verified=false;
    VG.UI.stylePool.current.drawIconWidget( this, canvas );
    this.previousRect.set( this.rect );
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.UI.TreeWidgetItem=function( item, rect )
{
    if ( !(this instanceof VG.UI.TreeWidgetItem) ) return new VG.UI.TreeWidgetItem( item, rect );

    this.item=item;
    this.rect=VG.Core.Rect( rect );
};

 /**
 * Creates an VG.UI.TreeWidget. A tree widget displays an hierarchical tree of items.
 *
 * A list widget has to be bound to a path inside a {@link VG.Data.Collection}.
 *
 * @example
 *
 * var dc=VG.Data.Collection( "MainData" );
 * dc.items=[];
 *
 * var treeWidget=VG.UI.TreeWidget();
 *
 * controller=treeWidget.bind( dc, "items" );
 * controller.addObserver( "selectionChanged", function() {
 *     var item=this.controller.selected;
 *     VG.log( "Selected \"" + item.text + "\" at index " + this.controller.indexOf( item ) );
 * }.bind( this ) );
 *
 * function folder( text, open, selectable ) {
 *     this.text=text;
 *     this.children=[];
 *     this.open=open;
 *     this.selectable=selectable;
 * }
 *
 * function item( text, folder, open ) {
 *     this.text=text;
 * }
 *
 * controller.add( "", new folder( "Folder #1", true ) );
 * controller.add( "0", new item( "First Item" ) );
 * controller.add( "0", new folder( "Selectable Subfolder", false, true ) );
 * controller.add( "0.1", new item( "Second Item" ) );
 * controller.add( "", new item( "Third Item" ) );
 *
 * @borrows VG.UI.ListWidget.bind as VG.UI.TreeWidget.bind
 * @constructor
 */

VG.UI.TreeWidget=function()
{
    if ( !(this instanceof VG.UI.TreeWidget) ) return new VG.UI.TreeWidget();

    VG.UI.Widget.call( this );
    this.name = "TreeWidget";

    this.offset=0;
    this._itemHeight=-1;

    this.toolLayout=VG.UI.Layout();
    this.layout=this.toolLayout;
    this.toolLayout.margin.set( 1, 1, 1, 1 );

    this.minimumSize.set( 100, 100 );
    this.supportsFocus=true;

    this.items=[];
    this.vScrollbar=0;
    this.needsVScrollbar=false;
    this.verified=false;
    this.previousRect=VG.Core.Rect();

    this.columns = [];
};

VG.UI.TreeWidget.prototype=VG.UI.Widget();

/**
 * Binds the widget to the data model.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @returns {VG.Controller.Tree} The tree controller created for this widget.
 * @tutorial Data Model
 */

VG.UI.TreeWidget.prototype.bind=function( collection, path )
{
    this.controller=collection.controllerForPath( path );
    if ( !this.controller ) {
        this.controller=VG.Controller.Tree( collection, path );
        collection.addControllerForPath( this.controller, path );
    }

    this.controller.addObserver( "changed", this.changed, this );
    this.controller.addObserver( "selectionChanged", this.selectionChanged, this );

    return this.controller;
};

Object.defineProperty( VG.UI.TreeWidget.prototype, "itemHeight",
{
    get: function() {
        if ( this._itemHeight === -1 ) {
            return VG.UI.stylePool.current.skin.TreeWidget.Font.size + 8;

            //VG.context.workspace.canvas.pushFont( VG.UI.stylePool.current.skin.TreeWidget.Font );
            //var fontHeight=VG.context.workspace.canvas.getLineHeight();
            //VG.context.workspace.canvas.popFont();
            //return fontHeight + 4;
        } else return this._itemHeight;
    },
    set: function( itemHeight ) {
        this._itemHeight=itemHeight;
    }
});

VG.UI.TreeWidget.prototype.addColumn=function( column )
{
    if ( column.hAlign !== 1 )
        column.hAlign = 0;

    this.columns.push( column );
};

VG.UI.TreeWidget.prototype.addToolWidget=function( widget )
{
    widget.supportsFocus=false;
    widget.panelButton = true;
    this.toolLayout.addChild( widget );
};

VG.UI.TreeWidget.prototype.removeToolWidget=function( widget )
{
    this.toolLayout.removeChild( widget );
};

VG.UI.TreeWidget.prototype.focusIn=function()
{
};

VG.UI.TreeWidget.prototype.focusOut=function()
{
};

VG.UI.TreeWidget.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return false;

    if ( step < 0 ) {
        this.offset -= Math.round( step * (this.itemHeight + this.spacing) );
        this.vScrollbar.scrollTo( this.offset );
    } else
    {
        this.offset -= Math.round( step * (this.itemHeight + this.spacing) );
        this.vScrollbar.scrollTo( this.offset );
    }

    return true;
};

VG.UI.TreeWidget.prototype.keyDown=function( keyCode )
{
    if ( !this.controller.selected ) return;

    var index=this.controller.indexOf( this.controller.selected );
    if ( index === -1 ) return;

    if ( keyCode === VG.Events.KeyCodes.ArrowUp && index > 0 )
    {
        if ( this.offset >= index ) {
            this.offset=index-1;
            this.vScrollbar.scrollTo( this.offset * this.itemHeight + (this.offset-1) * this.spacing );
        }
        this.controller.selected=this.controller.at( index - 1 );
    } else
    if ( keyCode === VG.Events.KeyCodes.ArrowDown && index < this.controller.length-1 )
    {
        if ( Math.floor( this.offset + this.visibleItems ) <= index +1 ) {
            this.offset=index+2-Math.floor(this.visibleItems);
            this.vScrollbar.scrollTo( this.offset * this.itemHeight + (this.offset-1) * this.spacing );
        }

        this.controller.selected=this.controller.at( index + 1 );
    }
};

VG.UI.TreeWidget.prototype.mouseMove=function( event )
{
    if ( this.mouseIsDown && this.dragSourceId && this.possibleDnDSource )
    {
        VG.context.workspace.dragOperationStarted( this, this.dragSourceId, this.possibleDnDSource.item );
    }
};

VG.UI.TreeWidget.prototype.mouseDown=function( event )
{
    this.possibleDnDSource=undefined;

    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    if ( !this.rect.contains( event.pos ) ) return;

/*
    if ( selectedIndex >=0 && selectedIndex < this.controller.count() )
        item=this.controller.at( selectedIndex );

    if ( this.controller.multiSelection )
    {
        if ( event.keysDown.indexOf( VG.Events.KeyCodes.Shift ) >= 0 )
        {
            if ( !this.controller.isSelected( item ) ) this.controller.addToSelection( item );
            else this.controller.removeFromSelection( item );
        } else
        if ( item ) {
            this.controller.setSelected( item );
            this.possibleDnDSource=item;
        }
    } else
    if ( item ) {
        this.controller.setSelected( item );
        this.possibleDnDSource=item;
    }
*/

    var treeItem=this.getItemAtPos( event.pos );
    if ( treeItem ) {
        if ( treeItem.item.children ) {

            if ( event.pos.x - treeItem.rect.x <  VG.UI.stylePool.current.skin.TreeWidget.ChildIndent || !treeItem.item.selectable ) {
                treeItem.item.open=treeItem.item.open ? false : true;
            }

            if ( treeItem.item.selectable ) this.controller.selected=treeItem.item;
        } else
        {
            if ( this.controller.multiSelection )
            {
                if ( event.keysDown.indexOf( VG.Events.KeyCodes.Shift ) >= 0 )
                {
                    if ( !this.controller.isSelected( treeItem.item ) ) this.controller.addToSelection( treeItem.item );
                    else this.controller.removeFromSelection( treeItem.item );
                } else {
                    this.controller.selected=treeItem.item;
                }
            } else {
                this.controller.selected=treeItem.item;
            }
        }
        this.possibleDnDSource=treeItem;
    }
    this.verified=false;
    this.mouseIsDown=true;
};

VG.UI.TreeWidget.prototype.mouseUp=function( event )
{
    this.possibleDnDSource=undefined;
    VG.context.workspace.dndOperation=undefined;
    VG.context.workspace.dndValidDragTarget=undefined;

    this.mouseIsDown=false;
};

VG.UI.TreeWidget.prototype.mouseDoubleClick=function( event )
{
    if ( this.controller.selected ) {
        var selected=this.controller.selected;
        var itemUnderMouse=this.getItemAtPos( event.pos );
        if ( itemUnderMouse ) itemUnderMouse=itemUnderMouse.item;

        if ( selected === itemUnderMouse )
            this.controller.selected.open=this.controller.selected.open ? false : true;
    }
    this.verified=false;
};

VG.UI.TreeWidget.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    this.offset=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.TreeWidget.prototype.verifyScrollbar=function( text )
{
    // --- Check if we have enough vertical space for all items

    this.needsVScrollbar=false;

    this.totalVisibleItemCount=this.countVisibleControllerItems();

    this.totalItemHeight=this.totalVisibleItemCount * this.itemHeight + (this.totalVisibleItemCount-1) * this.spacing;
    this.heightPerItem=this.totalItemHeight / this.controller.length;
    this.visibleItems=this.contentRect.height / this.heightPerItem;
    this.lastTopItem=Math.ceil( this.totalVisibleItemCount - this.visibleItems );

    if ( this.totalItemHeight > this.contentRect.height )
        this.needsVScrollbar=true;
    else this.offset=0;

    if ( this.needsVScrollbar && !this.vScrollbar ) {
        this.vScrollbar=VG.UI.ScrollBar( "TreeWidget Scrollbar" );
        this.vScrollbar.callbackObject=this;
    }

    this.verified=true;
};

VG.UI.TreeWidget.prototype.changed=function()
{
    this.verified=false;
    VG.update();
};

VG.UI.TreeWidget.prototype.selectionChanged=function()
{
    VG.update();
};

VG.UI.TreeWidget.prototype.paintWidget=function( canvas )
{
    this.spacing = this.customSkin ? this.customSkin.Spacing : VG.UI.stylePool.current.skin.TreeWidget.Spacing;

    if ( !this.rect.equals( this.previousRect ) ) this.verified=false;
    VG.UI.stylePool.current.drawTreeWidget( this, canvas );
    this.previousRect.set( this.rect );
};

VG.UI.TreeWidget.prototype.getItemAtPos=function( pos )
{
    for ( var i=0; i < this.items.length; ++i ) {
        if ( this.items[i].rect.contains( pos ) )
            return this.items[i];
    }
    return null;
};

VG.UI.TreeWidget.prototype.countVisibleControllerItems=function()
{
    var count=0;
    for ( var i=0; i < this.controller.length; ++i ) {
        var item=this.controller.at( i );

        ++count;

        if ( item.children && item.open )
            count+=this.countVisibleControllerChildItems( item );
    }

    return count;
};

VG.UI.TreeWidget.prototype.countVisibleControllerChildItems=function( item )
{
    var count=0;

    for ( var i=0; i < item.children.length; ++i )
    {
        var child=item.children[i];

        ++count;

        if ( child.children && child.open ) {
            count+=this.countVisibleControllerChildItems( child );
        }
    }

    return count;
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.UI.BaseText

VG.UI.BaseText=function()
{
    if ( !(this instanceof VG.UI.BaseText) ) return new VG.UI.BaseText();

    VG.UI.Frame.call( this );
    this.name="BaseText";

    this.hAlignment=VG.UI.HAlignment.Centered;
    this.vAlignment=VG.UI.VAlignment.Centered;

    this.maxTextLineSize=VG.Core.Size();
    this.textArray=[];
    this.textLines=0;
    this._textHasChanged=false;
    this.lastTextChangeTime=0;
    this.maxTextLine=0;

    this.cursorPosition=VG.Core.Point();
    this.textOffset=VG.Core.Point();

    this.selectionStart=VG.Core.Point(); // --- Unsorted
    this.selectionEnd=VG.Core.Point();

    this.startSel=VG.Core.Point(); // --- Sorted
    this.endSel=VG.Core.Point();

    this.selectionIsValid=false;

    this.vScrollbar=0;
    this.hScrollbar=0;

    this.needsVScrollbar=false;
    this.needsHScrollbar=false;

    this.supportsScrollbars=false;

    this.verified=false;
    this.spacing=0;
    this.readOnly=false;
};

VG.UI.BaseText.prototype=VG.UI.Frame();

Object.defineProperty( VG.UI.BaseText.prototype, "text", {
    get: function() {
        //return this._text;
        return this.textArray.join( "\n" );
    },
    set: function( newText ) {

        this._text=newText;

        if ( !newText ) newText="";

        this.textArray=newText.split(/\r\n|\r|\n/);

        if ( VG.context.workspace )
        {
            this.verifyText();
            this.checkCursorBounds();
        }
        this.selectionIsValid=false;
    }
});

Object.defineProperty( VG.UI.BaseText.prototype, "textHasChanged", {
    get: function() {
        return this._textHasChanged;
    },
    set: function( textHasChanged ) {
        this._textHasChanged=textHasChanged;
        this.lastTextChangeTime=Date.now();
    }
});

VG.UI.BaseText.prototype.checkCursorBounds=function()
{
    // --- Check if cursorposition is in bounds
    if ( this.cursorPosition.y >= this.textLines || isNaN( this.cursorPosition.y ) ) this.cursorPosition.y=this.textLines-1;
    if ( this.cursorPosition.x >= this.textArray[this.cursorPosition.y].length )
        this.cursorPosition.x=this.textArray[this.cursorPosition.y].length;
};

// --------------------- Clipboard

VG.UI.BaseText.prototype.clipboardCopyIsAvailable=function()
{
    if ( this.selectionIsValid ) return "Text";
    else return null;
};

VG.UI.BaseText.prototype.clipboardPasteIsAvailableForType=function( type )
{
    if ( type === "Text" && !this.readOnly ) return true;
    return false;
};

VG.UI.BaseText.prototype.clipboardCut=function()
{
    if ( !this.selectionIsValid ) return;

    VG.copyToClipboard( "Text", this.copySelection() );
    this.deleteSelection();
    this.textHasChanged=true;
    this.focusOut();
};

VG.UI.BaseText.prototype.clipboardCopy=function()
{
    VG.copyToClipboard( "Text", this.copySelection() );
};

VG.UI.BaseText.prototype.clipboardPaste=function()
{
    if ( this.selectionIsValid ) this.deleteSelection( true );
    this.insertText( VG.clipboardPasteDataForType( "Text" ) );
    this.textHasChanged=true;
    this.focusOut();
};

VG.UI.BaseText.prototype.clipboardDeleteSelection=function()
{
    if ( this.selectionIsValid ) this.deleteSelection( true );
    this.textHasChanged=true;
    this.focusOut();
};

// --------------------- Clipboard End

// --------------------- Other Functions used Globally

VG.UI.BaseText.prototype.selectAll=function()
{
    this.selectionStart.set( 0, 0 );
    this.selectionEnd.set( this.textArray[this.textLines-1].length, this.textLines-1);

    if ( !this.selectionStart.equals( this.selectionEnd ) )  {
        this.sortSelection();
        this.selectionIsValid=true;
    }
};

// ---

VG.UI.BaseText.prototype.verifyText=function()
{
    this.textLines=this.textArray.length;
    if ( this.font ) VG.context.workspace.canvas.pushFont( this.font );

    this.maxTextLineSize.set(0, 0);
    this.maxTextLineSize.height=VG.context.workspace.canvas.getLineHeight();
    this.itemHeight=this.maxTextLineSize.height + this.spacing;
    var size=VG.Core.Size();

    for ( var i=0; i < this.textLines; ++i ) {

        VG.context.workspace.canvas.getTextSize( this.textArray[i], size );
        if ( size.width > this.maxTextLineSize.width ) {

            this.maxTextLineSize.width=size.width;
            this.maxTextLine=i;
        }
        //if ( size.height > this.maxTextLineSize.height ) this.maxTextLineSize.height=size.height;
    }

    size=this.calcSize( VG.context.workspace.canvas );
    this.verified=false;

    if ( this.font ) VG.context.workspace.canvas.popFont();
};

VG.UI.BaseText.prototype.verifyTextForLineChange=function( line )
{
    //if ( line === this.maxTextLine ) { this.verifyText(); return }

    if ( this.font ) VG.context.workspace.canvas.pushFont( this.font );

    var size=VG.Core.Size();

    VG.context.workspace.canvas.getTextSize( this.textArray[line], size );
    if ( size.width > this.maxTextLineSize.width ) {
        this.maxTextLineSize.width=size.width;
        this.maxTextLine=line;
    }

    size=this.calcSize( VG.context.workspace.canvas );
    this.verified=false;

    if ( this.font ) VG.context.workspace.canvas.popFont();
};


VG.UI.BaseText.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    this.textOffset.y=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.BaseText.prototype.hHandleMoved=function( offsetInScrollbarSpace, customLine )
{
    this.textOffset.x=offsetInScrollbarSpace * this.hScrollbar.totalSize / this.hScrollbar.visibleSize;
};

VG.UI.BaseText.prototype.verifyScrollbar=function()
{
    // --- Check if we have enough vertical space for all text lines

    this.needsVScrollbar=false;

    this.totalItemHeight=this.textLines * this.maxTextLineSize.height + (this.textLines-1) * this.spacing;
    this.heightPerItem=this.totalItemHeight / this.textLines;
    this.visibleItems=Math.floor( this.contentRect.height / this.heightPerItem );
    this.lastTopItem=Math.ceil( this.textLines - this.visibleItems );

    if ( this.supportsScrollbars && this.totalItemHeight > this.contentRect.height )
        this.needsVScrollbar=true;

    if ( this.needsVScrollbar && this.supportsScrollbars && !this.vScrollbar ) {
        this.vScrollbar=VG.UI.ScrollBar( "Text Scrollbar" );
        this.vScrollbar.callbackObject=this;
    }

    if ( !this.needsVScrollbar ) this.textOffset.y=0;

    // --- Check if we have enough horizontal space for the longest text line

    this.needsHScrollbar=false;

    if ( this.supportsScrollbars && this.maxTextLineSize.width > this.contentRect.width ) {
         this.needsHScrollbar=true;
    }

    if ( this.needsHScrollbar && this.supportsScrollbars && !this.hScrollbar ) {
        this.hScrollbar=VG.UI.ScrollBar( "Text Scrollbar" );
        this.hScrollbar.direction=VG.UI.ScrollBar.Direction.Horizontal;
        this.hScrollbar.callbackObject=this;
    }

    if ( !this.needsHScrollbar ) this.textOffset.x=0;

    this.verified=true;
};

VG.UI.BaseText.prototype.calcSize=function()
{
    var size=VG.Core.Size();

    size.width=this.maxTextLineSize.width;
    size.height=this.maxTextLineSize.height * this.textLines;

    if ( this.frameType !== VG.UI.Frame.Type.None ) {
        size.width+=4;
        size.height+=4;
    }

    this.checkSizeDimensionsMinMax( size );

    return size;
};

VG.UI.BaseText.prototype.applyCursorPos=function( pos )
{
    // if ( this.font ) VG.context.workspace.canvas.pushFont( this.font );

    var lineY=Math.floor( (this.textOffset.y + pos.y - this.contentRect.y ) / this.heightPerItem );

    if ( lineY < 0 ) lineY=0;

    if ( lineY >= this.textLines )
        lineY=this.textLines-1;

    this.cursorPosition.y=lineY;

    // --- Get the x cursor position

    var text=this.textArray[this.cursorPosition.y];
    if ( !text ) { /*if ( this.font ) VG.context.workspace.canvas.popFont();*/ this.cursorPosition.x=0; return; }

    var size=VG.Core.Size();
    var offset=0;
    var textTester=text.slice( 0, offset );
    var leftPixelPosX=0;

    while ( ( (this.contentRect.x - this.textOffset.x + size.width ) < pos.x ) && offset <= text.length )
    {
        ++offset;
        textTester=text.slice( 0, offset );
        leftPixelPosX=size.width;
        VG.context.workspace.canvas.getTextSize( textTester, size );
    }

    var rightPixelPosX=size.width;

    // --- Place the cursor on the left or right side of the character depending on click position

    if ( ( pos.x - this.contentRect.x ) <= leftPixelPosX + (rightPixelPosX - leftPixelPosX) / 2 )
    {
        this.cursorPosition.x=offset-1;
    } else {
        this.cursorPosition.x=offset;
    }

    // --- Bounds check

    if ( this.cursorPosition.x < 0 ) this.cursorPosition.x=0;
    if ( this.cursorPosition.x >= text.length ) this.cursorPosition.x=text.length;

    // if ( this.font ) VG.context.workspace.canvas.popFont();

    if ( this.cursorChanged ) this.cursorChanged( this.cursorPosition );
};

VG.UI.BaseText.prototype.mouseMove=function( event )
{
    if ( this.needsVScrollbar && this.vScrollbar )
    {
        if ( this.vScrollbar.rect.contains( event.pos ) ) {
            this.vScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.vScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.vScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }

    if ( this.needsHScrollbar && this.hScrollbar )
    {
        if ( this.hScrollbar.rect.contains( event.pos ) ) {
            this.hScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.hScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.hScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }

    // --- If mouse leaves the entry field and the text is changed, accept the text changes if not a TextLineEdit

    if ( !this.rect.contains( event.pos ) && this.textHasChanged && (!(this instanceof VG.UI.TextLineEdit)) )
        this.focusOut();

    // --- Selection

    if ( this.dragging ) {
        this.applyCursorPos( event.pos );

        this.selectionEnd.set( this.cursorPosition );
        if ( !this.selectionStart.equals( this.selectionEnd ) ) {

            this.sortSelection();
            this.selectionIsValid=true;
            VG.update();
            //VG.Utils.ensureRedrawWithinMs( 50 );
        }
    }
};

VG.UI.BaseText.prototype.mouseDown=function( event )
{
    if ( event.button !== VG.Events.MouseButton.Left ) return;

    // --- Test if the mouse-click is inside one of the scrollbars

    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    if ( this.needsHScrollbar && this.hScrollbar && this.hScrollbar.rect.contains( event.pos ) ) {
        this.hScrollbar.mouseDown( event );
        return;
    }

    if ( this.lastDClickTime && ( ( Date.now() ) - this.lastDClickTime  < 300 ) )
    {
        this.selectionStart.x=0;
        this.selectionEnd.x=this.textArray[this.cursorPosition.y].length;

        if ( !this.selectionStart.equals( this.selectionEnd ) )  {
            this.sortSelection();
            this.selectionIsValid=true;
        }
    } else
    {
        this.dragging=true;

        this.applyCursorPos( event.pos );
        this.selectionStart.set( this.cursorPosition );
        this.selectionEnd.set( this.cursorPosition );
        this.selectionIsValid=false;
    }

    // ---

    this.resetBlinkState();
    VG.update();
};

VG.UI.BaseText.prototype.mouseDoubleClick=function( event )
{
    this.dragging=false; this.selectionIsValid=false;
    this.applyCursorPos( event.pos );

    var text=this.textArray[this.cursorPosition.y];
    this.selectionStart.x=this.selectionEnd.x=this.cursorPosition.x;
    this.selectionStart.y=this.selectionEnd.y=this.cursorPosition.y;

    var boundryItems=[" ", ".", ",", ":", ";", "=", "(", ")", "[", "]", "{", "}", "\"", "'"];

    this.selectionStart.x=this.textBoundry( text, true, boundryItems, this.selectionStart.x );
    this.selectionEnd.x=this.textBoundry( text, false, boundryItems, this.selectionEnd.x );

    if ( !this.selectionStart.equals( this.selectionEnd ) )  {
        this.lastDClickTime=Date.now();
        this.sortSelection();
        this.selectionIsValid=true;

        VG.Utils.scheduleRedrawInMs( 30 );
        VG.update();
    } else
    {
        // --- Select the whole line

        text=this.textArray[this.cursorPosition.y];

        if ( text.length )
        {
            this.selectionStart.y=this.selectionEnd.y=this.cursorPosition.y;
            this.selectionStart.x=0; this.selectionEnd.x=text.length;

            this.selectionIsValid=true;
            VG.update();
        }
    }

    if ( this.mouseDoubleClickCallback ) this.mouseDoubleClickCallback( this.textArray[this.cursorPosition.y] );
};

VG.UI.BaseText.prototype.textBoundry=function( text, left, boundryItems, offset )
{
    var i=offset;
    while( i > 0 && i < text.length )
    {
        var value=text[i];
        var hit=false;

        for ( var k=0; k < boundryItems.length; ++k ) {
            if ( boundryItems[k] === value ) {
                if ( left && i+1 < text.length ) return i+1;
                else return i;
            }
        }

        if ( !hit ) {
            if ( left ) i-=1;
            else i+=1;
        }
    }
    return i;
};

VG.UI.BaseText.prototype.mouseUp=function( event )
{
    this.dragging=false;
};

VG.UI.BaseText.prototype.keyDown=function( keyCode, keysDown )
{
    //console.log( "BaseText:" + keyCode );
    var recognized=false;
    var hasChanged=false;

    if ( keyCode == VG.Events.KeyCodes.ArrowLeft )
    {
        // --- Arrow Key Left

        if ( keysDown.indexOf( VG.Events.KeyCodes.AppleLeft ) !== -1 || keysDown.indexOf( VG.Events.KeyCodes.Ctrl ) !== -1 )
        {
            // --- Goto Start of Line

            var oldCursorPos=this.cursorPosition.x;
            this.cursorPosition.x=0;
            var text=this.textArray[this.cursorPosition.y];

            if ( this.enforceJSSyntax ) {
                for( i=0; i < text.length; ++i ) {
                    if ( text[i] !== " " ) break;
                    else ++this.cursorPosition.x;
                }
            }

            if ( this.cursorPosition.x && this.cursorPosition.x === oldCursorPos )
                this.cursorPosition.x=0;
        } else
        {
            // --- Single Char Left

            if ( this.cursorPosition.x > 0 )
            {
                this.cursorPosition.x-=1;
            } else if ( !this.cursorPosition.x && this.cursorPosition.y > 0 )
            {
                this.cursorPosition.y-=1;
                this.cursorPosition.x=this.textArray[this.cursorPosition.y].length;
            }
        }

        if ( this.needsHScrollbar )
            this.ensureCursorIsVisible();

        recognized=true;
    } else
    if ( keyCode == VG.Events.KeyCodes.ArrowRight )
    {
        // --- Arrow Key Right

        if ( keysDown.indexOf( VG.Events.KeyCodes.AppleLeft ) !== -1 || keysDown.indexOf( VG.Events.KeyCodes.Ctrl ) !== -1 )
        {
            // --- Goto End of Line

            this.cursorPosition.x=this.textArray[this.cursorPosition.y].length;
        } else
        {
            // --- Single Char Right
            if ( this.cursorPosition.x < this.textArray[this.cursorPosition.y].length )
            {
                this.cursorPosition.x+=1;
            } else if ( this.cursorPosition.x >= this.textArray[this.cursorPosition.y].length && this.cursorPosition.y < this.textLines-1 )
            {
                this.cursorPosition.y+=1;
                this.cursorPosition.x=0;
            }
        }

        if ( this.needsHScrollbar )
            this.ensureCursorIsVisible();

        recognized=true;
    } else
    if ( keyCode == VG.Events.KeyCodes.ArrowUp )
    {
        // --- Arrow Key Up

        if ( keysDown.indexOf( VG.Events.KeyCodes.Alt ) !== -1 )
        {
            // --- Alt Key: Page Down

            this.cursorPosition.y-=this.visibleItems;
            this.textOffset.y-=this.visibleItems * this.itemHeight;

            if ( this.cursorPosition.y < 0 ) this.cursorPosition.y=0;
            if ( this.textOffset.y < 0 ) this.textOffset.y=0;

            this.vScrollbar.scrollTo( this.textOffset.y );
        } else {
            if ( this.cursorPosition.y > 0 )
            {
                // --- Singe Line Up

                this.cursorPosition.y-=1;

                // --- Correct X Position if necessary
                if ( this.cursorPosition.x > this.textArray[this.cursorPosition.y].length )
                    this.cursorPosition.x=this.textArray[this.cursorPosition.y].length;

                if ( this.needsHScrollbar )
                    this.ensureCursorIsVisible();

                if ( this.needsVScrollbar )
                {
                    // --- Scroll one line up if necessary
                    y=this.contentRect.y - this.textOffset.y + (this.cursorPosition.y) * (this.maxTextLineSize.height + this.spacing);

                    if ( y < this.contentRect.y ) {
                        this.textOffset.y-=this.itemHeight;
                        this.vScrollbar.scrollTo( this.textOffset.y );
                    }
                }
            }
        }

        recognized=true;
    } else
    if ( keyCode == VG.Events.KeyCodes.ArrowDown )
    {
        // --- Arrow Key Down

        if ( keysDown.indexOf( VG.Events.KeyCodes.Alt ) !== -1 )
        {
            // --- Alt Key: Page Down

            this.cursorPosition.y+=this.visibleItems;
            this.textOffset.y+=this.visibleItems * this.itemHeight;

            if ( this.cursorPosition.y >= this.textLines-1 ) this.cursorPosition.y=this.textLines-1;

            this.vScrollbar.scrollTo( this.textOffset.y );
        } else {
            if ( this.cursorPosition.y < this.textLines-1 )
            {
                // --- Single Line Down

                this.cursorPosition.y+=1;

                // --- Correct X Position if necessary
                if ( this.cursorPosition.x > this.textArray[this.cursorPosition.y].length ) {
                    this.cursorPosition.x=this.textArray[this.cursorPosition.y].length;

                    if ( this.needsHScrollbar )
                        this.ensureCursorIsVisible();
                }

                if ( this.needsVScrollbar )
                {
                    // --- Scroll one line down if necessary
                    y=this.contentRect.y - this.textOffset.y + this.cursorPosition.y * (this.maxTextLineSize.height + this.spacing);

                    if ( y + this.maxTextLineSize.height > this.contentRect.bottom() ) {
                        this.textOffset.y+=this.maxTextLineSize.height + this.spacing;
                        this.vScrollbar.scrollTo( this.textOffset.y );
                    }
                }
            }
        }

        recognized=true;
    } else
    if ( keyCode == VG.Events.KeyCodes.Backspace && !this.readOnly )
    {
        // --- Delete Pressed

        if ( this.selectionIsValid )
            this.deleteSelection( this.embedded );
        else
        if ( this.cursorPosition.x > 0 )
        {
            var processed=false;
            oldText=this.textArray[this.cursorPosition.y];

            if ( this.enforceJSSyntax )
            {
                // --- CodeEditor only
                if ( this.settings && this.settings.Spaces )//&& this.cursorPosition.x >= this.settings.Spaces )
                {
                    processed=true; var spacesToEliminate=this.cursorPosition.x % this.settings.Spaces;
                    if ( !spacesToEliminate ) spacesToEliminate=this.settings.Spaces;
                    for( i=1; i <= spacesToEliminate; ++i ) {
                        if ( oldText[this.cursorPosition.x-i] !== ' ' )
                        { processed=false; break; }
                    }
                    if ( processed ) {
                        this.textArray[this.cursorPosition.y]=oldText.slice( 0, this.cursorPosition.x - spacesToEliminate ) + oldText.slice( this.cursorPosition.x );
                        this.cursorPosition.x-=spacesToEliminate;
                    }
                }
            }

            if ( !processed ) {
                // --- Delete the previous character

                this.cursorPosition.x-=1;

                newText=oldText.slice(0, this.cursorPosition.x);
                this.textArray[this.cursorPosition.y]=newText + oldText.slice( this.cursorPosition.x+1 );
            }

            this.textHasChanged=true;
            hasChanged=true;
        } else
        if ( this.cursorPosition.y > 0 )
        {
            // --- Remove this line and append this line to the previous line

            oldText=this.textArray[this.cursorPosition.y];
            this.textArray.splice( this.cursorPosition.y, 1 );

            this.cursorPosition.y-=1;
            this.cursorPosition.x=this.textArray[this.cursorPosition.y].length;

            newText=this.textArray[this.cursorPosition.y] + oldText;
            this.textArray[this.cursorPosition.y]=newText;

            this.verifyText();
            this.textHasChanged=true;
        }

        if ( this.needsHScrollbar )
            this.ensureCursorIsVisible();

        recognized=true;
    } else
    if ( keyCode === VG.Events.KeyCodes.Esc && this.embedded ) {
        this.focusOut();
        if ( this.textChanged ) this.textChanged();
    }

    if ( recognized )
    {
        this.selectionIsValid=false;
        if ( hasChanged ) this.verifyTextForLineChange( this.cursorPosition.y );
        this.resetBlinkState();
        VG.update();
    }

    if ( this.keyDownCallback ) this.keyDownCallback( keyCode, keysDown );

    return recognized;
};

VG.UI.BaseText.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return false;

    if ( step < 0 ) {
        this.textOffset.y -= Math.round( step * this.itemHeight * 3 );
        this.vScrollbar.scrollTo( this.textOffset.y );
    } else
    {
        this.textOffset.y -= Math.round( step * this.itemHeight * 3 );
        this.vScrollbar.scrollTo( this.textOffset.y );
    }

    this.resetBlinkState();
    VG.update();
    return true;
};

VG.UI.BaseText.prototype.ensureCursorIsVisible=function()
{
    if ( this.font ) VG.context.workspace.canvas.pushFont( this.font );

    var text=this.textArray[this.cursorPosition.y];
    text=text.slice( 0, this.cursorPosition.x );

    var size=VG.context.workspace.canvas.getTextSize( text );

    var cursorPosX=this.contentRect.x + size.width - this.textOffset.x;

    if ( cursorPosX > this.contentRect.right() )
    {
        this.setHScrollbarDimensions( VG.context.workspace.canvas );

        this.textOffset.x+=cursorPosX - this.contentRect.right();
        this.hScrollbar.scrollTo( this.textOffset.x );
    } else
    if ( cursorPosX < this.contentRect.x )
    {
        this.textOffset.x-=this.contentRect.x - cursorPosX;
        this.hScrollbar.scrollTo( this.textOffset.x );
    }

    if ( this.font ) VG.context.workspace.canvas.popFont();
};

VG.UI.BaseText.prototype.blink=function( canvas, cursorYPos, cursorHeight )
{
    if ( this.hasFocusState ) {

        var time=Date.now();

        if ( time > this.nextAnimationEventAt ) {
            this.blinkState=!this.blinkState;

            this.nextAnimationEventAt=time + 500;
            if ( VG.context.workspace.autoRedrawInterval > 500 )
                VG.context.workspace.redrawList.push( this.nextAnimationEventAt );

            if ( this._textHasChanged && !(this instanceof VG.UI.TextLineEdit) && (Date.now() - this.lastTextChangeTime) > 1000 ) this.focusOut();
        }

        if ( this.blinkState )
        {
            var cursorRect=VG.Core.Rect( this.contentRect );
            cursorRect.x+=this.cursorPosToPixelOffset( this.cursorPosition );

            if ( cursorYPos === undefined ) {
                cursorRect.x-=this.textOffset.x;
                cursorRect.y+=this.cursorPosition.y * this.itemHeight - this.textOffset.y;
                cursorRect.height=this.maxTextLineSize.height;
            } else {
                if ( VG.UI.NumberEdit && this instanceof VG.UI.NumberEdit )
                {
                    cursorRect.y+=this.cursorPosition.y * this.itemHeight - this.textOffset.y;
                    cursorRect.height=this.rect.height-4;//this.maxTextLineSize.height;// - 4;
                } else {
                    cursorRect.y=cursorYPos;
                    cursorRect.height=cursorHeight;
                }
            }

            cursorRect.width=1;

            if ( this.password )
                cursorRect.x=this.contentRect.x + (this.cursorPosition.x /*- this.textOffset.x*/) * (10+2);

            var color=VG.UI.stylePool.current.skin.Widget.TextColor;
            if ( this.blinkColor ) color=this.blinkColor;

            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, cursorRect, color );
        }
    }
};

VG.UI.BaseText.prototype.cursorPosToPixelOffset=function( pos )
{
    // if ( this.font ) VG.context.workspace.canvas.pushFont( this.font );

    var text=this.textArray[pos.y];
    text=text.slice( 0, pos.x );

    var size=VG.context.workspace.canvas.getTextSize( text, size );

    // if ( this.font ) VG.context.workspace.canvas.popFont();

    if ( size.width > this.contentRect.width ) size.width=this.contentRect.width;

    return size.width;
};

VG.UI.BaseText.prototype.insertText=function( text )
{
    var result="";

    for( i=0; i < this.cursorPosition.y; ++i)
        result+=this.textArray[i] + "\n";

    result+=this.textArray[this.cursorPosition.y].slice(0, this.cursorPosition.x);

    // --- Chop off whitespace in front of text to insert

    var whitespace=0;
    while( text[whitespace] === " " && whitespace < text.length ) ++whitespace;
    if ( whitespace ) text=text.slice( whitespace );

    // ---

    result+=text;
    result+=this.textArray[this.cursorPosition.y].slice( this.cursorPosition.x );

    // --- If text to insert has no line feed at the end, append one
    if ( text.indexOf( "\n", text.length - 1 ) === -1 ) result+="\n";

    for( i=this.cursorPosition.y+1; i < this.textLines; ++i)
        result+=this.textArray[i] + "\n";

    if ( result.indexOf( "\n", result.length - 1 ) !== -1 ) result=result.slice( 0, result.length-1 );

    // --- Adjust cursor position to end of inserted text
    var textArray=text.split(/\r\n|\r|\n/);

    if ( textArray.length === 1 )
        this.cursorPosition.x+=textArray[textArray.length-1].length;
    else
    {
        if ( textArray[textArray.length-1].length === 0 )
            textArray=textArray.slice( 0, textArray.length-1);

        this.cursorPosition.x=textArray[textArray.length-1].length;
        this.cursorPosition.y+=textArray.length-1;
    }

    this.text=result;
};

VG.UI.BaseText.prototype.sortSelection=function()
{
    if ( this.selectionStart.y === this.selectionEnd.y ) {
        if ( this.selectionStart.x < this.selectionEnd.x ) { this.startSel.set( this.selectionStart ); this.endSel.set( this.selectionEnd ); }
        else { this.startSel.set( this.selectionEnd ); this.endSel.set( this.selectionStart ); }
    } else if ( this.selectionStart.y < this.selectionEnd.y ) { this.startSel.set( this.selectionStart ); this.endSel.set( this.selectionEnd ); }
    else { this.startSel.set( this.selectionEnd ); this.endSel.set( this.selectionStart ); }
};

VG.UI.BaseText.prototype.deleteSelection=function( noUndo )
{
    var result="";

    for( i=0; i < this.startSel.y; ++i)
        result+=this.textArray[i] + "\n";

    result+=this.textArray[this.startSel.y].slice(0, this.startSel.x);
    result+=this.textArray[this.endSel.y].slice( this.endSel.x ) + "\n";

    for( i=this.endSel.y+1; i < this.textLines; ++i)
        result+=this.textArray[i] + "\n";

    if ( result.indexOf( "\n", result.length - 1 ) !== -1 ) result=result.slice( 0, result.length-1 );

    this.focusOut();

    this.text=result;
    this.cursorPosition.set( this.startSel );
    this.selectionIsValid=false;

    if ( !noUndo ) {
        this.textHasChanged=true;
        this.focusOut();
    }
};

VG.UI.BaseText.prototype.copySelection=function( text )
{
    var result="";

    if ( this.startSel.y === this.endSel.y )
    {
        result+=this.textArray[this.startSel.y].slice( this.startSel.x, this.endSel.x );
        return result;
    }
    result+=this.textArray[this.startSel.y].slice( this.startSel.x) + "\n";

    for( var i=this.startSel.y+1; i < this.endSel.y; ++i)
        result+=this.textArray[i] + "\n";

    result+=this.textArray[this.endSel.y].slice( 0, this.endSel.x ) + "\n";

    return result;
};

VG.UI.BaseText.prototype.resetBlinkState=function()
{
    this.blinkState=0;
    this.nextAnimationEventAt=0;

    if ( this.cursorChanged ) this.cursorChanged( this.cursorPosition );
};

VG.UI.BaseText.prototype.drawSelectionForLine=function( canvas, i, paintRect, text, color )
{
    var size=VG.Core.Size();

    if ( i >= this.startSel.y && i <= this.endSel.y )
    {
        if ( i === this.startSel.y && i === this.endSel.y ) {
            bX=paintRect.x; bWidth=paintRect.width;

            paintRect.x=this.contentRect.x - this.textOffset.x + this.cursorPosToPixelOffset( this.startSel );
            paintRect.width=this.cursorPosToPixelOffset( this.endSel ) - this.cursorPosToPixelOffset( this.startSel );

            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, paintRect, color );

            paintRect.x=bX;
            paintRect.width=bWidth;
        } else
        if ( i === this.startSel.y && i !== this.endSel.y ) {
            bX=paintRect.x; bWidth=paintRect.width;

            paintRect.x=this.contentRect.x - this.textOffset.x + this.cursorPosToPixelOffset( this.startSel );
            paintRect.width=this.contentRect.x - this.textOffset.x + canvas.getTextSize( text, size ).width - paintRect.x;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, paintRect, color );

            paintRect.x=bX;
            paintRect.width=bWidth;
        } else
        if ( i !== this.startSel.y && i !== this.endSel.y ) {
            bWidth=paintRect.width;

            paintRect.width=this.contentRect.x - this.textOffset.x + canvas.getTextSize( text, size ).width - paintRect.x;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, paintRect, color );

            paintRect.width=bWidth;
        } else
        if ( i !== this.startSel.y && i === this.endSel.y ) {
            bWidth=paintRect.width;

            paintRect.width=this.contentRect.x - this.textOffset.x + this.cursorPosToPixelOffset( this.endSel ) - paintRect.x;
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, paintRect, color );

            paintRect.width=bWidth;
        }
    }
};

VG.UI.BaseText.prototype.drawSearchTerm=function( canvas, y, paintRect, text, color )
{
    var offset=-1;

    if ( this.searchTermCaseSensitive ) offset=text.indexOf( this.searchTerm );
    else offset=text.toLowerCase().indexOf( this.searchTerm.toLowerCase() );

    if ( offset !== -1 )
    {
        var text1=text.slice( 0, offset );

        var size=canvas.getTextSize( text1 );

        var bX=paintRect.x, bWidth=paintRect.width;

        paintRect.x=this.contentRect.x - this.textOffset.x + size.width;
        paintRect.width=canvas.getTextSize( text.slice( offset, offset+this.searchTerm.length ), size ).width;

        if ( this.lastSearchTermResult && this.lastSearchTermResult.x === offset && this.lastSearchTermResult.y === y ) color.a=1.0;
        else color.a=0.5;

        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, paintRect, color );

        paintRect.x=bX;
        paintRect.width=bWidth;
    }
};

VG.UI.BaseText.prototype.autoScroll=function()
{
    var pos=VG.context.workspace.mousePos;
    var yPos=this.textOffset.y;

    if ( /*this.selectionEnd.y > this.startSel.y &&*/ pos.y > this.contentRect.bottom() - this.contentRect.height / 5 )
    {
        // --- Scroll down
        this.mouseWheel( -1 );
    } else
    if ( /*this.selectionStart.y > this.selectionEnd.y &&*/ pos.y - this.contentRect.y < this.contentRect.height / 5 )
    {
        // --- Scroll up
        this.mouseWheel( 1 );
    }

    if ( yPos != this.textOffset.y )
    {
        this.applyCursorPos( pos );
        this.selectionEnd.set( this.cursorPosition );
        this.sortSelection();

        //VG.Utils.ensureRedrawWithinMs( 10 );
        VG.context.workspace.redrawList.push( Date.now() + 10 );
    }
};

VG.UI.BaseText.prototype.gotoLine=function( lineNr )
{
    if ( this.vScrollbar ) {
        this.verifyScrollbar();

        var line=lineNr;
        line-=this.visibleItems/2;

        this.cursorPosition.x=0;
        this.cursorPosition.y=lineNr;
        this.textOffset.y=line * this.itemHeight;

        this.setVScrollbarDimensions( VG.context.workspace.canvas );
        this.vScrollbar.scrollTo( this.textOffset.y );
    }
};

VG.UI.BaseText.prototype.gotoNextSearchTerm=function( forward )
{
    if ( !this.searchTerm || this.searchTerm.length === 0 ) return;

    function searchForTerm( text ) {
        var offset=-1;

        if ( this.searchTermCaseSensitive ) offset=text.indexOf( this.searchTerm );
        else offset=text.toLowerCase().indexOf( this.searchTerm.toLowerCase() );

        return offset;
    }

    var x=this.cursorPosition.x, y=this.cursorPosition.y;
    var startY=y, wrap=false;

    //console.log( "gotoNextSearchTerm", x, y );

    if ( forward )
    {
        x+=1;

        while( !(y === startY && wrap) )
        {
            offset=-1;
            text=this.textArray[y];

            if ( x >= 0 && x < text.length ) {

                if ( x ) offset=searchForTerm.call( this, text.slice(x) );
                else offset=searchForTerm.call( this, text );

                if ( offset !== -1 ) {

                    // ---

                    //console.log( "found at", x, y );

                    if ( !this.lastSearchTermResult ) this.lastSearchTermResult=VG.Core.Point();
                    this.lastSearchTermResult.set( offset, y );
                    this.selectionIsValid=false;

                    this.gotoLine( y );
                    this.cursorPosition.x=offset;
                    this.cursorPosition.y=y;

                    this.resetBlinkState();

                    return true;
                }
            }

            x=0; ++y;

            if ( y === this.textLines ) {
                wrap=true;
                y=0;
            }
        }
    } else
    {
        if ( x === 0 ) {
            y-=1; if ( y < 0 ) y=this.textLines-1;
        }
        while( !(y === startY && wrap) )
        {
            offset=-1;
            text=this.textArray[y];

            if ( x >= 0 && x < text.length ) {

                if ( x ) offset=searchForTerm.call( this, text.slice( 0, x ) );
                else offset=searchForTerm.call( this, text );

                if ( offset !== -1 ) {

                    // ---

                    //console.log( "found at", x, y );

                    if ( !this.lastSearchTermResult ) this.lastSearchTermResult=VG.Core.Point();
                    this.lastSearchTermResult.set( offset, y );
                    this.selectionIsValid=false;

                    this.gotoLine( y );
                    this.cursorPosition.x=offset;
                    this.cursorPosition.y=y;

                    this.resetBlinkState();

                    return true;
                }
            }

            x=0; --y;

            if ( y < 0 ) {
                wrap=true;
                y=this.textLines-1;
            }
        }
    }

    return false;
};

/**
 * Creates a read-only text label widget.
 * @param {string} text - The text of the label.
 * @property {string} text - The text to display.
 * @property {VG.UI.HAlignment} hAlignment - The horizontal alignment of the label inside the available widget space.
 * @property {VG.UI.VAlignment} vAlignment - The vertical alignment of the label inside the available widget space.
 * @constructor
 */

VG.UI.Label=function( option1, option2 )
{
    if ( !(this instanceof VG.UI.Label) ) return new VG.UI.Label( option1, option2 );

    VG.UI.Widget.call( this );
    this.name="Label";

    this._margin = VG.Core.Size( 4, 4 );

    if ( typeof option1 == 'string' || option1 instanceof String )
    {
        this.text = option1;
    } else {
        this.options = option1 || {};
        var opt = this.options;
        if ( opt.color ) {
            this.type = VG.UI.Label.Type.Color;
        } else
        if ( opt.svgName ) {
            this.type = VG.UI.Label.Type.SVG;
        }
    }

    this.hAlignment=VG.UI.HAlignment.Centered;
    this.vAlignment=VG.UI.VAlignment.Centered;

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.supportsFocus=true;
    this.verifySize();
};

VG.UI.Label.prototype=VG.UI.Widget();

VG.UI.Label.Type = { "Text" : 0, "Image" : 1, "SVG" : 2, "Color" : 3 };

Object.defineProperty( VG.UI.Label.prototype, "margin", {
    get: function() {
        return this._margin;
    },
    set: function( newMargin ) {

        this._margin.copy( newMargin );
        this.verifySize();
    }
});

Object.defineProperty( VG.UI.Label.prototype, "text", {
    get: function() {
        return this._text;
    },
    set: function( newText ) {

        this.font = VG.Font.Font( VG.UI.stylePool.current.skin.Label.Font );
        this.type = VG.UI.Label.Type.Text;

        this._text = newText;
        this.verifySize();
    }
});

VG.UI.Label.prototype.verifySize = function()
{
    if ( this.type === VG.UI.Label.Type.Text )
    {
        if ( VG.context.workspace && this.font )
        {
            VG.context.workspace.canvas.pushFont( this.font );
            VG.context.workspace.canvas.getTextSize( this._text, this.preferredSize );
            this.preferredSize.add( this._margin.width, this._margin.height, this.preferredSize );
            this.checkSizeDimensionsMinMax( this.preferredSize );
            VG.context.workspace.canvas.popFont();
            this.sizeVerified = true;
        }
    } else
    if ( this.type === VG.UI.Label.Type.SVG )
    {
        let opt = this.options;
        this.svg = VG.Utils.getSVGByName( opt.svgName );
        if ( this.svg ) {
            this.svgGroup = this.svg.getGroupByName( opt.svgGroupName );

            this.sizeVerified = true;
        }

        this.preferredSize.width = opt.width || 24;
        this.preferredSize.height = opt.height || 24;
        this.preferredSize.add( this._margin.width, this._margin.height, this.preferredSize );
    } else
    if ( this.type === VG.UI.Label.Type.Color )
    {
        let opt = this.options;
        this.preferredSize.width = opt.width || 24;
        this.preferredSize.height = opt.height || 24;
        // this.colorFrame = new VG.Core.Color( 128, 128, 128 );
        this.preferredSize.add( this._margin.width, this._margin.height, this.preferredSize );
    }
};

/**
 * Binds the widget to the data model. This widget has to be bound to a String value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.Label.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.Label.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.text="";
    else this.text=value;

    if ( this.textChanged )
        this.textChanged.call( VG.context, value );
};

VG.UI.Label.prototype.calcSize=function()
{
    return this.preferredSize;
};

VG.UI.Label.prototype.focusIn=function()
{
    if ( this.focusInCallback )
        this.focusInCallback( this );
};

VG.UI.Label.prototype.paintWidget=function( canvas )
{
    if ( this.disabled ) canvas.setAlpha( VG.UI.stylePool.current.skin.Widget.DisabledAlpha );

    VG.UI.Frame.prototype.paintWidget.call( this, canvas );
    var rect=this.contentRect;

    if ( !this.sizeVerified ) this.verifySize();

    if ( this.type === VG.UI.Label.Type.Text && this.sizeVerified )
    {
        this.font.setFont( VG.UI.stylePool.current.skin.Label.Font );
        canvas.pushFont(this.font);

        if ( this.frameType !== VG.UI.Frame.Type.None )
            rect.add( 2, 2, -4, -4, rect );

        var totalHeight = this.preferredSize.height;
/*
        if ( this.vAlignment === VG.UI.VAlignment.Top ) {
            rect.y=this.contentRect.y;
        } else
        if ( this.vAlignment === VG.UI.VAlignment.Centered ) {
            rect.y=this.contentRect.y + (this.contentRect.height - totalHeight) / 2;
        } else
        if ( this.vAlignment === VG.UI.VAlignment.Bottom ) {
            rect.y=this.contentRect.y + this.contentRect.height - totalHeight;
        }
*/
        var textColor = this.customColor ? this.customColor : VG.UI.stylePool.current.skin.Widget.TextColor;
        canvas.drawTextRect( this._text, rect, textColor, this.hAlignment, 1 );

        canvas.popFont();
    } else
    if ( this.type === VG.UI.Label.Type.SVG && this.sizeVerified )
    {
        this.contentRect.copy( this.rect );
        this.contentRect.shrink( this._margin.width, this._margin.height, this.contentRect );
        canvas.drawSVG( this.svg, this.svgGroup, this.contentRect, VG.UI.stylePool.current.skin.Widget.TextColor );
    } else
    if ( this.type === VG.UI.Label.Type.Color )
    {
        this.contentRect.copy( this.rect );
        this.contentRect.shrink( this._margin.width, this._margin.height, this.contentRect );
        // canvas.draw2DShapeGL( VG.Canvas.Shape2D.Rectangle, this.contentRect, this.colorFrame );
        // this.contentRect.shrink( 1, 1, this.contentRect );
        canvas.draw2DShapeGL( VG.Canvas.Shape2D.Rectangle, this.contentRect, this.options.color );
    }
    if ( this.disabled ) canvas.setAlpha( 1 );
};

/**
 * Creates a an editable single-line text widget.
 * @param {string} text - The text to edit.
 * @property {string} text - The text to edit.
 * @borrows VG.UI.ListWidget.bind as VG.UI.TextLineEdit.bind
 * @constructor
 */

VG.UI.TextLineEdit=function( text )
{
    if ( !(this instanceof VG.UI.TextLineEdit) ) return new VG.UI.TextLineEdit( text );

    VG.UI.BaseText.call( this );
    this.name="TextLineEdit";

    this.font=VG.Font.Font( VG.UI.stylePool.current.skin.TextLineEdit.Font );

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    if ( arguments.length ) this.text=arguments[0];
    else this.text="";

    this.verifyScrollbar();

    // --- Setup Default Context Menu

    this.contextMenu=VG.UI.ContextMenu();
    this.contextMenu.aboutToShow=function() {
        this.copyMenuItem.disabled=!this.clipboardCopyIsAvailable( "Text" );
        this.cutMenuItem.disabled=this.copyMenuItem.disabled;
        this.pasteMenuItem.disabled=!VG.clipboardPasteDataForType( "Text" );
    }.bind( this );

    this.cutMenuItem=this.contextMenu.addItem( "Cut", null, function() {
        VG.copyToClipboard( "Text", this.copySelection() );
        if ( this.selectionIsValid ) this.deleteSelection();
    }.bind( this ));

    this.copyMenuItem=this.contextMenu.addItem( "Copy", null, function() {
        VG.copyToClipboard( "Text", this.copySelection() );
    }.bind( this ));

    this.pasteMenuItem=this.contextMenu.addItem( "Paste", null, function() {
        if ( this.selectionIsValid ) this.deleteSelection( true );
        this.insertText( VG.clipboardPasteDataForType( "Text" ) );
        this.textHasChanged=true;
        this.focusOut();
    }.bind( this ));
};

VG.UI.TextLineEdit.prototype=VG.UI.BaseText();

/**
 * Binds the widget to the data model. This widget has to be bound to a String value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.TextLineEdit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.TextLineEdit.prototype.valueFromModel=function( value )
{
    //console.log( "TextLineEdit.valueFromModel: " + value );

    if ( value === null ) this.text="";
    else this.text=value;

    if ( this.textChanged )
        this.textChanged.call( VG.context, this.text, true, this );

    this.verifyScrollbar();
};

VG.UI.TextLineEdit.prototype.calcSize=function( canvas )
{
    var size=VG.Core.Size();

    this.font.setFont( VG.UI.stylePool.current.skin.TextLineEdit.Font );
    canvas.pushFont(this.font);

    VG.context.workspace.canvas.getTextSize( this.text, size );

    size.height=VG.context.workspace.canvas.getLineHeight();

    if ( !this.embedded )
        size=size.add( 16, 3 );

    this.maximumSize.height=size.height;
    this.checkSizeDimensionsMinMax( size );

    canvas.popFont();

    return size;
};

VG.UI.TextLineEdit.prototype.focusIn=function()
{
    this.resetBlinkState();
    this.selectAll();

    if ( this.focusInCallback )
        this.focusInCallback( this );
};

VG.UI.TextLineEdit.prototype.focusOut=function()
{
    if ( this.textHasChanged )
    {
        if ( VG.UI.NumberEdit && this instanceof VG.UI.NumberEdit && this.valueIsValid() )
        {
            if ( this.changed )
                this.changed.call( VG.context, this.value, false, this );

            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.value, undoText : this.undoText } );

        } else
        {
            if ( this.textChanged )
                this.textChanged( this.text, false, this );

            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.text, undoText : this.undoText } );
        }
        this.textHasChanged=false;
    }
};

VG.UI.TextLineEdit.prototype.keyDown=function( keyCode, keysDown )
{
    //console.log( "TextLineEdit:" + keyCode );

    if ( VG.UI.BaseText.prototype.keyDown.call( this, keyCode, keysDown ) )
        return;

    var recognized=false;

    if ( keyCode == VG.Events.KeyCodes.Enter || keyCode == VG.Events.KeyCodes.Tab )
    {
        if ( this.textHasChanged )
        {
            if (  VG.UI.NumberEdit && this instanceof VG.UI.NumberEdit && this.valueIsValid() )
            {
                if ( this.collection && this.path )
                    this.collection.storeDataForPath( { path : this.path, value : this.value, undoText : this.undoText } );

                if ( this.changed )
                    this.changed( this.value, true, this );
            } else
            {
                if ( this.collection && this.path )
                    this.collection.storeDataForPath( { path : this.path, value : this.text, undoText : this.undoText } );

                if ( this.textChanged )
                    this.textChanged( this.text, true, this );
            }
            this.textHasChanged=false;
        }

        if ( keyCode == VG.Events.KeyCodes.Tab )
            VG.context.workspace.cycleFocus( this );

        recognized=true;
    }

    if ( recognized )
    {
        //if ( this.textChanged )
        //    this.textChanged.call( VG.context );

        this.resetBlinkState();
        VG.update();
    }
};

VG.UI.TextLineEdit.prototype.textInput=function( text )
{
    if ( this.selectionIsValid ) this.deleteSelection( true );
    if ( this.inputFilter ) text=this.inputFilter( text );

    var oldText=this.textArray[this.cursorPosition.y];
    this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x) + text + oldText.slice( this.cursorPosition.x );

    //if ( this.textChanged )
    //    this.textChanged.call( VG.context );

    this.cursorPosition.x+=text.length;
    this.textHasChanged=true;

    this.resetBlinkState();
    VG.update();
};

VG.UI.TextLineEdit.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawTextLineEdit( this, canvas );
};

/**
 * Creates a an editable multi-line text widget.
 * @param {string} text - The text to edit.
 * @property {string} text - The text to edit.
 * @property {bool} readOnly - Indicates if this widget is read-only, default is false.
 * @borrows VG.UI.ListWidget.bind as VG.UI.TextLineEdit.bind
 * @constructor
 */

VG.UI.TextEdit=function( text )
{
    if ( !(this instanceof VG.UI.TextEdit) ) return new VG.UI.TextEdit( text );

    VG.UI.BaseText.call( this );
    this.name="TextEdit";

    this.font=VG.UI.stylePool.current.skin.TextEdit.Font;

    this.supportsScrollbars=true;
    this.frameType=VG.UI.Frame.Type.None;

    this.supportsFocus=true;
    this.minimumSize.set( 40, 40 );

    this.hAlignment=VG.UI.HAlignment.Left;
    this.vAlignment=VG.UI.VAlignment.Top;

    this.horizontalExpanding=true;
    this.verticalExpanding=true;

    this.readOnly=false;

    this.previousRect=VG.Core.Rect();

    if ( arguments.length ) this.text=arguments[0];
    else this.text="";

    // --- Setup Default Context Menu

    this.contextMenu=VG.UI.ContextMenu();
    this.contextMenu.aboutToShow=function() {
        this.copyMenuItem.disabled=!this.clipboardCopyIsAvailable( "Text" );
        this.cutMenuItem.disabled=this.copyMenuItem.disabled || this.readOnly;
        this.pasteMenuItem.disabled=!VG.clipboardPasteDataForType( "Text" ) || this.readOnly;
        this.insertMenuItem.disabled=this.readOnly;
    }.bind( this );

    this.cutMenuItem=this.contextMenu.addItem( "Cut", null, function() {
        VG.copyToClipboard( "Text", this.copySelection() );
        if ( this.selectionIsValid ) this.deleteSelection();
    }.bind( this ));

    this.copyMenuItem=this.contextMenu.addItem( "Copy", null, function() {
        VG.copyToClipboard( "Text", this.copySelection() );
    }.bind( this ));

    this.pasteMenuItem=this.contextMenu.addItem( "Paste", null, function() {
        if ( this.selectionIsValid ) this.deleteSelection( true );
        this.insertText( VG.clipboardPasteDataForType( "Text" ) );
        this.textHasChanged=true;
        this.focusOut();
    }.bind( this ));

    this.contextMenu.addSeparator();

    this.insertMenuItem=this.contextMenu.addItem( "Insert Text...", null, function() {

        this.fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Text, function( name, content ) {
            this.insertText( content );
            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.text } );

        }.bind( this ) );
    }.bind( this ));

    // ---
};

VG.UI.TextEdit.prototype=VG.UI.BaseText();

/**
 * Binds the widget to the data model. This widget has to be bound to a String value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.TextEdit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );

    VG.context.workspace.aboutToSaveCallbacks.push( function() {
        if ( this._textHasChanged ) this.focusOut();
    }.bind( this ) );
};

VG.UI.TextEdit.prototype.valueFromModel=function( value )
{
    //console.log( "TextEdit.valueFromModel: " + value );

    if ( value === null ) this.text="";
    else this.text=value;
};

VG.UI.TextEdit.prototype.focusIn=function()
{
    this.resetBlinkState();
};

VG.UI.TextEdit.prototype.focusOut=function()
{
    if ( this.textHasChanged )
    {
        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : this.text, undoText : this.undoText } );

        if ( this.textChanged )
            this.textChanged( this.text, false, this );

        this.textHasChanged=false;
    }
};

VG.UI.TextEdit.prototype.keyDown=function( keyCode, keysDown )
{
    //console.log( "TextLineEdit:" + keyCode );

    if ( VG.UI.BaseText.prototype.keyDown.call( this, keyCode, keysDown ) )
        return;

    var recognized=false;

    if ( keyCode == VG.Events.KeyCodes.Enter )
    {
        if ( this.selectionIsValid ) this.deleteSelection( true );

        oldText=this.textArray[this.cursorPosition.y];

        this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x);
        this.textArray.splice( this.cursorPosition.y+1, 0, oldText.slice( this.cursorPosition.x ) );

        this.cursorPosition.y+=1;
        this.cursorPosition.x=0;

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line down if necessary
            var y=this.contentRect.y - this.textOffset.y + this.cursorPosition.y * this.itemHeight;

            if ( y + this.maxTextLineSize.height > this.contentRect.bottom() ) {

                this.verifyText();
                this.verifyScrollbar();
                this.setVScrollbarDimensions( VG.context.workspace.canvas );

                this.textOffset.y+=this.itemHeight;
                this.vScrollbar.scrollTo( this.textOffset.y );
            }
        }

        if ( this.needsHScrollbar )
            this.ensureCursorIsVisible();

        recognized=true;
        this.textHasChanged=true;
    } else
    if ( keyCode == VG.Events.KeyCodes.Tab )
    {
        if ( this.selectionIsValid ) this.deleteSelection();

        var text="\t";

        oldText=this.textArray[this.cursorPosition.y];
        this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x) + text + oldText.slice( this.cursorPosition.x );
        this.cursorPosition.x+=text.length;

        recognized=true;
        this.textHasChanged=true;
    }

    if ( recognized )
    {
        this.verifyText();
        this.resetBlinkState();
        VG.update();
    }
};

VG.UI.TextEdit.prototype.textInput=function( text )
{
    if ( this.readOnly ) return;
    if ( this.selectionIsValid ) this.deleteSelection( true );

    var oldText=this.textArray[this.cursorPosition.y];
    this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x) + text + oldText.slice( this.cursorPosition.x );

    //var size=VG.Core.Size();
    //VG.context.workspace.canvas.getTextSize( text, size );

    this.cursorPosition.x+=text.length;
    this.textHasChanged=true;

    this.verifyTextForLineChange( this.cursorPosition.y );
    this.verifyScrollbar();

    if ( this.needsHScrollbar )
        this.ensureCursorIsVisible();

    this.resetBlinkState();
    VG.update();
};

VG.UI.TextEdit.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawTextEdit( this, canvas );
};

VG.UI.TextEdit.prototype.setVScrollbarDimensions=function( canvas )
{
    this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right() + 2, this.contentRect.y, VG.UI.stylePool.current.skin.ScrollBar.Size, this.contentRect.height );

    // this.totalItemHeight == Total height of all Items in the list widget including spacing
    // visibleHeight == Total height of all currently visible items
    // this.contentRect.height == Height of the available area for the list items

    this.vScrollbar.setScrollBarContentSize( this.totalItemHeight, this.contentRect.height );
};

VG.UI.TextEdit.prototype.setHScrollbarDimensions=function( canvas )
{
    this.hScrollbar.rect=VG.Core.Rect( this.contentRect.x, this.contentRect.bottom() + 2, this.contentRect.width, VG.UI.stylePool.current.skin.ScrollBar.Size );

    // this.totalItemHeight == Total height of all Items in the list widget including spacing
    // visibleHeight == Total height of all currently visible items
    // this.contentRect.height == Height of the available area for the list items

    this.hScrollbar.setScrollBarContentSize( this.maxTextLineSize.width, this.contentRect.width );
};

/*
VG.UI.CodeEdit=function( text )
{
    if ( !(this instanceof VG.UI.CodeEdit) ) return new VG.UI.CodeEdit( text );

    this.font=VG.UI.stylePool.current.skin.CodeEdit.Font;

    VG.UI.BaseText.call( this, text );
    this.name="CodeEdit";

    this.supportsScrollbars=true  ;
    this.frameType=VG.UI.Frame.Type.None;

    this.supportsFocus=true;
    this.minimumSize.set( 40, 40 );

    this.hAlignment=VG.UI.HAlignment.Left;
    this.vAlignment=VG.UI.VAlignment.Top;

    this.horizontalExpanding=true;
    this.verticalExpanding=true;

    if ( arguments.length ) this.text=arguments[0];
    else this.text="";

    this.readOnly=false;
    this.blinkColor=VG.Core.Color( 255, 255, 255 );

    this.previousRect=VG.Core.Rect();
    this.workRect=VG.Core.Rect();


    // --- Setup Default Context Menu

    this.contextMenu=VG.UI.ContextMenu();
    this.contextMenu.aboutToShow=function() {
        this.copyMenuItem.disabled=!this.clipboardCopyIsAvailable( "Text" );
        this.cutMenuItem.disabled=this.copyMenuItem.disabled || this.readOnly;
        this.pasteMenuItem.disabled=!VG.clipboardPasteDataForType( "Text" ) || this.readOnly;
        this.insertMenuItem.disabled=this.readOnly;
        this.insertEncodedMenuItem.disabled=this.readOnly;
    }.bind( this );

    this.cutMenuItem=this.contextMenu.addItem( "Cut", null, function() {
        VG.copyToClipboard( "Text", this.copySelection() );
        if ( this.selectionIsValid ) this.deleteSelection();
    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.Cut ) );

    this.copyMenuItem=this.contextMenu.addItem( "Copy", null, function() {
        VG.copyToClipboard( "Text", this.copySelection() );
    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.Copy ) );

    this.pasteMenuItem=this.contextMenu.addItem( "Paste", null, function() {
        if ( this.selectionIsValid ) this.deleteSelection( true );
        this.insertText( VG.clipboardPasteDataForType( "Text" ) );
        this.textHasChanged=true;
        this.focusOut();

    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.Paste ) );

    this.contextMenu.addSeparator();

    this.insertMenuItem=this.contextMenu.addItem( "Insert Text...", null, function() {

        this.fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Text, function( name, content ) {
            this.insertText( content );
            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.text } );

        }.bind( this ) );
    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.InsertText ) );

    this.insertJSONMenuItem=this.contextMenu.addItem( "Insert Text (JSON)...", null, function() {

        this.fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Text, function( name, content ) {

            var text=content;
            text=JSON.stringify( text );

            this.insertText( text );
            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.text } );

        }.bind( this ) );
    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.InsertText ) );

    this.insertEncodedMenuItem=this.contextMenu.addItem( "Insert Encoded Text...", null, function() {

        this.fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Text, function( name, content ) {

            var oname=name;
            if ( name.indexOf( "." ) ) oname=name.slice( 0, name.indexOf( "." ) );

            var out="// --- Decompress with VG.Utils.decompressFromBase64( " + oname + " );\n";
            out+="var " + oname + "=";
            var encoded=VG.Utils.compressToBase64( content );
            var o=0;

            while ( o < encoded.length ) {
                out+="\"";
                for ( var i=0; i < 80; ++i ) {
                    out+=encoded[o++];
                    if ( o >= encoded.length ) {
                        out+="\";"; break;
                    }
                }

                if ( o < encoded.length )
                    out+="\" +";

                out+="\n";
            }

            this.insertText( out );

            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.text } );

        }.bind( this ));
    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.InsertEncodedText ) );

    this.insertEncodedMenuItem=this.contextMenu.addItem( "Insert Encoded Text(JSON)...", null, function() {

        this.fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Text, function( name, content ) {

            var oname=name;
            if ( name.indexOf( "." ) ) oname=name.slice( 0, name.indexOf( "." ) );

            var encoded=VG.Utils.compressToBase64( content );
            encoded=JSON.stringify( encoded );

            this.insertText( encoded );

            if ( this.collection && this.path )
                this.collection.storeDataForPath( { path : this.path, value : this.text } );

        }.bind( this ));
    }.bind( this ), VG.context.workspace.shortcutManager.createDefault( VG.Shortcut.Defaults.InsertEncodedText ) );

    // ---

    this.settings={ "Spaces" : 4 };
    this.enforceJSSyntax=true;

    this.languages = [
        {
            name : "JavaScript",

            lineComment : "//",

            reserved : [ "abstract"    , "arguments", "boolean", "break", "byte", "case", "catch", "char", "class", "const", "continue",
                "debugger", "default", "delete", "do", "double", "else", "enum", "eval", "export", "extends", "false", "final", "finally", "float", "for",
                "function", "goto", "if", "implements", "import", "in", "instanceof", "int", "interface", "let", "long", "native", "new", "null",
                "package", "private", "protected", "public", "return", "short", "static", "super", "switch", "synchronized", "this", "throw", "throws", "transient",
                "true", "try", "typeof", "var", "void", "volatile", "while", "with", "yield" ],

            globalVars : [],

            builtIn : [ "Array", "Date", "eval", "function", "hasOwnProperty", "Infinity", "isFinite", "isNaN", "isPrototypeOf", "length", "Math",
                "NaN", "name", "Number", "Object", "prototype", "String", "toString", "undefined", "valueOf" ],


            codeSkin : { "Comment" : VG.Core.Color( 108, 123, 129 ), "Text" : VG.Core.Color( 252, 124, 34 ), "Reserved" : VG.Core.Color( 156, 211, 102 ),
            "BuiltIn" : VG.Core.Color( 181, 144, 215 ), "ThisAndParameter" : VG.Core.Color( 108, 150, 190 ), "VG" : VG.Core.Color( 212, 179, 77 ),
            "Digit" : VG.Core.Color( 189, 152, 240 ) }
        },
        {
            name : "RaySL",

            lineComment : "//",

            reserved : [ "const", "float", "vec2", "vec3", "vec4", "int", "bool", "true", "false",

            "if", "else", "break", "while" ],

            builtIn : [ "mix", "sin", "fract", "cos", "floor", "InputFunc", "mix", "dot", "pow", "min", "max", "abs", "sign" ],
            globalVars : [ "inUV", "inPos", "inTerminal", "inDefaultTerminal", "inInput1", "inInput2", "inInput3", "inTime", "inNormal", "inMaterial", "outColor", "outMaterial", "outMetallic", "outSmoothness", "outReflectance", "outBump", "outName", "outCategory",
            "ParameterGroup", "ParamHtml", "ParamSlider", "ParamVector3", "ParamVector2", "ParamList", "ParamColor", "ParamDescription", "ParamReferences", "ParamBoolean", "ParamImportant", "ParamToolTip" ],


            codeSkin : { "Comment" : VG.Core.Color( 108, 123, 129 ), "Text" : VG.Core.Color( 146, 204, 153 ), "Reserved" : VG.Core.Color( 242, 119, 122 ),
            "BuiltIn" : VG.Core.Color( 102, 148, 198 ), "ThisAndParameter" : VG.Core.Color( 108, 150, 190 ), "VG" : VG.Core.Color( 255, 204, 102 ),
            "Digit" : VG.Core.Color( 245, 124, 61 ) }
        }
    ];

    this.setLanguageIndex( 0 );

    // ---
};

VG.UI.CodeEdit.prototype=VG.UI.BaseText();

VG.UI.CodeEdit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );

    VG.context.workspace.aboutToSaveCallbacks.push( function() {
        if ( this._textHasChanged ) this.focusOut();
    }.bind( this ) );
};

VG.UI.CodeEdit.prototype.valueFromModel=function( value )
{
    //console.log( "CodeEdit.valueFromModel: " + value );

    if ( value === null ) this.text="";
    else this.text=value;
};

VG.UI.CodeEdit.prototype.setLanguageIndex=function( index )
{
    this.langIndex = index;
    this.jsReserved = this.languages[this.langIndex].reserved;
    this.jsBuiltIn = this.languages[this.langIndex].builtIn;
    this.jsGlobalVars = this.languages[this.langIndex].globalVars;
    this.codeSkin = this.languages[this.langIndex].codeSkin;
    this.lineComment = this.languages[this.langIndex].lineComment;
    this.multiLineCommentOpen = this.languages[this.langIndex].multiLineCommentOpen;
    this.multiLineCommentClose = this.languages[this.langIndex].multiLineCommentClose;
};

VG.UI.CodeEdit.prototype.focusIn=function()
{
    this.resetBlinkState();
};

VG.UI.CodeEdit.prototype.focusOut=function()
{
    if ( this.textHasChanged )
    {
        if ( this.textChanged )
            this.textChanged( this.text, false, this );

        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : this.text } );

        this.textHasChanged=false;
    }
};

VG.UI.CodeEdit.prototype.keyDown=function( keyCode, keysDown )
{
    //console.log( "TextLineEdit:" + keyCode );

    if ( VG.UI.BaseText.prototype.keyDown.call( this, keyCode, keysDown ) )
        return;

    var recognized=false;
    var hasChanged=false;

    if ( keyCode == VG.Events.KeyCodes.Enter )
    {
        if ( this.selectionIsValid ) this.deleteSelection( true );

        oldText=this.textArray[this.cursorPosition.y];

        this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x);
        this.textArray.splice( this.cursorPosition.y+1, 0, oldText.slice( this.cursorPosition.x ) );

        var oldCursorPos=this.cursorPosition.x;
        this.cursorPosition.y+=1;
        this.cursorPosition.x=0;

        // --- Mirror the spaces of the beginning of the previous line

        for( i=0; i < oldText.length; ++i ) {
            if ( oldText[i] !== " " ) break;
            else { ++this.cursorPosition.x; this.textArray[this.cursorPosition.y]=" " + this.textArray[this.cursorPosition.y]; }
        }

        // --- If the previous line ended with an "{" add the settings amount of spaces

        var addSpaces=false;
        for( i=oldText.length-1; i >=0; --i ) {
            var chr=oldText[i];
            if ( chr === " " ) continue;
            if ( chr === "{" ) addSpaces=true;
            break;
        }

        if ( addSpaces && this.settings && this.settings.Spaces ) {

            for( i=0; i < this.settings.Spaces; ++i ) {
                ++this.cursorPosition.x;
                this.textArray[this.cursorPosition.y]=" " + this.textArray[this.cursorPosition.y];
            }
        }

        if ( this.needsVScrollbar )
        {
            // --- Scroll one line down if necessary
            var y=this.contentRect.y - this.textOffset.y + this.cursorPosition.y * this.itemHeight;

            if ( y + this.maxTextLineSize.height > this.contentRect.bottom() ) {

                this.verifyText();
                this.verifyScrollbar();
                this.setVScrollbarDimensions( VG.context.workspace.canvas );

                this.textOffset.y+=this.itemHeight;
                this.vScrollbar.scrollTo( this.textOffset.y );
            }
        }

        if ( this.needsHScrollbar )
            this.ensureCursorIsVisible();

        recognized=true;
        this.textHasChanged=true;

        this.verifyText();
    } else
    if ( keyCode == VG.Events.KeyCodes.Tab )
    {
        if ( this.selectionIsValid ) this.deleteSelection();

        var text="";

        for( i=0; i < this.settings.Spaces; ++i ) text+=" ";

        oldText=this.textArray[this.cursorPosition.y];
        this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x) + text + oldText.slice( this.cursorPosition.x );
        this.cursorPosition.x+=text.length;

        recognized=true;
        this.textHasChanged=true;
        hasChanged=true;
    }

    if ( recognized )
    {
        if ( hasChanged ) this.verifyTextForLineChange( this.cursorPosition.y );
        this.resetBlinkState();
        VG.update();
    }
};

VG.UI.CodeEdit.prototype.textInput=function( text )
{
    if ( this.readOnly ) return;
    if ( this.selectionIsValid ) this.deleteSelection( true );

    VG.context.workspace.canvas.pushFont( this.font );

    var oldText=this.textArray[this.cursorPosition.y];
    this.textArray[this.cursorPosition.y]=oldText.slice(0, this.cursorPosition.x) + text + oldText.slice( this.cursorPosition.x );

    var size=VG.Core.Size();
    VG.context.workspace.canvas.getTextSize( text, size );

    this.cursorPosition.x+=text.length;
    this.textHasChanged=true;

    this.verifyTextForLineChange( this.cursorPosition.y );
    this.verifyScrollbar();

    if ( this.needsHScrollbar )
        this.ensureCursorIsVisible();

    VG.context.workspace.canvas.popFont();

    this.resetBlinkState();
    VG.update();
};

VG.UI.CodeEdit.prototype.setErrorLine=function( line )
{
    this.errorLine = line;
};

VG.UI.CodeEdit.prototype.paintWidget=function( canvas )
{
    if ( this.dragging && this.selectionIsValid )
        this.autoScroll();

    this.rect.round();

    if ( !this.rect.equals( this.previousRect ) ) this.verified=false;
    this.contentRect.set( this.rect );
    canvas.pushClipRect( this.contentRect );

    canvas.pushFont( this.font );

    var size=canvas.getTextSize( String( this.textLines ) );
    var headerColumnWidth=size.width+20;

    this.contentRect.height=2;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.contentRect, VG.UI.stylePool.current.skin.CodeEdit.TopBorderColor );

    this.contentRect.y+=2;
    this.contentRect.width=headerColumnWidth;
    this.contentRect.height=this.rect.height-2;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.contentRect, VG.UI.stylePool.current.skin.CodeEdit.HeaderColor );

    this.contentRect.x+=this.contentRect.width;
    this.contentRect.width=this.rect.width - this.contentRect.width;
    var mainClipRect=VG.Core.Rect( this.contentRect );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.contentRect, VG.UI.stylePool.current.skin.CodeEdit.BackgroundColor );

    this.contentRect.add( 4, 2, -8, -4, this.contentRect );

    if ( !this.textLines ) { canvas.popFont(); canvas.popClipRect(); return; }

    if ( !this.verified || canvas.hasBeenResized )
        this.verifyScrollbar();

    if ( this.needsVScrollbar ) this.contentRect.width-=VG.UI.stylePool.current.skin.ScrollBar.Size;
    if ( this.needsHScrollbar ) this.contentRect.height-=VG.UI.stylePool.current.skin.ScrollBar.Size;

    // ---

    var paintRect=VG.Core.Rect();
    paintRect.x=this.rect.x + 10;
    paintRect.y=this.contentRect.y - this.textOffset.y;
    paintRect.width=headerColumnWidth;
    paintRect.height=this.maxTextLineSize.height;

    // --- Paint the Line Numbers First

    for ( var i=0; i < this.textLines; ++i )
    {
        if ( paintRect.y + this.itemHeight >= this.contentRect.y && paintRect.y < this.contentRect.bottom() )
        {
            // --- Text is visible, draw it
            canvas.drawTextRect( String( i+1 ), paintRect, VG.UI.stylePool.current.skin.CodeEdit.HeaderTextColor, 0, 1 );
        }
        paintRect.y+=this.itemHeight;
    }

    paintRect.x=this.contentRect.x - this.textOffset.x;
    paintRect.y=this.contentRect.y - this.textOffset.y;
    paintRect.width=this.maxTextLineSize.width;
    paintRect.height=this.maxTextLineSize.height;

    canvas.popClipRect();
    canvas.pushClipRect( mainClipRect );

    this.multiLineComment=false;
    this.textOut=0;

    // --- Paint the JS text

    for ( i=0; i < this.textLines; ++i ) {

        var text=this.textArray[i];

        if ( paintRect.y + this.itemHeight >= this.contentRect.y && paintRect.y < this.contentRect.bottom() )
        {
            // --- This line is visible

            if ( this.selectionIsValid )
                this.drawSelectionForLine( canvas, i, paintRect, text, VG.UI.stylePool.current.skin.CodeEdit.SelectionBackgroundColor );

            if ( this.searchTerm && this.searchTerm.length > 0 )
                this.drawSearchTerm( canvas, i, paintRect, text, VG.UI.stylePool.current.skin.CodeEdit.SearchBackgroundColor );

            if ( i === this.errorLine )
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, paintRect, VG.Core.Color( 255, 0, 0, 128 ) );

            this.drawJSLine( canvas, 0, text, paintRect );
            this.textOut=0;
        } else
        if ( this.multiLineCommentOpen )
        {
            // --- Text is not visible, check for multiline state
            if ( this.multiLineComment === false )
            {
                if ( text.indexOf( "/*" ) !== -1 )
                    this.multiLineComment=true;
            }
            if ( this.multiLineComment === true )
            {
            }
        }

        paintRect.y+=this.itemHeight;
        if ( paintRect.y > this.contentRect.bottom() ) break;
    }

    canvas.popFont();

    if ( this.needsVScrollbar ) {
        this.setVScrollbarDimensions();
        this.vScrollbar.paintWidget( canvas, true );
    }

    if ( this.needsHScrollbar ) {
        this.setHScrollbarDimensions();
        this.hScrollbar.paintWidget( canvas, true );
    }

    if ( !this.readOnly ) this.blink( canvas );
    this.previousRect.set( this.rect );

    canvas.popClipRect();
};

VG.UI.CodeEdit.prototype.drawJSLine=function( canvas, textPixelOffset, text, rect )
{
    //console.log( "drawJSLine", textPixelOffset, text, rect.toString() );

    function isLetter(c) {
        return c.match(/[a-zA-Z]/i);
    }

    var singleLineCommentIndex=text.indexOf( this.lineComment );
    var multiLineCommentIndex=-1;

    if ( this.multiLineCommentOpen ) text.indexOf( this.multiLineCommentOpen );

    if ( singleLineCommentIndex === -1 && multiLineCommentIndex === -1 && !this.multiLineComment )
    {
        // --- No comments, check for quotes and keywords

        var keyword=this.getJSKeyword( text );

        var quoteChar="\"";
        var quoteIndex=text.indexOf( quoteChar );
        var quoteIndex2=text.indexOf( "'" );

        if ( quoteIndex !== -1 && quoteIndex2 !== -1 )
        {
            if ( quoteIndex > quoteIndex2 ) {
                quoteChar="'"; quoteIndex=quoteIndex2;
            }
        } else
        if ( quoteIndex2 !== -1 ) {
            quoteChar="'"; quoteIndex=quoteIndex2;
        }

        if ( quoteIndex !== -1 )
        {
            if ( quoteIndex ) textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( 0, quoteIndex ), rect );

            var text2=text.slice( quoteIndex+1 );
            var endQuoteIndex=text2.indexOf( quoteChar );
            var skipped=0;

            // --- Skip end quote chars which have a \ before it
            while ( endQuoteIndex !== -1 && text2[endQuoteIndex-1] === "\\" ) {
                skipped+=endQuoteIndex+1;
                text2=text2.slice( endQuoteIndex+1 );
                endQuoteIndex=text2.indexOf( quoteChar );
            }

            if ( endQuoteIndex !== -1 )
            {
                textPixelOffset+=this.drawJSText( canvas, text.slice( quoteIndex, quoteIndex+endQuoteIndex+skipped+2 ), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.Text );
                textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( quoteIndex+endQuoteIndex+skipped+2 ), rect );
            } else
                textPixelOffset+=this.drawJSText( canvas, text.slice( quoteIndex ), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.Text );
        } else
        if ( keyword )
        {
            // --- Keyword (Reserved + BuiltIn)
            if ( keyword.index ) textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( 0, keyword.index ), rect );
            textPixelOffset+=this.drawJSText( canvas, text.slice( keyword.index, keyword.index + keyword.length ), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), keyword.color );
            textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( keyword.index + keyword.length ), rect );
        } else
        if ( text.indexOf( "VG." ) !== -1 )
        {
            // --- VG.Namespace

            var vgIndex=text.indexOf( "VG." );
            var vgIndexEnd=vgIndex+3;

            while ( vgIndexEnd < text.length && text[vgIndexEnd] !== " " && text[vgIndexEnd] !== "\n" && text[vgIndexEnd] !== "(" && text[vgIndexEnd] !== ";" && text[vgIndexEnd] !== "=" ) vgIndexEnd++;

            if ( vgIndex ) textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( 0, vgIndex ), rect );
            textPixelOffset+=this.drawJSText( canvas, text.slice( vgIndex, vgIndexEnd ), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.VG );
            textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( vgIndexEnd ), rect );
        } else
        {
            // --- Last Check: Digit

            var digitIndex = text.search( /[-+]?([0-9]*\.[0-9]+|[0-9]+)/ );
            if ( digitIndex !== -1 && ( (digitIndex && !isLetter( text[digitIndex-1] ) ) || digitIndex === 0 ) ) {

                if ( digitIndex ) textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( 0, digitIndex ), rect );
                textPixelOffset+=this.drawJSText( canvas, text.slice( digitIndex, digitIndex+1 ), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.Digit );
                textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( digitIndex+1 ), rect );
            } else
                // --- Just plain text, no formatting
                textPixelOffset+=this.drawJSText( canvas, text, rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), VG.UI.stylePool.current.skin.CodeEdit.TextColor );
        }
    } else
    {
        // --- This line has the start of a comment or is inside a multi-line comment

        if ( this.multiLineComment )
        {
            // --- Line is inside a multi line comment
            var multiLineCommentEndIndex="";
            if ( multiLineCommentEndIndex !== -1 )
            {
                // --- Line is inside a multi line comment and has a multi line comment end token

                textPixelOffset+=this.drawJSText( canvas, text.slice( 0, multiLineCommentEndIndex+2 ), rect.add( textPixelOffset, 0, -2*textPixelOffset, 0, this.workRect), this.codeSkin.Comment );

                this.multiLineComment=false;
                textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( multiLineCommentEndIndex+2 ), rect );
            } else
            {
                // --- Line is completely embedded in a multi line comment
                textPixelOffset+=this.drawJSText( canvas, text, rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.Comment );
            }
        } else
        if ( multiLineCommentIndex !== -1 )
        {
            // --- Line has a multi line comment start token
            if ( multiLineCommentIndex ) textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( 0, multiLineCommentIndex ), rect );
            textPixelOffset+=this.drawJSText( canvas, text.slice( multiLineCommentIndex ), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.Comment );
            this.multiLineComment=true;
        } else
        {
            // --- Line has a single line comment start token
            if ( singleLineCommentIndex ) textPixelOffset=this.drawJSLine( canvas, textPixelOffset, text.slice( 0, singleLineCommentIndex ), rect );
            textPixelOffset+=this.drawJSText( canvas, text.slice( singleLineCommentIndex), rect.add( textPixelOffset, 0, -textPixelOffset, 0, this.workRect), this.codeSkin.Comment );
        }
    }

    return textPixelOffset;
};

VG.UI.CodeEdit.prototype.drawJSText=function( canvas, text, rect, color )
{
    return canvas.drawTextRect( text, rect, color, this.hAlignment, 1 );
};

VG.UI.CodeEdit.prototype.getJSKeyword=function( text )
{
    var index=text.indexOf( "this" );
    if ( index !== -1 && this.verifyKeyword( text, "this", index ) ) return { "index" : index, "length" : "this".length, "color" : this.codeSkin.ThisAndParameter };

    for ( let i=0; i < this.jsReserved.length; ++i ) {
        index=text.indexOf( this.jsReserved[i] );
        if ( index !== -1 && this.verifyKeyword( text, this.jsReserved[i], index ) ) return { "index" : index, "length" : this.jsReserved[i].length, "color" : this.codeSkin.Reserved };
    }

    for ( let i=0; i < this.jsBuiltIn.length; ++i ) {
        index=text.indexOf( this.jsBuiltIn[i] );
        if ( index !== -1 && this.verifyKeyword( text, this.jsBuiltIn[i], index ) ) return { "index" : index, "length" : this.jsBuiltIn[i].length, "color" : this.codeSkin.BuiltIn };
    }

    for ( let i=0; i < this.jsGlobalVars.length; ++i ) {
        index=text.indexOf( this.jsGlobalVars[i] );
        if ( index !== -1 ) return { "index" : index, "length" : this.jsGlobalVars[i].length, "color" : this.codeSkin.VG };
    }

    return null;
};

VG.UI.CodeEdit.prototype.verifyKeyword=function( text, keyword, index )
{
    var left=true, right=true;

    // --- Left Check
    if ( index ) {
        if ( text[index-1] !== " " && text[index-1] !== "=" && text[index-1] !== "." && text[index-1] !== ";" && text[index-1] !== "!" ) left=false;
    }

    // --- Right Check
    var rightIndex=index+keyword.length;
    if ( rightIndex < text.length ) {
        if ( text[rightIndex] !== " " && text[rightIndex] !== "(" && text[rightIndex] !== "." && text[rightIndex] !== ";" ) right=false;
    }

    if ( left && right ) return true;
    else return false;
};

VG.UI.CodeEdit.prototype.setVScrollbarDimensions=function( canvas )
{
    this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right() + 4, this.contentRect.y, VG.UI.stylePool.current.skin.ScrollBar.Size, this.contentRect.height );

    // this.totalItemHeight == Total height of all Items in the list widget including spacing
    // visibleHeight == Total height of all currently visible items
    // this.contentRect.height == Height of the available area for the list items

    this.vScrollbar.setScrollBarContentSize( this.totalItemHeight, this.contentRect.height );
};

VG.UI.CodeEdit.prototype.setHScrollbarDimensions=function( canvas )
{
    this.hScrollbar.rect=VG.Core.Rect( this.contentRect.x, this.contentRect.bottom() + 2, this.contentRect.width, VG.UI.stylePool.current.skin.ScrollBar.Size );

    // this.totalItemHeight == Total height of all Items in the list widget including spacing
    // visibleHeight == Total height of all currently visible items
    // this.contentRect.height == Height of the available area for the list items

    this.hScrollbar.setScrollBarContentSize( this.maxTextLineSize.width, this.contentRect.width );
};*/

/**
 * Creates a an JavaScript code editor. Supports JavaScript syntax-highlighting.
 * @param {string} text - The text to edit.
 * @property {string} text - The text to edit.
 * @property {bool} readOnly - Indicates if this widget is read-only, default is false.
 * @borrows VG.UI.ListWidget.bind as VG.UI.TextLineEdit.bind
 * @constructor
 */

VG.UI.CodeEdit=function( text )
{
    if ( !(this instanceof VG.UI.CodeEdit) ) return new VG.UI.CodeEdit( text );

    VG.UI.Widget.call( this, text );
    this.name="CodeEdit";

    this.supportsFocus = true;
    this.domWidget = true;

    this.editor = ace.edit( "aceEditor" );

    let workerPath;
    if ( VG.localVGLibPrefix ) workerPath = VG.localVGLibPrefix + "web";
    else workerPath = "/web";

    ace.config.set( "workerPath", workerPath );

    this.editor.setTheme("ace/theme/monokai");
    this.editor.session.setMode("ace/mode/javascript");
    // this.editor.setOptions( { vScrollBarAlwaysVisible: true } );

    // ---

    this.displayed = false;
    this.oldRect = new VG.Core.Rect();
};

VG.UI.CodeEdit.prototype=VG.UI.Widget();

/**
 * Binds the widget to the data model. This widget has to be bound to a String value.
 * @param {VG.Data.Collection} collection - The data collection to link this widget to.
 * @param {string} path - The path inside the data collection to bind this widget to.
 * @tutorial Data Model
 */

VG.UI.CodeEdit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.CodeEdit.prototype.valueFromModel=function( value )
{
    //console.log( "CodeEdit.valueFromModel: " + value );

    if ( value === null ) this.editor.setValue( "" );
    else this.editor.setValue( value );

    this.editor.clearSelection();
};

Object.defineProperty( VG.UI.CodeEdit.prototype, "text", {
    get: function() {
        //return this._text;
        return this.editor.getValue();
    },
    set: function( newText ) {
        this.editor.setValue( newText );
        this.editor.clearSelection();
    }
});

VG.UI.CodeEdit.prototype.setMode=function( name, session )
{
    if ( name === "JavaScript" ) {
        if ( !session ) this.editor.session.setMode("ace/mode/javascript");
        else session.setMode("ace/mode/javascript");
    }
    else if ( name === "GLSL" ) {
        if ( !session ) this.editor.session.setMode("ace/mode/glsl");
        else session.setMode("ace/mode/glsl");
    }
};

VG.UI.CodeEdit.prototype.newSession=function( code )
{
    let EditSession = ace.EditSession;
    let session = new EditSession( code );
    session.setUndoManager(new ace.UndoManager());

    session.on( 'change', ( delta ) => {
        if ( this.textChanged ) this.textChanged();
    });

    return session;
};

VG.UI.CodeEdit.prototype.getSession=function()
{
    return this.editor.getSession();
};

VG.UI.CodeEdit.prototype.setSession=function( session )
{
    this.editor.setSession( session );
};

VG.UI.CodeEdit.prototype.focusIn=function( line )
{
    VG.editor.style.zIndex = "4";
};

VG.UI.CodeEdit.prototype.focusOut=function( line )
{
    VG.editor.style.zIndex = "1";
};

VG.UI.CodeEdit.prototype.mouseEnter=function( line )
{
    VG.editor.style.zIndex = "4";
};

VG.UI.CodeEdit.prototype.mouseLeave=function( line )
{
    VG.editor.style.zIndex = "1";
};

VG.UI.CodeEdit.prototype.hide=function( line )
{
    VG.editor.style.display = "none";
    this.hidden = true;
    this.displayed = false;
};

VG.UI.CodeEdit.prototype.show=function( line )
{
    VG.editor.style.display = "inline";
    this.hidden = false;
};

VG.UI.CodeEdit.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );
    VG.context.workspace.activeDOMWidgets.push( this );
    if ( !this.displayed || !this.oldRect.equals( this.contentRect ) )
    {
        VG.editor.style.left = String( this.contentRect.x ) + "px";
        VG.editor.style.top = String( this.contentRect.y ) + "px";
        VG.editor.style.width = String( this.contentRect.width ) + "px";
        VG.editor.style.height = String( this.contentRect.height ) + "px";

        VG.editor.style.display = "inline";
        this.editor.resize();

        this.displayed = true;
        this.oldRect.copy( this.contentRect );
    }
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**Creates a new HtmlView widget that can render HTML source text.
 * @param {string} html - The html to display.
 * @constructor
 */

VG.UI.HtmlView=function( html )
{
    if ( !(this instanceof VG.UI.HtmlView) ) return new VG.UI.HtmlView( html );

    VG.UI.Widget.call( this );
    this.name="HtmlView";

    this.textGroupArray=[];

    this.supportsScrollbars=true;

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.maxTextLineSize=VG.Core.Size();
    this.textOffset=VG.Core.Point();

    this.hAlignment=VG.UI.HAlignment.Left;
    this.vAlignment=VG.UI.VAlignment.Top;

    this.previousRect=VG.Core.Rect();

    this.vScrollbar=0;
    this.needsVScrollbar=false;

    this.childWidgets=[];

    this.verified=false;

    this.linkCallback=null;

    this.readOnly=true;

    this.body={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.FontName, 15 ),
        "bgColor" : VG.Core.Color( 0, 0, 0, 0 ),//VG.context.style.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 20, 25, 20, 25 ),
        "spacing" : 10,
        "noframe" : false
    };

    this.h1={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 24 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 0, 10, 20, 10 )
    };

    this.h2={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 22 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 0, 10, 20, 10 )
    };

    this.h3={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 18 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 0, 10, 20, 10 )
    };

    this.h4={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 16 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 0, 10, 20, 10 )
    };

    this.h5={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 12 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 0, 10, 20, 10 )
    };

    this.h6={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 10 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 0, 10, 20, 10 )
    };

    this.ul={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.FontName, 15 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 40, 10, 20, 10 ),
        "bulletStart" : 30,
        "bulletSize" : 0.5,
        "textStart" : 10
    };

    this.ol={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.FontName, 15 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "margin" : VG.Core.Margin( 40, 10, 20, 10 )
    };

    this.b={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.BoldFontName, 15 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
    };

    this.i={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.ItalicFontName, 15 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
    };

    this.a={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.FontName, 15 ),
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "color" : VG.Core.Color( VG.UI.stylePool.current.skin.Widget.TextColor ),
        "underlineHeight" : 1
    };

    this.br={
        "lineHeight" : 10
    };

    this.p={
        "margin" : VG.Core.Margin( 20, 10, 20, 10 )
    };

    this.font={
        "bgColor" : VG.UI.stylePool.current.skin.Widget.BackgroundColor,
        "override" : false
    };

    this.code={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.FontName, 15 ),
        "margin" : VG.Core.Margin( 20, 10, 20, 10 ),
        "verticalExpanding" : true,
        "maxHeight" : 100
    };

    this.appedit={
        "font" : VG.Font.Font( VG.UI.stylePool.current.skin.HtmlView.FontName, 15 ),
        "margin" : VG.Core.Margin(),
        "verticalExpanding" : true,
        "maxHeight" : 100
    };

    this.image={
        "margin" : VG.Core.Margin( 20, 10, 20, 10 )
    };

    this.elements={};

    this.elements.body=this.body;
    this.elements.h1=this.h1;
    this.elements.h2=this.h2;
    this.elements.h3=this.h3;
    this.elements.h4=this.h4;
    this.elements.h5=this.h5;
    this.elements.h6=this.h6;
    this.elements.ul=this.ul;
    this.elements.ol=this.ol;
    this.elements.b=this.b;
    this.elements.i=this.i;
    this.elements.a=this.a;
    this.elements.br=this.br;
    this.elements.font=this.font;
    this.elements.p=this.p;
    this.elements.code=this.code;
    this.elements.appedit=this.appedit;
    this.elements.image=this.image;

    if ( arguments.length ) this._html=arguments[0];
    else
    /** The HTML source text.
     * @member {string} VG.HtmlView.html
     */
        this._html="";
};

VG.UI.HtmlView.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.HtmlView.prototype, "html", {
    get: function() {
        // @TODO: Reconstruct the html from formatted text and modifiers.
        return this._html;
    },
    set: function( newHtml ) {

        if ( !newHtml ) newHtml="";

        this.resetFormattedText();
        this.parseHtmlText( newHtml );
    }
});

VG.UI.HtmlView.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.HtmlView.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.html="";
    else this.html=value;
};

VG.UI.HtmlView.prototype.focusIn=function()
{

};

VG.UI.HtmlView.prototype.focusOut=function()
{

};

VG.UI.HtmlView.prototype.resetFormattedText=function()
{
    this.verified=false;
    this.childWidgets=[];
    this.textGroupArray=[];
    this.numTextLines=0;
    this.numContinueLines=0;
    this.numActualLines=0;

    this.textOffset=VG.Core.Point();
}

VG.UI.HtmlView.prototype.parseHtmlText=function( html )
{
    var openedTags=[];

    this.textGroupArray=[];
    var textGroup;

    var parseTagAndAttribs=function( text )
    {
        //Parse attributes
        var attribs=[];
        tagName=text.split(" ")[0];
        text=text.substring(tagName.length+1, text.length);

        for( var i=0; i < text.length; ++i ) {

            if(text[i] === "=") {

                var attribName=text.substring( 0, i ).trim().toLowerCase();
                text=text.substring( i+1 ).trim();
                text=text.substring( 1 );

                var i1=text.indexOf( "'" );
                var i2=text.indexOf( "\"")
                var valueEnd= i1 < 0 ? i2 : ( i2 < 0 ? i1 : ( i1 < i2 ? i1 : i2 ) );

                var attribValue=text.substring( 0, valueEnd );
                text=text.substring( valueEnd+1 ).trim()

                attribs.push( { attrib : attribName, value : attribValue } );

                i=0;
            }
        }

        return { name : tagName, attribs : attribs }
    }

    while(html)
    {
        if( html.indexOf( "</" ) == 0)
        {
            // Tag end
            var index=html.indexOf( ">" );

            if( index < 0 )
                throw "html parse error, forgot to end a tag with >?";

            var tag=html.substring( 2, index );
            html=html.substring( index + 1 );

            var tagName=tag.substring( 0, tag.length );

            if( tagName === "li" || tagName === "p" || tagName === "code" || tagName === "appedit" && textGroup ) {

                this.textGroupArray.push( textGroup );
                textGroup=null;
            }

            index=-1;
            for( var i=0; i < openedTags.length; ++i ) {

                if( openedTags[i].tag === tagName ) {

                    index = i;
                    break;
                }
            }

            if( index > -1 ) openedTags.splice( index, 1 );
        }
        else if( html.indexOf( "<" ) == 0 )
        {
            // Tag start

            index=html.indexOf(">");
            if( index < 0 )
                throw 'html parse error, forgot to end a tag with >?'

            tagAndAttrib=html.substring( 1, index );
            html=html.substring( index + 1 );

            attribs=[];

            if(tagAndAttrib.search( " " ) > 0) {

                var ret=parseTagAndAttribs(tagAndAttrib);
                tagName=ret.name;
                attribs=ret.attribs;
            }
            else
            {
                tagName=tagAndAttrib.substring( 0, tagAndAttrib.length ).trim().toLowerCase();
            }
            if(tagName === "br")
            {
                if( !textGroup ) textGroup=VG.UI.HtmlView.TextGroup();

                // Handle Line breaks
                var options={ "font" : this.elements.body.font,
                              "color" : this.elements.body.color };

                var formattedText=VG.UI.HtmlView.FormattedText("", options );

                formattedText.addModifier( VG.UI.HtmlView.TextModifiers( "br" ) );

                textGroup.formattedTextArray.push( formattedText );
            }
            else if( tagName === "li" || tagName === "p" || tagName === "code" || tagName === "appedit" || tagName === "img" )
            {
                // End current textGroup if exists.
                if( textGroup ) this.textGroupArray.push( textGroup );

                textGroup=VG.UI.HtmlView.TextGroup( VG.UI.HtmlView.TextGroupNames[ tagName ] );

                if( tagName === "img" )
                {
                    for( var i=0; i < attribs.length; ++i )
                    {
                        if( attribs[i].attrib === "src" )
                        {

                            var formattedText=VG.UI.HtmlView.FormattedText( "" );
                            formattedText.image=attribs[i].value;

                            for( var i=0; i < openedTags.length; ++i ) {

                                if( openedTags[i].tag.indexOf("b") < 0
                                        && openedTags[i].tag.indexOf("i") < 0 )

                                    formattedText.addModifier( VG.UI.HtmlView.TextModifiers( openedTags[i].tag, openedTags[i].attribs ), this.elements[openedTags[i].tag] );
                            }

                            textGroup.formattedTextArray.push( formattedText );

                            this.textGroupArray.push( textGroup );
                            textGroup=null;

                            break;
                        }
                    }

                }
            }
            else
                openedTags.push( { tag : tagName, attribs : attribs } );
        }
        else if( html.indexOf("&vg") == 0 )
        {
            if( !textGroup ) textGroup=VG.UI.HtmlView.TextGroup();

            var options={ "font" : VG.Font.Font("Visual Graphics", this.elements.body.font.size),
                          "color" : this.elements.body.color };

            var formattedText=VG.UI.HtmlView.FormattedText("a", options);

            for( var i=0; i < openedTags.length; ++i ) {

                if( openedTags[i].tag.indexOf("b") < 0
                        && openedTags[i].tag.indexOf("i") < 0 )

                    formattedText.addModifier( VG.UI.HtmlView.TextModifiers( openedTags[i].tag, openedTags[i].attribs ), this.elements[openedTags[i].tag] );
            }

            textGroup.formattedTextArray.push( formattedText );

            html=html.substring(3);
        }
        else
        {
            // Create a text group if it doesnt already exist.
            if( !textGroup ) textGroup=VG.UI.HtmlView.TextGroup();

            index=html.indexOf( "<" );
            indexSpecial=html.indexOf( "&vg" );

            if ( index < 0 ) index=indexSpecial;
            if ( indexSpecial > 0 )
                index=indexSpecial < index ? indexSpecial : index;


            var text=index < 0 ? html : html.substring( 0, index );
            html=index < 0 ? "" : html.substring( index );

            var options={ "font" : this.elements.body.font,
                          "color" : this.elements.body.color };
            var formattedText=VG.UI.HtmlView.FormattedText(text, options);

            // Apply modifiers for all open tags
            for( var i=0; i < openedTags.length; ++i )
                formattedText.addModifier( VG.UI.HtmlView.TextModifiers( openedTags[i].tag, openedTags[i].attribs ), this.elements[ openedTags[i].tag ] );

            textGroup.formattedTextArray.push( formattedText );
        }
    }

    if( openedTags.length > 0 && html.length )
        throw 'Html warning: You forgot to close ' +  openedTags.length + ' tags.' + ' In ' + html;
    // push any unfinished text group
    if( textGroup ) this.textGroupArray.push( textGroup );

};

VG.UI.HtmlView.prototype.verifyText=function()
{

    this.maxTextLineSize.set(0, 0);

    this.maxTextLineSize.height=VG.context.workspace.canvas.getLineHeight();

    var gIndex=0;
    var aIndex=0;
    var tIndex=0;

    for ( var i=0; i < this.numTextLines; ++i )
    {
        // Wrap around the formattedTextArray to determine the correct indices.
        if( tIndex >= this.textGroupArray[gIndex].formattedTextArray[aIndex].textLines.length ) {

            tIndex=0;
            ++aIndex;

            if( aIndex >= this.textGroupArray[gIndex].numFormattedTexts ) {

                aIndex=0;
                ++gIndex;
            }

            if( gIndex >= this.numTextGroups )
                break;
        }

        var currentGroupItem=this.textGroupArray[gIndex];
        var currentArrayItem=currentGroupItem.formattedTextArray[aIndex];

        if( this.textGroupArray[gIndex].groupModifier === "Code" ) {

            var codeTextArray=currentArrayItem.text.split(/\r\n|\r|\n/);
            var rect=VG.Core.Rect();

            VG.context.workspace.canvas.pushFont( currentGroupItem.codeEdit.font );

            // CodeEdits textLineRect only has its height.
            rect.height=this.elements.code.verticalExpanding ?
                            codeTextArray.length * VG.context.workspace.canvas.getLineHeight() + 10 :
                            Math.min( this.elements.code.maxHeight, codeTextArray.length * VG.context.workspace.canvas.getLineHeight());

            VG.context.workspace.canvas.popFont( currentGroupItem.codeEdit.font );

            currentArrayItem.textLineRects.push(rect);

            ++tIndex;
            continue;
        }

        if( this.textGroupArray[gIndex].groupModifier === "AppEdit" ) {

            var codeTextArray=currentArrayItem.text.split(/\r\n|\r|\n/);
            var rect=VG.Core.Rect();

            VG.context.workspace.canvas.pushFont( currentGroupItem.appEdit.font );

            // CodeEdits textLineRect only has its height.
            rect.height=this.elements.code.verticalExpanding ?
                            Math.min((codeTextArray.length +1 )* VG.context.workspace.canvas.getLineHeight() + 10, 250) :
                            Math.min( this.elements.code.maxHeight, codeTextArray.length * VG.context.workspace.canvas.getLineHeight());

            VG.context.workspace.canvas.popFont( currentGroupItem.appEdit.font );

            currentArrayItem.textLineRects.push(rect);

            ++tIndex;
            continue;
        }

        if( this.textGroupArray[gIndex].groupModifier === "Image" ) {

            var rect=VG.Core.Rect();
            rect.height=this.textGroupArray[gIndex].image ? this.textGroupArray[gIndex].image.height : 0;
            rect.width=this.textGroupArray[gIndex].image ? this.textGroupArray[gIndex].image.width : 0;

            currentArrayItem.textLineRects.push(rect);

            ++tIndex;
            continue;
        }

        VG.context.workspace.canvas.pushFont( currentArrayItem.font )

        var size=VG.Core.Size();
        var rect=VG.Core.Rect();

        if(currentArrayItem.getModifier("LineBreak") )
            size.height=this.elements.br.lineHeight;
        else
            VG.context.workspace.canvas.getTextSize( currentArrayItem.textLines[tIndex], size );

        VG.context.workspace.canvas.popFont( currentArrayItem.font )

        if( size.width > this.maxTextLineSize.width ) this.maxTextLineSize.width=size.width;
        if ( size.height > this.maxTextLineSize.height ) this.maxTextLineSize.height=size.height;

        rect.width=size.width;
        rect.height=size.height;

        if( tIndex === 0 && currentArrayItem.continueLine ) {

            var j=aIndex-1;
            var k=gIndex;
            var items=0;
            var maxHeight=size.height;

            // Look back to see how many textlines are part of the same line.
            // Find the maximum height among them.
            while( 1 ) {

                if( j < 0 ) {

                    --k;
                    if( k < 0 ) break;

                    j=this.textGroupArray[k].numFormattedTexts-1;
                }

                var preSize=this.textGroupArray[k].formattedTextArray[j]
                                .textLineRects[this.textGroupArray[k].formattedTextArray[j].textLineRects.length - 1];

                maxHeight = maxHeight < preSize.height ? preSize.height : maxHeight;

                ++items;

                // If this formatted text was continued from the previous line and has only one textLine go back further.
                if( this.textGroupArray[k].formattedTextArray[j].textLines.length === 1
                    && this.textGroupArray[k].formattedTextArray[j].continueLine ) --j;
                else break;
            }

            rect.height = maxHeight;

            // Set all their heights to maxHeight.
            for( ; items >= 1; --items ) {

                if ( j >= this.textGroupArray[k].numFormattedTexts ) {

                    j = 0;
                    ++k;

                    if( k >= this.numTextGroups ) break;
                }
                this.textGroupArray[k].formattedTextArray[j].textLineRects[this.textGroupArray[k].formattedTextArray[j].textLineRects.length - 1].height = maxHeight;
                ++j;
            }
        }

        currentArrayItem.textLineRects.push(rect);

        ++tIndex;

    }

    this.verified=false;

};

VG.UI.HtmlView.prototype.processHtml=function()
{
    if ( this.verified ) return;

    this.numTextGroups=this.textGroupArray.length;

    var numTextLines=0;
    var nextStart=0;
    var numContinueLines=0;

    var listIndex=1;
    var rectWidth=0;

    var forceNextLine=false;

    for( var j=0; j < this.numTextGroups; ++j ) {

        this.textGroupArray[j].numFormattedTexts = this.textGroupArray[j].formattedTextArray.length;
        this.textGroupArray[j].numContinueLines=0;

        var textGroup=this.textGroupArray[j];
        textGroup.numTextLines=0;

        if( textGroup.groupModifier === "Code" || textGroup.groupModifier === "AppEdit" || textGroup.groupModifier === "Image" )
        {
            // Html formatting is not allowed inside code.
            if(textGroup.numFormattedTexts > 1) throw 'Html Error, Html Formatting is not allowed inside code tags or image tags.';

            if( textGroup.groupModifier === "Code" )
            {
                if ( textGroup.codeEdit )
                    continue;

                textGroup.codeEdit = VG.UI.CodeEdit( textGroup.formattedTextArray[0].text );
                textGroup.codeEdit.font=this.code.font;

                this.childWidgets.push(textGroup.codeEdit);
            }
            else if( textGroup.groupModifier === "AppEdit" )
            {
                if ( textGroup.appEdit )
                    continue;

                textGroup.appEdit = VG.UI.AppEditWidget( textGroup.formattedTextArray[0].text );
                textGroup.appEdit.font=this.appedit.font;

                //this.childWidgets.push(textGroup.appEdit);
                for ( var i=0; i < textGroup.appEdit.childWidgets.length; ++i ) {
                    this.childWidgets.push( textGroup.appEdit.childWidgets[i] );
                }
            }
            else if( textGroup.groupModifier === "Image" )
            {
                if ( textGroup.image )
                    continue;

                textGroup.image = VG.Utils.getImageByName(textGroup.formattedTextArray[0].image);
            }

            textGroup.formattedTextArray[0].textLines.push(textGroup.formattedTextArray[0].text)
            textGroup.numTextLines=textGroup.formattedTextArray[0].textLines.length;
            numTextLines+=textGroup.numTextLines;

            continue;
        }

        for( var i=0; i < textGroup.numFormattedTexts; ++i ) {

            var font=this.elements.body.font;
            var fontModifier=textGroup.formattedTextArray[i].getModifier( "Font" );
            if( fontModifier ) {

                if( fontModifier.size )
                    textGroup.formattedTextArray[i].setSize( fontModifier.size );

                if( fontModifier.color )
                    textGroup.formattedTextArray[i].color = fontModifier.color;

                if( this.elements.font.override && fontModifier.fontName )
                    textGroup.formattedTextArray[i].font = VG.Font.Font( fontModifier.fontName, textGroup.formattedTextArray[i].size );
            }

            var boldModifier=textGroup.formattedTextArray[i].getModifier( "Bold" );
            if( boldModifier )
                textGroup.formattedTextArray[i].font=this.elements.b.font;

            var italicModifier=textGroup.formattedTextArray[i].getModifier( "Italic" );
            if( italicModifier )
                textGroup.formattedTextArray[i].font=this.elements.i.font;

            if( forceNextLine ) nextStart=0;

            rectWidth = this.contentRect.width - ( this.elements.body.margin.left + this.elements.body.margin.right );

            if( textGroup.groupModifier === "Paragraph" )
                rectWidth -= this.elements.p.margin.left + this.elements.p.margin.right;

            // Start of a new text group. Or end of a list.
            if( ( i === 0 ) || (!textGroup.formattedTextArray[i].hasListModifiers() && textGroup.formattedTextArray[i-1].hasListModifiers() ) ) {

                forceNextLine=true;
                nextStart=0;
            }

            // Force next line for headings and line breaks.
            if( textGroup.formattedTextArray[i].hasModifier("LineBreak") || textGroup.formattedTextArray[i].hasHeadings() ) {

                forceNextLine=true;
                nextStart=0;
            }

            // Indent lists
            if( textGroup.formattedTextArray[i].hasListModifiers() ) {

                if( i === 0) {

                    // Apply list ordering for ordered lists.
                    if( textGroup.formattedTextArray[i].hasModifier( "OrderedList" ) && textGroup.groupModifier == "ListItem" ) {

                        textGroup.formattedTextArray[i].text=listIndex.toString() + ". " + textGroup.formattedTextArray[i].text;
                        ++listIndex;
                    }

                    forceNextLine=true;
                    nextStart=0;
                }

                if( textGroup.formattedTextArray[i].hasModifier("UnorderedList") )
                    rectWidth -= this.elements.ul.margin.left + this.elements.ul.textStart + this.elements.ul.margin.right + (this.elements.ul.bulletSize * font.scale);

                else if( textGroup.formattedTextArray[i].hasModifier("OrderedList") )
                    rectWidth -= this.elements.ol.margin.left + this.elements.ol.margin.right;
            }

            if( textGroup.formattedTextArray[i].hasHeadings() ) {

                var headingModifier=textGroup.formattedTextArray[i].getHeading();

                rectWidth -= this.elements[headingModifier.id].margin.left + this.elements[headingModifier.id].margin.right;

                textGroup.formattedTextArray[i].setSize( this.elements[headingModifier.id].font.size );
            }

            font=textGroup.formattedTextArray[i].font;

            textGroup.formattedTextArray[i].resetTextLines();

            VG.context.workspace.canvas.pushFont( textGroup.formattedTextArray[i].font );

            var ret=VG.context.workspace.canvas.wordWrap( textGroup.formattedTextArray[i].text, nextStart, rectWidth, textGroup.formattedTextArray[i].textLines );

            VG.context.workspace.canvas.popFont( textGroup.formattedTextArray[i].font );

            textGroup.formattedTextArray[i].textStartPos=ret.forceStartNewLine || forceNextLine ? 0 : nextStart;
            textGroup.formattedTextArray[i].continueLine=textGroup.formattedTextArray[i].textStartPos === 0 ? false: true;

            // If this is a heading force the next text to the next line.
            if( textGroup.formattedTextArray[i].hasHeadings() ) {

                forceNextLine=true;
                nextStart=0;
            }
            else
                forceNextLine=false;

            nextStart=ret.nextStart;

            if( textGroup.formattedTextArray[i].continueLine )
                ++textGroup.numContinueLines;

            textGroup.numTextLines+=textGroup.formattedTextArray[i].textLines.length;
        }

        numTextLines+=textGroup.numTextLines;
        numContinueLines+=textGroup.numContinueLines;
    }

    this.numTextLines=numTextLines;
    this.numActualLines=numTextLines - numContinueLines;

    this.verifyText();
};

VG.UI.HtmlView.prototype.verifyScrollbar=function()
{

    this.processHtml();

    // --- Check if we have enough vertical space for all text lines

    this.needsVScrollbar=false;

    // Calculate total item height.
    this.totalItemHeight=0;

    var gIndex=0;
    var aIndex=0;
    var tIndex=0;
    for( var i = 0; i < this.numTextLines; ++i ) {

        // Wrap around the formattedTextArray to determine the correct indices.
        if( tIndex >= this.textGroupArray[gIndex].formattedTextArray[aIndex].textLines.length ) {

            tIndex=0;
            ++aIndex;

            if( aIndex >= this.textGroupArray[gIndex].numFormattedTexts ) {

                aIndex=0;
                ++gIndex;
            }

        }

        if( this.textGroupArray[gIndex].groupModifier === "Code" || this.textGroupArray[gIndex].groupModifier === "AppEdit" )
        {
            this.totalItemHeight+=this.textGroupArray[gIndex].formattedTextArray[aIndex].textLineRects[tIndex].height
                                    + this.elements.code.margin.top + this.elements.code.margin.bottom;

            ++tIndex;
            continue;
        }

        if( this.textGroupArray[gIndex].groupModifier === "Image" )
        {
            if( this.textGroupArray[gIndex].image )
            {
                this.totalItemHeight+=this.textGroupArray[gIndex].image.height
                                        + this.elements.image.margin.top + this.elements.image.margin.bottom;
            }

            ++tIndex
            continue;
        }

        if( aIndex === 0 ) {

            if( this.textGroupArray[gIndex].formattedTextArray[aIndex].hasModifier("OrderedList")
                && gIndex-1 >= 0
                && !this.textGroupArray[gIndex-1].formattedTextArray[this.textGroupArray[gIndex-1].numFormattedTexts-1].hasModifier("OrderedList") )

                    this.totalItemHeight+=this.elements.ol.margin.top + this.elements.ol.margin.bottom;

            if( this.textGroupArray[gIndex].formattedTextArray[aIndex].hasModifier("UnorderedList")
                && gIndex-1 >= 0
                && !this.textGroupArray[gIndex-1].formattedTextArray[this.textGroupArray[gIndex-1].numFormattedTexts-1].hasModifier("UnorderedList") )

                    this.totalItemHeight+=this.elements.ul.margin.top + this.elements.ul.margin.bottom;

            if( tIndex === 0 && this.textGroupArray[gIndex].groupModifier === "Paragraph" )
                this.totalItemHeight+=this.elements.p.margin.top + this.elements.p.margin.bottom;
        }

        if( tIndex+1 >= this.textGroupArray[gIndex].formattedTextArray[aIndex].textLines.length
            && aIndex+1 < this.textGroupArray[gIndex].numFormattedTexts
            && this.textGroupArray[gIndex].formattedTextArray[aIndex+1].continueLine) {

            ++tIndex;
            continue;
        }

        if( this.textGroupArray[gIndex].formattedTextArray[aIndex].hasHeadings() ) {

            var heading=this.textGroupArray[gIndex].formattedTextArray[aIndex].getHeading();
            this.totalItemHeight+=this.elements[heading.id].margin.top + this.elements[heading.id].margin.bottom;
        }

        this.totalItemHeight+=this.textGroupArray[gIndex].formattedTextArray[aIndex].textLineRects[tIndex].height;
        ++tIndex;
    }

    this.totalItemHeight+=(this.numActualLines-1) * this.elements.body.spacing;
    this.averageItemHeight=this.totalItemHeight/this.numActualLines;

    this.totalItemHeight+=this.elements.body.margin.top + this.elements.body.margin.bottom;

    if ( this.supportsScrollbars && this.totalItemHeight > this.contentRect.height )
        this.needsVScrollbar=true;

    if ( this.needsVScrollbar && this.supportsScrollbars && !this.vScrollbar ) {
        this.vScrollbar=VG.UI.ScrollBar( "HtmlView Scrollbar" );
        this.vScrollbar.callbackObject=this;
    }

    this.verified=true;
};

VG.UI.HtmlView.prototype.paintWidget=function( canvas )
{
    if ( !this.rect.equals( this.previousRect ) )
        this.verified=false;

    this.rect.round(); // --- Make sure rect is integer only
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect, this.body.bgColor );

    //TODO if( !this.elements.body.noframe ) canvas.style.drawGeneralBorder( canvas, this );
    //else
        this.contentRect.copy( this.rect );

    if ( !this.textGroupArray.length ) return;

    canvas.pushClipRect( this.contentRect );
    this.contentRect=this.contentRect.shrink( 4, 2, this.contentRect );

    if ( !this.verified || canvas.hasBeenResized )
        this.verifyScrollbar();

    if ( this.needsVScrollbar )
        this.contentRect.width-=VG.UI.stylePool.current.skin.ScrollBar.Size;

    var paintRect=VG.Core.Rect( this.contentRect );
    paintRect.x=this.contentRect.x + this.elements.body.margin.left;
    paintRect.y=this.contentRect.y - this.textOffset.y + this.elements.body.margin.top;
    paintRect.height=this.maxTextLineSize.height;

    this.visibleHeight=0;

    var textColor;
    if ( !this.disabled ) textColor=VG.UI.stylePool.current.skin.Widget.TextColor;
    else textColor=VG.UI.stylePool.current.skin.Widget.TextColor;

    var tIndex=0;
    var aIndex=0;
    var gIndex=0;
    var numContinueLines=0;

    for ( var i=0; i < this.numTextLines; ++i ) {

        // Wrap around the formattedTextArray to determine the correct indices.
        if( tIndex >= this.textGroupArray[gIndex].formattedTextArray[aIndex].textLines.length ) {
            tIndex=0;
            ++aIndex;

            if( aIndex >= this.textGroupArray[gIndex].numFormattedTexts ) {

                aIndex=0;
                ++gIndex;
            }
        }

        var currentGroupItem=this.textGroupArray[gIndex];
        var currentArrayItem=currentGroupItem.formattedTextArray[aIndex];

        paintRect.x=this.contentRect.x + this.elements.body.margin.left;

        /*
         * Apply top and left margins
         */

        if( currentGroupItem.groupModifier === "Paragraph" )
            paintRect.x+=this.elements.p.margin.left;

        var heading=currentArrayItem.getHeading();
        if( heading ) {

            paintRect.x+=this.elements[heading.id].margin.left;

            if( i > 0)  paintRect.y+=this.elements[heading.id].margin.top;
        }

        if( currentArrayItem.hasModifier("UnorderedList") ) {

            paintRect.x+=this.elements.ul.margin.left

            if( gIndex-1 >= 0 && aIndex === 0
                && !this.textGroupArray[gIndex-1].formattedTextArray[this.textGroupArray[[gIndex-1]].numFormattedTexts-1].hasModifier("UnorderedList"))
            paintRect.y+=this.elements.ul.margin.top;
        }


        if( currentArrayItem.hasModifier("OrderedList") ) {

            paintRect.x+=this.elements.ol.margin.left

            if( gIndex-1 >= 0 && aIndex === 0
                && !this.textGroupArray[gIndex-1].formattedTextArray[this.textGroupArray[[gIndex-1]].numFormattedTexts-1].hasModifier("OrderedList") )
            paintRect.y+=this.elements.ol.margin.top;
        }

        if( tIndex ===0 && aIndex === 0 && currentGroupItem.groupModifier === "Paragraph" )
                paintRect.y+=this.elements.p.margin.top;


        /*
         * Embedded CodeEdit
         */
        if( currentGroupItem.groupModifier === "Code" && currentGroupItem.codeEdit ) {

            paintRect.x+=this.elements.code.margin.left;
            paintRect.y+=this.elements.code.margin.top;
        }

        if( currentGroupItem.groupModifier === "AppEdit" && currentGroupItem.appEdit ) {

            paintRect.x+=this.elements.appedit.margin.left;
            paintRect.y+=this.elements.appedit.margin.top;
        }

        if( currentGroupItem.groupModifier === "Image" && currentGroupItem.image ) {

            paintRect.x+=this.elements.image.margin.left;
            paintRect.y+=this.elements.image.margin.top;
        }

        paintRect.height=currentArrayItem.textLineRects[tIndex].height;

        if ( paintRect.y + paintRect.height >= this.contentRect.y || paintRect.y < this.contentRect.bottom() ) {

            if(currentGroupItem.groupModifier === "Code" && currentGroupItem.codeEdit ) {

                var codeRect=VG.Core.Rect( paintRect );

                codeRect.width-=codeRect.x - this.contentRect.x + this.elements.code.margin.right;

                currentGroupItem.codeEdit.rect.set(codeRect);
                if ( codeRect.bottom() > this.rect.y + 35 )
                    currentGroupItem.codeEdit.paintWidget(canvas);

                paintRect.y+=paintRect.height + this.elements.code.margin.bottom;

                //canvas.setClipRect( this.contentRect );todo
                ++tIndex;
                continue;
            }

            if(currentGroupItem.groupModifier === "AppEdit" && currentGroupItem.appEdit ) {

                var codeRect=VG.Core.Rect( paintRect );

                codeRect.width-=codeRect.x - this.contentRect.x + this.elements.code.margin.right;

                currentGroupItem.appEdit.rect.set(codeRect);
                if ( codeRect.bottom() > this.rect.y + 35 )
                currentGroupItem.appEdit.paintWidget(canvas);

                paintRect.y+=paintRect.height + this.elements.code.margin.bottom;

                //canvas.setClipRect( this.contentRect );todo
                ++tIndex;
                continue;
            }

            if ( currentGroupItem.groupModifier === "Image" ) {

                if( currentGroupItem.image )
                {
                    var maxImgWidth=this.contentRect.width - this.elements.body.margin.right
                                        - this.elements.body.margin.left - this.elements.image.margin.left
                                        - this.elements.image.margin.right;

                    var imgWidth=Math.min( maxImgWidth, currentGroupItem.image.width );
                    currentArrayItem.textLineRects[0].width=imgWidth;

                    // Centre image
                    var imgX=this.contentRect.width / 2 - ( imgWidth / 2 );

                    canvas.drawImage( VG.Core.Point( imgX, paintRect.y), currentGroupItem.image, VG.Core.Size( imgWidth, currentGroupItem.image.height ));

                    paintRect.y+=paintRect.height + this.elements.image.margin.bottom;

                    ++tIndex;
                    continue;
                }
            }

            // Make sure the next formatted text starts immediately
            // Adjust paintRect.x accordingly.
            if( tIndex == 0 )
                paintRect.x+=currentArrayItem.textStartPos;

            var text=currentArrayItem.textLines[tIndex];

            // If the first line of the next formatted text should continue in the previous line
            // move the paintRect back and draw it.
            if ( tIndex === 0 && currentArrayItem.continueLine ) {
                paintRect.y-=( paintRect.height + this.elements.body.spacing );
                this.visibleHeight-=paintRect.height + this.elements.body.spacing;
            }

            //var fontModifier=currentArrayItem.getModifier("Font");
            var textColor=VG.UI.stylePool.current.skin.Widget.TextColor;
            var bgColor=VG.UI.stylePool.current.skin.Widget.BackgroundColor;
            var font=this.elements.body.font;

            font=currentArrayItem.font;
            textColor=currentArrayItem.color;
            bgColor=currentArrayItem.bgColor ? currentArrayItem.bgColor : bgColor;

            VG.context.workspace.canvas.pushFont( font );

            if( currentGroupItem.groupModifier === "ListItem"
                && currentArrayItem.hasModifier("UnorderedList")
                && aIndex === 0 && tIndex === 0 ) {

                // Draw a circle for the bullet point
                var circleRect = VG.Core.Rect( paintRect.x,
                    paintRect.y + paintRect.height/2 - this.elements.ul.bulletSize/2 * font.scale,
                        this.elements.ul.bulletSize * font.scale , this.elements.ul.bulletSize * font.scale);

                canvas.draw2DShape( VG.Canvas.Shape2D.Circle, circleRect,  textColor);
            }

            // Apply offset after bullet symbol for unordered list.
            if( currentArrayItem.hasModifier("UnorderedList") )
                paintRect.x+=this.elements.ul.textStart + this.elements.ul.bulletSize * font.scale;

            if ( currentArrayItem.hasModifier("Link")
                    && currentArrayItem.mouseOver ) {

                var underlineRect = VG.Core.Rect( paintRect.x,
                    paintRect.y + paintRect.height - canvas.fonts[canvas.fontIndex].triFont.descender,
                        currentArrayItem.textLineRects[tIndex].width,
                            this.elements.a.underlineHeight );

                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, underlineRect,  textColor);
            }

            currentArrayItem.textLineRects[tIndex].x = paintRect.x;
            currentArrayItem.textLineRects[tIndex].y = paintRect.y;
            canvas.drawTextRect( text, paintRect , textColor, this.hAlignment, 1);

            VG.context.workspace.canvas.popFont( font );

            paintRect.y+=paintRect.height + this.elements.body.spacing;
            this.visibleHeight+=paintRect.height + this.elements.body.spacing;

            ++tIndex;

            /*
             * Apply bottom margins
             */
            if( tIndex >= currentArrayItem.textLines.length ) {

                if( heading )
                    paintRect.y+=this.elements[heading.id].margin.bottom;

                if( currentGroupItem.groupModifier === "Paragraph"
                    && aIndex+1 >= currentGroupItem.numFormattedTexts )

                    paintRect.y+=this.elements.p.margin.bottom;

                if( aIndex+1 >= currentGroupItem.numFormattedTexts
                        || currentGroupItem.groupModifier === "None" ) {

                    if( currentArrayItem.hasModifier("UnorderedList") && gIndex+1 < this.numTextGroups
                        && !this.textGroupArray[gIndex+1].formattedTextArray[0].hasModifier("UnorderedList") )

                        paintRect.y+=this.elements.ul.margin.bottom;

                    if( currentArrayItem.hasModifier("OrderedList") && gIndex+1 < this.numTextGroups
                        && !this.textGroupArray[gIndex+1].formattedTextArray[0].hasModifier("OrderedList") )

                        paintRect.y+=this.elements.ol.margin.bottom;
                }
            }

        } else break;
    }

    canvas.popClipRect();

    if( this.needsVScrollbar ) {

        this.setVScrollbarDimensions( canvas );
        this.vScrollbar.paintWidget( canvas );
    }

    this.previousRect.set( this.rect );
};

VG.UI.HtmlView.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    this.textOffset.y=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.HtmlView.prototype.mouseMove=function( event )
{
    if ( this.needsVScrollbar && this.vScrollbar )
    {
        if ( this.vScrollbar.rect.contains( event.pos ) ) {
            this.vScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.vScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.vScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }

    // Test if the mouse-pointer is inside one of the texts with a link modifier.

    var gIndex=0;
    var aIndex=0;
    var tIndex=0;

    for( var i=0; i < this.numTextLines; ++i ) {

        // Wrap around the formattedTextArray to determine the correct indices.
        if( tIndex >= this.textGroupArray[gIndex].formattedTextArray[aIndex].textLines.length ) {
            tIndex=0;
            ++aIndex;

            if( aIndex >= this.textGroupArray[gIndex].numFormattedTexts ) {

                aIndex=0;
                ++gIndex;
            }
        }

        if( this.textGroupArray[gIndex].formattedTextArray[aIndex].hasModifier("Link") ) {

            if ( this.textGroupArray[gIndex].formattedTextArray[aIndex].textLineRects[tIndex].contains( event.pos ) )  {

                VG.setMouseCursor("pointer");
                this.textGroupArray[gIndex].formattedTextArray[aIndex].mouseOver=true;
                VG.update();
                break;
            }
            else {

                if( this.textGroupArray[gIndex].formattedTextArray[aIndex].mouseOver ) {

                    this.textGroupArray[gIndex].formattedTextArray[aIndex].mouseOver=false;
                    VG.update();
                }
            }
        }

        ++tIndex;
    }

    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.autoScrolling )
        this.vScrollbar.mouseMove( event );
};

VG.UI.HtmlView.prototype.mouseDown=function( event )
{
    // --- Test if the mouse-click is inside one of the scrollbars

    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    // Test if the mouse-click is inside one of the texts with a link modifier.

    var gIndex=0;
    var aIndex=0;
    var tIndex=0;

    for( var i=0; i < this.numTextLines; ++i ) {

        // Wrap around the formattedTextArray to determine the correct indices.
        if( tIndex >= this.textGroupArray[gIndex].formattedTextArray[aIndex].textLines.length ) {
            tIndex=0;
            ++aIndex;

            if( aIndex >= this.textGroupArray[gIndex].numFormattedTexts ) {

                aIndex=0;
                ++gIndex;
            }
        }

        if( this.textGroupArray[gIndex].formattedTextArray[aIndex].hasModifier("Link") ) {

            if ( this.textGroupArray[gIndex].formattedTextArray[aIndex].textLineRects[tIndex].contains( event.pos ) )  {

                if( this.linkCallback ) {

                    var linkModifier=this.textGroupArray[gIndex].formattedTextArray[aIndex].getModifier("Link");

                    var link=linkModifier.hasAttrib("link") ? linkModifier.link : null;

                    if( link ) {
                        this.linkCallback( link );
                        return;
                    }
                }
            }
        }

        ++tIndex;
    }

    if ( this.needsVScrollbar && this.vScrollbar )
        this.vScrollbar.autoScrollStart( event );
};

VG.UI.HtmlView.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return false;

    if ( step > 0 )
    {
        this.textOffset.y-=this.averageItemHeight;
        this.vScrollbar.scrollTo( this.textOffset.y );
    } else
    {
        this.textOffset.y+=this.averageItemHeight;
        this.vScrollbar.scrollTo( this.textOffset.y );
    }

    VG.update();

    return true;
};

VG.UI.HtmlView.prototype.mouseLeave=function( step )
{
    VG.setMouseCursor("default");
};

VG.UI.HtmlView.prototype.setVScrollbarDimensions=function( canvas )
{
    this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right() + 2, this.contentRect.y, VG.UI.stylePool.current.skin.ScrollBar.Size, this.contentRect.height );

    this.vScrollbar.setScrollBarContentSize( this.totalItemHeight, this.contentRect.height );
};

// ----------------------------------------------------------------- VG.UI.HtmlView.TextGroup
// Groups text based on a common charasteristic

VG.UI.HtmlView.TextGroupNames={

    "None" : "None",
    "li" : "ListItem",
    "p" : "Paragraph",
    "code" : "Code",
    "appedit" : "AppEdit",
    "img" : "Image"
}

VG.UI.HtmlView.TextGroup=function( groupModifier )
{
    if ( !(this instanceof VG.UI.HtmlView.TextGroup) ) return new VG.UI.HtmlView.TextGroup( groupModifier );

    this.formattedTextArray=[];

    this.numFormattedTexts=0;
    this.numTextLines=0;
    this.numContinueLines=0;

    this.groupModifier=VG.UI.HtmlView.TextGroupNames.None;

    if ( arguments.length && arguments[0])
        this.groupModifier=arguments[0];
}

VG.UI.HtmlView.TextGroup.prototype=VG.UI.HtmlView.TextGroup();

// ----------------------------------------------------------------- VG.UI.HtmlView.FormattedText
// Contains format info for a string.

VG.UI.HtmlView.FormattedText=function( text, options )
{
    if ( !(this instanceof VG.UI.HtmlView.FormattedText) ) return new VG.UI.HtmlView.FormattedText( text, options);

    if ( !options ) options="";

    this.font = options.font ? options.font : VG.UI.stylePool.current.skin.Widget.Font;
    this.size = options.font ? options.font.size : this.font.size;
    this.color = options.color ? options.color : VG.UI.stylePool.current.skin.Widget.TextColor;

    this.textModifiers = options.modifiers ? options.modifiers : [];

    this.mouseOver=false;

    this.textLines=[];
    this.textLineRects=[];

    this.textStartPos=0;
    this.continueLine=false;
    this.maxTextLineSize=VG.Core.Size();

    if ( arguments.length ) this.text=arguments[0];
    else this.text="";
};

VG.UI.HtmlView.FormattedText.prototype.setSize=function( size )
{
    this.size = size;
    this.font = VG.Font.Font( this.font.name, this.size );
}

VG.UI.HtmlView.FormattedText.prototype=VG.UI.HtmlView.FormattedText();

VG.UI.HtmlView.FormattedText.prototype.hasModifier=function( name )
{
    for ( var i=0; i < this.textModifiers.length; ++i )
        if ( this.textModifiers[i].name === name ) return true;

    return false;
};

VG.UI.HtmlView.FormattedText.prototype.hasHeadings=function()
{
    for ( var i=0; i < this.textModifiers.length; ++i )
        if ( this.textModifiers[i].name.indexOf("Heading") >= 0 ) return true;

    return false;
}

VG.UI.HtmlView.FormattedText.prototype.hasListModifiers=function()
{
    // Check for unordered, ordered, list item modifiers
    for( var i=0; i < this.textModifiers.length; ++i )
        if( this.textModifiers[i].name.indexOf("List") >= 0 ) return true;
}

VG.UI.HtmlView.FormattedText.prototype.getHeading=function()
{
    for ( var i=0; i < this.textModifiers.length; ++i )
        if ( this.textModifiers[i].name.indexOf("Heading") >= 0 ) return this.textModifiers[i];

    return null;
}

VG.UI.HtmlView.FormattedText.prototype.getModifier=function( name )
{
    for ( var i=0; i < this.textModifiers.length; ++i )
        if ( this.textModifiers[i].name === name ) return this.textModifiers[i];
};

VG.UI.HtmlView.FormattedText.prototype.addModifier=function( modifier, options )
{
    this.textModifiers.push(modifier);

    if( options ) {

        if( this.font.name.indexOf("Visual Graphics") < 0 )
        {
            this.font=options.font ? options.font : this.font;
        }
        else
        {
            var size=options.font ? options.font.size : this.font.size;
            this.font=VG.Font.Font("Visual Graphics", size);
        }

        this.color=options.color ? options.color : this.color;
        this.bgColor=options.bgColor ? options.bgColor : this.bgColor;
    }
};

VG.UI.HtmlView.FormattedText.prototype.resetTextLines=function()
{
    this.textLines=[];
    this.textLineRects=[];
    this.maxTextLineSize=0;
}

// ----------------------------------------------------------------- VG.UI.HtmlView.TextModifiers
// Contains modifier info

VG.UI.HtmlView.ModifierNames={

    "b" : "Bold",
    "i" : "Italic",
    "br" : "LineBreak",
    "font" : "Font",
    "ol" : "OrderedList",
    "ul" : "UnorderedList",
    "h1" : "Heading1",
    "h2" : "Heading2",
    "h3" : "Heading3",
    "h4" : "Heading4",
    "h5" : "Heading5",
    "h6" : "Heading6",
    "a" : "Link"
};

VG.UI.HtmlView.HtmlColors={

    "aqua" : VG.Core.Color( 0, 255, 255 ),
    "black" : VG.Core.Color( 0, 0, 0 ),
    "blue" : VG.Core.Color( 0, 0, 255 ),
    "fuchsia" : VG.Core.Color( 255, 0, 255 ),
    "gray" : VG.Core.Color( 128, 128, 128 ),
    "green" : VG.Core.Color( 0, 128, 0 ),
    "lime" : VG.Core.Color( 0, 255, 0 ),
    "maroon" : VG.Core.Color( 128, 0, 0 ),
    "navy" : VG.Core.Color( 0, 0, 128 ),
    "olive" : VG.Core.Color( 128, 128, 0 ),
    "orange" : VG.Core.Color( 225, 165, 0 ),
    "purple" : VG.Core.Color( 128, 0, 128 ),
    "red" : VG.Core.Color( 255, 0, 0 ),
    "silver" : VG.Core.Color( 192, 192, 192 ),
    "teal" : VG.Core.Color( 0, 128, 128 ),
    "white" : VG.Core.Color( 255, 255, 255 ),
    "yellow" : VG.Core.Color( 255, 255, 0 ),

};

VG.UI.HtmlView.TextModifiers=function( id, attribs )
{
    if ( !(this instanceof VG.UI.HtmlView.TextModifiers) ) return new VG.UI.HtmlView.TextModifiers( id, attribs );

    this.id=id;
    this.name=VG.UI.HtmlView.ModifierNames[id];


    if(!attribs) {
        //@TODO: Improve this!
        if ( this.name === "Font" )
        {
            attribs = [];
        }
    }


    if(attribs) this.setAttribs(attribs);
};

VG.UI.HtmlView.TextModifiers.prototype=VG.UI.HtmlView.TextModifiers();

VG.UI.HtmlView.TextModifiers.prototype.setAttribs=function( attribs )
{
    // Font tag
    switch( this.name ) {

        case "Font":

            if( !attribs ) return;

            for ( var i=0; i < attribs.length; ++i ) {

                if( attribs[i].attrib === "color" ) {

                    if( attribs[i].value.indexOf("#") === 0 )
                        this.color=VG.Core.Color( attribs[i].value );
                    else
                        this.color=VG.UI.HtmlView.HtmlColors[ attribs[i].value ];
                }
                if( attribs[i].attrib === "size" ) this.size=parseInt( attribs[i].value );
                if( attribs[i].attrib === "face" ) this.fontName=attribs[i].value;
            }

            break;

        case "Link":

            if( !attribs ) return;

            for( var i=0; i < attribs.length; ++i ) {

                if( attribs[i].attrib === "href" ) this.link=attribs[i].value;
            }
            break;
    }

};

VG.UI.HtmlView.TextModifiers.prototype.hasAttrib=function( attrib )
{
    if ( this.hasOwnProperty( attrib ) ) return true;

    return false;
}
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**Creates a new HtmlWidget widget that can render HTML source text.
 * @param {string} html - The html to display.
 * @constructor
 */

VG.UI.HtmlWidget=function( html )
{
    if ( !(this instanceof VG.UI.HtmlWidget) ) return new VG.UI.HtmlWidget( html );

    VG.UI.Widget.call( this );
    this.name="HtmlWidget";
    this.supportsFocus=true;

    this._html=html ? html : "<html></html>";

    this.workRect=VG.Core.Rect();
    this.workSize=VG.Core.Size();
    this.margin=VG.Core.Margin( 2, 2, 2, 2 );

    this.lastRect=VG.Core.Rect();

    this.dirty=true;
    this.offset=0;
};

VG.UI.HtmlWidget.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.HtmlWidget.prototype, "html", {
    get: function() {

        return this._html;
    },
    set: function( html ) {
        if ( !html ) html="";

        this._html=html;
        this.dirty=true;
    }
});

VG.UI.HtmlWidget.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.HtmlWidget.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.html="";
    else this.html=value;
};

VG.UI.HtmlWidget.prototype.parseHtml=function()
{
    this.linkElements=[];
    if ( !this.html || !this.html.length ) return;

    this.elements=[];
    var elements=this.elements;
    var currEl;
    var ignoreFirstTopMargin=true;

    parser = VG.sax.parser( false, { lowercase : true } );//, trim : true, normalize : true } );

    var skin=VG.UI.stylePool.current.skin.HtmlWidget;
    var canvas=VG.context.workspace.canvas;
    var size=VG.Core.Size();

    // console.log( "-------------- Parsing " + this._html );

    var rect=VG.Core.Rect( this.contentRect );
    rect.y=this.margin.top;

    var margin=VG.Core.Margin( this.margin.left, this.margin.top, this.margin.right, 0 );
    var contentOffset=VG.Core.Point();

    var self=this;
    function createElement( name, skinObject, parent ) {
        var e={ name : name, skinObject : skinObject };

        e.startXOffset=0;

        var topMargin=skinObject.Margin.top;

        if ( topMargin && ignoreFirstTopMargin ) {
            topMargin=0;

            ignoreFirstTopMargin=false;
        }

        margin.left+=(self.adjustToHeight || self.emptyP) && name === "p" ? 0 : skinObject.Margin.left;
        margin.top+=topMargin;
        margin.right+=skinObject.Margin.right;

        e.rect=VG.Core.Rect( margin.left, rect.y + margin.top, rect.width - margin.left - margin.right, 0 );
        elements.push( e );

        rect.y+=topMargin;

        e.parent=parent;
        e.items=[];

        return e;
    }

    function addItem( el ) {

        var item={};
        item.rect=VG.Core.Rect();

        el.items.push( item );

        return item;
    }


    parser.onopentag = function ( node ) {
        // console.log( 'onopentag', node.name, rect.y, currEl );

        if ( skin[node.name] )
        {
            // --- Element exists in the Skin, create it

            currEl=createElement( node.name, skin[node.name], currEl );

            if ( node.name === "svg" ) {

                let item=addItem( currEl );

                item.svg = VG.Utils.getSVGByName( node.attributes.file );
                if ( item.svg )
                    item.svgGroup = item.svg.getGroupByName( node.attributes.group );

                item.rect.set( margin.left, rect.y + margin.top, rect.width - margin.left - margin.right, 0 );

                item.startXOffset=contentOffset.x;
                item.rect.y+=contentOffset.y;

                if ( currEl.parent.skinObject.Font ) {

                    canvas.pushFont( currEl.parent.skinObject.Font );

                    item.rect.width = Math.floor( canvas.getLineHeight() );
                    item.rect.height = item.rect.width;
                    canvas.popFont();
                } else {
                    item.rect.width = 13;
                    item.rect.height = 13;
                }

                if ( contentOffset.x + item.rect.width > rect.width - margin.left - margin.right )
                {
                    // --- Wordwrap

                    contentOffset.x=item.rect.width;
                    contentOffset.y += item.rect.width;

                    item.rect.y+=item.rect.width;

                    item.startXOffset=0;

                } else contentOffset.x += item.rect.width;

                if ( this.ulMode && this.circleMode ) {
                    item.Circle=true;
                    this.circleMode=false;
                }
            } else
            if ( node.name === "img" ) {

                let item=addItem( currEl );

                item.image = VG.Utils.getImageByName( node.attributes.src );
                item.rect.set( margin.left, rect.y + margin.top, rect.width - margin.left - margin.right, 0 );

                item.startXOffset=contentOffset.x;
                item.rect.y+=contentOffset.y;

                if ( item.image ) {
                    item.rect.width = item.image.width;
                    item.rect.height = item.image.height;
                }
            } else
            if ( node.name === "ul" ) {
                this.ulMode=true;
            }

            if ( node.name === "li" ) {
                if ( this.ulMode )
                    this.circleMode=true;
            }

            if ( skin[node.name].ResetLayout )
                contentOffset.set( 0, 0 );

            if ( skin[node.name].Link ) {
                currEl.href=node.attributes.href;
                self.linkElements.push( currEl );
            }
        }
    };

    parser.ontext = function ( text ) {
        // console.log( 'ontext', text, currEl );

        if ( !text.length || !text.trim().length ) return;

        if ( currEl ) {

            var item=addItem( currEl );
            item.text=text;

            if ( this.ulMode && this.circleMode ) {
                item.Circle=true;
                this.circleMode=false;
            }

            item.rect.set( margin.left, rect.y + margin.top, rect.width - margin.left - margin.right, 0 );
            item.rect.height=0;

            item.startXOffset=contentOffset.x;
            item.rect.y+=contentOffset.y;

            item.textLines=[];

            if ( rect.width > 5 ) {
                canvas.pushFont( currEl.skinObject.Font );
                var rc=canvas.wordWrap( text, contentOffset.x, item.rect.width, item.textLines );

                // --- Force a new line by adding an empty element to the front of the text
                if ( rc.forceStartNewLine ) item.textLines.unshift( "" );

                item.rect.height = canvas.getLineHeight() * item.textLines.length;
                // currEl.rect.height += item.rect.height;

                contentOffset.x=rc.nextStart;

                if ( item.textLines.length > 1 ) {
                    contentOffset.y += item.rect.height - canvas.getLineHeight();
                }

                //console.log( rc, item.textLines, contentOffset.y );

                canvas.popFont();
            }
        }
    };

    parser.onclosetag = function (name) {
        // console.log( 'onclosetag', name, rect.y, currEl.rect.height, currEl.skinObject.Margin.bottom, currEl );

        if ( currEl ) {

            margin.left-=(self.adjustToHeight || self.emptyP) && name === "p" ? 0 : currEl.skinObject.Margin.left;

            // margin.left-=currEl.skinObject.Margin.left;
            margin.top-=currEl.skinObject.Margin.top;
            margin.right-=currEl.skinObject.Margin.right;

            if ( currEl.skinObject.Margin.left ) {
                // rect.y+=currEl.rect.height + currEl.skinObject.Margin.bottom;

                var low=0;
                for ( var i=0; i < currEl.items.length; ++i )
                {
                    var item=currEl.items[i];
                    if( item.rect.bottom() > low ) low = item.rect.bottom();
                }
                if ( low ) {
                    var elHeight = low - rect.y;
                    rect.y += elHeight;
                    currEl.rect.height = elHeight;
                }
                rect.y += currEl.skinObject.Margin.bottom;
            }

            if ( currEl.skinObject.LineFeed ) {
                contentOffset.set( 0, 0 );
            }

            if ( name === "ul" )
                this.ulMode=false;

            currEl=currEl.parent;
        }
    };

    parser.onerror = function (e) {
        // an error happened.
        // console.log( "error", e );
    };

    try {
        parser.write( this._html ).close();
    } catch( e ) {
        // console.log( "error", e );
    }

    // ---- Debug elements

    for ( i=0; i < elements.length; ++i )
    {
        // console.log( elements[i] );
    }

    this.totalHeight = rect.y - this.margin.top;

    if ( this.adjustToHeight ) {
        this.maximumSize.height = this.totalHeight ? this.totalHeight : 20;
        this.minimumSize.height = this.totalHeight ? this.totalHeight : 20;
    }

    this.dirty=false;
    this.lastRect.copy( this.rect );

    if ( !this.adjustToHeight ) {
        this.needsVScrollbar=this.totalHeight > this.contentRect.height;

        if ( this.needsVScrollbar && !this.vScrollbar ) {
            this.vScrollbar=VG.UI.ScrollBar( "HtmlWidget Scrollbar" );
            this.vScrollbar.callbackObject=this;
        }

        if ( !this.needsVScrollbar ) this.offset=0;
    }
};

VG.UI.HtmlWidget.prototype.focusIn=function()
{

};

VG.UI.HtmlWidget.prototype.focusOut=function()
{

};

VG.UI.HtmlWidget.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    this.offset = offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.HtmlWidget.prototype.mouseMove=function( event )
{
    this.hrefUnderMouse=undefined;
    var rect=this.workRect;
    var size=this.workSize;
    var canvas=VG.context.workspace.canvas;

    for ( i=0; i < this.linkElements.length; ++i ) {
        var el=this.linkElements[i];

        for ( e=0; e < el.items.length; ++e ) {
            var item=el.items[e];

            if ( item.textLines )
            {
                canvas.pushFont( el.skinObject.Font );

                rect.copy( item.rect );
                rect.x+=this.rect.x + item.startXOffset; rect.y+=this.rect.y;
                rect.height=canvas.getLineHeight();

                for ( j=0; j < item.textLines.length; ++j )
                {
                    rect.width=canvas.getTextSize( item.textLines[j], size ).width;

                    if ( rect.contains( event.pos ) ) {
                        this.hrefUnderMouse=el.href;
                        canvas.popFont();
                        VG.update();
                        return;
                    }

                    rect.y+=canvas.getLineHeight();
                    if ( !j ) rect.x-=item.startXOffset;
                }

                canvas.popFont();
            }
        }
    }
};

VG.UI.HtmlWidget.prototype.mouseDown=function( event )
{
    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    if ( this.hrefUnderMouse && this.linkCallback ) this.linkCallback( this.hrefUnderMouse );

    this.mouseIsDown=true;
};

VG.UI.HtmlWidget.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.HtmlWidget.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return;

    if ( step === 0 ) step=this.lastStep;

    if ( step > 0 ) {
        this.offset=Math.max( this.offset - 20, 0);
    } else {
        this.offset+=20;
    }

    if ( step ) this.lastStep=step;

    this.vScrollbar.scrollTo( this.offset );
};

VG.UI.HtmlWidget.prototype.mouseLeave=function( step )
{
    VG.setMouseCursor("default");
};

VG.UI.HtmlWidget.prototype.setVScrollbarDimensions=function( canvas )
{
    this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right() + 2, this.contentRect.y, VG.UI.stylePool.current.skin.ScrollBar.Size, this.contentRect.height );
    this.vScrollbar.setScrollBarContentSize( this.totalItemHeight, this.contentRect.height );
};

VG.UI.HtmlWidget.prototype.paintWidget=function( canvas )
{
    var skin=VG.UI.stylePool.current.skin;
    var cRect=this.contentRect;

    cRect.copy( this.rect );
    cRect.width-=skin.ScrollBar.Size;

    if ( !this.lastRect.equals( this.rect ) ) this.dirty=true;
    if ( this.dirty ) this.parseHtml();

    canvas.pushClipRect( this.rect );

    var elements=this.elements;
    if ( !elements ) return;
    for( i=0; i < elements.length; ++i )
    {
        var el=elements[i];

        for ( e=0; e < el.items.length; ++e )
        {
            var item=el.items[e];

            // --- Debug
/*
            cRect.copy( item.rect );
            cRect.x+=this.rect.x; cRect.y+=this.rect.y;
            cRect.y-=this.offset;

            canvas.setAlpha( 0.2 );
            canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, cRect, VG.Core.Color.White );
            canvas.setAlpha( 1.0 );
*/
            // ---

            cRect.copy( item.rect );
            cRect.x+=this.rect.x + item.startXOffset; cRect.y+=this.rect.y;
            cRect.y-=this.offset;

            if ( cRect.y > this.rect.bottom() || cRect.bottom() < this.rect.y ) continue;

            if ( item.textLines ) {

                canvas.pushFont( el.skinObject.Font );

                for ( j=0; j < item.textLines.length; ++j )
                {
                    if ( j === 0 && item.Circle )
                    {
                        this.workRect.copy( cRect );

                        let size=el.skinObject.Font.size * 0.6;

                        this.workRect.x -= 2 * size;
                        this.workRect.y = cRect.y + (el.skinObject.Font.size-size);
                        this.workRect.width=size;
                        this.workRect.height=size;

                        canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.workRect, skin.HtmlWidget.p.Color );
                    }

                    canvas.drawTextRect( item.textLines[j], cRect, el.skinObject.Color, 0, 0 );

                    if ( el.href && el.href === this.hrefUnderMouse )
                    {
                        // --- Mouse is over this link, underline

                        var workRect=this.workRect;

                        workRect.x=cRect.x;
                        workRect.y=cRect.y + el.skinObject.Font.size + 2;
                        workRect.width=canvas.getTextSize( item.textLines[j], this.workSize ).width;
                        workRect.height=1;

                        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, workRect, el.skinObject.Color );
                    }

                    cRect.y+=canvas.getLineHeight();
                    if ( !j ) cRect.x-=item.startXOffset;
                }

                canvas.popFont();
            } else
            if ( item.svg ) {
                canvas.drawSVG( item.svg, item.svgGroup, cRect, el.skinObject.Color );
            } else
            if ( item.image ) {
                canvas.drawImage( cRect, item.image );
            }
        }
    }

    canvas.popClipRect();

    // VG.log( this.totalHeight, total );
    // this.totalHeight=total;

    cRect.copy( this.rect );

    if ( this.needsVScrollbar ) {
        this.vScrollbar.rect=VG.Core.Rect( cRect.right() - skin.ScrollBar.Size, cRect.y, skin.ScrollBar.Size, cRect.height );

        // this.totalItemHeight == Total height of all Items in the list widget including spacing
        // visibleHeight == Total height of all currently visible items
        // this.contentRect.height == Height of the available area for the list items

        this.vScrollbar.setScrollBarContentSize( this.totalHeight, this.rect.height );
        this.vScrollbar.paintWidget( canvas );
    }
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.UI.NumberEdit

VG.UI.NumberEdit=function( value, min, max, fixedPrecision )
{
    if ( !(this instanceof VG.UI.NumberEdit) ) return new VG.UI.NumberEdit( value, min, max, fixedPrecision );

    VG.UI.TextLineEdit.call( this );
    this.name="NumberEdit";

    this.min=min;
    this.max=max;

    this.inputFilter=function( input ) {
        var output=input;
        return output;
/*
        var i=0; var afterComma=false, digitsAfterComma=0;
        var index=this.text.indexOf( '.' );
        if ( index !== -1 ) {
            afterComma=true;
            digitsAfterComma=this.text.length - index;
        }

        while( i < input.length && input )
        {
            var c=input[i];

            if (c >= '0' && c <= '9') {
                if ( afterComma && digitsAfterComma > this.fixedPrecision )
                {
                    break;
                } else
                if ( afterComma ) {
                    digitsAfterComma++;
                    output+=c;
                } else output+=c;
            } else
            if ( c === '.' && this.text.indexOf( '.' ) === -1 ) {
                output+=c;
                if ( this.fixedPrecision ) afterComma=true;
            }
            else
            if ( ( c === '+' || c === '-' ) && !this.text.length && !i )
                output+=c;

            ++i;
        }

        if ( this.min && Number( this.text + output ) < this.min ) output="";
        else
        if ( this.max && Number( this.text + output ) > this.max ) output="";

        return output;*/
    };

    this.font = VG.Font.Font( VG.UI.stylePool.current.skin.TextEdit.Font );

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.fixedPrecision = fixedPrecision;
    this.maxString=this.max ? this.max.toFixed( this.fixedPrecision ) : "0";
    this.value = value;

    if ( value ) this.text = this.checkValueRange( value ).toFixed( this.fixedPrecision === undefined ? 3 : this.fixedPrecision );
    else this.text = "0";

    this.horizontalExpanding=true;
    this.verticalExpanding=false;
};

VG.UI.NumberEdit.prototype=VG.UI.TextLineEdit();

Object.defineProperty( VG.UI.NumberEdit.prototype, "value", {
    get: function() {
        return Number( this.text );
    },
    set: function( value ) {

        let fixedPrecision = this.fixedPrecision;
        if ( fixedPrecision === undefined && value % 1 !== 0 ) fixedPrecision = 3;

        if ( !fixedPrecision ) this.text = String( this.checkValueRange( value ) );
        else this.text = this.checkValueRange( value ).toFixed( fixedPrecision );
    }
});

VG.UI.NumberEdit.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.value=0;
    else this.value=value;

    if ( this.changed )
        this.changed.call( VG.context, this.value, false, this );

    this.verifyScrollbar();
};

VG.UI.NumberEdit.prototype.checkValueRange=function( value )
{
    if ( this.min && value < this.min ) value=this.min;
    if ( this.max && value > this.max ) value=this.max;

    return value;
};

VG.UI.NumberEdit.prototype.valueIsValid=function()
{
    var valid=true;

    if ( isNaN( this.value ) ) valid=false;
    if ( this.min && this.value < this.min ) valid=false;
    if ( this.max && this.value > this.max ) valid=false;

    return valid;
};

VG.UI.NumberEdit.prototype.calcSize=function( canvas )
{
    let size = this.preferredSize;

    canvas.pushFont( this.font );

    canvas.getTextSize( "0", size );

    if ( !this.embedded )
        size=size.add( 16, 8 );

    this.maximumSize.height=size.height;
    this.checkSizeDimensionsMinMax( size );

    canvas.popFont();

    return size;
};

// ----------------------------------------------------------------- VG.UI.Vector2Edit

VG.UI.Vector2Edit=function( x, y, min, max, fixedPrecision )
{
    if ( !(this instanceof VG.UI.Vector2Edit) ) return new VG.UI.Vector2Edit( x, y, min, max, fixedPrecision );

    VG.UI.Widget.call( this );
    this.name="Vector2Edit";
    this.min=min;
    this.max=max;

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.value1Edit=VG.UI.NumberEdit( x, min, max, fixedPrecision );
    this.value1Edit.changed=function( value, cont, obj ) {

        if ( this.lockAspect ) {
            let ratio = this.value.x / this.value.y;
            this.value.x = value;
            this.value.y = Math.round( value / ratio );
            this.value2Edit.value = this.value.y;
        } else
        this.value.x=value;
        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : [this.value.x, this.value.y], undoText : this.undoText } );
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value2Edit=VG.UI.NumberEdit( y, min, max, fixedPrecision );
    this.value2Edit.changed=function( value, cont, obj ) {

        if ( this.lockAspect ) {
            let ratio = this.value.y / this.value.x;
            this.value.y = value;
            this.value.x = Math.round( value / ratio );
            this.value1Edit.value = this.value.x;
        } else
        this.value.y=value;
        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : [this.value.x, this.value.y], undoText : this.undoText } );
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value=new VG.Math.Vector2( x, y );

    this.minimumSize.height=10;

    this.layout=VG.UI.Layout( this.value1Edit, this.value2Edit );
    this.layout.margin.set( 0, 0, 0, 0 );
};

VG.UI.Vector2Edit.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.Vector2Edit.prototype, "toolTip", {
    get: function() {
        return this.value1Edit.toolTip;
    },
    set: function( value ) {
        this.value1Edit.toolTip=value;
        this.value2Edit.toolTip=value;
    }
});

Object.defineProperty( VG.UI.Vector2Edit.prototype, "statusTip", {
    get: function() {
        return this.value1Edit.statusTip;
    },
    set: function( value ) {
        this.value1Edit.statusTip=value;
        this.value2Edit.statusTip=value;
    }
});

Object.defineProperty( VG.UI.Vector2Edit.prototype, "disabled", {
    get: function() {
        return this.value1Edit.disabled;
    },
    set: function( value ) {
        this.value1Edit.disabled=value;
        this.value2Edit.disabled=value;
    }
});

VG.UI.Vector2Edit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );

    if ( path.indexOf( "." ) === -1 )
        this.valueFromModel( collection.dataForPath( path ) );
};

VG.UI.Vector2Edit.prototype.calcSize=function( canvas )
{
    this.minimumSize.height = this.value1Edit.minimumSize.height;
    return this.value1Edit.calcSize( canvas );
};

VG.UI.Vector2Edit.prototype.set=function( x, y )
{
    this.value1Edit.value = x;
    this.value2Edit.value = y;

    this.value.x = x;
    this.value.y = y;
};

VG.UI.Vector2Edit.prototype.paintWidget=function( canvas )
{
    this.layout.rect.set( this.rect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.Vector3Edit

VG.UI.Vector3Edit=function( x, y, z, min, max, fixedPrecision )
{
    if ( !(this instanceof VG.UI.Vector3Edit) ) return new VG.UI.Vector3Edit( x, y, z, min, max, fixedPrecision );

    VG.UI.Widget.call( this );
    this.name="Vector3Edit";
    this.min=min;
    this.max=max;

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.value1Edit=VG.UI.NumberEdit( x, min, max, fixedPrecision );
    this.value1Edit.changed=function( value, cont, obj ) {
        this.value.x=value;
        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : [this.value.x, this.value.y, this.value.z], undoText : this.undoText } );
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value2Edit=VG.UI.NumberEdit( y, min, max, fixedPrecision );
    this.value2Edit.changed=function( value, cont, obj ) {
        this.value.y=value;
        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : [this.value.x, this.value.y, this.value.z], undoText : this.undoText } );
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value3Edit=VG.UI.NumberEdit( z, min, max, fixedPrecision );
    this.value3Edit.changed=function( value, cont, obj ) {
        this.value.z=value;
        if ( this.collection && this.path )
            this.collection.storeDataForPath( { path : this.path, value : [this.value.x, this.value.y, this.value.z], undoText : this.undoText } );
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.minimumSize.height=10;

    this.value=new VG.Math.Vector3( x, y, z );

    this.layout=VG.UI.Layout( this.value1Edit, this.value2Edit, this.value3Edit );
    this.layout.margin.set( 0, 0, 0, 0 );
    this.layout.parent = this;

    Object.defineProperty( this.layout, "disabled", {
        get: () => this.parent ? this.parent._disabled : this._disabled
    } );
};

VG.UI.Vector3Edit.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.Vector3Edit.prototype, "disabled", {
    get: function() {
        if ( !this.parent ) return this._disabled;
        else return this._disabled | this.parent.disabled;
    },
    set: function( value ) {
        this._disabled = value;
        this.value1Edit.disabled=value;
        this.value2Edit.disabled=value;
        this.value3Edit.disabled=value;
    }
});

Object.defineProperty( VG.UI.Vector3Edit.prototype, "fixedPrecision", {
    get: function() {
        return this.value1Edit.fixedPrecision;
    },
    set: function( value ) {
        this.value1Edit.fixedPrecision=value;
        this.value2Edit.fixedPrecision=value;
        this.value3Edit.fixedPrecision=value;
    }
});

Object.defineProperty( VG.UI.Vector3Edit.prototype, "toolTip", {
    get: function() {
        return this.value1Edit.toolTip;
    },
    set: function( value ) {
        this.value1Edit.toolTip=value;
        this.value2Edit.toolTip=value;
        this.value3Edit.toolTip=value;
    }
});

Object.defineProperty( VG.UI.Vector3Edit.prototype, "statusTip", {
    get: function() {
        return this.value1Edit.statusTip;
    },
    set: function( value ) {
        this.value1Edit.statusTip=value;
        this.value2Edit.statusTip=value;
        this.value3Edit.statusTip=value;
    }
});

VG.UI.Vector3Edit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );

    // if ( path.indexOf( "." ) === -1 )
        // this.valueFromModel( collection.dataForPath( path ) );
};

VG.UI.Vector3Edit.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.value.set( 0, 0, 0 );
    else if ( typeof value === 'string' || value instanceof String )
    {
        var arr=JSON.parse( value );
        this.value.set( arr[0], arr[1], arr[2] );
    }
    else if ( value instanceof Array )
        this.value.set( value[0], value[1], value[2] );

    this.value1Edit.value=this.value.x;
    this.value2Edit.value=this.value.y;
    this.value3Edit.value=this.value.z;

    if ( this.changed )
        this.changed.call( VG.context, this.value, true, this, true );
};

VG.UI.Vector3Edit.prototype.calcSize=function( canvas )
{
    this.minimumSize.height = this.value1Edit.minimumSize.height;
    return this.value1Edit.calcSize( canvas );
};

VG.UI.Vector3Edit.prototype.enableXYZMode=function()
{
    this.value1Edit.customBorderColor=VG.Core.Color( "#bd2121" );
    this.value2Edit.customBorderColor=VG.Core.Color( "#dbd92a" );
    this.value3Edit.customBorderColor=VG.Core.Color( "#4445c6" );
};

VG.UI.Vector3Edit.prototype.set=function( x, y, z )
{
    this.value1Edit.value = x;
    this.value2Edit.value = y;
    this.value3Edit.value = z;

    this.value.x = x;
    this.value.y = y;
    this.value.z = z;
};

VG.UI.Vector3Edit.prototype.paintWidget=function( canvas )
{
    this.layout.rect.set( this.rect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.Vector3Edit

VG.UI.Vector4Edit=function( x, y, z, w, min, max, fixedPrecision )
{
    if ( !(this instanceof VG.UI.Vector4Edit) ) return new VG.UI.Vector4Edit( x, y, z, w, min, max, fixedPrecision );

    VG.UI.Widget.call( this );
    this.name="Vector4Edit";
    this.min=min;
    this.max=max;

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.value1Edit=VG.UI.NumberEdit( x, min, max, fixedPrecision );
    this.value1Edit.changed=function( value, cont, obj ) {
        this.value.x=value;
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value2Edit=VG.UI.NumberEdit( y, min, max, fixedPrecision );
    this.value2Edit.changed=function( value, cont, obj ) {
        this.value.y=value;
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value3Edit=VG.UI.NumberEdit( z, min, max, fixedPrecision );
    this.value3Edit.changed=function( value, cont, obj ) {
        this.value.z=value;
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value4Edit=VG.UI.NumberEdit( w, min, max, fixedPrecision );
    this.value4Edit.changed=function( value, cont, obj ) {
        this.value.w=value;
        if ( this.changed ) this.changed( this.value, cont, this );
    }.bind( this );

    this.value=new VG.Math.Vector4( x, y, z, w );

    this.layout=VG.UI.Layout( this.value1Edit, this.value2Edit, this.value3Edit, this.value4Edit );
    this.layout.margin.set( 0, 0, 0, 0 );
};

VG.UI.Vector4Edit.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.Vector4Edit.prototype, "fixedPrecision", {
    get: function() {
        return this.value1Edit.fixedPrecision;
    },
    set: function( value ) {
        this.value1Edit.fixedPrecision=value;
        this.value2Edit.fixedPrecision=value;
        this.value3Edit.fixedPrecision=value;
        this.value4Edit.fixedPrecision=value;
    }
});

Object.defineProperty( VG.UI.Vector4Edit.prototype, "disabled", {
    get: function() {
        return this.value1Edit.disabled;
    },
    set: function( value ) {
        this.value1Edit.disabled=value;
        this.value2Edit.disabled=value;
        this.value3Edit.disabled=value;
        this.value4Edit.disabled=value;
    }
});

VG.UI.Vector4Edit.prototype.calcSize=function( canvas )
{
    this.minimumSize.height = this.value1Edit.minimumSize.height;
    return this.value1Edit.calcSize( canvas );
};

VG.UI.Vector4Edit.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );

    if ( path.indexOf( "." ) === -1 )
        this.valueFromModel( collection.dataForPath( path ) );
};

VG.UI.Vector4Edit.prototype.valueFromModel=function( value )
{
    if ( value === null ) this.value.set( 0, 0, 0, 0 );
    else if ( typeof value === 'string' || value instanceof String )
    {
        var arr=JSON.parse( value );
        this.value.set( arr[0], arr[1], arr[2], arr[3] );
    }
    else if ( value instanceof Array )
        this.value.set( value[0], value[1], value[2], value[3] );

    this.value1Edit.value=this.value.x;
    this.value2Edit.value=this.value.y;
    this.value3Edit.value=this.value.z;
    this.value4Edit.value=this.value.z;

    if ( this.changed )
        this.changed.call( VG.context, this.value, true, this, true );
};

VG.UI.Vector4Edit.prototype.set=function( x, y, z, w )
{
    this.value1Edit.value = x;
    this.value2Edit.value = y;
    this.value3Edit.value = z;
    this.value4Edit.value = w;

    this.value.x = x;
    this.value.y = y;
    this.value.z = z;
    this.value.w = w;
};

VG.UI.Vector4Edit.prototype.paintWidget=function( canvas )
{
    this.layout.rect.set( this.rect );
    this.layout.layout( canvas );
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

 // ----------------------------------------------------------------- VG.UI.DecoratedToolSeparator

VG.UI.DecoratedToolSeparator=function()
{
    if ( !(this instanceof VG.UI.DecoratedToolSeparator )) return new VG.UI.DecoratedToolSeparator();

    VG.UI.Widget.call( this );
    this.name="DecoratedToolSeparator";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;
};

VG.UI.DecoratedToolSeparator.prototype=VG.UI.Widget();

VG.UI.DecoratedToolSeparator.prototype.calcSize=function()
{
    this.preferredSize.set( VG.UI.stylePool.current.skin.DecoratedToolBar.Separator.Size );
    return this.preferredSize;
};

VG.UI.DecoratedToolSeparator.prototype.paintWidget=function( canvas )
{
    var size=this.calcSize();
    this.contentRect.set( this.rect );

    VG.UI.stylePool.current.drawDecoratedToolSeparator( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolSeparator

VG.UI.ToolSeparator=function()
{
    if ( !(this instanceof VG.UI.ToolSeparator )) return new VG.UI.ToolSeparator();

    VG.UI.Widget.call( this );
    this.name="ToolSeparator";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;
};

VG.UI.ToolSeparator.prototype=VG.UI.Widget();

VG.UI.ToolSeparator.prototype.calcSize=function()
{
    var size=VG.Core.Size( 2, VG.UI.stylePool.current.skin.ToolBar.Separator.Size.height );
    return size;
};

VG.UI.ToolSeparator.prototype.paintWidget=function( canvas )
{
    var size=this.calcSize();
    this.contentRect.set( this.rect );

    VG.UI.stylePool.current.drawToolSeparator( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolBarButton

VG.UI.ToolBarButton=function( text, svgGroupName )
{
    if ( !(this instanceof VG.UI.ToolBarButton) ) return new VG.UI.ToolBarButton( text, svgGroupName );

    if ( svgGroupName ) {
        this.svgName=text ? text : undefined;
        this.svgGroupName=svgGroupName ? svgGroupName : undefined;
    } else
    this.text=text ? text : "";

    VG.UI.Widget.call( this );
    this.name="ToolBarButton";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.role=VG.UI.ActionItemRole.None;
    this.minimumSize.width=VG.UI.stylePool.current.skin.ToolBarButton.MinimumWidth;
    this._icon=0;

    this.checkable=false;
    this.checked=false;
    this.exclusions=[];
};

VG.UI.ToolBarButton.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.ToolBarButton.prototype, "icon", {
    get: function() {
        return this._icon;
    },
    set: function( icon ) {
        this._icon=icon;
    }
});

VG.UI.ToolBarButton.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.ToolBarButton.prototype.valueFromModel=function( value )
{
    //console.log( "TextEdit.valueFromModel: " + value );

    if ( value === null ) this.checked=false;
    else this.checked=value;

    if ( this.changed )
        this.changed.call( VG.context, value, false, this );

    VG.update();
};

VG.UI.ToolBarButton.prototype.addExclusions=function()
{
    this.checkable=true;

    for ( var i=0; i < arguments.length; ++i ) {
        if ( this.exclusions.indexOf( arguments[i] ) === -1 ) this.exclusions.push( arguments[i] );

        if ( arguments[i].exclusions.indexOf( this ) === -1 )
        {
            arguments[i].exclusions.push( this );
            arguments[i].checkable=true;

            for ( var ai=0; ai < arguments.length; ++ai ) {
                if ( i !== ai ) arguments[i].exclusions.push( arguments[ai] );
            }
        }
    }
};

VG.UI.ToolBarButton.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    if ( !this.icon && !this.svgName && !this.svg && this.text )
    {
        canvas.pushFont( canvas.style.skin.ToolBarButton.Font );
        this.minimumSize.width=canvas.style.skin.ToolBarButton.MinimumWidth;

        canvas.getTextSize( this.text, size );
        size.width+=canvas.style.skin.ToolBarButton.TextMargin.width; size.height=canvas.getLineHeight() + canvas.style.skin.ToolBarButton.TextMargin.height;

        if ( size.width < this.minimumSize.width )
            size.width=this.minimumSize.width;

        if ( this.__vgInsideToolBar ) size.height+=2;

        canvas.popFont();
    } else  {
        if ( this.__vgInsideToolBar ) {
            size.copy( canvas.style.skin.ToolBar.IconSize );
        }
        else
        if ( this.iconSize ) size.copy( this.iconSize );
        else size.set( canvas.style.skin.ToolBarButton.IconSize.width, canvas.style.skin.ToolBarButton.IconSize.height );
    }

    if ( this.parent && this.parent.decorated )
        size.set( 33, 33 );

    return size;
};

VG.UI.ToolBarButton.prototype.mouseDown=function( event )
{
    if ( !this.disabled && this.rect.contains( event.pos) )
        this.mouseIsDown=true;
};

VG.UI.ToolBarButton.prototype.mouseUp=function( event )
{
    if ( !this.disabled && this.rect.contains( event.pos) )
    {
        if ( this.checkable && this.mouseIsDown )
        {
            if ( this.exclusions.length && this.checked === false )
            {
                this.checked=true;
                var undo;

                if ( this.collection && this.path )
                    undo=this.collection.storeDataForPath( { path: this.path, value: this.checked, undoText: this.undoText } );

                for ( var i=0; i < this.exclusions.length; ++i )
                {
                    var exclusion=this.exclusions[i];
                    exclusion.checked=false;

                    if ( this.collection && this.path && undo ) {
                        undo.addSubItem( exclusion.path, exclusion.checked );

                        if ( exclusion.changed ) exclusion.changed( exclusion.checked, true, exclusion );
                    }
                }

                if ( this.changed ) this.changed( this.checked, true, this );
            } else
            if ( !this.exclusions.length )
            {
                this.checked=!this.checked;

                if ( this.collection && this.path )
                    this.collection.storeDataForPath( { path: this.path, value: this.checked, undoText: this.undoText } );

                if ( this.changed ) this.changed( this.checked, true, this );
            }
        }
        this.mouseIsDown=false;
    }
};

VG.UI.ToolBarButton.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawToolBarButton( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolButton

VG.UI.ToolButton=function( iconName, svgGroupName )
{
    if ( !(this instanceof VG.UI.ToolButton) ) return new VG.UI.ToolButton( iconName, svgGroupName );

    if ( svgGroupName ) {
        this.svgName=iconName ? iconName : undefined;
        this.svgGroupName=svgGroupName ? svgGroupName : undefined;
    } else
    this.iconName=iconName ? iconName : undefined;

    VG.UI.Widget.call( this );
    this.name="ToolButton";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.role=VG.UI.ActionItemRole.None;
    this.minimumSize.width=VG.UI.stylePool.current.skin.ToolButton.Size.width;
    this._icon=0;

    this.checkable=false;
    this.checked=false;
    this.exclusions=[];
    this.preferredSize=VG.UI.stylePool.current.skin.ToolButton.Size;
};

VG.UI.ToolButton.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.ToolButton.prototype, "icon", {
    get: function() {
        return this._icon;
    },
    set: function( icon ) {
        this._icon=icon;
    }
});

VG.UI.ToolButton.prototype.bind=function( collection, path )
{
    this.collection=collection;
    this.path=path;
    collection.addValueBindingForPath( this, path );
};

VG.UI.ToolButton.prototype.valueFromModel=function( value )
{
    //console.log( "TextEdit.valueFromModel: " + value );

    if ( value === null ) this.checked=false;
    else this.checked=value;

    if ( this.changed )
        this.changed.call( VG.context, value, false, this );

    VG.update();
};

VG.UI.ToolButton.prototype.addExclusions=function()
{
    this.checkable=true;

    for ( var i=0; i < arguments.length; ++i ) {
        if ( this.exclusions.indexOf( arguments[i] ) === -1 ) this.exclusions.push( arguments[i] );

        if ( arguments[i].exclusions.indexOf( this ) === -1 )
        {
            arguments[i].exclusions.push( this );
            arguments[i].checkable=true;

            for ( var ai=0; ai < arguments.length; ++ai ) {
                if ( i !== ai ) arguments[i].exclusions.push( arguments[ai] );
            }
        }
    }
};

VG.UI.ToolButton.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    return size;
};

VG.UI.ToolButton.prototype.mouseDown=function( event )
{
    if ( !this.disabled && this.rect.contains( event.pos) )
        this.mouseIsDown=true;
};

VG.UI.ToolButton.prototype.mouseUp=function( event )
{
    if ( !this.disabled && this.rect.contains( event.pos) )
    {
        if ( this.checkable && this.mouseIsDown )
        {
            if ( this.exclusions.length && this.checked === false )
            {
                this.checked=true;
                var undo;

                if ( this.collection && this.path )
                    undo=this.collection.storeDataForPath( { path: this.path, value: this.checked, undoText: this.undoText } );

                for ( var i=0; i < this.exclusions.length; ++i )
                {
                    var exclusion=this.exclusions[i];
                    exclusion.checked=false;

                    if ( this.collection && this.path && undo ) {
                        undo.addSubItem( exclusion.path, exclusion.checked );

                        if ( exclusion.changed ) exclusion.changed( exclusion.checked, true, exclusion );
                    }
                }

                if ( this.changed ) this.changed( this.checked, true, this );
            } else
            if ( !this.exclusions.length )
            {
                this.checked=!this.checked;

                if ( this.collection && this.path )
                    this.collection.storeDataForPath( { path: this.path, value: this.checked, undoText: this.undoText } );

                if ( this.changed ) this.changed( this.checked, true, this );
            }
        }
        this.mouseIsDown=false;
    }
};

VG.UI.ToolButton.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawToolButton( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolBarButtonGroup

VG.UI.ToolBarButtonGroup=function( noneExclusiv )
{
    if ( !(this instanceof VG.UI.ToolBarButtonGroup) ) return new VG.UI.ToolBarButtonGroup( noneExclusiv );

    VG.UI.Widget.call( this );
    this.name="ToolBarButtonGroup";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.layout=VG.UI.Layout();
    this.layout.margin.clear();
    this.layout.spacing=1;

    this._index=-1;

    this.childWidgets=[];
    this.noneExclusiv=noneExclusiv;
};

VG.UI.ToolBarButtonGroup.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.ToolBarButtonGroup.prototype, "index", {
    get: function() {
        return this._index;
    },
    set: function( index ) {
        this._index=index;

        for ( var i=0; i < this.layout.children.length; ++i )
            this.layout.children[i].checked=false;

        this.layout.children[index].checked=true;

        if ( this.changed ) this.changed( index, true, this );
    }
});

Object.defineProperty( VG.UI.ToolBarButtonGroup.prototype, "__vgInsideToolBar", {
    set: function( index ) {
        for ( var i=0; i < this.layout.children.length; ++i ) {
            var child=this.layout.children[i];
            child.__vgInsideToolBar=true;
        }
    }
});

VG.UI.ToolBarButtonGroup.prototype.calcSize=function( canvas )
{
    return this.layout.calcSize( canvas );
};

VG.UI.ToolBarButtonGroup.prototype.addImageButton=function( iconName, toolTip )
{
    let button = VG.UI.ToolBarButton();
    button.icon=VG.Utils.getImageByName( iconName );

    if ( this.useStatusTips ) button.statusTip = toolTip;
    else button.toolTip = toolTip;

    this.addButton( button );
    return button;
};

VG.UI.ToolBarButtonGroup.prototype.addSVGButton=function( svgName, groupName, toolTip )
{
    let button = VG.UI.ToolBarButton();
    button.svgName=svgName;
    button.svgGroupName=groupName;

    if ( this.useStatusTips ) button.statusTip = toolTip;
    else button.toolTip = toolTip;

    this.addButton( button );
    return button;
};

VG.UI.ToolBarButtonGroup.prototype.addTextButton=function( text, toolTip )
{
    let button = VG.UI.ToolBarButton( text );

    if ( this.useStatusTips ) button.statusTip = toolTip;
    else button.toolTip = toolTip;

    this.addButton( button );
    return button;
};

VG.UI.ToolBarButtonGroup.prototype.addButton=function( button )
{
    //button.iconSize=VG.Core.Size( 28, 24 );
    button.checkable=true;
    button.changed=function( value, cont, object ) {
        if ( !this.noneExclusiv )
            this.index=this.layout.children.indexOf( object );
        else {
            if ( this.changed ) this.changed( this.layout.children.indexOf( object ), false, object );
        }
    }.bind( this );

    this.layout.addChild( button );
    this.childWidgets.push( button );

    var size=this.layout.calcSize( VG.context.workspace.canvas );

    this.minimumSize.copy( size );
    this.maximumSize.copy( size );
    this.preferredSize.copy( size );

    if ( this._index === -1 ) this.index=0;

    if ( this.noneExclusiv ) return;
    for ( var i=0; i < this.layout.children.length; ++i )
    {
        var child=this.layout.children[i];

        if ( child !== button ) {
            child.exclusions.push( button );
            button.exclusions.push( child );
        }
    }
};

VG.UI.ToolBarButtonGroup.prototype.paintWidget=function( canvas )
{
    this.layout.rect.copy( this.rect);
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolButtonGroup

VG.UI.ToolButtonGroup=function( noneExclusiv )
{
    if ( !(this instanceof VG.UI.ToolButtonGroup) ) return new VG.UI.ToolButtonGroup( noneExclusiv );

    VG.UI.Widget.call( this );
    this.name="ToolButtonGroup";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.layout = VG.UI.Layout();
    this.layout.margin.clear();
    this.layout.spacing = 1;

    this._index=-1;

    this.childWidgets=[];
    this.noneExclusiv=noneExclusiv;
};

VG.UI.ToolButtonGroup.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.ToolButtonGroup.prototype, "index", {
    get: function() {
        return this._index;
    },
    set: function( index ) {
        this._index=index;

        for ( var i=0; i < this.layout.children.length; ++i )
            this.layout.children[i].checked=false;

        this.layout.children[index].checked=true;

        if ( this.changed ) this.changed( index, true, this );
    }
});

Object.defineProperty( VG.UI.ToolButtonGroup.prototype, "__vgInsideToolBar", {
    set: function( index ) {
        for ( var i=0; i < this.layout.children.length; ++i ) {
            var child=this.layout.children[i];
            child.__vgInsideToolBar=true;
        }
    }
});

VG.UI.ToolButtonGroup.prototype.calcSize=function( canvas )
{
    return this.layout.calcSize( canvas );
};

VG.UI.ToolButtonGroup.prototype.addImageButton=function( iconName, toolTip )
{
    var button=VG.UI.ToolButton();
    button.icon=VG.Utils.getImageByName( iconName );
    button.toolTip=toolTip;

    this.addButton( button );

    return button;
};

VG.UI.ToolButtonGroup.prototype.addSVGButton=function( svgName, groupName, toolTip )
{
    var button=VG.UI.ToolButton();
    button.svgName=svgName;
    button.svgGroupName=groupName;
    button.toolTip=toolTip;

    this.addButton( button );

    return button;
};

VG.UI.ToolButtonGroup.prototype.addTextButton=function( text, toolTip )
{
    var button=VG.UI.ToolButton( text );
    button.toolTip=toolTip;

    this.addButton( button );

    return button;
};

VG.UI.ToolButtonGroup.prototype.addButton=function( button )
{
    //button.iconSize=VG.Core.Size( 28, 24 );
    button.checkable=true;
    button.changed=function( value, cont, object ) {
        if ( !this.noneExclusiv )
            this.index=this.layout.children.indexOf( object );
        else {
            if ( this.changed ) this.changed( this.layout.children.indexOf( object ), false, object );
        }
    }.bind( this );

    this.layout.addChild( button );
    this.childWidgets.push( button );

    var size=this.layout.calcSize( VG.context.workspace.canvas );

    this.minimumSize.copy( size );
    this.maximumSize.copy( size );
    this.preferredSize.copy( size );

    if ( this._index === -1 ) this.index=0;

    if ( this.noneExclusiv ) return;
    for ( var i=0; i < this.layout.children.length; ++i )
    {
        var child=this.layout.children[i];

        if ( child !== button ) {
            child.exclusions.push( button );
            button.exclusions.push( child );
        }
    }
};

VG.UI.ToolButtonGroup.prototype.paintWidget=function( canvas )
{
    this.layout.rect.copy( this.rect);
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.DecoratedQuickMenu

VG.UI.DecoratedQuickMenuItem=function( text, callback, iconName, svgName, svgGroupName )
{
    if ( !(this instanceof VG.UI.DecoratedQuickMenuItem) ) return new VG.UI.DecoratedQuickMenuItem( text, callback, iconName, svgName, svgGroupName );

    this.text=text;
    this.callback=callback;

    this.rect=VG.Core.Rect();

    // --- Sub Menu

    this.index=undefined;
    this.items=[];
    this.itemsRect=VG.Core.Rect();
};

VG.UI.DecoratedQuickMenuItem.prototype.addItem=function( text, callback, iconName, svgName, svgGroupName )
{
    var item=new VG.UI.DecoratedQuickMenuItem( text, callback, iconName, svgName, svgGroupName );

    item.text=text;
    item.callback=callback;

    item.rect=VG.Core.Rect();

    this.items.push( item );

    return item;
};

// ----------------------------------------------------------------- VG.UI.DecoratedQuickMenu

VG.UI.DecoratedQuickMenu=function()
{
    if ( !(this instanceof VG.UI.DecoratedQuickMenu) ) return new VG.UI.DecoratedQuickMenu();

    VG.UI.Widget.call( this );
    this.name="DecoratedQuickMenu";

    this.horizontalExpanding = false;
    this.verticalExpanding = false;
    this.supportsAutoFocus = this.supportsFocus = true;

    this.minimumSize.set( VG.context.workspace.appLogo.rect.width, VG.context.workspace.appLogo.rect.height );
    this.maximumSize.set( VG.context.workspace.appLogo.rect.width, VG.context.workspace.appLogo.rect.height );

    this.role=VG.UI.ActionItemRole.None;
    this._icon=0;

    this.open=false;
    this.popupRect=VG.Core.Rect();
    this.closeButtonRect=VG.Core.Rect();
    this.closeButtonHover=false;

    this.items=[];
};

VG.UI.DecoratedQuickMenu.prototype=VG.UI.Widget();

VG.UI.DecoratedQuickMenu.prototype.calcSize=function()
{
    return this.minimumSize;
};

VG.UI.DecoratedQuickMenu.prototype.addItem=function( text, callback )
{
    var item=VG.UI.DecoratedQuickMenuItem( text, callback );
    this.items.push( item );

    return item;
};

VG.UI.DecoratedQuickMenu.prototype.mouseDown=function( event )
{
    var oldOpenState=this.open, selItem;

    // --- Test for Main Menu Click
    if ( this.popupRect.contains( event.pos ) )
    {
        if ( this.open && this.index !== undefined )
        {
            selItem=this.items[this.index];
            if ( selItem && !selItem.items.length && !selItem.disabled && selItem.callback ) selItem.callback();
        }
    }

    // --- Test for Sub Menu Click

    if ( this.open && this.index !== undefined ) {
        selItem=this.items[this.index];
        if ( selItem && selItem.items.length && selItem.index !== undefined ) {
            selItem=selItem.items[selItem.index];
            if ( selItem && !selItem.disabled && selItem.callback ) selItem.callback();
        }
    }

    if ( !VG.UI.stylePool.current.skin.DecoratedQuickMenu.UsesCloseButton )
    {
        if ( this.rect.contains( event.pos) )
        {
            this.mouseIsDown=true;
            this.open=!this.open;
        } else this.open=false;
    } else
    {
        this.mouseIsDown=true;
        if ( !this.open ) this.open=true;
        else
        {
            if ( this.closeButtonRect.contains( event.pos ) || this.popupRect.contains( event.pos ) )
                this.open=false;
        }
    }

    if ( this.open ) VG.context.workspace.mouseTrackerWidget=this;
    else VG.context.workspace.mouseTrackerWidget=null;

    if ( this.open && !oldOpenState && this.aboutToShow )
        this.aboutToShow();

    VG.update();
};

VG.UI.DecoratedQuickMenu.prototype.mouseUp=function( event )
{
    this.noStatusTip = false;
    if ( this.rect.contains( event.pos) )
    {
        this.mouseIsDown=false;
    }
};

VG.UI.DecoratedQuickMenu.prototype.mouseMove=function( event )
{
    this.closeButtonHover=false;
    if ( VG.UI.stylePool.current.skin.DecoratedQuickMenu.UsesCloseButton && this.open && this.closeButtonRect && this.closeButtonRect.contains( event.pos ) )
    {
        this.closeButtonHover=true;
    }

    if ( this.open && this.popupRect )
    {
        var item, i;

        if ( this.popupRect.contains( event.pos ) )
        {
            var y=event.pos.y - this.popupRect.y;
            var index;

            for ( i=0; i < this.items.length; ++i ) {
                item=this.items[i];

                if ( item.rect.contains( event.pos ) && item.text && item.text.length )
                    { index=i; break; }
            }

            if ( index !== undefined && index < this.items.length ) {
                this.index=index;
                VG.update();

                if ( VG.context.workspace.statusBar ) {
                    if ( this.items[index].statusTip && !this.items[index].disabled ) {
                        VG.context.workspace.statusBar.message( this.items[index].statusTip, 4000 );
                        this.noStatusTip = true;
                    }
                    else VG.context.workspace.statusBar.message( "" );
                }
            }
        }

        if ( this.index !== undefined )
        {
            item=this.items[this.index];
            item.index=undefined;

            if ( item.items.length && item.itemsRect.contains( event.pos ) )
            {
                for ( i=0; i < item.items.length; ++i ) {
                    var childItem=item.items[i];

                    if ( childItem.rect.contains( event.pos ) && childItem.text && childItem.text.length )
                        { item.index=i; VG.update(); break; }
                }
            }
        }
    }
};

VG.UI.DecoratedQuickMenu.prototype.paintWidget=function( canvas )
{
    this.rect.height = VG.context.workspace.appLogo.rect.height;
    this.contentRect.set( this.rect );

    if ( this.open && canvas.delayedPaintWidgets.indexOf( this ) === -1 ) canvas.delayedPaintWidgets.push( this );
    else VG.UI.stylePool.current.drawDecoratedQuickMenu( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.DecoratedToolBar

VG.UI.DecoratedToolBar=function()
{
    if ( !(this instanceof VG.UI.DecoratedToolBar) ) return VG.UI.DecoratedToolBar.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="DecoratedToolBar";

    // ---

    this.layout = VG.UI.Layout();
    this.layout.decorated=true;
    this.layout.spacing = VG.UI.stylePool.current.skin.DecoratedToolBar.Spacing;
    this.layout.margin.right = 12;
    this.layout.noClipping = true;

    for( var i=0; i < arguments.length; ++i )
        this.addItem( arguments[i] );

    this.maximumSize.height = VG.UI.stylePool.current.skin.DecoratedToolBar.Height;
};

VG.UI.DecoratedToolBar.prototype=VG.UI.Widget();

VG.UI.DecoratedToolBar.prototype.addItem=function( item )
{
    this.layout.addChild( item );
};

VG.UI.DecoratedToolBar.prototype.addItems=function()
{
    for( var i=0; i < arguments.length; ++i )
        this.addItem( arguments[i] );
};

VG.UI.DecoratedToolBar.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawDecoratedToolBar( this, canvas );

    this.layout.rect.set( this.contentRect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolBar

VG.UI.ToolBar=function()
{
    if ( !(this instanceof VG.UI.ToolBar) ) return VG.UI.ToolBar.creator( arguments );

    VG.UI.Widget.call( this );
    this.name="ToolBar";

    // ---

    this.layout=VG.UI.Layout();

    for( var i=0; i < arguments.length; ++i )
        this.addItem( arguments[i] );

    this.maximumSize.height=VG.UI.stylePool.current.skin.ToolBar.Height;
};

VG.UI.ToolBar.prototype=VG.UI.Widget();

VG.UI.ToolBar.prototype.addItem=function( item )
{
    this.layout.addChild( item );
    item.__vgInsideToolBar=true;
};

VG.UI.ToolBar.prototype.addItems=function()
{
    for( var i=0; i < arguments.length; ++i )
        this.addItem( arguments[i] );
};

VG.UI.ToolBar.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawToolBar( this, canvas );

    this.layout.rect.set( this.contentRect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.ToolSettings

VG.UI.ToolSettings=function( label, options )
{
    if ( !(this instanceof VG.UI.ToolSettings) ) return new VG.UI.ToolSettings( label, options );

    VG.UI.Widget.call( this );
    this.name = "ToolSettings";

    this.supportsFocus = true;

    this.options = options || {};
    this.label = label;
    this.label.textMargin = VG.Core.Size( 12, 12 );

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.label.minimumSize.set( VG.UI.stylePool.current.skin.ToolSettings.Size.width, VG.UI.stylePool.current.skin.ToolSettings.Size.height );
    this.label.maximumSize.set( VG.UI.stylePool.current.skin.ToolSettings.Size.width, VG.UI.stylePool.current.skin.ToolSettings.Size.height );

    this.open = false;
    this.popupRect = new VG.Core.Rect();
    this.closeButtonRect = new VG.Core.Rect();

    this.widget = new VG.UI.Widget();
    this.widget.supportsFocus = true;
    this.widget.layout = this.options.layout;
    this.widget.parent = this;

    this.svgGroup = VG.Utils.getSVGByName( "glyphs.svg" );
    this.childWidgets = [];
};

VG.UI.ToolSettings.prototype=VG.UI.Widget();

VG.UI.ToolSettings.prototype.calcSize=function()
{
    if ( this.label ) return this.label.preferredSize;
    else return this.minimumSize;
};

VG.UI.ToolSettings.prototype.addItem=function( text, callback )
{
    let item=VG.UI.DecoratedQuickMenuItem( text, callback );
    this.items.push( item );

    return item;
};

VG.UI.ToolSettings.prototype.close=function( )
{
    this.open = false;
    this.childWidgets = [];
    this.removeFromOverlays();
    VG.context.workspace.removeEventHandler( this );

    VG.update();
};

VG.UI.ToolSettings.prototype.mouseMove=function( event )
{
    let oldCloseButtonHover = this.closeButtonHover;
    this.closeButtonHover = this.closeButtonRect.contains( event.pos );
    if ( this.closeButtonHover !== oldCloseButtonHover )
        VG.update();
};

VG.UI.ToolSettings.prototype.mouseDown=function( event )
{
    let oldOpenState = this.open;

    // --- Click on button
    if ( !this.open && this.rect.contains( event.pos) ) {
        this.mouseIsDown = true;
        this.open = !this.open;
    }

    // --- Close it when click outside widget rect
    if ( this.open && oldOpenState && ( !this.widget.rect.contains( event.pos ) || this.closeButtonRect.contains( event.pos ) ) )
       this.close();

    // --- Open it when pressed on button
    if ( this.open && !oldOpenState )
    {
        if ( this.aboutToShow )
            this.aboutToShow();

        if ( this.widget.layout ) {
            if ( !VG.context.workspace.overlayWidgets.includes( this.widget ) )
                VG.context.workspace.overlayWidgets.push( this.widget );
            this.setFocus( this.widget );
        }

        VG.context.workspace.addEventHandler( this );
    }

    VG.update();
};

VG.UI.ToolSettings.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.ToolSettings.prototype.keyDown = function( keyCode )
{
    if ( this.open && keyCode === VG.Events.KeyCodes.Esc )
        this.close();
};

VG.UI.ToolSettings.prototype.removeFromOverlays=function( event )
{
    let index = VG.context.workspace.overlayWidgets.indexOf( this.widget );
    while( index >= 0 ) {
        VG.context.workspace.overlayWidgets.splice( index, 1 );
        index = VG.context.workspace.overlayWidgets.indexOf( this.widget );
    }
};

VG.UI.ToolSettings.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );

    if ( this.open && canvas.delayedPaintWidgets.indexOf( this ) === -1 ) canvas.delayedPaintWidgets.push( this );
    else VG.UI.stylePool.current.drawToolSettings( this, canvas, this.svgGroup );
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.UI.LayoutHSeparator

VG.UI.LayoutHSeparator=function()
{
    if ( !(this instanceof VG.UI.LayoutHSeparator )) return new VG.UI.LayoutHSeparator();

    VG.UI.Widget.call( this );
    this.name="ToolSeparator";

    this.horizontalExpanding=false;
    this.verticalExpanding=true;

    this.preferredSize.set( 1, 1 );
};

VG.UI.LayoutHSeparator.prototype=VG.UI.Widget();

VG.UI.LayoutHSeparator.prototype.calcSize=function()
{
    return this.preferredSize;
};

VG.UI.LayoutHSeparator.prototype.paintWidget=function( canvas )
{
    this.contentRect.set( this.rect );

    //VG.context.style.drawToolSeparator( canvas, this );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.rect, VG.Core.Color("#BBC0C7") );
};

// ----------------------------------------------------------------- VG.UI.LayoutVSeparator

VG.UI.LayoutVSeparator=function()
{
    if ( !(this instanceof VG.UI.LayoutVSeparator )) return new VG.UI.LayoutVSeparator();

    VG.UI.Widget.call( this );
    this.name="ToolSeparator";

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.preferredSize.set( 2, 2 );

    this.color1 = VG.Core.Color("#525252");
    this.color2 = VG.Core.Color("#7e7e7e");
};

VG.UI.LayoutVSeparator.prototype=VG.UI.Widget();

VG.UI.LayoutVSeparator.prototype.calcSize=function()
{
    return this.preferredSize;
};

VG.UI.LayoutVSeparator.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );

    this.contentRect.y += Math.floor( (this.rect.height - 2 ) / 2 );
    this.contentRect.height = 1;

    //VG.context.style.drawToolSeparator( canvas, this );
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.contentRect, this.color1 );
    this.contentRect.y += 1;
    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.contentRect, this.color2 );
};

// ----------------------------------------------------------------- VG.UI.LayoutHSpacer

VG.UI.LayoutHSpacer=function()
{
    if ( !(this instanceof VG.UI.LayoutHSpacer )) return new VG.UI.LayoutHSpacer();

    VG.UI.Widget.call( this );
    this.name="LayoutHSpacer";

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.preferredSize.set( 1,1 );
};

VG.UI.LayoutHSpacer.prototype=VG.UI.Widget();

VG.UI.LayoutHSpacer.prototype.calcSize=function()
{
    return this.preferredSize;
};

VG.UI.LayoutHSpacer.prototype.paintWidget=function( canvas )
{
    this.contentRect.set( this.rect );
};

// ----------------------------------------------------------------- VG.UI.LayoutVSpacer

VG.UI.LayoutVSpacer=function( maxSize )
{
    if ( !(this instanceof VG.UI.LayoutVSpacer )) return new VG.UI.LayoutVSpacer( maxSize );

    VG.UI.Widget.call( this );
    this.name="LayoutVSpacer";

    this.horizontalExpanding=false;
    this.verticalExpanding=true;

    if ( maxSize !== undefined )
        this.maximumSize.height=maxSize;
};

VG.UI.LayoutVSpacer.prototype=VG.UI.Widget();

VG.UI.LayoutVSpacer.prototype.calcSize=function()
{
    var size=VG.Core.Size( 1,1 );
    return size;
};

VG.UI.LayoutVSpacer.prototype.paintWidget=function( canvas )
{
    this.contentRect.set( this.rect );
};

/**
 * The base clase and most simple layout class. It arranges child objects either horizontally or vertically. Layouts can contain {@link VG.UI.Widget} based classes or other layouts.
 * @borrows VG.UI.Widget.disabled as VG.UI.Layout.disabled
 * @borrows VG.UI.Widget.visible as VG.UI.Layout.visible
 * @property {number} length - The number of child objects in this layout (read-only).
 * @property {bool} horizontal - If true, child objects are arranged horizontally (the default).
 * @property {bool} vertical - If true, child objects are arranged vertically.
 * @constructor
 * @tutorial Layouts
 * @param {object} object - The  objects to add to the layout.
 */

VG.UI.Layout=function()
{
    if ( this instanceof VG.UI.Layout ) {
        this.name="Layout";
        this.children=[];
        this.spacing=4;

        this.rect=VG.Core.Rect();
        this.workRect=VG.Core.Rect();
        this.contentRect=VG.Core.Rect();
        this.margin=VG.Core.Margin( 8, 8, 8, 8 );
        this.minimumSize=VG.Core.Size( 100, 100 );
        this.maximumSize=VG.Core.Size( VG.UI.MaxLayoutSize, VG.UI.MaxLayoutSize );

        this.isWidget=false;
        this.isLayout=true;

        this._disabled=false;
        this._visible=true;

        this._horizontal=true;
        this._vertical=false;
        this.initLayoutAccessors();

        this.hOffset=0; this.vOffset=0;

        for( var i=0; i < arguments.length; ++i )
            this.addChild( arguments[i] );

    } else return VG.UI.Layout.creator( arguments );
};

Object.defineProperty( VG.UI.Layout.prototype, "length",
{
    get: function() {
        return this.children.length;
    }
});

Object.defineProperty( VG.UI.Layout.prototype, "disabled",
{
    get: function() {
        return this._disabled;
    },
    set: function( disabled ) {
        this._disabled=disabled;
        this.makeAllChildsLooseFocus( this );
        VG.context.workspace.canvas.update();
    }
});

Object.defineProperty( VG.UI.Layout.prototype, "visible",
{
    get: function() {
        return this._visible;
        //if ( !this.parent ) return this._visible;
        //else  return  this._visible | this.parent.visible;
    },
    set: function( visible ) {
        this._visible=visible;
        VG.update();
    }
});

Object.defineProperty( VG.UI.Layout.prototype, "horizontal",
{
    get: function() {
        return this._horizontal;
    },
    set: function( horizontal  ) {
        this._vertical=!horizontal;
        this._horizontal=horizontal;

        this.initLayoutAccessors();
        VG.update();
    }
});

Object.defineProperty( VG.UI.Layout.prototype, "vertical",
{
    get: function() {
        return this._vertical;
    },
    set: function( vertical  ) {
        this._vertical=vertical;
        this._horizontal=!vertical;

        this.initLayoutAccessors();
        VG.update();
    }
});

VG.UI.Layout.prototype.makeAllChildsLooseFocus=function( layout )
{
    for( var i=0; i < layout.children.length; ++i )
    {
        var child=this.children[i];

        if ( child.isWidget ) {
            if ( child.visualState === VG.UI.Widget.VisualState.Focus )
                VG.context.workspace.widgetLostFocus( child );
        } else
        if ( child.isLayout ) {
            this.makeAllChildsLooseFocus( child );
        }
    }
};

VG.UI.Layout.prototype.initLayoutAccessors=function()
{
    if ( this._horizontal ) {
        this.primaryCoord="x";
        this.secondaryCoord="y";

        this.primarySize="width";
        this.secondarySize="height";

        this.primaryLayoutExpanding="horizontalExpanding";
        this.secondaryLayoutExpanding="verticalExpanding";

        this.primaryLesserMargin="left";
        this.secondaryLesserMargin="top";

        this.primaryGreaterMargin="right";
        this.secondaryGreaterMargin="bottom";
    } else
    if ( this._vertical ) {
        this.primaryCoord="y";
        this.secondaryCoord="x";

        this.primarySize="height";
        this.secondarySize="width";

        this.primaryLayoutExpanding="verticalExpanding";
        this.secondaryLayoutExpanding="horizontalExpanding";

        this.primaryLesserMargin="top";
        this.secondaryLesserMargin="left";

        this.primaryGreaterMargin="bottom";
        this.secondaryGreaterMargin="right";
    }
};

/**
 * Adds a small title to the top of the layout.
 * @param {string} title - The title text to show.
 */

VG.UI.Layout.prototype.addTitle=function( title )
{
    this.title=title;
};

VG.UI.Layout.prototype.clear=function()
{
    this.children = [];
};

/**
 * Inserts a child object at a specific index to this layout.
 * @param {number} index - The index position to insert the child at.
 * @param {object} child - The child oject to add.
 */

VG.UI.Layout.prototype.insertChildAt=function( index, child )
{
    this.children.splice( index, 0, child );
    child.parent=this;
};

// Legacy
VG.UI.Layout.prototype.insertAt=function( index, child )
{
    this.insertChildAt( index, child );
};

/**
 * Adds a child object to the end of this layout.
 * @param {object} child - The child object to add to this layout.
 */

VG.UI.Layout.prototype.addChild=function( child )
{
    this.children.push( child );
    child.parent=this;
};

/**
 * Adds child objects to the end of this layout.
 * @param {object} childs - The child objects to add to this layout.
 */

VG.UI.Layout.prototype.addChilds=function()
{
    for( var i=0; i < arguments.length; ++i )
        this.addChild( arguments[i] );
};

/**
 * Returns the child object at the given index.
 * @param {number} index - The index position to of the object to return.
 * @returns {object} The object at the given index.
 */

VG.UI.Layout.prototype.childAt=function( index )
{
    return this.children[index];
};

/**
 * Removes the given child object from the layout.
 * @param {object} child - The child object to remove.
 */

VG.UI.Layout.prototype.removeChild=function( child )
{
    var index=this.children.indexOf( child );
    if ( index >= 0 ) {
        this.children.splice( index, 1 );
    }
};

/**
 * Returns true of the layout contains the given child object.
 * @param {object} child - The child object.
 * @returns {bool} True if the layout contains the child object, false otherwise.
 */

VG.UI.Layout.prototype.contains=function( child )
{
    if ( this.children.indexOf( child ) === -1 ) return false;
    else return;
};

VG.UI.Layout.prototype.hHandleMoved=function( offsetInScrollbarSpace, customLine )
{
    this.hOffset=offsetInScrollbarSpace * this.hScrollbar.totalSize / this.hScrollbar.visibleSize;
};

VG.UI.Layout.prototype.vHandleMoved=function( offsetInScrollbarSpace, customLine )
{
    this.vOffset=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.Layout.prototype.specialLayoutHitTest=function( pt )
{
    if ( !this.hScrollbar && !this.vScrollbar ) return false;

    if ( this.needsHScrollbar && this.hScrollbar.rect.contains( pt ) )
        return true;
    else
    if ( this.needsVScrollbar && this.vScrollbar.rect.contains( pt ) )
        return true;
    else
    {
        if ( ( this.hScrollbar && this.hScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) || ( this.vScrollbar && this.vScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) )
            return true;
    }
    return false;
};

VG.UI.Layout.prototype.mouseMove=function( event )
{
    if ( this.needsHScrollbar && this.hScrollbar )
    {
        if ( this.hScrollbar.rect.contains( event.pos ) ) {
            this.hScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.hScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.hScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }

    if ( this.needsVScrollbar && this.vScrollbar )
    {
        if ( this.vScrollbar.rect.contains( event.pos ) ) {
            this.vScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.vScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.vScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }
};

VG.UI.Layout.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return false;

    if ( step > 0 ) {
        this.vOffset-=1 + this.spacing;
        this.vScrollbar.scrollTo( this.vOffset );
        return true;
    } else
    {
        this.vOffset+=1 + this.spacing;
        this.vScrollbar.scrollTo( this.vOffset );
        return true;
    }
};

VG.UI.Layout.prototype.mouseDown=function( event )
{
    if ( this.needsHScrollbar && this.hScrollbar.rect.contains( event.pos ) ) {
        this.hScrollbar.mouseDown( event );
    } else
    if ( this.needsVScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
    }
};

VG.UI.Layout.prototype.autoScrollStart=function( event )
{
    if ( this.needsVScrollbar )
        this.vScrollbar.autoScrollStart( event );
};

VG.UI.Layout.prototype.calcSize=function( canvas )
{
    var size=VG.Core.Size();
    var visibleChildren=0;

    for( var i=0; i < this.children.length; ++i )
    {
        var child=this.children[i];
        var childSize=child.calcSize( canvas );

        if ( child.visible ) ++visibleChildren;

        if ( child.isWidget && child.visible )
        {
            if ( child[this.primaryLayoutExpanding] )
                size[this.primarySize]=VG.UI.MaxLayoutSize;
            else {
                if ( size[this.primarySize] < VG.UI.MaxLayoutSize )
                    size[this.primarySize]+=childSize[this.primarySize];
            }

            if ( child[this.secondaryLayoutExpanding] === false )
            {
                if ( childSize[this.secondarySize] > size[this.secondarySize] )
                    size[this.secondarySize]=childSize[this.secondarySize];
            } else
            if ( child[this.secondaryLayoutExpanding] )
            {
                if ( child.maximumSize[this.secondarySize] === VG.UI.MaxLayoutSize )
                    size[this.secondarySize]=VG.UI.MaxLayoutSize;
                else size[this.secondarySize]=child.maximumSize[this.secondarySize];
            }
        }
    }

    if ( size[this.primarySize] < VG.UI.MaxLayoutSize )
    {
        size[this.primarySize]+=(visibleChildren-1) * this.spacing;

        size[this.primarySize]+=this.margin[this.primaryLesserMargin] + this.margin[this.primaryGreaterMargin];
    }

    if ( size[this.secondarySize] < VG.UI.MaxLayoutSize )
    {
        size[this.secondarySize]+=this.margin[this.secondaryLesserMargin] + this.margin[this.secondaryGreaterMargin];
    }

    if ( size[this.primarySize] > this.maximumSize[this.primarySize] ) size[this.primarySize]=this.maximumSize[this.primarySize];
    if ( size[this.secondarySize] > this.maximumSize[this.secondarySize] ) size[this.secondarySize]=this.maximumSize[this.secondarySize];

    this.layout( canvas, true );

    return size;
};

VG.UI.Layout.prototype.layout=function( canvas, dontDraw )
{
    if ( !this.visible ) return;

    if ( !dontDraw && this.title ) {
        this.contentRect.copy( this.rect ); this.contentRect.height=VG.UI.stylePool.current.skin.TitleBar.Height;
        VG.UI.stylePool.current.drawTitleBar( canvas, this.contentRect, this.title );
    }

    if ( !this.children.length ) return;

    if ( this.animationIsRunning === true ) {
        this.animate( canvas );
        return;
    }

    this.contentRect.copy( this.rect );
    if ( this.title ) {
        this.contentRect.y+=VG.UI.stylePool.current.skin.TitleBar.Height;
        this.contentRect.height-=VG.UI.stylePool.current.skin.TitleBar.Height;
    }

    if ( !this.noClipping )
        canvas.pushClipRect( this.contentRect );
/*
    if ( this.children.length === 1 && this.children[0].isLayout )
    {
        var child=this.children[0];

        child.rect.set( this.rect );
        child.rect.x+=this.margin.left; child.rect.width-=this.margin.left + this.margin.right;
        child.rect.y+=this.margin.top; child.rect.height-=this.margin.top + this.margin.bottom;
        child.layout( canvas );

        canvas.popClipRect();

        return;
    }*/

    var primaryOffset=0, secondaryOffset=0;

    // --- Check for H Scrollbar
    if ( this.allowScrollbars && this.contentRect.width < this.minimumSize.width ) {
        this.needsHScrollbar=true;
        //VG.log( "VG.UI.Layout needs HScrollbar", this.rect.width, this.size.width );
        this.contentRect.height-=/*this.rect.height - */VG.UI.stylePool.current.skin.ScrollBar.Size;

        if ( !this.hScrollbar ) {
            this.hScrollbar=VG.UI.ScrollBar( "Horizontal LabelLayout" );
            this.hScrollbar.direction=VG.UI.ScrollBar.Direction.Horizontal;
            this.hScrollbar.callbackObject=this;
        }
        if ( this.primaryCoord === "x" ) primaryOffset=this.hOffset;
        else secondaryOffset=this.hOffset;
    } else this.needsHScrollbar=false;

    // --- Check for V Scrollbar
    if ( this.allowScrollbars && this.contentRect.height< this.minimumSize.height ) {
        this.needsVScrollbar=true;
        //VG.log( "VG.UI.Layout needs VScrollbar", this.rect.height, this.minimumSize.height );
        this.contentRect.width-=/*this.rect.width -*/ VG.UI.stylePool.current.skin.ScrollBar.Size;

        if ( !this.vScrollbar ) {
            this.vScrollbar=VG.UI.ScrollBar( "Vertical LabelLayout" );
            this.vScrollbar.direction=VG.UI.ScrollBar.Direction.Vertical;
            this.vScrollbar.callbackObject=this;
        }
        if ( this.primaryCoord === "y" ) primaryOffset=this.vOffset;
        else secondaryOffset=this.vOffset;
    } else this.needsVScrollbar=false;

    // --- Visible Children

    var visibleChildren=0, i, child;

    for( i=0; i < this.children.length; ++i )
    {
        child=this.children[i];
        if ( child.visible ) ++visibleChildren;

        if ( this.font ) child.font=this.font;
    }

    // ---

    var rect=this.contentRect;
    var totalSpacing=(visibleChildren-1) * this.spacing;

    var availableSpace=rect[this.primarySize] - totalSpacing - this.margin[this.primaryLesserMargin] - this.margin[this.primaryGreaterMargin];
    var expandingChilds=0, childLayoutSize;

    for( i=0; i < this.children.length; ++i ) {
        child=this.children[i];

        if ( !child.visible ) continue;

        if ( child.isWidget ) {
            if ( child[this.primaryLayoutExpanding] === false ) {
                availableSpace-=child.calcSize( canvas )[this.primarySize];
            } else {
                if ( child.maximumSize[this.primarySize] === VG.UI.MaxLayoutSize )
                    ++expandingChilds;
                else availableSpace-=child.maximumSize[this.primarySize];
            }
        } else
        if ( child.isLayout ) {
            childLayoutSize=child.calcSize( canvas );

            if ( childLayoutSize[this.primarySize] < VG.UI.MaxLayoutSize ) {
                availableSpace-=childLayoutSize[this.primarySize];
            } else ++expandingChilds;
        }
    }

    var expandingChildSpace=availableSpace;
    if ( expandingChilds ) expandingChildSpace/=expandingChilds;

    this.minimumSize[this.primarySize]=this.margin[this.primaryLesserMargin] + totalSpacing + this.margin[this.primaryGreaterMargin];
    this.minimumSize[this.secondarySize]=0;

    var pos=rect[this.primaryCoord] + this.margin[this.primaryLesserMargin];
    var secondaryCoord;

    for( i=0; i < this.children.length; ++i )
    {
        child=this.children[i];

        if ( !child.visible ) continue;

        if ( child.isWidget )
        {
            // --- Child is a Widget

            var size=child.calcSize( canvas );

            // --- Add Child Minimum Size

            this.minimumSize[this.primarySize]+=child.minimumSize[this.primarySize];
            if ( child.minimumSize[this.secondarySize] > this.minimumSize[this.secondarySize] ) this.minimumSize[this.secondarySize]=child.minimumSize[this.secondarySize];

            // ---

            if ( child[this.primaryLayoutExpanding] === false )
            {
                secondaryCoord=rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] + ( rect[this.secondarySize] -
                    this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] - size[this.secondarySize] ) / 2;

                child.rect[this.primaryCoord]=pos - primaryOffset;
                child.rect[this.secondaryCoord]=secondaryCoord - secondaryOffset;

                if ( child[this.secondaryLayoutExpanding] === false ) {
                    child.rect.setSize( size.width, size.height );
                } else
                if ( child[this.secondaryLayoutExpanding] ) {
                    child.rect[this.secondaryCoord]=rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin];
                    child.rect[this.secondarySize]=rect[this.secondarySize] - this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin];
                    child.rect[this.primarySize]=size[this.primarySize];
                }
            } else
            if ( child[this.primaryLayoutExpanding] )
            {
                var secondarySize;

                if ( child[this.secondaryLayoutExpanding] === false ) {
                    secondaryCoord=rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] +  (rect[this.secondarySize] -
                        this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] - size[this.secondarySize])/2;
                    secondarySize=size[this.secondarySize];

                } else
                if ( child[this.secondaryLayoutExpanding] ) {
                    secondaryCoord=rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin];
                    secondarySize=rect[this.secondarySize] - this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin];
                }

                child.rect[this.primaryCoord]=pos - primaryOffset;
                child.rect[this.secondaryCoord]=secondaryCoord - secondaryOffset;

                if ( child.maximumSize[this.primarySize] === VG.UI.MaxLayoutSize )
                    child.rect[this.primarySize]=expandingChildSpace;
                else child.rect[this.primarySize]=child.maximumSize[this.primarySize];

                child.rect[this.secondarySize]=secondarySize;
            }

            child.rect.round();
            if ( !dontDraw ) child.paintWidget( canvas );
            pos+=child.rect[this.primarySize] + this.spacing;
        } else
        {
            // --- Child is a Layout

            var childRect=VG.Core.Rect();
            childLayoutSize=child.calcSize( canvas );

            // --- Add Child Minimum Size

            this.minimumSize[this.primarySize]+=child.minimumSize[this.primarySize];
            if ( child.minimumSize[this.secondarySize] > this.minimumSize[this.secondarySize] ) this.minimumSize[this.secondarySize]=child.minimumSize[this.secondarySize];

            // ---

            childRect[this.primaryCoord]=pos;
            childRect[this.secondaryCoord]=rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin];
            childRect[this.secondarySize]=rect[this.secondarySize] - this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin];

            if ( childLayoutSize[this.primarySize] < VG.UI.MaxLayoutSize ) {
                childRect[this.primarySize]=childLayoutSize[this.primarySize];
            } else childRect[this.primarySize]=expandingChildSpace;

            child.rect.set( childRect );
            if ( !dontDraw ) child.layout( canvas );

            pos+=childRect[this.primarySize] + this.spacing;
        }
    }

    this.minimumSize[this.secondarySize]+=this.margin[this.secondaryLesserMargin] + this.margin[this.secondaryGreaterMargin];

    if ( this.needsHScrollbar ) {
        this.setHScrollbarDimensions( canvas );
        this.hScrollbar.paintWidget( canvas );
    }

    if ( this.needsVScrollbar ) {
        this.setVScrollbarDimensions( canvas );
        this.vScrollbar.paintWidget( canvas );
    }

    if ( !this.noClipping )
        canvas.popClipRect();
};

VG.UI.Layout.prototype.setHScrollbarDimensions=function( canvas )
{
    this.hScrollbar.rect=VG.Core.Rect( this.contentRect.x + 1, this.contentRect.bottom(),
        this.contentRect.width - 2, VG.UI.stylePool.current.skin.Scrollbar.Size );

    this.hScrollbar.setScrollBarContentSize( this.minimumSize.width, this.contentRect.width-2 );
};

VG.UI.Layout.prototype.setVScrollbarDimensions=function( canvas )
{
    this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right() /*- VG.UI.stylePool.current.skin.ScrollBar.Size*/, this.contentRect.y + 1,
        VG.UI.stylePool.current.skin.ScrollBar.Size, this.contentRect.height-2 );

    this.vScrollbar.setScrollBarContentSize( this.minimumSize.height, this.contentRect.height );
};

VG.UI.LayoutAnimationItem=function( widget )
{
    this.rect=VG.Core.Rect( widget.rect );
    this.visible=widget.visible;
    this.widget=widget;
};

VG.UI.LayoutAnimationState=function( layout )
{
    this.animationItems=[];

    layout.layout( VG.context.workspace.canvas, true );

    for( var i=0; i < layout.children.length; ++i )
    {
        var child=layout.children[i];

        var animationItem=new VG.UI.LayoutAnimationItem( child );
        this.animationItems.push( animationItem );

        if ( layout instanceof VG.UI.LabelLayout ) {
            var item=layout.items[i];

            animationItem.label=item.label;
            animationItem.labelRect=VG.Core.Rect( item.labelRect );
            animationItem.labelVAlignment=item.labelVAlignment;
        }
    }
};

VG.UI.Layout.prototype.lockAnimationSourceData=function()
{
    this.animationStates=[];
    this.animationStates.push( new VG.UI.LayoutAnimationState( this ) );
};

VG.UI.Layout.prototype.lockAnimationDestData=function()
{
    this.animationStates.push( new VG.UI.LayoutAnimationState( this ) );
};

VG.UI.Layout.prototype.startAnimation=function( mode, time )
{
    if ( !this.visible ) return;

    this.animationIsRunning=true;
    this.animationStartTime=new Date().getTime();
    this.animationDuration=time;

    VG.context.workspace.redrawList.push( this.animationStartTime + 1 );
};

VG.UI.Layout.prototype.animate=function( canvas )
{
    var currentTime=new Date().getTime();
    var timeElapsed=currentTime - this.animationStartTime;

    var percent=timeElapsed * 100 / this.animationDuration;

    if ( percent < 100 ) {
        VG.context.workspace.redrawList.push( currentTime + 1 );
    } else {
        if ( this.animationIsRunning )
            VG.context.workspace.redrawList.push( currentTime + VG.AnimationTick );
        this.animationIsRunning=false;
        percent=100;
    }

    for( var i=0; i < this.animationStates[0].animationItems.length; ++i )
    {
        var sItem=this.animationStates[0].animationItems[i];
        var dItem=this.animationStates[1].animationItems[i];

        if ( sItem.widget === dItem.widget )
        {
            if ( sItem.visible !== dItem.visible )
            {
                if ( sItem.visible ) canvas.setAlpha( (100 - percent) / 100.0 );
                else canvas.setAlpha( percent / 100.0 );

                sItem.widget.rect.set( dItem.rect );
                sItem.widget.paintWidget( VG.context.workspace.canvas );

                if ( sItem.label ) {
                    canvas.pushFont( VG.UI.stylePool.current.skin.Widget.Font );
                    VG.context.workspace.canvas.drawTextRect( sItem.label, sItem.labelRect, VG.UI.stylePool.current.skin.Widget.TextColor, 2, sItem.labelVAlignment );
                    canvas.popFont();
                }
            } else
            {
                var item=dItem;
                var rect, fadeLabel=false;

                if ( sItem.rect.equals( dItem.rect ) ) rect=sItem.rect;
                else {
                    // --- Compute the middle rect

                    rect=VG.Core.Rect();

                    rect.x=sItem.rect.x + ((dItem.rect.x - sItem.rect.x)/100) * percent;
                    rect.y=sItem.rect.y + ((dItem.rect.y - sItem.rect.y)/100) * percent;
                    rect.width=sItem.rect.width + ((dItem.rect.width - sItem.rect.width)/100) * percent;
                    rect.height=sItem.rect.height + ((dItem.rect.height - sItem.rect.height)/100) * percent;

                    fadeLabel=true;
                }

                canvas.setAlpha( 1.0 );

                item.widget.rect.set( rect.round() );
                item.widget.paintWidget( VG.context.workspace.canvas );

                if ( item.label ) {
                    canvas.pushFont( VG.UI.stylePool.current.skin.Widget.Font );
                    if ( fadeLabel ) canvas.setAlpha( percent / 100.0 );
                    canvas.drawTextRect( item.label, item.labelRect, VG.UI.stylePool.current.skin.Widget.TextColor, 2, item.labelVAlignment );
                    canvas.popFont();
                }
            }
        }
    }

    canvas.setAlpha( 1.0 );
};

// ----------------------------------------------------------------- VG.UI.SplitLayoutItem

VG.UI.SplitLayoutItem=function()
{
    if ( !(this instanceof VG.UI.SplitLayoutItem) ) return new VG.UI.SplitLayoutItem();

    this.percent=50;
    this.offset=0;
    this.totalOffset=0;
    this.canDrag=false;

    this.rect=VG.Core.Rect();
};

/**
 * This layout arranges it's relatively sized child objects next to each other. Expanding child object can be resized by the use of a small bar next the object.
 * Each object is given a percentage (out of 100) which defines its relative size compared to the other child objects.
 * Layouts can contain {@link VG.UI.Widget} based classes or other layouts.
 * @borrows VG.UI.Widget.disabled as VG.UI.Layout.disabled
 * @borrows VG.UI.Widget.visible as VG.UI.Layout.visible
 * @property {number} length - The number of child objects in this layout (read-only).
 * @property {bool} horizontal - If true, child objects are arranged horizontally (the default).
 * @property {bool} vertical - If true, child objects are arranged vertically.
 * @constructor
 * @tutorial Layouts
 * @param {object} child - The  object to add to the layout.
 * @param {number} percent - The relative size of the object in percent.
 */

VG.UI.SplitLayout=function()
{
    if ( !(this instanceof VG.UI.SplitLayout) ) return VG.UI.SplitLayout.creator( arguments );

    VG.UI.Layout.call( this );
    this.name="SplitLayout";

    this.minimumSize.set( 200, 200 );

    this.dragOpStart=VG.Core.Point();

    this.dragOpItemIndex=0;
    this.dragOp=false;

    this.items=[];
    this.spacing = VG.UI.stylePool.current.skin.SplitLayout.Size;

    for( var i=0; i < arguments.length; i+=2 )
        this.addChild( arguments[i], arguments[i+1] );
};

VG.UI.SplitLayout.prototype=VG.UI.Layout();

VG.UI.SplitLayout.prototype.calcSize=function( canvas )
{
    var size=VG.Core.Size();
    size.width=VG.UI.MaxLayoutSize;
    size.height=VG.UI.MaxLayoutSize;

    if ( size[this.primarySize] > this.maximumSize[this.primarySize] ) size[this.primarySize]=this.maximumSize[this.primarySize];
    if ( size[this.secondarySize] > this.maximumSize[this.secondarySize] ) size[this.secondarySize]=this.maximumSize[this.secondarySize];

    return size;
};

/**
 * Adds a child object to the end of this layout.
 * @param {object} child - The child object to add to the layout.
 * @param {number} percent - The relative size of the object in percent (out of 100).
 */

VG.UI.SplitLayout.prototype.addChild=function( child, percent )
{
    this.children.push( child );
    child.parent=this;

    var item=VG.UI.SplitLayoutItem();

    if ( arguments.length == 2 )
        item.percent=percent;

    this.items.push( item );
};

/**
 * Inserts a child object at a specific index to this layout.
 * @param {number} index - The index position to insert the child at.
 * @param {object} child - The child oject to add.
 * @param {number} percent - The relative size of the object in percent (out of 100).
 */

VG.UI.SplitLayout.prototype.insertChildAt=function( index, child, percent )
{
    child.parent=this;
    this.children.splice( index, 0, child );

    let item = VG.UI.SplitLayoutItem();

    if ( arguments.length == 3 )
        item.percent=percent;

    this.items.splice( index, 0, item );
};

// Legacy
VG.UI.SplitLayout.prototype.insertChild=function( index, child )
{
    this.insertChildAt( index, child );
};

/**
 * Removes the given child object from the layout.
 * @param {object} child - The child object to remove.
 */

VG.UI.SplitLayout.prototype.removeChild=function( child )
{
    var index=this.children.indexOf( child );
    if ( index >= 0 ) {
        this.children.splice( index, 1 );
        this.items.splice( index, 1 );
    }
};

/**
 * Returns the relative child object's percentage at the given index.
 * @param {number}  index - The index of the child object.
 * @returns {number} The child object's relative percentage.
 */

VG.UI.SplitLayout.prototype.getChildPercentAt=function( index )
{
    return this.items[index].percent;
};

/**
 * Sets the child object's relative percentage at the given index.
 * @param {number} index - The index of the child object.
 * @param {number} percent - The relative size of the object in percent (out of 100).
 */

VG.UI.SplitLayout.prototype.setChildPercentAt=function( index, percent )
{
    this.items[index].percent=percent;
};

VG.UI.SplitLayout.prototype.specialLayoutHitTest=function( pt )
{
    for( i=0; i < this.children.length; ++i )
    {
        var item=this.items[i];
        if ( item.canDrag && item.rect.contains( pt ) ) {
            this.dragOpItemIndex=i;

            if ( this.horizontal ) VG.setMouseCursor( "col-resize" );
            else VG.setMouseCursor( "row-resize" );

            if ( !this.hasHoverState ) {
                this.hasHoverState=true;
                VG.update();
            }

            this.mouseCursorChanged=true;

            return true;
        }
    }

    if ( this.mouseCursorChanged ) {
        VG.setMouseCursor( "default" );
        this.mouseCursorChanged=false;
    }

    if ( this.hasHoverState ) {
        this.hasHoverState=false;
        VG.update();
    }
    return false;
};

VG.UI.SplitLayout.prototype.hoverIn=function()
{
    //console.log( "hoverIn" );
};

VG.UI.SplitLayout.prototype.hoverOut=function()
{
    if ( this.mouseCursorChanged ) {
        VG.setMouseCursor( "default" );
        this.mouseCursorChanged=false;
    }
};

VG.UI.SplitLayout.prototype.mouseMove=function( event )
{
    if ( VG.context.workspace.mouseDownButton === undefined ) {

        this.dragOp=0;
        VG.context.workspace.mouseTrackerWidget=0;

        for( let i=0; i < this.items.length; ++i ) {
            let item=this.items[i];
            item.offset=0;
        }
        return;
    }

    if ( this.dragOp )
    {
        let item=this.items[this.dragOpItemIndex];
        let nextItem=this.items[this.dragOpItemIndex + 1 ];

        let widget=this.children[this.dragOpItemIndex ];
        let nextWidget=this.children[this.dragOpItemIndex + 1];

        let oldItemOffset=item.offset;
        let oldNextItemOffset=nextItem.offset;
        let offset;

        if ( event.pos[this.primaryCoord] > this.dragOpStart[this.primaryCoord] )
        {
            // --- User drags to the right / down

            offset=event.pos[this.primaryCoord] - this.dragOpStart[this.primaryCoord];
            var greaterBorder;

            if ( (this.dragOpItemIndex + 1 ) < ( this.items.length - 1 ) ) {
                // --- There is another item to the right / bottom, use it as the greater border.
                var rightWidget=this.children[this.dragOpItemIndex + 2];
                greaterBorder=rightWidget.rect[this.primaryCoord] - this.spacing - nextWidget.minimumSize[this.primarySize];
            } else {
                // --- greater border is rect
                greaterBorder=this.rect[this.primaryCoord] + this.rect[this.primarySize] - this.margin[this.primaryGreaterMargin] -
                    this.spacing - nextWidget.minimumSize[this.primarySize];
            }

            if ( event.pos[this.primaryCoord] > greaterBorder ) {
                offset-=event.pos[this.primaryCoord] - greaterBorder;
            }

            item.offset=offset;
            nextItem.offset=-offset;
        } else {
            // --- User drags to the left / top

            offset=this.dragOpStart[this.primaryCoord] - event.pos[this.primaryCoord];

            let lesserBorder=widget.rect[this.primaryCoord] + this.margin[this.primaryLesserMargin] + widget.minimumSize[this.primarySize];
            if ( event.pos[this.primaryCoord] < lesserBorder ) offset-=lesserBorder - event.pos[this.primaryCoord];

            item.offset=-offset;
            nextItem.offset=offset;
        }

        if ( ( oldItemOffset != item.offet ) || ( oldNextItemOffset != nextItem.offset ) )
            VG.context.workspace.canvas.update();
    }
};

VG.UI.SplitLayout.prototype.mouseDown=function( event )
{
    if ( !this.specialLayoutHitTest( event.pos ) ) return;

    var widget=this.children[this.dragOpItemIndex];

    if ( event.pos[this.primaryCoord] > ( widget.rect[this.primaryCoord] + widget.rect[this.primarySize] - this.spacing ) ) {

        this.dragOp=true;
        this.dragOpStart.set( event.pos );

        VG.context.workspace.mouseTrackerWidget=this;
    }
};

VG.UI.SplitLayout.prototype.mouseUp=function( event )
{
    this.dragOp=0;
    VG.context.workspace.mouseTrackerWidget=0;

    for( let i=0; i < this.items.length; ++i ) {
        let item=this.items[i];

        item.totalOffset+=item.offset;
        item.offset=0;
    }

    VG.update();
};

VG.UI.SplitLayout.prototype.recalcOffset=function()
{
    for( let i=0; i < this.items.length; ++i ) {
        let item=this.items[i];

        item.totalOffset+=item.offset;
        item.offset=0;
    }
};

VG.UI.SplitLayout.prototype.layout=function( canvas )
{
    if ( !this.children.length ) return;

    this.rect.round();
    let sepSize = this.spacing;
    this.spacing=sepSize;

    let rect=this.rect;

    let availableSpace=rect[this.primarySize] - this.margin[this.primaryLesserMargin] - this.margin[this.primaryGreaterMargin];
    let expandingChilds=0, i, child;

    for( i=0; i < this.children.length; ++i ) {
        child=this.children[i];

        if ( child.isWidget ) {
            if ( child[this.primaryLayoutExpanding] === false ) {
                availableSpace-=child.calcSize( canvas )[this.primarySize];
            } else ++expandingChilds;
        } else
        if ( child.isLayout ) {
            let childLayoutSize=child.calcSize( canvas );
            /*if ( childLayoutSize[this.primarySize] < VG.UI.MaxLayoutSize ) {
                availableSpace-=childLayoutSize[this.primarySize];
            } else*/ ++expandingChilds;
        }
    }

    let totalSpacing=(expandingChilds-1) * sepSize;
    availableSpace-=totalSpacing;

    let expandingChildSpace=availableSpace;
    let minAdjustmentCorrection=0;
    let pos=rect[this.primaryCoord] + this.margin[this.primaryLesserMargin];

    for( i=0; i < this.children.length; ++i )
    {
        child = this.children[i];
        let childRect=this.workRect;

        let size, item, primarySize;
        let secondaryCoord, secondarySize;

        let adjustY = 0;
        if ( VG.context.workspace.layout === this && VG.context.workspace.decoratedToolBar && child.__rightDock )
            adjustY = VG.context.workspace.appLogo.rect.height - VG.UI.stylePool.current.skin.DecoratedToolBar.Height;

        if ( child.isWidget )
        {
            // --- The Child is a Widget

            size = child.calcSize( canvas );

            if ( child[this.primaryLayoutExpanding] === false )
            {
                child.rect[this.primaryCoord] = pos;
                child.rect[this.secondaryCoord] = rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] - adjustY;

                secondaryCoord = rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] + ( rect[this.secondarySize] -
                    this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] - size[this.secondarySize] ) / 2 - adjustY;

                if ( child[this.secondaryLayoutExpanding] === false ) {
                    child.rect.setSize( size.width, size.height );
                } else
                if ( child[this.secondaryLayoutExpanding] ) {

                    child.rect[this.primarySize] = size[this.primarySize];
                    child.rect[this.secondarySize] = rect[this.secondarySize] + adjustY;
                }

                child.rect.round();
                // canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, child.rect, VG.UI.stylePool.current.skin.Widget.BackgroundColor );
                child.paintWidget( canvas );
                childRect.copy( child.rect );
            } else
            if ( child[this.primaryLayoutExpanding] )
            {
                if ( child[this.secondaryLayoutExpanding] === false ) {
                    size = child.calcSize( canvas );

                    secondaryCoord = rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] +  (rect[this.secondarySize] -
                        this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] - size[this.secondarySize])/2 - adjustY;
                    secondarySize = size[this.secondarySize] + adjustY;
                } else
                if ( child[this.secondaryLayoutExpanding] ) {
                    secondaryCoord = rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] - adjustY;
                    secondarySize = rect[this.secondarySize] - this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] + adjustY;
                }

                child.rect[this.primaryCoord] = pos;
                child.rect[this.secondaryCoord] = secondaryCoord;
                child.rect[this.secondarySize] = secondarySize;

                item = this.items[i];
                primarySize=(expandingChildSpace*item.percent) / 100.0 - minAdjustmentCorrection;
                if ( primarySize < child.minimumSize[this.primarySize] )
                {
                    // --- Propagate the correction when a minimumSize conflicts with the assigned percentage
                    minAdjustmentCorrection += child.minimumSize[this.primarySize] - primarySize;
                    primarySize = child.minimumSize[this.primarySize];
                }

                availableSpace -= primarySize;
                if ( availableSpace < 0 ) primarySize += availableSpace;

                primarySize+=item.offset + item.totalOffset;
                child.rect[this.primarySize] = primarySize;

                child.rect.round();
                if ( primarySize > 1 ) {
                    // canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, child.rect, VG.UI.stylePool.current.skin.Widget.BackgroundColor );
                    child.paintWidget( canvas );
                }
                childRect.copy( child.rect );
            }
        } else
        {
            // --- Child is a Layout

            childRect[this.primaryCoord] = pos;
            childRect[this.secondaryCoord] = rect[this.secondaryCoord] + this.margin[this.secondaryLesserMargin] - adjustY;
            childRect[this.secondarySize] = rect[this.secondarySize] - this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] + adjustY;

            item = this.items[i];
            primarySize = (expandingChildSpace*item.percent) / 100.0 - minAdjustmentCorrection;

            if ( primarySize < child.minimumSize[this.primarySize] )
            {
                // --- Propagate the correction when a minimumSize conflicts with the assigned percentage
                minAdjustmentCorrection += child.minimumSize[this.primarySize] - primarySize;
                primarySize = child.minimumSize[this.primarySize];
            }

            availableSpace -= primarySize;
            if ( availableSpace < 0 ) primarySize += availableSpace;

            primarySize += item.offset + item.totalOffset;
            childRect[this.primarySize] = primarySize;

            child.rect.copy( childRect );
            child.rect.round();
            if ( primarySize > 1 ) {
                // canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, child.rect, VG.UI.stylePool.current.skin.Widget.BackgroundColor );
                child.layout( canvas );
            }
        }

        let drawSplitbar = true;

        if ( i < (this.children.length-1) ) {
            child = this.children[i];
            item = this.items[i];

            adjustY = 0;
            if ( VG.context.workspace.layout === this && VG.context.workspace.decoratedToolBar && this.children[i+1].__rightDock )
                adjustY = VG.context.workspace.appLogo.rect.height - VG.UI.stylePool.current.skin.DecoratedToolBar.Height;

            if ( child.isWidget && child[this.primaryLayoutExpanding] === false )
                drawSplitbar=false;

            if ( this.children[i+1].isWidget && this.children[i+1][this.primaryLayoutExpanding] === false )
                drawSplitbar=false;

            if ( drawSplitbar ) {

                VG.UI.stylePool.current.drawSplitHandle( canvas, this, pos, item.rect, childRect, this.dragOp && this.dragOpItemIndex === i, this.hasHoverState && this.dragOpItemIndex === i, adjustY );

                item.rect[this.primaryCoord]=pos + childRect[this.primarySize];
                item.rect[this.secondaryCoord]=this.margin[this.secondaryLesserMargin] + rect[this.secondaryCoord] - adjustY;
                item.rect[this.primarySize]=sepSize;
                item.rect[this.secondarySize]=rect[this.secondarySize] - this.margin[this.secondaryLesserMargin] - this.margin[this.secondaryGreaterMargin] + adjustY;
                item.canDrag=true;
            } else item.canDrag=false;
        }

        pos += childRect[this.primarySize];
        if ( drawSplitbar ) pos+=sepSize;
    }
};

// ----------------------------------------------------------------- VG.UI.LabelLayoutItem

VG.UI.LabelLayoutItem=function( label, widget )
{
    if ( !(this instanceof VG.UI.LabelLayoutItem) ) return new VG.UI.LabelLayoutItem( label, widget );

    this.label=label;
    this.labelRect=VG.Core.Rect();
    this.widget=widget;
};

/**
 * Arranges it's child objects vertically with a text label to the left of each child object.
 * Layouts can contain {@link VG.UI.Widget} based classes or other layouts.
 * @borrows VG.UI.Widget.disabled as VG.UI.Layout.disabled
 * @borrows VG.UI.Widget.visible as VG.UI.Layout.visible
 * @property {number} length - The number of child objects in this layout (read-only).
 * @constructor
 * @tutorial Layouts
 * @param {string} label - The text label of the object.
 * @param {object} child - The  object to add to the layout.
 */

VG.UI.LabelLayout=function()
{
    if ( !(this instanceof VG.UI.LabelLayout) ) return VG.UI.LabelLayout.creator( arguments );

    VG.UI.Layout.call( this );
    this.name="LabelLayout";

    this.items=[];
    this.spacing=8;
    this.labelSpacing=8;
/*
    this.margin.left=12;
    this.margin.right=12;
    this.margin.top=12;
    this.margin.bottom=12;*/

    this.labelAlignment=VG.UI.HAlignment.Right;
    this.mode=VG.UI.LabelLayout.Mode.WidgetMax;

    this.size=VG.Core.Size();

    for( var i=0; i < arguments.length; i+=2 ) {
        let widget = arguments[i+1];
        if ( typeof widget === 'string' || widget instanceof String ) this.addDivider( widget );
        else this.addChild( arguments[i], arguments[i+1] );
    }

    this.hOffset=0; this.vOffset=0;
    this.allowScrollbars=false;
};

VG.UI.LabelLayout.prototype=VG.UI.Layout();

VG.UI.LabelLayout.Mode={ "WidgetMax" : 0, "Centered" : 1 };

VG.UI.LabelLayout.prototype.calcSize=function( canvas )
{
    this.layout( canvas, true );
    this.size.set( this.minimumSize );

    return this.size;
};

/**
 * Adds a child object to the end of this layout.
 * @param {string} label - The text label of the child object to add.
 * @param {object} child - The child object to add to the layout.
 */

VG.UI.LabelLayout.prototype.addChild=function( label, widget )
{
    let item=VG.UI.LabelLayoutItem( label, widget );

    this.items.push( item );
    this.children.push( widget );
    widget.parent=this;

    if  ( label === "__EXPANDING__" )
        item.isExpanding = true;
};

/**
 * Adds a child object to the end of this layout.
 * @param {string} label - The text label of the child object to add.
 * @param {object} child - The child object to add to the layout.
 */

VG.UI.LabelLayout.prototype.addDivider=function( label = "" )
{
    let widget = VG.UI.LayoutVSeparator();
    let item=VG.UI.LabelLayoutItem( label, widget );
    item.isDivider = true;

    this.items.push( item );
    this.children.push( widget );
};

VG.UI.LabelLayout.prototype.hHandleMoved=function( offsetInScrollbarSpace, customLine )
{
    this.hOffset=offsetInScrollbarSpace * this.hScrollbar.totalSize / this.hScrollbar.visibleSize;
};

VG.UI.LabelLayout.prototype.vHandleMoved=function( offsetInScrollbarSpace, customLine )
{
    this.vOffset=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
};

VG.UI.LabelLayout.prototype.specialLayoutHitTest=function( pt )
{
    if ( !this.hScrollbar && !this.vScrollbar ) return false;

    if ( this.needsHScrollbar && this.hScrollbar.rect.contains( pt ) )
        return true;
    else
    if ( this.needsVScrollbar && this.vScrollbar.rect.contains( pt ) )
        return true;
    else
    {
        if ( ( this.hScrollbar && this.hScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) || ( this.vScrollbar && this.vScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) )
            return true;
    }
    return false;
};

VG.UI.LabelLayout.prototype.mouseMove=function( event )
{
    if ( this.needsHScrollbar && this.hScrollbar )
    {
        if ( this.hScrollbar.rect.contains( event.pos ) ) {
            this.hScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.hScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.hScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }

    if ( this.needsVScrollbar && this.vScrollbar )
    {
        if ( this.vScrollbar.rect.contains( event.pos ) ) {
            this.vScrollbar.mouseMove( event );
            return;
        } else
        {
            if ( this.vScrollbar.visualState === VG.UI.Widget.VisualState.Hover ) {
                this.vScrollbar.visualState=VG.UI.Widget.VisualState.Normal;
                VG.update();
            }
        }
    }
};

VG.UI.LabelLayout.prototype.mouseWheel=function( step )
{
    if ( !this.needsVScrollbar ) return false;

    if ( step > 0 ) {
        this.vOffset-=1 + this.spacing;
        this.vScrollbar.scrollTo( this.vOffset );
        return true;
    } else
    {
        this.vOffset+=1 + this.spacing;
        this.vScrollbar.scrollTo( this.vOffset );
        return true;
    }
};

VG.UI.LabelLayout.prototype.mouseDown=function( event )
{
    if ( this.needsHScrollbar && this.hScrollbar.rect.contains( event.pos ) ) {
        this.hScrollbar.mouseDown( event );
    } else
    if ( this.needsVScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
    }
};

VG.UI.LabelLayout.prototype.mouseUp=function( event )
{
    //console.log( "mouseUp" );
};

VG.UI.LabelLayout.prototype.layout=function( canvas, dontDraw )
{
    if ( !this.visible ) return;

    if ( !dontDraw && this.title ) {
        this.contentRect.copy( this.rect ); this.contentRect.height=VG.UI.stylePool.current.skin.TitleBar.Height;
        VG.UI.stylePool.current.drawTitleBar( canvas, this.contentRect, this.title );
    }

    if ( !this.children.length ) return;

    if ( this.animationIsRunning === true ) {
        this.animate( canvas );
        return;
    }

    this.rect.round();
    this.contentRect.copy( this.rect );
    if ( this.title ) {
        this.contentRect.y+=VG.UI.stylePool.current.skin.TitleBar.Height;
        this.contentRect.height-=VG.UI.stylePool.current.skin.TitleBar.Height;
    }

    // --- If single item with empty label make it occupy all of the space
    if ( this.items.length === 1 && this.items[0].label === "" ) {
        let widget = this.items[0].widget;
        widget.rect.copy( this.contentRect.shrink( 2, 2 ) );
        widget.paintWidget( canvas );
        return;
    }

    // --- Check for H Scrollbar
    if ( this.allowScrollbars && Math.floor( this.rect.width ) < Math.floor( this.size.width ) ) {
        this.needsHScrollbar=true;
        //VG.log( "VG.UI.LabelLayout needs HScrollbar", this.rect.width, this.size.width );
        this.contentRect.height-=/*this.rect.height -*/ VG.UI.stylePool.current.skin.ScrollBar.Size;

        if ( !this.hScrollbar ) {
            this.hScrollbar=VG.UI.ScrollBar( "Horizontal LabelLayout" );
            this.hScrollbar.direction=VG.UI.ScrollBar.Direction.Horizontal;
            this.hScrollbar.callbackObject=this;
        }
    } else this.needsHScrollbar=false;

    // --- Check for V Scrollbar
    if ( this.allowScrollbars && Math.floor( this.rect.height ) < Math.floor( this.size.height ) ) {
        this.needsVScrollbar=true;
        //VG.log( "VG.UI.LabelLayout needs VScrollbar", this.rect.height, this.size.height );
        this.contentRect.width-=/*this.rect.width -*/ VG.UI.stylePool.current.skin.ScrollBar.Size;

        if ( !this.vScrollbar ) {
            this.vScrollbar=VG.UI.ScrollBar( "Vertical LabelLayout" );
            this.vScrollbar.direction=VG.UI.ScrollBar.Direction.Vertical;
            this.vScrollbar.callbackObject=this;
        }
    } else this.needsVScrollbar=false;

    canvas.pushClipRect( this.contentRect );

    canvas.pushFont( VG.UI.stylePool.current.skin.Widget.Font );

    var rect=this.contentRect;
    var rectWidth=rect.width - this.margin.left - this.margin.right;

    var y=rect.y + this.margin.top;
    var sideWidth=(rectWidth - this.labelSpacing) / 2;

    var labelRect=VG.Core.Rect();
    var widgetRect=VG.Core.Rect();
    var minHeight=canvas.getLineHeight();
    var i;

    this.minimumSize.set( 0, this.margin.top + this.margin.bottom );

    if ( this.title )
        this.minimumSize.height+=VG.UI.stylePool.current.skin.TitleBar.Height;

    // --- Compute number of visible items

    var visibleItems=0, child;

    for( i=0; i < this.children.length; ++i ) {
        child=this.children[i];
        if ( child.visible ) ++visibleItems;
    }

    // ----

    var totalSpacing=(visibleItems-1) * this.spacing;
    var availableSpace=rect.height - totalSpacing - this.margin.top - this.margin.bottom;
    if ( this.title ) availableSpace-=VG.UI.stylePool.current.skin.TitleBar.Height;

    var expandingChilds=0;

    for( i=0; i < this.children.length; ++i ) {
        child=this.children[i];

        if ( this.items[i].isDivider ) availableSpace -= 11;
        else
        if ( child.isWidget && child.visible ) {
            if ( child.verticalExpanding === false ) {
                availableSpace-=child.calcSize( canvas ).height;
            } else {
                if ( child.maximumSize.height === VG.UI.MaxLayoutSize )
                    ++expandingChilds;
                else availableSpace-=child.maximumSize.height;
            }
        }
    }

    var expandingChildSpace=availableSpace / expandingChilds;

    // ---

    let textSize=VG.Core.Size();
    if ( this.mode === VG.UI.LabelLayout.Mode.WidgetMax )
    {
        var maxTextWidth=0;

        for( i=0; i < this.items.length; ++i ) {
            child=this.items[i];

            if ( child.isDivider || child.isExpanding )
                continue;

            canvas.getTextSize( child.label, textSize );

            if ( textSize.width > maxTextWidth )
                maxTextWidth=textSize.width;
        }

        labelRect.x=rect.x + this.margin.left;
        labelRect.width=maxTextWidth;

        widgetRect.x=rect.x + this.margin.left + maxTextWidth + this.labelSpacing;
        widgetRect.width=rectWidth - maxTextWidth - this.labelSpacing;
    } else
    if ( this.mode === VG.UI.LabelLayout.Mode.Centered )
    {
        labelRect.x=rect.x + this.margin.left;
        labelRect.width=sideWidth;

        widgetRect.x=rect.x + rectWidth / 2 + this.labelSpacing / 2;
        widgetRect.width=sideWidth;
    }

    labelRect.x-=this.hOffset;
    widgetRect.x-=this.hOffset;

    // ---

    for( i=0; i < this.items.length; ++i ) {
        child=this.items[i];
        var widget=child.widget;

        if ( widget.isLayout && widget instanceof VG.UI.StackedLayout && widget.current )
            widget=widget.current;

        if ( !widget.visible ) continue;

        var widgetSize=widget.calcSize( canvas );
        var height;
        var textVAlignment=1;

        if ( widget.verticalExpanding === false )
            height=widgetSize.height;
        else {

            if ( widget.maximumSize.height === VG.UI.MaxLayoutSize )
                height=expandingChildSpace;
            else height=widget.maximumSize.height;
            textVAlignment=0;
        }

        if ( height < minHeight )
            height=minHeight;

        labelRect.y=y - this.vOffset;
        labelRect.height=height;
        child.labelRect.set( labelRect );
        child.labelVAlignment=textVAlignment;

        labelRect.round();

        if ( arguments.length === 1 ) {

            if ( child.isExpanding )
            {

            } else
            if ( child.isDivider )
            {
                canvas.getTextSize( child.label, textSize );

                widget.rect.copy( labelRect );
                widget.rect.x = rect.x + this.margin.left;
                widget.rect.width = rect.width;
                widget.rect.y -= this.spacing /2;

                canvas.drawTextRect( child.label, widget.rect, VG.UI.stylePool.current.skin.Widget.TextColor, 1, textVAlignment );
            } else {
                if ( !this.disabled && !widget.disabled ) canvas.drawTextRect( child.label, labelRect, VG.UI.stylePool.current.skin.Widget.TextColor, this.labelAlignment, textVAlignment );
                else canvas.drawTextRect( child.label, labelRect, VG.UI.stylePool.current.skin.Widget.DisabledTextColor, this.labelAlignment, textVAlignment );
            }
        }

        widget.rect.y=y - this.vOffset;

        if ( child.isDivider )
        {
            widget.rect.y -= this.spacing /2;
            if ( child.label.length > 1 ) {
                widget.rect.x = rect.x + this.margin.left;
                widget.rect.width = (rect.width - textSize.width)/2 - this.margin.right;

                widget.rect.round();

                if ( arguments.length === 1 )
                    widget.paintWidget( canvas );

                widget.rect.x += widget.rect.width + textSize.width + 12;
                widget.rect.width -= 12;
            } else {
                widget.rect.x = rect.x + this.margin.left;
                widget.rect.width = rect.width - this.margin.left - this.margin.right;
            }
            widget.rect.height = minHeight;
            y-=this.spacing;
        } else
        {
            widget.rect.x=widgetRect.x;

            if ( child.isExpanding ) {

                widgetRect.width = rectWidth;

                widgetRect.x = rect.x + this.margin.left;
                widget.rect.x = rect.x + this.margin.left;
            }


            if ( widgetRect.width > widget.maximumSize.width )
            {
                widget.rect.width=widget.maximumSize.width;
            } else widget.rect.width=widgetRect.width;

            if ( height > widget.maximumSize.height )
            {
                widget.rect.y+=(height - widget.maximumSize.height) / 2;
                widget.rect.height=widget.maximumSize.height;
            } else widget.rect.height=height;

            if ( widget.horizontalExpanding === false ) {
                if ( widgetSize.width < widgetRect.width )
                    widget.rect.width=widgetSize.width;
            }
        }

        widget.rect.round();

        if ( arguments.length === 1 )
            widget.paintWidget( canvas );

        // --- Minimum Size: Width

        if ( this.margin.left + this.margin.right + this.labelSpacing + labelRect.width + widget.minimumSize.width > this.minimumSize.width )
            this.minimumSize.width=this.margin.left + this.margin.right + this.labelSpacing + labelRect.width + widget.minimumSize.width;

        // ---

        y+=height + this.spacing;
        this.minimumSize.height+=widget.minimumSize.height + this.spacing;
    }

    canvas.popFont();
    canvas.popClipRect();

    if ( this.needsHScrollbar ) {
        this.setHScrollbarDimensions( canvas );
        this.hScrollbar.paintWidget( canvas );
    }

    if ( this.needsVScrollbar ) {
        this.setVScrollbarDimensions( canvas );
        this.vScrollbar.paintWidget( canvas );
    }
};

VG.UI.LabelLayout.prototype.setHScrollbarDimensions=function( canvas )
{
    this.hScrollbar.rect=VG.Core.Rect( this.contentRect.x + 1, this.contentRect.bottom(),
        this.contentRect.width - 2, VG.UI.stylePool.current.skin.ScrollBar.Size );

    this.hScrollbar.setScrollBarContentSize( this.size.width, this.contentRect.width-2 );
};

VG.UI.LabelLayout.prototype.setVScrollbarDimensions=function( canvas )
{
    this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right(), this.contentRect.y + 1,
        VG.UI.stylePool.current.skin.ScrollBar.Size, this.contentRect.height - 2 );

    this.vScrollbar.setScrollBarContentSize( this.size.height, this.contentRect.height );
};

/**
 * Arranges it's child objects stacked on top of each other. The <i>current</i> property defines the currently visible child object at the top of the stack. By default the first added child object
 * is currently visible.
 * Layouts can contain {@link VG.UI.Widget} based classes or other layouts.
 * @borrows VG.UI.Widget.disabled as VG.UI.Layout.disabled
 * @borrows VG.UI.Widget.visible as VG.UI.Layout.visible
 * @property {number} length - The number of child objects in this layout (read-only).
 * @property {object} current - The currently visible child object.
 * @constructor
 * @tutorial Layouts
 * @param {object} child - Optional, the  object to add to the layout.
 */

VG.UI.StackedLayout=function()
{
    if ( !(this instanceof VG.UI.StackedLayout) ) return VG.UI.StackedLayout.creator( arguments );

    VG.UI.Layout.call( this );
    this.name="StackedLayout";

    this._current=undefined;

    for( var i=0; i < arguments.length; ++i )
        this.addChild( arguments[i] );
};

VG.UI.StackedLayout.prototype=VG.UI.Layout();

Object.defineProperty( VG.UI.StackedLayout, "current",
{
    get: function() {
        return this._current;
    },
    set: function( current ) {
        this._current=current;

        for( var i=0; i < this.children.length; ++i )
        {
            var child=this.children[i];

            if ( child === current ) child.visible=true;
            else child.visible=false;
        }
    }
});

/**
 * Adds a child object to the layout.
 * @param {object} child - The child object to add to the layout.
 */

VG.UI.StackedLayout.prototype.addChild=function( child )
{
    VG.UI.Layout.prototype.addChild.call( this, child );

    if ( !this.current ) this.current=child;
};

VG.UI.StackedLayout.prototype.childAt=function( index )
{
    return this.children[index];
};

VG.UI.StackedLayout.prototype.calcSize=function( canvas )
{
    var size;
    if ( this.current ) {
        size=this.current.calcSize( canvas );

        this.minimumSize.set( this.current.minimumSize );

        if ( this.current.horizontalExpanding ) size.width=VG.UI.MaxLayoutSize;
        if ( this.current.verticalExpanding ) size.height=VG.UI.MaxLayoutSize;
        return size;
    } else {
        size=VG.Core.Size( 100, 100 );
        return size;
    }
};

VG.UI.StackedLayout.prototype.layout=function( canvas )
{
    // --- Adjust the rect of all children
    for( var i=0; i < this.children.length; ++i )
    {
        var child=this.children[i];

        child.rect.set( this.rect );

        if ( child === this.current ) {
            if ( !child._visible && child.aboutToShow ) child.aboutToShow();
            child.visible=true;
        } else child.visible=false;
    }

    // --- Layout the current item

    if ( this.current )
    {
        this.current.rect.set( this.rect );
        if ( this.current.isLayout )
            this.current.layout( canvas );
        else
            this.current.paintWidget( canvas );
    }
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.UI.TableWidgetSeparator

VG.UI.TableWidgetSeparator=function()
{
    if ( !(this instanceof VG.UI.TableWidgetSeparator )) return new VG.UI.TableWidgetSeparator();

    VG.UI.Widget.call( this );
    this.name="TableWidgetSeparator";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;
};

VG.UI.TableWidgetSeparator.prototype=VG.UI.Widget();

VG.UI.TableWidgetSeparator.prototype.calcSize=function()
{
    var size=VG.Core.Size( VG.UI.stylePool.current.skin.TableWidget.SeparatorWidth, 20 );
    return size;
};

VG.UI.TableWidgetSeparator.prototype.paintWidget=function( canvas )
{
    var size=this.calcSize( canvas );
    this.contentRect.set( this.rect );

    VG.UI.stylePool.current.drawTableWidgetSeparator( canvas, this );
};

VG.UI.TableWidgetColumn=function( binding, type )
{
    this.binding=binding;
    this.type=type;
};

// ----------------------------------------------------------------- VG.UI.TableWidgetHeaderItem

VG.UI.TableWidgetHeaderItem=function( text )
{
    if ( !(this instanceof VG.UI.TableWidgetHeaderItem )) return new VG.UI.TableWidgetHeaderItem( text );

    VG.UI.Widget.call( this );
    this.name="TableWidgetHeaderItem";

    this.text=text ? text : "";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;
};

VG.UI.TableWidgetHeaderItem.prototype=VG.UI.Widget();

VG.UI.TableWidgetHeaderItem.prototype.calcSize=function( canvas )
{
    var size=canvas.getTextSize( this.text );

    size.width+=10;
    size.height=canvas.getLineHeight();
    if ( size.height < canvas.style.skin.TableWidget.Header.MinHeight )
        size.height=canvas.style.skin.TableWidget.Header.MinHeight;

    this.checkSizeDimensionsMinMax( size );

    return size;
};

VG.UI.TableWidgetHeaderItem.prototype.paintWidget=function( canvas )
{
    this.font=canvas.style.skin.TableWidget.Font;
    canvas.pushFont(this.font);

    var textColor;

    if ( !this.disabled ) {
        if ( this.customColor ) textColor=this.customColor;
        else textColor=canvas.style.skin.Widget.TextColor;
    } else textColor=canvas.style.skin.Widget.DisabledTextColor;

    if ( this.embedded && this.embeddedSelection ) textColor=canvas.style.skin.Widget.EmbeddedTextColor;

    canvas.drawTextRect( this.text, this.rect.add( canvas.style.skin.TableWidget.Header.TextXOffset, 0, 0, 0 ), textColor, this.hAlignment, 1 );

    canvas.popFont();
};

// ----------------------------------------------------------------- VG.UI.TableWidget

VG.UI.TableWidget=function()
{
    if ( !(this instanceof VG.UI.TableWidget) ) return new VG.UI.TableWidget();

    VG.UI.Widget.call( this );
    this.name="TableWidget";

    this.offset=0;

    this.minimumSize.set( 100, 200 );
    this.supportsFocus=true;

    this.vScrollbar=0;
    this.needsVScrollbar=false;
    this.verified=false;

    this.headerLayout=VG.UI.Layout();
    this.headerLayout.spacing=0;
    this.headerLayout.margin.set( /*VG.context.workspace.canvas.style.skin.TableWidgetSeparatorWidth*/0, 0, 0, 0 );
    this.footerLayout=VG.UI.Layout();
    this.footerLayout.margin.set( 0, 0, 0, 0 );

    this.childWidgets=[];

    this.columns=[];

    this.textLineEdits=[];
    this.popupButtons=[];
    this.labels=[];

    this.spacing=VG.context.workspace.canvas.style.skin.TableWidget.Item.Spacing;
    this.itemHeight=VG.context.workspace.canvas.style.skin.TableWidget.RowHeight;
    this.textLineEditModulo=0;
    this.popupButtonModulo=0;

    this.frameType=VG.UI.Frame.Type.Box;

    // --- Setup Default Context Menu

    this.contextMenu=VG.UI.ContextMenu();

    this.addMenuItem=this.contextMenu.addItem( "Add", null, function() {
        if ( this.controller && this.controller.contentClassName ) this.controller.add();
    }.bind( this ));

    this.removeMenuItem=this.contextMenu.addItem( "Remove", null, function() {
        if ( this.controller && this.controller.canRemove() ) this.controller.remove( this.controller.selected );
    }.bind( this ));
};

VG.UI.TableWidget.prototype=VG.UI.Widget();

VG.UI.TableWidget.prototype.bind=function( collection, path )
{
    this.controller=collection.controllerForPath( path );
    if ( !this.controller ) {
        this.controller=VG.Controller.Array( collection, path );
        collection.addControllerForPath( this.controller, path );
    } else this.controller=this.controller.object;

    this.controller.addObserver( "changed", this.changed, this );
    this.controller.addObserver( "selectionChanged", this.selectionChanged, this );
    this.controller.addObserver( "parentSelectionChanged", this.parentSelectionChanged.bind( this ), this );

    this.collection=collection;
    this.path=path;

    return this.controller;
};

VG.UI.TableWidget.prototype.addTextLineEdit=function()
{
    var widget=new VG.UI.TextLineEdit();
    widget.parent=this;
    widget.embedded=true;

    this.textLineEdits.push( widget );

    return widget;
};

VG.UI.TableWidget.prototype.addPopupButton=function()
{
    var widget=new VG.UI.PopupButton();
    widget.parent=this;
    widget.embedded=true;

    this.popupButtons.push( widget );

    return widget;
};

VG.UI.TableWidget.prototype.addLabel=function()
{
    var widget=new VG.UI.Label( "" );
    widget.parent=this;
    widget.embedded=true;

    this.labels.push( widget );

    return widget;
};

VG.UI.TableWidget.prototype.changed=function( )
{
    //console.log( "TableWidget.changed" );
    this.parentSelectionChanged();
    this.verified=false;
    VG.update();
};

VG.UI.TableWidget.prototype.selectionChanged=function( )
{
    //console.log( "TableWidget.selectionChanged" );
    this.parentSelectionChanged();

    VG.update();
};

VG.UI.TableWidget.prototype.parentSelectionChanged=function( )
{
    //console.log( "TableWidget.parentSelectionChanged" );

    // --- Remvove all previous value bindings for this path

    var i, column;
    for ( i=0; i < this.columns.length; ++i )
    {
        column=this.columns[i];
        this.collection.removeAllValueBindingsForPath( this.controller.path + "." + column.binding );
    }

    // --- Assign an UI Widget for every row / col

    var textLineEditCounter=0, popupButtonCounter=0, labelCounter=0;

    for( var row=0; row < this.controller.length; ++row )
    {
        var item=this.controller.at( row );

        for ( i=0; i < this.columns.length; ++i )
        {
            column=this.columns[i];
            var widget;

            if ( column.type === VG.UI.TableWidgetItemType.TextLineEdit ) {
                if ( textLineEditCounter < this.textLineEdits.length )
                    widget=this.textLineEdits[textLineEditCounter];
                else widget=this.addTextLineEdit();
                ++textLineEditCounter;

                widget.text=item[column.binding];
                if ( column.defaultText ) widget.defaultText=column.defaultText;
            } else
            if ( column.type === VG.UI.TableWidgetItemType.PopupButton ) {
                if ( popupButtonCounter < this.popupButtons.length )
                    widget=this.popupButtons[popupButtonCounter];
                else widget=this.addPopupButton();
                ++popupButtonCounter;

                if ( widget.items.length === 0 && column.popupItems ) {
                    for( i=0; i < column.popupItems.length; ++i ) {
                        widget.addItem( column.popupItems[i] );
                    }
                }

                widget.index=item[column.binding];
            } else
            if ( column.type === VG.UI.TableWidgetItemType.Label ) {
                if ( labelCounter < this.labels.length )
                    widget=this.labels[labelCounter];
                else widget=this.addLabel();
                ++labelCounter;

                widget.hAlignment=VG.UI.HAlignment.Left;
                widget.text=item[column.binding];
            }

            widget.focusInCallback=this.childFocusedIn.bind( this );
            widget.__vgDataRep=item;

            if ( item === this.controller.selected ) {
                widget.bind( this.collection, this.controller.path + "." + column.binding );
            }
        }
    }

    this.verified=false;
};

VG.UI.TableWidget.prototype.addColumn=function( binding, text, type, expanding, minimumWidth )
{
    if ( this.headerLayout.children.length )
        this.headerLayout.addChild( VG.UI.TableWidgetSeparator() );

    var label=VG.UI.TableWidgetHeaderItem( text );
    var i;

    if ( expanding === undefined ) expanding=true;
    if ( minimumWidth ) label.minimumSize.width=minimumWidth;

    label.horizontalExpanding=expanding;
    label.hAlignment=VG.UI.HAlignment.Left;

    this.headerLayout.addChild( label );
    this.columns.push( new VG.UI.TableWidgetColumn( binding, type ) );

    if ( type === VG.UI.TableWidgetItemType.TextLineEdit )
    {
        this.textLineEditModulo=0;
        for( i=0; i < this.columns.length; ++i )
        {
            if ( this.columns[i].type === VG.UI.TableWidgetItemType.TextLineEdit )
                this.textLineEditModulo++;
        }
    } else
    if ( type === VG.UI.TableWidgetItemType.PopupButton )
    {
        this.popupButtonModulo=0;
        for( i=0; i < this.columns.length; ++i )
        {
            if ( this.columns[i].type === VG.UI.TableWidgetItemType.PopupButton )
                this.popupButtonModulo++;
        }
    } else
    if ( type === VG.UI.TableWidgetItemType.Label )
    {
        this.labelModulo=0;
        for( i=0; i < this.columns.length; ++i )
        {
            if ( this.columns[i].type === VG.UI.TableWidgetItemType.Label )
                this.labelModulo++;
        }
    }
};

VG.UI.TableWidget.prototype.setColumnPopupItems=function( colIndex )
{
    var column=this.columns[colIndex];

    column.popupItems=[];

    for( var i=1; i < arguments.length; ++i )
        column.popupItems.push( arguments[i] );
};

VG.UI.TableWidget.prototype.setColumnDefaultText=function( colIndex, text )
{
    var column=this.columns[colIndex];
    column.defaultText=text;
};

VG.UI.TableWidget.prototype.addButton=function( buttonText)
{
    var button=VG.UI.Button( buttonText );
    button.big=false;

    this.footerLayout.addChild( button );
    //this.layout.addChild( button );

    return button;
};

VG.UI.TableWidget.prototype.focusIn=function()
{
};

VG.UI.TableWidget.prototype.focusOut=function()
{
};

VG.UI.TableWidget.prototype.keyDown=function( keyCode )
{
    if ( !this.controller.selected ) return;

    var index=this.controller.indexOf( this.controller.selected );
    if ( index === -1 ) return;

    if ( keyCode === VG.Events.KeyCodes.ArrowUp && index > 0 )
    {
        if ( this.offset >= index ) {
            this.offset=index-1;
            this.vScrollbar.scrollTo( this.offset * this.itemHeight + (this.offset-1) * this.spacing );
        }
        this.controller.selected=this.controller.at( index - 1 );
    } else
    if ( keyCode === VG.Events.KeyCodes.ArrowDown && index < this.controller.length-1 )
    {
        if ( Math.floor( this.offset + this.visibleItems ) <= index +1 ) {
            this.offset=index+2-Math.floor(this.visibleItems);
            this.vScrollbar.scrollTo( this.offset * this.itemHeight + (this.offset-1) * this.spacing );
        }

        this.controller.selected=this.controller.at( index + 1 );
    }
};

VG.UI.TableWidget.prototype.mouseMove=function( event )
{
};

VG.UI.TableWidget.prototype.mouseDown=function( event )
{
    if ( this.needsVScrollbar && this.vScrollbar && this.vScrollbar.rect.contains( event.pos ) ) {
        this.vScrollbar.mouseDown( event );
        return;
    }

    if ( !this.rect.contains( event.pos ) ) return;

    var selected=this.offset + (event.pos.y - this.contentRect.y) / this.heightPerItem;
    var item=-1;

    if ( selected >=0 && selected < this.controller.length )
        item=this.controller.at( Math.floor( selected ) );

    if ( this.controller.multiSelection )
    {/*
        if ( ! (totalSelected) ) {
            item.selected=true;
            changed=true;
        } else {
        if ( item.selected == false ) {
            if ( ! ( event.keysDown.indexOf( VG.Events.KeyCodes.Shift ) >= 0 ) ) {
                this.deselectAll();
            }
            item.selected=true;
            changed=true;
        } else {
            if ( event.keysDown.indexOf( VG.Events.KeyCodes.Shift ) >= 0 ) {
                item.selected=false;
                changed=true;
            }
        }
        }*/
    } else {
        if ( item !== -1 && !this.controller.isSelected( item ) ) {
            this.controller.selected=item;
        }
    }
};

VG.UI.TableWidget.prototype.vHandleMoved=function( offsetInScrollbarSpace )
{
    var offset=offsetInScrollbarSpace * this.vScrollbar.totalSize / this.vScrollbar.visibleSize;
    var loopOffset=0;

    for ( var i=0; i < this.controller.length; ++i ) {
        var item=this.controller.at( i );

        loopOffset+=this.itemHeight + this.spacing;

        if ( loopOffset >= offset ) {
            this.offset=i;
            break;
        }
    }

    if ( this.offset > this.lastTopItem )
        this.offset=this.lastTopItem;
};

VG.UI.TableWidget.prototype.verifyScrollbar=function( text )
{
    // --- Check if we have enough vertical space for all items

    this.needsVScrollbar=false;

    this.totalItemHeight=this.controller.length * this.itemHeight + (this.controller.length-1) * this.spacing;
    this.heightPerItem=this.totalItemHeight / this.controller.length;
    this.visibleItems=this.contentRect.height / this.heightPerItem;
    this.lastTopItem=Math.ceil( this.controller.length - this.visibleItems );

    if ( this.totalItemHeight > this.contentRect.height )
        this.needsVScrollbar=true;

    if ( this.needsVScrollbar && !this.vScrollbar ) {
        this.vScrollbar=VG.UI.ScrollBar( "TableWidget Scrollbar" );
        this.vScrollbar.callbackObject=this;
        //this.layout.addChild( this.vScrollbar );
        this.childWidgets.push( this.vScrollbar );
    }

    this.verified=true;
};

VG.UI.TableWidget.prototype.paintWidget=function( canvas )
{
    this.spacing=VG.context.workspace.canvas.style.skin.TableWidget.Item.Spacing;
    this.itemHeight=VG.context.workspace.canvas.style.skin.TableWidget.RowHeight;

    var oldState=this.visualState, i, child;
    if ( this.visualState !== VG.UI.Widget.VisualState.Focus )
    {
        // --- If one of the childs has focus, draw a focus ring too
        for( i=0; i < this.childWidgets.length; ++i ) {
            if ( this.childWidgets[i].visualState === VG.UI.Widget.VisualState.Focus )
                this.visualState=VG.UI.Widget.VisualState.Focus;
        }
    }

    VG.UI.Frame.prototype.paintWidget.call( this, canvas );
    //canvas.style.drawGeneralBorder( canvas, this );
    this.visualState=oldState;

    this.childWidgets=[];

    this.contentRect.x+=canvas.style.skin.TableWidget.ContentMargin.left;
    this.contentRect.y+=canvas.style.skin.TableWidget.ContentMargin.top;
    this.contentRect.width-=canvas.style.skin.TableWidget.ContentMargin.left + canvas.style.skin.TableWidget.ContentMargin.right;
    this.contentRect.height-=canvas.style.skin.TableWidget.ContentMargin.top + canvas.style.skin.TableWidget.ContentMargin.bottom;

    //if ( this.needsVScrollbar )
        //this.contentRect.width-=canvas.style.skin.Scrollbar.Size + 4;

    // --- Header Layout

    canvas.pushFont( canvas.style.skin.TableWidget.Header.Font );

    for( i=0; i < this.headerLayout.children.length; ++i ) {
        child=this.headerLayout.children[i];
        child.disabled=this.disabled;
    }

    this.headerLayout.rect.set( this.contentRect );
    this.headerLayout.rect.height=canvas.style.skin.TableWidget.Header.Height;
    this.headerLayout.rect.round();

    canvas.style.drawTableWidgetHeaderBackground( canvas, this.headerLayout.rect );
    this.headerLayout.layout( canvas );

    canvas.style.drawTableWidgetHeaderSeparator( canvas, this );

    canvas.popFont();

    // --- Footer Layout

    this.contentRect.y+=this.headerLayout.rect.height + canvas.style.skin.TableWidget.Header.SeparatorHeight;
    this.contentRect.height-=this.headerLayout.rect.height + canvas.style.skin.TableWidget.Header.SeparatorHeight;

    if ( this.footerLayout.children.length )
    {
        // --- Footer Layout

        for( i=0; i < this.footerLayout.children.length; ++i ) {
            child=this.footerLayout.children[i];
            this.childWidgets.push( child );
        }

        this.footerLayout.rect.set( this.contentRect.x, this.contentRect.bottom() - canvas.style.skin.TableWidget.Footer.Height,
            this.contentRect.width, canvas.style.skin.TableWidget.Footer.Height );
        this.footerLayout.margin.set( canvas.style.skin.TableWidget.Footer.Margin );
        this.footerLayout.layout( canvas );

        canvas.style.drawTableWidgetFooterSeparator( canvas, this );

        this.contentRect.height-=this.footerLayout.rect.height + canvas.style.skin.TableWidget.Footer.SeparatorHeight;
    }

    // ---

    if ( !this.controller || !this.controller.length ) { return; }

    if ( !this.verified || canvas.hasBeenResized )
        this.verifyScrollbar();

    // --- Draw the Contents of it all ----------------------------

    canvas.pushFont( canvas.style.skin.TableWidget.Font );

    var paintRect=VG.Core.Rect( this.contentRect );
    paintRect.height=canvas.style.skin.TableWidget.RowHeight;

    var textLineEditCounter=this.offset * this.textLineEditModulo, popupButtonCounter=this.offset * this.popupButtonModulo, labelCounter=this.offset * this.labelModulo;
    this.visibleHeight=0;

    for( var row=this.offset; row < this.controller.length; ++row )
    {
        var item=this.controller.at( row );

        var rect=VG.Core.Rect( paintRect );
        rect.x=this.rect.x+1; rect.width=this.rect.width-2;

        if ( this.needsVScrollbar ) rect.width-=canvas.style.skin.ScrollBar.Size + 8 + canvas.style.skin.TableWidget.ContentMargin.right;

        canvas.style.drawTableWidgetRowBackground( canvas, this, rect, this.headerLayout, item === this.controller.selected );

        for ( i=0; i < this.columns.length; ++i )
        {
            var column=this.columns[i];
            var widget;

            if ( column.type === VG.UI.TableWidgetItemType.TextLineEdit ) {
                widget=this.textLineEdits[textLineEditCounter++];
            } else
            if ( column.type === VG.UI.TableWidgetItemType.PopupButton ) {
                widget=this.popupButtons[popupButtonCounter++];
            } else
            if ( column.type === VG.UI.TableWidgetItemType.Label ) {
                widget=this.labels[labelCounter++];
            }

            if ( widget === undefined ) break;

            widget.embeddedSelection=item === this.controller.selected;

            var widgetHeight=widget.calcSize( canvas ).height;

            widget.rect.x=this.headerLayout.children[i*2].rect.x;
            widget.rect.y=paintRect.y + ( paintRect.height - widgetHeight ) / 2;
            widget.rect.width=this.headerLayout.children[i*2].rect.width;
            widget.rect.height=widgetHeight;

            if ( column.type === VG.UI.TableWidgetItemType.Label ) {
                widget.rect.x+=canvas.style.skin.TableWidget.Header.TextXOffset;
                widget.rect.width-=canvas.style.skin.TableWidget.Header.TextXOffset;
            }

            if ( !i ) widget.rect.x+=canvas.style.skin.TableWidget.Item.XMargin;
            if ( i === this.columns.length - 1 ) {
                widget.rect.width-=2*canvas.style.skin.TableWidget.Item.XMargin;

                if ( this.needsVScrollbar )
                    widget.rect.width-=canvas.style.skin.ScrollBar.Size + 2;
            }

            widget.rect.round();
            widget.paintWidget( canvas );
            this.childWidgets.push( widget );
        }

        // ---

        paintRect.y+=this.itemHeight + this.spacing;
        this.visibleHeight+=this.itemHeight + this.spacing;

        if ( paintRect.bottom() > this.contentRect.bottom() )
            break;
    }

    // ---

    canvas.popFont();

    if ( this.needsVScrollbar ) {
        this.vScrollbar.rect=VG.Core.Rect( this.contentRect.right() - canvas.style.skin.ScrollBar.Size - 2, this.contentRect.y, canvas.style.skin.ScrollBar.Size, this.contentRect.height );

        // this.totalItemHeight == Total height of all Items in the list widget including spacing
        // visibleHeight == Total height of all currently visible items
        // this.contentRect.height == Height of the available area for the list items

        this.vScrollbar.setScrollBarContentSize( this.totalItemHeight, this.visibleHeight );
        this.vScrollbar.paintWidget( canvas );
    }
};

VG.UI.TableWidget.prototype.childFocusedIn=function( widget )
{
    //console.log( "childFocusedIn", widget );
    this.parentSelectionChanged();
    this.controller.selected=widget.__vgDataRep;
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**Creates an VG.UI.Window object.<br>
 *
 * Windows are standalone, well, windows, floating on the {@link VG.UI.Workspace} space. They are not part of any layout inside the Workspace. You can create, or derive, from a Window
 * and apply your own layout to the Window by setting its layout property. In contrast to VG.UI.Dialog, VG.UI.Window is not modal, i.e. you can still use other user interface
 * elements in the Workspace. <br>
 * Windows can be shown by calling {@link VG.UI.Workspace.showWindow}.
 * @param {string} title - The title of the Window
 * @constructor
 */

VG.UI.Window=function( title )
{
    if ( !(this instanceof VG.UI.Window) ) return new VG.UI.Window( title );

    VG.UI.Widget.call( this );

    this.supportsFocus=true;

    this.name="Window";
    this.text=title;

    /**The layout of the Window, default is null. You should set your own layout into this property and the Window will adjust its size to fit the layout.
     *  @member {object} */
    this.layout=null;

    this.dragOpStart=VG.Core.Point();
    this.dragOpPos=VG.Core.Point();

    this.dragOp=false;

    this.closeRect=VG.Core.Rect();
    this.supportsClose=true;

    this.childWidgets=[];
};

VG.UI.Window.prototype=VG.UI.Widget();

VG.UI.Window.prototype.dispose=function()
{
    if ( this.frameImage ) {
        this.frameImage.dispose();
        this.frameImage = undefined;
    }
};

VG.UI.Window.prototype.setFocus=function()
{
    /**Applies keyboard and mouse event focus to this Window.
     *
     **/

    VG.context.workspace.setFocus( this );
};

VG.UI.Window.prototype.calcSize=function( canvas )
{
    let size = this.preferredSize;

    if ( this.layout ) {
        let layoutSize = this.layout.calcSize( canvas );//VG.Core.Size( 0, 0 );
        size.width = layoutSize.width;

        if ( this.rounded ) size.height=VG.UI.stylePool.current.skin.RoundedWindow.HeaderHeight + layoutSize.height;
        else size.height=VG.UI.stylePool.current.skin.Window.HeaderHeight + layoutSize.height;

        this.rect.width = size.width;
        this.rect.height = size.height;
    }

    return size;
};

VG.UI.Window.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;

    if ( this.rounded )
        VG.UI.stylePool.current.drawRoundedWindow( this, canvas );
    else
        VG.UI.stylePool.current.drawWindow( this, canvas );

    if ( this.layout ) {

        if ( this.buttonLayout ) this.layout.rect.set( this.contentRect.add( 0, 0, 0, -this.buttonLayoutSize.height ) );
        else this.layout.rect.set( this.contentRect );
        this.layout.layout( canvas );
    }
};

VG.UI.Window.prototype.mouseMove=function( event )
{
    if ( this.dragOp ) {

        var offsetX=event.pos.x - this.dragOpStart.x;
        var offsetY=event.pos.y - this.dragOpStart.y;

        this.rect.x=this.dragOpPos.x + offsetX;
        this.rect.y=this.dragOpPos.y + offsetY;
        VG.update();
    }

    if ( this.closeRect.contains( event.pos ) )
    {
        if ( !this.insideCloseRect ) {
            VG.update();
            this.insideCloseRect=true;
        }
    } else if ( this.insideCloseRect )
    {
        VG.update();
        this.insideCloseRect=false;
    }
};

VG.UI.Window.prototype.mouseDown=function( event )
{
    if ( event.pos.y >= this.rect.y && event.pos.y <= (this.rect.y + VG.UI.stylePool.current.skin.Window.HeaderHeight ) ) {

        this.dragOp=true;
        this.dragOpStart.set( event.pos );
        this.dragOpPos.x=this.rect.x;
        this.dragOpPos.y=this.rect.y;

        VG.context.workspace.mouseTrackerWidget=this;
    }

    if ( this.closeRect.contains( event.pos ) )
        this.close( this );

    this.mouseIsDown=true;
};

VG.UI.Window.prototype.mouseUp=function( event )
{
    //this.mouseIsDown=false;

    this.dragOp=0;
    VG.context.workspace.mouseTrackerWidget=0;
};

/**Creates an VG.UI.Dialog object. VG.UI.Dialog inherits from VG.UI.Window.<br>
 *
 * Dialogs are modal Windows, i.e. other user interface elements in the Workspace will be disabled while a Dialog is visible. Dialogs support a button row at the bottom
 * of the Dialog. You can call addButton() and addButtonSpacer() to populate the Dialog with buttons.
 * Dialogs can be shown by calling {@link VG.UI.Workspace.showWindow}.
 * @param {string} title - The title of the Dialog
 * @constructor
 */

VG.UI.Dialog=function( title )
{
    if ( !(this instanceof VG.UI.Dialog) ) return new VG.UI.Dialog( title );

    VG.UI.Window.call( this );

    this.name="Dialog";
    this.text=title;

    /**The layout of the Dialog, default is null. You should set your own layout into this property and the Dialog will adjust its size to fit the layout.
     *  @member {object} */
    this.layout=null;

    this.buttonLayout=VG.UI.Layout();
    this.buttonLayout.horizontal=true;
    this.buttonLayout.spacing=10;
    this.buttonLayout.margin.set( 12, 12, 12, 12 );

    this.label=VG.UI.Label( "" );
    this.label.frameType=VG.UI.Frame.None;
    this.label.hAlignment=VG.UI.HAlignment.Left;
    this.label.minimumSize.width=200;
    this.label.horizontalExpanding=true;

    this.buttonLayout.addChild( this.label );

    this.minimumSize=VG.Core.Size( 200, 0 );
    this.maximumSize=VG.Core.Size( 800, 600 );

    this.buttonLayoutSize=VG.Core.Size();
};

VG.UI.Dialog.prototype=VG.UI.Window();

VG.UI.Dialog.prototype.calcSize=function( canvas )
{
    if ( this.layout )
    {
        //this.layout.margin.set( 15, 12, 15, 6 );
        this.layout.maximumSize.set( this.maximumSize.width, this.maximumSize.height );
    }

    let size=VG.UI.Window.prototype.calcSize.call( this, canvas );

    if ( this.buttonLayout ) {
        if ( this.buttonLayout.visible ) this.buttonLayoutSize.set( this.buttonLayout.calcSize( canvas ) );
        else this.buttonLayoutSize.set( 0, 0 );

        size.height += this.buttonLayoutSize.height;

        if ( this.buttonLayout.minimumSize.width > size.width ) size.width=this.buttonLayout.minimumSize.width;
    }

    this.checkSizeDimensionsMinMax( size );

    this.rect.width=size.width;
    this.rect.height=size.height;

    return size;
};

/**Adds a button to the Dialog. Buttons are added from the left to right. To close the window, the callback function of the button has to call this.close().
 * @param {string} text - The text of the button
 * @param {function} func - The callback function which gets invoked when the button is pressed. Make sure to call this.close() in the callback if you want to
 * close the Dialog
 */

VG.UI.Dialog.prototype.addButton=function( text, func )
{
    var button=VG.UI.Button( text );

    if ( func ) button.clicked=func;
    else button.clicked=function() { this.close( this ); }.bind( this );

    this.buttonLayout.addChild( button );
    return button;
};

/**Adds horizontal space to the button layout. If space is defined, it adds the value of space in pixels, otherwise the space is set to expanding, meaning
 * it will take as much space as available.
 * @param {number} space - The space to add to the button layout in pixels, if undefined, it will take as much space as available (expanding)
 */

VG.UI.Dialog.prototype.addButtonSpacer=function( space )
{
    var spacer=VG.UI.LayoutHSpacer();

    if ( space ) spacer.maximumSize.width=space;
    this.buttonLayout.addChild( spacer );
};

VG.UI.Dialog.prototype.setFocus=function()
{
    /**Sets the focus to the first widget in the layout which supports focus.
     **/

    var firstResponder=false;
    if ( this.layout && this.layout.children.length )
    {
        for ( var i=0; i < this.layout.children.length; ++i )
        {
            var child=this.layout.children[i];

            if ( child.isWidget && child.supportsFocus )
            {
                VG.context.workspace.setFocus( child );
                firstResponder=true;
                break;
            }
        }
    }

    if ( !firstResponder )
        VG.context.workspace.setFocus( this.layout );
};

VG.UI.Dialog.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;

    this.rect.round();
    VG.UI.stylePool.current.drawWindow( this, canvas );

    //VG.context.style.drawWindowTitleCloseButton( canvas, this, this.closeButtonState, this.closeButtonRect );

    if ( this.layout ) {

        if ( this.buttonLayout ) this.layout.rect.set( this.contentRect.add( 0, 0, 0, -this.buttonLayoutSize.height ) );
        else this.layout.rect.set( this.contentRect );
        this.layout.layout( canvas );
    }

    if ( this.buttonLayout ) {
        this.buttonLayout.rect.set( this.contentRect );
        this.buttonLayout.rect.y=this.contentRect.bottom() - this.buttonLayoutSize.height;
        this.buttonLayout.rect.height=this.buttonLayoutSize.height;

        this.buttonLayout.layout( canvas );
    }
};

/**Creates an VG.UI.StatusDialog object. VG.UI.StatusDialog inherits from {@link VG.UI.Dialog}.<br>
 *
 * Shows an Dialog with a status icon and a user defined message and title. Adds a "Close" button to the Dialog by default.
 * @param {VG.UI.StatusDialog.Type} type - The status icon to show, currently supported are VG.UI.StatusDialog.Type.Error, VG.UI.StatusDialog.Type.Warning and
 * VG.UI.StatusDialog.Type.Question.
 * @param {string} title - The title of the status dialog.
 * @param {string} message - The user message to show to the user. Can be multine text.
 * @constructor
 */

VG.UI.StatusDialog=function( type, title, message )
{
    if ( !(this instanceof VG.UI.StatusDialog) ) return new VG.UI.StatusDialog( type, title, message );

    VG.UI.Dialog.call( this );

    this.text=title;
    this.image=VG.UI.Image();

    var imageName="status_success.png";

    if ( type === VG.UI.StatusDialog.Type.Error ) imageName="status_error.png";
    else
    if ( type === VG.UI.StatusDialog.Type.Warning ) imageName="status_warning.png";
    else
    if ( type === VG.UI.StatusDialog.Type.Question ) imageName="status_question.png";

    this.image.image=VG.Utils.getImageByName( imageName );
    this.image.horizontalExpanding=false;
    this.image.verticalExpanding=false;

    this.label=VG.UI.Label( message );
    this.label.hAlignment=VG.UI.HAlignment.Left;

    this.layout=VG.UI.Layout( this.image, this.label );
    this.layout.spacing=40;
    this.layout.margin.left=20;
    this.layout.margin.right=20;

    // this.addButton( "Close" );

    this.type=type;
    this.message=message;
};

VG.UI.StatusDialog.prototype=VG.UI.Dialog();

/** The supported types for {@link VG.UI.StatusDialog}.
 * @enum
 */

VG.UI.StatusDialog.Type={ "Success" : 0, "Error" : 1, "Warning" : 2, "Question" : 3 };

/**Creates an VG.UI.ProgressDialog object. VG.UI.ProgressDialog inherits from {@link VG.UI.Dialog}.<br>
 *
 * @constructor
 */

VG.UI.ProgressDialog=function( message, progress, title )
{
    if ( !(this instanceof VG.UI.ProgressDialog) ) return new VG.UI.ProgressDialog( message, progress, title );

    VG.UI.Dialog.call( this );

    this.text=title ? title : "Progress Dialog";

    this.label=VG.UI.Label( message );
    this.label.hAlignment=VG.UI.HAlignment.Left;

    this.layout=VG.UI.Layout( this.label );
    this.layout.spacing=40;
    this.layout.margin.left=20;
    this.layout.margin.right=20;

    this.supportsClose=false;
};

VG.UI.ProgressDialog.prototype=VG.UI.Dialog();

VG.UI.ProgressDialog.prototype.setStatus=function( message, progress )
{
    this.label.text=message;
};
/*
 * Copyright (c) 2014-2018 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**Creates an VG.UI.DockWidget.<br>
 * Dock widgets can be added to the left or right side of an {@link VG.UI.Workspace} and can contain a list of vertically stacked Widgets or Layouts. Dock Widgets can be resized. Use
 * addItem() and addItems() to add items to the Dock widget.
 * @param {string} title - The title of the Dock Widget.
 * @constructor
 */

VG.UI.DockWidget=function( text )
{
    if ( !(this instanceof VG.UI.DockWidget) ) return new VG.UI.DockWidget( text );

    VG.UI.Widget.call( this );
    this.name="DockWidget";
    this.text=text === undefined ? "" : text;

    this.layout=VG.UI.Layout();
    this.layout.vertical=true;
    this.layout.margin.set( 0, 0, 0, 0 );
    this.layout.spacing=0;
    this.supportsFocus=true;

    this.dragOpStart=VG.Core.Point();
    this.dragOpPos=VG.Core.Point();

    for( let i = 1; i < arguments.length; ++i )
        this.addChild( arguments[i] );

    this.dragOp=false;
};

VG.UI.DockWidget.prototype=VG.UI.Widget();

VG.UI.DockWidget.prototype.mouseMove=function( event )
{
    if ( !this.dragOp ) return;

    this.dragOpMoved=true;

    if ( this.location < VG.UI.DockWidgetLocation.Floating )
    {
        var offset=Math.abs( event.pos.x - this.dragOpStart.x );

        if ( offset > 10 ) {
            VG.context.workspace.detachDockWidget( this );
            VG.update();
        }
    } else
    {
        var offsetX=event.pos.x - this.dragOpStart.x;
        var offsetY=event.pos.y - this.dragOpStart.y;

        this.rect.x=this.dragOpPos.x + offsetX;
        this.rect.y=this.dragOpPos.y + offsetY;
        VG.update();
    }
};

VG.UI.DockWidget.prototype.mouseDown=function( event )
{
    if ( event.pos.y >= this.rect.y && event.pos.y <= ( this.rect.y + VG.UI.stylePool.current.skin.DockWidget.HeaderHeight ) )
    {
        this.dragOp=true;
        this.dragOpMoved=false;
        this.dragOpStart.set( event.pos );
        this.dragOpPos.x=this.rect.x;
        this.dragOpPos.y=this.rect.y;

        VG.context.workspace.mouseTrackerWidget=this;
        VG.update();
    }
};

VG.UI.DockWidget.prototype.mouseUp=function( event )
{
    VG.context.workspace.mouseTrackerWidget=0;

    if ( this.dragOp && this.dragOpMoved && this.location === VG.UI.DockWidgetLocation.Floating ) {
        VG.context.workspace.possiblyAttachDockWidget( this );
    }

    this.dragOp=false;
    VG.update();
};

VG.UI.DockWidget.prototype.mouseDoubleClick=function( event )
{
    this.dragOp=false;

    if ( this.rect.contains( event.pos ) )
    {
/*
        if ( this.location < VG.UI.DockWidgetLocation.Floating )
        {
            this.rect.x+=10;
            this.rect.y+=10;
            VG.context.workspace.detachDockWidget( this );
        } else
        {
            VG.context.workspace.possiblyAttachDockWidget( this, true );
        }
*/
    }
};

VG.UI.DockWidget.prototype.calcSize=function( canvas )
{
    var size=this.layout.calcSize( canvas );
    this.minimumSize.set( this.layout.minimumSize );
    return size;
};

/**Adds an item, either a Widget or a Layout, to the Dock widget.
 * @param {widget} widget - Widget or layout to add
 */

VG.UI.DockWidget.prototype.addItem=function( item )
{
    this.layout.addChild( item );
};

/**Adds a list of items, either a Widget or a Layout, to the Dock widget.
 * @param {widget} widgets - Widget or layout to add
 * @param {widget} ...
 */

VG.UI.DockWidget.prototype.addItems=function( item )
{
    for( var i=0; i < arguments.length; ++i )
        this.layout.addChild( arguments[i] );
};

/**Adds an item, either a Widget or a Layout, to the Dock widget.
 * @param {widget} widget - Widget or layout to add
 */

VG.UI.DockWidget.prototype.addChild=function( item )
{
    this.layout.addChild( item );
};

/**Adds a list of items, either a Widget or a Layout, to the Dock widget.
 * @param {widget} widgets - Widget or layout to add
 * @param {widget} ...
 */

VG.UI.DockWidget.prototype.addChildren=function( item )
{
    for( var i=0; i < arguments.length; ++i )
        this.layout.addChild( arguments[i] );
};

VG.UI.DockWidget.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawDockWidget( this, canvas );

    this.layout.rect.set( this.contentRect );
    this.layout.layout( canvas );

    this.minimumSize.set( this.layout.minimumSize );
};

/**Creates a VG.UI.SectionBar.<br>
 * SectionBars can be added to the left or right side of an {@link VG.UI.Workspace} and can contain a list of vertically stacked VG.UI.SectionBarButtons. SectionBars cannot be resized. Use
 * addItem() and addItems() to add items to the SectionBar.
 * @constructor
 */

VG.UI.SectionBar=function( text )
{
    if ( !(this instanceof VG.UI.SectionBar) ) return new VG.UI.SectionBar( text );

    VG.UI.DockWidget.call( this );
    this.name="SectionBar";

    this.text=text ? text : "";

    this.layout.margin.set( 9, 7, 9, 9 );
    this.layout.spacing=6;

    this.horizontalExpanding=false;
    this.verticalExpanding=true;

    this.activeButton=null;
};

VG.UI.SectionBar.prototype=VG.UI.DockWidget();

VG.UI.SectionBar.prototype.calcSize=function( canvas )
{
    var size=this.layout.calcSize( canvas );
    this.minimumSize.width=size.width;
    this.maximumSize.width=size.width;
    return size;
};

VG.UI.SectionBar.prototype.mouseMove=function( event )
{
};

VG.UI.SectionBar.prototype.mouseDown=function( event )
{
};

VG.UI.SectionBar.prototype.mouseUp=function( event )
{
};

/**Adds an VG.UI.SectionBarButton to the SectionBar.
 * @param {VG.UI.SectionBarButton} button - Button to add to the SectionBar
 */

VG.UI.SectionBar.prototype.addItem=function( item )
{
    this.layout.addChild( item );

    if ( item instanceof VG.UI.SectionBarButton ) {
        item.stripCallback=this.stripButtonSelectionCallback.bind( this );
        item.stripWidget=this;
        if ( !this.activeButton ) this.activeButton=item;
    }
};

/**Adds a Button to the SectionBar.
 * @param {string} text - The text of the button to add.
 */

VG.UI.SectionBar.prototype.addButton=function( text )
{
    var button=VG.UI.SectionBarButton( text );
    this.addItem( button );
    return button;
};

/**Adds a SwitchButton to the SectionBar.
 * @param {string} text - The text of the button to add.
 */

VG.UI.SectionBar.prototype.addSwitch=function( text1, text2 )
{
    var switchButton=VG.UI.SectionBarSwitch( text1, text2 );
    this.addItem( switchButton );
    return switchButton;
};

/**Adds a separator to the SectionBar.
 * @param {string} text - The text of the button to add.
 */

VG.UI.SectionBar.prototype.addSeparator=function( text )
{
    var sep=VG.UI.SectionBarSeparator();
    this.addItem( sep );
    return sep;
};

/**Adds a list of items to the SectionBar.
 * @param {VG.UI.SectionBarButton} button - Button to add to the SectionBar
 * @param {VG.UI.SectionBarSeparator} ...
 */

VG.UI.SectionBar.prototype.addItems=function( item )
{
    for( var i=0; i < arguments.length; ++i )
        this.addItem( arguments[i] );
};

VG.UI.SectionBar.prototype.stripButtonSelectionCallback=function( button )
{
    for( var i=0; i < this.layout.children.length; ++i )
    {
        var widget=this.layout.children[i];

        if ( widget instanceof VG.UI.SectionBarButton )
        {
            if ( widget === button ) widget.selected=true;
            else widget.selected=false;
        }
    }

    if ( this.selectionChanged ) this.selectionChanged( button );
};

VG.UI.SectionBar.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawSectionBar( this, canvas );

    this.layout.rect.set( this.contentRect );
    this.layout.layout( canvas );
};

/**Creates an VG.UI.SectionBarButton.<br>
 * DockStripButtons can be added to VG.UI.SectionBars. They contain either text or images.
 * @param {string} text - The text of the button.
 * @constructor
 */

VG.UI.SectionBarButton=function( text )
{
    if ( !(this instanceof VG.UI.SectionBarButton) ) return new VG.UI.SectionBarButton( text );
    this.text=arguments[0];

    if ( text.indexOf( "\n" ) !== -1 )
    {
        this.textArray=text.split( "\n" );
    }

    VG.UI.Widget.call( this );
    this.name="SectionBarButton";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    this.minimumSize.width=VG.UI.stylePool.current.skin.SectionBarButton.Size.Width;
};

VG.UI.SectionBarButton.prototype=VG.UI.Widget();

VG.UI.SectionBarButton.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    size.width=VG.UI.stylePool.current.skin.SectionBarButton.Size.width;
    size.height=VG.UI.stylePool.current.skin.SectionBarButton.Size.height;

    this.minimumSize.width=size.width;
    this.minimumSize.height=size.height;

    return size;
};

VG.UI.SectionBarButton.prototype.mouseDown=function( event )
{
    this.mouseIsDown=true;

    //if ( this.stripCallback ) this.stripCallback( this );
    //if ( this.clicked ) this.clicked( this );
    this.stripWidget.activeButton=this;
};

VG.UI.SectionBarButton.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.SectionBarButton.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawSectionBarButton( this, canvas );
};

// ----------------------------------------------------------------- VG.UI.SectionBarSwitch

VG.UI.SectionBarSwitch=function( text1, text2 )
{
    if ( !(this instanceof VG.UI.SectionBarSwitch) ) return new VG.UI.SectionBarSwitch( text1, text2 );
    this.text=arguments[0];

    VG.UI.Widget.call( this );
    this.name="SectionBarSwitch";

    this.text1=text1;
    this.text2=text2;

    this.horizontalExpanding=false;
    this.verticalExpanding=false;
    this.left=true;

    this.customClick=true;
    this.leftRect=VG.Core.Rect();
    this.rightRect=VG.Core.Rect();

    this.minimumSize.width=VG.UI.stylePool.current.skin.SectionBarSwitch.Size.Width;
};

VG.UI.SectionBarSwitch.prototype=VG.UI.Widget();

VG.UI.SectionBarSwitch.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    size.width=VG.UI.stylePool.current.skin.SectionBarSwitch.Size.width;
    size.height=VG.UI.stylePool.current.skin.SectionBarSwitch.Size.height;

    this.minimumSize.width=size.width;
    this.minimumSize.height=size.height;

    return size;
};

VG.UI.SectionBarSwitch.prototype.mouseDown=function( event )
{
    this.mouseIsDown=true;

    if ( this.leftRect.contains( event.pos ) )
        this.left=true;
    else
    if ( this.rightRect.contains( event.pos ) )
        this.left=false;
    else return;

    if ( this.clicked ) this.clicked( this.left );
    VG.update();
};

VG.UI.SectionBarSwitch.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.SectionBarSwitch.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawSectionBarSwitch( this, canvas );
};


/**Creates an VG.UI.SectionBarSeparator.<br>
 * A SectionBarSeparator can be added to VG.UI.SectionBar and draws a horizontal separator line.
 * @constructor
 */

VG.UI.SectionBarSeparator=function()
{
    if ( !(this instanceof VG.UI.SectionBarSeparator )) return new VG.UI.SectionBarSeparator();

    VG.UI.Widget.call( this );
    this.name="SectionBarSeparator";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;
};

VG.UI.SectionBarSeparator.prototype=VG.UI.Widget();

VG.UI.SectionBarSeparator.prototype.calcSize=function()
{
    var size=VG.Core.Size( 81, VG.UI.stylePool.current.skin.SectionBar.Separator.Height );
    return size;
};

VG.UI.SectionBarSeparator.prototype.paintWidget=function( canvas )
{
    var size=this.calcSize();
    this.contentRect.set( this.rect );

    if ( VG.UI.stylePool.current.skin.SectionBar.Separator.Height === 1 ) {
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, VG.Core.Rect( this.rect.x, this.rect.y, this.rect.width, 1 ), VG.UI.stylePool.current.skin.SectionBar.Separator.Color1 );
    } else
    {
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, VG.Core.Rect( this.rect.x, this.rect.y, this.rect.width, 1 ), VG.UI.stylePool.current.skin.SectionBar.Separator.Color1 );
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, VG.Core.Rect( this.rect.x, this.rect.y+1, this.rect.width, 1 ), VG.UI.stylePool.current.skin.SectionBar.Separator.Color2 );
    }
};

/**Creates a VG.UI.SectionToolBar.<br>
 * SectionToolBars can be added to the left or right side of an {@link VG.UI.Workspace} and can contain a list of vertically stacked {@link VG.UI.SectionToolBarButton}s which are grouped into sections.
 * SectionToolBars cannot be resized.
 * @constructor
 */

VG.UI.SectionToolBar=function( text )
{
    if ( !(this instanceof VG.UI.SectionToolBar) ) return new VG.UI.SectionToolBar( text );

    VG.UI.DockWidget.call( this );
    this.name="SectionToolBar";

    this.text=text ? text : "";

    this.layout.margin.set( 9, 7, 9, 0 );
    // this.layout.margin.set( 0, 0, 0, 0 );
    this.layout.spacing=6;

    this.horizontalExpanding=false;
    this.verticalExpanding=true;

    this.activeButton=null;
    this.childWidgets=[];
};

VG.UI.SectionToolBar.prototype=VG.UI.DockWidget();

VG.UI.SectionToolBar.prototype.calcSize=function( canvas )
{
    var size=this.preferredSize;

    size.width = this.small ? 44 : 54;
    size.height=VG.UI.MaxLayoutSize;

    this.minimumSize.width = size.width;
    this.maximumSize.width = size.width;
    return size;
};

VG.UI.SectionToolBar.prototype.mouseMove=function( event )
{
};

VG.UI.SectionToolBar.prototype.mouseDown=function( event )
{
};

VG.UI.SectionToolBar.prototype.mouseUp=function( event )
{
};

/**Adds a new section to the to the SectionToolBar.
 * @param {string} text - The text of the section to add
 * @returns {VG.UI.Layout}
 */

VG.UI.SectionToolBar.prototype.addSection=function( text )
{
    var layout=VG.UI.Layout();
    layout.vertical=true;
    layout.margin.clear();
    layout.spacing=1;
    layout.text=text;

    this.layout.addChild( layout );
    return layout;
};

/**Adds an VG.UI.SectionToolBarButton to the given section.
 * @param {VG.UI.Layout} section - The section to add thew new button to.
 * @param {string} iconName - Name of the icon to add to the section.
 * @returns {VG.UI.SectionToolBarButton}
 */

VG.UI.SectionToolBar.prototype.addButton=function( section, iconName )
{
    var button=VG.UI.SectionToolBarButton( iconName );
    button.small = this.small;
    section.addChild( button );

    if ( button instanceof VG.UI.SectionToolBarButton ) {
        button.sectionBarCallback=this.buttonSelectionCallback.bind( this );
        button.sectionBarWidget=this;
        if ( !this.activeButton ) this.activeButton=button;
    }

    this.childWidgets.push( button );

    return button;
};

/**Adds an VG.UI.SectionToolBarButton to the given section.
 * @param {VG.UI.Layout} section - The section to add thew new button to.
 * @param {string} group - Name of the svg group.
 * @param {string} name- Name of the svg.
 * @returns {VG.UI.SectionToolBarButton}
 */

VG.UI.SectionToolBar.prototype.addSVGButton=function( section, group, name )
{
    var button=VG.UI.SectionToolBarButton( group, name );
    button.small = this.small;
    section.addChild( button );

    if ( button instanceof VG.UI.SectionToolBarButton ) {
        button.sectionBarCallback=this.buttonSelectionCallback.bind( this );
        button.sectionBarWidget=this;
        if ( !this.activeButton ) this.activeButton=button;
    }

    this.childWidgets.push( button );

    return button;
};

VG.UI.SectionToolBar.prototype.buttonSelectionCallback=function( button )
{
    for( var i=0; i < this.layout.children.length; ++i )
    {
        var widget=this.layout.children[i];

        if ( widget instanceof VG.UI.SectionToolBarButton )
        {
            if ( widget === button ) widget.selected=true;
            else widget.selected=false;
        }
    }

    if ( this.selectionChanged ) this.selectionChanged( button );
};

VG.UI.SectionToolBar.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawSectionToolBar( this, canvas );

    //this.layout.rect.set( this.contentRect );
    //this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.SectionToolBarButton

VG.UI.SectionToolBarButton=function( iconName, svgGroupName )
{
    if ( !(this instanceof VG.UI.SectionToolBarButton) ) return new VG.UI.SectionToolBarButton( iconName, svgGroupName );

    VG.UI.Widget.call( this );
    this.name="SectionToolBarButton";

    this.horizontalExpanding=false;
    this.verticalExpanding=false;

    if ( svgGroupName === undefined || typeof svgGroupName == 'number' ) {
        if ( !iconName.includes( ".svg" ) )
            this.iconName=iconName;
        else {
            let size = 24;
            if ( typeof svgGroupName == 'number' ) size = svgGroupName;
            VG.Utils.svgToImage( { data : VG.Utils.getTextByName( iconName ), width : size, height : size, callback : function( image ) {
                this.image = image;
            }.bind( this ) } );
        }
    }
    else
    {
        this.svgName=iconName;
        this.svgGroupName=svgGroupName;
    }

    this.minimumSize.width = this.small ? VG.UI.stylePool.current.skin.SectionToolBarButton.SmallSize.width : VG.UI.stylePool.current.skin.SectionToolBarButton.Size.width;
};

VG.UI.SectionToolBarButton.prototype=VG.UI.Widget();

VG.UI.SectionToolBarButton.prototype.calcSize=function( canvas )
{
    var size = this.preferredSize;

    size.width = this.small ? VG.UI.stylePool.current.skin.SectionToolBarButton.SmallSize.width : VG.UI.stylePool.current.skin.SectionToolBarButton.Size.width;
    size.height = this.small ? VG.UI.stylePool.current.skin.SectionToolBarButton.SmallSize.height : VG.UI.stylePool.current.skin.SectionToolBarButton.Size.height;

    this.minimumSize.width = size.width;
    this.minimumSize.height = size.height;

    return size;
};

VG.UI.SectionToolBarButton.prototype.mouseDown=function( event )
{
    this.mouseIsDown=true;

    if ( this.disabled )
        return;

    if ( this.sectionBarCallback ) this.sectionBarCallback( this );
    if ( this.clicked ) this.clicked( this );
    this.sectionBarWidget.activeButton=this;
};

VG.UI.SectionToolBarButton.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
};

VG.UI.SectionToolBarButton.prototype.paintWidget=function( canvas )
{
    VG.UI.stylePool.current.drawSectionToolBarButton( this, canvas );
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Creates an VG.UI.Workspace class.<br>
 * VG.UI.Workspace represents the visual workspace of every VG application or game. Before your application gets started, a VG.UI.Workspace object will be created
 * and passed as the first argument to vgMain().
 *
 * <br>VG.context is the context of your application and set as "this" for vgMain(). A reference to the application Workspace is set in
 * VG.context.workspace.
 *
 * @constructor
 * @tutorial Workspace
 */

VG.UI.Workspace=function()
{
    if ( !(this instanceof VG.UI.Workspace) ) return new VG.UI.Workspace();

    VG.UI.Widget.call( this );

    this.name="Workspace";
    this.focusWidget=0;

    /** Holds the content of the Workspace and has to be set within vgMain() to either a VG.UI.Widget derived object or one of the Layout objects. This object will fill the
     * available space of the Workspace and is the root object for all display widgets.
     *  @member {object} */
    this.content=0;

    this.needsRedraw=true;
    this.redrawList=[];

    /** The {@link VG.Canvas} for the Workspace, used for all drawing operations.
     *  @member {VG.Canvas} */
    this.canvas=VG.Canvas();
    this.canvas.style=VG.UI.stylePool.current;

    this.shortcutManager=VG.Shortcut.Manager();

    this.mouseTrackerWidget=null;
    this.mousePos=VG.Core.Point();

    this.keysDown=[];

    this.filePath=undefined;

    this.menubars=[];
    this.toolbars=[];
    this.windows=[];
    this.widgets3d=[];

    /** Set this member to an {@link VG.UI.StatusBar} object if your application should have a status bar at the bottom of the screen.
     * @member {VG.UI.StatusBar}
     */
    this.statusBar=null;
    this.layout=VG.UI.SplitLayout();
    this.layout.name = "MainLayout";
    this.layout.margin.set( 0, 0, 0, 0 );

    this.loginButton=VG.UI.ToolBarButton( "Login" );
    this.signupButton=VG.UI.ToolBarButton( "Signup" );
    this.loginButton.clicked=this.showUserDialog.bind( this );

    this.loginDialog=null;
    this.userName="";
    this.userId=undefined;
    this.userIsAdmin=false;

    this.modelToolButtonRoles=[];
    this.modelMenuItemRoles=[];

    this.dataCollectionForLoadSave=null;
    this.dataCollectionForUndoRedo=null;

    this.undo=null;

    this.platform=VG.getHostProperty( VG.HostProperty.Platform );
    this.operatingSystem=VG.getHostProperty( VG.HostProperty.OperatingSystem );

    this.textClipboard="";
    this.nodesClipboard="";
    this.imageClipboard=undefined;

    this.singleShotCallbacks=[];
    this.aboutToSaveCallbacks=[];

    // --- Force a redraw every 2000ms
    this.autoRedrawInterval=2000;
    this.maxRedrawInterval=0;//1000/60;

    this.overlayWidgets = [];
    this.eventHandlers = [];

    // --- Current Project Info

    this.projectName="Untitled";
    this.projectExtension=undefined;

    this.activeDOMWidgets = [];

    // --- Send an isLoggedIn request to the server to check if we are logged in or not.

    VG.sendBackendRequest( "/user/isLoggedIn", "", function( responseText ) {
        if ( !responseText ) return;
        //VG.log( responseText )
        var response=JSON.parse( responseText );

        if ( response.status === "ok" && response.loggedIn === true )
        {
            this.userName=response.username;
            this.userId=response.userid;
            this.userIsAdmin=response.isAdmin;

            this.modelLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );

            if ( this.callbackForLoggedStateChanged )
                this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );
            VG.update();
        } else {
            // --- Not logged in, try to get the appId of the current application
            if ( !this.appId ) {
                VG.DB.getAppId( function( appId ) {
                    this.appId=appId;
                }.bind( this ) );
            }
        }
    }.bind(this), "GET" );

    // --- Default Events

    this.mainMoveEvent=VG.Events.MouseMoveEvent();

    // ---

    this.toolTipWidget=VG.UI.ToolTipWidget();

    // --- Adjust the CSS Background Color to the StatusBar if running on the Web

    if ( VG.getHostProperty( VG.HostProperty.Platform ) === VG.HostProperty.PlatformWeb ) {
        var canvas=document.getElementById( 'webgl' );
        var body=document.body;

        body.style["background-color"]=this.canvas.style.skin.StatusBar.BackColor.toHex();
    }

    // --- CmdCtrl Shortcut depending on platform

    if ( this.operatingSystem === VG.HostProperty.OSMac )
        VG.Events.KeyCodes.CmdCtrl=VG.Events.KeyCodes.AppleLeft;
    else VG.Events.KeyCodes.CmdCtrl=VG.Events.KeyCodes.Ctrl;

    // --- Electron Events

    if ( this.isElectron() ) {
        const ipc = require('electron').ipcRenderer;

        ipc.on( 'workspace-open', ( event ) => {
            this.modelOpenCallback_electron();
        });
        ipc.on( 'workspace-save', ( event ) => {
            this.modelSaveCallback();
        });
        ipc.on( 'workspace-saveas', ( event ) => {
            this.modelSaveAsCallback_electron();
        });

        ipc.on( 'workspace-undo', ( event ) => {
            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.undo();
            VG.update();
        });
        ipc.on( 'workspace-redo', ( event ) => {
            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.redo();
            VG.update();
        });
    }
};

VG.UI.Workspace.prototype=VG.UI.Widget();

Object.defineProperty( VG.UI.Workspace.prototype, "content",
{
    get: function() {
        return this._content;
    },
    set: function( content ) {
        if ( this.layout ) {
            this._content=content;

            var insertAt=0;
            for( var i=0; i < this.layout.children.length; ++i )
            {
                var widget=this.layout.children[i];
                if ( widget instanceof VG.UI.DockWidget ) {
                    if ( widget.location === VG.UI.DockWidgetLocation.Left ) {
                        insertAt++;
                    } else break;
                } else break;
            }

            this.layout.insertChild( insertAt, content, 100 );

            //this.layout.addChild( content, 100 );
            this.recalcLayoutPercentages();
        }
    }
});

Object.defineProperty( VG.UI.Workspace.prototype, "projectName",
{
    get: function() {
        return this._projectName;
    },
    set: function( projectName ) {
        this._projectName = projectName;
        if ( this.isElectron() ) {
            const win = require('electron').remote.getCurrentWindow();
            win.setTitle( projectName );
        }
    }
});

VG.UI.Workspace.prototype.resize=function( width, height )
{
    this.rect.setSize( width, height );
    this.contentRect.set( this.rect );

    VG.context.workspace.needsRedraw=true;
    VG.context.workspace.canvas.hasBeenResized=true;

    VG.Renderer().onResize( width, height );
};

/**
 * Adds a Dock widget to the Workspace.
 * @param {VG.UI.DockWidget} widget - The DockWidget to add to the Workspace
 * @param {VG.UI.DockWidgetLocation} location - Currently limited to VG.UI.DockWidgetLocation.Left and VG.UI.DockWidgetLocation.Right.
 * @param {number} percent - Optional, the width this dock widget should cover in percent, default is 20.
 */

VG.UI.Workspace.prototype.addDockWidget=function( dockWidget, location, percent )
{
    if ( !location ) location=VG.UI.DockWidgetLocation.Left;

    if ( !percent )
        percent=dockWidget._oldPercent ? dockWidget._oldPercent : 20;

    var contentIndex=this.layout.children.indexOf( this._content );
    if ( contentIndex > -1 ) {
        if ( location === VG.UI.DockWidgetLocation.Left || location === "Left" ) {
            this.layout.insertChild( contentIndex, dockWidget, percent );
        } else
        if ( location === VG.UI.DockWidgetLocation.Right || location === "Right" ) {
            this.layout.insertChild( contentIndex+1, dockWidget, percent, "Right" );
        }
    } else this.layout.addChild( dockWidget, percent );

    if ( location === VG.UI.DockWidgetLocation.Right || location === "Right" )
        dockWidget.__rightDock = true;

    dockWidget.location=location;
    this.recalcLayoutPercentages();
};

/**
 * Removes the given dock widget from the Workspace.
 * @param {VG.UI.DockWidget} widget - The DockWidget to remove from the Workspace.
 */

VG.UI.Workspace.prototype.removeDockWidget=function( dockWidget )
{
    this.layout.removeChild( dockWidget );
};

/**
 * Detaches a Dock widget from the Workspace.
 * @param {VG.UI.DockWidget} widget - The DockWidget to detach from the Workspace
 */

VG.UI.Workspace.prototype.detachDockWidget=function( dockWidget )
{
    dockWidget._oldPercent=dockWidget.rect.width / this.layout.rect.width * 100.0;

    this.layout.removeChild( dockWidget );
    this.windows.push( dockWidget );
    dockWidget.oldLocation=dockWidget.location;
    dockWidget.location=VG.UI.DockWidgetLocation.Floating;
    this.recalcLayoutPercentages();
};

VG.UI.Workspace.prototype.possiblyAttachDockWidget=function( dockWidget, useOldLocation )
{
    var index;
    if ( dockWidget.oldLocation !== undefined && useOldLocation )
    {
        this.addDockWidget( dockWidget, dockWidget.oldLocation );
        index=this.windows.indexOf( dockWidget );
        if ( index >= 0 )
            this.windows.splice( index, 1 );
    } else
    {
        // --- Check if the mouse position is near a border and if yes attach the dockwidget to that border
        if ( this.mousePos.x < this._content.rect.x + 100 ) {
            // --- Left of Content
            this.addDockWidget( dockWidget, VG.UI.DockWidgetLocation.Left );

            index=this.windows.indexOf( dockWidget );
            if ( index >= 0 )
                this.windows.splice( index, 1 );
        } else
        if ( this.mousePos.x > this._content.rect.right() - 100 ) {
            // --- Right of Content
            this.addDockWidget( dockWidget, VG.UI.DockWidgetLocation.Right );

            index=this.windows.indexOf( dockWidget );
            if ( index >= 0 )
                this.windows.splice( index, 1 );
        }
    }
};

VG.UI.Workspace.prototype.recalcLayoutPercentages=function()
{
    var percent=100.0;
    var contentOffset=-1;

    for( var i=0; i < this.layout.children.length; ++i ) {
        var widget=this.layout.children[i];
        if ( widget instanceof VG.UI.DockWidget ) {
            if ( widget.horizontalExpanding )
                percent-=this.layout.getChildPercentAt( i );
        } else contentOffset=i;
    }

    if ( contentOffset !== -1 )
        this.layout.setChildPercentAt( contentOffset, percent );
};

/**
 * Adds a VG.UI.ToolBar to the top of the Workspace
 * @param {VG.UI.ToolBar} toolbar - The toolbar to add. Several Toolbars can be added to each Workspace
 */

VG.UI.Workspace.prototype.addToolBar=function( toolbar )
{
    this.toolbars.push( toolbar );
};

/**
 * Adds a VG.UI.MenuBar to the top of the Workspace
 * @param {VG.UI.MenuBar} menubar - The VG.UI.MenuBar to add. Several MenuBars can be added to each Workspace.
 */

VG.UI.Workspace.prototype.addMenuBar=function( menubar )
{
    this.menubars.push( menubar );
    this.paintMenubar=VG.getHostProperty( VG.HostProperty.DrawMenus );
};

/**
 * Adds a decorated ToolBar (VG.UI.DecoratedToolBar) to the application.
 */

VG.UI.Workspace.prototype.createDecoratedToolBar=function( { logo, logoRect = { width: 83, height: 83 }, noUndo, noFileOp } = {} )
{
    if ( !logo )
        logo = VG.Utils.getImageByName( "vg_logo.png" );

    this.appLogo = {
        image: logo,
        rect: logoRect,
    };

    this.decoratedToolBar = VG.UI.DecoratedToolBar();

    this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.QuickMenu );

    if ( !noUndo ) {
        this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.Undo );
        this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.Redo );
        this.decoratedToolBar.addItem( VG.UI.DecoratedToolSeparator() );
    }

    if ( !noFileOp ) {
        this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.New );
        this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.Open );
        this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.Save );
        this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.SaveAs );
    }
    // this.decoratedToolBar.addItem( VG.UI.DecoratedToolSeparator() );
    // this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.SkinCycle );
    this.decoratedToolBar.addItem( VG.UI.LayoutHSpacer() );
    this.decoratedToolBar.addItem( VG.UI.DecoratedToolSeparator() );
    this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.Login );
    this.addToolButtonRole( this.decoratedToolBar, VG.UI.ActionItemRole.UserTool );

    return this.decoratedToolBar;
};

VG.UI.Workspace.prototype.addQuickMenuItem=function( text, callback )
{
    if ( this.quickMenu )
    {
        var item=VG.UI.DecoratedQuickMenuItem( text, callback );
        this.quickMenu.items.push( item );

        return item;
    }

    return undefined;
};

VG.UI.Workspace.prototype.setDecoratedWidget=function( widget )
{
    this.decoratedWidget = widget;
};

// --- paintWidget

VG.UI.Workspace.prototype.paintWidget=function()
{
    this.contentRect.set( this.rect );
    this.canvas.setActiveCanvas( "" );
    this.lastActiveDOMWidgets = this.activeDOMWidgets;
    this.activeDOMWidgets = [];

    // --- Draw Menubar if any and if the menubar is painted by VG itself

    if ( this.menubars.length && this.paintMenubar ) {
        for ( let i=0; i < this.menubars.length; ++i)
        {
            let menubar=this.menubars[i];

            menubar.rect.x=this.contentRect.x; menubar.rect.y=this.contentRect.y;
            menubar.rect.setSize( this.rect.width, VG.UI.stylePool.current.skin.MenuBar.Height );

            menubar.paintWidget( this.canvas );

            this.contentRect.y+=menubar.rect.height;
            this.contentRect.height-=menubar.rect.height;
        }
    }

    // --- Draw Decorated ToolBar

    if ( this.decoratedToolBar )
    {
        this.decoratedToolBar.rect.copy( this.contentRect );
        this.decoratedToolBar.rect.x = 0;//this.appLogo.rect.width;
        // this.decoratedToolBar.rect.width -= this.appLogo.rect.width;
        this.decoratedToolBar.rect.height = VG.UI.stylePool.current.skin.DecoratedToolBar.Height;

        this.decoratedToolBar.paintWidget( this.canvas );

        if ( this.decoratedWidget )
        {
            this.decoratedWidget.rect.x = this.appLogo.rect.width;
            this.decoratedWidget.rect.y = this.contentRect.y + VG.UI.stylePool.current.skin.DecoratedToolBar.Height;
            this.decoratedWidget.rect.width = this.contentRect.width - this.appLogo.rect.width;
            this.decoratedWidget.rect.height = this.appLogo.rect.height - VG.UI.stylePool.current.skin.DecoratedToolBar.Height;

            if ( this.layout && this.layout.children )
            {
                for ( let i = 0; i < this.layout.children.length; ++i )
                {
                    let child = this.layout.children[i];
                    if ( child && child.__rightDock && i > 0 ) {
                        let totalX = this.layout.children[i-1].rect.x + this.layout.children[i-1].rect.width;
                        this.decoratedWidget.rect.width -= (this.decoratedWidget.rect.x + this.decoratedWidget.rect.width) - totalX;
                        break;
                    }
                }
            }

            this.decoratedWidget.paintWidget( this.canvas );
        }

        this.contentRect.y += this.appLogo.rect.height;
        this.contentRect.height -= this.appLogo.rect.height;
    }

    // --- Draw Toolbar

    for ( let i=0; i < this.toolbars.length; ++i)
    {
        let toolbar=this.toolbars[i];

        toolbar.rect.x=this.contentRect.x; toolbar.rect.y=this.contentRect.y;
        toolbar.rect.setSize( this.rect.width, VG.UI.stylePool.current.skin.ToolBar.Height );

        toolbar.paintWidget( this.canvas );
        this.contentRect.y+=toolbar.rect.height;
        this.contentRect.height-=toolbar.rect.height;
    }

    // --- Setup Statusbar

    if ( this.statusBar )
    {
        this.statusBar.rect.set( this.rect.x, this.rect.y + this.rect.height - VG.UI.stylePool.current.skin.StatusBar.Height, this.rect.width, VG.UI.stylePool.current.skin.StatusBar.Height );
        this.contentRect=this.contentRect.add( 0, 0, 0, -VG.UI.stylePool.current.skin.StatusBar.Height );
    }

    // --- Draw Layout

    this.canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, this.contentRect, VG.UI.stylePool.current.skin.Widget.BackgroundColor );

    if ( this.layout ) {
        this.layout.rect.set( this.contentRect );
        this.layout.layout( this.canvas );
    }

    // --- Draw Statusbar

    if ( this.statusBar )
        this.statusBar.paintWidget( this.canvas );

    this.canvas.setActiveCanvas( "Overlay" );

    // --- Draw Windows

    for ( let i=0; i < this.windows.length; ++i)
    {
        let window=this.windows[i];

        if ( !window.visible ) continue;

        if ( this.canvas.twoD )
            this.canvas.clearGLRect( window.rect );
        window.paintWidget( this.canvas );
    }

    // --- Check for delayed paint widgets (widgets with popups)

    if ( this.canvas.delayedPaintWidgets.length )
    {
        for( let i = 0; i < this.canvas.delayedPaintWidgets.length; ++i ) {
            let widget = this.canvas.delayedPaintWidgets[i];
            widget.paintWidget( this.canvas );
        }
        this.canvas.delayedPaintWidgets = [];
    }

    // --- Check if we have an active context Menu

    if ( this.contextMenu )
        this.contextMenu.paintWidget( this.canvas );

    // ---

    this.canvas.hasBeenResized=false;

    // --- Hide widgets in the DOM canvas if they are not visible anymore

    for ( let i = 0; i < this.lastActiveDOMWidgets.length; ++i )
    {
        let widget = this.lastActiveDOMWidgets[i];

        if ( !this.activeDOMWidgets.includes( widget ) )
            widget.hide();
    }
};

VG.UI.Workspace.prototype.mouseMove=function( x, y )
{
    let event = this.mainMoveEvent;
    event.pos.set( x, y );
    let found;

    // --- If a widget is tracking the mouse, this has priority

    if ( this.mouseTrackerWidget ) {

        this.mousePos.set( x, y );
        this.mouseTrackerWidget.mouseMove( event );
        return;
    }

    // --- Event Handlers

    this.eventHandlers.forEach( ( handler ) => {
        if ( handler.mouseMove ) handler.mouseMove( event );
    } );

    // ---

    let windowUnderMouse = 0;
    let widgetUnderMouse = 0;
    let layoutUnderMouse = 0;

    this.modalDialog = 0;

    // --- Search for a window under the mouse

    for( let i=0; i < this.windows.length; ++i ) {
        let window=this.windows[i];

        if ( window.visible && window.rect.contains( event.pos ) ) {

            windowUnderMouse=window;
            widgetUnderMouse=window;

            // --- Search the layout

            if ( windowUnderMouse.layout ) {
                found=this.findLayoutItemAtMousePos( windowUnderMouse.layout, event.pos );
                if ( found && found.isWidget ) {
                    widgetUnderMouse=found;
                } else
                if ( found && found.isLayout ) {
                    layoutUnderMouse=found;
                }
            }

            // --- Search the buttonLayout (Dialogs Only)

            if ( widgetUnderMouse === window && windowUnderMouse.buttonLayout ) {
                found=this.findLayoutItemAtMousePos( windowUnderMouse.buttonLayout, event.pos );
                if ( found && found.isWidget ) {
                    widgetUnderMouse=found;
                }
            }

            // --- Search optional childWidgets

            if ( window.childWidgets ) {
                for ( var cw=0; cw < window.childWidgets.length; ++cw) {
                    var child=window.childWidgets[cw];
                    if ( child.rect.contains( event.pos ) )
                        widgetUnderMouse=child;
                }
            }
        }

        // --- Check if a dialog is currently being shown and if yes, set the modal flag for the workspace, i.e.
        // --- Dont accept any mouse or key input except from the modal dialog.

        if ( window.visible && (window instanceof VG.UI.Dialog ) ) {
            this.modalDialog=window;
        }

    }

    // --- Search for the widget or layout under the mouse

    // --- Draw Menubar if any and if the menubar is painted by VG itself

    if ( this.paintMenubar && !windowUnderMouse  ) {
        for ( let i=0; i < this.menubars.length; ++i)
        {
            var menubar=this.menubars[i];
            if ( menubar.rect.contains( event.pos ) )
                widgetUnderMouse=menubar;
        }
    }

    // --- Search the decorated toolbar

    if ( this.decoratedToolBar )
    {
        found=this.findLayoutItemAtMousePos( this.decoratedToolBar.layout, event.pos );
        if ( found && found.isWidget )
            widgetUnderMouse=found;

        if ( !widgetUnderMouse && this.decoratedWidget && this.decoratedWidget.rect.contains( event.pos ) ) {
            if ( this.decoratedWidget.layout ) {
                found = this.findLayoutItemAtMousePos( this.decoratedWidget.layout, event.pos );
                if ( found && found.isWidget )
                    widgetUnderMouse = found;
            } else widgetUnderMouse = this.decoratedWidget;
        }
    }

    // --- Search the overlay layout

    if ( this.overlayWidgets.length )
    {
        for ( let i = this.overlayWidgets.length - 1; i >= 0; --i )
        {
            if ( widgetUnderMouse ) break;

            let overlayWidget =  this.overlayWidgets[i];
            found=this.findLayoutItemAtMousePos( overlayWidget.layout, event.pos );
            if ( found && found.isWidget )
                widgetUnderMouse=found;

            if ( !widgetUnderMouse && overlayWidget.rect.contains( event.pos ) )
                widgetUnderMouse = overlayWidget;
        }
    }

    // --- Search the toolbars

    if ( !windowUnderMouse && !widgetUnderMouse ) {

        for ( let i=0; i < this.toolbars.length; ++i) {
            var toolbar=this.toolbars[i];
            found=this.findLayoutItemAtMousePos( toolbar.layout, event.pos );
            if ( found && found.isWidget ) {
                widgetUnderMouse=found;
            }
        }

        if ( !widgetUnderMouse )
        {
            // --- Search the main layout
            found=this.findLayoutItemAtMousePos( this.layout, event.pos );

            if ( found ) {
                //VG.log( "Found:" + found.name );

                if ( found.isWidget ) {
                    widgetUnderMouse=found;
                } else
                if ( found.isLayout ) {
                    layoutUnderMouse=found;
                }
            }
        }
    }

    // --- If we have a modal dialog and it is currently not under the mouse, ignore this event

    if ( this.modalDialog && windowUnderMouse !== this.modalDialog )
        { this.mousePos.set( x, y ); return; }

    // --- Evalutate the layout under the mouse

    if ( layoutUnderMouse !== this.layoutUnderMouse ) {

        if ( layoutUnderMouse ) {
            // --- New Layout has Hover

            if ( layoutUnderMouse.hoverIn )
                layoutUnderMouse.hoverIn();
        }

        if ( this.layoutUnderMouse ) {
            // --- This Layout has lost Hover State

            if ( this.layoutUnderMouse.hoverOut )
                this.layoutUnderMouse.hoverOut();
        }

        this.layoutUnderMouse=layoutUnderMouse;

        if ( layoutUnderMouse && layoutUnderMouse.mouseMove )
            layoutUnderMouse.mouseMove( event );
    }

    if ( this.layoutUnderMouse && this.layoutUnderMouse.mouseMove )
        this.layoutUnderMouse.mouseMove( event );

    // --- Drag and Drop

    if ( this.dndOperation )
    {
        this.dndValidDragTarget=undefined;

        if ( widgetUnderMouse.checkDragSourceItemId ) {
            var accepts=widgetUnderMouse.checkDragSourceItemId( event.pos, this.dndItemId, this.dndItem );
            if ( accepts && widgetUnderMouse.acceptDragSourceItem ) {

                // set mouse ptr to accept mode

                this.dndValidDragTarget=widgetUnderMouse;
            }
        }
        this.mousePos.set( x, y );

        if ( this.dndValidDragTarget ) VG.setMouseCursor( "pointer" );
        else VG.setMouseCursor( "no-drop" );

        return;
    }

    // --- Evalutate the widget under the mouse

    if ( widgetUnderMouse !== this.widgetUnderMouse ) {

        if ( widgetUnderMouse )
        {
            // --- New Widget has Hover
            if ( !widgetUnderMouse.disabled && widgetUnderMouse.visualState === VG.UI.Widget.VisualState.Normal ) {
                widgetUnderMouse.visualState=VG.UI.Widget.VisualState.Hover;
                widgetUnderMouse.hasHoverState=true;
                widgetUnderMouse.hasFocusState=false;
                this.canvas.update();
            }

            // --- Send mouseEnter
            if ( !widgetUnderMouse.disabled && widgetUnderMouse.mouseEnter )
                widgetUnderMouse.mouseEnter( event );
        }

        if ( this.widgetUnderMouse )
        {
            // --- This Widget has lost Hover
            if ( this.focusWidget === this.widgetUnderMouse ) {
                this.widgetUnderMouse.visualState=VG.UI.Widget.VisualState.Focus;
                this.widgetUnderMouse.hasFocusState=true;
                this.widgetUnderMouse.hasHoverState=false;
            } else {
                this.widgetUnderMouse.visualState=VG.UI.Widget.VisualState.Normal;
                this.widgetUnderMouse.hasFocusState=false;
                this.widgetUnderMouse.hasHoverState=false;
            }

            // --- Send mouseLeave
            if ( !this.widgetUnderMouse.disabled && this.widgetUnderMouse.mouseLeave )
                this.widgetUnderMouse.mouseLeave( event );

            this.canvas.update();
        }

        this.widgetUnderMouse=widgetUnderMouse;
    }

    this.windowUnderMouse=windowUnderMouse;

    if ( this.widgetUnderMouse && this.widgetUnderMouse.supportsAutoFocus === true && this.widgetUnderMouse !== this.focusWidget )
    {
        if ( !this.widgetUnderMouse.autoFocusRect )
            this.setFocus( this.widgetUnderMouse );
        else
        if ( this.widgetUnderMouse.autoFocusRect.contains( event.pos ) )
            this.setFocus( this.widgetUnderMouse );
    }

    if ( this.focusWidget && this.focusWidget.mouseMove )
        this.focusWidget.mouseMove( event );
    else
    if ( this.widgetUnderMouse && this.widgetUnderMouse.mouseMove )
        this.widgetUnderMouse.mouseMove( event );

    this.lastMouseMove=Date.now();
    this.mousePos.set( x, y );
};

VG.UI.Workspace.prototype.mouseDown=function( button )
{
    // ---

    this.mouseDownButton=button;
    this.mouseDownWidget=this.widgetUnderMouse;

    var event=VG.Events.MouseDownEvent( this );
    event.pos.set( this.mousePos );
    event.button=button;

    // --- If a widget is tracking the mouse, this has priority

    if ( this.mouseTrackerWidget && !this.contextMenu ) {
        this.mouseTrackerWidget.mouseDown( event );
        return;
    }

    // --- Event Handlers

    this.eventHandlers.forEach( ( handler ) => {
        if ( handler.mouseDown ) handler.mouseDown( event );
    } );

    // --- An active context menu has priority

    if ( this.contextMenu ) {

        if ( this.contextMenu.rect.contains( event.pos ) ) {
            this.contextMenu.mouseDown( event );
            this.canvas.update();
            return;
        }
        else
        {
            // --- A click outside the menu closes it
            this.contextMenu.visible=false;
            this.contextMenu=null;
            this.mouseTrackerWidget=null;
        }
    }

    // ---

    this.setFocus( this.mouseDownWidget );

    if ( this.layoutUnderMouse && this.layoutUnderMouse.mouseDown )
        this.layoutUnderMouse.mouseDown( event );

    if ( this.mouseDownWidget && this.mouseDownWidget.mouseDown && !this.mouseDownWidget.supportsFocus )
        this.mouseDownWidget.mouseDown( event );
    else
    if ( this.focusWidget && this.focusWidget.mouseDown && this.focusWidget.rect.contains( this.mousePos ) )
        this.focusWidget.mouseDown( event );

    if ( this.customEventWidget && this.customEventWidget.mouseDown && this.customEventWidget.rect.contains( this.mousePos ) )
        this.customEventWidget.mouseDown( event );

    this.canvas.update();
};

VG.UI.Workspace.prototype.mouseUp=function( button )
{
    //console.log( "mouseUp();", button );

    this.mouseDownButton=undefined;

    // --- Handle possible DnD Operation

    if ( this.dndOperation ) {
        if ( this.dndValidDragTarget )
            this.dndValidDragTarget.acceptDragSourceItem( this.mousePos, this.dndItemId, this.dndItem );

        VG.setMouseCursor( "default" );
    }

    this.dndOperation=false;

    // --- Send mouseUp event

    var event=VG.Events.MouseUpEvent( this );
    event.pos.set( this.mousePos );
    event.button=button;

    // --- If a widget or layout tracks the mouse, this has priority

    if ( this.mouseTrackerWidget ) {
        this.mouseTrackerWidget.mouseUp( event );
        this.mouseDownWidget=undefined;
        this.lastMouseMove=-1;
        return;
    }

    // --- Event Handlers

    this.eventHandlers.forEach( ( handler ) => {
        if ( handler.mouseUp ) handler.mouseUp( event );
    } );

    if ( this.layoutUnderMouse && this.layoutUnderMouse.mouseUp )
        this.layoutUnderMouse.mouseUp( event );

    if ( this.mouseDownWidget && this.mouseDownWidget.mouseUp && !this.mouseDownWidget.supportsFocus )
        this.mouseDownWidget.mouseUp( event );
    else
    if ( this.focusWidget && this.focusWidget.mouseUp )
        this.focusWidget.mouseUp( event );

    // --- If the widget handles click events (buttons), send one.

    if ( this.mouseDownWidget && this.mouseDownWidget === this.widgetUnderMouse && this.mouseDownWidget.clicked && !this.mouseDownWidget.disabled && !this.mouseDownWidget.customClick )
        this.mouseDownWidget.clicked.call( VG.context, this.mouseDownWidget );

    this.mouseDownWidget=undefined;
    this.lastMouseMove=-1;

    this.canvas.update();
};

VG.UI.Workspace.prototype.mouseDoubleClick=function()
{
    this.mouseDownWidget=this.widgetUnderMouse;

    var event=VG.Events.MouseDownEvent( this );
    event.pos.set( this.mousePos );

    if ( this.layoutUnderMouse && this.layoutUnderMouse.mouseDoubleClick )
        this.layoutUnderMouse.mouseDoubleClick( event );

    if ( this.mouseDownWidget && this.mouseDownWidget.mouseDoubleClick && !this.mouseDownWidget.supportsFocus )
        this.mouseDownWidget.mouseDoubleClick( event );
    else
    if ( this.focusWidget && this.focusWidget.mouseDoubleClick )
        this.focusWidget.mouseDoubleClick( event );

    this.canvas.update();
};

VG.UI.Workspace.prototype.mouseWheel=function( step, xStep )
{
    this.lastMouseMove=Date.now();

    let rc, widget;
    if ( this.layoutUnderMouse && this.layoutUnderMouse.mouseWheel ) {
        rc=this.layoutUnderMouse.mouseWheel( step, xStep );
        if ( rc === true ) return true;
    }

    if ( this.widgetUnderMouse && !this.widgetUnderMouse.disabled && this.widgetUnderMouse.mouseWheel ) {
        rc=this.widgetUnderMouse.mouseWheel( step, xStep );
        if ( rc === true ) return true;
    }

    if ( this.widgetUnderMouse ) {
        widget=this.widgetUnderMouse.parent;
        while ( widget )
        {
            //VG.log( "iter widget", widget.name );
            if ( widget && !widget.disabled && widget.mouseWheel )
            {
                rc=widget.mouseWheel( step, xStep );
                if ( rc === true ) return true;
            }
            widget=widget.parent;
        }
    }

    if ( this.layoutUnderMouse ) {
        widget=this.layoutUnderMouse.parent;
        while ( widget )
        {
            //VG.log( "iter layout", widget.name );
            if ( widget && widget.mouseWheel )
            {
                rc=widget.mouseWheel( step, xStep );
                if ( rc === true ) return true;
            }
            widget=widget.parent;
        }
    }

    return false;
};

VG.UI.Workspace.prototype.showContextMenu=function()
{
    // if ( this.keysDown.length || (this.widgetUnderMouse && this.widgetUnderMouse.noContextMenuSupport ) ) {
    if ( this.widgetUnderMouse && this.widgetUnderMouse.noContextMenuSupport ) {
        return;
    }

    this.mouseDownWidget=this.widgetUnderMouse;

    var event=VG.Events.MouseDownEvent( this );
    event.pos.set( this.mousePos );

    this.setFocus( this.mouseDownWidget );

    if ( this.layoutUnderMouse && this.layoutUnderMouse.showContextMenu )
        this.layoutUnderMouse.showContextMenu( event );

    if ( this.mouseDownWidget && this.mouseDownWidget.parent.childWidgets && this.mouseDownWidget.parent.showContextMenu )
    {
        // --- Forwarding for embedded widgets (TableWidget)
        this.mouseDownWidget.parent.showContextMenu( event );
    } else
    if ( this.mouseDownWidget && this.mouseDownWidget.showContextMenu && !this.mouseDownWidget.supportsFocus )
        this.mouseDownWidget.showContextMenu( event );
    else
    if ( this.focusWidget && this.focusWidget.showContextMenu )
        this.focusWidget.showContextMenu( event );

    this.canvas.update();
};

VG.UI.Workspace.prototype.keyDown=function( keyCode )
{
    // --- Test for Keyboard Shortcuts

    let shortCutFound=false;
    if ( this.decoratedToolBar )  {
        if ( this.shortcutManager.verifyToolBar( String.fromCharCode( keyCode ), this.keysDown, this.decoratedToolBar ) ) {
            shortCutFound=true;

            // --- Check if the click was originated from a native menu bar / shortcut outside of VG
            // --- If yes, dont block the next text input
            this.ignoreTextInput=!this.shortcutManager.duplicateFromHost;
            VG.update();
        }
    }

    // ---

    if ( this.keysDown.indexOf( keyCode ) === -1 )
        this.keysDown.push( keyCode );

    if ( !shortCutFound )
    {
        if ( this.focusWidget && this.focusWidget.keyDown )
            this.focusWidget.keyDown( keyCode, this.keysDown );

        // --- Event Handlers

        this.eventHandlers.forEach( ( handler ) => {
            if ( handler.keyDown ) handler.keyDown( keyCode, this.keysDown );
        } );
    }
};

VG.UI.Workspace.prototype.keyUp=function( keyCode )
{
    while ( this.keysDown.indexOf( keyCode ) >= 0 )
        this.keysDown.splice( this.keysDown.indexOf( keyCode ), 1 );

    if ( this.focusWidget && this.focusWidget.keyUp )
        this.focusWidget.keyUp( keyCode, this.keysDown );

    if ( keyCode === 91 || keyCode === 17 || keyCode === 18 )
        this.keysDown = [];
};

VG.UI.Workspace.prototype.textInput=function( text )
{
    if ( !this.ignoreTextInput && this.focusWidget && this.focusWidget.textInput )
        this.focusWidget.textInput( text );

    this.ignoreTextInput=false;
};

/**
 * Sets focus to a VG.UI.Widget derived widget. The widget has to support supportsFocus
 * @param {VG.UI.Widget} widget - The widget to set focus to.
 */

VG.UI.Workspace.prototype.setFocus=function( widget )
{
     if ( this.focusVerification && !this.focusVerification( widget ) ) return;

    if ( widget && widget.supportsFocus && !widget.disabled &&
         widget.visualState !== VG.UI.Widget.VisualState.Focus )
    {
        widget.visualState=VG.UI.Widget.VisualState.Focus;
        widget.hasFocusState=true;
        widget.hasHoverState=false;

        if ( this.focusWidget ) {
            if ( this.focusWidget.focusOut ) this.focusWidget.focusOut();
            this.focusWidget.visualState=VG.UI.Widget.VisualState.Normal;
            this.focusWidget.hasHoverState=false;
            this.focusWidget.hasFocusState=false;
        }

        if ( widget.focusIn )
            widget.focusIn();

        this.focusWidget=widget;
        this.canvas.update();
    }
};

VG.UI.Workspace.prototype.widgetLostFocus=function( widget )
{
    if ( this.focusWidget === widget ) {

        if ( this.focusWidget.focusOut )
            this.focusWidget.focusOut();

        this.focusWidget.visualState=VG.UI.Widget.VisualState.Normal;
        this.focusWidget.hasHoverState=false;
        this.focusWidget.hasFocusState=false;
        this.focusWidget=0;
        this.canvas.update();
    } else VG.log( "Unknown widget called widgetLostFocus()" );
};

VG.UI.Workspace.prototype.cycleFocus=function( widget )
{
    if ( this.focusWidget === widget ) {

        var parent=widget.parent;
        if ( !parent || !parent.children ) return;
        var index=parent.children.indexOf( widget );
        if ( index >= 0 ) {
            ++index;

            var newFocusWidget=0;

            while ( !newFocusWidget ) {
                if ( index >= parent.children.length ) {
                    index=0;
                }

                if ( parent.children[index].isWidget && parent.children[index].visible && !parent.children[index].disabled && parent.children[index].supportsFocus ) {
                    newFocusWidget=parent.children[index];
                }

                ++index;
            }

            this.setFocus( newFocusWidget );
        }

    } else VG.log( "Unknown widget called cycleFocus()" );
};

VG.UI.Workspace.prototype.focusIn=function()
{
    if ( this.callbackForFocusChanged )
        this.callbackForFocusChanged( true );
};

VG.UI.Workspace.prototype.focusOut=function()
{
    if ( this.callbackForFocusChanged )
        this.callbackForFocusChanged( false );
};

VG.UI.Workspace.prototype.tick=function( needsRedraw )
{
    var redraw=false;
    var current = Date.now();
    var i, time;

    // --- ToolTips Controller

    if ( this.lastMouseMove !== -1 && current - this.lastMouseMove > 800 && this.widgetUnderMouse && !this.widgetUnderMouse.disabled &&
        this.widgetUnderMouse.toolTip && this.mouseDownWidget === undefined ) {

        this.toolTipWidget.rect.x=this.mousePos.x;
        this.toolTipWidget.rect.y=this.mousePos.y;

        if ( this.canvas.delayedPaintWidgets.indexOf( this.toolTipWidget ) === -1 )
            this.canvas.delayedPaintWidgets.push( this.toolTipWidget );

        if ( !this.toolTipWidget.visible ) {
            needsRedraw=true;
            this.toolTipWidget.visible=true;
            this.toolTipWidget.setToolTip( this.canvas, this.widgetUnderMouse );
        }
    } else
    if ( this.toolTipWidget.visible ) {
        needsRedraw=true;
        this.toolTipWidget.visible=false;
        this.canvas.delayedPaintWidgets=[];
    }

    // --- StatusTips

    if ( this.statusBar && this.widgetUnderMouse && !this.widgetUnderMouse.disabled && !this.widgetUnderMouse.noStatusTip && this.widgetUnderMouse.statusTip ) {
        this.statusBar.message( this.widgetUnderMouse.statusTip, 4000 );
    }

    // ---

    if ( this.singleShotCallbacks.length ) {
        for( i=0; i < this.singleShotCallbacks.length; ++i ) {
            this.singleShotCallbacks[i]();
        }
        if ( this.singleShotCallbacks ) delete this.singleShotCallbacks;
        this.singleShotCallbacks=[];
    }

    if ( ( ( current - this.lastRedrawTime ) > this.autoRedrawInterval ) || needsRedraw ) redraw=true;
    else
    {
        // --- Check if a redraw request time is true

        for( i=0; i < this.redrawList.length; ++i ) {

            time=this.redrawList[i];

            if ( time <= current ) {
                redraw=true;
                break;
            }
        }

        if ( redraw && this.redrawList.length )
        {
            // --- Create a new array only containing the none-expired redraw requests
            var array=[];

            for( i=0; i < this.redrawList.length; ++i ) {
                time=this.redrawList[i];

                if ( time > current ) array.push( time );
            }

            // --- Replace the redrawList array
            if ( this.redrawList ) delete this.redrawList;
            this.redrawList=array;
        }
    }

    var rt=VG.Renderer().mainRT;

    var diff=current - this.lastRedrawTime;
    if ( diff < this.maxRedrawInterval ) redraw=false;

    if ( redraw ) {
        rt.clear( true, 1.0);
        rt.setViewport(this.rect);

        if ( this.canvas.twoD ) {
            this.canvas.canvas = document.getElementById( 'workspace' );
            this.canvas.ctx = this.canvas.canvas.getContext('2d');

            this.canvas.canvas.width = VG.context.workspace.rect.width; this.canvas.canvas.height = VG.context.workspace.rect.height;
            this.canvas.ctx.clearRect( 0, 0, VG.context.workspace.rect.width, VG.context.workspace.rect.height );

            this.canvas.canvasOverlay = document.getElementById( 'workspaceOverlay' );
            this.canvas.ctxOverlay = this.canvas.canvasOverlay.getContext('2d');

            this.canvas.canvasOverlay.width = VG.context.workspace.rect.width; this.canvas.canvasOverlay.height = VG.context.workspace.rect.height;
            this.canvas.ctxOverlay.clearRect( 0, 0, VG.context.workspace.rect.width, VG.context.workspace.rect.height );
        }

        this.paintWidget();
        this.canvas.flush();

        // VG.log( "Redraw time", Date.now() - current );

        this.lastRedrawTime=current;
    } else
    if ( this.renderCallback ) this.renderCallback();

    return redraw;
};

VG.UI.Workspace.prototype.findLayoutItemAtMousePos=function( layout, pos )
{
    // console.log( "findLayoutItemAtMousePos: " + layout.name );

    // --- Check if top layout is a StackedWidget and if yes do the proper forwarding
    if ( layout instanceof VG.UI.StackedLayout ) {
        while ( layout instanceof VG.UI.StackedLayout )
            layout=layout.current;

        if ( layout === undefined || layout === null ) return layout;
        else if ( layout.isWidget ) return layout;
    }

    var found, i, t;
    if ( layout )
    {
        if ( layout.specialLayoutHitTest && layout.specialLayoutHitTest( pos ) )
        {
            return layout;
        } else
        {
            for ( i=0; i < layout.children.length; ++i ) {
                var child=layout.children[i];

                if ( !child.visible ) continue;

                // --- Check for StackedLayout Forwarding for childs
                if ( child instanceof VG.UI.StackedLayout )
                {
                    // --- Handle recursive VG.UI.StackedLayout situations
                    while ( child instanceof VG.UI.StackedLayout )
                        child=child.current;

                    if ( child === undefined || child === null ) continue;
                }

                // --- Check for StackedLayout Forwarding for child layouts of widgets
                if ( child.isWidget && child.layout instanceof VG.UI.StackedLayout && child.layout.rect.contains( pos ) )
                {
                    child=child.layout.current;
                    // --- Handle recursive VG.UI.StackedLayout situations
                    while ( child instanceof VG.UI.StackedLayout )
                        child=child.current;

                    if ( child === null ) continue;
                }

                if ( !child ) continue;

                if ( child.isWidget ) {
                    if ( child.visible && child.rect.contains( pos ) ) {
                        if ( child.layout && child.layout.visible && child.layout.rect.contains( pos ) ) {
                            found=this.findLayoutItemAtMousePos( child.layout, pos );
                            if ( found ) return found;
                            else return child.layout;
                        } else
                        if ( child.childWidgets ) {
                            for ( t=0; t < child.childWidgets.length; ++t ) {
                                var widget=child.childWidgets[t];
                                if ( widget.visible && widget.rect.contains( pos ) ) {
                                    if ( !widget.childWidgets ) return widget;
                                    else
                                    {
                                        for ( var w=0; w < widget.childWidgets.length; ++w ) {
                                            var subChild=widget.childWidgets[w];
                                            if ( subChild.visible && subChild.rect.contains( pos ) ) return subChild;
                                        }
                                        return widget;
                                    }
                                }
                            }
                            return child;
                        } else return child;
                    }
                } else
                if ( child.isLayout ) {
                    found=this.findLayoutItemAtMousePos( child, pos );
                    if ( found ) return found;

                    // --- If inside a LabelLayout and did not find any child, return the LabelLayout itself
                    if ( child instanceof VG.UI.LabelLayout && child.rect.contains( pos ) )
                        return child;
                }
            }
        }
    }
    return 0;
};

VG.UI.Workspace.prototype.modelNewCallback=function()
{
    if ( this.callbackForConfirmNew )
        this.callbackForConfirmNew( this.modelPerformNew.bind( this ) );
    else this.modelPerformNew();
};


VG.UI.Workspace.prototype.modelPerformNew=function()
{
    if ( this.dataCollectionForUndoRedo )
    {
        this.dataCollectionForUndoRedo.clearUndo();
        this.dataCollectionForUndoRedo.updateTopLevelBindings();
    }
    this.filePath=undefined;

    if ( this.platform === VG.HostProperty.PlatformDesktop )
        VG.setWindowTitle( "", "" );
};

/**
 * Called for displaying a file open dialog when running on the web. The dialog is passed a function pointer to modelOpen which
 * will be called with the project data.
 */

VG.UI.Workspace.prototype.modelOpenCallback=function()
{
    if ( this.dataCollectionForLoadSave || this.callbackForOpen )
    {
        if ( !this.appId ) {

            // --- Show Error Message when no appId (either not logged in or app does not yet exist )

            var message;

            if ( !this.userName ) message="Please login to Visual Graphics first!";
            else message="Application was not yet created @ Visual Graphics.\nPlease create the application first.";

            var dialog=VG.UI.StatusDialog( VG.UI.StatusDialog.Type.Error, "Cannot Open File Dialog", message );
            this.showWindow( dialog );
            return;
        }

        //var fileDialog=VG.RemoteFileDialog( this.modelFileType, this.modelOpen.bind( this ), "Select File", "Open" );
        //this.showWindow( fileDialog );

        var openProject=VG.RemoteOpenProject( this, this.modelOpen.bind( this ) );
        this.showWindow( openProject );
    }
};

/**
 * Called for displaying a file open dialog when running on the desktop using electron. The dialog is passed a function pointer to modelOpen which
 * will be called with the project data.
 */

VG.UI.Workspace.prototype.modelOpenCallback_electron=function()
{
    if ( this.dataCollectionForLoadSave || this.callbackForOpen )
    {
        const ipc = require('electron').ipcRenderer;
        ipc.send('open-file-dialog');

        ipc.once( 'selected-project-file', function ( event, paths ) {
            const fs = require( 'fs' );
            const { app } = require('electron').remote;

            let filePath = paths[0];
            let data = fs.readFileSync( filePath ).toString();

            app.addRecentDocument( filePath );
            VG.context.workspace.modelOpen( filePath, data );
        });
    }
};

/**
 * Opens the given project data.
 */

VG.UI.Workspace.prototype.modelOpen=function( name, data )
{
    let path = name;
    this.projectName=VG.Utils.fileNameFromPath( path, true );

    if ( this.dataCollectionForLoadSave )
    {
        // --- Clear Undo History
        this.dataCollectionForUndoRedo.clearUndo();

        // --- Load the data into the dataCollection
        var dc=this.dataCollectionForLoadSave;
        var json=JSON.parse( VG.Utils.decompressFromBase64( data ) );

        for (var key in json ) {
            if ( dc.hasOwnProperty(key)) {
                dc[key]=json[key];
            }
        }
    } else
    if ( this.callbackForOpen )
    {
        this.callbackForOpen( name, data );
    }

    // --- Update the model
    this.dataCollectionForUndoRedo.updateTopLevelBindings();

    this.setFilePath( path );
    VG.update();
};

/**
 * Sets the file path of the currently active project file.
 */

VG.UI.Workspace.prototype.setFilePath=function( filePath )
{
    this.filePath = filePath;
    if ( this.isElectron() ) {
        const win = require('electron').remote.getCurrentWindow();
        win.setRepresentedFilename( filePath );
    }
};

/**
 * Called by the "Save" callback to actually save the provided data based on the given platform and last save operation.
 * @param {object} data - The data to save
 */

VG.UI.Workspace.prototype.modelPerformSave=function( data )
{
    if ( this.isElectron() ) {
        const fs = require( 'fs' );
        fs.writeFile( this.filePath, data, (err) => { if ( err ) console.log( err ); } );
    } else
    if ( this.lastSaveType === 2 || this.lastSaveType === undefined ) {
        var params = {};
        params.filename = this.filePath;
        params.content = data;

        VG.downloadRequest("/api/download", params, "POST");
    } else {
        VG.remoteSaveFile( this.filePath, data, function( data ) {

            if ( this.statusBar ) {
                var obj=JSON.parse( data );

                if ( obj.status === 'ok' )
                    this.statusBar.message( "\"" + VG.Utils.fileNameFromPath( this.filePath ) + "\" has been saved successfully.", 2000 );
                else this.statusBar.message( "Error during saving \"" + VG.Utils.fileNameFromPath( this.filePath ) + "\"!", 2000 );
            }
        }.bind( this ) );
    }
};

/**
 * The main callback for the "Save" function for both the web and electron.
 */

VG.UI.Workspace.prototype.modelSaveCallback=function( callback )
{
    if ( !this.filePath ) return;

    this.modelNotifyAboutToSaveCallbacks();
    if ( this.dataCollectionForLoadSave ) {
        let data=VG.Utils.compressToBase64( JSON.stringify( this.dataCollectionForLoadSave ) );
        this.modelPerformSave( data );
    } else
    if ( this.callbackForSave ) this.callbackForSave( function( appEncodedData ) {
        this.modelPerformSave( appEncodedData );
    }.bind( this ) );
};

/**
 * The main callback for the "Save As" function for the web. Shows the web dialog and provides modelSaveAs() as success callback.
 */

VG.UI.Workspace.prototype.modelSaveAsCallback=function()
{
    if ( this.dataCollectionForLoadSave || this.callbackForSave ) {
        let saveProject = VG.RemoteSaveProject( this, this.modelSaveAs.bind( this ) );
        this.showWindow( saveProject );
    }
};

/**
 * The main callback for the "Save As" function for electron. Shows the native dialog and calls modelSaveAs().
 */

VG.UI.Workspace.prototype.modelSaveAsCallback_electron=function()
{
    if ( this.dataCollectionForLoadSave || this.callbackForSave ) {
        const ipc = require('electron').ipcRenderer;
        ipc.send('save-project-dialog');

        ipc.once( 'save-project-file', function ( event, filePath ) {
            let object = { filePath : filePath };
            VG.context.workspace.modelSaveAs( object );
        });
    }
};

/**
 * Saves the file data for the "Save As" callback.
 * @param {object} callbackObject - The object containing information about the destination path, most notably the filePath.
 * @param {function} rcCallback - Optional callback for showing a success message, only used for cloud storage.
 * @param {data} - The data to save.
 */

VG.UI.Workspace.prototype.modelPerformSaveAs=function( callbackObject, rcCallback, data )
{
    let path = callbackObject.filePath;

    this.setFilePath( path );
    this.projectName = VG.Utils.fileNameFromPath( path, true );

    if ( this.isElectron() ) {
        const fs = require( 'fs' );
        fs.writeFile( path, data, (err) => { if ( err ) console.log( err ); } );
        this.lastSaveType = 3;
    } else
    if ( !callbackObject.download ) {
        this.lastSaveType = 1;
        VG.remoteSaveFile( path, data, rcCallback );
    } else {
        var params = {};
        params.filename = path;
        params.content = data;

        VG.downloadRequest("/api/download", params, "POST");
        this.lastSaveType = 2;
    }
};

/**
 * Generates the data to save and calls modelPerformSaveAs for the actual saving.
 * @param {object} callbackObject - The object containing information about the destination path, most notably the filePath.
 * @param {function} rcCallback - Optional callback for showing a success message, only used for cloud storage.
 */

VG.UI.Workspace.prototype.modelSaveAs=function( callbackObject, rcCallback )
{
    let path = callbackObject.filePath;
    if ( !path.length ) return;

    this.modelNotifyAboutToSaveCallbacks();
    if ( this.dataCollectionForLoadSave ) {
        let data = VG.Utils.compressToBase64( JSON.stringify( this.dataCollectionForLoadSave ) );
        this.modelPerformSaveAs( callbackObject, rcCallback, data );
        return data;
    } else if ( this.callbackForSave ) this.callbackForSave( function( data ) {
        this.modelPerformSaveAs( callbackObject, rcCallback, data );
        return data;
    }.bind( this ) );
};

VG.UI.Workspace.prototype.modelNotifyAboutToSaveCallbacks=function()
{
    for( var i=0; i < this.aboutToSaveCallbacks.length; ++i )
    {
        var callback=this.aboutToSaveCallbacks[i];
        if ( callback ) callback();
    }
};

VG.UI.Workspace.prototype.modelCutCallback=function( hostCall )
{
    if ( hostCall ) this.shortCutHostCall=true;
    else if ( this.shortCutHostCall ) { this.shortCutHostCall=undefined; return; }

    if ( this.focusWidget && this.focusWidget.clipboardCut )
        this.focusWidget.clipboardCut();
};

/**
 * The main copy entry point. Called whenever the user initiates a copy operation.
 */

VG.UI.Workspace.prototype.modelCopyCallback=function( hostCall )
{
    if ( hostCall ) this.shortCutHostCall=true;
    else if ( this.shortCutHostCall ) { this.shortCutHostCall=undefined; return; }

    if ( this.focusWidget && this.focusWidget.clipboardCopy )
        this.focusWidget.clipboardCopy();

    if ( !hostCall && this.platform === VG.HostProperty.PlatformWeb )
        document.execCommand( "copy" );
};

/**
 * The main paste entry point. Called whenever the user initiates a paste operation. When running on Electron, copy the image data from the system clipboard.
 */

VG.UI.Workspace.prototype.modelPasteCallback=function( hostCall )
{
    if ( hostCall ) this.shortCutHostCall=true;
    else if ( this.shortCutHostCall ) { this.shortCutHostCall=undefined; return; }

    if ( this.isElectron() ) {
        const { clipboard, nativeImage } = require('electron');
        let formats = clipboard.availableFormats();

        formats.forEach( ( text ) => {
            if ( text.startsWith( "image/" ) ) {
                let nativeImage = clipboard.readImage( text );
                let dataURL = nativeImage.toDataURL();
                let image = VG.decompressImageData( dataURL, new VG.Core.Image(), ( image ) => {
                    this.imageClipboard = image;
                    if ( this.focusWidget && this.focusWidget.clipboardPaste )
                        this.focusWidget.clipboardPaste();
                } );
            } else
            if ( text === "text/plain" ) {
                this.textClipboard = clipboard.readText( text );
            }
        } );
    } else {
        if ( this.focusWidget && this.focusWidget.clipboardPaste )
            this.focusWidget.clipboardPaste();
    }
};

VG.UI.Workspace.prototype.modelDeleteCallback=function()
{
    if ( this.focusWidget && this.focusWidget.clipboardDeleteSelection )
        this.focusWidget.clipboardDeleteSelection();
};

VG.UI.Workspace.prototype.modelSelectAllCallback=function()
{
    if ( this.focusWidget && this.focusWidget.selectAll )
        this.focusWidget.selectAll();
};

VG.UI.Workspace.prototype.logout=function()
{
    this.userName="";
    this.userId=undefined;
    this.userIsAdmin=false;

    this.modelLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );

    if ( this.callbackForLoggedStateChanged )
        this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false );

    VG.update();
    VG.DB.userLogOut( () => {

    } );
};

VG.UI.Workspace.prototype.modelLoggedStateChanged=function( logged, userName, userId )
{
    let userNamePopup=this.getToolButtonOfRole( VG.UI.ActionItemRole.UserTool );
    let loginButton=this.getToolButtonOfRole( VG.UI.ActionItemRole.Login );
    let signupButton=this.getToolButtonOfRole( VG.UI.ActionItemRole.Signup );

    if ( userNamePopup ) userNamePopup.visible=logged;
    if ( loginButton ) loginButton.visible=!logged;
    if ( signupButton ) signupButton.visible=!logged;

    if ( !logged ) return;

    if ( userNamePopup )
    {
        userNamePopup.clear();
        userNamePopup.addItems( userName, "User Settings", "Logout" );
        let size = userNamePopup.calcSize( this.canvas );
        userNamePopup.minimumSize.set( size );
        userNamePopup.maximumSize.set( size );

        if ( !userNamePopup.changed )
        {
            userNamePopup.changed=function( index )
            {
               if ( index === 1 )
               {
                    this.showUserDialog( "User Settings" );

                    let userNamePopup = this.getToolButtonOfRole( VG.UI.ActionItemRole.UserTool );
                    if ( userNamePopup ) userNamePopup.index=0;
                } else
                if ( index === 2 ) this.logout();
            }.bind( this );
        }
    }

    // --- Get the appId of the current application

    VG.DB.getAppId( function( appId ) {
        this.appId=appId;

        // --- Check if the logged user is an admin of this app
        if ( this.userId !== undefined ) {
            VG.DB.userIsAppAdmin( appId, this.userId, function( isAppAdmin ) {
                this.userIsAppAdmin=isAppAdmin;

                if ( this.callbackForLoggedStateChanged )
                    this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId, isAppAdmin );
            }.bind( this ) );
        }
    }.bind( this ) );
};

/*
 * Callback used to update the disabled state of items with ActionRoles like Copy / Paste for the given menu.
 */

VG.UI.Workspace.prototype.modelMenuActionRoleValidationCallback=function( menu )
{
    for( var i=0; i < menu.items.length; ++i ) {
        var menuItem=menu.items[i];

        switch( menuItem.role ) {
            case VG.UI.ActionItemRole.Copy:
                if ( this.focusWidget && this.focusWidget.clipboardCopyIsAvailable && this.focusWidget.clipboardCopyIsAvailable() !== null )
                    menuItem.disabled=false; else menuItem.disabled=true;
            break;

            case VG.UI.ActionItemRole.Cut:
            case VG.UI.ActionItemRole.Delete:
                if ( this.focusWidget && this.focusWidget.clipboardCopyIsAvailable ) {
                    var clipboardType=this.focusWidget.clipboardCopyIsAvailable();

                    // --- Check if we can paste into this widget, i.e. is not read only
                    if ( clipboardType !== null && this.focusWidget.clipboardPasteIsAvailableForType( clipboardType ) )
                        menuItem.disabled=false; else menuItem.disabled=true;
                } else menuItem.disabled=true;
            break;

            case VG.UI.ActionItemRole.Paste:

                if ( VG.clipboardPasteDataForType( "Text" ) && this.focusWidget && this.focusWidget.clipboardPasteIsAvailableForType && this.focusWidget.clipboardPasteIsAvailableForType( "Text" ) )
                    menuItem.disabled=false;
                else
                if ( VG.clipboardPasteDataForType( "Nodes" ) && this.focusWidget && this.focusWidget.clipboardPasteIsAvailableForType && this.focusWidget.clipboardPasteIsAvailableForType( "Nodes" ) )
                    menuItem.disabled=false;
                else menuItem.disabled=true;
            break;

            case VG.UI.ActionItemRole.SelectAll:
                if ( this.focusWidget && this.focusWidget.selectAll )
                    menuItem.disabled=false; else menuItem.disabled=true;
            break;
        }
    }
};

/**
 * Registers a VG.Data.Collection with the specified roles to the Workspace.
 * @param {VG.Data.Collection} dc - The data collection to register
 * @param {VG.UI.DataCollectionRole} roles - Currently supported roles are VG.UI.DataCollectionRole.LoadSaveRole, the DC is used for Application Load / Save operations, and
 * VG.UI.DataCollectionRole.UndoRedoRole, which adds automatic Undo / Redo functionality to the DC
 */

VG.UI.Workspace.prototype.registerDataCollection=function( dataCollection, roles )
{
    var button;
    if ( roles & VG.UI.DataCollectionRole.LoadSaveRole )
    {
        this.dataCollectionForLoadSave=dataCollection;

        button=this.getToolButtonOfRole( VG.UI.ActionItemRole.Open );
        if ( button ) button.disabled=false;
        button=this.getToolButtonOfRole( VG.UI.ActionItemRole.Save );
        if ( button ) button.disabled=false;
        button=this.getToolButtonOfRole( VG.UI.ActionItemRole.SaveAs );
        if ( button ) button.disabled=false;
    }

    if ( roles & VG.UI.DataCollectionRole.UndoRedoRole )
    {
        this.dataCollectionForUndoRedo=dataCollection;
        dataCollection.__vgUndo=VG.Data.Undo();

        button=this.getToolButtonOfRole( VG.UI.ActionItemRole.Undo );
        if ( button ) button.disabled=false;
        button=this.getToolButtonOfRole( VG.UI.ActionItemRole.Redo );
        if ( button ) button.disabled=false;
    }
};

/**
 * Installs a temporary undo / redo collections.
 */

VG.UI.Workspace.prototype.registerTempUndoCollection=function( dataCollection )
{
    let button;

    // --- Disable all non Undo / Redo Buttons

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.New );
    if ( button ) {
        this._oldNewState = button.disabled;
        button.disabled = true;
    }

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Open );
    if ( button ) {
        this._oldOpenState = button.disabled;
        button.disabled = true;
    }

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Save );
    if ( button ) {
        this._oldSaveState = button.disabled;
        button.disabled = true;
    }

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.SaveAs );
    if ( button ) {
        this._oldSaveAsState = button.disabled;
        button.disabled = true;
    }

    // ---

    this._dataCollectionForUndoRedo = this.dataCollectionForUndoRedo;

    this.dataCollectionForUndoRedo = dataCollection;
    let undo = new VG.Data.Undo();
    dataCollection.__vgUndo = undo;

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Undo );
    if ( button ) undo.addUndoWidget( button );
    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Redo );
    if ( button ) undo.addRedoWidget( button );

    dataCollection.__vgUndo.updateUndoRedoWidgets();
};

/**
 * Removes the previously installed undo / redo connection.
 */

VG.UI.Workspace.prototype.unregisterTempUndoCollection=function()
{
    this.dataCollectionForUndoRedo.clearUndo();

    this.dataCollectionForUndoRedo = this._dataCollectionForUndoRedo;

    // --- Reassign the undo / redo callbacks

    let button;
    let undo = this.dataCollectionForUndoRedo.__vgUndo;

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.New );
    if ( button ) button.disabled = this._oldNewState;
    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Open );
    if ( button ) button.disabled = this._oldOpenState;
    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Save );
    if ( button ) button.disabled = this._oldSaveState;
    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.SaveAs );
    if ( button ) button.disabled = this._oldSaveAsState;

    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Undo );
    if ( button ) undo.addUndoWidget( button );
    button = this.getToolButtonOfRole( VG.UI.ActionItemRole.Redo );
    if ( button ) undo.addRedoWidget( button );
};

/**
 * Registers a callback for a specified callback type.
 * @param {VG.UI.CallbackType} type - The type of the callback
 * @param {function} func - The callback which gets invoked for the specified callback type
 */

VG.UI.Workspace.prototype.registerCallback=function( type, callback )
{
    var button;
    switch ( type ) {

        case VG.UI.CallbackType.New:
            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.callbackForClear=callback;
            button=this.getToolButtonOfRole( VG.UI.ActionItemRole.New );
            if ( button ) button.disabled=false;
        break;

        case VG.UI.CallbackType.UndoRedo:
            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.callbackForUndoRedo=callback;
        break;

        case VG.UI.CallbackType.Open:
            this.callbackForOpen=callback;
            button=this.getToolButtonOfRole( VG.UI.ActionItemRole.Open );
            if ( button ) button.disabled=false;
        break;

        case VG.UI.CallbackType.Save:
            this.callbackForSave=callback;
        break;

        case VG.UI.CallbackType.LoggedStateChanged:
            this.callbackForLoggedStateChanged=callback;
            this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );
        break;

        case VG.UI.CallbackType.ConfirmNew:
            this.callbackForConfirmNew=callback;
        break;

        case VG.UI.CallbackType.FocusChanged:
            this.callbackForFocusChanged=callback;
        break;

        case VG.UI.CallbackType.PlaceWindow:
            this.callbackForPlaceWindow=callback;
        break;
    }
};

VG.UI.Workspace.prototype.addToolButtonRole=function( toolbar, role )
{
    /**Creates a VG.UI.ToolButton, adds a specified default role to it and inserts it to the specified toolbar.
     * @param {VG.UI.Toolbar} toolbar - The toolbar to add the new VG.UI.ToolButton to.
     * @param {VG.UI.ActionItemRole} role - The role to apply
     */
    let button;

    if ( role === VG.UI.ActionItemRole.QuickMenu )
        button=VG.UI.DecoratedQuickMenu( "" );
    else
    if ( role === VG.UI.ActionItemRole.UserTool ) {
        button=VG.UI.DropDownMenu();
        button.supportsFocus=false;
        button.addItems( "User Settings", "Logout" );
    } else
    if ( role !== VG.UI.ActionItemRole.UserTool )
        button=VG.UI.ToolBarButton( "" );

    this.setupActionItemRole( button, role );
    button.role=role;

    this.modelToolButtonRoles.push( button );
    toolbar.addItem( button );

    return button;
};

VG.UI.Workspace.prototype.addMenuItemRole=function( menu, role )
{
    /**Creates a VG.UI.MenuItem, adds a specified default role to it and inserts it to the specified VG.UI.Menu.
     * @param {VG.UI.Menu} menu - The menubar to add the new VG.UI.MenuItem to.
     * @param {VG.UI.ActionItemRole} role - The role to apply
     */
    var menuItem=VG.UI.MenuItem( "" );

    this.setupActionItemRole( menuItem, role, menu );
    menuItem.role=role;

    menu.addMenuItem( menuItem );
    return menuItem;
};

VG.UI.Workspace.prototype.getToolButtonOfRole=function( role )
{
    for ( var i=0; i < this.modelToolButtonRoles.length; ++i )
    {
        var button=this.modelToolButtonRoles[i];
        if ( button.role === role ) return button;
    }
    return undefined;
};

VG.UI.Workspace.prototype.setupActionItemRole=function( object, role, parent )
{
    switch ( role ) {

        case VG.UI.ActionItemRole.New:
            object.text="New";

            if ( !VG.Utils.getImageByName( "_new.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_new.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_new.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }
            // object.svgName="glyphs.svg";
            //object.svgGroupName="New";

            object.iconName="_new.png";
            object.toolTip="Clear the current project, i.e. resets the application state.";
            object.statusTip="Clear the current project, i.e. resets the application state.";

            object.clicked=this.modelNewCallback.bind( this );
            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.addNewWidget( object );
            // else object.disabled=true;
            //object.svgName="glyphs.svg";
            //object.svgGroupName="new";
        break;

        case VG.UI.ActionItemRole.Open:
            object.text="Open...";

            if ( !VG.Utils.getImageByName( "_open.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_open.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_open.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }
            // object.svgName="glyphs.svg";
            // object.svgGroupName="Open";

            object.iconName="_open.png";
            object.statusTip="Open an existing project.";
            object.toolTip="Open an existing project.";

            if ( !this.isElectron() ) object.clicked = this.modelOpenCallback.bind( this );
            else object.clicked = this.modelOpenCallback_electron.bind( this );

            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.Open );
            //else object.disabled=true;

            if ( this.callbackForOpen ) object.disabled=false;

        break;

        case VG.UI.ActionItemRole.Save:
            object.text="Save";

            if ( !VG.Utils.getImageByName( "_save.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_save.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_save.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }
            //object.svgName="glyphs.svg";
            //object.svgGroupName="Save";

            object.iconName="_save.png";
            object.statusTip="Save the project.";
            object.toolTip="Save the project.";

            object.clicked = this.modelSaveCallback.bind( this );

            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.addSaveWidget( object );
            else object.disabled=true;

            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.Save );

        break;

        case VG.UI.ActionItemRole.SaveAs:
            object.text="Save As...";

            if ( !VG.Utils.getImageByName( "_saveas.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_saveas.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_saveas.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }
            // object.svgName="glyphs.svg";
            // object.svgGroupName="SaveAs";

            object.iconName="_saveas.png";
            object.statusTip="Save the project under a new file name.";
            object.toolTip="Save the project under a new file name.";

            if ( !this.isElectron() ) object.clicked = this.modelSaveAsCallback.bind( this );
            else object.clicked = this.modelSaveAsCallback_electron.bind( this );

            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.addSaveWidget( object );
            else object.disabled=true;

            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.SaveAs );

        break;

        case VG.UI.ActionItemRole.Undo:
            object.text="Undo";

            if ( !VG.Utils.getImageByName( "_undo.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_undo.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_undo.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }

            object.iconName="_undo.png";
            object.toolTip="Undo the last user action in the application.";
            object.statusTip="Undo the last user action in the application.";

            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.addUndoWidget( object );
            else object.disabled=true;

            object.shortcut = this.shortcutManager.createDefault( VG.Shortcut.Defaults.Undo );

            // object.svgName="glyphs.svg";
            // object.svgGroupName="Undo";
        break;

        case VG.UI.ActionItemRole.Redo:
            object.text="Redo";

            if ( !VG.Utils.getImageByName( "_redo.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_redo.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_redo.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }

            object.iconName="_redo.png";
            object.toolTip="Redo the last user action, previously undone via undo.";
            object.statusTip="Redo the last user action, previously undone via undo.";

            if ( this.dataCollectionForUndoRedo ) this.dataCollectionForUndoRedo.__vgUndo.addRedoWidget( object );
            else object.disabled=true;
            object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.Redo );

            // object.svgName="glyphs.svg";
            // object.svgGroupName="Redo";
        break;

        case VG.UI.ActionItemRole.Cut:
            object.text="Cut";

            if ( parent instanceof VG.UI.Menu ) object.statusTip="Delete the selected data and copies it to clipboard.";
            if ( parent instanceof VG.UI.Menu ) parent.aboutToShow=this.modelMenuActionRoleValidationCallback.bind( this );
            object.clicked=this.modelCutCallback.bind( this );
            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.Cut );
        break;

        case VG.UI.ActionItemRole.Copy:
            object.text="Copy";
            if ( parent instanceof VG.UI.Menu ) object.statusTip="Copy the selected data to the clipboard.";
            object.clicked=this.modelCopyCallback.bind( this );
            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.Copy );
        break;

        case VG.UI.ActionItemRole.Paste:
            object.text="Paste";
            if ( parent instanceof VG.UI.Menu ) object.statusTip="Paste the clipboard data to the current widget.";
            object.clicked=this.modelPasteCallback.bind( this );
            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.Paste );
        break;

        case VG.UI.ActionItemRole.Delete:
            object.text="Delete";
            if ( parent instanceof VG.UI.Menu ) object.statusTip="Delete the current selection.";
            if ( parent instanceof VG.UI.Menu ) parent.aboutToShow=this.modelMenuActionRoleValidationCallback.bind( this, parent );
            object.clicked=this.modelDeleteCallback.bind( this );
        break;

        case VG.UI.ActionItemRole.SelectAll:
            object.text="Select All";
            if ( parent instanceof VG.UI.Menu ) object.statusTip="Select all data in the current widget.";
            if ( parent instanceof VG.UI.Menu ) parent.aboutToShow=this.modelMenuActionRoleValidationCallback.bind( this, parent );
            object.clicked=this.modelSelectAllCallback.bind( this );
            if ( parent instanceof VG.UI.Menu ) object.shortcut=this.shortcutManager.createDefault( VG.Shortcut.Defaults.SelectAll );
        break;

        case VG.UI.ActionItemRole.Login:
            object.text="LOGIN";

            if ( !VG.Utils.getImageByName( "_user.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_user.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_user.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }

            // object.svgName="glyphs.svg";
            // object.svgGroupName="User";

            object.iconName="_user.png";
            object.toolTip="Login / User Management.";
            object.statusTip="Login / User Management.";

            object.clicked=this.showUserDialog.bind( this );
            object.visible=!this.userId;
        break;

        case VG.UI.ActionItemRole.UserTool:
            object.visible=this.userId;

            var size=object.calcSize( this.canvas );
            object.minimumSize.set( size );
            object.maximumSize.set( size );
        break;

        case VG.UI.ActionItemRole.QuickMenu:
            object.text="QuickMenu";

            if ( !VG.Utils.getImageByName( "_quickmenu.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_quickmenu.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_quickmenu.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }

            object.iconName="_quickmenu.png";
            // object.toolTip="Show the application menu.";
            object.statusTip="Show the application menu.";

            this.quickMenu=object;
        break;

        case VG.UI.ActionItemRole.SkinCycle:
            object.text="Skin Cycle";

            if ( !VG.Utils.getImageByName( "_skin.png" ) ) {
                VG.Utils.svgToImage( { data : VG.Shaders.fs["vgstyle_gray_skin.svg"], width : 24, height : 24, callback : function( image ) {
                    image.name="_skin.png";
                    VG.context.imagePool.addImage( image );
                }.bind( this ) } );
            }

            // object.svgName="glyphs.svg";
            // object.svgGroupName="SkinCycle";

            object.iconName="_skin.png";
            object.toolTip="Cycle through the available skins of the application.";
            object.statusTip="Cycle through the available skins of the application.";

            object.clicked=function() {
                var style=VG.UI.stylePool.current;
                var skin=style.skin;
                var skinIndex=style.skins.indexOf( skin );

                if ( skinIndex < style.skins.length - 1 ) skinIndex++;
                else skinIndex=0;

                style.skin=style.skins[skinIndex];

                VG.update();
            };
        break;

        default:
            object.text="Unknown Role";
        break;
    }
};

/**
 * Returns a rectangle with the visible screen area. Useful on Websites when the VG app is larger than the visible size and the browser
 * uses a scrollbar. In this case the returned rectangle contains the width and height of the visible area along with its offet. On all other
 * platforms the returned retangle is the same size as the Workspace rectangle.
 * @param {VG.Core.Rect} rect - Optional, the rectangle to fill out. If undefined a new rect will be allocated.
 * @returns A filled out rectangle with the visible screen space.
 */

VG.UI.Workspace.prototype.getVisibleScreenRect=function( rect )
{
    if ( !rect ) rect=VG.Core.Rect();

    if ( VG.getHostProperty( VG.HostProperty.Platform ) === VG.HostProperty.PlatformWeb ) {

        rect.x=document.body.scrollLeft;
        rect.y=document.body.scrollTop;
        rect.width=window.innerWidth;
        rect.height=window.innerHeight;
    } else rect.set( this.rect );
    return rect;
};

/**
 * Shows the VG.UI.Window derived object, like VG.UI.Dialog on the Workspace.
 * @param {VG.UI.Window} window - The window to display. Be sure to call the close() function of the Window / Dialog to close it after use.
 */

VG.UI.Workspace.prototype.showWindow=function( window, pos )
{
    if ( this.windows.indexOf( window ) !== -1 ) return;

    window.calcSize( this.canvas );

    if ( pos )
    {
        window.rect.x = pos.x;
        window.rect.y = pos.y;
    } else {
        var screenRect=this.getVisibleScreenRect();

        window.rect.x = Math.round( (this.contentRect.width - window.rect.width) / 2 );
        window.rect.y = Math.round( (screenRect.height - window.rect.height) * 0.25 );

        if ( this.callbackForPlaceWindow )
            this.callbackForPlaceWindow( window, screenRect );
    }

    window.visible=true;
    window.setFocus();

    window.close=function() {
        if ( VG.context.workspace.windows.indexOf( this ) !== -1 )  {
            VG.context.workspace.windows.splice( VG.context.workspace.windows.indexOf( this ), 1 );
            this.dispose();
            VG.update();
            window.visible = false;
        }
    }.bind( window );

    this.windows.push( window );
};

VG.UI.Workspace.prototype.tryToLogin=function( userName, password )
{
    VG.DB.userLogIn( userName, password, function( success, userName, userId, isAdmin )
    {
        if ( success )
        {
            this.userName=userName;
            this.userId=userId;
            this.userIsAdmin=isAdmin;

            this.modelLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );

            if ( this.callbackForLoggedStateChanged )
                this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );

        }
    }.bind( this ) );
};

VG.UI.Workspace.prototype.switchToStyle=function( style, skin )
{
    VG.UI.stylePool.current=style;
    this.canvas.style=style;

    if ( skin ) style.skin=skin;

    // --- Adjust the CSS background color to the statusbar end color
    if ( VG.getHostProperty( VG.HostProperty.Platform ) === VG.HostProperty.PlatformWeb ) {
        var canvas=document.getElementById( 'webgl' );
        var body=document.body;

        body.style["background-color"]=this.canvas.style.skin.StatusBar.BackColor.toHex();
    }
    return;
    /*
    VG.context.style=style;
    VG.context.workspace.canvas.style=style;

    if ( skin ) style.skin=skin;

    // --- Adjust the CSS background color to the statusbar end color
    if ( VG.getHostProperty( VG.HostProperty.Platform ) === VG.HostProperty.PlatformWeb ) {
        var canvas=document.getElementById( 'webgl' );
        var body=document.body;

        body.style["background-color"]=VG.context.style.skin.StatusBar.GradientColor2.toHex();
    }

    VG.update();*/
};

/**
 * Returns the currently active style.
 * @returns The currently active UI style.
 */

VG.UI.Workspace.prototype.getCurrentStyle=function()
{
    return VG.UI.stylePool.current;
};

VG.UI.Workspace.prototype.dragOperationStarted=function( source, itemId, item )
{
    if ( !this.dndOperation ) {
        this.dndOperation=true;
        this.dndSource=source;
        this.dndItemId=itemId;
        this.dndItem=item;
    }
};

VG.UI.Workspace.prototype.isDirty=function()
{
    let dirty=false;

    if ( this.dataCollectionForUndoRedo && this.dataCollectionForUndoRedo.__vgUndo )
    {
        if ( this.dataCollectionForUndoRedo.__vgUndo.undoIsAvailable )
        {
            dirty=true;
        }
    }

    return dirty;
};

VG.UI.Workspace.prototype.canBeClosed=function()
{
    let canBeClosed=true;

    if ( this.dataCollectionForUndoRedo && this.dataCollectionForUndoRedo.__vgUndo )
    {
        if ( this.dataCollectionForUndoRedo.__vgUndo.undoIsAvailable )
        {
            canBeClosed=false;
        }
    }

    if ( this._downloadIP ) {
        this._downloadIP=false;
        canBeClosed=true;
    }

    return canBeClosed;
};

/**
 * Returns true if running inside Electron
 * @returns {boolean} true if the application is running inside an Electron instance, false otherwise.
 */

VG.UI.Workspace.prototype.isElectron=function()
{
    if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer')
        return true;
    if (typeof process !== 'undefined' && process.versions && !!process.versions.electron)
        return true;
    return false;
};

VG.UI.Workspace.prototype.addEventHandler = function( handler )
{
    let index = this.eventHandlers.indexOf( handler );
    if ( index === -1 ) this.eventHandlers.push( handler );

    // console.log( "addEventHandler", handler, this.eventHandlers.length );
};

VG.UI.Workspace.prototype.removeEventHandler = function( handler )
{
    let index = this.eventHandlers.indexOf( handler );
    if ( index !== -1 ) this.eventHandlers.splice( index, 1 );

    // console.log( "removeEventHandler", handler, this.eventHandlers.length );
};

/*
 * Copyright (c) 2014-2018 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.UI.Workspace.prototype.showUserDialog=function( defaultState = "Login" )
{
    let state = "Login"; if ( defaultState === "User Settings" ) state = defaultState;
    let redColor = new VG.Core.Color( "f34d4e" );
    let style = this.getCurrentStyle();

    let setState = ( state ) => {
        let dialog = this.userDialog;

        // --- Header
        let addHeader = ( layout, text ) => {
            let widget = new VG.UI.Widget();
            widget.font = new VG.Font.Font( "Open Sans Bold", 20 );
            widget.setFixedSize( 468, text ? 30 : 30 );

            widget.paintWidget = ( canvas ) => {

                let rect = widget.contentRect;
                rect.copy( widget.rect );

                canvas.pushFont( widget.font );
                canvas.drawTextRect( text, rect, VG.UI.stylePool.current.skin.Widget.TextColor, 0, 0 );
                canvas.popFont();

                rect.y += text ? 26 : 26;
                rect.height = 1;
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, style.skin.Window.BorderColor1 );
                rect.y++;
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, style.skin.Window.BorderColor2 );
            };

            layout.addChild( widget );
        };

        // --- Footer
        let addFooter = ( layout ) => {
            // let logo = VG.Utils.getImageByName( "vg_text_logo.png" );

            let widget = new VG.UI.Widget();
            widget.supportsFocus = true;
            widget.vgRect = new VG.Core.Rect();
            widget.bdRect = new VG.Core.Rect();

            widget.vgLogo = VG.Utils.getImageByName( "vg_text_logo.png" );
            if ( !widget.vgLogo.canvasImage ) widget.vgLogo.toCanvasImage();
            widget.bdLogo = VG.Utils.getImageByName( "vg_powered_bd.png" );
            if ( !widget.bdLogo.canvasImage ) widget.bdLogo.toCanvasImage();

            widget.html = new VG.UI.HtmlWidget();
            /*widget.html.supportsAutoFocus =*/ widget.html.supportsFocus = true;
            widget.html.linkCallback = ( link ) => VG.gotoUrl( link );
            widget.html.html = `<html><p>Sign up to <a href="http://www.viralgraphics.io">ViralGraphics.io</a> and sign in to all the applications using next generation app technology.</p></html>`;

            widget.setFixedSize( 365, 200 );
            widget.paintWidget = ( canvas ) => {

                let rect = widget.contentRect;
                rect.copy( widget.rect );

                rect.y += 15;
                rect.height = 1;
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, style.skin.Window.BorderColor1 );
                rect.y++;
                canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, style.skin.Window.BorderColor2 );

                widget.vgRect.set( widget.rect.x, widget.rect.y + 30, widget.vgLogo.width, widget.vgLogo.height );
                canvas.drawImage( widget.vgRect, widget.vgLogo );


                widget.html.rect.copy( widget.rect );
                widget.html.rect.y += 90;
                widget.html.rect.height = 60;
                widget.html.paintWidget( canvas );

                widget.bdRect.set( widget.rect.x + 260, widget.rect.y + 140, widget.bdLogo.width, widget.bdLogo.height );
                canvas.drawImage( widget.bdRect, widget.bdLogo );
            };

            widget.mouseDown = ( event ) => {
                if ( widget.vgRect.contains( event.pos ) )
                    VG.gotoUrl( `https://www.viralgraphics.io` );
                else
                if ( widget.bdRect.contains( event.pos ) )
                    VG.gotoUrl( `https://www.braindistrict.com` );
            };

            layout.addChild( widget );
        };

        if ( state === "Login" )
        {
            dialog.text = "Login";

            let userNameEdit = new VG.UI.TextLineEdit( "" );
            let passwordEdit = new VG.UI.TextLineEdit( "" );
            let messageLabel = new VG.UI.Label( "" );
            messageLabel.customColor = redColor;
            messageLabel.hAlignment = VG.UI.HAlignment.Left;

            passwordEdit.password = true;
            messageLabel.visible = false;

            let loginLayout = VG.UI.LabelLayout();
            loginLayout.margin.set( 36, 32, 36, 10 );
            loginLayout.labelSpacing = 60;
            loginLayout.labelAlignment = VG.UI.HAlignment.Left;

            loginLayout.addChild( "Username", userNameEdit );
            loginLayout.addChild( "Password", passwordEdit );
            loginLayout.addChild( "", messageLabel );

            let createAccountButton = new VG.UI.Button( "Create Account" );
            createAccountButton.clicked = () => {
                state = "Signup";
                setState( state );
                VG.update();
            };
            let loginButton = new VG.UI.Button( "Login" );
            loginButton.clicked = () => {

                VG.DB.userLogIn( userNameEdit.text, passwordEdit.text, ( { success, userName, userId, isAppAdmin, message } ) => {
                    if ( success )
                    {
                        this.userName = userName;
                        this.userId = userId;
                        this.userIsAdmin = isAppAdmin;

                        this.modelLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );

                        if ( this.callbackForLoggedStateChanged )
                            this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId );

                        messageLabel.customColor = undefined;
                        messageLabel.visible = true;
                        messageLabel.text = "Success";

                        VG.update();
                        if ( VG.Utils.getTextByName( "subscriptions.json" ) && !this.dontHandleRegistrations ) setState( "User Settings" );
                        else setTimeout( dialog.close( dialog ), 1000 );
                    } else {
                        messageLabel.visible = true;
                        messageLabel.text = message;
                    }
                } );
            };

            let buttonLayout = new VG.UI.Layout( createAccountButton, VG.UI.LayoutHSpacer(), loginButton );
            buttonLayout.margin.set( 36, 0, 36, 10 );

            // --- Forgot Password Widget

            let widget = new VG.UI.Widget();
            widget.supportsFocus = true;

            widget.setFixedSize( 365, 17 );
            widget.mouseDown = () => {
                setState( "Forgot Password" );
            };
            widget.paintWidget = ( canvas ) => {

                let rect = widget.contentRect;
                rect.copy( widget.rect );

                if ( !widget.textSize ) widget.textSize = canvas.getTextSize( "Forgot Password" );
                canvas.drawTextRect( "Forgot Password", widget.rect, VG.Core.Color.White, 2, 1 );

                if ( rect.contains ( VG.context.workspace.mousePos ) ) {
                    rect.y += 16;
                    rect.x += 365 - widget.textSize.width;
                    rect.width = widget.textSize.width;
                    rect.height = 1;
                    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, VG.Core.Color.White );
                }
            };

            // ---

            let layout = new VG.UI.Layout( loginLayout, buttonLayout, widget );
            layout.vertical = true;
            layout.spacing = 0;
            layout.margin.clear();

            addFooter( layout );

            layout.calcSize = ( canvas ) => {
                return VG.Core.Size( 440, 380 );
            };

            dialog.layout = layout;
            dialog.calcSize();
            return userNameEdit;
        } else
        if ( state === "Signup" )
        {
            dialog.text = "Signup";

            let userNameEdit = new VG.UI.TextLineEdit( "" );
            let emailEdit = new VG.UI.TextLineEdit( "" );
            let passwordEdit = new VG.UI.TextLineEdit( "" );
            let repeatPasswordEdit = new VG.UI.TextLineEdit( "" );
            let messageLabel = new VG.UI.Label( "" );
            messageLabel.customColor = redColor;
            messageLabel.hAlignment = VG.UI.HAlignment.Left;

            passwordEdit.password = true;
            repeatPasswordEdit.password = true;
            messageLabel.visible = false;

            let loginLayout = VG.UI.LabelLayout();
            loginLayout.margin.set( 36, 32, 36, 10 );
            loginLayout.labelSpacing = 60;
            loginLayout.labelAlignment = VG.UI.HAlignment.Left;

            loginLayout.addChild( "Username", userNameEdit );
            loginLayout.addChild( "eMail", emailEdit );
            loginLayout.addChild( "Password", passwordEdit );
            loginLayout.addChild( "Repeat Password", repeatPasswordEdit );
            loginLayout.addChild( "", messageLabel );

            let signupButton = new VG.UI.Button( "Signup" );
            signupButton.clicked = () => {

                if ( !userNameEdit.text )
                {
                    messageLabel.visible = true;
                    messageLabel.text = "Username is empty";
                } else
                if ( !emailEdit.text )
                {
                    messageLabel.visible = true;
                    messageLabel.text = "eMail is empty";
                } else
                if ( !passwordEdit.text || passwordEdit.text !== repeatPasswordEdit.text )
                {
                    messageLabel.visible = true;
                    messageLabel.text = "Passwords do not match";
                } else
                {
                    let parameters = {email : emailEdit.text, username : userNameEdit.text, password : passwordEdit.text };

                    VG.sendBackendRequest( "/user/signup", JSON.stringify( parameters ),
                        ( responseText ) => {
                            let response = JSON.parse( responseText );

                            if ( response.status === "error" ) {
                                messageLabel.visible = true;
                                messageLabel.text = response.message;
                                if ( response.detail && response.detail.errors ) {
                                    let errors = response.detail.errors;

                                    for( let key in errors) {
                                        messageLabel.text = errors[key].message;
                                        break;
                                    }
                                }
                            } else
                            if ( response.status === "ok" ) {
                                messageLabel.customColor = undefined;
                                messageLabel.visible = true;
                                messageLabel.text = "Please verify eMail we send you";
                            }
                        }
                    );
                }
            };

            let buttonLayout = new VG.UI.Layout( VG.UI.LayoutHSpacer(), signupButton );
            buttonLayout.margin.set( 36, 0, 36, 0 );

            let layout = new VG.UI.Layout( loginLayout, buttonLayout );
            layout.vertical = true;
            layout.spacing = 0;
            layout.margin.clear();

            addFooter( layout );

            layout.calcSize = ( canvas ) => {
                return VG.Core.Size( 440, 420 );
            };

            dialog.layout = layout;
            dialog.calcSize();
            return userNameEdit;
        } else
        if ( state === "Forgot Password" )
        {
            dialog.text = "Forgot Password";

            let userLabel = new VG.UI.Label( VG.context.workspace.userName );
            // let eMailLabel = new VG.UI.Label( VG.context.workspace.userEmail );
            let userEdit = new VG.UI.TextLineEdit( "" );
            let tokenEdit = new VG.UI.TextLineEdit( "" );
            let passwordEdit = new VG.UI.TextLineEdit( "" );
            let repeatPasswordEdit = new VG.UI.TextLineEdit( "" );
            let messageLabel = new VG.UI.Label( "" );

            userEdit.maximumSize.width = 200;
            tokenEdit.maximumSize.width = 200;
            passwordEdit.maximumSize.width = 200;
            repeatPasswordEdit.maximumSize.width = 200;
            messageLabel.customColor = redColor;
            messageLabel.hAlignment = VG.UI.HAlignment.Left;

            passwordEdit.password = true;
            repeatPasswordEdit.password = true;
            messageLabel.visible = false;

            let loginLayout = VG.UI.LabelLayout();
            loginLayout.margin.set( 0, 10, 0, 10 );
            loginLayout.labelSpacing = 60;
            loginLayout.labelAlignment = VG.UI.HAlignment.Left;

            loginLayout.addChild( "Username", userEdit );
            loginLayout.addChild( "Token", tokenEdit );
            loginLayout.addChild( "Password", passwordEdit );
            loginLayout.addChild( "Repeat Password", repeatPasswordEdit );
            loginLayout.addChild( "", messageLabel );

            let changeButton = new VG.UI.Button( "Change Password" );
            changeButton.clicked = () => {

                if ( !userEdit.text )
                {
                    messageLabel.customColor = redColor;
                    messageLabel.visible = true;
                    messageLabel.text = "Please enter username.";
                } else
                if ( !tokenEdit.text )
                {
                    messageLabel.customColor = redColor;
                    messageLabel.visible = true;
                    messageLabel.text = "Please enter valid token.";
                } else
                if ( !passwordEdit.text || passwordEdit.text !== repeatPasswordEdit.text )
                {
                    messageLabel.customColor = redColor;
                    messageLabel.visible = true;
                    messageLabel.text = "Passwords do not match";
                } else
                {
                    VG.sendBackendRequest( "/user/password/" + tokenEdit.text, JSON.stringify( { password: passwordEdit.text } ), (responseText) => {
                        let response = JSON.parse( responseText );
                        if ( response.status === "error" ) {
                            messageLabel.visible = true;
                            if ( response.message === "Wrong password recovery key" )
                                response.message = "Wrong password recovery token";
                            messageLabel.text = response.message;
                        } else
                        if ( response.status === "ok" ) {
                            messageLabel.customColor = undefined;
                            messageLabel.visible = true;
                            messageLabel.text = "Password changed.";
                        }

                    }, "POST" );
                }
            };

            let requestTokenButton = new VG.UI.Button( "Request Token" );
            requestTokenButton.clicked = () => {

                if ( !userEdit.text )
                {
                    messageLabel.customColor = redColor;
                    messageLabel.visible = true;
                    messageLabel.text = "Please enter username.";
                } else
                {
                    VG.sendBackendRequest( "/user/" + userEdit.text + "/password", JSON.stringify( {} ), (responseText) => {
                        let response = JSON.parse( responseText );
                        if ( response.status === "error" ) {
                            messageLabel.visible = true;
                            messageLabel.text = response.message;
                        } else
                        if ( response.status === "ok" ) {
                            messageLabel.customColor = undefined;
                            messageLabel.visible = true;
                            messageLabel.text = "Please see eMail we send you";
                        }
                    }, "GET" );
                }
            };

            let buttonLayout = new VG.UI.Layout( VG.UI.LayoutHSpacer(), requestTokenButton, changeButton );
            buttonLayout.margin.set( 0, 0, 0, 0 );

            let layout = new VG.UI.Layout();
            layout.margin.set( 36, 32, 36, 20 );

            addHeader( layout, "Change Password with Token" );
            layout.addChild( loginLayout );
            layout.addChild( buttonLayout );

            layout.vertical = true;
            layout.spacing = 0;

            layout.calcSize = ( canvas ) => {
                return VG.Core.Size( 540, 300 );
            };

            dialog.layout = layout;
            dialog.calcSize();
            return passwordEdit;
        }
        if ( state === "User Settings" )
        {
            dialog.text = "User Settings";

            let userLabel = new VG.UI.Label( VG.context.workspace.userName );
            // let eMailLabel = new VG.UI.Label( VG.context.workspace.userEmail );
            let passwordEdit = new VG.UI.TextLineEdit( "" );
            let repeatPasswordEdit = new VG.UI.TextLineEdit( "" );
            let messageLabel = new VG.UI.Label( "" );

            userLabel.setFixedSize( 200, 20 );
            // eMailLabel.setFixedSize( 200, 20 );
            userLabel.hAlignment = VG.UI.HAlignment.Left;
            // eMailLabel.hAlignment = VG.UI.HAlignment.Left;

            passwordEdit.maximumSize.width = 200;
            repeatPasswordEdit.maximumSize.width = 200;
            messageLabel.customColor = redColor;
            messageLabel.hAlignment = VG.UI.HAlignment.Left;

            passwordEdit.password = true;
            repeatPasswordEdit.password = true;
            messageLabel.visible = false;

            let loginLayout = VG.UI.LabelLayout();
            loginLayout.margin.set( 0, 10, 0, 10 );
            loginLayout.labelSpacing = 60;
            loginLayout.labelAlignment = VG.UI.HAlignment.Left;

            loginLayout.addChild( "Username", userLabel );
            // loginLayout.addChild( "eMail", eMailLabel );
            loginLayout.addChild( "Password", passwordEdit );
            loginLayout.addChild( "Repeat Password", repeatPasswordEdit );
            loginLayout.addChild( "", messageLabel );

            let changeButton = new VG.UI.Button( "Change Password" );
            changeButton.clicked = () => {

                if ( !passwordEdit.text || passwordEdit.text !== repeatPasswordEdit.text )
                {
                    messageLabel.visible = true;
                    messageLabel.text = "Passwords do not match";
                } else
                {
                    VG.DB.userChangePassword( passwordEdit.text, ( success ) => {
                        if ( success ) {
                            dialog.close( dialog );
                        } else {
                            messageLabel.visible = true;
                            messageLabel.text = "Password change failed.";
                        }
                    } );
                }
            };

            let buttonLayout = new VG.UI.Layout( VG.UI.LayoutHSpacer(), changeButton );
            buttonLayout.margin.set( 0, 0, 0, 0 );

            let layout = new VG.UI.Layout();
            layout.margin.set( 36, 32, 36, 20 );

            addHeader( layout, "Account" );
            layout.addChild( loginLayout );
            layout.addChild( buttonLayout );

            layout.vertical = true;
            layout.spacing = 0;
            // layout.margin.clear();

            // --- Subscriptions

            let subText = VG.Utils.getTextByName( "subscriptions.json" );
            if ( subText && !this.dontHandleRegistrations ) {
                let subs = JSON.parse( subText );
                sub = subs[0];

                addHeader( layout, sub.name );

                let htmlWidget = new VG.UI.HtmlWidget();

                let buildHtml = ( sub, info ) => {
                    let html="<html>" + sub.description;

                    if ( !info )
                    {
                        html+="<p>You can buy a subscription on our <a href=\"" + sub.orderpage + "\">" + sub.product + " Product Page</a>.</p>";
                        html+="<p>After ordering, your will receive your subscription token by eMail.</p>";
                        html+="<p>You can than enter the token into the text entry field below to activate it.</p>";
                    } else {
                        let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                        let endDate=new Date( info.endDate );
                        html+="<p>Thanks for subscribing!</p>";
                        html+="<p>If you want to renew or extend your subscription, you can always do so on the <a href=\"" + sub.orderpage + "\">" + sub.product + " Product Page</a>.</p>";
                        html+="<p>The expiration date for your subscription is " + endDate.toLocaleDateString( "en-US",options ) + ".</p>";
                    }

                    html+="</html>";
                    return html;
                };

                htmlWidget.html = buildHtml( sub );
                htmlWidget.margin.set( 0, 5, 0, 0 );
                htmlWidget.emptyP = true;
                htmlWidget.supportsAutoFocus = true;
                htmlWidget.linkCallback = ( link ) => VG.gotoUrl( link );

                layout.addChild( htmlWidget );

                let parameters = {};
                VG.sendBackendRequest( "/app/subscription/" + VG.context.appId + "/" + sub.id + "/check", JSON.stringify( parameters ), (responseText) => {
                    let response = JSON.parse( responseText );
                    if ( response.status === "ok" ) {
                        let subscription = { id : response.subscriptionId, endDate: response.user.end };
                        htmlWidget.html = buildHtml( sub, subscription );
                    }
                }, "GET" );

                // --- Token Edit / Activation

                let activationFeedbackLabel = new VG.UI.Label("");
                activationFeedbackLabel.visible = false;
                activationFeedbackLabel.labelAlignment = VG.UI.HAlignment.Left;

                let tokenEdit = new VG.UI.TextLineEdit();
                tokenEdit.textChanged = ( text ) => {
                    tokenActivateButton.disabled = !tokenEdit.text.length;
                };
                let tokenActivateButton = new VG.UI.Button( "Activate" );
                tokenActivateButton.disabled = true;
                tokenActivateButton.clicked = function() {

                    let token = tokenEdit.text;
                    let parameters={ token : token };

                    VG.sendBackendRequest( "/app/" + VG.context.appId + "/tokens/redeem", JSON.stringify( parameters ), (responseText) => {

                        let response=JSON.parse( responseText );
                        activationFeedbackLabel.visible = true;

                        if ( response.status === "error" ) {
                            activationFeedbackLabel.customColor = redColor;
                            activationFeedbackLabel.text = "Token could not be verified.";
                        } else
                        if ( response.status === "ok" ) {
                            activationFeedbackLabel.customColor = undefined;
                            activationFeedbackLabel.text = "Token accepted. Thanks for subscribing.";

                            htmlWidget.html = buildHtml( sub, subscription );

                            let parameters = {};
                            VG.sendBackendRequest( "/app/subscription/" + VG.context.appId + "/" + sub.id + "/check", JSON.stringify( parameters ), (responseText) => {
                                let response = JSON.parse( responseText );
                                if ( response.status === "ok" ) {
                                    let subscription = { id : response.subscriptionId, endDate: response.user.end };
                                    htmlWidget.html = buildHtml( sub, subscription );
                                }
                            }, "GET" );

                            if ( this.callbackForLoggedStateChanged )
                                this.callbackForLoggedStateChanged( this.userName.length > 0 ? true : false, this.userName, this.userId, this.userIsAppAdmin );
                        }

                        tokenEdit.text = "";
                    }, "POST" );

                }.bind( this );

                let tokenEditLayout = VG.UI.Layout( VG.UI.Label( "Token:" ), tokenEdit, tokenActivateButton );
                tokenEditLayout.margin.clear();
                layout.addChild( activationFeedbackLabel );
                layout.addChild( tokenEditLayout );
            } else subText = undefined;

            // --- Logout

            addHeader( layout, "" );
            let logoutButton = new VG.UI.Button( "Logout" );
            logoutButton.clicked = () => {
                this.logout();
                dialog.close( dialog );
            };
            let logoutLayout = new VG.UI.Layout( VG.UI.LayoutHSpacer(), logoutButton );
            logoutLayout.margin.set( 0, 4, 0, 0 );
            layout.addChild( logoutLayout );

            layout.calcSize = ( canvas ) => {
                return VG.Core.Size( 540, !subText ? 300 : 600 );
            };

            dialog.layout = layout;
            dialog.calcSize();
            return passwordEdit;
        }
    };

    if ( !this.userDialog ) {
        this.userDialog = new VG.UI.Dialog( "" );
        this.userDialog.buttonLayout = undefined;
    }

    let focusWidget = setState( state );
    this.showWindow( this.userDialog );
    if ( focusWidget ) focusWidget.setFocus();
};

// ----------------------------------------------------------------------------------- Contact Us

VG.UI.Workspace.prototype.showContactUsDialog=function( subjects )
{
    var dialog=VG.UI.Dialog( "CONTACT US");

    var nameEdit=VG.UI.TextLineEdit();
    var emailEdit=VG.UI.TextLineEdit();
    var subjectMenu=VG.UI.DropDownMenu();
    var messageEdit=VG.UI.TextEdit( "" );
    messageEdit.minimumSize.set( 500, 300 );

    if ( this.userId ) {
        nameEdit.text=this.userName;
        nameEdit.disabled=true;
        emailEdit.setFocus();
    }

    for ( var i=0; i < subjects.length; ++i )
        subjectMenu.addItem( subjects[i] );

    dialog.layout=VG.UI.LabelLayout( "NAME", nameEdit, "EMAIL", emailEdit, "SUBJECT", subjectMenu, "MESSAGE", messageEdit );
    dialog.layout.labelSpacing=20;
    dialog.layout.allowScrollbars=false;
    dialog.layout.labelAlignment=VG.UI.HAlignment.Left;
    dialog.layout.margin.set( 30, 20, 30, 10 );

    dialog.addButton( "CLOSE", function() { dialog.close( dialog ); }.bind( this ) );
    dialog.addButton( "SEND", function() {

        if ( nameEdit.text.length && emailEdit.text && messageEdit.text ) {
            VG.DB.sendEMailToAppAdmins( this.appId, nameEdit.text, emailEdit.text, subjectMenu.text(), messageEdit.text, function( success ) {

                if ( success ) dialog.close( dialog );
                else dialog.label.text="Login failed";

            }.bind( this ) );
        } else dialog.label="Missing Information";

    }.bind( this ) );

    this.showWindow( dialog );
};

// ----------------------------------------------------------------------------------- User Settings Dialog

VG.UI.Workspace.prototype.showUserSettingsDialog=function()
{
    if ( !this.userSettingsDialog ) {

        this.userSettingsDialog=VG.UI.Dialog( "Change Password");

        var layout=VG.UI.LabelLayout();
        layout.labelSpacing=40;
        layout.labelAlignment=VG.UI.HAlignment.Left;

        this.userSettings_passwordEdit1=VG.UI.TextLineEdit( "" );
        this.userSettings_passwordEdit2=VG.UI.TextLineEdit( "" );
        this.userSettings_passwordEdit1.password=true;
        this.userSettings_passwordEdit2.password=true;

        layout.addChild( "New Password", this.userSettings_passwordEdit1 );
        layout.addChild( "Repeat Password", this.userSettings_passwordEdit2 );

        this.userSettingsDialog.layout=layout;
        this.userSettingsDialog.addButton( "Close", function() { this.close( this ); }.bind( this.userSettingsDialog ) );
        this.userSettingsDialog.addButton( "Change", function() {
            if ( this.userSettings_passwordEdit1.text.length > 0 && this.userSettings_passwordEdit1.text == this.userSettings_passwordEdit2.text ) {
                VG.DB.userChangePassword( this.userSettings_passwordEdit1.text, function( success ) {
                    if ( success ) this.userSettingsDialog.close( this.userSettingsDialog );
                    else this.userSettingsDialog.label.text="Password change failed";
                }.bind( this ) );
            } else this.userSettingsDialog.label.text="Invalid Password";
        }.bind( this ) );
    }

    this.userSettings_passwordEdit1.text="";
    this.userSettings_passwordEdit2.text="";
    this.userSettingsDialog.label.text="";

    this.showWindow( this.userSettingsDialog );
};

// ----------------------------------------------------------------------------------- VG.RemoteOpenProject

VG.RemoteProjectItem=function()
{
    this.name="";
    this.size=0;
    this.type="";
};

VG.RemoteOpenProject=function( workspace, dataReadCallback )
{
    if ( !(this instanceof VG.RemoteOpenProject) ) return new VG.RemoteOpenProject( workspace, dataReadCallback );

    VG.UI.Dialog.call( this, "Open Project" );

    this.buttonLayout.margin.top /= 4;
    this.buttonLayout.margin.spacing /= 4;

    // --- Local Layout

    var dropArea=VG.UI.DropArea( "Project", function( canvas ) {
        // --- Paint Callback
        canvas.draw2DShape( VG.Canvas.Shape2D.RectangleOutlineMin1px, dropArea.rect, VG.UI.stylePool.current.skin.ListWidget.ItemCustomContentBorderColor );
        canvas.drawTextRect( "Drop Project File Here", dropArea.rect, VG.UI.stylePool.current.skin.Widget.TextColor, 1, 1 );
    }.bind( this ), function( name, data ) {
        // --- Drop Callback

        dataReadCallback( name, data );
        workspace.lastSaveType=2;

        // --- Close

        if ( VG.context.workspace.platform === VG.HostProperty.PlatformWeb )
            VG.dropZone.style.display="none";

        this.close( this );
    }.bind( this ) );

    var localLayout=VG.UI.Layout( dropArea );

    // --- Login first Layout

    var loginLabel = VG.UI.Label();
    loginLabel.text = `You have to login first to be able to use the ${VG.context.workspace.appName} Cloud.`;

    var loginLayout=VG.UI.LabelLayout( "", loginLabel );

    loginLayout.margin.left=0;
    loginLayout.vertical=true;

    // --- Visual Graphics Cloud

    var dc=VG.Data.Collection( "File List" );
    dc.fileList=[];

    var treeWidget=new VG.UI.TreeWidget();
    treeWidget.addColumn( { name : "Name", itemName : "text", width : 60 } );
    treeWidget.addColumn( { name : "Type", itemName : "type", width : 20 } );
    treeWidget.addColumn( { name : "Size", itemName : "size", width : 20 } );
    // treeWidget.itemHeight=68;

    var openButton=VG.UI.Button( "OPEN" );
    openButton.toolTip=`Open the Project from the ${VG.context.workspace.appName} Cloud.`;
    openButton.clicked=function() {

        VG.remoteOpenFile( controller.selected.name, function ( responseText ) {
            var data=JSON.parse( responseText );
            dataReadCallback( controller.selected.name, data.file );

            workspace.lastSaveType=1;

            // --- Close

            if ( VG.context.workspace.platform === VG.HostProperty.PlatformWeb )
                VG.dropZone.style.display="none";

            this.close( this );
        }.bind( this ) );

        this.label.text="Opening...";
    }.bind( this );
    treeWidget.addToolWidget( openButton );

    var deleteButton=VG.UI.Button( "DELETE" );
    deleteButton.toolTip=`Delete the selected Project from the ${VG.context.workspace.appName} Cloud.`;
    deleteButton.disabled=true;
    deleteButton.clicked=function() {

        // --- Request list of files

        if ( !controller.selected ) return;

        var parameters={};
        var url="/upload/" + workspace.appId + "/id/" + controller.selected.serverId;

        VG.sendBackendRequest( url, JSON.stringify( parameters ), function( data ) {
            var obj=JSON.parse( data );

            if ( obj.status === 'ok' )
                this.label.text="File deleted successfully.";
            else this.label.text="Error during deletion!";

            getFileList();
        }.bind( this ), "DELETE" );

        this.label.text="Deleting...";

    }.bind( this );
    treeWidget.addToolWidget( deleteButton );

    // ---

    var controller=treeWidget.bind( dc, "fileList" );

    controller.addObserver( "changed", function() {
        deleteButton.disabled=controller.length > 0 ? false : true;
    }.bind( this ) );

    controller.addObserver( "selectionChanged", function() {
        deleteButton.disabled=!controller.selected;
    }.bind( this ) );

    function getFileList() {
        if ( workspace.userName )
        {
            dc.fileList=[];

            // --- Request list of files

            var parameters={};
            var url="/upload/" + workspace.appId;

            VG.sendBackendRequest( url, JSON.stringify( parameters ), function( responseText ) {
                var response=JSON.parse( responseText );
                for ( var i =0; i < response.files.length; ++i )
                {
                    var item=response.files[i];

                    if ( item.user === VG.context.workspace.userId ) {
                        var fileItem=new VG.RemoteProjectItem();
                        fileItem.text=VG.Utils.fileNameFromPath( item.name, true );
                        fileItem.size=VG.Utils.bytesToSize(item.size);
                        fileItem.name=item.name;
                        fileItem.serverId=item._id;
                        fileItem.type=VG.context.workspace.projectShortName ? VG.context.workspace.projectShortName : "";
                        controller.add( "", fileItem );
                    }
                }

                if ( controller.length ) controller.selected=controller.at( 0 );
                //this.label.text="";
            }.bind( this ), "GET" );
        }
    }

    getFileList();

    // --- Top Layout

    var labelLayout=VG.UI.LabelLayout();

    var openFromMenu=VG.UI.DropDownMenu( "Computer", `${VG.context.workspace.appName} Cloud` );
    openFromMenu.menuIsUp=true;
    openFromMenu.changed=function( index ) {
        if ( index === 0 ) {
            stackedLayout.current=localLayout;
            dropArea.makeVisible=true;
        } else
        if  ( index === 1 ) {

            if ( VG.context.workspace.platform === VG.HostProperty.PlatformWeb )
                VG.dropZone.style.display="none";

            if ( !workspace.userName )
                stackedLayout.current=loginLayout;
            else stackedLayout.current=treeWidget;
        }
    }.bind( this );

    labelLayout.addChild( "Open From", openFromMenu );

    // ---

    var stackedLayout=VG.UI.StackedLayout();
    stackedLayout.current= VG.context.workspace.userId ? treeWidget : localLayout;
    openFromMenu.index = VG.context.workspace.userId ? 1 : 0;

    this.layout=VG.UI.Layout( labelLayout, stackedLayout );
    this.layout.vertical=true;
    this.layout.calcSize=function( canvas ) {
        return VG.Core.Size( 800, 480 );
    }.bind( this.layout );

    openFromMenu.setFocus();

    // ---

    this.addButton( "CLOSE", function() {

        if ( VG.context.workspace.platform === VG.HostProperty.PlatformWeb )
            VG.dropZone.style.display="none";

        this.close( this );
    }.bind( this ) );
};

VG.RemoteOpenProject.prototype=VG.UI.Dialog();

// ----------------------------------------------------------------------------------- VG.RemoteSaveProject

VG.RemoteSaveProject=function( workspace, dataWriteCallback )
{
    if ( !(this instanceof VG.RemoteSaveProject) ) return new VG.RemoteSaveProject( workspace, dataWriteCallback );

    VG.UI.Dialog.call( this, "Save Project" );

    this.buttonLayout.margin.top /= 4;
    this.buttonLayout.margin.spacing /= 4;

    //this.layout=VG.UI.LabelLayout();

    // --- Download Layout

    var downloadLabel=VG.UI.Label();
    downloadLabel.text="The Projectfile will be downloaded to the \"Downloads\" folder of your Computer.";

    var downloadButton=VG.UI.Button( "DOWNLOAD" );
    downloadButton.clicked=function() {

        var fileName = nameEdit.text;
        if ( workspace.projectExtension )fileName+=workspace.projectExtension;

        dataWriteCallback( { "filePath" : fileName, "download" : true } );

        this.label.text="\"" + fileName + "\" download request send successfully.";
    }.bind( this );

    var downloadLayout=VG.UI.LabelLayout( "", downloadLabel, "", downloadButton );
    downloadLayout.margin.left=0;
    downloadLayout.vertical=true;

    // --- Login first Layout

    var loginLabel=VG.UI.Label();
    loginLabel.text = `You have to login first to be able to use the ${VG.context.workspace.appName} Cloud.`;

    var loginLayout=VG.UI.LabelLayout( "", loginLabel );

    loginLayout.margin.left=0;
    loginLayout.vertical=true;

    // --- Visual Graphics Cloud

    var dc=VG.Data.Collection( "File List" );
    dc.fileList=[];

    var treeWidget=new VG.UI.TreeWidget();
    treeWidget.addColumn( { name : "Name", itemName : "text", width : 60 } );
    treeWidget.addColumn( { name : "Type", itemName : "type", width : 20 } );
    treeWidget.addColumn( { name : "Size", itemName : "size", width : 20 } );
    // treeWidget.itemHeight=68;

    var saveButton=VG.UI.Button( "SAVE" );
    saveButton.toolTip=`Save the Project to the ${VG.context.workspace.appName} Cloud.`;
    saveButton.clicked=function() {

        var fileName = nameEdit.text;
        if ( workspace.projectExtension ) fileName+=workspace.projectExtension;

        dataWriteCallback( { "filePath" : fileName }, function( data ) {
            var obj=JSON.parse( data );

            if ( obj.status === 'ok' )
                this.label.text="File saved successfully.";
            else this.label.text="Error during saving!";

            getFileList();
        }.bind( this ) );

        this.label.text="Saving...";

    }.bind( this );
    treeWidget.addToolWidget( saveButton );

    var deleteButton=VG.UI.Button( "DELETE" );
    deleteButton.toolTip=`Delete the selected Project from the ${VG.context.workspace.appName} Cloud.`;
    deleteButton.disabled=true;
    deleteButton.clicked=function() {

        // --- Request list of files

        if ( !controller.selected ) return;

        var parameters={};
        var url="/upload/" + workspace.appId + "/id/" + controller.selected.serverId;

        VG.sendBackendRequest( url, JSON.stringify( parameters ), function( data ) {
            var obj=JSON.parse( data );

            if ( obj.status === 'ok' )
                this.label.text="File deleted successfully.";
            else this.label.text="Error during deletion!";

            getFileList();
        }.bind( this ), "DELETE" );

        this.label.text="Deleting...";

    }.bind( this );
    treeWidget.addToolWidget( deleteButton );

    // ---

    var controller=treeWidget.bind( dc, "fileList" );

    controller.addObserver( "changed", function() {
        deleteButton.disabled=controller.length > 0 ? false : true;
    }.bind( this ) );

    controller.addObserver( "selectionChanged", function() {
        deleteButton.disabled=!controller.selected;

        if ( controller.selected )
            nameEdit.text = controller.selected.text;
    }.bind( this ) );

    function getFileList() {
        if ( workspace.userName )
        {
            dc.fileList=[];

            // --- Request list of files

            var parameters={};
            var url="/upload/" + workspace.appId;

            VG.sendBackendRequest( url, JSON.stringify( parameters ), function( responseText ) {
                var response=JSON.parse( responseText );
                for ( var i =0; i < response.files.length; ++i )
                {
                    var item=response.files[i];

                    if ( item.user === VG.context.workspace.userId ) {
                        var fileItem=new VG.RemoteProjectItem();
                        fileItem.text=VG.Utils.fileNameFromPath( item.name, true );
                        fileItem.size=VG.Utils.bytesToSize(item.size);
                        fileItem.type=VG.context.workspace.projectShortName ? VG.context.workspace.projectShortName : "";
                        fileItem.serverId=item._id;
                        controller.add( "", fileItem );
                    }
                }

                // if ( controller.length ) controller.selected=controller.at( 0 );
                //this.label.text="";
            }.bind( this ), "GET" );
        }
    }

    getFileList();

    // --- Top Layout

    var nameEdit=VG.UI.TextLineEdit();
    nameEdit.text=workspace.projectName;

    var extensionLabel=VG.UI.Label();
    extensionLabel.text="An extension of \'" + workspace.projectExtension + "\' will be automatically added.";

    var labelLayout=VG.UI.LabelLayout( "Project Name", nameEdit );
    if ( workspace.projectExtension ) labelLayout.addChild( "", extensionLabel );

    var saveToMenu=VG.UI.DropDownMenu( "Download", `${VG.context.workspace.appName} Cloud` );
    saveToMenu.changed=function( index ) {
        if ( index === 0 ) stackedLayout.current=downloadLayout;
        else
        if  ( index === 1 ) {
            if ( !workspace.userName )
                stackedLayout.current=loginLayout;
            else stackedLayout.current=treeWidget;
        }
    }.bind( this );

    labelLayout.addChild( "Save To", saveToMenu );

    // ---

    var stackedLayout=VG.UI.StackedLayout();
    stackedLayout.current= VG.context.workspace.userId ? treeWidget : downloadLayout;
    saveToMenu.index = VG.context.workspace.userId ? 1 : 0;

    //labelLayout.addChild( "", stackedLayout );

    this.layout=VG.UI.Layout( labelLayout, VG.UI.LayoutVSeparator(), stackedLayout );
    this.layout.vertical=true;
    //this.layout.margin.top=20;
    this.layout.calcSize=function( canvas ) {
        //this.preferredSize.width=400;
        //this.preferredSize.height=420;
        return VG.Core.Size( 800, 480 );
    }.bind( this.layout );

    nameEdit.setFocus();


    // ---

    this.addButton( "CLOSE", function() { this.close( this ); }.bind( this ) );
};

VG.RemoteSaveProject.prototype=VG.UI.Dialog();

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.UI.NewsScrollerItem

VG.UI.ScrollerImageItem=function( image )
{
    if ( !(this instanceof VG.UI.ScrollerImageItem) ) return new VG.UI.ScrollerImageItem( image );

    this.rect = new VG.Core.Rect();
    this.contentRect = new VG.Core.Rect();
    this.image=image;
};

VG.UI.ScrollerImageItem.prototype.paintWidget=function( canvas )
{
    if ( this.image.isValid() ) {

        let rect1=this.contentRect;
        rect1.copy( this.rect );

        if ( this.image.width < this.rect.width )
            rect1.x=this.rect.x + (this.rect.width - this.image.width)/2;

        if ( this.image.height < this.rect.height )
            rect1.y=this.rect.y + (this.rect.height - this.image.height)/2;

        canvas.drawImage( rect1, this.image );
    }
};

// ----------------------------------------------------------------- VG.UI.Scroller

VG.UI.Scroller=function()
{
    if ( !(this instanceof VG.UI.Scroller) ) return new VG.UI.Scroller();

    VG.UI.Widget.call( this );
    this.name="Scroller";

    this.supportsFocus=true;
    this.supportsAutoFocus=true;

    this.items=[];
    this.current=null;
    this.currentIndex=0;

    this.nextAnimationEventAt=0;

    this.animStartTime=-1;
    this.animDuration=600;
    this.animDirectionLeft=true;
    this.animPeriod=8000*2;

    this.circleColor=VG.Core.Color( 255, 255, 255 );
    this.titleColor=VG.Core.Color( 255, 255, 255 );
    this.titleFont=VG.Font.Font( "Open Sans Bold", 20 );
    this.blurbBackColor=VG.Core.Color();
    this.blurbBackColor.a=0.6;
    this.htmlFont=VG.Font.Font( "Open Sans Semibold", 8 );

    this.blurbAlpha=0;
};

VG.UI.Scroller.prototype=VG.UI.Widget();

VG.UI.Scroller.prototype.addItem=function( item )
{
    this.items.push( item );
    item._circleRect=VG.Core.Rect();
    if ( !this.current ) this.current=item;
};

VG.UI.Scroller.prototype.scrollLeft=function( canvas )
{
    this.nextAnimationEventAt = new Date().getTime();
    this.animDirectionLeft = true;
    VG.update();
};

VG.UI.Scroller.prototype.scrollRight=function( canvas )
{
    this.nextAnimationEventAt = new Date().getTime();
    this.animDirectionLeft = false;
    VG.update();
};

VG.UI.Scroller.prototype.paintWidget=function( canvas )
{
    if ( !this.current ) return;

    // --- Period Handling

    if ( this.items.length > 1 ) {
        let time = new Date().getTime();

        if ( this.nextAnimationEventAt === 0 )
        {
            this.nextAnimationEventAt=time + this.animPeriod;
            VG.context.workspace.redrawList.push( this.nextAnimationEventAt );
        } else {

            if ( time > this.nextAnimationEventAt )
            {
                // --- Inside Scroll Event

                if ( !this.animActive ) this.animStartTime=time;

                if ( ( time - this.animStartTime ) <= this.animDuration )
                {
                    this.animActive=true;
                    this.animOffset=time - this.animStartTime;

                    this.nextAnimationEventAt=time + 1;
                    VG.context.workspace.redrawList.push( this.nextAnimationEventAt );
                } else
                {
                    this.animActive=false;
                    this.animOffset=0;

                    this.currentIndex++;
                    if ( this.currentIndex >= this.items.length )
                    this.currentIndex=0;

                    this.animDirectionLeft=true;
                    this.nextAnimationEventAt=time + this.animPeriod;
                    VG.context.workspace.redrawList.push( this.nextAnimationEventAt );
                }
            }
        }
    }

    // --- Draw the item (normal + animated)

    this.current=this.items[this.currentIndex];

    let rect=this.contentRect;
    rect.copy( this.rect );

    if ( this.animActive ) {
        this.animPixelOffset = this.animOffset * this.contentRect.width / this.animDuration;

        rect.x -= this.animDirectionLeft ? this.animPixelOffset : -this.animPixelOffset;

        this.current.rect.copy( rect );
        this.current.paintWidget( canvas );

        let nextIndex;
        if ( this.animDirectionLeft ) {
            nextIndex = this.currentIndex + 1;
            if ( nextIndex >= this.items.length ) nextIndex = 0;
        } else {
            nextIndex = this.currentIndex - 1;
            if ( nextIndex < 0 ) nextIndex = this.items.length - 1;
        }
        let nextItem=this.items[nextIndex];

        rect.copy( this.rect );

        if ( this.animDirectionLeft ) rect.x = this.rect.right() - this.animPixelOffset;
        else rect.x -= this.contentRect.width - this.animPixelOffset;

        nextItem.rect.copy( rect );
        nextItem.paintWidget( canvas );
    } else {
        this.current.rect.copy( rect );
        this.current.paintWidget( canvas );

        // --- Draw the Circles

        if ( this.items.length > 1 ) {
            // let xOff = this.rect.right() - 13 - this.items.length * 10 - (this.items.length-1) * 6;
            let xOff = this.rect.x + ( this.rect.width - this.items.length * 10 - (this.items.length-1) * 6) / 2;
            for ( let i=0; i < this.items.length; ++i )
            {
                rect.copy( this.rect );
                rect.x = xOff; rect.y = rect.bottom() - 20;

                if ( this.currentIndex === i ) {
                    rect.width = 10; rect.height = 10;
                    this.circleColor.a = 1.0;
                }
                else {
                    rect.width = 6; rect.height = 6;
                    rect.y += 2;
                    this.circleColor.a = 0.5;
                }

                canvas.draw2DShapeGL( VG.Canvas.Shape2D.Circle, rect, this.circleColor );
                this.items[i]._circleRect.copy( rect );

                xOff += 10 + 6;
            }
        }
    }
};

/*
 * Copyright (c) 2017 Markus Moenig <markus@moenig.tv>
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

RichText = {};

/**
 * Measures the given text.
 * @param {string} text
 * @param {string} fontText - The font
 * @returns {object} metrics
 */

RichText.measureText = function( text, fontText )
{
    // Based on https://github.com/ryansturmer/em.js/blob/master/em.js

    let metrics = {};

    this.ctx.font = fontText;
    this.ctx.textBaseline = 'top';
    metrics.width = this.ctx.measureText( text ).width;

    let textSpan = document.createElement('span');
    textSpan.innerHTML = text;
    textSpan.style.font = fontText;

    let block = document.createElement("div");
    block.style.display = 'inline-block';
    block.style.width = '1px';
    block.style.height = '0px';

    let div = document.createElement('div');
    div.appendChild(textSpan);
    div.appendChild(block);

    let body = document.body;
    body.appendChild(div);

    metrics.ascent = -1;
    metrics.descent = -1;
    metrics.height = -1;

    try {
        block.style['vertical-align'] = 'baseline';
        metrics.ascent = block.offsetTop - textSpan.offsetTop;
        block.style['vertical-align'] = 'bottom';
        metrics.height = block.offsetTop - textSpan.offsetTop;
        metrics.descent = metrics.height - metrics.ascent;
    } finally {
        document.body.removeChild(div);
    }

    // if ( !text.includes('q') && !text.includes('y') && !text.includes('j') && !text.includes('g') && !text.includes('J') ) {
        // metrics.height -= metrics.descent;
        // metrics.descent = 0;
    // }

    return metrics;
};

/**
 * Manages the list of elements for the document. Each element contains text for a specific font.
 * @constructor
 */

RichText.ElementManager = class {

    constructor( defaultFont ) {
        this.elements = [];
        this.defaultFont = defaultFont;
    }

    /**
     * @returns {number} The length of the element array.
     */

    length() {
        return this.elements.length;
    }

    /**
     * Returns the element object at the given index.
     * @param {number} index
     * @returns {object} The elements at the given index.
     */

    at( index ) {
        return this.elements[index];
    }

   /**
     * Creates a new element;
     */

    createElement( font )
    {
        if ( !font ) font = this.defaultFont;
        let el = { text : "", font : Object.assign( {}, font ) };
        Object.defineProperty( el, "words", { enumerable: false, writable: true } );
        return el;
    }

    /**
     * Returns the current element.
     */

    getCurrentElement()
    {
        if ( !this.current ) {
            this.current = this.createElement();
            this.elements.push( this.current );
        }

        return this.current;
    }

    /**
     * @returns the element before the given element.
     */

    getPreviousElement( el )
    {
        let index = this.elements.indexOf( el );
        if ( index )
            return this.elements[index-1];
    }

    /**
     * @returns the element after the given element.
     */

    getNextElement( el )
    {
        let index = this.elements.indexOf( el );
        if ( index < this.elements.length )
            return this.elements[index+1];
    }


    /**
     * Removes the given element.
     * @param {object} el - the element to remove
     */

    removeElement( el )
    {
        let index = this.elements.indexOf( el );
        if ( index !== -1 ) this.elements.splice( index, 1 );
    }

    /**
     * Splits the element at the given offset, inserts the new element and returns it.
     * @param {*} el
     * @param {*} offset
     * @returns {object} The created element.
     */

    splitElement( el, offset ) {
        let newEl = this.createElement();
        newEl.font = Object.assign( {}, el.font );

        let index = this.elements.indexOf( el );
        this.elements.splice( index + 1, 0, newEl );

        newEl.text = el.text.substr( offset );
        el.text = el.text.substr( 0, offset );

        this.rewordElement( el );
        this.rewordElement( newEl );

        return newEl;
    }

    /**
     * Inserts the element at the given location.
     * @param {*} el
     * @param {*} loc
     */

    insertElementAt( el, loc )
    {
        // console.log( loc.element.text.length, loc.offset );
        if ( loc.element.text.length === loc.offset ) {
            // --- Insert it behind the location element
            let index = this.elements.indexOf( loc.element );
            this.elements.splice( index + 1, 0, el );
        } else
        if ( loc.offset === 0 ) {
            // --- Insert it before the location element
            let index = this.elements.indexOf( loc.element );
            this.elements.splice( Math.min( index - 1, 0 ), 0, el );
        } else {
            this.splitElement( loc.element, loc.offset );
            let index = this.elements.indexOf( loc.element );
            this.elements.splice( index + 1, 0, el );
        }
    }

    /**
     *
     * @param {*} el
     * @param {*} fromElement
     * @param {*} toElement
     * @returns {bool} True if the given element is located between the from and to element, false otherwise.
     */

    isElementInsideRange( el, fromElement, toElement )
    {
        let fromIndex = this.elements.indexOf( fromElement ), toIndex = this.elements.indexOf( toElement );
        if ( fromIndex === -1 || toIndex === -1 ) return false;

        let index = this.elements.indexOf( el );

        if ( index >= fromIndex && index <= toIndex ) return true;
        else return false;
    }

    /**
     * Deletes the given range between the two locations.
     * @param {*} fromLoc
     * @param {*} toLoc
     * @returns {object} The new location.
     */

    deleteRange( fromLoc, toLoc )
    {
        let elements = [];
        let newLoc = {};
        for( let i = 0; i < this.elements.length; ++i )
        {
            let el = this.elements[i];

            if ( this.isElementInsideRange( el, fromLoc.element, toLoc.element ) )
            {
                if ( el !== fromLoc.element && el !== toLoc.element )
                    continue; // Delete if inside range
                else
                if ( el === fromLoc.element && el === toLoc.element )
                {
                    let text = fromLoc.element.text;
                    fromLoc.element.text = text.substr( 0, fromLoc.offset ) + text.substr( toLoc.offset, text.length - toLoc.offset );
                    this.rewordElement( fromLoc.element );

                    elements.push( fromLoc.element );
                    newLoc.element = fromLoc.element;
                    newLoc.offset = fromLoc.offset;
                } else
                if ( el === fromLoc.element )
                {
                    let text = fromLoc.element.text;
                    fromLoc.element.text = text.substr( 0, fromLoc.offset );
                    this.rewordElement( fromLoc.element );

                    elements.push( fromLoc.element );
                    newLoc.element = fromLoc.element;
                    newLoc.offset = fromLoc.offset;
                } else
                if ( el === toLoc.element )
                {
                    let text = toLoc.element.text;
                    toLoc.element.text = text.substr( toLoc.offset, text.length - toLoc.offset );
                    this.rewordElement( toLoc.element );

                    elements.push( toLoc.element );
                }
            } else elements.push( el );
        }
        this.elements = elements;
        return newLoc;
    }

    /**
     * Applies the font to the range between the two locations.
     * @param {*} font
     * @param {*} fromLoc
     * @param {*} toLoc
     * @returns {object} The new location.
     */

    applyFontToRange( font, fromLoc, toLoc )
    {
        let elements = [];
        let newLoc = {};

        let newFromElement, newFromOffset;
        let newToElement, newToOffset;

        for( let i = 0; i < this.elements.length; ++i )
        {
            let el = this.elements[i];

            if ( this.isElementInsideRange( el, fromLoc.element, toLoc.element ) )
            {
                if ( el !== fromLoc.element && el !== toLoc.element )
                {
                    // --- If inside the range, apply font to the whole element
                    el.font = Object.assign( {}, font );
                    this.rewordElement( el );
                    elements.push( el );
                }
                else
                if ( el === fromLoc.element && el === toLoc.element )
                {
                    if ( fromLoc.offset === 0 && toLoc.offset === el.text.length )
                    {
                        // --- The whole element is selected
                        el.font = Object.assign( {}, font );
                        this.rewordElement( el );
                        elements.push( el );

                        newLoc.element = el;
                        newLoc.offset = el.text.length;
                    } else {
                        let text = el.text;

                        if ( fromLoc.offset ) {
                            el.text = text.substr( 0, fromLoc.offset );
                            this.rewordElement( el );
                            elements.push( el );
                        }

                        let middleEl = this.createElement( font );
                        middleEl.text = text.substr( fromLoc.offset, toLoc.offset - fromLoc.offset );
                        this.rewordElement( middleEl );
                        elements.push( middleEl );

                        newFromOffset = 0;
                        newFromElement = middleEl;

                        if ( text.length - toLoc.offset ) {
                            let endEl = this.createElement( toLoc.element.font );
                            endEl.text = text.substr( toLoc.offset, text.length - toLoc.offset );
                            this.rewordElement( endEl );
                            elements.push( endEl );
                        }

                        newToOffset = middleEl.text.length;
                        newToElement = middleEl;

                        newLoc.element = middleEl;
                        newLoc.offset = middleEl.text.length;
                    }
                } else
                if ( el === fromLoc.element )
                {
                    let text = el.text;
                    if ( fromLoc.offset === 0 ) el.font = Object.assign( {}, font );
                    else if ( fromLoc.offset > 0 ) el.text = text.substr( 0, fromLoc.offset );
                    this.rewordElement( el );
                    elements.push( el );

                    if ( fromLoc.offset > 0 ) {
                        let middleEl = this.createElement( font );
                        middleEl.text = text.substr( fromLoc.offset, text.length - fromLoc.offset );
                        this.rewordElement( middleEl );
                        elements.push( middleEl );

                        newFromOffset = 0;
                        newFromElement = middleEl;
                    }
                } else
                if ( el === toLoc.element )
                {
                    let text = el.text;
                    let oldFont = Object.assign( {}, el.font );
                    el.text = text.substr( 0, toLoc.offset );
                    el.font = Object.assign( {}, font );
                    this.rewordElement( el );
                    elements.push( el );

                    newToOffset = el.text.length;
                    newToElement = el;

                    newLoc.offset = el.text.length;
                    newLoc.element = el;

                    if ( toLoc.offset < text.length ) {
                        let middleEl = this.createElement( oldFont );
                        middleEl.text = text.substr( toLoc.offset, text.length - toLoc.offset );
                        this.rewordElement( middleEl );
                        elements.push( middleEl );
                    }
                }
            } else elements.push( el );
        }
        this.elements = elements;

        // --- Adjust the selection if necessary

        if ( newFromElement ) {
            fromLoc.element = newFromElement;
            fromLoc.offset = newFromOffset;
        }

        if ( newToElement ) {
            toLoc.element = newToElement;
            toLoc.offset = newToOffset;
        }

        return newLoc;
    }

    /**
     * Returns the elements inside the given range. The text of the elements is truncated to reflect the range.
     * @param {*} fromLoc
     * @param {*} toLoc
     * @returns {array} The elements inside the range.
     */

    getRange( fromLoc, toLoc )
    {
        let elements = [];

        for( let i = 0; i < this.elements.length; ++i )
        {
            let el = this.elements[i];

            if ( this.isElementInsideRange( el, fromLoc.element, toLoc.element ) )
            {
                if ( el !== fromLoc.element && el !== toLoc.element )
                {
                    elements.push( el );
                }
                else
                if ( el === fromLoc.element && el === toLoc.element )
                {
                    if ( fromLoc.offset === 0 && toLoc.offset === el.text.length )
                    {
                        // --- The whole element is selected
                        elements.push( el );
                    } else {
                        let text = el.text;
                        let element = this.createElement( el.font );
                        element.text = text.substr( fromLoc.offset, toLoc.offset - fromLoc.offset );
                        elements.push( element );
                    }
                } else
                if ( el === fromLoc.element )
                {
                    let text = el.text;
                    let element = this.createElement( el.font );
                    element.text = text.substr( fromLoc.offset, text.length - fromLoc.offset );
                    elements.push( element );
                } else
                if ( el === toLoc.element )
                {
                    let text = el.text;
                    let element = this.createElement( el.font );
                    element.text = text.substr( 0, toLoc.offset );
                    elements.push( element );
                }
            }
        }

        return elements;
    }

    /**
     *
     * @param {object} fromLoc
     * @param {object} toLoc
     */

    createFontForRange( fromLoc, toLoc ) {
        let font = {
            attributes : {},
        };

        let set = ( font, elFont, name ) => {
            if ( !font[name] ) font[name] = elFont[name];
            else if ( font[name] != elFont[name] ) font[name] = -1;
        };

        let setAttribute = ( font, elFont, name ) => {
            if ( font.attributes[name] === undefined ) font.attributes[name] = elFont.attributes[name];
            else if ( font.attributes[name] !== elFont.attributes[name] ) font.attributes[name] = -1;
        };

        for( let i = 0; i < this.elements.length; ++i )
        {
            let el = this.elements[i];

            if ( this.isElementInsideRange( el, fromLoc.element, toLoc.element ) )
            {
                let elFont = el.font;

                set( font, elFont, "name" );
                set( font, elFont, "text" );
                set( font, elFont, "size" );
                set( font, elFont, "style" );
                if ( elFont.link ) {
                    font.link = Object.assign( {}, elFont.link );
                }
                setAttribute( font, elFont, "bold" );
                setAttribute( font, elFont, "italic" );
            }
        }
        return font;
    }

    /**
     * Clean
     */

    clean( )
    {
        let elements = [];
        for( let i = 0; i < this.elements.length; ++i )
        {
            let el = this.elements[i];

            if ( el.words ) elements.push( el );
        }
        this.elements = elements;
    }

    /**
     * Parses the given element and creates an array of words with their prefixes from the element's text.
     */

    rewordElement( el )
    {
        el.words = [];
        el.maxWordHeight = 0;
        el.maxAscent = 0;
        el.maxDescent = 0;

        let prefix = "";
        let word = "";

        let pushWord = ( prefix, word, offset ) => {
            let obj = { prefix : prefix, word : word, lineBreak : false };

            obj.prefixMetrics = RichText.measureText( prefix, el.font.text );
            obj.wordMetrics = RichText.measureText( word, el.font.text );

            if ( el.imageName ) {
                obj.wordMetrics.width = el.imageWidth;
                obj.wordMetrics.height = el.imageHeight;
                obj.wordMetrics.ascent = el.imageHeight;
                obj.wordMetrics.descent = 0;
            }

            // --- Calculate offset into the elements text
            obj.offset = offset;
            if ( prefix.length ) obj.offset -= prefix.length;
            if ( word.length ) obj.offset -= word.length;
            obj.endOffset = offset;

            obj.width = obj.prefixMetrics.width + obj.wordMetrics.width;
            obj.height = Math.max( obj.prefixMetrics.height, obj.wordMetrics.height );

            el.maxAscent = Math.max( el.maxAscent, obj.wordMetrics.ascent );
            el.maxDescent = Math.max( el.maxDescent, obj.wordMetrics.descent );

            obj.text = prefix + word;

            el.words.push( obj );
        };

        let pushLineBreak = () => {
            el.words.push( { lineBreak : true } );
        };

        for ( let i = 0; i < el.text.length; ++i )
        {
            let c = el.text.charAt( i );

            if ( c === ' ' )
            {
                if ( word.length ) {
                    pushWord( prefix, word, i );
                    prefix = ""; word = "";
                }
                prefix += c;
            } else
            if ( c == '\n' )
            {
                if ( prefix.length || word.length )
                    pushWord( prefix, word, i );

                pushLineBreak();
                prefix = ""; word = "";
            }
            else word += c;
        }

        if ( prefix.length || word.length )
            pushWord( prefix, word, el.text.length );
    }
};

/**
 * The editor class.
 * @constructor
 */

RichText.Editor = class {

    constructor( { canvas, defaultFont, tagList, selectionStyle, linkStyle, readOnly = false } = {} ) {

        this.canvas = canvas;
        this.ctx = canvas.getContext('2d');
        RichText.ctx = this.ctx;

        this.defaultFont = defaultFont;
        this.tagList = tagList;
        this.selectionStyle = selectionStyle ? selectionStyle : '#b2d0ee';
        this.linkStyle = linkStyle ? linkStyle : 'blue';
        this.readOnly = readOnly;

        this.wordWrap = true;

        this.blinkStateChanged = 0;

        this.cursorLocation = {
            x : 0,
            y : 0,
            offset : 0,
        };

        this.scrollBarWidth = 0;
        this.needsScrollBar = false;

        this.elements = new RichText.ElementManager( defaultFont );

        this.handleOffset = 0;
        this.handleDragOffset = 0;

        this._redraw = () => this.draw();
        this._fontChanged = () => {};
        this._contentChanged = () => {};
        this._gotoUrl = () => {};
        this._scrollBarFunc = () => {};
        this._getImage = () => {};

        this.vOffset = 0;
        this.focus = true;
        this.clearBackground = true;

        this.defaultFontHeight = RichText.measureText( "H", defaultFont.text ).height;
    }

    /**
     * Sets the focus state of the editor. When the editor does not have focus, the cursor will not be animated.
     * @param {boolean} focus
     */

    setFocus( focus ) {
        this.focus = focus;
        this.mouseIsDown = false;
        if ( focus ) {
            this.resetBlinkState();
            this.updateBlinkState();
            this._redraw();
        } else {
            this.blinkState = false;
            this._redraw();
        }
    }

    /**
     * @returns {boolean} The focus state of the editor.
     */

    hasFocus() {
        return this.focus;
    }

    /**
     * Sets the redraw callback function. When the editor needs to be redrawn, it calls this function. The callback mostly just calls the draw() function.
     * @param {function} func
     */

    needsRedraw( func ) {
        this._redraw = func;
    }

    /**
     * Sets the callback for the content changed event.
     * @param {function} func - Called when the editor content changes.
     */

    contentChanged( func ) {
        this._contentChanged = func;
    }

    /**
     * Sets the callback for the link clicked event.
     * @param {function} func - Called when a link is clicked in the editor.
     */

    gotoUrl( func ) {
        this._gotoUrl = func;
    }

    /**
     * Sets the callback for the font changed event.
     * @param {function} func - Called when the font under the cursor changes.
     */

    fontChanged( func ) {
        this._fontChanged = func;
    }

    /**
     * Sets the callback for the get image event.
     * @param {function} func - Called when an image needs to be displayed.
     */

    getImage( func ) {
        this._getImage = func;
    }

    /**
     * Deletes the current selection (if any).
     */

     deleteSelection() {
         if ( this.selection )
             this.keyDown( "Backspace" );
     }

    /**
     * Set the scrollbar code for the vertical scrollbar.
     * @param {object} width - Width of the scrollbar
     * @param {function} func - Called when the scrollbar needs to be drawn
     */

     setScrollBar( width, func )
     {
        this.scrollBarWidth = width;
        this._scrollBarFunc = func;
     }

    /**
     * Sets the cursor at the specified text offset.
     * @param {*} offset
     */

    setCursor( offset )
    {
        if ( this.elements.length() ) {
            let loc = {};
            loc.offset = offset;

            this.elements.current = loc.element;
            this.cursorLocation = loc;
        }
    }

    /**
     * Sets the given font.
     * @param {object} font - The font to apply to the editor.
     */

    setFont( font )
    {
        if ( this.selection ) {
            this.cursorLocation = this.elements.applyFontToRange( font, this.selectionStart, this.selectionEnd );
            this.linalyze();
            this.elements.current = this.cursorLocation.element;

            this.getPositionForElementOffset( this.selectionEnd.element, this.selectionEnd.offset, this.selectionEnd );
            this.getPositionForElementOffset( this.cursorLocation.element, this.cursorLocation.offset, this.cursorLocation );
            this.resetBlinkState();
            this._contentChanged( this, "Edit" );
        } else {
            if ( this.elements.current && !this.elements.current.words ) {
                this.elements.current.font = Object.assign( {}, font );
            } else {
                let el = this.elements.createElement( font );

                if ( !this.cursorLocation.element )
                    this.cursorLocation.element = el;

                this.elements.insertElementAt( el, this.cursorLocation );
                this.elements.current = el;

                this.cursorLocation.offset = 0;
            }
        }
    }

    /**
     * Sets the given image.
     * @param {string} name - The name of the image.
     * @param {string} image - The image.
     */

    setImage( { name, width, height }, sendNotification = true )
    {
        let el = this.elements.createElement();

        this.elements.insertElementAt( el, this.cursorLocation );
        this.elements.current = el;

        el.imageName = name;
        el.imageWidth = width;
        el.imageHeight = height;
        el.text = " ";

        this.elements.rewordElement( el );
        this.linalyze();

        this.cursorLocation.element = el;
        this.cursorLocation.offset = 0;

        this._contentChanged( this, "Insert Image" );
    }

    /**
     * Marks the cursor as visible, called after mouse or text events.
     */

    resetBlinkState()
    {
        this.blinkState = true;
        this.blinkStateChanged = Date.now();
    }

    /**
     * Updates the blink state. Calls setTimeout() for blink state animation.
     */

    updateBlinkState()
    {
        if ( this.readOnly ) return;
        this.redrawAt = Date.now();
        setTimeout( function() {
            let time = Date.now();
            if ( this.focus && time - this.blinkStateChanged >= 600 ) {
                this.blinkState = !this.blinkState;
                this.blinkStateChanged = time;
                this._redraw();
            }
        }.bind( this ), 600 );
    }

    /**
     * Finds the x, y position for the text offset inside the given element and writes the position into the given object.
     * @param {object} el - The element.
     * @param {number} offset - The text offset inside the element.
     * @param {object} object - The object to write the x, y coordinates into.
     */

    getPositionForElementOffset( el, offset, object )
    {
        let x, y = 0;
        let off = 0;
        let lastOffset;

        object.x = 0;

        for( let l = 0; l < this.lines.length; ++l )
        {
            let line = this.lines[l];
            x = line.offset;

            for ( let w = 0; w < line.words.length; ++w )
            {
                let lWord = line.words[w];

                if ( lWord.element === el )
                {
                    let text = lWord.text;

                    if ( lWord.wrapped ) x -= lWord.prefixMetrics.width;

                    if ( lWord.offset <= offset && lWord.offset + text.length >= offset )
                    {
                        // --- Offset is in this word

                        this.ctx.font = lWord.element.font.text;

                        // --- Find the character
                        for ( let i = 0; i < text.length; ++i )
                        {
                            let c = text.charAt( i );
                            x += this.ctx.measureText( c ).width;

                            if ( lWord.offset + i + 1 === offset ) {
                                object.x = x;
                                object.y = y;
                                object.line = line;
                                return;
                            }
                        }
                    }
                    lastOffset = lWord.endOffset;
                }

                // if ( lWord.wrapped ) x += lWord.wordMetrics.width;
                // else x += lWord.width;
                x += lWord.width;
            }

            y += line.maxHeight;

            // --- As linefeeds are not part of the words but new lines, need to check for them separately
            if ( lastOffset ) ++lastOffset;
            if ( lastOffset === offset ) {
                object.x = line.offset;
                object.y = y;
                object.line = line;
            }

            // --- When no word at all is present, make sure object is initialized correctly
            if ( lastOffset === undefined ) {
                object.x = line.offset;
                object.y = y - line.maxHeight;
                object.line = line;
            }
        }
    }

    /**
     * Finds the text location for the given x, y coordinate.
     * @param {object} pos
     * @returns {object} The location for the given coordinates
     */

    getLocationForMousePos( pos )
    {
        let x = 0, y = 0;

        for( let l = 0; l < this.lines.length; ++l )
        {
            let line = this.lines[l];
            x = line.offset;

            if ( pos.y >= y && pos.y <= ( y + line.maxHeight ) || ( l === this.lines.length - 1 ) )
            {
                // --- Mouse click was on this line
                let rc = {};
                rc.line = line;
                rc.y = y;

                for ( let w = 0; w < line.words.length; ++w )
                {
                    let lWord = line.words[w];
                    let d;

                    if ( lWord.wrapped ) {
                        // --- First word per line, only print word
                        d = lWord.wordMetrics.width;
                    } else {
                        d = lWord.width;
                    }

                    if ( pos.x >= x && pos.x <= ( x + d ) )
                    {
                        // --- Hit inside this word
                        rc.element = lWord.element;
                        rc.offset = lWord.offset;

                        let text = lWord.text;
                        if ( lWord.wrapped ) x -= lWord.prefixMetrics.width;

                        this.ctx.font = lWord.element.font.text;

                        // --- Find the character
                        for ( let i = 0; i < text.length; ++i )
                        {
                            let c = text.charAt( i );
                            let cw = this.ctx.measureText( c ).width;

                            if ( pos.x <= x + cw / 2 ) {
                                rc.x = x;
                                break;
                            } else {
                                x += cw;
                                rc.offset++;
                                if ( i === text.length - 1 )
                                    rc.x = x;
                            }
                        }
                    }

                    x += d;
                }

                if ( !rc.element ) {
                    // --- Not found, put the cursor at the end of the line

                    if ( !line.words.length )
                    {
                        // --- This line is empty, go backward to search for the last word to get element and offset

                        let prev = l - 1;
                        let lastWord;
                        let lineOffset = 1;

                        while( prev >= 0 )
                        {
                            let prevLine = this.lines[prev];
                            if ( prevLine.words.length ) {
                                lastWord = prevLine.words[prevLine.words.length-1];
                                break;
                            }
                            lineOffset += 1; --prev;
                        }

                        if ( lastWord ) {
                            rc.element = lastWord.element;
                            rc.offset = lastWord.endOffset + lineOffset;
                        } else {
                            rc.element = undefined;
                            rc.offset = 0;
                        }
                    } else
                    if ( line.words.length ) {
                        let lastWord = line.words[line.words.length-1];
                        rc.element = lastWord.element;
                        rc.offset = lastWord.endOffset;
                    }

                    rc.x = line.offset + line.maxWidth;
                }

                return rc;
            }

            if ( l < this.lines.length - 1 ) {
                x = 0;
                y += line.maxHeight;
            }
        }
    }

    /**
     * Breaks the elements into lines.
     */

    linalyze() {
        this.lines = [];
        this.maxHeight = 0;
        let width = this.needsScrollBar ? this.width - this.scrollBarWidth : this.width;

        function createLine() {
            let line = {
                words : [],
                maxHeight : 0,
                maxAscent : 0,
                maxDescent : 0,
                maxWidth : 0, // For non word-wrap cases
                offset : 0,
                symbol : "",
            };
            return line;
        }

        let pushLine = ( el, line ) => {
            if ( !line.maxAscent ) line.maxAscent = el.maxAscent;
            if ( !line.maxDescent ) line.maxDescent = el.maxDescent;

            if ( !line.maxHeight )
                line.maxHeight =  el.maxWordHeight ? el.maxWordHeight : el.maxAscent;

            if ( !line.maxAscent ) line.maxAscent = this.defaultFontHeight;
            if ( !line.maxHeight ) line.maxHeight = this.defaultFontHeight;

            this.maxHeight += line.maxHeight;
            this.lines.push( line );
        };

        let remaining = width;
        let line = createLine();
        let lastEL;
        let formatTag;

        this.elements.clean();
        for( let i = 0; i < this.elements.length(); ++i ) {
            let el = this.elements.at( i );
            lastEL = el;

            // --- Formatting
            if ( el.font.formatting && formatTag !== el.font.formatting.tag ) {
                let formatting = el.font.formatting;
                formatTag =  formatting.tag;

                pushLine( el, line );
                line = createLine();

                remaining = width - formatting.margin[0] - formatting.margin[2];

                line.offset = formatting.margin[0];
                line.symbol = "circle";
            }

            // --- Close formatting
            if ( !el.font.formatting && formatTag ) {
                formatTag = undefined;

                pushLine( el, line );
                line = createLine();
                pushLine( el, line );
                line = createLine();

                remaining = width;
            }

            // --- Parse the words
            for ( let w = 0; w < el.words.length; ++w ) {
                let word = el.words[w];
                word.wrapped = false;

                // --- line break
                if ( word.lineBreak ) {

                    // if ( lastEL.imageName ) line.offset = remaining / 2;

                    pushLine( el, line );
                    line = createLine();
                    remaining = width;

                    if ( el.font.formatting ) {
                        line.offset = el.font.formatting.margin[0];
                        remaining -= line.offset + el.font.formatting.margin[2];
                        line.symbol = "circle";
                    }

                    continue;
                }

                // --- Word wrap
                if ( this.wordWrap && word.width > remaining  ) {
                    this.lines.push( line );
                    this.maxHeight += line.maxHeight;
                    line = createLine();
                    remaining = width;
                    word.wrapped = true;
                    if ( el.font.formatting ) {
                        line.offset = el.font.formatting.margin[0];
                        remaining -= line.offset + el.font.formatting.margin[2];
                    }
                }

                // --- Insert word
                if ( word.width <= remaining ) {
                    // --- Insert the original element for reference
                    Object.defineProperty( word, "element", { enumerable: false, writable: true } );
                    word.element = el;
                    // ---
                    line.words.push( word );

                    line.maxHeight = Math.max( line.maxHeight, word.height );
                    line.maxAscent = Math.max( line.maxAscent, el.maxAscent );
                    line.maxDescent = Math.max( line.maxDescent, el.maxDescent );

                    if ( word.wrapped ) {
                        // --- Word was wrapped, no prefix
                        remaining -= word.wordMetrics.width;
                        line.maxWidth += word.wordMetrics.width;
                    } else {
                        remaining -= word.width;
                        line.maxWidth += word.width;
                    }
                }
            }
        }

        if ( lastEL ) {
            if ( !line.maxAscent ) line.maxAscent = lastEL.maxAscent;
            if ( !line.maxDescent ) line.maxDescent = lastEL.maxDescent;

            if ( !line.maxHeight )
                line.maxHeight =  lastEL.maxWordHeight ? lastEL.maxWordHeight : lastEL.maxAscent;
        }

        // --- If no element with words, get the line height from the default font
        if ( !line.maxAscent ) line.maxAscent = this.defaultFontHeight;
        if ( !line.maxHeight ) line.maxHeight = this.defaultFontHeight;

        this.maxHeight += line.maxHeight;
        this.lines.push( line );

        // --- ScrollBar
        this.needsScrollBar = this.maxHeight > this.height;

        if ( this.needsScrollBar ) {
            if ( this.scrollBarWidth )
                if ( width === this.width )
                    this.linalyze();
        }
    }

    /**
     * Receives plain text input.
     * @param {string} text
     */

    textInput( text, sendNotification = true )
    {
        if ( this.readOnly ) return;

        if ( this.selection ) {
            this.cursorLocation = this.elements.deleteRange( this.selectionStart, this.selectionEnd );
            this.linalyze();
            this.selection = false;
            this.elements.current = this.cursorLocation.element;
        }
        let el = this.elements.getCurrentElement();

        let insert = ( str, index, value ) => {
            return str.substr(0, index) + value + str.substr(index);
        };

        el.text = insert( el.text, this.cursorLocation.offset, text );

        this.elements.rewordElement( el );
        this.linalyze();
        this.resetBlinkState();

        this.cursorLocation.offset += text.length;
        this.cursorLocation.element = el;
        this.getPositionForElementOffset( el, this.cursorLocation.offset, this.cursorLocation );

        if ( sendNotification ) this._contentChanged( this, "Edit" );
    }

    /**
     * Processes a keyDown event. The key is in a human readable string format like "Enter".
     * @param {string} key
     */

    keyDown( key )
    {
        if ( this.readOnly ) return;
        if ( this.selection ) {
            this.cursorLocation = this.elements.deleteRange( this.selectionStart, this.selectionEnd );
            this.linalyze();
            this.selection = false;
            this.elements.current = this.cursorLocation.element;
            if ( key === "Backspace" ) {
                this.getPositionForElementOffset( this.cursorLocation.element, this.cursorLocation.offset, this.cursorLocation );
                this.resetBlinkState();
                this._contentChanged( this, "Edit" );
                this._redraw();
                return;
            }
        }
        let el = this.elements.getCurrentElement();

        let insert = ( str, index, value ) => {
            return str.substr(0, index) + value + str.substr(index);
        };

        if ( key === "Enter" )
        {
            el.text = insert( el.text, this.cursorLocation.offset, "\n" );

            this.elements.rewordElement( el );
            this.linalyze();

            this.cursorLocation.offset += 1;
            this.cursorLocation.element = el;
            this.getPositionForElementOffset( el, this.cursorLocation.offset, this.cursorLocation );
            this._contentChanged( this, "Edit" );
        } else
        if ( key === "Backspace" )
        {
            let checkPrevious = () => {
                // --- If at the front of the element, go to previous one.
                if ( !this.cursorLocation.offset ) {
                    let previous = this.elements.getPreviousElement( el );
                    if ( !el.text.length && this.elements.length() > 1 ) this.elements.removeElement( el );
                    if ( previous ) {
                        this.cursorLocation.offset = previous.text.length;
                        this.cursorLocation.element = previous;
                        this.elements.current = previous;

                        el = previous;
                        this.getPositionForElementOffset( el, this.cursorLocation.offset, this.cursorLocation );
                    }
                }
            };

            checkPrevious();

            if ( this.cursorLocation.offset ) {
                el.text = el.text.slice(0, this.cursorLocation.offset - 1 ) + el.text.slice( this.cursorLocation.offset );

                this.elements.rewordElement( el );
                this.linalyze();

                this.cursorLocation.offset -= 1;
                this.cursorLocation.element = el;
                this.getPositionForElementOffset( el, this.cursorLocation.offset, this.cursorLocation );

                this._contentChanged( this, "Edit" );
            }

            checkPrevious();
        } else
        if ( key === "ArrowLeft" )
        {
            if ( this.cursorLocation.offset ) --this.cursorLocation.offset;
            else {
                // --- Try to go to previous element
                let element = this.elements.getPreviousElement( this.cursorLocation.element );
                if ( element ) {
                    this.cursorLocation.element = element;
                    this.cursorLocation.offset = element.text.length;
                }
            }

            this.getPositionForElementOffset( this.cursorLocation.element, this.cursorLocation.offset, this.cursorLocation );
        } else
        if ( key === "ArrowRight" )
        {
            if ( this.cursorLocation.offset <= this.cursorLocation.element.text.length ) ++this.cursorLocation.offset;
            else {
                // --- Try to go to previous element
                let element = this.elements.getNextElement( this.cursorLocation.element );
                if ( element ) {
                    this.cursorLocation.element = element;
                    this.cursorLocation.offset = 0;
                }
            }

            this.getPositionForElementOffset( this.cursorLocation.element, this.cursorLocation.offset, this.cursorLocation );
        } else
        if ( key === "ArrowUp" )
        {
            this.cursorLocation.y -= this.cursorLocation.line.maxHeight / 2;
            this.cursorLocation.y = Math.max( this.cursorLocation.y, 0 );
            this.cursorLocation = this.getLocationForMousePos( { x : this.cursorLocation.x, y : this.cursorLocation.y } );
        } else
        if ( key === "ArrowDown" )
        {
            this.cursorLocation.y += this.cursorLocation.line.maxHeight+1;
            this.cursorLocation = this.getLocationForMousePos( { x : this.cursorLocation.x, y : this.cursorLocation.y } );
        }

        this.resetBlinkState();
        this._redraw();
    }

    /**
     * Processes a mouseDown event.
     * @param {object} pos
     */

    mouseDown( pos )
    {
        if ( pos.x < 0 || pos.y < 0 ) return;

        this.scrollAction = undefined;
        this.handleDragOffset = 0;

        if ( this.needsScrollBar && this.scrollBarWidth ) {
            // --- Check if pressed inside handle rect
            if ( pos.x >= this.handleRect.x && pos.x <= this.handleRect.x + this.handleRect.width ){
                // --- ScrollBar
                if ( pos.y >= this.handleRect.y && pos.y <= this.handleRect.y + this.handleRect.height ) {
                    // --- Handle
                    this.scrollAction = "Vertical Handle Move";
                    this.scrollStartX = pos.x;
                    this.scrollStartY = pos.y;
                    this.handleDragOffset = this.handleRect.y;
                }

                this.mouseMove( pos );
                return;
            }
            pos.y += this.vOffset;
        }

        if ( this.hoverElement && this.hoverElement.font.link )
            this._gotoUrl( this.hoverElement.font.link.url );

        let rc = this.getLocationForMousePos( pos );

        if ( rc ) {
            this.cursorLocation = rc;
            this.elements.current = rc.element;

            if ( rc.element ) {
                if ( !this.selection ) this._fontChanged( rc.element.font );
                else this._fontChanged( this.elements.createFontForRange( this.selectionStart, this.selectionEnd ) );
            }
        }

        this.resetBlinkState();

        this.mouseIsDown = true;
        this.selection = false;
        this._redraw();
    }

    /**
     * Processes a mouseMove event.
     * @param {object} pos
     */

    mouseMove( pos )
    {
        pos.x = Math.max( pos.x, 0 );
        pos.y = Math.max( pos.y, 0 );

        if ( this.scrollAction === "Vertical Handle Move" ) {
            this.handleOffset = pos.y - this.scrollStartY;

            if ( this.handleOffset + this.handleDragOffset < 0 )
                this.handleOffset = -this.handleDragOffset;

            if ( this.handleOffset + this.handleDragOffset + this.handleRect.height > this.height )
                this.handleOffset = this.height - this.handleRect.height - this.handleDragOffset;

            this.vOffset = (this.handleOffset + this.handleDragOffset) * this.maxHeight / this.height;

            this._redraw();
            return;
        }

        if ( this.needsScrollBar && this.scrollBarWidth ) {
            // --- Adjust mouse position for vertical scrollbar offset
            pos.y += this.vOffset;
        }

        let rc = this.getLocationForMousePos( pos );

        if ( rc && !this.mouseIsDown ) {
            if ( this.hoverElement !== rc.element ) {
                this.hoverElement = rc.element;
                this._redraw();

                if ( this.hoverElement ) {
                    if ( this.hoverElement.font.link ) this.canvas.style.cursor = "pointer";
                    else this.canvas.style.cursor = "default";
                }
            }
            return;
        }

        if ( rc ) {
            this.selection = true;

            if ( rc.y < this.cursorLocation.y ) {
                this.selectionStart = rc;
                this.selectionEnd = this.cursorLocation;
            } else
            if ( rc.y === this.cursorLocation.y )
            {
                if ( rc.x <= this.cursorLocation.x ) {
                    this.selectionStart = rc;
                    this.selectionEnd = this.cursorLocation;
                } else {
                    this.selectionStart = this.cursorLocation;
                    this.selectionEnd = rc;
                }

                if ( rc.x === this.cursorLocation.x )
                    this.selection = false;
            } else {
                this.selectionStart = this.cursorLocation;
                this.selectionEnd = rc;
            }

            this._fontChanged( this.elements.createFontForRange( this.selectionStart, this.selectionEnd ) );
            this._redraw();
        }
    }

    /**
     * Processes a mouseUp event.
     * @param {object} pos
     */

    mouseUp( pos )
    {
        this.mouseIsDown = false;
        this.scrollAction = undefined;
    }

    mouseWheel( step) {
        if ( this.needsScrollBar && this.scrollBarWidth ) {

            this.handleOffset = this.handleOffset - step * 5;

            if ( this.handleOffset + this.handleDragOffset < 0 )
                this.handleOffset = -this.handleDragOffset;

            if ( this.handleOffset + this.handleDragOffset + this.handleRect.height > this.height )
                this.handleOffset = this.height - this.handleRect.height - this.handleDragOffset;

            this.vOffset = (this.handleOffset + this.handleDragOffset) * this.maxHeight / this.height;
            this._redraw();
        }
    }

    /**
     * Layouts the rich text area for the given width, height
     * @param {number} width - The width of the canvas.
     * @param {number} height - The height of the canvas.
     */

    layout( width, height ) {
        this.width = width; this.height = height;
        this.ctx.width = this.width; this.ctx.height = this.height;
        this.linalyze();
        if ( this.cursorLocation.element )
            this.getPositionForElementOffset( this.cursorLocation.element, this.cursorLocation.offset, this.cursorLocation );
        this._redraw();
    }

    /**
     * Export to the given format.
     * @param {*} type
     */

    export( format, selection )
    {
        let getTagForSize = ( size ) => {
            let tags = this.tagList, diff = 10000, rc;

            tags.forEach( function( tag ) {
                let d = tag.size - size;
                if ( Math.abs( d ) < diff ) {
                    rc = tag.name;
                    diff = Math.abs( d );
                }
            } );
            return rc;
        };

        let transformTextForTag = ( tag, formattingTag, text, attributes ) => {
            let out="";
            // --- Line breaks
            if ( formattingTag === "ul" || formattingTag === "ol" ) {
                out = text.replace(/(\r\n|\n|\r)/gm, "</li><li>" );
            } else
            if ( tag === 'p' ) {
                out = text.replace(/(\r\n|\n|\r)/gm, "</p><p>" );
            } else
            {
                if ( tag[0] === 'h' )
                    out = text.replace(/(\r\n|\n|\r)/gm, "" );
                else
                    out = text.replace(/(\r\n|\n|\r)/gm, "</br>" );
            }
            // --- Attributes
            let open = "", close = "";
            if ( attributes.bold ) { open += "<strong>"; close += "</strong>"; }
            if ( attributes.italic ) { open += "<i>"; close += "</i>"; }
            out = open + out + close;
            return out;
        };

        let rc = "";
        let openTag = "", openFormattingTag = "";

        let elements = this.elements.elements;
        if ( selection ) {
            if ( this.selection ) elements = this.elements.getRange( this.selectionStart, this.selectionEnd );
            else return rc;
        }

        for( let i = 0; i < elements.length; ++i ) {
            let el = elements[i];

            if ( el.font.formatting ) {

                let formatting = el.font.formatting;
                openFormattingTag = formatting.tag;

                rc += "<" + openFormattingTag + ">";
                if ( openFormattingTag === "ul" || openFormattingTag === "ol" )
                    rc += "<li>";
            }

            if ( !el.font.formatting && openFormattingTag ) {
                if ( openFormattingTag === "ul" || openFormattingTag === "ol" )
                    rc += "</li>";
                rc += "</" + openFormattingTag + ">";
                openFormattingTag = undefined;
            }

            if ( format === "text") rc += el.text;
            else
            if ( format === "html" )
            {
                let tag = getTagForSize( el.font.size );
                let text = transformTextForTag( tag, openFormattingTag, el.text, el.font.attributes );

                if ( !openTag ) {
                    rc += `<${tag}>${text}`;
                    openTag = tag;
                } else {
                    if ( tag === openTag ) {
                        rc += text;
                    } else {
                        rc += `</${openTag}><${tag}>${text}`;
                        openTag = tag;
                    }
                }
            }
        }

        if ( format === "html" && openTag )
            rc += `</${openTag}>`;

        return rc;
    }

    /**
     * Clears the document.
     */

    clear( sendNotification )
    {
        this.elements.elements = [];
        this.elements.current = undefined;
        this.cursorLocation = { offset : 0 };
        this.selection = false;
        this.vOffset = 0;
        this.handleDragOffset = 0;
        this.handleOffset = 0;
        if ( sendNotification ) this._contentChanged( this, "Clear" );
    }

    /**
     * Loads a previously saved data string.
     * @param {*} data
     */

    load( data, { clear = true, sendNotification = true } = {} )
    {
        if ( clear ) this.clear();

        let restoreString = ( string ) => {
            let text = "";
            for ( let i = 0; i < string.length; ++i )
            {
                if ( string[i] === "\\" && i < string.length - 1 && string[i+1] === "n" ) {
                    text += '\n';
                    i++;
                } else text += string[i];
            }
            return text;
        };

        let d = JSON.parse( data );
        let elements = d.elements;
        let images = d.images;

        for( let i = 0; i < elements.length; ++i )
        {
            let el = elements[i];
            el.text = restoreString( el.text );
            this.elements.rewordElement( el );
        }

        this.elements.elements = elements;

        this.cursorLocation = {
            element : elements.length ? elements[0] : undefined,
            offset : 0,
        };

        this.linalyze();
        if ( sendNotification )
            this._contentChanged( this, "Load" );
        this._redraw();

        this.getPositionForElementOffset( this.cursorLocation.element, this.cursorLocation.offset, this.cursorLocation );
    }

    /**
     * Stores the current document into a string.
     * @param {boolean} includeCursorLocation - If true includes the cursor location in the saved data (helpful for example for undo / redo).
     * @returns {string} The data
     */

    save( includeCursorLocation )
    {
        let out = {};
        out.elements = [];

        let saveString = ( string ) => {
            let text = "";
            for ( let i = 0; i < string.length; ++i )
            {
                if ( string[i] === '\n' )
                    text += '\\n';
                else text += string[i];
            }
            return text;
        };

        for( let i = 0; i < this.elements.length(); ++i )
        {
            let el = this.elements.at( i );

            let newEl = {};
            newEl.text = saveString( el.text );
            newEl.font = Object.assign( {}, el.font );
            if ( el.imageName ) {
                newEl.imageName = el.imageName;
                newEl.imageWidth = el.imageWidth;
                newEl.imageHeight = el.imageHeight;
            }
            out.elements.push( newEl );
        }

        return JSON.stringify( out );
    }

    /**
     * Draws the text at the given screen coordinates. The screen coordinates are only necessary if you don't want to draw the text at 0, 0
     * of your 2D canvas.
     * @param {*} screenX The X offset inside the 2D canvas. 0 by default.
     * @param {*} screenY The Y offset inside the 2D canvas. 0 by default.
     */

    draw( screenX = 0, screenY = 0 )
    {
        this.screenOffsetX = screenX; this.screenOffsetY = screenY;

        // ---
        let startX = screenX, startY = screenY;
        let ctx = this.ctx;

        let x = 0, y = 0;

        ctx.setTransform(1, 0, 0, 1, 0, 0);
        if ( this.clearBackground )
            ctx.clearRect( startX, startY, this.width, this.height );

        // --- Clip the content

        ctx.save();
        ctx.rect( startX, startY, this.width, this.height );
        ctx.clip();

        screenY -= this.vOffset;

        ctx.fillStyle = 'black';
        ctx.textBaseline = 'alphabetic';

        let formatTag;
        for( let l = 0; l < this.lines.length; ++l ) {
            let line = this.lines[l];

            // --- Dont draw line if below visible area
            if ( y - this.vOffset > this.height )
                continue;

            x += line.offset;
            screenX += line.offset;

            if ( line.symbol ) {
                if ( line.symbol === "circle" ) {
                    ctx.beginPath();
                    let radius = Math.min( line.maxHeight, 3 );
                    let centerX = line.offset - 4 - radius;
                    let centerY = Math.ceil( line.maxHeight / 2 );

                    ctx.beginPath();
                    ctx.arc( screenX - 14 - radius, screenY + centerY, 3, 0, 2 * Math.PI, false);
                    ctx.fillStyle = this.defaultFont.style;
                    ctx.strokeStyle = this.defaultFont.style;
                    ctx.lineWidth = 1;
                    ctx.fill();
                    ctx.stroke();
                    ctx.closePath();
                }
            }

            if ( !line.words.length && this.selection && ( y >= this.selectionStart.y && y <= this.selectionEnd.y ) ) {
                // --- If empty line, draw a selection rectangle
                ctx.fillStyle = this.selectionStyle;
                ctx.fillRect( startX + x, startY + y - this.vOffset, 5, line.maxHeight );
            }

            for ( let w = 0; w < line.words.length; ++w ) {
                let lWord = line.words[w];

                ctx.font = lWord.element.font.text;

                // --- Get the text and width to draw

                let textToDraw, textToDrawWidth;

                if ( lWord.wrapped ) {
                    // --- Word wrap, only print word
                    textToDraw = lWord.word;
                    textToDrawWidth = lWord.wordMetrics.width;
                } else {
                    textToDraw = lWord.text;
                    textToDrawWidth = lWord.width;
                }

                // --- Draw selection background if necessary

                if ( this.selection )
                {
                    // console.log( y, this.selectionStart.x, this.selectionStart.y, this.selectionEnd.x, this.selectionEnd.y );

                    if ( y >= this.selectionStart.y && y <= this.selectionEnd.y )
                    {
                        ctx.fillStyle = this.selectionStyle;

                        let drawWholeText = false;

                        if ( y > this.selectionStart.y && y < this.selectionEnd.y )
                        {
                            // --- This line is in the middle of the vertical selection somewhere, select everything
                            ctx.fillRect( startX + x, startY + y - this.vOffset, textToDrawWidth, line.maxHeight );
                        } else
                        if ( y === this.selectionStart.y && y === this.selectionEnd.y )
                        {
                            // --- This line is the start and end line of the selection
                            let rx = startX + x, rw = textToDrawWidth;

                            if ( this.selectionStart.x > x ) {
                                let diff = x - this.selectionStart.x;
                                rx -= diff; rw += diff;
                            }

                            if ( this.selectionEnd.x <= rx + rw ) {
                                let diff = rx + rw - this.selectionEnd.x - startX;
                                rw -= diff;
                            }

                            if ( rw > 1 ) ctx.fillRect( rx, startY + y - this.vOffset, rw, line.maxHeight );
                        } else
                        if ( y === this.selectionStart.y )
                        {
                            // --- This line is the start line
                            let rx = startX + x, rw = textToDrawWidth;

                            if ( this.selectionStart.x > x ) {
                                let diff = x - this.selectionStart.x;
                                rx -= diff; rw += diff;
                            }

                            if ( rw > 1 ) ctx.fillRect( rx, startY + y - this.vOffset, rw, line.maxHeight );
                        } else
                        if ( y === this.selectionEnd.y )
                        {
                            // --- This line is end line
                            let rx = startX + x, rw = textToDrawWidth;

                            if ( this.selectionEnd.x <= rx + rw ) {
                                let diff = rx + rw - this.selectionEnd.x - startX;
                                rw -= diff;
                            }

                            if ( rw > 1 ) ctx.fillRect( rx, startY + y - this.vOffset, rw, line.maxHeight );
                        }
                    }
                }

                // --- Draw the text

                if ( lWord.element.font.style ) ctx.fillStyle = lWord.element.font.style;
                else ctx.fillStyle = 'black';

                if ( lWord.element.font.link ) {
                    ctx.fillStyle = this.linkStyle;
                }

                if ( lWord.element.font.link && lWord.element === this.hoverElement && this.focus )
                {
                    // if ( lWord.element.font.link.hoverStyle )
                    //ctx.fillStyle = lWord.element.font.link.hoverStyle;

                    if ( lWord.element.font.link.hoverAttributes ) {
                        let attributes = lWord.element.font.link.hoverAttributes;
                        if ( attributes.includes( "underline") )
                            ctx.fillRect( screenX, screenY + line.maxAscent + 1, textToDrawWidth, 1 );
                    }
                }

                if ( !lWord.element.imageName ) ctx.fillText( textToDraw, screenX, screenY + line.maxAscent );
                else {
                    if ( lWord.element.image )
                        ctx.drawImage( lWord.element.image, screenX, screenY + line.maxAscent - lWord.wordMetrics.height + line.maxDescent );
                    else {
                        if ( !lWord.element.imageRequestSend ) this._getImage( lWord.element.imageName, ( image ) => {
                            Object.defineProperty( lWord.element, "image", { enumerable: false, writable: true } );
                            lWord.element.image = image;
                            this._redraw();
                        } );
                        lWord.element.imageRequestSend = true;
                    }
                }

                x += textToDrawWidth; screenX += textToDrawWidth;
            }

            if ( l < this.lines.length - 1 ) {
                x = 0;
                y += line.maxHeight;

                screenX = startX;
                screenY += line.maxHeight;
            }
        }

        // --- Cursor / Blink State
        if ( !this.selection && !this.readOnly ) {
            if ( this.blinkState && this.cursorLocation ) {
                let height = this.defaultFont.size;

                if ( this.cursorLocation.line )
                    height = this.cursorLocation.line.maxAscent;// - this.cursorLocation.line.maxDescent;

                ctx.fillStyle = this.defaultFont.style;
                ctx.fillRect( startX + this.cursorLocation.x, startY + this.cursorLocation.y - this.vOffset, 1, height );
            }

            this.updateBlinkState();
        }

        ctx.restore();

        // --- Scrollbar
        if ( this.needsScrollBar && this.scrollBarWidth ) {
            // --- Draw Scrollbar

            let x = this.width - this.scrollBarWidth;
            let y = Math.max( this.handleOffset + this.handleDragOffset, 0 );
            let height = Math.min( this.height / this.maxHeight * this.height, this.height );

            this.handleRect = { x : x, y : y, width : this.scrollBarWidth, height : height };
            this._scrollBarFunc( ctx, this.handleRect );
        }
    }
};

if ( typeof module !== 'undefined' && module.exports )
    module.exports = RichText;


/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.UI.RichTextEditor = class extends VG.UI.Widget {

    constructor( { defaultFont, tagList, readOnly = false, margin } = {} ) {
        super();
        this.supportsFocus = true;
        this.margin = margin;

        this.defaultFont = defaultFont ? defaultFont : {
            name : "open sans",
            size : 13.5,
            attributes : { bold : false, italic : false },
            style : 'rgb(244,244,244)',
            text : "13.5px open sans"
        };

        this.tagList = tagList ? tagList : [
            { name : "h1", size : 30 },
            { name : "h2", size : 20 },
            { name : "h3", size : 18 },
            { name : "h4", size : 16 },
            { name : "p", size : 14 },
        ];

        let canvas = document.getElementById( 'workspace' );
        this.richText = new RichText.Editor( { canvas : canvas,
            defaultFont : this.defaultFont,
            tagList : this.tagList,
            selectionStyle : '#c287d4',
            linkStyle : '#7ec5f3',
            readOnly : readOnly,
         } );
        let richText = this.richText;

        richText.needsRedraw( () => VG.update() );
        richText.contentChanged( ( richText, type ) => {
            setTimeout( () => {
                let saveData = richText.save();
                // console.trace( richText, type, richText.export( "text") );
                if ( this.collection && this.path )
                    this.collection.storeDataForPath( { path : this.path, value : saveData, undoText : this.undoText } );
            }, 1000 );
        } );

        richText.gotoUrl( ( url ) => { console.log( url ); VG.gotoUrl( url ); } );

        richText.setScrollBar( VG.UI.stylePool.current.skin.ScrollBar.Size, ( ctx, rect ) => {
            // ctx.fillStyle = 'darkGray';
            // ctx.fillRect( this.contentRect.x + rect.x, this.contentRect.y + rect.y, rect.width, rect.height );

            let widget = {};
            widget.handleRect = new VG.Core.Rect( this.contentRect.x + rect.x, this.contentRect.y + rect.y, rect.width, rect.height );
            let style = VG.UI.stylePool.current;
            widget.contentRect = {
                x : this.contentRect.right() - style.skin.ScrollBar.Size, y :this.contentRect.y,
                width : style.skin.ScrollBar.Size, height : this.contentRect.height
            };
            widget.rect = widget.contentRect;
            widget.direction = VG.UI.ScrollBar.Direction.Vertical;
            style.drawScrollBar( widget, VG.context.workspace.canvas );
        } );

        richText.clearBackground = false;
    }

    /**
     * Binds the widget to the data model. This widget has to be bound to a String value.
     * @param {VG.Data.Collection} collection - The data collection to link this widget to.
     * @param {string} path - The path inside the data collection to bind this widget to.
     * @tutorial Data Model
     */

    bind( collection, path )
    {
        this.collection=collection;
        this.path=path;
        collection.addValueBindingForPath( this, path );
    }

    valueFromModel( value )
    {
        if ( value === null ) this.data = "";
        else this.data = value;

        // if ( this.textChanged )
            // this.textChanged.call( VG.context, value );
        if ( value && value[0] === "{" ) this.richText.load( value, { clear : true, sendNotification : false } );
        else if ( value ) {
            this.richText.clear( false );
            value = value.replace( /</g, "" );
            value = value.replace( />/g, "" );
            this.richText.textInput( value, false );
        }
    }

    /**
     * Feeds plain text input to RichTextJS.
     * @param {*} text
     */

    textInput( text ) {
        // console.log( text );
        this.richText.textInput( text );
        VG.update();
    }

    /**
     * Translates a Viral Graphics key code event to RichTextJS understandable string.
     * @param {number} keyCode
     * @returns {string}
     */

    translateKeyCode( keyCode ) {
        let key = "";

        if ( keyCode === VG.Events.KeyCodes.Enter ) key = "Enter";
        else if ( keyCode === VG.Events.KeyCodes.Backspace || keyCode === VG.Events.KeyCodes.Delete ) key = "Backspace";
        else if ( keyCode === VG.Events.KeyCodes.ArrowLeft ) key = "ArrowLeft";
        else if ( keyCode === VG.Events.KeyCodes.ArrowUp ) key = "ArrowUp";
        else if ( keyCode === VG.Events.KeyCodes.ArrowRight ) key = "ArrowRight";
        else if ( keyCode === VG.Events.KeyCodes.ArrowDown ) key = "ArrowDown";

        return key;
    }

    keyDown( keyCode ) {
        let key = this.translateKeyCode( keyCode );
        if ( key ) this.richText.keyDown( key );
        VG.update();
    }

    mouseDown( event ) {
        let pos = { x : Math.max( event.pos.x - this.contentRect.x, 0), y : Math.max( event.pos.y - this.contentRect.y, 0 ) };
        this.richText.mouseDown( pos );
        VG.update();
    }

    mouseMove( event ) {
        let pos = { x : Math.max( event.pos.x - this.contentRect.x, 0), y : Math.max( event.pos.y - this.contentRect.y, 0 ) };
        this.richText.mouseMove( pos );
        VG.update();
    }

    mouseUp( event ) {
        let pos = { x : Math.max( event.pos.x - this.contentRect.x, 0), y : Math.max( event.pos.y - this.contentRect.y, 0 ) };
        this.richText.mouseUp( pos );
        VG.update();
    }

    mouseWheel( step )
    {
        this.richText.mouseWheel( step );
    }

    focusIn() {
        this.richText.setFocus( true );
    }

    focusOut() {
        this.richText.setFocus( false );
    }

    checkDragSourceItemId( pos, id ) {
        if ( id === "Image" )
        {
            let p = { x : Math.max( pos.x - this.contentRect.x, 0), y : Math.max( pos.y - this.contentRect.y, 0 ) };
            if ( this.richText.needsScrollBar && this.richText.scrollBarWidth )
                p.y += this.richText.vOffset;

            let rc = this.richText.getLocationForMousePos( p );

            if ( rc ) {
                this.richText.cursorLocation = rc;
                this.richText.elements.current = rc.element;

                this.richText.resetBlinkState();
                this.richText.selection = false;
                this.richText._redraw();
            }

            return true;
        } else return false;
    }

    acceptDragSourceItem( pos, id, item ) {
        if ( id === "Image" ) {
            this.richText.setImage( { name: item.text, width: item.image.width, height: item.image.height } );
        }
    }

    clipboardCopyIsAvailable()
    {
        if ( this.richText.selection ) return "Text";
        else return null;
    }

    clipboardPasteIsAvailableForType( type )
    {
        if ( type === "Text" && !this.richText.readOnly ) return true;
        return false;
    }

    clipboardCut()
    {
        if ( !this.richText.selection ) return;

        let out = this.richText.export( "text", true );
        if ( out ) {
            this.richText.deleteSelection();
            VG.copyToClipboard( "Text", out );
        }
    }

    clipboardCopy()
    {
        let out = this.richText.export( "text", true );
        if ( out )
            VG.copyToClipboard( "Text", out );
    }

    clipboardPaste()
    {
        if ( this.richText.selection ) this.richText.deleteSelection();
        this.richText.textInput( VG.clipboardPasteDataForType( "Text" ) );
    }

    clipboardDeleteSelection()
    {
        if ( this.richText.selection ) this.richText.deleteSelection();
    }

    paintWidget( canvas ) {
        let rect = this.contentRect;

        rect.copy( this.rect );

        if ( !this.margin ) this.margin = { x : 2, y : 2 };

        rect.x += this.margin.x;
        rect.y += this.margin.y;
        rect.width -= this.margin.x;
        rect.height -= this.margin.y;

        if ( rect.width !== this.richText.width || rect.height !== this.richText.height )
            this.richText.layout( rect.width, rect.height );

        this.richText.draw( rect.x, rect.y );
    }
};

Object.defineProperty( VG.UI.RichTextEditor.prototype, "content", {
    get: function() {

        return this._content;
    },
    set: function( content ) {
        if ( !content ) content="";
        this._content = content;
        if ( content )
            this.richText.load( content, { clear : true, sendNotification : false } );
    }
});
/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// --------------------------------------------- VG.Controller.Node

VG.Controller.Node=function( collection, path, graph )
{
    if ( !(this instanceof VG.Controller.Node) ) return new VG.Controller.Node( collection, path, graph );

    VG.Controller.Base.call( this );

    this.collection=collection;
    this.path=path;
    this.contentClassName="";
    this.graph=graph;

    // ---

    this.multiSelection=false;

    this._selected=0;
    this.selection=[];

    // --- Init possible OberverKeys

    this.addObserverKey( "parentSelectionChanged" );
    this.addObserverKey( "selectionChanged" );
    this.addObserverKey( "addItem" );
    this.addObserverKey( "removeItem" );
    this.addObserverKey( "changed" );
};

VG.Controller.Node.prototype=VG.Controller.Base();

Object.defineProperty( VG.Controller.Node.prototype, "length",
{
    get: function() {
        var array=this.collection.dataForPath( this.path ).nodes;
        if ( array ) return array.length;
        else return 0;
    }
});

VG.Controller.Node.prototype.at=function( index )
{
    var array=this.collection.dataForPath( this.path ).nodes;

    if ( index < 0 || index >= array.length ) return undefined;

    return array[index];
};

VG.Controller.Node.prototype.add=function( item, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    if ( !array ) { VG.error( "VG.Controller.Node.add() : Controller has no content!" ); return; }

    if ( item.node )
    {
        this.graph.addNode( item.node );
    } else
    if ( item.className )
    {
        Object.defineProperty( item, "node", {
            enumerable: false,
            writable: true
        });

        item.node=new VG.Nodes[item.className]();
        item.node.data=item;

        if ( item.node.createProperties )
            item.node.createProperties( item );

        if ( item.node.updateFromData )
            item.node.updateFromData( item );

        this.graph.addNode( item.node, true );
        item.node.readConnections();
    }

    this.notifyObservers( "addItem", item );

    array.push( item );

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Add, this.path, array.length-1, JSON.stringify( item ) );

    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.insert=function( index, item, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;

    if ( item.node )
    {
        this.graph.addNode( item.node );
    } else
    {
        Object.defineProperty( item, "node", {
            enumerable: false,
            writable: true
        });

        item.node=new VG.Nodes[item.className]();
        item.node.data=item;

        if ( item.node.createProperties )
            item.node.createProperties( item );

        if ( item.node.updateFromData )
            item.node.updateFromData( item );

        this.graph.addNode( item.node, true );
        item.node.readConnections();
    }

    this.notifyObservers( "addItem", item );
    array.splice( index, 0, item );

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Add, this.path, array.length-1, JSON.stringify( item ) );

    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.remove=function( item, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;

    item.node.disconnectAll();
    this.notifyObservers( "removeItem", item );

    var index=array.indexOf( item );
    if ( index >= 0 )
        array.splice( index, 1 );

    this.graph.nodes.delete( item.id );

    if ( this.collection.__vgUndo && !noUndo )
        this.collection.__vgUndo.controllerProcessedItem( this, VG.Data.UndoItem.ControllerAction.Remove, this.path, index, JSON.stringify( item ) );

    this.notifyObservers( "changed" );

    if ( index-1 < array.length && index-1 >= 0 )
        this.selected=array[index-1];
    else
        this.selected=array[index];

    this.removeFromSelection( item );
};

VG.Controller.Node.prototype.changeProperty=function( index, name, data, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    var item=array[index];

    if ( data !== null && typeof data === 'object' )
    {
        // --- Object, need to copy content
        var obj=item[name];
        for( var prop in data ) obj[prop]=data[prop];
    } else item[name]=data;

    if ( item.node.updateFromData )
        item.node.updateFromData( item );

    this.selected=item;

    this.notifyObservers( "selectionChanged" );
    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.keyAdd=function( index, name, data, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    var item=array[index];

    var param=item.node.container.getParam( name );
    item.node.container.addKeyFrame( data._frame, param, data[name], true );
    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.keyRemove=function( index, name, data, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    var item=array[index];

    item.node.container.removeKeyFrameAt( data._frame, name, true );
    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.keyChange=function( index, name, data, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    var item=array[index];

    let param=item.node.container.getParam( name );
    let key=item.node.container.keyFrameAt( param.data, data._frame );

    for( var prop in data ) key[prop]=data[prop];

    VG.update();
    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.keyMove=function( index, name, newPos, oldPos, keyName, value, noUndo )
{
    let array = this.collection.dataForPath( this.path ).nodes;
    let item = array[index];

    let param=item.node.container.getParam( name );

    item.node.container.removeKeyFrameAt( oldPos, keyName, true );
    item.node.container.addKeyFrame( newPos, param, value, true );

    VG.update();
    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.disconnect=function( index, name, data, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    var item=array[index];

    var sourceNode, destNode;
    if ( data.nodeId === -1 ) sourceNode=this.graph.previewNode; else sourceNode=this.graph.nodes.get( data.nodeId );
    if ( !sourceNode ) VG.error( "VG.Controller.Node::disconnect Cannot find source node" );
    if ( data.connNodeId === -1 ) destNode=this.graph.previewNode; else destNode=this.graph.nodes.get( data.connNodeId );
    if ( !destNode ) VG.error( "VG.Controller.Node::disconnect Cannot find dest node" );

    var sourceTerminal=sourceNode.getTerminal( data.terminalName );
    var destTerminal=destNode.getTerminal( data.connTerminalName );

    sourceTerminal.disconnectFrom( destTerminal );

    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.connect=function( index, name, data, noUndo )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    var item=array[index];

    var sourceNode, destNode;
    if ( data.nodeId === -1 ) sourceNode=this.graph.previewNode; else sourceNode=this.graph.nodes.get( data.nodeId );
    if ( !sourceNode ) VG.error( "VG.Controller.Node::connect Cannot find source node" );
    if ( data.connNodeId === -1 ) destNode=this.graph.previewNode; else destNode=this.graph.nodes.get( data.connNodeId );
    if ( !destNode ) VG.error( "VG.Controller.Node::connect Cannot find dest node" );

    var sourceTerminal=sourceNode.getTerminal( data.terminalName );
    var destTerminal=destNode.getTerminal( data.connTerminalName );

    sourceTerminal.connectTo( destTerminal );

    this.notifyObservers( "changed" );
    return item;
};

VG.Controller.Node.prototype.modelChanged=function( forceRenew )
{
    var data=this.collection.dataForPath( this.path );
    var array;

    if ( !data || !this.graph ) return;
    else array=data.nodes;

    if ( this.graph.previewNode )
        this.graph.previewNode.disconnectAll();

    if ( !array || !array.length ) this.graph.clear();
    else
    {
        // --- Initialize new Nodes in controller
        var i, item;
        for( i=0; i < array.length; ++i )
        {
            item=array[i];

            if ( !item.node || forceRenew )
            {
                Object.defineProperty( item, "node", {
                    enumerable: false,
                    writable: true
                });

                Object.defineProperty( item, "readConnections", {
                    enumerable: false,
                    writable: true
                });

                item.node=new VG.Nodes[item.className]();
                item.node.data=item;

                if ( item.node.createProperties )
                    item.node.createProperties( item );

                if ( item.node.updateFromData )
                    item.node.updateFromData( item );

                this.graph.addNode( item.node, true );
                item.readConnections=true;

                this.notifyObservers( "addItem", item );
            }
        }

        // --- Connect new Nodes in controller
        for( i=0; i < array.length; ++i )
        {
            item=array[i];

            if ( item.readConnections ) {
                item.node.readConnections( true );
                item.readConnections=false;
            }
        }
    }

    this.notifyObservers( "changed" );
};

VG.Controller.Node.prototype.syncGraph=function()
{
    var data=this.collection.dataForPath( this.path );
    var array;

    if ( !data ) return;
    else array=data.nodes;

    this.graph.nodes.clear();

    if ( !array ) return;
    for( var i=0; i < array.length; ++i )
    {
        var item=array[i];

        if ( item.node ) this.graph.nodes.set( item.node.data.id, item.node );
        else { this.modelChanged(); return; }

    }
};

VG.Controller.Node.prototype.create=function( strClass )
{
    var args = Array.prototype.slice.call(arguments, 1);
    var clsClass = eval( strClass );

    function F() {
        return clsClass.apply(this, args);
    }
    F.prototype = clsClass.prototype;

    return new F();
};

Object.defineProperty( VG.Controller.Node.prototype, "selected",
{
    get: function() {
        return this._selected;
    },
    set: function( selected ) {
        if ( this._selected !== selected ) {

            this._selected=selected;
            this.selection=[];

            if ( selected ) {
                this.selection.push( selected );
            }

            this.notifyObservers( "selectionChanged" );
        }
    }
});

VG.Controller.Node.prototype.addToSelection=function( item )
{
    if ( !this._selected ) this._selected=item;

    var index=this.selection.indexOf( item );
    if ( index === -1 && item )
        this.selection.push( item );

    this.notifyObservers( "selectionChanged" );
};

VG.Controller.Node.prototype.removeFromSelection=function( item )
{
    if ( this._selected === item ) this._selected=0;

    var index=this.selection.indexOf( item );
    if ( index >= 0 )
    {
        this.selection.splice( index, 1 );

     //   if ( this.selectionChanged )
     //       this.selectionChanged.call( VG.context );
    }

    if ( this._selected === 0 && this.selection.length ) {
        this._selected=this.selection[0];
    }

    this.notifyObservers( "selectionChanged" );
};

VG.Controller.Node.prototype.isSelected=function( item )
{
    var index=this.selection.indexOf( item );

    if ( index === -1 ) return false;
    else return true;
};

VG.Controller.Node.prototype.canRemove=function()
{
    if ( this.selected ) return true;
    else return false;
};

VG.Controller.Node.prototype.indexOf=function( item )
{
    var array=this.collection.dataForPath( this.path ).nodes;
    return array.indexOf( item );
};

VG.Controller.Node.prototype.isValid=function()
{
    var data=this.collection.dataForPath( this.path );
    if ( !data || !data.nodes ) return false; else return true;
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

VG.Nodes={};

// ----------------------------------------------------------------- VG.Nodes.ParamContainer

VG.Nodes.ParamContainer=function( node )
{
    /**
     * Creates a Parameter Container.<br>
     *
     * VG.Nodes.ParamContainer is the container class which lists all parameter groups of a node and provide convenience functions to read and write value of Parameters
     * inside the different groups.
     *
     * @constructor
     * @param {VG.Nodes.Node} node - The node whose parameters this container represents.
    */

    if ( !(this instanceof VG.Nodes.ParamContainer ) ) return new VG.Nodes.ParamContainer( node );

    /**An array of all VG.Nodes.ParamGroup inside the container.
     * @member {array} */
    this.groups=[];

    this.node=node;
};

VG.Nodes.ParamContainer.prototype.addGroupByName=function( name, text, open )
{
    /**Adds a new parameter group to the container and returns it.
     * @param {string} name - The name of the new group, the name is used to identify groups inside a container and has to be unique.
     * @param {string} text - The text / title of this group.
     * @param {string} open - True if the group should be open by default. Default is true.
     * @returns The newly added VG.Nodes.ParamGroup.
     */

    var group=VG.Nodes.ParamGroup( name, text, open );
    group.container=this;
    this.groups.push( group );
    return group;
};

VG.Nodes.ParamContainer.prototype.addGroup=function( group )
{
    /**Adds the given group to this container.
     * @param {VG.Nodes.ParamGroup} group - The group to be added to this container.
     */

    group.container=this;
    this.groups.push( group );
};

VG.Nodes.ParamContainer.prototype.getGroup=function( name )
{
    for( let i=0; i < this.groups.length; ++i )
    {
        let group=this.groups[i];

        if ( group.name === name )
            return group;
    }
};

VG.Nodes.ParamContainer.prototype.getParam=function( name )
{
    /**Returns the parameter identified by its name.
     * @param {string} name - The name of the parameter to look up.
     * @returns The found parameter or null.
     */

    for( var i=0; i < this.groups.length; ++i )
    {
        var group=this.groups[i];

        for( var p=0; p < group.parameters.length; ++p )
        {
            var param=group.parameters[p];

            if ( param.name === name ) return param;
        }
    }

    return null;
};

VG.Nodes.ParamContainer.prototype.getParamValue=function( name )
{
    /**Returns the value of the parameter identified by its name.
     * @param {string} name - The name of the parameter to look up.
     * @returns The found parameter value or null.
     */

    for( let i=0; i < this.groups.length; ++i )
    {
        let group=this.groups[i];

        for( let p=0; p < group.parameters.length; ++p )
        {
            let param=group.parameters[p];

            if ( param.name === name ) {
                if ( !param.data._keyFrames ) return param.data[param.name];
                else return this.keyParamValue( param );
            }
        }
    }

    return null;
};

VG.Nodes.ParamContainer.prototype.getAdjustedParamString=function( name, adjustCallback, scale )
{
    /**Returns the value of the parameter identified by its name.
     * @param {string} name - The name of the parameter to look up.
     * @returns The found parameter value or null.
     */

    for( let i=0; i < this.groups.length; ++i )
    {
        let group=this.groups[i];

        for( let p=0; p < group.parameters.length; ++p )
        {
            let param = group.parameters[p];

            if ( param.name === name ) {
                let value = param.data[param.name];
                if ( adjustCallback ) value = adjustCallback( name, param, scale );
                if (typeof value === 'string' || value instanceof String) {

                } else
                if ( param.type === "bool" )
                {
                    value = `${Boolean( value )}`;
                } else
                if ( param.type === "int" )
                {
                    value = `${Math.round( value )}`;
                } else
                if ( !isNaN( value ) && value.toFixed ) {
                    value = value.toFixed( 3 );
                } else
                if ( param.type === "vec2" )
                {
                    value = `vec2(${value.x},${value.y})`;
                } else
                if ( param.type === "vec3" )
                {
                    value = `vec3(${value.x},${value.y},${value.z})`;
                } else
                if ( param.type === "vec4" )
                {
                    value = `vec4(${value.x},${value.y},${value.z},${value.w})`;
                }

                return value;
            }
        }
    }

    return null;
};

VG.Nodes.ParamContainer.prototype.areKeysActive=function( keys )
{
    /**Returns the value of the parameter identified by its name.
     * @param {string} name - The name of the parameter to look up.
     * @returns The found parameter value or null.
     */

    for( var i=0; i < this.groups.length; ++i )
    {
        var group=this.groups[i];

        for( var p=0; p < group.parameters.length; ++p )
        {
            var param=group.parameters[p];

            if ( param.data._keyFrames )
            {
                for( let k=0; k < param.data._keyFrames.length; ++k )
                {
                    let key=param.data._keyFrames[k];

                    for ( let t=0; t < keys.length; ++t )
                    {
                        if ( key[keys[t]] !== undefined ) return true;
                    }
                }
            }
        }
    }

    return false;
};

VG.Nodes.ParamContainer.prototype.resetParams=function()
{
    for( let i=0; i < this.groups.length; ++i )
    {
        let group=this.groups[i];

        for( let p=0; p < group.parameters.length; ++p )
        {
            let param=group.parameters[p];

            if ( param.defaultValue === undefined )
                continue;

            if ( param instanceof VG.Nodes.ParamColor )
            {
                let value = param.data[param.name];
                value.r=param.defaultValue.r; value.g=param.defaultValue.g; value.b=param.defaultValue.b; value.a=param.defaultValue.a;
                value.x=param.defaultValue.r; value.y=param.defaultValue.g; value.z=param.defaultValue.b; value.w=param.defaultValue.a;
            }
            else {
                param.data[param.name] = param.defaultValue;
            }
        }
    }
};

VG.Nodes.ParamContainer.prototype.setParamColor=function( name, r, g, b, a )
{
    /**Sets the value of a color parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} r - The red value to set.
     * @param {number} g - The green value to set.
     * @param {number} b - The blue value to set.
     * @param {number} a - The alpha value to set.
     */
    var param=this.getParam( name );
    if ( !param ) return;
    var value=param.data[param.name];

    value.r=r; value.g=g; value.b=b; value.a=a;
    value.x=r; value.y=g; value.z=b; value.w=a;
};

VG.Nodes.ParamContainer.prototype.setParamNumber=function( name, value )
{
    /**Sets the value of a number parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
    var param=this.getParam( name );
    param.data[param.name]=value;
};

VG.Nodes.ParamContainer.prototype.setParamText=function( name, value )
{
    /**Sets the value of a text parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
    var param=this.getParam( name );
    param.data[param.name]=value;
};

VG.Nodes.ParamContainer.prototype.setParamSlider=function( name, value )
{
    /**Sets the value of a slider parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
    var param=this.getParam( name );
    param.data[param.name]=value;
};

VG.Nodes.ParamContainer.prototype.setParamBoolean=function( name, value )
{
    /**Sets the value of a boolean parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
    var param=this.getParam( name );
    param.data[param.name]=value;

    if ( param.widget )
        param.widget.checked=value;
};

VG.Nodes.ParamContainer.prototype.setParamList=function( name, value )
{
    /**Sets the value of a list parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
    var param=this.getParam( name );
    param.data[param.name]=value;
};


VG.Nodes.ParamContainer.prototype.setParamVector2=function( name, x, y )
{
    /**Sets the value of a vector2 parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} x - The x value to set.
     * @param {number} y - The y value to set.
     */
    var param=this.getParam( name );
    if ( !param ) return;
    param.data[param.name].x=x;
    param.data[param.name].y=y;

    if ( param.widget ) {
        param.widget.value1Edit.value=x;
        param.widget.value2Edit.value=y;
    }
};

VG.Nodes.ParamContainer.prototype.setParamVector3=function( name, x, y, z )
{
    /**Sets the value of a vector3 parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} x - The x value to set.
     * @param {number} y - The y value to set.
     * @param {number} z - The z value to set.
     */
    var param=this.getParam( name );
    if ( !param ) return;
    param.data[param.name].x=x;
    param.data[param.name].y=y;
    param.data[param.name].z=z;

    if ( param.widget ) {
        param.widget.value1Edit.value=x;
        param.widget.value2Edit.value=y;
        param.widget.value3Edit.value=z;
    }
};

VG.Nodes.ParamContainer.prototype.setParamVector4=function( name, x, y, z, w )
{
    /**Sets the value of a vector4 parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} x - The x value to set.
     * @param {number} y - The y value to set.
     * @param {number} z - The z value to set.
     * @param {number} w - The w value to set.
     */
    var param=this.getParam( name );
    if ( !param ) return;
    param.data[param.name].x=x;
    param.data[param.name].y=y;
    param.data[param.name].z=z;
    param.data[param.name].w=w;
};

VG.Nodes.ParamContainer.prototype.setParamImage=function( name, imageName, imageData )
{
    /**Sets the value of an image parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} imageName - The name of the image.
     * @param {imageData} imageData- The compressed data of the image to set.
     */
    var param=this.getParam( name );
    if ( !param ) return;

    param.data[param.name].imageName=imageName;
    param.data[param.name].imageData=imageData;

    if ( param.updateFromData ) param.updateFromData( param.data );
};

VG.Nodes.ParamContainer.prototype.addKeyFrame=function( frame, param, value, noUndo )
{
    // console.log( "addKeyFrame", frame, param, value, noUndo );
    this.node.open=true;

    let data = param.data;
    if ( !data._keyFrames ) data._keyFrames=[];

    let key = this.keyFrameAt( data, frame ), added=false, obj={};
    if ( !key ) {
        key = { _frame : frame };

        let ins=0;
        for( let i=0; i < data._keyFrames.length; ++i ) {
            let k=data._keyFrames[i];
            if ( k._frame < frame ) ++ins;
            else break;
        }

        data._keyFrames.splice( ins, 0, key );
        added=true;
    }

    if ( !added && !noUndo ) {
        // --- Prepare for Node Change Undo
        obj.oldValue = JSON.stringify( key );
    }

    // --- If key did not yet exist at the position, make sure its added and not changed
    if ( key[param.name] === undefined ) added = true;

    if ( value instanceof Object )
    {
        key[param.name]={};
        let dest=key[param.name];

        var props = Object.getOwnPropertyNames( value );

        props.forEach( function( prop ) {
            dest[prop]=value[prop];
        } );
    } else key[param.name]=value;

    if ( !noUndo ) {
        if ( this.node.graph.nodeKeyAddedCallback && added )
            this.node.graph.nodeKeyAddedCallback( param, data, key );
        if ( this.node.graph.nodeKeyChangedCallback && !added ) {
            obj.newValue=JSON.stringify( key );
            this.node.graph.nodeKeyChangedCallback( param, data, obj );
        }
    }

    VG.update();
};

VG.Nodes.ParamContainer.prototype.removeKeyFrameAt=function( frame, keyName, noUndo )
{
    let data = this.groups[0].parameters[0].data;
    let key = this.keyFrameAt( data, frame );
    let newKey = {};

    let count = 0;
    for ( let prop in key ) {
        if ( prop !== "_frame" ) count++;
        if ( prop !== keyName && prop ) newKey[prop] = key[prop];
    }

    let param = this.getParam( keyName );
    let insertNewKey = count >=  2 ? true : false;

    if ( key ) {
        let keyIndex = data._keyFrames.indexOf( key );
        data._keyFrames.splice( keyIndex, 1 );

        if ( insertNewKey ) data._keyFrames.splice( keyIndex, 0, newKey );

        if ( !noUndo ) {
            if ( this.node.graph.nodeKeyRemovedCallback )
                this.node.graph.nodeKeyRemovedCallback( param, data, key, insertNewKey ? newKey : undefined, keyName );
        }
    }

    VG.update();
};

VG.Nodes.ParamContainer.prototype.keyFrameAt=function( data, frame )
{
    if ( !data._keyFrames ) return undefined;

    for( let i=0; i < data._keyFrames.length; ++i )
    {
        let key=data._keyFrames[i];
        if ( key._frame === frame ) return key;
    }
    return undefined;
};

VG.Nodes.ParamContainer.prototype.keyParamValue=function( param )
{
    var frame = this.node.graph.time.frames - this.node.inTime.frames;
    var data=param.data, name=param.name;

    var keys=this.findSurrKeys( frame, data, name );

    if ( keys.prev && !keys.next ) return keys.prev[name];
    else
    if ( !keys.prev && !keys.next ) return data[name];
    else
    if ( keys.prev === keys.next ) return keys.prev[name];

    // --- Interpolate values

    var value;

    var prevFrame = keys.prev ? keys.prev._frame : 0;
    var nextFrame = keys.next._frame;

    var frameDur =  nextFrame - prevFrame;
    var frameOff = frame - prevFrame;

    var prevValue = keys.prev ? keys.prev[name] : data[name];
    var nextValue = keys.next[name];

    if ( param instanceof VG.Nodes.ParamSlider || param instanceof VG.Nodes.ParamNumber )
    {
        value = prevValue + ( (nextValue - prevValue) / frameDur ) * frameOff;
    } else
    if ( param instanceof VG.Nodes.ParamVector2 )
    {
        value = {};
        value.x = prevValue.x + ( (nextValue.x - prevValue.x) / frameDur ) * frameOff;
        value.y = prevValue.y + ( (nextValue.y - prevValue.y) / frameDur ) * frameOff;
    } else
    if ( param instanceof VG.Nodes.ParamColor )
    {
        value = {};
        value.r = prevValue.r + ( (nextValue.r - prevValue.r) / frameDur ) * frameOff;
        value.g = prevValue.g + ( (nextValue.g - prevValue.g) / frameDur ) * frameOff;
        value.b = prevValue.b + ( (nextValue.b - prevValue.b) / frameDur ) * frameOff;
        value.a = prevValue.a + ( (nextValue.a - prevValue.a) / frameDur ) * frameOff;
    } else
    if ( param instanceof VG.Nodes.ParamMaterial )
    {
        value = {};
        value.r = prevValue.r + ( (nextValue.r - prevValue.r) / frameDur ) * frameOff;
        value.g = prevValue.g + ( (nextValue.g - prevValue.g) / frameDur ) * frameOff;
        value.b = prevValue.b + ( (nextValue.b - prevValue.b) / frameDur ) * frameOff;
        value.a = prevValue.a + ( (nextValue.a - prevValue.a) / frameDur ) * frameOff;
        value.metallic = prevValue.metallic + ( (nextValue.metallic - prevValue.metallic) / frameDur ) * frameOff;
        value.smoothness = prevValue.smoothness + ( (nextValue.smoothness - prevValue.smoothness) / frameDur ) * frameOff;
        value.reflectance = prevValue.reflectance + ( (nextValue.reflectance - prevValue.reflectance) / frameDur ) * frameOff;
    } else
    if ( param instanceof VG.Nodes.ParamBoolean )
    {
        value = prevValue;
    }

    return value;
};

VG.Nodes.ParamContainer.prototype.findSurrKeys=function( frame, data, name )
{
    var keys={ prev: undefined, next: undefined };
    for( let i=0; i < data._keyFrames.length; ++i )
    {
        let key=data._keyFrames[i];
        if ( key._frame < frame && key[name] !== undefined ) keys.prev=key;
        else
        if ( key._frame === frame && key[name] !== undefined ) {
            keys.prev=key;
            keys.next=key;
            break;
        }
        else
        if ( key._frame > frame && key[name] !== undefined ) {
            keys.next=key;
            break;
        }
    }
    return keys;
};

VG.Nodes.ParamContainer.prototype.getKeyListOfProperty=function( data, name )
{
    var keys=[];
    for( let i=0; i < data._keyFrames.length; ++i )
    {
        let key=data._keyFrames[i];
        if ( key[name] !== undefined ) keys.push( key );
    }
    return keys;
};

VG.Nodes.ParamContainer.prototype.containsKeyFrames=function( data, list )
{
    for( let i=0; i < data._keyFrames.length; ++i )
    {
        let key=data._keyFrames[i];

        for( let l=0; l < list.length; ++l ) {
            if ( key[list[l]] !== undefined )
                return true;
        }
    }
    return false;
};

// ----------------------------------------------------------------- VG.Nodes.ParamGroup

VG.Nodes.ParamGroup=function( name, text, open )
{
    /**
     * Creates a Parameter Group.<br>
     *
     * VG.Nodes.ParamGroup is used to group several parameters. Typically these parameters control a common feature of the node.
     * @param {string} name - The name of the new group, the name is used to identify groups inside a container and has to be unique.
     * @param {string} text - The text / title of this group.
     * @param {string} open - True if the group should be open by default. Default is true.
     * @constructor
    */
    if ( !(this instanceof VG.Nodes.ParamGroup ) ) return new VG.Nodes.ParamGroup( name, text, open );

    this.name=name ? name : "settings";
    this.text=text ? text : "Settings";
    this.open=open === undefined ? true : open;

    this.visible=true;

    /**The array of parameters contained in this group.
     * @member {array} */
    this.parameters=[];
};

VG.Nodes.ParamGroup.prototype.addParam=function( param )
{
    /**Adds the given parameter to this group.
     * @param {VG.Nodes.Param} param - The parameter to add to this group.
     */

    param.group=this;
    this.parameters.push( param );

    return param;
};

// ----------------------------------------------------------------- VG.Nodes.Param

VG.Nodes.Param=function()
{
    if ( !(this instanceof VG.Nodes.Param) ) return new VG.Nodes.Param();
};

Object.defineProperty( VG.Nodes.Param.prototype, "disabled",
{
    get: function() {
        return this._disabled;
    },
    set: function( disabled ) {
        this._disabled=disabled;
        if ( this.widget ) this.widget.disabled=disabled;
    }
});

// ----------------------------------------------------------------- VG.Nodes.ParamNumber

VG.Nodes.ParamNumber=function( data, name, text, value, min, max, precision )
{
    /**
     * Creates a Number Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial value of this parameter.
     * @param {number} min - Optional, the minimum number allowed.
     * @param {number} max - Optional, the maximum number allowed.
     * @param {number} precision - Optional, the numerical precision.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamNumber ) ) return new VG.Nodes.ParamNumber( data, name, text, value, min, max, precision );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "float";

    this.min=min;
    this.max=max;
    this.precision=precision;

    this.data=data;
    if ( data[name] === undefined ) data[name]=value;
};

VG.Nodes.ParamNumber.prototype=VG.Nodes.Param();

VG.Nodes.ParamNumber.prototype.toString=function()
{
    var val=this.data[this.name];
    return val.toFixed( 3 );
};

// ----------------------------------------------------------------- VG.Nodes.ParamText

VG.Nodes.ParamText=function( data, name, text, value )
{
    /**
     * Creates a Text Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial value of this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamText ) ) return new VG.Nodes.ParamText( data, name, text, value );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";

    this.data=data;
    if ( !data[name] ) data[name]=value;
};

VG.Nodes.ParamText.prototype=VG.Nodes.Param();

VG.Nodes.ParamText.prototype.toString=function()
{
    var val=this.data[this.name];
    return val;
};

// ----------------------------------------------------------------- VG.Nodes.ParamText

VG.Nodes.ParamHtml=function( data, name, text, value )
{
    /**
     * Creates an Html Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial value of this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamHtml ) ) return new VG.Nodes.ParamHtml( data, name, text, value );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";

    this.data=data;
    data[name]=value;
};

VG.Nodes.ParamHtml.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamDivider

VG.Nodes.ParamDivider=function( data, name, text )
{
    /**
     * Creates a Divider.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamDivider ) ) return new VG.Nodes.ParamDivider( data, name, text );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
};

VG.Nodes.ParamDivider.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamToolSettings

VG.Nodes.ParamToolSettings=function( data, name, text, widgetCount, height )
{
    /**
     * Creates a Divider.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {string} widgetCount - The widget count.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamToolSettings ) ) return new VG.Nodes.ParamToolSettings( data, name, text, widgetCount, height );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.data=data;
    this.widgetCount = widgetCount;
    this.height = height;
};

VG.Nodes.ParamToolSettings.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamNumber

VG.Nodes.ParamSlider=function( data, name, text, value, min, max, step, precision, halfWidthValue )
{
    /**
     * Creates a Slider Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial value of this parameter.
     * @param {number} min - Optional, the minimum number allowed.
     * @param {number} max - Optional, the maximum number allowed.
     * @param {number} step - Optional, the step distance between possible values.
     * @param {number} precision - Optional, the fixed precision for the edit widget.
     * @constructor
    */

    //VG.Nodes.Param.call( this );

    if ( !(this instanceof VG.Nodes.ParamSlider ) ) return new VG.Nodes.ParamSlider( data, name, text, value, min, max, step, precision, halfWidthValue );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";

    this.min=min;
    this.max=max;
    this.step=step;
    this.precision=precision;
    this.halfWidthValue=halfWidthValue;
    this.defaultValue=value;
    this.type = "float";

    this.data=data;
    if ( data[name] === undefined ) {
        if ( !isNaN( value ) ) value = Number( value );
        data[name]=value;
    } else {
        if ( !isNaN( data[name] ) ) data[name] = Number( data[name] );
    }
};

VG.Nodes.ParamSlider.prototype=VG.Nodes.Param();

VG.Nodes.ParamSlider.prototype.toString=function()
{
    var val=this.data[this.name];
    return val.toFixed( 3 );
};

// ----------------------------------------------------------------- VG.Nodes.ParamBoolean

VG.Nodes.ParamBoolean=function( data, name, text, value )
{
    /**
     * Creates a Boolean (on/off) Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial value of this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamBoolean ) ) return new VG.Nodes.ParamBoolean( data, name, text, value );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "bool";

    this.data=data;
    if ( data[name] === undefined ) data[name]=value;
};

VG.Nodes.ParamBoolean.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamBoolean

VG.Nodes.ParamCustom=function( data, name, text, cb )
{
    /**
     * Creates a Boolean (on/off) Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial value of this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamCustom ) ) return new VG.Nodes.ParamCustom( data, name, text, cb );

    this.name=name ? name : "value";
    this.text=text !== undefined ? text : "";

    this.data=data;
    this.cb=cb;

    if ( data[name] === undefined ) data[name]=cb( "DefaultValue" );
};

VG.Nodes.ParamCustom.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamList

VG.Nodes.ParamList=function( data, name, text, value, array, callback )
{
    /**
     * Creates a List Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} value - The initial index of this parameter.
     * @param {array} array - An array of strings.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamList ) ) return new VG.Nodes.ParamList( data, name, text, value, array, callback );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "int";

    this.list=array;
    this.callback=callback;

    this.data=data;
    if ( data[name] === undefined ) data[name]=value;
};

VG.Nodes.ParamList.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamButton

VG.Nodes.ParamButton=function( data, name, text, callback )
{
    /**
     * Creates a List Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamButton ) ) return new VG.Nodes.ParamButton( data, name, text, callback );

    this.name = name ? name : "value";
    this.text = text ? text : "Value";
    this.type = "";

    this.callback = callback;
    this.data=data;
};

VG.Nodes.ParamButton.prototype = VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamVector2

VG.Nodes.ParamVector2=function( data, name, text, x, y, min, max, precision )
{
    /**
     * Creates a Vector 2 Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} x - The initial x value.
     * @param {number} y - The initial y value.
     * @param {number} min - Optional, the minimum number allowed.
     * @param {number} max - Optional, the maximum number allowed.
     * @param {number} precision - Optional, the fixed precision for the edit widget.*
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamVector2 ) ) return new VG.Nodes.ParamVector2( data, name, text, x, y, min, max, precision );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "vec2";

    this.min=min;
    this.max=max;
    this.precision=precision;

    if ( !data[name] )
    {
        data[name]={};
        data[name].x=x;
        data[name].y=y;
    }

    this.data=data;
    this.value=new VG.Math.Vector2( x, y );
};

VG.Nodes.ParamVector2.prototype=VG.Nodes.Param();

VG.Nodes.ParamVector2.prototype.toString=function()
{
    var obj=this.data[this.name];
    return  "vec2( " + obj.x.toFixed(3) + "," + obj.y.toFixed(3) + " )";
};

// ----------------------------------------------------------------- VG.Nodes.ParamVector2

VG.Nodes.ParamVector2List=function( data, name, text, array, min, max )
{
    /**
     * Creates a Vector 2 Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} array - The list of values.
     * @param {number} min - Optional, the minimum number allowed.
     * @param {number} max - Optional, the maximum number allowed.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamVector2List ) ) return new VG.Nodes.ParamVector2List( data, name, text, array, min, max );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";

    this.min=min;
    this.max=max;

    if ( !data[name] )
        data[name] = array;

    this.data=data;
    this.minimumPoints = 2;
    this.index=0;
};

VG.Nodes.ParamVector2List.prototype=VG.Nodes.Param();

// ----------------------------------------------------------------- VG.Nodes.ParamVector3

VG.Nodes.ParamVector3=function( data, name, text, x, y, z, min, max )
{
    /**
     * Creates a Vector 3 Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} x - The initial x value.
     * @param {number} y - The initial y value.
     * @param {number} z - The initial z value.
     * @param {number} min - Optional, the minimum number allowed.
     * @param {number} max - Optional, the maximum number allowed.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamVector3 ) ) return new VG.Nodes.ParamVector3( data, name, text, x, y, z, min, max );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "vec3";

    this.min=min;
    this.max=max;

    if ( !data[name] )
    {
        data[name]={};
        data[name].x=x;
        data[name].y=y;
        data[name].z=z;
    }

    if ( typeof data[name] == 'number' )
        data[name] = { x : data[name], y : data[name], z : data[name] };

    this.data=data;
    this.value=new VG.Math.Vector3( x, y, z );
};

VG.Nodes.ParamVector3.prototype=VG.Nodes.Param();

VG.Nodes.ParamVector3.prototype.toString=function()
{
    var obj=this.data[this.name];
    return  "vec3( " + obj.x.toFixed(3) + "," + obj.y.toFixed(3) + "," + obj.z.toFixed(3) + " )";
};

// ----------------------------------------------------------------- VG.Nodes.ParamVector4

VG.Nodes.ParamVector4=function( data, name, text, x, y, z, w, min, max )
{
    /**
     * Creates a Vector4 Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {number} x - The initial x value.
     * @param {number} y - The initial y value.
     * @param {number} z - The initial z value.
     * @param {number} w - The initial w value.
     * @param {number} min - Optional, the minimum number allowed.
     * @param {number} max - Optional, the maximum number allowed.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamVector4 ) ) return new VG.Nodes.ParamVector4( data, name, text, x, y, z, w, min, max );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "vec4";

    this.min=min;
    this.max=max;

    if ( !data[name] )
    {
        data[name]={};
        data[name].x=x;
        data[name].y=y;
        data[name].z=z;
        data[name].w=w;
    }

    this.data=data;
    this.value=new VG.Math.Vector4( x, y, z, w );
};

VG.Nodes.ParamVector4.prototype=VG.Nodes.Param();

VG.Nodes.ParamVector4.prototype.toString=function()
{
    var obj=this.data[this.name];
    return  "vec4( " + obj.x.toFixed(3) + "," + obj.y.toFixed(3) + "," + obj.z.toFixed(3) + "," + obj.w.toFixed(3) + " )";
};

// ----------------------------------------------------------------- VG.Nodes.ParamColor

VG.Nodes.ParamColor=function( data, name, text, value, alpha )
{
    /**
     * Creates a Color Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {string} value - The initial value of this parameter.
     * @param {boolean} alpha - If the edit show an alpha slider for the color.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamColor ) ) return new VG.Nodes.ParamColor( data, name, text, value, alpha );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";
    this.type = "vec3";

    if ( !data[name] )
    {
        data[name]={};
        data[name].r=value.r;
        data[name].g=value.g;
        data[name].b=value.b;
        data[name].a=value.a;

        data[name].x=value.r;
        data[name].y=value.g;
        data[name].z=value.b;
        data[name].w=value.a;
    } else {
        if ( data[name].x === undefined ) {
            data[name].x=data[name].r;
            data[name].y=data[name].g;
            data[name].z=data[name].b;
            data[name].w=data[name].a;
        }
    }

    this.data=data;
    this.defaultValue=value;
    this.value=VG.Core.Color( value );
    this.alpha=alpha;
};

VG.Nodes.ParamColor.prototype=VG.Nodes.Param();

VG.Nodes.ParamColor.prototype.toString=function()
{
    var obj=this.data[this.name];
    return  "vec4( " + obj.r.toFixed(3) + "," + obj.g.toFixed(3) + "," + obj.b.toFixed(3) + "," + obj.a.toFixed(3) + " )";
};

VG.Nodes.ParamColor.prototype.toString3=function()
{
    var obj=this.data[this.name];
    return  "vec3( " + obj.r.toFixed(3) + "," + obj.g.toFixed(3) + "," + obj.b.toFixed(3) + " )";
};

// ----------------------------------------------------------------- VG.Nodes.ParamColor

VG.Nodes.ParamMaterial=function( data, name, text, value, alpha )
{
    /**
     * Creates a Material Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @param {VG.Core.Material} value - The initial value of this parameter.
     * @param {boolean} alpha - If the edit for this material should show an alpha slider for the color.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamMaterial ) ) return new VG.Nodes.ParamMaterial( data, name, text, value, alpha );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";

    if ( !data[name] )
    {
        data[name]={};
        data[name].r=value.color.r;
        data[name].g=value.color.g;
        data[name].b=value.color.b;
        data[name].a=value.color.a;
        data[name].metallic=value.metallic;
        data[name].smoothness=value.smoothness;
        data[name].reflectance=value.reflectance;
    }

    this.data=data;
    this.value=VG.Core.Material( value.color, value.metallic, value.smoothness, value.reflectance );
    this.alpha=alpha;
};

VG.Nodes.ParamColor.prototype=VG.Nodes.Param();

VG.Nodes.ParamColor.prototype.toString=function()
{
    var obj=this.data[this.name];
    return  "vec4( " + obj.r.toFixed(3) + "," + obj.g.toFixed(3) + "," + obj.b.toFixed(3) + "," + obj.a.toFixed(3) + " )";
};

// ----------------------------------------------------------------- VG.Nodes.ParamImage

VG.Nodes.ParamImage=function( data, name, text )
{
    /**
     * Creates an Image Parameter.<br>
     *
     * @param {object} data - The object which holds the low level representation of the parameters.
     * @param {string} name - The name of the new parameter, the name is used to identify parameters inside a container or group and has to be unique.
     * @param {string} text - The text to display in the user interface for this parameter.
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.ParamImage ) ) return new VG.Nodes.ParamImage( data, name, text );

    this.name=name ? name : "value";
    this.text=text ? text : "Value";

    this.value=VG.Core.Image();

    if ( !data[name] )
    {
        data[name]={};
        data[name].imageData=null;
        data[name].imageName="";
    }

    this.data=data;
};

VG.Nodes.ParamImage.prototype=VG.Nodes.Param();

VG.Nodes.ParamImage.prototype.updateFromData=function( data )
{
    if ( data[this.name] )
    {
        if ( data[this.name].imageData ) {
            VG.decompressImageData( data[this.name].imageData, this.value, function() {
                if ( this.group.container.node.graph && this.group.container.node.graph.update )
                    this.group.container.node.graph.update();
            }.bind( this ) );

            if ( VG.context.workspace.platform !== VG.HostProperty.PlatformWeb ) {
                if ( this.group.container.node.graph && this.group.container.node.graph.update )
                    this.group.container.node.graph.update();
            }
        } else this.value.clear();
    }
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.Nodes.Terminal

VG.Nodes.Terminal=function( type, name, onCall, onConnect, onDisconnect )
{
    /**
     * Creates a Terminal.<br>
     *
     * Terminals are either an input or an output of a VG.Nodes.Node. Terminals can be connected if their types match.
     *
     * @constructor
     * @param {VG.Nodes.Terminal.Type} type - The type of the Terminal. Terminals can be connected if they have the same type or if one of the Terminals has a type
     * of VG.Nodes.Terminal.Type.Universal.
     * @param {string} name - The name of the Terminal. The name of a Terminal inside a Node has to be unique.
     * @param {function} onCall - A function which is called when an output node is pulled during node graph execution. The parameters to onCall and its return value
     * depend on the terminal type. This function callback only needs to be set for output terminals.
     * @param {function} onConnect - Optional. A function which is called when the terminal is being connected. Can be used for input terminals to disable Node Parameters which
     * are being overruled by the terminal connection.
     * @param {function} onDisconnect - Optional. A function which is called when the terminal is being disconnected. Can be used for input terminals to enable Node Parameters which
     * are otherwise being overruled if the terminal would be connected.
    */

    if ( !(this instanceof VG.Nodes.Terminal ) ) return new VG.Nodes.Terminal( type, name, onCall, onConnect, onDisconnect );

    this.type=type;
    this.name=name;
    this.onCall=onCall;
    this.onConnect=onConnect;
    this.onDisconnect=onDisconnect;

    /**The node this terminal is embedded in.
     * @member {VG.Nodes.Node} */
    this.node=undefined;

    /**A list of other terminals this terminal is connected to.
     * @member {array} */
    this.connectedTo=[];
};

VG.Nodes.Terminal.Type={ "Universal" : 0, "String" : 1, "Float" : 2, "Vector2" : 3, "Vector3" : 4, "Vector4" : 5, "Sample" : 6, "Texture" : 7, "Material" : 8, "Map" : 9, "Function" : 10 };

VG.Nodes.Terminal.prototype.connectTo=function( t, dontAddToLowLevelData )
{
    /**Connects this terminal to the given terminal. It is assumed that canConnect() was called previously to make sure the terminals can be connected.
     * @param {VG.Nodes.Terminal} terminal - The terminal to connect to.
     */

    this.connectedTo.push( t );
    t.connectedTo.push( this );

    // --- Connect
    if ( !this.node.data.connections )  this.node.data.connections=[];
    if ( !t.node.data.connections )  t.node.data.connections=[];

    // --- Call the connection callbacks
    if ( this.onConnect ) this.onConnect( t );
    if ( t.onConnect ) t.onConnect( this );

    if ( dontAddToLowLevelData ) return;

    // --- Add the connection to the low level data representation
    this.node.data.connections.push( { terminalName : this.name, connNodeId : t.node.data.id, connTerminalName : t.name } );
    t.node.data.connections.push( { terminalName : t.name, connNodeId : this.node.data.id, connTerminalName : this.name } );
};

VG.Nodes.Terminal.prototype.disconnectFrom=function( t, dontRemoveFromLowLevelData )
{
    /**Disconnects this terminal from the given terminal. It is assumed that the two terminals are already connected, if not, this function does nothing.
     * @param {VG.Nodes.Terminal} terminal - The terminal to disconnect from.
     */

    // --- Call the disconnection callbacks
    if ( this.onDisconnect ) this.onDisconnect( t );
    if ( t.onDisconnect ) t.onDisconnect( this );

    // --- Disconnect
    var index=this.connectedTo.indexOf( t );
    if ( index >= 0 )
        this.connectedTo.splice( index, 1 );

    index=t.connectedTo.indexOf( this );
    if ( index >= 0 )
        t.connectedTo.splice( index, 1 );

    if ( dontRemoveFromLowLevelData ) return;

    // --- Remove the connection from the low level data representation
    function getConnIndex( array, terminalName, connNodeId, connTerminalName ) {
        for ( var i=0; i < array.length; ++i )
        {
            var conn=array[i];
            if ( conn.terminalName === terminalName && conn.connNodeId === connNodeId && conn.connTerminalName === connTerminalName )
                return i;
        }
        return -1;
    }

    index=getConnIndex( this.node.data.connections, this.name, t.node.data.id, t.name );
    var connIndex=getConnIndex( t.node.data.connections, t.name, this.node.data.id, this.name );

    if ( index !== -1 ) this.node.data.connections.splice( index, 1 );
    if ( connIndex !== -1 ) t.node.data.connections.splice( connIndex, 1 );
};

VG.Nodes.Terminal.prototype.canConnect=function( t )
{
    /**Checks if this terminal can be connected to the given terminal.
     * @param {VG.Nodes.Terminal} terminal - The terminal to check.
     * @returns True if the terminals can be connected, false otherwise.
     */

    // --- Make sure terminals are on different nodes and both or not an input or output
    if ( this.input !== t.input && this.node !== t.node )
    {
        // --- Make sure terminal types match
        if ( this.type === t.type || ( this.type === VG.Nodes.Terminal.Type.Universal || t.type === VG.Nodes.Terminal.Type.Universal ) ||
            ( this.type === VG.Nodes.Terminal.Type.Vector4 && t.type === VG.Nodes.Terminal.Type.Sample ) ||
            ( this.type === VG.Nodes.Terminal.Type.Sample && t.type === VG.Nodes.Terminal.Type.Vector4 ) )
        {
            // --- Input can have only one connection
            if ( ( this.input && this.isConnected() ) || ( t.input && t.isConnected() ) ) return false;
            else return true;
        }
    }
    return false;
};

VG.Nodes.Terminal.prototype.isConnected=function()
{
    /**Returns true if this terminal has at least one connection.
     * @returns True if the terminal is connected to at least one other terminal, false otherwise.
     */

    if ( this.connectedTo.length ) return true; else return false;
};

/** Disconnects all connected terminals.
 * @param {bool} dontRemoveFromLowLevelData - True if the disconnection should not affect the low level data reprentation, i.e. is only an UI operation.
 */

VG.Nodes.Terminal.prototype.disconnectAll=function( dontRemoveFromLowLevelData )
{
    for ( var c=0; c < this.connectedTo.length; ++c )
    {
        var ct=this.connectedTo[c];
        this.disconnectFrom( ct, dontRemoveFromLowLevelData );
    }
};

/**
 * Returns the connected terminal at the given index.
 * @returns True The connected terminal.
 */

VG.Nodes.Terminal.prototype.at=function( index )
{
    if ( index < this.connectedTo.length )
        return this.connectedTo[index];
};

/**
 * Returns the first connected terminal.
 * @returns True The connected terminal.
 */

VG.Nodes.Terminal.prototype.first=function()
{
    if ( this.connectedTo.length )
        return this.connectedTo[0];
};

VG.Nodes.Terminal.prototype.getValueType=function()
{
    let conn = this.first();
    if ( !conn ) return;

    if ( conn.type === VG.Nodes.Terminal.Type.Float ) return { type : VG.Nodes.Terminal.Type.Float, count : 1 };
    else
    if ( conn.type === VG.Nodes.Terminal.Type.Vector2 ) return { type : VG.Nodes.Terminal.Type.Vector2, count : 2 };
    else
    if ( conn.type === VG.Nodes.Terminal.Type.Vector3 ) return { type : VG.Nodes.Terminal.Type.Vector3, count : 3 };
    else
    if ( conn.type === VG.Nodes.Terminal.Type.Vector4 ) return { type : VG.Nodes.Terminal.Type.Vector4, count : 4 };
};
/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.Node

VG.Nodes.Node=function()
{
    /**
     * Creates a Node.<br>
     *
     * VG.Nodes.Node is the base class for all Nodes.
     *
     * @constructor
    */

    if ( !(this instanceof VG.Nodes.Node ) ) return new VG.Nodes.Node();

    if ( !this.name ) this.name="Base Node";

    /**The list of input terminals of this node.
     * @member {array} */
    this.inputs=[];

    /**The list of output terminals of this node.
     * @member {array} */
    this.outputs=[];

    this.createToken();
};

VG.Nodes.Node.prototype.createDefaultProperties=function( data )
{
    let group=this.container.addGroupByName( "basics", "Preview", false );
    if ( !this.noPreview )
        group.addParam( VG.Nodes.ParamBoolean( data, "showPreview", "Show Preview", true ) );
    group.addParam( VG.Nodes.ParamText( data, "comment", "Comment", "" ) );

    if ( this.description ) {
        let group=this.container.addGroupByName( "about", "About", false );
        group.addParam( VG.Nodes.ParamHtml( data, "about", "About", this.description ) );
    }

    return group;
};

VG.Nodes.Node.prototype.createToken=function( terminal )
{
   let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');
   let token = [], rnd = Math.random, r;

   for (let i = 0; i < 4; i++) {
        r = 0 | rnd()*chars.length;
        token[i] = chars[r];
   }
   this.token = token.join('');
};

VG.Nodes.Node.prototype.addInput=function( terminal )
{
    /**Adds the given terminal as an input terminal to this node.
     * @param {VG.Nodes.Terminal} terminal - The new input terminal.
     */

    terminal.node=this;
    terminal.input=true; terminal.output=false;
    this.inputs.push( terminal );

    return terminal;
};

VG.Nodes.Node.prototype.removeInput=function( terminal )
{
    /**Removes the given terminal as an input terminal from this node.
     * @param {VG.Nodes.Terminal} terminal - The input terminal to remove.
     */

    terminal.disconnectAll();
    terminal.node=null;

    var index=this.inputs.indexOf( terminal );
    if ( index >= 0 ) this.inputs.splice( index, 1 );
};

VG.Nodes.Node.prototype.addOutput=function( terminal )
{
    /**Adds the given terminal as an output terminal to this node.
     * @param {VG.Nodes.Terminal} terminal - The new output terminal.
     */

    terminal.node=this;
    terminal.input=false; terminal.output=true;
    this.outputs.push( terminal );

    return terminal;
};

VG.Nodes.Node.prototype.getInput=function( name )
{
    /**Gets the input terminal specified by name.
     * @param {string} terminal - The name of the terminal.
     * @returns The found terminal or null.
     */

    for ( var i=0; i < this.inputs.length; ++i )
        if ( this.inputs[i].name === name ) return this.inputs[i];

    return null;
};

VG.Nodes.Node.prototype.getOutput=function( name )
{
    /**Gets the input terminal specified by name.
     * @param {string} terminal - The name of the terminal.
     * @returns The found terminal or null.
     */

    for ( var i=0; i < this.outputs.length; ++i )
        if ( this.outputs[i].name === name ) return this.outputs[i];

    return null;
};

VG.Nodes.Node.prototype.hasConnectedInput=function()
{
    /**Returns true if one of the nodes inputs is connected, i.e. this node is not static.
     * @returns True if one of the inputs is connected or false otherwise.
     */

    for ( var i=0; i < this.inputs.length; ++i )
        if ( this.inputs[i].isConnected() ) return true;

    return false;
};

VG.Nodes.Node.prototype.getTerminal=function( terminalName )
{
    /**Gets the input or output terminal specified by name.
     * @param {string} terminal - The name of the terminal.
     * @returns The found terminal or null.
     */

    var i;
    for ( i=0; i < this.inputs.length; ++i )
    {
        if ( this.inputs[i].name === terminalName )
            return this.inputs[i];
    }

    for ( i=0; i < this.outputs.length; ++i )
    {
        if ( this.outputs[i].name === terminalName )
            return this.outputs[i];
    }

    return null;
};

VG.Nodes.Node.prototype.readConnections=function( outputsOnly )
{
    /**Reads the connections of the low level data and initializes the terminals and connections.
     * @param {bool} outputsOnly - Only connect output terminals (to make sure terminals are only connected once)
     */

    if ( this.data.connections ) {

        for ( var i=0; i < this.data.connections.length; ++i )
        {
            var conn=this.data.connections[i];
            var terminal=this.getTerminal( conn.terminalName );
            if ( terminal ) {

                if ( outputsOnly && terminal.input )
                    continue;

                var destNode=this.graph.nodes.get( conn.connNodeId );
                if ( destNode )
                {
                    var destTerminal=destNode.getTerminal( conn.connTerminalName );
                    if ( destTerminal ) terminal.connectTo( destTerminal, true );
                }
            }
        }
    }
};

VG.Nodes.Node.prototype.disconnectAll=function()
{
    /**Disonnects all terminals.
     */

    var i, t, c, ct;
    for ( i=0; i < this.inputs.length; ++i )
    {
        t=this.inputs[i];

        for ( c=0; c < t.connectedTo.length; ++c )
        {
            ct=t.connectedTo[c];
            t.disconnectFrom( ct, true );
        }
    }

    for ( i=0; i < this.outputs.length; ++i )
    {
        t=this.outputs[i];

        for ( c=0; c < t.connectedTo.length; ++c )
        {
            ct=t.connectedTo[c];
            t.disconnectFrom( ct, true );
        }
    }
};

VG.Nodes.Node.prototype.setParamColor=function( name, r, g, b, a )
{
    /**Sets the value of a color parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} r - The red value to set.
     * @param {number} g - The green value to set.
     * @param {number} b - The blue value to set.
     * @param {number} a - The alpha value to set.
     */
     if ( this.container )
        this.container.setParamColor( name, r, g, b, a );
};

VG.Nodes.Node.prototype.setParamNumber=function( name, value )
{
    /**Sets the value of a color parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
     if ( this.container )
        this.container.setParamNumber( name, value );
};

VG.Nodes.Node.prototype.setParamSlider=function( name, value )
{
    /**Sets the value of a slider parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
     if ( this.container )
        this.container.setParamSlider( name, value );
};

VG.Nodes.Node.prototype.setParamBoolean=function( name, value )
{
    /**Sets the value of a boolean parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
     if ( this.container )
        this.container.setParamBoolean( name, value );
};

VG.Nodes.Node.prototype.setParamList=function( name, value )
{
    /**Sets the value of a list parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} value - The value to set.
     */
     if ( this.container )
        this.container.setParamList( name, value );
};

VG.Nodes.Node.prototype.setParamVector2=function( name, x, y )
{
    /**Sets the value of a color parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} x - The x value to set.
     * @param {number} y - The y value to set.
     */
     if ( this.container )
        this.container.setParamVector2( name, x, y );
};

VG.Nodes.Node.prototype.setParamVector3=function( name, x, y, z )
{
    /**Sets the value of a color parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} x - The x value to set.
     * @param {number} y - The y value to set.
     * @param {number} z - The z value to set.
     */
     if ( this.container )
        this.container.setParamVector3( name, x, y, z );
};

VG.Nodes.Node.prototype.setParamVector4=function( name, x, y, z, w )
{
    /**Sets the value of a color parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} x - The x value to set.
     * @param {number} y - The y value to set.
     * @param {number} z - The z value to set.
     * @param {number} w - The w value to set.
     */
     if ( this.container )
        this.container.setParamVector4( name, x, y, z, w );
};

VG.Nodes.Node.prototype.setParamImage=function( name, imageName, imageData)
{
    /**Sets the value of an image parameter, identified by its name.
     * @param {string} name - The name of the parameter to set.
     * @param {number} imageName - The name of the image.
     * @param {imageData} imageData- The compressed data of the image to set.
     */

     if ( this.container )
        this.container.setParamImage( name, imageName, imageData );
};

VG.Nodes.availableNodes=new Map();

// ----------------------------------------------------------------- VG.Nodes.TimeCode

VG.Nodes.TimeCode=function()
{
    if ( !arguments.length || ( arguments.length === 1 && arguments[0] === undefined ) ) {
        this.h=0;
        this.m=0;
        this.s=0;
        this.f=0;
    } else
    if ( arguments.length === 4 ) {
        this.h=arguments[0];
        this.m=arguments[1];
        this.s=arguments[2];
        this.f=arguments[3];
    } else
    if ( arguments.length === 1 && typeof arguments[0] === 'string' ) {
        var arr=arguments[0].split( ":" );
        if ( arr.length === 4 ) {
            this.h=Number( arr[0] );
            this.m=Number( arr[1] );
            this.s=Number( arr[2] );
            this.f=Number( arr[3] );
        }
    } else
    if ( arguments.length === 1 && typeof arguments[0] === TimeCode ) {
        this.h=arguments[0].h;
        this.m=arguments[0].m;
        this.s=arguments[0].s;
        this.f=arguments[0].f;
        this.frames=arguments[0].frames;
    }

    this.calcFrames();
};

VG.Nodes.TimeCode.prototype.copy=function( tc )
{
    this.h=tc.h;
    this.m=tc.m;
    this.s=tc.s;
    this.f=tc.f;
    this.frames=tc.frames;
};

VG.Nodes.TimeCode.prototype.toString=function()
{
    var mText=this.m < 9 ? "0" + this.m : "" + this.m;
    var sText=this.s < 9 ? "0" + this.s : "" + this.s;

    return "" + this.h + ":" + mText + ":" + sText + ":" + this.f;
};

VG.Nodes.TimeCode.prototype.calcFrames=function()
{
    var fps=VG.context.frameBase;

    var rc=this.f;
    rc+=this.s * fps;
    rc+=this.m * 60 * fps;
    rc+=this.h * 60 * 60 * fps;

    this.frames=rc;
    return rc;
};

VG.Nodes.TimeCode.prototype.setTotalFrames=function( frame )
{
    var fps=VG.context.frameBase;

    this.f=Math.floor( frame % fps );
    this.s=Math.floor( frame / fps );
    this.m=Math.floor( this.s / 60 );
    this.h=Math.floor( this.m / (60 * 60) );

    this.s%=60;
    this.m%=60;

    this.calcFrames();
};

/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.NodeMaterial --- Material

VG.Nodes.NodeMaterial=function()
{
    if ( !(this instanceof VG.Nodes.NodeMaterial ) ) return new VG.Nodes.NodeMaterial();

    this.name="Material";
    this.className="NodeMaterial";
    this.noPreview=true;

    VG.Nodes.Node.call( this );

    // --- Terminals

    let colorTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "color" ) );
    let specularTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "specular" ) );
    let metallicTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "metallic" ) );
    let smoothnessTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "smoothness" ) );
    let reflectanceTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "reflectance" ) );
    let bumpTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "bump" ) );
    let normalTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "normal" ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Material, "out", function( options ) {

        options.code += "\nvoid " + options.materialName + "( in vec3 pos, inout Material material, inout vec3 normal ) {\n";

        options.code += "  pos /= " + this.container.getParam("scale").toString() + ";\n";

        options.code += "  material.type = 0;\n";
        options.code += "  material.specularAmount = 0.0;\n";
        options.code += "  material.emission = vec3(0);\n";

        if ( colorTerminal.isConnected() ) {
            let varName = colorTerminal.first().onCall( options );
            options.code += "  material.color = " + varName + ";\n";
        } else options.code += "  material.color = " + this.container.getParam("color").toString() + ".xyz;\n";

        if ( specularTerminal.isConnected() ) {
            let varName = specularTerminal.first().onCall( options );
            options.code += "  material.specularColor = " + varName + ";\n";
        } else options.code += "  material.specularColor = " + this.container.getParam("specular").toString() + ".xyz;\n";

        if ( metallicTerminal.isConnected() )
        {
            let varName = metallicTerminal.first().onCall( options );
            options.code += "  material.metallic = " + varName + ";\n";
        } else options.code += "  material.metallic = " + this.container.getParamValue("metallic").toFixed(4) + ";\n";

        if ( smoothnessTerminal.isConnected() )
        {
            let varName = smoothnessTerminal.first().onCall( options );
            options.code += "  material.smoothness = " + varName + ";\n";
        } else options.code += "  material.smoothness = " + this.container.getParamValue("smoothness").toFixed(4) + ";\n";

        if ( reflectanceTerminal.isConnected() )
        {
            let varName = reflectanceTerminal.first().onCall( options );
            options.code += "  material.reflectance = " + varName + ";\n";
        } else options.code += "  material.reflectance = " + this.container.getParamValue("reflectance").toFixed(4) + ";\n";

        let displacement = this.container.getParamValue( "bumps" );

        if ( normalTerminal.isConnected() && !options.physicalBumps ) {
            let varName = normalTerminal.first().onCall( options );
            // options.code += "  normal = normalize( " + varName + " );\n";
            options.code += "  normal = ( mix( normal, normalize(" + varName + "), " + this.container.getParamValue("normalWeight").toFixed(2) + " ) );\n";
        } else
        if ( bumpTerminal.isConnected() && !displacement )
        {
            if ( !options.physicalBumps )
            {
                // --- Use bumps to calculate normal
                options.override = true;
                options.code += "  vec2 eps = vec2( 0.0001, 0.0 );\n";

                options.code += "  vec3 origPos = pos;\n";

                options.code += "  pos = origPos + eps.xyy;\n";
                let varName = bumpTerminal.first().onCall( options );
                options.code += "  float nor_1 = " + varName + ";\n";
                options.code += "  pos = origPos - eps.xyy;\n";
                varName = bumpTerminal.first().onCall( options );
                options.code += "  float nor_2 =" + varName + ";\n";

                options.code += "  pos = origPos + eps.yxy;\n";
                varName = bumpTerminal.first().onCall( options );
                options.code += "  float nor_3 = " + varName + ";\n";
                options.code += "  pos = origPos - eps.yxy;\n";
                varName = bumpTerminal.first().onCall( options );
                options.code += "  float nor_4 = " + varName + ";\n";

                options.code += "  pos = origPos + eps.yyx;\n";
                varName = bumpTerminal.first().onCall( options );
                options.code += "  float nor_5 = " + varName + ";\n";
                options.code += "  pos = origPos - eps.yyx;\n";
                varName = bumpTerminal.first().onCall( options );
                options.code += "  float nor_6 = " + varName + ";\n";

                options.code += "  vec3 bumpNormal = normalize( vec3( nor_2 - nor_1, nor_4 - nor_3, nor_6 - nor_5 ) );\n";
                options.code += "  normal = ( mix( normal, bumpNormal, " + this.container.getParamValue("normalWeight").toFixed(2) + " ) );\n";
            } else {
                // --- Pass the physical bump, ignore normal
                let varName = bumpTerminal.first().onCall( options );
                options.code += "  material.bump = " + varName + ";\n";
            }
        }

        options.code+="\n}\n";

        // --- Displacement Code

        if ( displacement && bumpTerminal.isConnected() && !options.physicalBumps ) {
            options.clearVars();

            let preview = options.generatePreview;
            options.generatePreview = function() {};

            options.code += "\nfloat " + options.materialName + "_displacement( in vec3 pos ) {\n";
            options.code += "  vec3 normal = vec3( 0, 0, 1 );\n";
            options.code += "  pos /= " + this.container.getParam("scale").toString() + ";\n";
            let varName = bumpTerminal.first().onCall( options );
            options.code += "  return " + varName + ";\n";
            options.code+="\n}\n";

            options.generatePreview = preview;
        }

        // ---

        this.category = this.container.getParamValue( "category" );

    }.bind( this ) ) );

    this.colorTerminal = colorTerminal;
    this.bumpTerminal = bumpTerminal;
};

VG.Nodes.NodeMaterial.prototype=VG.Nodes.Node();

VG.Nodes.NodeMaterial.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "settings", "Material Settings" );

    group.addParam( VG.Nodes.ParamColor( data, "color", "Diffuse", VG.Core.Color( 128, 128, 128 ) ) );
    group.addParam( VG.Nodes.ParamColor( data, "specular", "Specular", VG.Core.Color( "#ffffff" ) ) );

    group.addParam( VG.Nodes.ParamSlider( data, "specularWeight", "Spec. Weight", 0, 0, 1, 0.1, 2 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "scale", "Global Scale", 1, 0, 10, 0.1, 2, 1 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "normalWeight", "Normal Weight", 0.2, 0, 1, 0.1, 2 ) );

    group=this.container.addGroupByName( "PBR", "PBR Properties / Bump Mapping" );

    group.addParam( VG.Nodes.ParamSlider( data, "metallic", "Metallic", 0, 0, 1, 0.1, 2 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "smoothness", "Smoothness", 0, 0, 1, 0.1, 2 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "reflectance", "Reflectance", 0.5, 0, 1, 0.1, 2 ) );

    group.addParam( VG.Nodes.ParamList( data, "bumps", "Bumps", 0, ["Bump Mapping", "Displacement Mapping"] ) );

    group=this.container.addGroupByName( "emissive", "Emissive", false );

    group.addParam( VG.Nodes.ParamBoolean( data, "emissive", "Emissive", false ) );
    group.addParam(VG.Nodes.ParamColor( data, "emissiveColor", "Emissive Color", VG.Core.Color( 255, 255, 255 ) ) );

    group.addParam( VG.Nodes.ParamSlider( data, "emissivePower", "Strength", 1, 0.01, 10, 0.1, 2 ) );

    group=this.container.addGroupByName( "dielectric", "Dielectric", false );

    group.addParam( VG.Nodes.ParamBoolean( data, "dielectric", "Dielectric", false ) );
    group.addParam( VG.Nodes.ParamSlider( data, "IOR", "IOR", 1.5, 0, 5, 0.1, 2 ) );

    group = this.createDefaultProperties( data );
    group.addParam( VG.Nodes.ParamText( data, "category", "Category", "" ) );
};

VG.Nodes.availableNodes.set( "Material.Material", "NodeMaterial" );



/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.Graph

/**
 * Creates a VG.Node.Graph.<br>
 *
 * A node graph contains a list of nodes and provides convenient functions to load / save the graph.
 *
 * @constructor
 */

VG.Nodes.Graph=function()
{
	if ( !(this instanceof VG.Nodes.Graph ) ) return new VG.Nodes.Graph();

    /**The array of nodes (nodes are derived from VG.Nodes.Node) contained in this graph.
     * @member {array} */
	this.nodes=new Map();

    this.idCounter=0;
};

/**
 * Adds the given node to this graph.
 * @param {VG.Nodes.Node} node - The node to add.
 */

VG.Nodes.Graph.prototype.addNode=function( node, customSetup )
{
    node.graph=this;

    if ( !node.data && !customSetup )
    {
        node.data={};

        Object.defineProperty( node.data, "node", { enumerable: false, writable: true } );

        while ( this.nodes.has( this.idCounter ) ) this.idCounter++;

        node.data.id=this.idCounter++;
        node.data.className=node.className;
        node.data.node=node;
        node.data.name=node.name;

        if ( node.createProperties )
            node.createProperties( node.data );
    }

    this.nodes.set( node.data.id, node );
};

/**
 * Creates the node of the given class name and add it to this graph
 * @param {string} className - The name of the class.
 */

VG.Nodes.Graph.prototype.createNode=function( className)
{
    var node=new VG.Nodes[className]();

    if ( node )
    {
        node.data={};

        Object.defineProperty( node.data, "node", {
            enumerable: false,
            writable: true
        });

        node.data.id=this.idCounter++;
        node.data.className=node.className;
        node.data.node=node;
        node.data.name=node.name;

        if ( node.createProperties )
            node.createProperties( node.data );

        this.nodes.set( node.data.id, node );
        node.graph=this;

        return node;
    }

    return null;
};

/**
 * Returns the node with the given id.
 * @param {number} id - The id of the node to return.
 * @returns The node associated with the given id.
 */

VG.Nodes.Graph.prototype.getNodeFromId=function( id )
{
    return this.nodes.get( id );
};

/**
 * Finds the node of the given name.
 * @param {string} name - The name of the node to return.
 * @returns The node associated with the given name.
 */

VG.Nodes.Graph.prototype.findNode=function( name )
{
    for (var node of this.nodes.values() )
    {
        if ( node.data.name === name )
            return node;
    }
};

/**
 * Finds the first node of the given class.
 * @param {string} name - The class name of the node to return.
 * @returns The node of the given class name
 */

VG.Nodes.Graph.prototype.findNodeClass=function( name )
{
    for (var node of this.nodes.values() )
    {
        if ( node.data.className === name )
            return node;
    }
};

/**
 * Initializes the graph from the given node array.
 */

VG.Nodes.Graph.prototype.loadNodesFromArray=function( array, displaceImage )
{
    if ( !array ) { VG.error( "Graph::load() could not find array."); return; }

    // --- Load the Nodes

    var i, nodeData;
    for ( i=0; i < array.length; ++i )
    {
        nodeData=array[i];

        Object.defineProperty( nodeData, "node", {
            enumerable: false,
            writable: true
        });

        nodeData.node=new VG.Nodes[nodeData.className]();
        nodeData.node.data=nodeData;

        if ( nodeData.node.createProperties )
            nodeData.node.createProperties( nodeData );

        if ( displaceImage && nodeData.className === "NodeImage" ) {
            var param=nodeData.node.container.getParam("image");
            param.value.set( displaceImage );
            nodeData.image.imageData=displaceImage.imageData;
            nodeData.image.imageName=displaceImage.name;
        }

        if ( nodeData.node.updateFromData )
            nodeData.node.updateFromData( nodeData );

        this.addNode( nodeData.node, true );
    }

    this.outputTerminal=null;

    // --- Connect the Nodes
    for( i=0; i < array.length; ++i )
    {
        nodeData=array[i];
        nodeData.node.readConnections( true );
    }

    return this.outputTerminal;
};

/**
 * Loads the nodes of a compressed graph.
 * @param {string} data - The compressed data to load.
 */

VG.Nodes.Graph.prototype.load=function( data, displaceImage )
{
    var string=VG.Utils.decompressFromBase64( data );

    var obj=JSON.parse( string );
    var array=null;

    if ( obj instanceof Array ) array=obj;
    else if ( obj.nodes instanceof Array ) array=obj.nodes;

    return this.loadNodesFromArray( array, displaceImage );
};

/**
 * Saves the node data of this graph. This is low level, in a GraphEdit environment this gets taken care of the node controller.
 * @returns {string} data - The compressed data
 **/

VG.Nodes.Graph.prototype.save=function()
{
    var arr=[];

    this.nodes.forEach(function(n) {
        arr.push( n.data );
    });
    var data=JSON.stringify( arr );
    data=VG.Utils.compressToBase64( data );

    return data;
};

/**
 * Called when the graph has changed and the graph has to be rerun.
 **/


VG.Nodes.Graph.prototype.update=function()
{
    if ( this.updateCallback )
        this.updateCallback();
};

VG.Nodes.Graph.prototype.nodePropertyWillChange=function( param, data )
{
    if ( this.nodePropertyWillChangeCallback )
        this.nodePropertyWillChangeCallback( param, data );
};

/**
 * Clears the graph.
 **/

VG.Nodes.Graph.prototype.clear=function( id )
{
    this.nodes.clear();
    this.idCounter=0;
};

/**
 *
 */

VG.Nodes.Graph.prototype.getMaterialNode=function()
{
    let node = this.findNodeClass( "NodeMaterial" );
    return node;
};

/**
 * Utility function called from collectGlobals(). Builds the global code from the branch starting from this terminal.
 * @param {VG.Nodes.Terminal} terminal - The terminal to start collection globals.
 * @param {array} nodesProcessed - The array holding the already processed nodes.
 * @param {string} globalCode - The already processed global code.
 * @returns {string} The accumulated global code.
 */

VG.Nodes.Graph.prototype.collectTerminalBranch=function( terminal, nodesProcessed, globalCode )
{
    if ( terminal && terminal.isConnected() ) {
        for ( let i = 0; i < terminal.connectedTo.length; ++i )
        {
            let cTerminal = terminal.connectedTo[i];

            let n = cTerminal.node;

            // --- Parse the nodes inputs
            for ( i = 0; i < n.inputs.length; ++i )
            {
                let iTerminal = n.inputs[i];
                globalCode = this.collectTerminalBranch( iTerminal, nodesProcessed, globalCode );
            }

            // --- Add the node if not yet processed
            if ( !nodesProcessed.includes( n.className ) && !nodesProcessed.includes( n.token ) )
            {
                if ( n.getGlobalCode !== undefined )
                    globalCode += n.getGlobalCode();

                if ( !n.modifiesGlobal ) nodesProcessed.push( n.className );
                else nodesProcessed.push( n.token );
            }
        }
    }

    return globalCode;
};

/**
 * Builds the global code of the nodes starting from the given node.
 * @param {VG.Nodes.Node} node - The node to build the global code from.
 * @param {array} nodesProcessed - The already processed nodes (multiple graphs / materials etc)
 * @returns The global code of the nodes in the chain.
 */

VG.Nodes.Graph.prototype.collectGlobals=function( node, nodesProcessed )
{
    let globalCode = "";

    for ( i = 0; i < node.inputs.length; ++i )
    {
        let terminal = node.inputs[i];
        globalCode = this.collectTerminalBranch( terminal, nodesProcessed, globalCode );
    }

    return globalCode;
};

/**
 * Compiles the graph as a material function.
 * @returns {object} The return object. The success member indicates success, code will contain the compiled material and globalCode the global code necessary for the material.
 */

VG.Nodes.Graph.prototype.compileAsMaterial=function( { code = "", materialName = "material_1", generatePreview = function() {}, physicalBumps = false } = {} )
{
    var rc={ success : false, error : "" };

    // --- Get the global code and the material node

    let materialNode;

    // --- Locate the material node

    this.nodes.forEach(function(n) {
        if ( n.className === "NodeMaterial" )
            materialNode=n;
    } );

    if ( !materialNode ) {
        rc.globalCode = "";
        rc.code = "\nvoid " + materialName + "( in vec3 pos, inout Material material, inout vec3 normal ) {}\n";
        return rc;
    }

    let nodesProcessed=[];

    rc.globalCode = this.collectGlobals( materialNode, nodesProcessed );

    let options = {};
    options.code = "";
    options.globalCode = rc.globalCode;
    options.materialName = materialName;
    options.generatePreview = generatePreview;
    options.physicalBumps = physicalBumps;

    let variables = {};

    options.getVar = function( node, terminal, type ) {
        let rc={};
        rc.name = node.token + "_" + terminal;
        if ( variables[rc.name] ) {
            rc.exists = true;
            rc.code = rc.name;
        } else {
            variables[rc.name] = true;
            rc.code = type + " " + rc.name;
        }
        return rc;
    }.bind( this );

    options.clearVars = function() {
        variables = {};
    }.bind( this );

    let outTerminal=materialNode.getOutput( "out" );
    outTerminal.onCall( options );

    // console.log( options.code );

    rc.code = options.code;
    rc.success = true;

    return rc;
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.Nodes.ParamContainerEdit

VG.Nodes.ParamContainerEdit=function( container, { tabs = false, noContainer = false, callback, horizontal = false } = {} )
{
    if ( !(this instanceof VG.Nodes.ParamContainerEdit ) ) return new VG.Nodes.ParamContainerEdit( container, { tabs, noContainer, callback } );

    VG.UI.Widget.call( this );
    this.name="ParamContainerEdit";
    this.container=container;

    if ( !tabs ) this.containerWidget=VG.UI.SnapperWidget( { horizontal: horizontal } );
    else {
        this.containerWidget=VG.UI.TabWidget();
        this.containerWidget.small=true;
    }

    this.layout=VG.UI.Layout( this.containerWidget );
    this.layout.margin.set( 0, 0, 0, 0 );
    this.layout.parent=this;

    if ( !container ) return;

    for( let i=0; i < this.container.groups.length; ++i )
    {
        let group = this.container.groups[i];
        if ( !group.visible ) continue;

        group.layout = new VG.UI.LabelLayout();
        if ( group.disabled || container.disabled ) group.layout.disabled = true;

        if ( tabs ) this.containerWidget.addItem( group.text, group.layout );
        else this.containerWidget.addItem( group.text, group.layout, group.open );

        for( let p=0; p < group.parameters.length; ++p )
        {
            let param=group.parameters[p], object;

            if ( param instanceof VG.Nodes.ParamText )
            {
                param.widget=VG.UI.TextLineEdit( param.data[param.name] );
                param.widget.name=param.name;
                param.widget.maximumSize.width = 320;

                param.widget.textChanged=function( value, contineous, object ) {
                    var param=this.container.getParam( object.name );

                    // --- Send undo packet with old & new value
                    if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                        object={ oldValue: param.data[param.name], newValue: value };
                        this.container.node.graph.nodePropertyWillChange( param, object );
                    }

                    param.data[param.name]=value;

                    // --- Update the graph
                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();
                }.bind( this );

                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamHtml )
            {
                param.widget=VG.UI.HtmlWidget();
                param.widget.margin.set( 0, 0, 0, 0 );
                param.widget.adjustToHeight = true;
                param.widget.html = param.data[param.name];
                param.widget.supportsAutoFocus = true;
                param.widget.linkCallback=function( link ) {
                    VG.gotoUrl( link );
                };
                param.widget.name=param.name;

                group.layout.addChild( param.text !== "Html" ? param.text : "", param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamNumber )
            {
                param.widget=VG.UI.NumberEdit( param.data[param.name], param.min, param.max, param.precision );
                param.widget.name=param.name;

                param.widget.changed=function( value, contineous, object ) {
                    var param=this.container.getParam( object.name );

                    // --- Send undo packet with old & new value
                    if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                        object={ oldValue: param.data[param.name], newValue: value };
                        this.container.node.graph.nodePropertyWillChange( param, object );
                    }

                    param.data[param.name]=value;

                    // --- Update the graph
                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();
                    if ( callback ) callback( false, param );
                }.bind( this );

                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamSlider )
            {
                param.widget=VG.UI.Slider( { min : param.min, max : param.max, step : param.step, editable : true, precision : param.precision } );
                param.widget.halfWidthValue=param.halfWidthValue;
                if ( horizontal ) param.widget.minimumSize.width=260;
                param.widget.edit.minimumSize.width=55;
                param.widget.value=param.data[param.name];
                param.widget.name=param.name;
                param.widget.maximumSize.width = 320;

                param.widget.changed=function( value, continuous, object ) {

                    var autoKey=this.container.node && this.container.node.graph && this.container.node.graph.autoKeying;
                    var param=this.container.getParam( object.name );

                    if ( autoKey )
                    {
                        let frame = this.container.node.graph.time.frames - this.container.node.inTime.frames;
                        let key = this.container.keyFrameAt( param.data, frame );
                        let noUndo = continuous, addKey = true;

                        if ( key === undefined ) noUndo = false;

                        if ( key ) {

                            if ( key[param.name] === value ) addKey=false;
                            else if ( continuous && this.contStartValue === undefined ) {
                                this.contStartValue = key[param.name];
                            }
                        }

                        if ( key && !addKey && !continuous && this.contStartValue !== undefined ) {
                            addKey=true;
                            key[param.name]=this.contStartValue;
                            this.contStartValue=undefined;
                        }

                        if ( addKey )
                            this.container.addKeyFrame( frame, param, value, noUndo );
                    } else {

                        // --- Send undo packet with old & new value
                        if ( !continuous && this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange && !param.customUndo  )  {
                            object={ oldValue: param.widget.startValue, newValue: value };
                            this.container.node.graph.nodePropertyWillChange( param, object );
                        }

                        param.data[param.name]=value;

                        // --- Update the graph
                        if (  this.container.node && this.container.node.graph  )
                            this.container.node.graph.update();
                    }
                    if ( callback ) callback( continuous, param );
                }.bind( this );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamBoolean )
            {
                param.widget=VG.UI.CheckBox( param.data[param.name] );
                param.widget.name=param.name;

                param.widget.changed=function( value, object ) {

                    var autoKey=this.container.node && this.container.node.graph && this.container.node.graph.autoKeying;
                    var param=this.container.getParam( object.name );

                    if ( autoKey ) this.container.addKeyFrame( this.container.node.graph.time.frames - this.container.node.inTime.frames, param, value );
                    else {
                        // --- Send undo packet with old & new value
                        if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                            object={ oldValue: param.data[param.name], newValue: value };
                            this.container.node.graph.nodePropertyWillChange( param, object );
                        }

                        param.data[param.name]=value;

                        // --- Update the graph
                        if (  this.container.node && this.container.node.graph  )
                            this.container.node.graph.update();
                    }
                    if ( callback ) callback( false, param );
                }.bind( this );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamList )
            {
                param.widget=VG.UI.DropDownMenu();
                param.widget.name=param.name;

                if ( param.list ) {
                    for ( var ii=0; ii < param.list.length; ++ii )
                        param.widget.addItem( param.list[ii] );
                }

                param.widget.index=param.data[param.name];
                if ( param.callback ) param.callback( param.data[param.name] );

                param.widget.changed=function( value, textValue, object ) {
                    var param=this.container.getParam( object.name );

                    // --- Send undo packet with old & new value
                    if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                        object={ oldValue: param.data[param.name], newValue: value };
                        this.container.node.graph.nodePropertyWillChange( param, object );
                    }

                    param.data[param.name]=value;

                    if ( param.callback ) param.callback( value );

                    // --- Update the graph
                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();

                    if ( callback ) callback( false, param );
                }.bind( this );

                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamButton )
            {
                param.widget = new VG.UI.Button( param.text );
                param.widget.name=param.name;

                param.widget.clicked = function() {
                    if ( param.callback ) param.callback();
                }.bind( this );

                group.layout.addChild( "", param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamVector2 )
            {
                param.widget=VG.UI.Vector2Edit( param.data[param.name].x, param.data[param.name].y, param.min, param.max, param.precision );
                param.widget.name=param.name;
                param.widget.maximumSize.width = 320;

                param.widget.changed=function( value, contineous, object ) {
                    var autoKey=this.container.node && this.container.node.graph && this.container.node.graph.autoKeying;
                    var param=this.container.getParam( object.name );

                    if ( autoKey ) this.container.addKeyFrame( this.container.node.graph.time.frames - this.container.node.inTime.frames, param, value );
                    else {

                        // --- Send undo packet with old & new value
                        if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                            object={ oldValue: { x : param.data[param.name].x, y : param.data[param.name].y },
                                newValue: { x: value.x, y : value.y } };
                            this.container.node.graph.nodePropertyWillChange( param, object );
                        }

                        param.data[param.name].x=value.x;
                        param.data[param.name].y=value.y;

                        // --- Update the graph
                        if (  this.container.node && this.container.node.graph  )
                            this.container.node.graph.update();
                    }

                    if ( callback ) callback( false, param );
                }.bind( this );

                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamVector2List )
            {
                param.dc=VG.Data.Collection( "ParamVector2List" );
                param.dc.values = param.data[param.name];
                param.widget = VG.UI.TreeWidget();
                param.widget.name=param.name;
                param.widget.maximumSize.height = 250;

                let controller = param.widget.bind( param.dc, "values" );

                for ( let i = 0; i < param.dc.values.length; ++i ) {
                    let item = param.dc.values[i];
                    item.text = `Point at ${item.x.toFixed(2)}  ${item.y.toFixed(2)}`;
                }

                if ( param.dc.values.length )
                    controller.selected = controller.at( param.index );

                let doUndo = function() {
                }.bind( this );

                let edit = VG.UI.Vector2Edit( 0, 0, param.min, param.max, 2 );
                edit.minimumSize.height = 30;
                edit.changed = function( value ) {
                    let selected = controller.selected;
                    selected.x = value.x;
                    selected.y = value.y;

                    selected.text = `Point at ${selected.x.toFixed(2)}  ${selected.y.toFixed(2)}`;

                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();
                    if ( callback ) callback( false, param );
                }.bind( this );

                let addButton=VG.UI.ToolBarButton();
                addButton.text="+";
                addButton.toolTip="Add a point.";
                // this.addMaterialButton.disabled=true;
                addButton.clicked=function() {
                    let point = { text : "Point at 0  0", x : 0, y : 0 };
                    controller.add( "", point );
                    controller.selected = point;

                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();
                    if ( callback ) callback( false, param );
                }.bind( this );

                let removeButton=VG.UI.ToolBarButton();
                removeButton.text="-";
                removeButton.toolTip="Removes the point.";
                removeButton.clicked=function() {
                    let selected = controller.selected;
                    if ( selected ) controller.remove( selected );

                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();
                    if ( callback ) callback( false, param );
                }.bind( this );

                param.widget.addToolWidget( addButton );
                param.widget.addToolWidget( removeButton );
                param.widget.addToolWidget( VG.UI.LayoutHSeparator() );
                param.widget.addToolWidget( edit );

                param.editWidget = edit;
                param.controller = controller;

                controller.addObserver( "selectionChanged", function() {
                    let selected = controller.selected;
                    edit.set( selected.x, selected.y );
                    removeButton.disabled = controller.length <= 2;//param.minimumPoints;
                    param.index = Number( controller.indexOf( selected ) );
                }.bind( this ) );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamVector3 )
            {
                param.widget=VG.UI.Vector3Edit( param.data[param.name].x, param.data[param.name].y, param.data[param.name].z, param.min, param.max );
                param.widget.name=param.name;
                param.widget.fixedPrecision=3;
                param.widget.enableXYZMode();
                param.widget.maximumSize.width=320;

                param.widget.changed=function( value, contineous, object ) {
                    var param=this.container.getParam( object.name );

                    // --- Send undo packet with old & new value
                    if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange && !param.customUndo )  {
                        object={ oldValue: { x : param.data[param.name].x, y : param.data[param.name].y, z : param.data[param.name].z },
                            newValue: { x: value.x, y : value.y, z : value.z } };
                        this.container.node.graph.nodePropertyWillChange( param, object );
                    }

                    param.data[param.name].x=value.x;
                    param.data[param.name].y=value.y;
                    param.data[param.name].z=value.z;

                    // --- Update the graph
                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();

                    if ( callback ) callback( false, param );
                }.bind( this );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamVector4 )
            {
                param.widget=VG.UI.Vector4Edit( param.data[param.name].x, param.data[param.name].y, param.data[param.name].z, param.data[param.name].w, param.min, param.max );
                param.widget.name=param.name;
                param.widget.fixedPrecision=3;
                param.widget.minimumSize.height=30;

                param.widget.changed=function( value, contineous, object ) {
                    var param=this.container.getParam( object.name );

                    // --- Send undo packet with old & new value
                    if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                        object={ oldValue: { x : param.data[param.name].x, y : param.data[param.name].y, z : param.data[param.name].z, w : param.data[param.name].w },
                            newValue: { x: value.x, y : value.y, z : value.z, w : value.w } };
                        this.container.node.graph.nodePropertyWillChange( param, object );
                    }

                    param.data[param.name].x=value.x;
                    param.data[param.name].y=value.y;
                    param.data[param.name].z=value.z;
                    param.data[param.name].w=value.w;

                    // --- Update the graph
                    if (  this.container.node && this.container.node.graph  )
                        this.container.node.graph.update();

                    if ( callback ) callback( false, param );
                }.bind( this );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamColor )
            {
                param.widget=VG.UI.ColorEdit();

                param.value.set( param.data[param.name].r, param.data[param.name].g, param.data[param.name].b,
                    param.data[param.name].a );

                param.widget.color=param.value;
                param.widget.name=param.name;

                param.widget.changed=function( value, continuous, object ) {
                    if ( continuous ) return;

                    var autoKey=this.container.node && this.container.node.graph && this.container.node.graph.autoKeying;
                    var param=this.container.getParam( object.name );

                    if ( autoKey ) this.container.addKeyFrame( this.container.node.graph.time.frames - this.container.node.inTime.frames, param, value );
                    else {
                        // --- Send undo packet with old & new value
                        if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                            object={ oldValue: { r : param.data[param.name].r, g : param.data[param.name].g, b : param.data[param.name].b, a : param.data[param.name].a },
                                newValue: { r: value.r, g : value.g, b : value.b, a : value.a } };
                            this.container.node.graph.nodePropertyWillChange( param, object );
                        }

                        param.data[param.name].r=value.r;
                        param.data[param.name].g=value.g;
                        param.data[param.name].b=value.b;
                        param.data[param.name].a=value.a;

                        param.data[param.name].x=value.r;
                        param.data[param.name].y=value.g;
                        param.data[param.name].z=value.b;
                        param.data[param.name].w=value.a;

                        if (  this.container.node && this.container.node.graph && this.container.node.graph.update )
                            this.container.node.graph.update();

                        VG.update();
                    }
                    if ( callback ) callback( false, param );
                }.bind( this );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            }  else
            if ( param instanceof VG.Nodes.ParamCustom )
            {
                param.widget=param.cb( "CreateWidget" );

                param.widget.disabled=param.disabled;
                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamMaterial )
            {
                param.widget = new VG.UI.MaterialEdit( { alpha: param.alpha } );

                param.value.set( VG.Core.NormalizedColor( param.data[param.name].r, param.data[param.name].g, param.data[param.name].b, param.data[param.name].a ),
                    param.data[param.name].metallic, param.data[param.name].smoothness, param.data[param.name].reflectance );

                param.widget.material=param.value;
                param.widget.name=param.name;

                param.widget.changed=function( value, continuous, object ) {

                    var autoKey=this.container.node && this.container.node.graph && this.container.node.graph.autoKeying;
                    var param=this.container.getParam( object.name );

                    if ( !continuous ) {
                        if ( autoKey ) this.container.addKeyFrame( this.container.node.graph.time.frames - this.container.node.inTime.frames, param, value );
                        else {
                            // --- Send undo packet with old & new value
                            if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                                object={ oldValue: { r : param.data[param.name].r, g : param.data[param.name].g, b : param.data[param.name].b, a : param.data[param.name].a },
                                    newValue: { r: value.r, g : value.g, b : value.b, a : value.a } };
                                this.container.node.graph.nodePropertyWillChange( param, object );
                            }
                        }
                    }

                    param.data[param.name].r=value.color.r;
                    param.data[param.name].g=value.color.g;
                    param.data[param.name].b=value.color.b;
                    param.data[param.name].a=value.color.a;
                    param.data[param.name].metallic=value.metallic;
                    param.data[param.name].smoothness=value.smoothness;
                    param.data[param.name].reflectance=value.reflectance;

                    if (  this.container.node && this.container.node.graph && this.container.node.graph.update )
                        this.container.node.graph.update();

                    VG.update();
                    if ( callback ) callback( false, param );
                }.bind( this );

                group.layout.addChild( param.text, param.widget );
            }  else
            if ( param instanceof VG.Nodes.ParamImage )
            {
                param.widget=VG.UI.ImageSelector( param.data[param.name].imageName );
                //param.widget.color=String( param.value );
                param.widget.name=param.name;

                param.widget.changed=function( image, imageName, object ) {
                    var param=this.container.getParam( object.name );

                    // --- Send undo packet with old & new value
                    if (  this.container.node && this.container.node.graph && this.container.node.graph.nodePropertyWillChange )  {
                        object={ oldValue: { imageData : param.data[param.name].imageData, imageName : param.data[param.name].imageName },
                            newValue: { imageData: image.imageData, imageName : imageName } };
                        this.container.node.graph.nodePropertyWillChange( param, object );
                    }

                    param.data[param.name].imageData=image.imageData;
                    param.data[param.name].imageName=imageName;

                    VG.decompressImageData( image.imageData, param.value, function() {
                        if (  this.container.node && this.container.node.graph && this.container.node.graph.update )
                        this.container.node.graph.update();
                    }.bind( this ) );

                    if (  this.container.node && this.container.node.graph && this.container.node.graph.update )
                        this.container.node.graph.update();
                }.bind( this );

                group.layout.addChild( param.text, param.widget );
            } else
            if ( param instanceof VG.Nodes.ParamDivider )
            {
                group.layout.addDivider( param.text );
            } else
            if ( param instanceof VG.Nodes.ParamToolSettings )
            {
                let label = new VG.UI.Label( "Settings" );
                label.margin = new VG.Core.Size( 20, 15 );

                let toolLayout = VG.UI.LabelLayout();
                toolLayout.margin.set( 10, 10, 10, 10 );
                toolLayout.vertical = true;

                param.widget = new VG.UI.ToolSettings( label, { layout : toolLayout, height : param.height, text : param.text + " Settings" } );
                group.layout.addChild( param.text, param.widget );

                this.preToolLayout = group.layout;
                group.layout = toolLayout;
                this.toolLayoutCount = param.widgetCount + 1;
            }

            if ( param && param.widget ) {
                param.widget.toolTip = param.toolTip;
                param.widget.statusTip = param.statusTip;
            }

            if ( this.preToolLayout ) {
                this.toolLayoutCount--;
                if ( !this.toolLayoutCount ) {
                    group.layout = this.preToolLayout;
                    this.preToolLayout = undefined;
                }
            }

            if ( param && param.widget && this.container.node && this.container.node.getInput ) {

                var terminal=this.container.node.getInput( param.name );
                if ( terminal && terminal.isConnected() )
                    param.widget.disabled=true;
            }
        }

        if ( noContainer ) {
            this.layout = group.layout;
            break;
        }
    }
};

VG.Nodes.ParamContainerEdit.prototype=VG.UI.Widget();

VG.Nodes.ParamContainerEdit.prototype.resync=function()
{
    for( var i=0; i < this.container.groups.length; ++i )
    {
        var group=this.container.groups[i];

        for( var p=0; p < group.parameters.length; ++p )
        {
            var param=group.parameters[p], object;

            if ( param instanceof VG.Nodes.ParamText )
            {
                if ( param.widget ) {
                    param.widget.text=param.data[param.name];
                }
            } else
            if ( param instanceof VG.Nodes.ParamNumber )
            {
                if ( param.widget ) {
                    param.widget.value=param.data[param.name];
                }
            } else
            if ( param instanceof VG.Nodes.ParamSlider )
            {
                if ( param.widget ) {
                    param.widget.value=param.data[param.name];
                }
            } else
            if ( param instanceof VG.Nodes.ParamBoolean )
            {
                if ( param.widget ) {
                    param.widget.checked=param.data[param.name];
                }
            } else
            if ( param instanceof VG.Nodes.ParamList )
            {
                if ( param.widget ) {
                    param.widget.index=param.data[param.name];
                }
            } else
            if ( param instanceof VG.Nodes.ParamVector2 )
            {
                if ( param.widget ) {
                    param.widget.set( param.data[param.name].x, param.data[param.name].y );
                }
            } else
            if ( param instanceof VG.Nodes.ParamVector2List )
            {
                if ( param.widget ) {
                    for ( let i = 0; i < param.dc.values.length; ++i ) {
                        let item = param.dc.values[i];
                        item.text = `Point at ${item.x.toFixed(2)}  ${item.y.toFixed(2)}`;
                    }
                }
                if ( param.editWidget ) {
                    let selected = param.controller.selected;
                    param.editWidget.set( selected.x, selected.y );
                }
            } else
            if ( param instanceof VG.Nodes.ParamVector3 )
            {
                if ( param.widget ) {
                    param.widget.set( param.data[param.name].x, param.data[param.name].y, param.data[param.name].z );
                }
            } else
            if ( param instanceof VG.Nodes.ParamVector4 )
            {
                if ( param.widget ) {
                    param.widget.set( param.data[param.name].x, param.data[param.name].y, param.data[param.name].z, param.data[param.name].w );
                }
            } else
            if ( param instanceof VG.Nodes.ParamColor )
            {
                if ( param.widget ) {
                    param.value.set( param.data[param.name].r, param.data[param.name].g, param.data[param.name].b,
                        param.data[param.name].a );
                    param.widget.color=param.value;
                }
            }  else
            if ( param instanceof VG.Nodes.ParamMaterial )
            {
                if ( param.widget ) {
                    param.value.set( VG.Core.NormalizedColor( param.data[param.name].r, param.data[param.name].g, param.data[param.name].b, param.data[param.name].a ),
                        param.data[param.name].metallic, param.data[param.name].smoothness, param.data[param.name].reflectance );

                    param.widget.material=param.value;
                }
            }  else
            if ( param instanceof VG.Nodes.ParamImage )
            {
            }

            if ( param && param.widget && this.container.node && this.container.node.getInput ) {

                var terminal=this.container.node.getInput( param.name );
                if ( terminal && terminal.isConnected() )
                    param.widget.disabled=true;

            }
        }
    }
};

VG.Nodes.ParamContainerEdit.prototype.paintWidget=function( canvas )
{
    this.layout.rect.set( this.rect );
    this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.UI.ImageSelector

VG.UI.ImageSelector=function( name )
{
    if ( !(this instanceof VG.UI.ImageSelector) ) return new VG.UI.ImageSelector( name );

    VG.UI.Widget.call( this );
    this.name="ImageSelector";
    this.imageName=name;

    this.supportsFocus=true;
    this.minimumSize.width=40;

    this.horizontalExpanding=true;
    this.verticalExpanding=false;

    this.label=VG.UI.Label( name );
    this.label.horizontalExpanding=true;
    this.label.frameType=VG.UI.Frame.Type.Box;
    this.label.hAlignment=VG.UI.HAlignment.Left;

    this.button=VG.UI.Button( "Select..." );
    //this.button.big=false;

    this.button.clicked=function() {
        var fileDialog=VG.OpenFileDialog( VG.UI.FileDialog.Image, function( name, image ) {

            this.label.text=VG.Utils.fileNameFromPath( name );
            if ( this.changed ) this.changed( image, this.label.text, this );

        }.bind( this ) );
    }.bind( this );

    this.layout=VG.UI.Layout( this.label, this.button );
    this.layout.margin.set( 0, 0, 0, 0 );
};

VG.UI.ImageSelector.prototype=VG.UI.Widget();

VG.UI.ImageSelector.prototype.calcSize=function( canvas )
{
    return this.label.calcSize( canvas );
};

VG.UI.ImageSelector.prototype.paintWidget=function( canvas )
{
    this.layout.rect.set( this.rect );
    this.layout.layout( canvas );
};

/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.GraphEdit

VG.Nodes.GraphEdit=function( { readOnly = false, mapPreview = false, materialPreview = true, closeCallback } = {} )
{
    if ( !(this instanceof VG.Nodes.GraphEdit ) ) return new VG.Nodes.GraphEdit( { readOnly, mapPreview, materialPreview, closeCallback } );

    VG.UI.Widget.call( this );

    this.supportsFocus=true;
    this.nodePreviewRect = VG.Core.Rect( 0, 0, 158, 116 );

    var node;

    // --- DnD source
    this.graphView.addNodeAt=function( pos, className ) {
        node=new VG.Nodes[className]();

        this.addNode( node, false, pos );
    }.bind( this );

    this.nodeNameEdit=VG.UI.TextLineEdit();
    this.nodeNameEdit.disabled=true;
    this.nodeNameEdit.textChanged=function( text ) {
        var selected=this.controller.selected;
        selected.name=text;
    }.bind( this );

    this.nodeNameEditLayout=VG.UI.LabelLayout( "Name", this.nodeNameEdit );
    this.nodeNameEditLayout.margin.bottom=0;

    this.containerLayout=VG.UI.Layout();// this.nodeNameEditLayout );
    this.containerLayout.margin.set( 0, 0, 0, 0 );
    //this.containerLayout.title="Node Name and Settings";
    this.containerLayout.vertical=true;
    this.containerLayout.spacing=0;

    // --- Available Nodes

    this.dc=VG.Data.Collection( "Available Nodes" );
    this.dc.nodes=[];
    this.dc.terminals=[];

	this.availableNodes=VG.UI.ListWidget();
    this.availableNodes.setDragSourceId( "Node" );

    this.availableNodes.paintItemCallback=function( canvas, item, paintRect, selected ) {
        itemRect.copy( paintRect );
        itemRect.x+=7; itemRect.width-=7;
        canvas.drawTextRect( item.text, itemRect, VG.UI.stylePool.current.skin.ListWidget.TextColor, 0, 1 );
        itemRect.width-=7;
        canvas.drawTextRect( item.category, itemRect, VG.UI.stylePool.current.skin.ListWidget.TextColor, 2, 1 );
    }.bind( this );

    this.availableNodesController=this.availableNodes.bind( this.dc, "nodes" );

    // Filter

    this.availableNodesFilterEdit=VG.UI.TextLineEdit();
    this.availableNodesFilterEdit.textChanged=function( text, cont ) {
        this.nodesFilter( text, this.availableNodesFilterDD.text() );
    }.bind( this );

    this.availableNodesFilterDD=VG.UI.DropDownMenu();
    this.availableNodesFilterDD.changed=function( text ) {
        this.nodesFilter( this.availableNodesFilterEdit.text, this.availableNodesFilterDD.text() );
    }.bind( this );

    this.availableNodesFilterLayout=VG.UI.Layout( this.availableNodesFilterEdit, this.availableNodesFilterDD );
    this.availableNodesFilterLayout.margin.set( 2, 2, 2, 2 );

    this.availableNodesLayout=VG.UI.Layout( this.availableNodesFilterLayout, this.availableNodes );
    this.availableNodesLayout.title="Available Nodes";
    this.availableNodesLayout.margin.clear();
    this.availableNodesLayout.vertical=true;
    this.availableNodesLayout.spacing=0;

    this.nodesFilter=function( text, category ) {

        var array=this.dc.dataForPath( "nodes" );
        text=text.toLowerCase();

        // VG.log( text, category );

        for( var i=0; i < array.length; ++i )
        {
            var item=array[i];

            item.visible=true;
            if ( !item.text.toLowerCase().includes( text ) ) item.visible=false;
            if ( category !== "All" && item.category !== category ) item.visible=false;
        }

        VG.update();
        this.availableNodes.changed();

    }.bind( this );


   	this.availableNodes.mouseDoubleClick=function( event ) {
   		if ( this.availableNodesController.selected && this.availableNodesController.selected.className && this.controller.isValid() ) {
            node=new VG.Nodes[this.availableNodesController.selected.className]();
            this.addNode( node );
   		}
   	}.bind( this );

    this.parseAvailableNodes();

    // --- Available Terminals

    this.availableTerminals=VG.UI.ListWidget();
    this.availableTerminalsController=this.availableTerminals.bind( this.dc, "terminals" );

    var itemRect=VG.Core.Rect();
    this.availableTerminals.paintItemCallback=function( canvas, item, paintRect, selected ) {
        itemRect.copy( paintRect );

        itemRect.x+=4;
        itemRect.y+=3;
        itemRect.width=18;
        itemRect.height=18;

        canvas.draw2DShape( VG.Canvas.Shape2D.Circle, itemRect, this.graphView.getTerminalColor( item ) );

        itemRect.copy( paintRect );

        itemRect.x+=30;
        itemRect.width-=30;

        canvas.drawTextRect( item.text, itemRect, VG.UI.stylePool.current.skin.ListWidget.TextColor, 0, 1 );
    }.bind( this );

    this.availableTerminalsLayout=VG.UI.Layout( this.availableTerminals );
    this.availableTerminalsLayout.title="Terminals";
    this.availableTerminalsLayout.margin.clear();

    this.availableLayout=VG.UI.SplitLayout( this.previewWidget, 50, this.availableNodesLayout, 30, this.availableTerminalsLayout, 20 );
    this.availableLayout.margin.clear();
    this.availableLayout.vertical=true;

    var skin=VG.UI.stylePool.current.skin;

    let terminal={ text : "value (float - vec4)", type : VG.Nodes.Terminal.Type.Universal };
    this.availableTerminalsController.add( terminal );
    terminal={ text : "float", type : VG.Nodes.Terminal.Type.Float };
    this.availableTerminalsController.add( terminal );
    terminal={ text : "vec2", type : VG.Nodes.Terminal.Type.Vector2 };
    this.availableTerminalsController.add( terminal );
    terminal={ text : "vec3", type : VG.Nodes.Terminal.Type.Vector3 };
    this.availableTerminalsController.add( terminal );
    terminal={ text : "vec4", type : VG.Nodes.Terminal.Type.Vector4 };
    this.availableTerminalsController.add( terminal );
    terminal={ text : "material", type : VG.Nodes.Terminal.Type.Material };
    this.availableTerminalsController.add( terminal );
    terminal={ text : "function", type : VG.Nodes.Terminal.Type.Function };
    this.availableTerminalsController.add( terminal );

    // --- GraphParams

    this.graphEditButton=VG.UI.ToolButton("Edit Script...");
    this.graphEditButton.clicked=function() {

        var graphData=this.controller.collection.dataForPath( this.controller.path );

        if ( !graphData.graphParamsFunc )
        {
            graphData.graphParamsFunc="";
            graphData.graphParamsData={};
        }

        var dialog=new VG.Nodes.GraphParamsDialog( this, graphData );
        VG.context.workspace.showWindow( dialog );
    }.bind( this );

    this.graphEditWidget=VG.UI.Widget();

    //this.graphParamsLayout=VG.UI.Layout( this.graphEditWidget );
    //this.graphParamsLayout.vertical=true;

    this.emptyWidget=VG.UI.Widget();
    this.graphEditWidget.stackedLayout=VG.UI.StackedLayout( this.emptyWidget );

    this.graphEditWidget.layout=VG.UI.Layout( this.graphEditWidget.stackedLayout, VG.UI.LayoutVSpacer(), VG.UI.Layout( this.graphEditButton ) );
    this.graphEditWidget.layout.margin.clear();
    this.graphEditWidget.layout.vertical=true;

    this.graphEditWidget.paintWidget=function( canvas ) {
        this.layout.rect.copy( this.rect );
        this.layout.layout( canvas );
    }.bind( this.graphEditWidget );

    // ---

    // this.colorWidget=VG.Nodes.FragColorWidget( this.graph );

    // --- Material Layout
/*
    if ( mapPreview )
    {
        this.mapWidget=VG.UI.CodeEdit( "" );
        this.mapWidget.readOnly=true;

        this.middleLayout=VG.UI.SplitLayout( this.mapWidget, 40, this.graphView, 60 );
        this.middleLayout.margin.clear();
        this.middleLayout.vertical=true;
    } else
    if ( materialPreview ) {

        this.materialWidget=VG.Nodes.MaterialWidget( this.graph );

        var materialTypeDD=VG.UI.DropDownMenu( "Flat", "Plane", "Sphere" );
        materialTypeDD.changed=function( val ) {
            this.materialWidget.setType( val );
        }.bind( this );

        var animateLightCB=VG.UI.CheckBox();
        animateLightCB.changed=function( value ) {
            this.materialWidget.setAnimation( value );
        }.bind( this );

        var closeButton=VG.UI.ToolBarButton( "Close Editor" );
        closeButton.clicked=function() {
            closeCallback();
        }.bind( this );

        var materialTB = materialTB=VG.UI.ToolBar( materialTypeDD, VG.UI.Label( "  Animate Light" ), animateLightCB );
        if ( closeCallback ) {
            materialTB.addItem( VG.UI.LayoutHSpacer() );
            materialTB.addItem( closeButton );
        }
        //materialTB.layout.margin.top=materialTB.layout.margin.bottom=0;

        var materialLayout=VG.UI.Layout( materialTB, this.materialWidget );
        materialLayout.margin.clear();
        materialLayout.vertical=true;

        // --- Material Layout

        this.middleLayout=VG.UI.SplitLayout( materialLayout, 50, this.graphView, 50 );
        this.middleLayout.margin.clear();
        this.middleLayout.vertical=true;
    }
*/
    if ( !readOnly ) {
        // this.layout=VG.UI.Layout( this.graphView );

        this.layout=VG.UI.SplitLayout( this.availableLayout, 20, this.graphView, 80 );
        this.layout.margin.clear();
    } else {
        this.layout=VG.UI.Layout( this.middleLayout );
        this.layout.margin.clear();
    }

    this.frameType=VG.UI.Frame.Type.None;

    // --- Called when the Graph needs to be updated.
    this.graph.updateCallback=function() {

        // this.colorWidget.changed=true;

        // if ( this.materialWidget )
            // this.materialWidget.changed=true;

        if ( this.buildGraph )
            this.buildGraph();

        if ( this.graphUpdateCallback ) this.graphUpdateCallback();

    }.bind( this );

    this.minimumSize.width = 280;
};

VG.Nodes.GraphEdit.prototype=VG.UI.Widget();

VG.Nodes.GraphEdit.prototype.bind=function( collection, path )
{
    this.controller=collection.controllerForPath( path );
    if ( !this.controller ) {
        this.controller=VG.Controller.Node( collection, path, this.graph );

    	this.controller.addObserver( "selectionChanged", function() {

    		var data=this.controller.selected;
    		var node=null;

    		if ( data && data.node ) node=data.node;

    		if ( this.containerEdit ) {
    			this.containerLayout.removeChild( this.containerEdit );
    			this.containerEdit=null;

                this.nodeNameEdit.disabled=true;
                this.nodeNameEdit.text="";
    		}

    		if ( node && node.container )
    		{
    			this.containerEdit=VG.Nodes.ParamContainerEdit( node.container );
    			this.containerLayout.addChild( this.containerEdit );
    		}

            if ( node ) {
                this.nodeNameEdit.disabled=false;
                this.nodeNameEdit.text=data.name;
            }

    	}.bind( this ), this );

	    this.controller.addObserver( "parentSelectionChanged", function() {
	    	// --- Resync nodes of Graph
	    	this.controller.syncGraph();

            // this.colorWidget.changed=true;

            if ( this.buildGraph )
                this.buildGraph();

	    }.bind( this ) );
/*
        this.controller.addObserver( "changed", function() {
            this.colorWidget.changed=true;
            this.materialWidget.changed=true;
        }.bind( this ) );*/

      	this.graphView.setController( this.controller );
        collection.addControllerForPath( this.controller, path );
    }

    return this.controller;
};

VG.Nodes.GraphEdit.prototype.parseAvailableNodes=function( node, noUndo )
{
    var categories=[];
    this.availableNodesFilterDD.clear();
    this.availableNodesFilterDD.addItem( "All" );

    this.dc.nodes=[];
    var folderIndex=[];

    // --- Insert all Nodes
    for (var key of VG.Nodes.availableNodes.keys() ) {
        var stringArray=String( key ).split( "." );
        var item={ text : stringArray[1], className : VG.Nodes.availableNodes.get( key ), category : stringArray[0] };
        this.availableNodesController.add( item, true );

        if ( !categories.includes( stringArray[0]) ) {
            this.availableNodesFilterDD.addItem( stringArray[0] );
            categories.push( stringArray[0] );
        }
    }

    function sort(a, b) {
        var nameA = a.text.toUpperCase(); // ignore upper and lowercase
        var nameB = b.text.toUpperCase(); // ignore upper and lowercase
        if (nameA < nameB) {
            return -1;
        }
        if (nameA > nameB) {
            return 1;
        }
        return 0;
    }

    this.dc.nodes.sort( sort );
};

/**
 * Adds the given node to this graph.
 * @param {VG.Nodes.Node} node - The node to add.
 */

VG.Nodes.GraphEdit.prototype.addNode=function( node, noUndo, pos )
{
    this.graph.addNode( node );

    if ( pos ) {
        node.data.xPos=pos.x-this.graphView.rect.x;
        node.data.yPos=pos.y-this.graphView.rect.y;
    }
	if ( this.controller ) this.controller.add( node.data, noUndo );
};

VG.Nodes.GraphEdit.prototype.reload=function( canvas )
{
    this.controller.modelChanged( true );
};

VG.Nodes.GraphEdit.prototype.revalidate=function()
{
    var graphData=this.controller.collection.dataForPath( this.controller.path );
    this.applyGraphParams( graphData, graphData.graphParamsFunc );
};

VG.Nodes.GraphEdit.prototype.applyGraphParams=function( graphData, funcText )
{
    graphData.graphParamsFunc=funcText;

    this.graphSettingsLayout=undefined;
    createParams=undefined;

    try {
        if ( funcText ) {
            eval( funcText );
            if ( createParams ) {
                this.graphSettingsLayout=createParams( this.graph, graphData.graphParamsData );
            }
        }
    } catch ( e ) {
        VG.log( e.message );
    }

    if ( this.graphSettingsLayout )
    {
        this.graphEditWidget.stackedLayout.current=this.graphSettingsLayout;
    } else this.graphEditWidget.stackedLayout.current=this.emptyWidget;
};

VG.Nodes.GraphEdit.prototype.paintWidget=function( canvas )
{
    this.contentRect.copy( this.rect );

	this.layout.rect.copy( this.contentRect );
	this.layout.layout( canvas );
};

// ----------------------------------------------------------------- VG.Nodes.GraphView

VG.Nodes.GraphView=function( graph )
{
    if ( !(this instanceof VG.Nodes.GraphView ) ) return new VG.Nodes.GraphView( graph );

    VG.UI.Widget.call( this );

    this.supportsFocus=true;
    this.supportsAutoFocus=true;

	this.workRect1=VG.Core.Rect();
	this.workRect2=VG.Core.Rect();

    this.graph=graph;

    this.mousePos=VG.Core.Point();
    this.dragOffset=VG.Core.Point();
    this.dragging=false;
    this.dragNode=null;

    this.connSourceTerminal=null;
    this.connDestTerminal=null;

	this.scale=1.0;
	this.graphOutput=null;

    // --- Called when a node property will change, initiate undo
    this.graph.nodePropertyWillChangeCallback=function( param, data ) {
    	if ( 1 )
    	{
            if ( param.data.className === "NodeMaterial" && param.name === "category" ) {
                // --- Material Node Category, set it to the graph

                let item = this.getGraphObject();

                item.category = data.newValue;
                item.previewStripNeedsUpdate = true;
            }

	    	if ( this.controller.collection && this.controller.collection.__vgUndo )
    	    	this.controller.collection.__vgUndo.controllerProcessedItem( this.controller, VG.Data.UndoItem.ControllerAction.NodeProperty, param.name,
    	    		this.controller.indexOf( param.data ), JSON.stringify( data ) );

            if ( this.nodePropertyChangedCallback )
                this.nodePropertyChangedCallback( param, data );
    	}
    }.bind( this );

    this.style={
    	"BorderColor" : VG.Core.Color( "#45505A" ),
    	"SelectedBorderColor" : VG.Core.Color( "#4859b1" ),
    	"TitleGradient1" : VG.Core.Color( "#3f4b57" ),
    	"TitleGradient2" : VG.Core.Color( "#505c68" ),
    	"SelectedTitleGradient1" : VG.Core.Color( "#5c6bc6" ),
    	"SelectedTitleGradient2" : VG.Core.Color( "#6d7cd7" ),
    	"TitleFont" : VG.Font.Font( "Roboto Regular", 12 ),
    	"TitleTextColor" : VG.Core.Color( "#ffffff" ),
    	"SeparatorColor" : VG.Core.Color( "#273747" ),
    	"BodyColor" : VG.Core.Color( "#4a545e" ),
    	"TerminalColor0" : VG.Core.Color( "#ffffff" ),
    	"TerminalColor1" : VG.Core.Color( "#da649d" ),
    	"TerminalColor2" : VG.Core.Color( "#ee804a" ),
    	"TerminalColor3" : VG.Core.Color( "#6775d0" ),
    	"TerminalColor4" : VG.Core.Color( "#f1c200" ),
		"TerminalColor5" : VG.Core.Color( "#f175d0" ),

    	"TerminalConnectedColor" : VG.Core.Color( "#000000" ),
    };
};

VG.Nodes.GraphView.prototype=VG.UI.Widget();

VG.Nodes.GraphView.prototype.checkDragSourceItemId=function( pos, id, item )
{
    if ( id === "Node" ) return true;
};

VG.Nodes.GraphView.prototype.acceptDragSourceItem=function( pos, id, item )
{
    if ( this.addNodeAt ) this.addNodeAt( pos, item.className );
};

VG.Nodes.GraphView.prototype.setController=function( controller )
{
	this.controller=controller;
	this.controller.addObserver( "changed", function() { if ( this.graph.updateCallback ) { this.graph.updateCallback(); VG.update(); } }, this );
};

/**
 * Returns the data object for current graph.
 * @returns {object}
 */

VG.Nodes.GraphView.prototype.getGraphObject=function( controller )
{
    let graph = this.controller.collection.controllerForPath( this.controller.path.replace( ".graph", "" ) );
    if ( graph ) graph = graph.object._selected;
    return graph;
};

/**
 * Returns the canvas offset value for the current graph.
 * @returns {object}
 */

VG.Nodes.GraphView.prototype.getGraphCanvasOffset=function( controller )
{
    let graphObject = this.getGraphObject();
    if ( graphObject ) {
        if ( !graphObject.offset ) graphObject.offset = { x: 0, y : 0 };
        return graphObject.offset;
    }

    return { x: 0, y : 0 };
};

VG.Nodes.GraphView.prototype.drawNode=function( canvas, node )
{
    let skin = VG.UI.stylePool.current.skin;

	let nodeHeight = this.getNodeHeight( node );

	let selected = this.controller.selection.indexOf( node.data ) != -1;
    let workRect1 = this.workRect1, workRect2 = this.workRect2;

	if ( !node.rect ) node.rect=VG.Core.Rect();
	if ( !node.data.xPos ) { node.data.xPos=10; node.data.yPos=10; }

	workRect1.set( this.rect.x + node.data.xPos, this.rect.y + node.data.yPos, 158 * this.scale, nodeHeight.total * this.scale );
	node.rect.set( workRect1 );

    // --- Comment

    if ( node.data.comment ) {
	    skin.Nodes.Font.setSize( 18 * this.scale );
	    canvas.pushFont( skin.Nodes.Font );
        canvas.drawTextRect( "// " + node.data.comment, VG.Core.Rect( this.rect.x + node.data.xPos, this.rect.y + node.data.yPos - 22, 300, 20 * this.scale  ),
            skin.Nodes.TitleTextColor, 0, 1 );
        canvas.popFont();
    }

    // --- Outline

    if ( selected ) canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangle2px, workRect1.shrink(-1.5, -1.5), skin.Nodes.BorderColor );

    canvas.draw2DShape( VG.Canvas.Shape2D.RoundedRectangle2px, workRect1, skin.Nodes.TopColor );

    // --- Title

	workRect2.set( workRect1.x + 2, workRect1.y + 1, workRect1.width - 4, 1 + 23 * this.scale );

	workRect2.x+=8 * this.scale; this.workRect2.width-=(8 + 8) * this.scale;

	skin.Nodes.Font.setSize( 12 * this.scale );
	canvas.pushFont( skin.Nodes.Font );
    canvas.drawTextRect( node.data.name, workRect2, skin.Nodes.TitleTextColor, 0, 1 );

    this.workRect2.set( workRect1.x, workRect1.y + 24 * this.scale, workRect1.width, 1 * this.scale );
	canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, workRect2, skin.Nodes.SeparatorColor );

    // --- Preview

	workRect1.set( this.rect.x + node.data.xPos, this.rect.y + node.data.yPos, 158 * this.scale, nodeHeight.total * this.scale );
    if ( !node.noPreview ) {
	    if ( !node.previewRect ) node.previewRect=VG.Core.Rect();

        node.previewRect.set( workRect1.x, workRect1.y + nodeHeight.total - 25 - 116 * this.scale, workRect1.width, 116 * this.scale );

        if ( node.image ) canvas.ctx.drawImage( node.image, node.previewRect.x, node.previewRect.y );
        else canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, node.previewRect, VG.Core.Color.Black );
    }

    // --- Body

	workRect1.y+=25 * this.scale; workRect1.height = nodeHeight.body * this.scale;
	canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, workRect1, skin.Nodes.BodyColor );

    // workRect2.x -= 3 * this.scale;
    // workRect2.x+=4 * this.scale;

    workRect2.x+=8 * this.scale;
    workRect2.y+=9 * this.scale; workRect2.width=12 * this.scale; workRect2.height=12 * this.scale;
	workRect1.set( workRect2 );

	workRect2.x+=15 * this.scale;
	workRect2.width=(158 - 2 - 2 * 15) * this.scale;

	let y=workRect1.y;
    let drawTerminalTexts = true;//node.noPreview;

	skin.Nodes.Font.setSize( 11 * this.scale );

    let i, t, color;
	for ( i=0; i < node.outputs.length; ++i )
	{
		t=node.outputs[i];
		color=this.getTerminalColor( t );

        if ( !node.noPreview ) {
            canvas.setAlpha( 0.8 );
		    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, VG.Core.Rect( this.rect.x + node.data.xPos, workRect1.y -2, 158, workRect2.height + 4 ), skin.Nodes.BodyColor );
            canvas.setAlpha( 1.0 );
        }

        // if ( !node.noPreview ) {
            // canvas.setAlpha( 0.5 );
		    // canvas.draw2DShape( VG.Canvas.Shape2D.Circle, workRect1.shrink( -2, -2 ), skin.Nodes.BodyColor );
            // canvas.setAlpha( 1.0 );
        // }
		// canvas.draw2DShape( VG.Canvas.Shape2D.Circle, workRect1.shrink( -1.5, -1.5 ), skin.Nodes.BodyColor );
		canvas.draw2DShape( VG.Canvas.Shape2D.Circle, workRect1, color );

		if ( !t.rect ) t.rect=VG.Core.Rect();
		t.rect.set( workRect1 );

        if ( drawTerminalTexts ) {
		    this.workRect2.y=workRect1.y;
    	    canvas.drawTextRect( t.name, workRect2, skin.Nodes.TerminalTextColor, 0, 1 );
        }

		workRect1.y+=(12 + 9) * this.scale;
	}

	workRect1.y=workRect2.y=y;
	workRect1.x=this.rect.x + node.data.xPos + (158 - 1 - 8 - 10) * this.scale;
	// workRect1.x=this.rect.x + node.data.xPos + (158 - 1 - 6) * this.scale;
	// workRect1.x=this.rect.x + node.data.xPos + (158 - 1 - 8) * this.scale;

	workRect2.x=workRect1.x - (5 * this.scale) - workRect2.width;

	for ( i=0; i < node.inputs.length; ++i )
	{
		t=node.inputs[i];

        if ( t.type === VG.Nodes.Terminal.Type.Universal && t.isConnected() )
            color=this.getTerminalColor( t.first() );
        else color=this.getTerminalColor( t );

        // if ( !node.noPreview ) {
            // canvas.setAlpha( 0.5 );
		    // canvas.draw2DShape( VG.Canvas.Shape2D.Circle, workRect1.shrink( -2, -2 ), skin.Nodes.BodyColor );
            // canvas.setAlpha( 1.0 );
        // }
        canvas.draw2DShape( VG.Canvas.Shape2D.Circle, workRect1, color );

		if ( !t.rect ) t.rect=VG.Core.Rect();
		t.rect.set( workRect1 );

        if ( drawTerminalTexts ) {
		    this.workRect2.y=this.workRect1.y;
    	    canvas.drawTextRect( t.name, workRect2, skin.Nodes.TerminalTextColor, 2, 1 );
        }

		workRect1.y+=(12 + 9) * this.scale;
	}

    // --- Bottom Custom Text

    workRect2.set( workRect1.x + 2, workRect1.y + nodeHeight.total - 25 * this.scale, 150, 23 * this.scale );

    if ( node.customTitle ) {
	    workRect2.set( this.rect.x + node.data.xPos + 8, this.rect.y + node.data.yPos + nodeHeight.total - 25, 150 * this.scale, 23 * this.scale );
        canvas.drawTextRect( node.customTitle, workRect2, skin.Nodes.TitleTextColor, 0, 1 );
    }

    canvas.popFont();
};

VG.Nodes.GraphView.prototype.getNodeHeight=function( node )
{
    let rc = {};

    rc.body = node.noPreview ? this.getNodeBodyHeight( node ) : 0;
	rc.total = 25 + rc.body + 25;
    if ( !node.noPreview ) rc.total+=116;

	return rc;
};

VG.Nodes.GraphView.prototype.getNodeBodyHeight=function( node )
{
	var inputHeight=9 + node.inputs.length * 12 + 7; if ( node.inputs.length ) inputHeight+=(node.inputs.length-1) * 9;
	var outputHeight=9 + node.outputs.length * 12 + 7; if ( node.outputs.length > 0 ) outputHeight+=(node.outputs.length-1) * 9;

	return Math.max( inputHeight, outputHeight );
};

VG.Nodes.GraphView.prototype.getTerminalColor=function( t )
{
    var skin=VG.UI.stylePool.current.skin;

	if ( t.type === VG.Nodes.Terminal.Type.Universal ) return VG.Core.Color.White;
	else
	if ( t.type === VG.Nodes.Terminal.Type.Float ) return skin.Nodes.FloatTerminalColor;
    else
	if ( t.type === VG.Nodes.Terminal.Type.Vector3 ) return skin.Nodes.Vector3TerminalColor;
    else
	if ( t.type === VG.Nodes.Terminal.Type.Vector2 ) return skin.Nodes.Vector2TerminalColor;
    else	// else
	//if ( t.type === VG.Nodes.Terminal.Type.String ) return this.style.TerminalColor2;
	// else
	// if ( t.type === VG.Nodes.Terminal.Type.Vector2 || t.type === VG.Nodes.Terminal.Type.Vector3 || t.type === VG.Nodes.Terminal.Type.Vector4 )
		// return skin.Nodes.VectorTerminalColor;
	// else
	if ( t.type === VG.Nodes.Terminal.Type.Material ) return skin.Nodes.MaterialTerminalColor;
	else
	if ( t.type === VG.Nodes.Terminal.Type.Texture ) return skin.Nodes.TextureTerminalColor;
	else
	if ( t.type === VG.Nodes.Terminal.Type.Function ) return skin.Nodes.TextureTerminalColor;

	return VG.Core.Color();
};

VG.Nodes.GraphView.prototype.mouseDown=function( event )
{
    if ( !this.graph ) return;

    var foundNode=false;
    this.connSourceTerminal=null;
    var i, t;

    for (var node of this.graph.nodes.values() )
    {
    	if ( node.rect && node.rect.contains( this.mousePos ) )
    	{
			foundNode=true;

    		this.dragOffset.set( this.mousePos.x - node.rect.x, this.mousePos.y - node.rect.y );

    		if ( this.dragOffset.y < 25 * this.scale ) {
    			this.dragging=true;
    			this.dragNode=node;

    			VG.update();
    		}

			for ( i=0; i < node.inputs.length; ++i )
			{
				t=node.inputs[i];

				if ( t.rect.contains( this.mousePos ) ) {
					this.connSourceTerminal=t;
				}
			}

			for ( i=0; i < node.outputs.length; ++i )
			{
				t=node.outputs[i];

				if ( t.rect.contains( this.mousePos ) ) {
					this.connSourceTerminal=t;
				}
			}

    		if ( node !== this.controller.selected )
    		{
    			this.controller.selected=node.data;
    		}

    		if ( this.controller.selection.indexOf( node.data ) === -1 )
    		{
    			this.controller.addToSelection( node.data );
    			VG.update();
    		}

    		break;
    	}
    }

    // --- If the clicked source terminal is an connected input, break the connection

    if ( this.connSourceTerminal && this.connSourceTerminal.input === true && this.connSourceTerminal.isConnected() )
    {
    	t=this.connSourceTerminal.connectedTo[0];

    	this.connSourceTerminal.disconnectFrom( t );

	    if ( this.controller.collection && this.controller.collection.__vgUndo )
	    {
	    	// --- Add the NodeDisconnect Undo

	    	var obj={ terminalName: this.connSourceTerminal.name, nodeId: this.connSourceTerminal.node.data.id,
	    		connTerminalName: t.name, connNodeId : t.node.data.id };

    	    this.controller.collection.__vgUndo.controllerProcessedItem( this.controller, VG.Data.UndoItem.ControllerAction.NodeDisconnect,
    	    	this.connSourceTerminal.node.data.id, this.controller.indexOf( this.connSourceTerminal.node.data ), JSON.stringify( obj ) );
    	}

    	this.connSourceTerminal=t;
    	this.connDestTerminal=null;

        if ( this.graph.updateCallback )
		  this.graph.updateCallback();
    }

    if ( !foundNode )
    {
    	this.controller.selected=null;
        this.canvasMoveStart = VG.Core.Point( event.pos );
        this.canvaOffsetStart = VG.Core.Point();

        let graphObject = this.getGraphObject();
        if ( graphObject )
        {
            if ( !graphObject.offset ) graphObject.offset = { x: 0, y : 0 };
            this.canvaOffsetStart.set( graphObject.offset.x, graphObject.offset.y );
        }
    }

    this.mouseIsDown=true;
};

VG.Nodes.GraphView.prototype.mouseUp=function( event )
{
    this.mouseIsDown=false;
    this.dragging=false;
    this.dragNode=null;

    if ( this.connSourceTerminal && this.connDestTerminal )
    {
    	// --- Connect the two terminals.
    	this.connSourceTerminal.connectTo( this.connDestTerminal );

	    if ( this.controller.collection && this.controller.collection.__vgUndo )
	    {
	    	// --- Add the NodeConnect Undo

	    	var obj={ terminalName: this.connSourceTerminal.name, nodeId: this.connSourceTerminal.node.data.id,
	    		connTerminalName: this.connDestTerminal.name, connNodeId : this.connDestTerminal.node.data.id };

    	    this.controller.collection.__vgUndo.controllerProcessedItem( this.controller, VG.Data.UndoItem.ControllerAction.NodeConnect,
    	    	this.connSourceTerminal.node.data.id, this.controller.indexOf( this.connSourceTerminal.node.data ), JSON.stringify( obj ) );
    	}

        if ( this.graph.updateCallback )
		  this.graph.updateCallback();
    }

   	this.connSourceTerminal=null;
   	this.connDestTerminal=null;
};

VG.Nodes.GraphView.prototype.mouseMove=function( event )
{
	this.mousePos.set( event.pos );

	if ( this.dragNode && this.dragging ) {
		this.dragNode.data.xPos=this.mousePos.x - this.dragOffset.x - this.rect.x;
		this.dragNode.data.yPos=this.mousePos.y - this.dragOffset.y - this.rect.y;

		VG.update();
	}

    var i, t;
	if ( this.connSourceTerminal )
	{
		this.connDestTerminal=null;
		// --- Check if there is a fitting dest terminal under the mouse pointer

	    for (var node of this.graph.nodes.values() )
    	{
    		if ( node !== this.connSourceTerminal.node && node.rect && node.rect.contains( this.mousePos ) )
    		{
				for ( i=0; i < node.inputs.length; ++i )
				{
					t=node.inputs[i];

					if ( t.rect.contains( this.mousePos ) && this.connSourceTerminal.canConnect( t ) ) {
						this.connDestTerminal=t;
					}
				}

				for ( i=0; i < node.outputs.length; ++i )
				{
					t=node.outputs[i];

					if ( t.rect.contains( this.mousePos ) && this.connSourceTerminal.canConnect( t ) ) {
						this.connDestTerminal=t;
					}
				}

    			break;
    		}
    	}

		VG.update();
	}

    if ( !this.controller.selected && this.mouseIsDown )
    {
        let graphObject = this.getGraphObject();
        if ( graphObject ) {
            if ( !graphObject.offset ) graphObject.offset = { x: 0, y : 0 };

            graphObject.offset.x = this.canvaOffsetStart.x + event.pos.x - this.canvasMoveStart.x;
            graphObject.offset.y = this.canvaOffsetStart.y + event.pos.y - this.canvasMoveStart.y;

            VG.update();
        }
    }
};

VG.Nodes.GraphView.prototype.keyDown=function( keyCode, keysDown )
{
	if ( keyCode == VG.Events.KeyCodes.Backspace )
    {
    	if ( this.controller.selected )
    		this.controller.remove( this.controller.selected );
    }
 };

VG.Nodes.GraphView.prototype.update=function()
{
    /*
    if ( this.previewNode.inputs[0].isConnected() )
    {
        var vector=undefined;

        if ( this.previewNode.inputs.length > 1 && this.previewNode.inputs[1].isConnected() )
            vector=this.previewNode.inputs[1].connectedTo[0].onCall();

        this.graphOutput=this.graph.run( this.previewNode.inputs[0].connectedTo[0], this.previewImage, vector );
        VG.update();
    }*/
};

VG.Nodes.GraphView.prototype.paintWidget=function( canvas )
{
    var rect=this.rect;
    var wrect=this.workRect1;

    var skin=VG.UI.stylePool.current.skin;

    canvas.pushClipRect( this.rect );

    // --- Grid

    canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, rect, skin.Nodes.BackColor );

    let offset = this.getGraphCanvasOffset();

    var i;
    wrect.width=1; wrect.height=rect.height;
    for ( i=rect.x + skin.Nodes.GridSize/2 + offset.x % skin.Nodes.GridSize; i < rect.right(); i+=skin.Nodes.GridSize ) {
        wrect.x=i; wrect.y=rect.y;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, wrect, skin.Nodes.BackLineColor );
    }

    wrect.height=1; wrect.width=rect.width;
    for ( i=rect.y + skin.Nodes.GridSize/2 + offset.y % skin.Nodes.GridSize; i < rect.bottom(); i+=skin.Nodes.GridSize ) {
        wrect.x=rect.x; wrect.y=i;
        canvas.draw2DShape( VG.Canvas.Shape2D.Rectangle, wrect, skin.Nodes.BackLineColor );
    }

    // --- Check if Controller has Content

    if ( !this.controller.isValid() ) {
        canvas.popClipRect();
        return;
    }

    if ( offset ) {
        rect.x += offset.x;
        rect.y += offset.y;
    }

    // --- Nodes

    if ( this.graph )
    {
        let arr = Array.from( this.graph.nodes.values() ).reverse();
	    for (let node of arr ) {
    		this.drawNode( canvas, node );
    	}
    }

    // --- Connections

    var originX, originY;
    var destX, destY;

    if ( this.graph )
    {
    	for (var node1 of this.graph.nodes.values() )
    	{
    		for ( var o=0; o < node1.outputs.length; ++o )
    		{
    			var ot=node1.outputs[o];

    			originX=ot.rect.x + 5;
    			originY=ot.rect.y + 5;

    			for ( var c=0; c < ot.connectedTo.length; ++c )
    			{
	    			var it=ot.connectedTo[c];

    				destX=it.rect.x + 5;
    				destY=it.rect.y + 5;

    				canvas.drawCurve( originX, originY, originX - 80, originY, destX + 80, destY, destX, destY, 2.5, 60, this.getTerminalColor( ot ) );
/*
    				var conSize=4; var conOffset=(12-conSize)/2;

    				this.workRect1.set( ot.rect );
    				this.workRect1.x+=conOffset; this.workRect1.y+=conOffset; this.workRect1.width=conSize; this.workRect1.height=conSize;
    				canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.workRect1, this.style.TerminalConnectedColor );

    				this.workRect1.set( it.rect );
    				this.workRect1.x+=conOffset; this.workRect1.y+=conOffset; this.workRect1.width=conSize; this.workRect1.height=conSize;
    				canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.workRect1, this.style.TerminalConnectedColor );*/
    			}
    		}
    	}
    }

    // --- Connection preview

    if ( this.connSourceTerminal )
    {
        originX=this.connSourceTerminal.rect.x + 5;
        originY=this.connSourceTerminal.rect.y + 5;

        var color;

        if ( !this.connDestTerminal )
        {
            color=this.getTerminalColor( this.connSourceTerminal );

            destX=this.mousePos.x;
            destY=this.mousePos.y;
        } else
        {
            // --- Adjust Universal terminal color to switch to color of the potential new connection

            if ( this.connSourceTerminal.type !== VG.Nodes.Terminal.Type.Universal ) color=this.getTerminalColor( this.connSourceTerminal );
            else
            {
                color=this.getTerminalColor( this.connDestTerminal );
                canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.connSourceTerminal.rect, color );
            }

            if ( this.connDestTerminal.type === VG.Nodes.Terminal.Type.Universal )
                canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.connDestTerminal.rect, this.getTerminalColor( this.connSourceTerminal ) );


            destX=this.connDestTerminal.rect.x + 5;
            destY=this.connDestTerminal.rect.y + 5;
        }

        if ( this.connSourceTerminal.output )
            canvas.drawCurve( originX, originY, originX - 80, originY, destX + 80, destY, destX, destY, 2.5, 60, color );
        else canvas.drawCurve( destX, destY, destX - 80, destY, originX + 80, originY, originX, originY, 2.5, 60, color );

        if ( this.connDestTerminal )
        {
            /*
            var conSize=4; var conOffset=(12-conSize)/2;

            this.workRect1.set( this.connSourceTerminal.rect );
            this.workRect1.x+=conOffset; this.workRect1.y+=conOffset; this.workRect1.width=conSize; this.workRect1.height=conSize;
            canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.workRect1, this.style.TerminalConnectedColor );

            this.workRect1.set( this.connDestTerminal.rect );
            this.workRect1.x+=conOffset; this.workRect1.y+=conOffset; this.workRect1.width=conSize; this.workRect1.height=conSize;
            canvas.draw2DShape( VG.Canvas.Shape2D.Circle, this.workRect1, this.style.TerminalConnectedColor );*/
        }
    }

	canvas.popClipRect();
};

// --------------------- Clipboard

VG.Nodes.GraphView.prototype.clipboardCopyIsAvailable=function()
{
    if ( this.controller.selected ) return "Nodes";
    else return null;
};

VG.Nodes.GraphView.prototype.clipboardPasteIsAvailableForType=function( type )
{
    if ( type === "Nodes" ) return true;
    return false;
};

VG.Nodes.GraphView.prototype.clipboardCut=function()
{
    VG.copyToClipboard( "Nodes", JSON.stringify( this.controller.selected ) );
    if ( this.controller.selected ) this.controller.remove( this.controller.selected );
};

VG.Nodes.GraphView.prototype.clipboardCopy=function()
{
    VG.copyToClipboard( "Nodes", JSON.stringify( this.controller.selected ) );
};

VG.Nodes.GraphView.prototype.clipboardPaste=function()
{
	var data=JSON.parse( VG.clipboardPasteDataForType( "Nodes" ) );
	data.id=this.graph.idCounter++;
	data.connections={};

	this.controller.add( data );
};

VG.Nodes.GraphView.prototype.clipboardDeleteSelection=function()
{
    if ( this.controller.selected ) this.controller.remove( this.controller.selected );
};

// --------------------- Clipboard End

// -------------------------------------------------------------------- VG.Nodes.FragColorWidget

VG.Nodes.FragColorWidget=function( graph )
{
    if ( !(this instanceof VG.Nodes.FragColorWidget ) ) return new VG.Nodes.FragColorWidget( graph );

    VG.UI.Widget.call( this );
    this.graph=graph;

    this.changed=true;
    this.shaderIsValid=false;

    this._mainRT = VG.Renderer().mainRT;

    // --- Shader

    this.shader=new VG.Shader();
    this.shader.depthWrite = true;
    this.shader.depthTest = true;

    this.shader.vSource=[
        "#version 100",
        "precision mediump float;",
        "attribute vec4 aPosition;",
        "attribute vec2 aTexCoord;",

        "varying vec2 vTexCoord;",

        "void main() {",
        "   vTexCoord = vec2(aTexCoord.x, 1.0-aTexCoord.y);",
        "   gl_Position = aPosition;",
        "}", ""
    ].join('\n');

    // --- GPU Frame Buffer

    this.bufferSize=18;

    this.buffer=new VG.GPUBuffer( VG.Type.Float, this.bufferSize, true );
    this.bufferDB = this.buffer.getDataBuffer();
    this.buffer.create();
};

VG.Nodes.FragColorWidget.prototype=VG.UI.Widget();

VG.Nodes.FragColorWidget.prototype.createFrame = function(x, y, w, h, b)
{
    var vw = w;
    var vh = h;

    var x1 = (x - vw / 2) / (vw / 2);
    var y1 = (vh / 2 - y) / (vh / 2);
    var x2 = ((x + w) - vw / 2) / (vw / 2);
    var y2 = (vh / 2 - (y + h)) / (vh / 2);

    var i = 0;
    var db=b.getDataBuffer();

    db.set(i++, x1); db.set(i++, y1); db.set(i++, 0.0); db.set(i++, 1.0);
    db.set(i++, x1); db.set(i++, y2); db.set(i++, 0.0); db.set(i++, 0.0);
    db.set(i++, x2); db.set(i++, y1); db.set(i++, 1.0); db.set(i++, 1.0);
    db.set(i++, x2); db.set(i++, y2); db.set(i++, 1.0); db.set(i++, 0.0);

    b.update();

    return b;
};

VG.Nodes.FragColorWidget.prototype.buildShader=function()
{
    this.shaderIsValid=false;

    var fSource=[
        "#version 100",
        "precision mediump float;\n",

        "varying vec2 vTexCoord;\n",
    ].join('\n');

    var rc=this.graph.compile();

    // VG.log( rc.success, rc.error, rc.globalCode, rc.mainCode );

    if ( rc.success )
    {
        VG.log( "success" );

        fSource+=rc.globalCode;

        fSource+="void main() {\n";
        fSource+=rc.mainCode;

        fSource+="  " + rc.resultNode.resultVar + " = valVec4;\n";
        fSource+="}\n";

        this.shader.fSource=fSource;

        VG.log( this.shader.fSource );

        try {
            this.shader.create();
        } catch( err )
        {
            return;
        }

        this.shaderIsValid=true;
    } else VG.log( rc.error );
};

VG.Nodes.FragColorWidget.prototype.paintWidget=function( canvas )
{
    if ( this.changed )
    {
        this.buildShader();
        this.changed=false;
    }

    if ( this.shaderIsValid )
    {
        var rect=this.rect;

        this.createFrame( 0, 0, rect.width, rect.height, this.buffer );

        var b = this.buffer;
        var shader = this.shader;

        shader.bind();
        b.bind();

        var stride = b.getStride();

        b.vertexAttrib(shader.getAttrib("aPosition"), 2, false, stride * 4, 0);
        b.vertexAttrib(shader.getAttrib("aTexCoord"), 2, false, stride * 4, stride * 2);

        this._mainRT.setViewport( rect );
        b.drawBuffer( VG.Renderer.Primitive.TriangleStrip, 0,  4 );
        this._mainRT.setViewport(VG.context.workspace.rect);
    }
};

// -------------------------------------------------------------------- ShapeUploadDialog

VG.Nodes.GraphParamsDialog=function( graphEditor, graphData )
{
    VG.UI.Dialog.call( this, "Graph Parameters Dialog" );

    var codeEdit=VG.UI.CodeEdit( graphData.graphParamsFunc );

    this.layout=VG.UI.Layout( codeEdit );

    this.addButton( "Close", function() { this.close( this ); }.bind( this ) );
    this.addButton( "Apply", function() {
        graphEditor.applyGraphParams( graphData, codeEdit.text );
        this.close( this );
    }.bind( this ) );
};

VG.Nodes.GraphParamsDialog.prototype=VG.UI.Dialog();

// -------------------------------------------------------------------- VG.Nodes.NodeEditorDialog

 VG.Nodes.NodeEditorDialog=function( title, nodeEditor, callback )
{
    if ( !(this instanceof  VG.Nodes.NodeEditorDialog) ) return new NodeEditorDialog(  nodeEditor, graphData, callback );

    VG.UI.Dialog.call( this, title );

    var screenRect=VG.context.workspace.getVisibleScreenRect();
    this.maximumSize.width=screenRect.width-50;
    this.maximumSize.height=screenRect.height-100;

    this.layout=VG.UI.Layout( nodeEditor );
    this.layout.margin.clear();

    this.addButton( "Close", function() {
        if ( callback ) callback();
        this.close( this );
    }.bind( this ) );

    this.addButton( "Accept", function() {
        if ( callback ) {
            nodeEditor.text=nameEdit.text;
            callback( true, name );
        }
        this.close( this );
    }.bind( this ) );

    this.buttonLayout.insertChildAt( 0, VG.UI.Label( "Graph Name:") );

    var nameEdit=VG.UI.TextLineEdit( nodeEditor.text );
    //this.nodeEditorNameEdit.font=VG.Font.Font( "Open Sans Semibold", 13 );
    nameEdit.maximumSize.width=200;
    nameEdit.toolTip="Name of the Graph.";

    this.buttonLayout.insertChildAt( 1, nameEdit );
};

 VG.Nodes.NodeEditorDialog.prototype=VG.UI.Dialog();

/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.MaterialEdit

VG.Nodes.MaterialEdit=function( { readOnly = false, mapPreview = false, materialPreview = true, closeCallback } = {} )
{
    if ( !(this instanceof VG.Nodes.MaterialEdit ) ) return new VG.Nodes.MaterialEdit( { readOnly, mapPreview, materialPreview, closeCallback } );

    this.graph = VG.Nodes.Graph();
    this.graphView = new VG.Nodes.MaterialView( this.graph );

    this.previewWidget = VG.UI.Widget();
    this.previewRect = VG.Core.Rect();
    this.previewIsValid = false;
    this.previewIsInit = false;

    VG.Nodes.GraphEdit.call( this );

    this._mainRT = VG.Renderer().mainRT;

    this.renderer = new VG.Nodes.MaterialRenderer();

    // --- Node Prevew

    this.prevShader=new VG.Shader();
    this.prevShader.depthWrite = true;
    this.prevShader.depthTest = true;

    this.prevBuffer=new VG.GPUBuffer( VG.Type.Float, 18, true );
    this.prevBufferDB = this.prevBuffer.getDataBuffer();
    this.prevBuffer.create();

    this.nodesToRender = [];

    // --- Setup Preview Widget

    this.rt = new VG.RenderTarget(); // Used for node preview
    let pW = this.previewWidget; this.pW = pW;

    pW.typeDD = VG.UI.DropDownMenu( "Shape: Plain", "Shape: Sphere", "Shape: Twisted", "Shape: Floor" );
    pW.typeDD.changed = function() {
        this.buildShader.bind( this );
        this.iter = 0;
        this.previewIsValid = false;
        this.previewIsRendered = false;
        VG.update();
    }.bind( this );
    pW.qualityDD = VG.UI.DropDownMenu( "Quality: Fast", "Quality: Good" );
    pW.qualityDD.changed = pW.typeDD.changed;
    pW.toolBar = VG.UI.ToolBar( pW.typeDD, pW.qualityDD );
    pW.childWidgets = [ pW.typeDD, pW.qualityDD ];
    pW.minimumSize.height = 100;
    pW.paintWidget = function( canvas ) {
        let skin=VG.UI.stylePool.current.skin;

        pW.toolBar.rect.copy( pW.rect );
        pW.toolBar.rect.height = skin.ToolBar.Height;

        pW.toolBar.paintWidget( canvas );

        if ( this.previewRect.width !== pW.rect.width || this.previewRect.height !== pW.rect.height - skin.ToolBar.Height ) {
            this.previewIsValid = false;
            this.previewIsRendered = false;
            this.iter = 0;
        }

        this.previewRect.copy( pW.rect );
        this.previewRect.y += skin.ToolBar.Height;
        this.previewRect.height -= skin.ToolBar.Height;

        if ( !this.previewIsValid )
            setTimeout( this.buildShader.bind( this ), 1 );
        else
        // if ( !this.previewIsRendered )
        {
            if ( this.renderer.iter < 50 ) {
                if ( this.renderer.getTiming() !== undefined ) this.runShader();
                VG.context.workspace.autoRedrawInterval = 60;
            } else VG.context.workspace.autoRedrawInterval = 2000;
        }

        if ( this.previewIsInit ) {
            canvas.pushClipRect( this.previewRect );
            canvas.drawImage( this.previewRect, this.resultRT );
            canvas.popClipRect();
            // canvas.drawTextRect( String( this.iter ), pW.rect, VG.Core.Color.Black, 0, 2 );
        }

        if ( this.nodesToRender.length )
            setTimeout( this.runNextNodePreview.bind( this ), 1 );

    }.bind( this );

    // --- Extensions

    if ( !VG.webgl2 )
        this.queryExt = VG.WebGL.gl.getExtension('EXT_disjoint_timer_query');
};

VG.Nodes.MaterialEdit.prototype=Object.create(VG.Nodes.GraphEdit.prototype);

VG.Nodes.MaterialEdit.prototype.createFrame = function(x, y, w, h, b)
{
    var vw = w;
    var vh = h;

    var x1 = (x - vw / 2) / (vw / 2);
    var y1 = (vh / 2 - y) / (vh / 2);
    var x2 = ((x + w) - vw / 2) / (vw / 2);
    var y2 = (vh / 2 - (y + h)) / (vh / 2);

    var i = 0;
    var db=b.getDataBuffer();

    db.set(i++, x1); db.set(i++, y1); db.set(i++, 0.0); db.set(i++, 1.0);
    db.set(i++, x1); db.set(i++, y2); db.set(i++, 0.0); db.set(i++, 0.0);
    db.set(i++, x2); db.set(i++, y1); db.set(i++, 1.0); db.set(i++, 1.0);
    db.set(i++, x2); db.set(i++, y2); db.set(i++, 1.0); db.set(i++, 0.0);

    b.update();

    return b;
};

VG.Nodes.MaterialEdit.prototype.buildGraph=function()
{
    this.nodesToRender = [];
    this.rc = this.graph.compileAsMaterial( { generatePreview : this.genNodePreview.bind( this ) } );

    this.renderer.iter = 0;
    this.previewIsValid = false;
    this.previewIsRendered = false;
};

VG.Nodes.MaterialEdit.prototype.buildShader=function()
{
    if ( !this.rc ) return;
    if ( !this.previewRect.width || !this.previewRect.height ) return;

    if ( !this.pW.qualityDD.index )
        this.renderer.build( { globalCode : this.rc.globalCode, code : this.rc.code, type : this.pW ? this.pW.typeDD.index : 0 } );
    else this.renderer.build_path( { globalCode : this.rc.globalCode, code : this.rc.code, type : this.pW ? this.pW.typeDD.index : 0 } );

    this.previewIsValid = true;
};

VG.Nodes.MaterialEdit.prototype.runShader=function()
{
    this.resultRT = this.renderer.render( this.previewRect );

    this.previewIsRendered = true;
    this.previewIsInit = true;
};

VG.Nodes.MaterialEdit.prototype.genNodePreview=function( node, code )
{
    // console.log( "genNodePreview", node, code );

    let exists = false;
    this.nodesToRender.forEach( function ( n ) {
        if ( n.token === node.token ) exists=true;
    } );
    if ( exists ) return;

    let frag = `
        #version 100
        precision highp float;

        varying vec2 vTexCoord;

        struct Material {
            int type;
            vec3 color;
            vec3 specularColor;
            float specularAmount;
            float metallic;
            float smoothness;
            float reflectance;
            float bump;
            vec3 emission;
            float ior;
        };
    `;

    frag += code;
    frag += `

        void main()
        {
            // vec3 pos = vec3( vTexCoord.x * ${this.nodePreviewRect.width.toFixed(1)}, vTexCoord.y * ${this.nodePreviewRect.height.toFixed(1)}, 0.0 );
            vec3 pos = vec3( vTexCoord.x, vTexCoord.y, 0.0 );
            Material material;
            vec3 normal = vec3(0);

            material_1( pos, material, normal );
            gl_FragColor = vec4( material.color, 1.0 );
        }
    `;

    this.nodesToRender.push( { node : node, code : frag } );
};

VG.Nodes.MaterialEdit.prototype.runNextNodePreview=function()
{
    if ( !this.nodesToRender.length ) return;
    if ( !this.previewIsRendered ) return;

    let item = this.nodesToRender.pop();
    this.runNodePreview( item.node, item.code );
};

VG.Nodes.MaterialEdit.prototype.runNodePreview=function( node, code )
{
    // console.log( "runNodePreview", node, code );

    if ( this.prevShader.fSource ) this.prevShader.destroy();

    this.prevShader.vSource = `
        #version 100
        precision highp float;
        attribute vec4 aPosition;
        attribute vec2 aTexCoord;

        varying vec2 vTexCoord;

        void main() {
            vTexCoord = vec2(aTexCoord.x, 1.0-aTexCoord.y);
            gl_Position = aPosition;
        }
    `;

    this.prevShader.fSource = code;

    // console.log( this.shader.fSource );

    try {
        this.prevShader.create();
    } catch( err )
    {
        // console.log( this.shader.fSource );
        return;
    }

    // --- Run it

    let b = this.prevBuffer;
    let shader = this.prevShader;

    let rt = this.rt;

    rt.resize( this.nodePreviewRect.width, this.nodePreviewRect.height );
    rt.bind();
    rt.setViewport( this.nodePreviewRect );
    rt.clear( undefined, true );

    this.createFrame( 0, 0, this.nodePreviewRect.width, this.nodePreviewRect.width, b );

    shader.bind();
    b.bind();

    // this.applyCameraToShader( this.shader );

    var stride = b.getStride();
    b.vertexAttrib(shader.getAttrib("aPosition"), 2, false, stride * 4, 0);
    b.vertexAttrib(shader.getAttrib("aTexCoord"), 2, false, stride * 4, stride * 2);

    b.drawBuffer( VG.Renderer.Primitive.TriangleStrip, 0,  4 );
    rt.unbind();

    this._mainRT.setViewport(VG.context.workspace.rect);

    node.image = VG.Utils.renderTargetToHTML5Image( rt );
    VG.update();
};

// ----------------------------------------------------------------- VG.Nodes.MaterialView

VG.Nodes.MaterialView=function( graph )
{
    if ( !(this instanceof VG.Nodes.MaterialView ) ) return new VG.Nodes.MaterialView( graph );

    VG.Nodes.GraphView.call( this, graph );
};

VG.Nodes.MaterialView.prototype=Object.create(VG.Nodes.GraphView.prototype);

// ----------------------------------------------------------------- VG.Nodes.MaterialRenderer

/**
 * The VG.Nodes.MaterialRenderer class.
 * @constructor
 */

VG.Nodes.MaterialRenderer=function()
{
    if ( !(this instanceof VG.Nodes.MaterialRenderer ) ) return new VG.Nodes.MaterialRenderer();

    // --- Shader Stuff

    this._mainRT = VG.Renderer().mainRT;

    this.shader=new VG.Shader();
    this.shader.depthWrite = true;
    this.shader.depthTest = true;

    this.buffer=new VG.GPUBuffer( VG.Type.Float, 18, true );
    this.bufferDB = this.buffer.getDataBuffer();
    this.buffer.create();

    this.camera = new VG.Render.Camera(80);
    this.camera.setLookAt(new VG.Math.Vector3(0, 0, 0), new VG.Math.Vector3(0, 1, 0), new VG.Math.Vector3(0, 0, 5), true);

    // --- Setup Preview Widget

    this.rt = new VG.RenderTarget();
    // this.rt.floatTexture = true;
    this.rt1 = new VG.RenderTarget();
    // this.rt1.floatTexture = true;

    this.iter = 0;

    // --- Extensions

    if ( !VG.webgl2 )
        this.queryExt = VG.WebGL.gl.getExtension('EXT_disjoint_timer_query');
};

VG.Nodes.MaterialRenderer.prototype.copyRenderTarget=function copyRenderTarget( source, dest )
{
    let raster=VG.context.workspace.canvas;
    let width=source.width, height=source.height;

    source.setViewportEx( 0, 0, width, height );
    dest.setViewportEx( 0, 0, width, height );

    raster.flush();
    dest.bind();

    let blendType = raster.renderer.shaderTex2d.blendType;
    raster.renderer.shaderTex2d.blendType = VG.Shader.Blend.None;
    raster.renderer.drawQuad( source, width, height, 0, 0, 1.0, VG.Core.Size( width, height ) );
    raster.renderer.shaderTex2d.blendType = blendType;

    raster.flush();
    dest.unbind();
};

VG.Nodes.MaterialRenderer.prototype.createFrame = function(x, y, w, h, b)
{
    var vw = w;
    var vh = h;

    var x1 = (x - vw / 2) / (vw / 2);
    var y1 = (vh / 2 - y) / (vh / 2);
    var x2 = ((x + w) - vw / 2) / (vw / 2);
    var y2 = (vh / 2 - (y + h)) / (vh / 2);

    var i = 0;
    var db=b.getDataBuffer();

    db.set(i++, x1); db.set(i++, y1); db.set(i++, 0.0); db.set(i++, 1.0);
    db.set(i++, x1); db.set(i++, y2); db.set(i++, 0.0); db.set(i++, 0.0);
    db.set(i++, x2); db.set(i++, y1); db.set(i++, 1.0); db.set(i++, 1.0);
    db.set(i++, x2); db.set(i++, y2); db.set(i++, 1.0); db.set(i++, 0.0);

    b.update();

    return b;
};

/**
 * Builds path traced shader.
 * @param {string} globalCode - The global code needed to render the material. These are functions created by the node system like noises etc.
 * @param {string} code - The material function itself.
 */

VG.Nodes.MaterialRenderer.prototype.build_path=function( { globalCode, code, type = 0 } = {} )
{
    if ( this.shader.fSource ) this.shader.destroy();
    if ( globalCode === undefined || code === undefined ) return;

    this.shader.vSource = `
        #version 100
        precision highp float;
        attribute vec4 aPosition;
        attribute vec2 aTexCoord;

        varying vec2 vTexCoord;

        void main() {
            vTexCoord = vec2(aTexCoord.x, 1.0-aTexCoord.y);
            gl_Position = aPosition;
        }
    `;

    this.shader.fSource = `
        #version 100
        precision highp float;

        varying vec2 vTexCoord;

        uniform vec3 uOrigin, uLookAt;
        uniform vec2 uCanvasSize;

        uniform int uIter;
        uniform sampler2D uLast;
        uniform float uTime;

        struct Material {
            int type;
            vec3 color;
            vec3 specularColor;
            float specularAmount;
            float metallic;
            float smoothness;
            float reflectance;
            float bump;
            vec3 emission;
            float ior;
        };

        struct Light {
            float id;
            vec3 emission;
        };

        #define PI 3.1415926535897932384626422832795028841971

        #define LIGHT1_POS vec3( 1.5, 1.5, 8 )
        #define LIGHT1_EM vec3( 180, 180, 180 )

        vec2 randv2;

        float random() {
            randv2+=vec2(1.0,0.0);
            // return fract(sin(dot(vTexCoord, vec2(12.9898, 78.233)) + seed++) * 43758.5453);
            return fract(sin(dot(randv2.xy ,vec2(12.9898,78.233))) * 43758.5453);

        }

        vec2 rand2(){// implementation derived from one found at: lumina.sourceforge.net/Tutorials/Noise.html
            randv2+=vec2(1.0,1.0);
            return vec2(fract(sin(dot(randv2.xy ,vec2(12.9898,78.233))) * 43758.5453),
                fract(cos(dot(randv2.xy ,vec2(4.898,7.23))) * 23421.631));
        }

        vec3 opU( vec3 d1, vec3 d2 )
        {
            return (d1.x<d2.x) ? d1 : d2;
        }

        vec3 opTwist( vec3 p, float twist )
        {
            float c = cos(twist*p.z);
            float s = sin(twist*p.z);
            mat2  m = mat2(c,-s,s,c);
            vec3  q = vec3(m*p.xy,p.z);
            return q;
        }

        float opS( float d1, float d2 )
        {
            return max(-d2,d1);
        }
    `;

    this.shader.fSource += globalCode;
    this.shader.fSource += code;

    this.shader.fSource += `

/*
   tp=p;
    gResult1=opU( gResult1, vec3( length( max( abs( tp) - vec3( 399.741, 399.741, 399.741 ), 0.0 ) ) - 0.259, 2, 0 ) );
   tp=p;
    tp.y = tp.y + -19.0000;
    gResult1.x=opS( gResult1.x, length( max( abs( tp) - vec3( 84.000, 3.000, 3.000 ), 0.0 ) ) - 16.000);
*/

        vec3 map( vec3 p )
        {
            vec3 res=vec3( 1000000, -2, -1 );
            ${ type === 0 ? "res=opU( res, vec3( p.z, 0, 0 ) );" :
                type === 1 ? "res=opU( res, vec3( length( p ) - 1.0, 0, 0 ) );" :
                type === 2 ? `vec3 tp=p;tp.zxy=opTwist( tp.zxy, 2.531 );
                res=opU( res, vec3( length( max( abs(tp) - vec3( 0.213 * 3.0, 0.978 * 3.0, 0.213 * 3.0 ), 0.0 ) ) - 0.10, 0, 0 ) );`
                : //`res=opU( res, vec3( length( max( abs(p) - vec3( 40, 40, 40 ), 0.0 ) ) - 0.259, 0, 0 ) );
                   //vec3 tp = p; tp.z -= 4.9;
                   //res.x=opS( res.x, length( max( abs(tp) - vec3( 1, 0.5, 5 ), 0.0 ) ) - 0.900);
                //`
                "res=opU( res, vec3( p.y + 1.5, 0, 0 ) );"
            }
            ${ code.indexOf( "_displacement" ) !== -1 ? "res.x -= material_1_displacement( p );" : "" }

            // res=opU( res, vec3( length( p ) - 1.0, 0, 0 ) );
            res=opU( res, vec3( length( p - LIGHT1_POS ) - 1.0, 2, 2 ) ); // Light #1

            return res;
        }

        // --- Cast a ray into the scene

        vec3 castRay( in vec3 ro, in vec3 rd, in float tmin, in float tmax )
        {
            float t=tmin;
            float m=-1.0, id=-1.0;

            for( int i=0; i<100; i++ )
            {
                // float precis = 0.002;
                float precis = 0.0005*t;

                vec3 res = map( ro+rd*t );
                if( t<precis || t>tmax ) break;
                t += res.x * 0.4;
                m = res.y;
                id = res.z;
            }

            if( t>tmax ) { m=-1.0; id=-1.0; }
            return vec3( t, m, id );
        }
    `;

    this.shader.fSource += `

        struct Ray {
            vec3 origin;
            vec3 dir;
        };

        vec3 calcNormal( in vec3 pos )
        {
            vec2 e = vec2(1.0,-1.0)*0.5773*0.0005;
            return normalize( e.xyy*map( pos + e.xyy ).x +
                            e.yyx*map( pos + e.yyx ).x +
                            e.yxy*map( pos + e.yxy ).x +
                            e.xxx*map( pos + e.xxx ).x );
        }


        vec3 jitter(vec3 d, float phi, float sina, float cosa) {
            vec3 w = normalize(d), u = normalize(cross(w.yzx, w)), v = cross(w, u);
            return (u*cos(phi) + v*sin(phi)) * sina + w * cosa;
        }

        float ggx(vec3 N, vec3 V, vec3 L, float roughness, float F0)
        {
            vec3 H = normalize(V + L);

            float dotLH = max(dot(L, H), 0.0);
            float dotNH = max(dot(N, H), 0.0);
            float dotNL = max(dot(N, L), 0.0);
            float dotNV = max(dot(N, V), 0.0);

            float alpha = roughness * roughness + 0.0001;

            // GGX normal distribution
            float alphaSqr = alpha * alpha;
            float denom = dotNH * dotNH * (alphaSqr - 1.0) + 1.0;
            float D = alphaSqr / (denom * denom);

            // Fresnel term approximation
            float F_a = 1.0;
            float F_b = pow(1.0 - dotLH, 5.0);
            float F = mix(F_b, F_a, F0);

            // GGX self shadowing term
            float k = (alpha + 2.0 * roughness + 1.0) / 8.0;
            float G = dotNL / (mix(dotNL, 1.0, k) * mix(dotNV, 1.0, k));

            // '* dotNV' - Is canceled due to normalization
            // '/ dotLN' - Is canceled due to lambert
            // '/ dotNV' - Is canceled due to G
            return max(0.0, min(10.0, D * F * G / 4.0));
        }

        vec3 angleToDir(vec3 n, float theta, float phi)
        {
            float sinPhi = sin(phi);
            float cosPhi = cos(phi);
            vec3 w = normalize(n);
            vec3 u = normalize(cross(w.yzx, w));
            vec3 v = cross(w, u);
            return (u * cos(theta) + v * sin(theta)) * sinPhi + w * cosPhi;
        }

        vec3 tracerDirectIllumination1( in vec3 hitOrigin, in vec3 hitNormal, in vec3 rayDir, in Material material  )
        {
            vec3 brdf = vec3( 0 );

            Light light;
            light.id = 2.0;
            light.emission = LIGHT1_EM;

            vec3 l0 = LIGHT1_POS - hitOrigin;
            // vec3 l = normalize( l0 );

            //vec3 l0 = lightSample - hitOrigin;
            // float cos_a_max = 0.0;//sqrt(1. - clamp(light.bbox_area / dot(l0, l0), 0., 1.));
            //float cosa = mix(cos_a_max, 1., random());
            //vec3 l = jitter(l0, 2.*PI*random(), sqrt(1. - cosa*cosa), cosa);

            float cos_a_max = sqrt(1. - clamp(0.5 * 0.5 / dot(l0, l0), 0., 1.));
            float cosa = mix(cos_a_max, 1., random());
            vec3 l = jitter(l0, 2.*PI*random(), sqrt(1. - cosa*cosa), cosa);

            vec3 lightHit = castRay( hitOrigin, l, 0.001, 20.0 );

            if ( lightHit.z == light.id )
            {
                float roughness = 1.0 - material.smoothness * material.smoothness;
                float metallic = material.metallic;

                float omega = 2. * PI * (1. - cos_a_max);
                brdf += ((light.emission * clamp(ggx( hitNormal, rayDir, l, roughness, metallic),0.,1.) * omega) / PI);
            }

            return brdf;
        }

        vec3 tracerDirectIllumination2( in vec3 hitOrigin, in vec3 hitNormal, in vec3 rayDir, in Material material  )
        {
            vec3 e = vec3( 0 );

            Light light;
            light.id = 2.0;
            light.emission = LIGHT1_EM;

            vec3 l0 = LIGHT1_POS - hitOrigin;
            // vec3 l = normalize( l0 );

            // vec3 l0 = lightSample - hitOrigin;
            // float cos_a_max = 1.0;//sqrt(1. - clamp(light.bbox_area / dot(l0, l0), 0., 1.));
            // float cosa = mix(cos_a_max, 1., random());
            // vec3 l = jitter(l0, 2.*PI*random(), sqrt(1. - cosa*cosa), cosa);

            float cos_a_max = sqrt(1. - clamp(0.5 * 0.5 / dot(l0, l0), 0., 1.));
            float cosa = mix(cos_a_max, 1., random());
            vec3 l = jitter(l0, 2.*PI*random(), sqrt(1. - cosa*cosa), cosa);

            // vec3 lightHit = hitScene2( hitOrigin, l, light

            vec3 lightHit = castRay( hitOrigin, l, 0.001, 10.0 );

            // vec3 lightHit = shadow( hitOrigin, l, uTMin, uTMax, light.id );
            if ( lightHit.z == light.id )
            {
                float omega = 2. * PI * (1. - cos_a_max);
                vec3 n = normalize(hitOrigin - LIGHT1_POS);
                e += ((light.emission * clamp(dot(l, n),0.,1.) * omega) / PI);
            }

            return e;
        }

        vec4 getColor( in Ray ray )
        {
            vec4 tcol = vec4(0,0,0,0);
            vec4 fcol = vec4(1.0);

            Material material;
            vec3 normal;

            // for (int depth = 0; depth < 2; depth++)
            {
                // Material material;
                // vec3 normal;

                vec3 hit = castRay( ray.origin, ray.dir, 0.001, 10.0 );

                if ( hit.y >= 0.0 )
                {
                    vec3 hitOrigin = ray.origin + ray.dir * hit.x;

                    normal = calcNormal( hitOrigin );

                    if ( hit.y < 2.0 ) {
                        material_1( hitOrigin, material, normal );
                    }
                    else if ( hit.y == 2.0 )
                    {
                        material.type = 2;
                        material.emission = LIGHT1_EM;
                    }

                    //hitOrigin = ray.origin + (ray.dir - material.bump) * hit.x;

                    if ( material.type == 0 )
                    {
                        // PBR

                        float E = 1.;
                        float roughness = 1.0 - material.smoothness * material.smoothness;
                        float alpha = roughness * roughness;
                        float metallic = material.metallic;
                        float reflectance = material.reflectance;
                        float specular = material.specularAmount;
                        float diffuse = 1.0 - specular;
                        vec4 color = vec4( material.color * diffuse + material.specularColor * specular, 1.0 );

                        vec3 brdf = vec3(0);

                        if (random() < reflectance)
                        {
                            vec3 brdf = tracerDirectIllumination1( hitOrigin, normal, ray.dir, material );

                            vec2 rand = rand2();
                            float xsi_1 = rand.x;
                            float xsi_2 = rand.y;
                            float phi = atan((alpha * sqrt(xsi_1)) / sqrt(1.0 - xsi_1));
                            float theta = 2.0 * PI * xsi_2;
                            vec3 direction = angleToDir(normal, theta, phi);

                            ray = Ray( hitOrigin, direction );

                            tcol += fcol * vec4( material.emission, 1.0 ) * E + fcol * color * vec4( brdf, 1.0 );
                            fcol *= color;
                        } else
                        {
                            float r2 = random();
                            vec3 d = jitter(normal, 2.*PI*random(), sqrt(r2), sqrt(1. - r2));

                            vec3 e = tracerDirectIllumination2( hitOrigin, normal, ray.dir, material );

                            float E = 1.;

                            ray = Ray( hitOrigin, d );

                            tcol += fcol * vec4( material.emission, 1.0 ) * E + fcol * color * vec4( e, 1.0 );
                            fcol *= color;
                        }
                    } else
                    if ( material.type == 1 )
                    {
                        // --- Dielectric - material.ior is the index of refraction

                        vec3 nl = dot(normal,ray.dir) < 0.0 ? normal : normal * -1.0;
                        float specular = material.specularAmount;
                        float diffuse = 1.0 - specular;
                        vec4 color = vec4( material.color * diffuse + material.specularColor * specular, 1.0 );
                        fcol *= color;

                        // Ideal dielectric REFRACTION
                        Ray reflRay = Ray( hitOrigin, ray.dir - normal * 2.0 * dot(normal,ray.dir));
                        bool into = dot(normal,nl) > 0.0;                // Ray from outside going in?

                        float nc = 1.0;   // IOR of air
                        float nt = material.ior; // IOR of solid
                        float nnt = into ? nc / nt : nt / nc;
                        float ddn = dot(ray.dir , nl);
                        float cos2t = 1.0 - nnt * nnt * (1.0 - ddn * ddn);

                        if (cos2t < 0.0)    // Total internal reflection
                        {
                            tcol += fcol * vec4( material.emission, 1.0);
                            ray = reflRay;
                        } else {
                            vec3 tdir = normalize(ray.dir * nnt - normal * ((into ? 1.0 : -1.0) * (ddn * nnt + sqrt(cos2t))));

                            float a = nt - nc;
                            float b = nt + nc;
                            float R0 = a * a / (b * b);
                            float c = 1.0 - (into ? -ddn : dot(tdir,normal));
                            float Re = R0 + (1.0 - R0) * c * c * c * c * c;
                            float Tr = 1.0 - Re;
                            float P = .25 + .5 * Re;
                            float RP = Re / P;
                            float TP = Tr / (1.0 - P);

                            if( random() < P )
                            {
                                // vec3 brdf = tracerDirectIllumination1( hitOrigin, normal, ray.dir, material );

                                ray = reflRay;
                                fcol = fcol * RP;
                                tcol += fcol * vec4( material.emission, 1.0 );// + fcol * vec4( brdf, 1.0 );

                            } else {

                                // vec3 e = tracerDirectIllumination2( hitOrigin, normal, ray.dir, material );

                                ray = Ray( hitOrigin, normalize( tdir ) );
                                fcol = fcol * TP;
                                tcol += fcol * vec4( material.emission, 1.0 );// + fcol * vec4( e, 1.0 );
                            }
                            // ray.origin += ray.dir * 0.0008;
                        }

                    } else
                    if ( material.type == 2 )
                    {
                        // --- Light
                        return vec4( material.emission, 1.0 );
                    }
                } else {
                    // vec4 backColor = vec4( 0 );
                    vec4 topColor = vec4( 0.1229, 0.3628, 0.7820, 1.0000 );
                    vec4 bottomColor = vec4( 1.0000, 1.0000, 1.0000, 1.0000 );
                    float t = 0.5 * ( ray.dir.y + 1.0 );
                    // vec4 backColor = vec4( 0.322, 0.322, 0.322, 0.0 );//( vec4( 1.0 )  - vec4( t )  ) * bottomColor + vec4( t )  * topColor;
                    vec4 backColor = vec4( 0.5, 0.5, 0.5, 1.0 );//( vec4( 1.0 )  - vec4( t )  ) * bottomColor + vec4( t )  * topColor;
                    // color = vec4( backColor.x, backColor.y, backColor.z, 1.0 ) ;

                    return tcol + fcol * backColor;
                }
            }

            {
                // Material material;
                // vec3 normal;

                vec3 hit = castRay( ray.origin, ray.dir, 0.001, 10.0 );

                if ( hit.y >= 0.0 )
                {
                    vec3 hitOrigin = ray.origin + ray.dir * hit.x;

                    normal = calcNormal( hitOrigin );

                    if ( hit.y < 2.0 ) {
                        material_1( hitOrigin, material, normal );
                    }
                    else if ( hit.y == 2.0 )
                    {
                        material.type = 2;
                        material.emission = LIGHT1_EM;
                    }

                    //hitOrigin = ray.origin + (ray.dir - material.bump) * hit.x;

                    if ( material.type == 0 )
                    {
                        // PBR

                        float E = 1.;
                        float roughness = 1.0 - material.smoothness * material.smoothness;
                        float alpha = roughness * roughness;
                        float metallic = material.metallic;
                        float reflectance = material.reflectance;
                        float specular = material.specularAmount;
                        float diffuse = 1.0 - specular;
                        vec4 color = vec4( material.color * diffuse + material.specularColor * specular, 1.0 );

                        vec3 brdf = vec3(0.0);

                        if (random() < reflectance)
                        {
                            vec3 brdf = tracerDirectIllumination1( hitOrigin, normal, ray.dir, material );

                            vec2 rand = rand2();
                            float xsi_1 = rand.x;
                            float xsi_2 = rand.y;
                            float phi = atan((alpha * sqrt(xsi_1)) / sqrt(1.0 - xsi_1));
                            float theta = 2.0 * PI * xsi_2;
                            vec3 direction = angleToDir(normal, theta, phi);

                            ray = Ray( hitOrigin, direction );

                            tcol += fcol * vec4( material.emission, 1.0 ) * E + fcol * color * vec4( brdf, 1.0 );
                            fcol *= color;
                        } else
                        {
                            float r2 = random();
                            vec3 d = jitter(normal, 2.*PI*random(), sqrt(r2), sqrt(1. - r2));

                            vec3 e = tracerDirectIllumination2( hitOrigin, normal, ray.dir, material );

                            float E = 1.;

                            ray = Ray( hitOrigin, d );

                            tcol += fcol * vec4( material.emission, 1.0 ) * E + fcol * color * vec4( e, 1.0 );
                            fcol *= color;
                        }
                    } else
                    if ( material.type == 1 )
                    {
                        // --- Dielectric - material.ior is the index of refraction

                        vec3 nl = dot(normal,ray.dir) < 0.0 ? normal : normal * -1.0;
                        float specular = material.specularAmount;
                        float diffuse = 1.0 - specular;
                        vec4 color = vec4( material.color * diffuse + material.specularColor * specular, 1.0 );
                        fcol *= color;

                        // Ideal dielectric REFRACTION
                        Ray reflRay = Ray( hitOrigin, ray.dir - normal * 2.0 * dot(normal,ray.dir));
                        bool into = dot(normal,nl) > 0.0;                // Ray from outside going in?

                        float nc = 1.0;   // IOR of air
                        float nt = material.ior; // IOR of solid
                        float nnt = into ? nc / nt : nt / nc;
                        float ddn = dot(ray.dir , nl);
                        float cos2t = 1.0 - nnt * nnt * (1.0 - ddn * ddn);

                        if (cos2t < 0.0)    // Total internal reflection
                        {
                            tcol += fcol * vec4( material.emission, 1.0);
                            ray = reflRay;
                        } else {
                            vec3 tdir = normalize(ray.dir * nnt - normal * ((into ? 1.0 : -1.0) * (ddn * nnt + sqrt(cos2t))));

                            float a = nt - nc;
                            float b = nt + nc;
                            float R0 = a * a / (b * b);
                            float c = 1.0 - (into ? -ddn : dot(tdir,normal));
                            float Re = R0 + (1.0 - R0) * c * c * c * c * c;
                            float Tr = 1.0 - Re;
                            float P = .25 + .5 * Re;
                            float RP = Re / P;
                            float TP = Tr / (1.0 - P);

                            if( random() < P )
                            {
                                // vec3 brdf = tracerDirectIllumination1( hitOrigin, normal, ray.dir, material );

                                ray = reflRay;
                                fcol = fcol * RP;
                                tcol += fcol * vec4( material.emission, 1.0 );// + fcol * vec4( brdf, 1.0 );

                            } else {

                                // vec3 e = tracerDirectIllumination2( hitOrigin, normal, ray.dir, material );

                                ray = Ray( hitOrigin, normalize( tdir ) );
                                fcol = fcol * TP;
                                tcol += fcol * vec4( material.emission, 1.0 );// + fcol * vec4( e, 1.0 );
                            }
                            // ray.origin += ray.dir * 0.0008;
                        }

                    } else
                    if ( material.type == 2 )
                    {
                        // --- Light
                        return vec4( material.emission, 1.0 );
                    }
                } else {
                    // vec4 backColor = vec4( 0 );
                    vec4 topColor = vec4( 0.1229, 0.3628, 0.7820, 1.0000 );
                    vec4 bottomColor = vec4( 1.0000, 1.0000, 1.0000, 1.0000 );
                    float t = 0.5 * ( ray.dir.y + 1.0 );
                    // vec4 backColor = vec4( 0.322, 0.322, 0.322, 0.0 );//( vec4( 1.0 )  - vec4( t )  ) * bottomColor + vec4( t )  * topColor;
                    vec4 backColor = vec4( 0.5, 0.5, 0.5, 1.0 );//( vec4( 1.0 )  - vec4( t )  ) * bottomColor + vec4( t )  * topColor;
                    // color = vec4( backColor.x, backColor.y, backColor.z, 1.0 ) ;

                    return tcol + fcol * backColor;
                }
            }

            return tcol;
        }

        #define SAMPLES 1

        vec3 Tonemap_ACES(const vec3 x) {
            // Narkowicz 2015, "ACES Filmic Tone Mapping Curve"
            const float a = 2.51;
            const float b = 0.03;
            const float c = 2.43;
            const float d = 0.59;
            const float e = 0.14;
            return (x * (a * x + b)) / (x * (c * x + d) + e);
        }

        void main()
        {
            float ratio = uCanvasSize.x / uCanvasSize.y;
            vec2 pixelSize = vec2(1.0) / uCanvasSize.xy;

            randv2=fract(cos((vTexCoord.xy+vTexCoord.yx*vec2(1000.0,1000.0))+vec2(uTime)*10.0));

            // --- Camera

            const float fov = 80.0;
            float halfWidth = tan(radians(fov) * 0.5);
            float halfHeight = halfWidth / ratio;

            vec3 upVector = vec3(0.0, 1.0, 0.0);

            vec3 w = normalize(uOrigin - uLookAt);
            vec3 u = cross(upVector, w);
            vec3 v = cross(w, u);

            vec3 lowerLeft = uOrigin-halfWidth * u - halfHeight * v - w;
            vec3 horizontal = u * halfWidth * 2.0;
            vec3 vertical = v * halfHeight * 2.0;

            // --- lights
/*
            lights[0].pos = vec3( 1, 2, 2 );
            lights[0].color = vec3( 1 );

            lights[1].pos = vec3( -80, 1, 20 );
            lights[1].color = vec3( 0.5 );
*/
            // ---

            vec4 color = vec4(0);

            for (int s = 0; s < SAMPLES; s++)
            {
                vec3 dir = lowerLeft - uOrigin;
                vec2 rand = rand2();
                // vec2 rand = vec2( 0.5 );

                dir += horizontal * (pixelSize.x * rand.x + vTexCoord.x);
                dir += vertical * (pixelSize.y * rand.y + 1.0 - vTexCoord.y);

                color += getColor( Ray( uOrigin, normalize(dir) ) );
            }

            color /= float( SAMPLES );
            color = vec4( clamp( pow( color.xyz, vec3(0.4545) ), 0.0, 1.0 ), color.a );
            // color = vec4( pow( color.xyz, vec3(0.4545) ), color.a );
            // color = vec4( clamp( Tonemap_ACES( color.xyz ), 0.0, 1.0 ), color.a );

            if ( uIter > 0 ) {
                vec4 lastColor = texture2D( uLast, vTexCoord, 0.0 );

                float weight = float(uIter+1);
                gl_FragColor = mix(lastColor, color, 1.0 / weight );
            } else gl_FragColor = color;
        }
    `;

    // console.log( this.shader.fSource );

    try {
        this.shader.create();
    } catch( err )
    {
        // console.log( this.shader.fSource );
        return;
    }

    this.iter = 0;
};

/**
 * Builds a simple and fast preview shader.
 * @param {string} globalCode - The global code needed to render the material. These are functions created by the node system like noises etc.
 * @param {string} code - The material function itself.
 */

VG.Nodes.MaterialRenderer.prototype.build=function( { globalCode, code, type = 0 } = {} )
{
    if ( this.shader.fSource ) this.shader.destroy();
    if ( globalCode === undefined || code === undefined ) return;

    this.shader.vSource = `
        #version 100
        precision highp float;
        attribute vec4 aPosition;
        attribute vec2 aTexCoord;

        varying vec2 vTexCoord;

        void main() {
            vTexCoord = vec2(aTexCoord.x, 1.0-aTexCoord.y);
            gl_Position = aPosition;
        }
    `;

    this.shader.fSource = `
        #version 100
        precision highp float;

        varying vec2 vTexCoord;

        uniform vec3 uOrigin, uLookAt;
        uniform vec2 uCanvasSize;

        uniform int uIter;
        uniform sampler2D uLast;
        uniform float uTime;

        struct Material {
            int type;
            vec3 color;
            vec3 specularColor;
            float specularAmount;
            float metallic;
            float smoothness;
            float reflectance;
            float bump;
            vec3 emission;
            float ior;
        };

        #define PI 3.1415926535897932384626422832795028841971

        #define LIGHT1_POS vec3( 1.5, 1.5, 8 )
        #define LIGHT1_EM vec3( 180, 180, 180 )

        vec2 randv2;

        float random() {
            randv2+=vec2(1.0,0.0);
            // return fract(sin(dot(vTexCoord, vec2(12.9898, 78.233)) + seed++) * 43758.5453);
            return fract(sin(dot(randv2.xy ,vec2(12.9898,78.233))) * 43758.5453);

        }

        vec2 rand2(){// implementation derived from one found at: lumina.sourceforge.net/Tutorials/Noise.html
            randv2+=vec2(1.0,1.0);
            return vec2(fract(sin(dot(randv2.xy ,vec2(12.9898,78.233))) * 43758.5453),
                fract(cos(dot(randv2.xy ,vec2(4.898,7.23))) * 23421.631));
        }

        vec3 opU( vec3 d1, vec3 d2 )
        {
            return (d1.x<d2.x) ? d1 : d2;
        }

        vec3 opTwist( vec3 p, float twist )
        {
            float c = cos(twist*p.z);
            float s = sin(twist*p.z);
            mat2  m = mat2(c,-s,s,c);
            vec3  q = vec3(m*p.xy,p.z);
            return q;
        }

        float opS( float d1, float d2 )
        {
            return max(-d2,d1);
        }
/*
   tp=p;
    gResult1=opU( gResult1, vec3( length( max( abs( tp) - vec3( 399.741, 399.741, 399.741 ), 0.0 ) ) - 0.259, 2, 0 ) );
   tp=p;
    tp.y = tp.y + -19.0000;
    gResult1.x=opS( gResult1.x, length( max( abs( tp) - vec3( 84.000, 3.000, 3.000 ), 0.0 ) ) - 16.000);
*/

        vec3 map( vec3 p )
        {
            vec3 res=vec3( 1000000, -2, -1 );
            ${ type === 0 ? "res=opU( res, vec3( p.z, 0, 0 ) );" :
                type === 1 ? "res=opU( res, vec3( length( p ) - 1.0, 0, 0 ) );" :
                type === 2 ? `vec3 tp=p;tp.zxy=opTwist( tp.zxy, 2.531 );
                res=opU( res, vec3( length( max( abs(tp) - vec3( 0.213 * 3.0, 0.978 * 3.0, 0.213 * 3.0 ), 0.0 ) ) - 0.10, 0, 0 ) );`
                : //`res=opU( res, vec3( length( max( abs(p) - vec3( 40, 40, 40 ), 0.0 ) ) - 0.259, 0, 0 ) );
                   //vec3 tp = p; tp.z -= 4.9;
                   //res.x=opS( res.x, length( max( abs(tp) - vec3( 1, 0.5, 5 ), 0.0 ) ) - 0.900);
                //`
                "res=opU( res, vec3( p.y + 1.5, 0, 0 ) );"
            }
            // res=opU( res, vec3( length( p ) - 1.0, 0, 0 ) );
            res=opU( res, vec3( length( p - LIGHT1_POS ) - 1.0, 2, 2 ) ); // Light #1

            return res;
        }

        // --- Cast a ray into the scene

        vec3 castRay( in vec3 ro, in vec3 rd, in float tmin, in float tmax )
        {
            float t=tmin;
            float m=-1.0, id=-1.0;

            for( int i=0; i<100; i++ )
            {
                // float precis = 0.002;
                float precis = 0.0005*t;

                vec3 res = map( ro+rd*t );
                if( t<precis || t>tmax ) break;
                t += res.x;
                m = res.y;
                id = res.z;
            }

            if( t>tmax ) { m=-1.0; id=-1.0; }
            return vec3( t, m, id );
        }
    `;

    this.shader.fSource += globalCode;
    this.shader.fSource += code;
    this.shader.fSource += `

        struct Ray {
            vec3 origin;
            vec3 dir;
        };

        vec3 calcNormal( in vec3 pos )
        {
            vec2 e = vec2(1.0,-1.0)*0.5773*0.0005;
            return normalize( e.xyy*map( pos + e.xyy ).x +
                            e.yyx*map( pos + e.yyx ).x +
                            e.yxy*map( pos + e.yxy ).x +
                            e.xxx*map( pos + e.xxx ).x );
        }

        vec4 getColor( in Ray ray )
        {
            vec4 color = vec4(0);

            Material material;
            vec3 normal;

            vec3 hit = castRay( ray.origin, ray.dir, 0.001, 10.0 );

            if ( hit.y >= 0.0 )
            {
                vec3 hitOrigin = ray.origin + ray.dir * hit.x;

                material_1( hitOrigin, material, normal );
                color = vec4( material.color, 1.0 );
            } else {
                color = vec4( 0.5, 0.5, 0.5, 1.0 );
            }

            return color;
        }

        #define SAMPLES 4

        vec3 Tonemap_ACES(const vec3 x) {
            // Narkowicz 2015, "ACES Filmic Tone Mapping Curve"
            const float a = 2.51;
            const float b = 0.03;
            const float c = 2.43;
            const float d = 0.59;
            const float e = 0.14;
            return (x * (a * x + b)) / (x * (c * x + d) + e);
        }

        void main()
        {
            float ratio = uCanvasSize.x / uCanvasSize.y;
            vec2 pixelSize = vec2(1.0) / uCanvasSize.xy;

            randv2=fract(cos((vTexCoord.xy+vTexCoord.yx*vec2(1000.0,1000.0))+vec2(uTime)*10.0));

            // --- Camera

            const float fov = 80.0;
            float halfWidth = tan(radians(fov) * 0.5);
            float halfHeight = halfWidth / ratio;

            vec3 upVector = vec3(0.0, 1.0, 0.0);

            vec3 w = normalize(uOrigin - uLookAt);
            vec3 u = cross(upVector, w);
            vec3 v = cross(w, u);

            vec3 lowerLeft = uOrigin-halfWidth * u - halfHeight * v - w;
            vec3 horizontal = u * halfWidth * 2.0;
            vec3 vertical = v * halfHeight * 2.0;

            // ---

            vec4 color = vec4(0);

            for (int s = 0; s < SAMPLES; s++)
            {
                vec3 dir = lowerLeft - uOrigin;
                vec2 rand = rand2();
                // vec2 rand = vec2( 0.5 );

                dir += horizontal * (pixelSize.x * rand.x + vTexCoord.x);
                dir += vertical * (pixelSize.y * rand.y + 1.0 - vTexCoord.y);

                color += getColor( Ray( uOrigin, normalize(dir) ) );
            }

            color /= float( SAMPLES );
            color = vec4( clamp( pow( color.xyz, vec3(0.4545) ), 0.0, 1.0 ), color.a );
            // color = vec4( pow( color.xyz, vec3(0.4545) ), color.a );
            // color = vec4( clamp( Tonemap_ACES( color.xyz ), 0.0, 1.0 ), color.a );

            if ( uIter > 0 ) {
                vec4 lastColor = texture2D( uLast, vTexCoord, 0.0 );

                float weight = float(uIter+1);
                gl_FragColor = mix(lastColor, color, 1.0 / weight );
            } else gl_FragColor = color;
        }
    `;

    // console.log( this.shader.fSource );

    try {
        this.shader.create();
    } catch( err )
    {
        // console.log( this.shader.fSource );
        return;
    }

    this.iter = 0;
};

/**
 * Returns the duration of the last render pass in milliseconds. Returns undefined if the render is not yet finished.
 * @returns {number} The duration of the last render in ms or undefined.
 */

VG.Nodes.MaterialRenderer.prototype.getTiming=function()
{
    if ( !this.query ) return null;
    if ( VG.webgl2 ) {
        let available = VG.WebGL.gl.getQueryParameter( this.query, VG.WebGL.gl.QUERY_RESULT_AVAILABLE);
        let disjoint = VG.WebGL.gl.getParameter( VG.WebGL.queryExt.GPU_DISJOINT_EXT);

        if (available && !disjoint) {
            // See how much time the rendering of the object took in nanoseconds.
            let timeElapsed = VG.WebGL.gl.getQueryParameter( this.query, VG.WebGL.gl.QUERY_RESULT);
            return timeElapsed / 1000000;
        }
    } else
    {
        // ...at some point in the future, after returning control to the browser and being called again:
        let available = this.queryExt.getQueryObjectEXT( this.query, this.queryExt.QUERY_RESULT_AVAILABLE_EXT);
        let disjoint = VG.WebGL.gl.getParameter(this.queryExt.GPU_DISJOINT_EXT);

        if (available && !disjoint) {
            // See how much time the rendering of the object took in nanoseconds.
            let timeElapsed = this.queryExt.getQueryObjectEXT(this.query, this.queryExt.QUERY_RESULT_EXT);
            return timeElapsed / 1000000;
        }
    }
};

/**
 * Renders one iteration.
 */

VG.Nodes.MaterialRenderer.prototype.render=function( rect, { noZoom = false } = {} )
{
    // --- Run it

    let b = this.buffer;
    let shader = this.shader;
    let rt = this.rt, rt1 = this.rt1;

    let width = rect.width, height = rect.height;

    if ( width !== rt.width || height !== rt.height ) {
        rt.resetSize( width, height );
        rt1.resetSize( width, height );
    }

    if ( !this.iter ) this.startTime=Date.now();

    rt.bind();
    rt.setViewport( VG.Core.Rect( 0, 0, width, height ) );
    rt.clear( undefined, true );

    this.createFrame( 0, 0, width, height, this.buffer );

    shader.bind();
    b.bind();

    let stride = b.getStride();
    b.vertexAttrib(shader.getAttrib("aPosition"), 2, false, stride * 4, 0);
    b.vertexAttrib(shader.getAttrib("aTexCoord"), 2, false, stride * 4, stride * 2);

    // this.camera.fov = 80.0/180 * Math.PI;
    this.camera.aspect = width / height;
    this.camera.setLookAt(new VG.Math.Vector3(0, 0, 0), new VG.Math.Vector3(0, 1, 0), new VG.Math.Vector3(0, 0, 5), true);
    if ( !noZoom )
        this.camera.setBoundingBox( new VG.Math.Vector3(-1.32, -1.32, -1.32), new VG.Math.Vector3(1.32, 1.32, 1.32) );

    shader.setFloat( "uOrigin", [this.camera.eye.x,this.camera.eye.y,this.camera.eye.z] );
    shader.setFloat( "uLookAt", [this.camera.center.x,this.camera.center.y,this.camera.center.z] );

    shader.setFloat( "uCanvasSize", [ width, height ] );
    shader.setFloat( "uTime", ( Date.now() - this.startTime ) / 1000.0 );
    shader.setInt( "uIter", this.iter );

    shader.setTexture( this.uLast, rt1, 0 );

    if ( VG.webgl2 )
    {
        if ( !this.query ) this.query = VG.WebGL.gl.createQuery();
        VG.WebGL.gl.beginQuery( VG.WebGL.queryExt.TIME_ELAPSED_EXT, this.query );
        b.drawBuffer( VG.Renderer.Primitive.TriangleStrip, 0, 4 );
        VG.WebGL.gl.endQuery( VG.WebGL.queryExt.TIME_ELAPSED_EXT );
    } else {
        if ( !this.query ) this.query = this.queryExt.createQueryEXT();
        this.queryExt.beginQueryEXT( this.queryExt.TIME_ELAPSED_EXT, this.query );
        b.drawBuffer( VG.Renderer.Primitive.TriangleStrip, 0, 4 );
        this.queryExt.endQueryEXT( this.queryExt.TIME_ELAPSED_EXT );
    }

    rt.unbind();

    this.copyRenderTarget( rt, rt1 );

    this._mainRT.setViewport(VG.context.workspace.rect);
    this.iter++;

    return rt1;
};


/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.NodeFloat

VG.Nodes.NodeFloat = class extends VG.Nodes.Node
{
    constructor() {
        super();
        this.name="Float Value";
        this.className="NodeFloat";
        this.noPreview=true;

        // --- Terminals

        this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "float", function( options ) {
            let param = this.container.getParamValue( "float" );
            this.customTitle = param.toFixed( 3 );
            return param.toFixed( 3 );
        }.bind( this ) ) );
    }

    createProperties( data ) {
        this.container=VG.Nodes.ParamContainer( this );
        var group=this.container.addGroupByName( "basics", "Float Settings" );

        group.addParam( VG.Nodes.ParamNumber( data, "float", "Float Value", 0.000, -10000.00, 10000.00, 3 ) );
    }
};

VG.Nodes.availableNodes.set( "Generator.Color", "NodeColor" );

// ----------------------------------------------------------------- VG.Nodes.Color

VG.Nodes.NodeColor = class extends VG.Nodes.Node
{
    constructor() {
        super();
        this.name="Color Value";
        this.className="NodeColor";
        this.noPreview=true;

        // --- Terminals

        this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "color", function( options ) {
            let param = this.container.getParam( "color" );
            // this.customTitle = param.toFixed( 3 );
            return `${param.toString()}.xyz`;
        }.bind( this ) ) );
    }

    createProperties( data ) {
        this.container=VG.Nodes.ParamContainer( this );
        var group=this.container.addGroupByName( "basics", "Color Settings" );

        group.addParam( VG.Nodes.ParamColor( data, "color", "Color", VG.Core.Color( "#ffffff" ) ) );
    }
};

VG.Nodes.availableNodes.set( "Generator.Float", "NodeFloat" );

// ----------------------------------------------------------------- VG.Nodes.NodeShapes

VG.Nodes.NodeShapes2D = function()
{
    if ( !(this instanceof VG.Nodes.NodeShapes2D ) ) return new VG.Nodes.NodeShapes2D();

    this.name="Shapes 2D";
    this.className="NodeShapes2D";
    this.modifiesGlobal = true;

    VG.Nodes.Node.call( this );

    this.boxD = `
        float boxDist_${this.token}(vec2 p, vec2 size, float radius)
        {
            size -= vec2(radius);
            vec2 d = abs(p) - size;
            return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
        }
    `;

    this.hexD = `
        float hexDist_${this.token}(vec2 p, vec2 h) {
	        vec2 q = abs(p);
            return max(q.x-h.y,max(q.x+q.y*0.57735,q.y*1.1547)-h.x);
        }
    `;

    this.triangleD = `
        float triangleDist_${this.token}(vec2 p, float width, float height)
        {
            vec2 n = normalize(vec2(height, width / 2.0));
            return max(	abs(p).x*n.x + p.y*n.y - (height*n.y), -p.y);
        }
    `;

    this.strokeCode = `
        float stroke_${this.token}(float dist, float width)
        {
            //dist += 1.0;
            float alpha1 = clamp(dist + width, 0.0, 1.0);
            float alpha2 = clamp(dist, 0.0, 1.0);
            return alpha1 - alpha2;
        }
    `;

    // --- Terminals

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "fill", function( options ) {

        let addVar = options.getVar( this, "dist", "float" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + `NodeShapes2D_${this.token}( pos, normal )` + ";\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + `  material.color = vec3( clamp( - ${addVar.name}, 0., 1.0 ) );\n}`;
            options.generatePreview( self, prevCode );
        }

        return `clamp( -${addVar.name}, 0., 1.)`;

    }.bind( this ) ) );

    this.strokeTerminal = this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "stroke", function( options ) {

        let addVar = options.getVar( this, "dist", "float" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + `NodeShapes2D_${this.token}( pos, normal )` + ";\n";

        let stroke = this.container.getParamValue( "stroke" ).toFixed(3);

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + ` material.color = vec3( stroke_${this.token}( ${addVar.name}, ${stroke} ) );\n}`;
            options.generatePreview( self, prevCode );
        }

        return `stroke_${this.token}( ${addVar.name}, ${stroke} )`;

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "dist", function( options ) {

        let addVar = options.getVar( this, "dist", "float" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + `NodeShapes2D_${this.token}( pos, normal )` + ";\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + `  material.color = vec3( ${addVar.name} );\n}`;
            options.generatePreview( self, prevCode );
        }

        return addVar.name;

    }.bind( this ) ) );

    this.funcTerminal = this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "function", function( options ) {
        return `NodeShapes2D_func_${this.token}`;
    }.bind( this ) ) );
};

VG.Nodes.NodeShapes2D.prototype=VG.Nodes.Node();

VG.Nodes.NodeShapes2D.prototype.getGlobalCode=function( data )
{
    let shape = this.container.getParamValue( "shape" );
    let round = this.container.getParamValue( "round" ).toFixed(3);
    let scale = this.container.getParamValue( "scale" ).toFixed(3);
    let translate = this.container.getParam( "translate" ).toString();
    let rotate = this.container.getParamValue( "rotate" ).toFixed(3);
    let hard = this.container.getParamValue( "hard" ).toFixed(3);
    let size= this.container.getParamValue( "size" );
    let repeat = this.container.getParam( "repeat" ).toString();

    let global = "";

    if ( this.strokeTerminal.isConnected() )
        global += this.strokeCode;

    // --- Axis Code

    let self = this;
    function getAxisCode() {
        let axisParam = self.container.getParam( "axis" );

        if ( self.funcTerminal.isConnected() )
        {
            return 'vec2 uv = pos.xy;';
        } else
        if ( axisParam.data.axis === 0 ) {
            return `
                vec2 uv;
                vec3 n = abs(normal);
                if(n.x > 0.57735) {
                    uv = pos.yz;
                } else if (n.y>0.57735){
                    uv = pos.xz;
                }else{
                    uv = pos.xy;
                }
            `;
        } else
            return `vec2 uv = pos.${axisParam.list[ axisParam.data.axis ].toLowerCase()};`;
    }

    // ---


    if ( shape === 0 ) {
        // --- Box
        global += this.boxD;
        global += `
            float NodeShapes2D_${this.token}( in vec3 pos, in vec3 normal )
            {
                ${getAxisCode()}

                // uv.x -= step(0.5, uv.y)*.5;

                // if ( mod( uv.y * ( ${size.y.toFixed(2)} + (2.0 * ${size.y.toFixed(2)} - ${repeat}.y ) / 2.0 ) / ${scale}, 1.0 ) > 0.5 )
	                // uv.x += 0.5;

                uv /= ${scale};
                uv += ${translate};

                float angle = ${rotate};
	            mat2 m = mat2( cos( angle ), sin( angle ), -sin( angle ), cos( angle ) );
	            uv = uv * m;

                vec2 r=${repeat};
                vec2 q=mod(uv,r)-0.5*r;

                // if ( mod( uv.y * 0.5, 1.0 ) > 0.5 )
	                // uv.x += 0.5;

                float d = boxDist_${this.token}( q, vec2( ${size.x.toFixed(2)}, ${size.y.toFixed(2)} ), ${round} ) * 100.0 * ${hard};
                return d;
            }
        `;
    } else
    if ( shape === 1 ) {
        // --- Hex
        global += this.hexD;
        global += `
            float NodeShapes2D_${this.token}( in vec3 pos, in vec3 normal )
            {
                ${getAxisCode()}

                uv /= ${scale};
                uv += ${translate};
                float angle = ${rotate};
	            mat2 m = mat2( cos( angle ), sin( angle ), -sin( angle ), cos( angle ) );
	            uv = uv * m;

                vec2 r=${repeat};
                vec2 q=mod(uv,r)-0.5*r;

                float d = hexDist_${this.token}( q, vec2( ${size.x.toFixed(2)}, ${size.y.toFixed(2)} ) ) * 100.0 * ${hard};
                return d;
            }
        `;
    } else
    if ( shape === 2 ) {
        // --- Sphere
        global += this.hexD;
        global += `
            float NodeShapes2D_${this.token}( in vec3 pos, in vec3 normal )
            {
                ${getAxisCode()}

                uv /= ${scale};
                uv += ${translate};
                float angle = ${rotate};
	            mat2 m = mat2( cos( angle ), sin( angle ), -sin( angle ), cos( angle ) );
	            uv = uv * m;

                vec2 r=${repeat};
                vec2 q=mod(uv,r)-0.5*r;

                float d = ( length( q ) - ${size.x.toFixed(2)} ) * 100.0 * ${hard} ;
                return d;
            }
        `;
    } else
    if ( shape === 3 ) {
        // --- Triangle
        global += this.triangleD;
        global += `
            float NodeShapes2D_${this.token}( in vec3 pos, in vec3 normal )
            {
                ${getAxisCode()}

                uv /= ${scale};
                uv += ${translate};
                float angle = ${rotate};
	            mat2 m = mat2( cos( angle ), sin( angle ), -sin( angle ), cos( angle ) );
	            uv = uv * m;

                vec2 r=${repeat};
                vec2 q=mod(uv,r)-0.5*r;

                float d = triangleDist_${this.token}( q, ${size.x.toFixed(2)}, ${size.y.toFixed(2)} ) * 100.0 * ${hard};
                return d;
            }
        `;
    }

    if ( this.funcTerminal.isConnected() ) {
        global += `
            vec4 NodeShapes2D_func_${this.token}( in vec3 pos, in vec3 normal )
            {
                return vec4( NodeShapes2D_${this.token}( pos, normal ) );
            }
        `;
    }

    // console.log( global );

    return global;
};

VG.Nodes.NodeShapes2D.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Shapes 2D Settings" );

    group.addParam( VG.Nodes.ParamList( data, "shape", "Shape", 0, ["Cube", "Hex", "Sphere", "Triangle"] ) );
    group.addParam( VG.Nodes.ParamVector2( data, "size", "Size", 1.00, 1.00, 0, 100, 2 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "round", "Rounding", 0.2, 0.001, 2.00, 0.1, 3 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "hard", "Hardness", 1.0, 0.001, 1.00, 0.1, 3 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "stroke", "Stroke", 1.0, 0.001, 20.00, 0.1, 3 ) );
    group.addParam( VG.Nodes.ParamList( data, "axis", "Pattern Axis", 0, ["Dynamic", "XY", "XZ", "YZ"] ) );
    group.addParam( VG.Nodes.ParamDivider( data, "divider", "Transform" ) );
    group.addParam( VG.Nodes.ParamSlider( data, "scale", "Scale", 1, 0.001, 10.00, 0.1, 3 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "rotate", "Rotate", 0, 0.0, 359, 0.1, 2 ) );
    group.addParam( VG.Nodes.ParamVector2( data, "translate", "Translate", 0.00, 0.00, -100, 100, 2 ) );
    group.addParam( VG.Nodes.ParamVector2( data, "repeat", "Repeat", 0.00, 0.00, 0, 100, 2 ) );
    // group.addParam( VG.Nodes.ParamNumber( data, "alternate", "Alternate", 0.00, 0, 100, 2 ) );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Shapes 2D.Shapes 2D", "NodeShapes2D" );

// ----------------------------------------------------------------- VG.Nodes.NodeShape3DMixer

VG.Nodes.NodeGrid2D = class extends VG.Nodes.Node
{
    constructor() {
        super();

        this.name="Grid";
        this.className="NodeGrid2D";

        // --- Inputs

        this.noiseTerminal = VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "noise" );
        this.addInput( this.noiseTerminal );

        this.shapeTerminals = [];
        this.shapeTerminals[0] = this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "shape1" ) );
        this.shapeTerminals[1] = this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "shape2" ) );
        this.shapeTerminals[2] = this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "shape3" ) );


        // --- Outputs

        this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "dist", function( options ) {

            let addVar = options.getVar( this, "dist", "float" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + `NodeGrid2D_${this.token}( pos, normal )` + ";\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + `  material.color = vec3( clamp( pow( ${addVar.name}, 0.4545 ), 0., 1.0 ) );\n}`;
                options.generatePreview( self, prevCode );
            }

            return `${addVar.name}`;
        }.bind( this ) ) );
    }

    getGlobalCode( data )
    {
        let gridSize = this.container.getParam( "gridSize" ).toString();
        let scale = this.container.getParamValue( "scale" ).toFixed(3);
        let hard = this.container.getParamValue( "hard" ).toFixed(3);
        let round = this.container.getParamValue( "round" ).toFixed(3);
        let randomX = this.container.getParamValue( "randomX" );
        let randomY = this.container.getParamValue( "randomY" );
        let tileSize = this.container.getParam( "tileSize" ).toString();

        let global = "";

        // --- Axis Code

        let self = this;
        function getAxisCode() {
            let axisParam = self.container.getParam( "axis" );

            if ( axisParam.data.axis === 0 ) {
                return `
                    vec2 grid;
                    vec3 n = abs(normal);
                    if(n.x > 0.57735) {
                        grid = pos.yz;
                    } else if (n.y>0.57735){
                        grid = pos.xz;
                    }else{
                        grid = pos.xy;
                    }
                `;
            } else
                return `vec2 grid = pos.${axisParam.list[ axisParam.data.axis ].toLowerCase()};`;
        }

        global += `
            float boxDist_${this.token}(vec2 p, vec2 size, float radius)
            {
                size -= vec2(radius);
                vec2 d = abs(p) - size;
                return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
            }
        `;

        // --- Noise Code

        let noiseCode = "float rand = 0.0;";

        if ( this.noiseTerminal.isConnected() ) {
            let func = this.noiseTerminal.first().onCall( { generatePreview : function() {} } );
            noiseCode = `
                float rand = ${func}( vec3( gridCenter, 0 ) ).x;

                ${randomX ? "gridCenter.x -= (0.3 + 0.5 * (rand - 0.5));" : "" }
                ${randomY ? "gridCenter.y -= (0.3 + 0.5 * (rand - 0.5));" : "" }
            `;
        }

        // --- Shape Code

        let shapeCode = `float res = clamp( -boxDist_${this.token}( uv - gridCenter, tileSize, ${round} ) * 100.0 * ${hard}, 0., 1. );`;

        let shapeCount = 0; this.shapeTerminals.forEach( function( t ) { if ( t.isConnected() ) ++shapeCount; } );

        if ( shapeCount ) {
            shapeCode = "float res = 0.0; rand += clamp( rand + 0.3, 0., 1. );";

            let cCount = 0;
            for ( let i = 0; i < 3; ++i ) {
                let t = this.shapeTerminals[i];
                if ( t.isConnected() )
                {
                    let func = t.first().onCall( { generatePreview : function() {} } );
                    if ( shapeCount === 1 ) {
                        shapeCode += `res = clamp( -${func}( vec3( uv - gridCenter, pos.z ), normal ).x, 0., 1. );`;
                    } else
                    {
                        if ( cCount ) shapeCode += " else ";
                        shapeCode += `if ( rand <= ${((cCount +1) * 1.0 / shapeCount).toFixed(3)} )
                            res = clamp( -${func}( vec3( uv - gridCenter, pos.z ), normal ).x, 0., 1. );
                        `;
                    }

                    ++cCount;
                }
            }
        }

        // ---

        global += `
            float NodeGrid2D_${this.token}( in vec3 pos, in vec3 normal )
            {
                pos /= vec3( ${gridSize}, ${gridSize}.x ) * ${scale};
                ${getAxisCode()}

                vec2 uv = grid;

                grid = floor( grid );

	            vec2 gridCenter = vec2(grid.x + 0.5, grid.y + 0.5 );
                vec2 tileSize = ${tileSize} * 0.5;

                ${noiseCode}
                ${shapeCode}

                return res;
            }
        `;

        // console.log( global );

        return global;
    }

    createProperties( data )
    {
        this.container=VG.Nodes.ParamContainer( this );
        var group=this.container.addGroupByName( "basics", "Grid Settings" );

        group.addParam( VG.Nodes.ParamVector2( data, "gridSize", "Grid Size", 1, 1, 0, 10, 3 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "scale", "Scale", 1, 0.001, 3.00, 0.1, 3, 1 ) );
        group.addParam( VG.Nodes.ParamVector2( data, "tileSize", "Tile Size", 1, 1, 0, 10, 3 ) );

        group.addParam( VG.Nodes.ParamSlider( data, "round", "Rounding", 0.2, 0.001, 2.00, 0.1, 3 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "hard", "Hardness", 1.0, 0.001, 1.00, 0.1, 3 ) );
        group.addParam( VG.Nodes.ParamList( data, "axis", "Grid Axis", 0, ["Dynamic", "XY", "XZ", "YZ"] ) );

        group.addParam( VG.Nodes.ParamDivider( data, "random", "Randomness" ) );

        group.addParam( VG.Nodes.ParamBoolean( data, "randomX", "X Pos", false ) );
        group.addParam( VG.Nodes.ParamBoolean( data, "randomY", "Y Pos", false ) );

        this.createDefaultProperties( data );
    }
};

VG.Nodes.availableNodes.set( "Shapes 2D.Grid", "NodeGrid2D" );

// ----------------------------------------------------------------- VG.Nodes.NodeShapes3D

VG.Nodes.NodeShapes3D = class extends VG.Nodes.Node
{
    constructor() {
        super();

        this.name="Shapes 3D";
        this.className="NodeShapes3D";

        this.boxD = `
            float boxDist_${this.token}( vec3 p, vec3 b, float r )
            {
                // return length(max(abs(p)-b,0.0))-r;
	            // vec3 dist = abs(p) - 0.5 * size;
	            // return max(dist.x, max(dist.y, dist.z));

                //vec3 d = abs(p) - b;
                //return min(max(d.x,max(d.y,d.z)),0.0) + length(max(d,0.0));

	            vec3 dist = abs(p) - 0.5 * b;
	            return max(dist.x, max(dist.y, dist.z));
            }
        `;

        // --- Outputs

        this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "dist", function( options ) {

/*
            let addVar = options.getVar( this, "dist", "float" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + `NodeShapes3D_${this.token}( pos, normal )` + ";\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + `  material.color = vec3( clamp( - ${addVar.name}, 0., 1.0 ) );\n}`;
                options.generatePreview( self, prevCode );
            }

            return `${addVar.name}`;*/

            return `NodeShapes3D_${this.token}`;

        }.bind( this ) ) );
    }

    getGlobalCode( data )
    {
        let shape = this.container.getParamValue( "shape" );
        let round = this.container.getParamValue( "round" ).toFixed(3);
        let scale = this.container.getParamValue( "scale" ).toFixed(3);
        let translate = this.container.getParam( "translate" ).toString();
        let rotate = this.container.getParamValue( "rotate" ).toFixed(3);
        let size= this.container.getParamValue( "size" );
        let repeat = this.container.getParam( "repeat" ).toString();

        let global = "";

        // --- Axis Code

        let self = this;
        function getAxisCode() {
            let axisParam = self.container.getParam( "axis" );
/*
            if ( axisParam.data.axis === 0 ) {
                return `
                    vec2 uv;
                    vec3 n = abs(normal);
                    if(n.x > 0.57735) {
                        uv = pos.yz;
                    } else if (n.y>0.57735){
                        uv = pos.xz;
                    }else{
                        uv = pos.xy;
                    }
                `;
            } else*/
                return `vec2 uv = pos.${axisParam.list[ axisParam.data.axis ].toLowerCase()};`;
        }

        // ---

        if ( shape === 0 ) {
            // --- Box
            global += this.boxD;
            global += `
                vec4 NodeShapes3D_${this.token}( in vec3 pos )
                {
                    vec4 rc = vec4( 0 );

                    vec3 c = ${repeat};
                    vec3 tp = mod( pos, c ) - 0.5 * c;

                    rc.x = boxDist_${this.token}( tp, vec3( ${size.x.toFixed(3)}, ${size.y.toFixed(3)}, ${size.z.toFixed(3)} ), ${round} );
                    return rc;
                }
            `;
        }

        console.log( global );

        return global;
    }

    createProperties( data )
    {
        this.container=VG.Nodes.ParamContainer( this );
        var group=this.container.addGroupByName( "basics", "Shapes 3D Settings" );

        group.addParam( VG.Nodes.ParamList( data, "shape", "Shape", 0, ["Cube", "Hex", "Sphere", "Triangle"] ) );
        group.addParam( VG.Nodes.ParamVector3( data, "size", "Size", 1.00, 1.00, 1.00, 0, 100, 2 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "round", "Rounding", 0.2, 0.001, 2.00, 0.1, 3 ) );
        group.addParam( VG.Nodes.ParamList( data, "axis", "Pattern Axis", 0, ["Dynamic", "XY", "XZ", "YZ"] ) );
        group.addParam( VG.Nodes.ParamDivider( data, "divider", "Transform" ) );
        group.addParam( VG.Nodes.ParamSlider( data, "scale", "Scale", 1, 0.001, 10.00, 0.1, 3 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "rotate", "Rotate", 0, 0.0, 359, 0.1, 2 ) );
        group.addParam( VG.Nodes.ParamVector2( data, "translate", "Translate", 0.00, 0.00, -100, 100, 2 ) );
        group.addParam( VG.Nodes.ParamVector3( data, "repeat", "Repeat", 0.00, 0.00, 0.00, 0, 100, 2 ) );
        // group.addParam( VG.Nodes.ParamNumber( data, "alternate", "Alternate", 0.00, 0, 100, 2 ) );

        this.createDefaultProperties( data );
    }
};

// VG.Nodes.availableNodes.set( "Shapes 3D.Shapes 3D", "NodeShapes3D" );

// ----------------------------------------------------------------- VG.Nodes.NodeShape3DMixer

VG.Nodes.NodeShape3DMixer = class extends VG.Nodes.Node
{
    constructor() {
        super();

        this.name="Mix - Shapes 3D";
        this.className="NodeShape3DMixer";

        // --- Inputs

        this.terminals = [];
        this.terminals[0] = VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "A" );
        this.terminals[1] = VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "B" );
        this.terminals[2] = VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "C" );
        this.terminals[3] = VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "D" );

        this.terminals.forEach( function( t ) { this.addInput( t ); }.bind( this ) );

        // --- Outputs

        this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "dist", function( options ) {

            let addVar = options.getVar( this, "dist", "float" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + `NodeShape3DMixer_${this.token}( pos )` + ";\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + `  material.color = vec3( clamp( ${addVar.name}, 0., 1.0 ) );\n}`;
                options.generatePreview( self, prevCode );
            }

            return `${addVar.name}`;
        }.bind( this ) ) );
    }

    getGlobalCode( data )
    {
        /*
        let shape = this.container.getParamValue( "shape" );
        let round = this.container.getParamValue( "round" ).toFixed(3);
        let scale = this.container.getParamValue( "scale" ).toFixed(3);
        let translate = this.container.getParam( "translate" ).toString();
        let rotate = this.container.getParamValue( "rotate" ).toFixed(3);
        let size= this.container.getParamValue( "size" );
        let repeat = this.container.getParam( "repeat" ).toString();*/

        let global = "";

        // --- Axis Code

        let self = this;
        function getAxisCode() {
            let axisParam = self.container.getParam( "axis" );
/*
            if ( axisParam.data.axis === 0 ) {
                return `
                    vec2 uv;
                    vec3 n = abs(normal);
                    if(n.x > 0.57735) {
                        uv = pos.yz;
                    } else if (n.y>0.57735){
                        uv = pos.xz;
                    }else{
                        uv = pos.xy;
                    }
                `;
            } else*/
                return `vec2 uv = pos.${axisParam.list[ axisParam.data.axis ].toLowerCase()};`;
        }

        // --- Distance Code, parse the inputs

        let distCode = '';

        for( let i = 0; i < 4; ++ i )
        {
            let t = this.terminals[i];

            if ( t.isConnected() ) {
                let funcName = t.first().onCall();
                distCode += `
                    temp = ${funcName}( pos - p ).x;
                    if ( temp < dist ) dist = temp;
                `;
            }
        }

        // ---

        global += `
            float NodeShape3DMixer_${this.token}( in vec3 p)
            {
                const float MAX_DEPTH = 50.0;
                float depth = 0.0;

                // p.z += 1.0;

                vec3 startPos = p - mapDir * 3.0;
                vec3 dir = mapDir;//vec3( 0, 0, -1 );//(startPos + vec3( 0, 0, 1 )) - startPos;

                for (int i = 0; i < 64; i++) {
                    vec3 pos = startPos + dir * depth;
                    // float dist = SceneDistance(pos);

                    float dist = MAX_DEPTH, temp;

                    // dist = length(max(abs(pos)-vec3( 0.5, 0.5, 0.5 ), 0.0) ) - 0.1;
                    ${distCode}

                    if (dist < 0.005) {
                        return depth;
                    }
                    depth += 0.99 * dist;
                    if (depth >= MAX_DEPTH) {
                        return MAX_DEPTH;
                    }
                }
                return MAX_DEPTH;
            }
        `;

        console.log( global );

        return global;
    }

    createProperties( data )
    {
        this.container=VG.Nodes.ParamContainer( this );
        var group=this.container.addGroupByName( "basics", "Shapes 3D Settings" );

        // group.addParam( VG.Nodes.ParamList( data, "shape", "Shape", 0, ["Cube", "Hex", "Sphere", "Triangle"] ) );
/*
        group.addParam( VG.Nodes.ParamList( data, "shape", "Shape", 0, ["Cube", "Hex", "Sphere", "Triangle"] ) );
        group.addParam( VG.Nodes.ParamVector3( data, "size", "Size", 1.00, 1.00, 0, 100, 2 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "round", "Rounding", 0.2, 0.001, 2.00, 0.1, 3 ) );
        group.addParam( VG.Nodes.ParamList( data, "axis", "Pattern Axis", 0, ["Dynamic", "XY", "XZ", "YZ"] ) );
        group.addParam( VG.Nodes.ParamDivider( data, "divider", "Transform" ) );
        group.addParam( VG.Nodes.ParamSlider( data, "scale", "Scale", 1, 0.001, 10.00, 0.1, 3 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "rotate", "Rotate", 0, 0.0, 359, 0.1, 2 ) );
        group.addParam( VG.Nodes.ParamVector2( data, "translate", "Translate", 0.00, 0.00, -100, 100, 2 ) );
        group.addParam( VG.Nodes.ParamVector2( data, "repeat", "Repeat", 0.00, 0.00, 0, 100, 2 ) );
        // group.addParam( VG.Nodes.ParamNumber( data, "alternate", "Alternate", 0.00, 0, 100, 2 ) );
*/
        this.createDefaultProperties( data );
    }
};

// VG.Nodes.availableNodes.set( "Shapes 3D.Mix - Shapes 3D", "NodeShape3DMixer" );

/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.NodeGradient3D --- Generator.Gradient3D

VG.Nodes.NodeGradient3D=function()
{
    if ( !(this instanceof VG.Nodes.NodeGradient3D ) ) return new VG.Nodes.NodeGradient3D();

    this.name="Gradient Noise";
    this.className="NodeGradient3D";
    this.modifiesGlobals=true;
	this.description = `<html><p>Gradient 3D noise. <a href=\"https://www.shadertoy.com/view/4dffRH">Based on a noise</a> by <a href=\"https://www.shadertoy.com/user/iq\">Inigo Quilez</a>. Released under the MIT license.</p>
        <p>"normal" returns the analytic derivative of the gradient function. You can optionally supply an alternative hash function as input.</p></html>
     `;

    VG.Nodes.Node.call( this );

    this.global=`
// return value noise (in x) and its derivatives (in yzw)
vec4 NodeGradient3D_noised_${this.token}( in vec3 x )
{
    x *= <! SCALE VALUE !>;
    // x += <! OFFSET VALUE !>;

    // grid
    vec3 p = floor(x);
    vec3 w = fract(x);

    #if 1
    // quintic interpolant
    vec3 u = w*w*w*(w*(w*6.0-15.0)+10.0);
    vec3 du = 30.0*w*w*(w*(w-2.0)+1.0);
    #else
    // cubic interpolant
    vec3 u = w*w*(3.0-2.0*w);
    vec3 du = 6.0*w*(1.0-w);
    #endif

    // gradients
    vec3 ga = <! HASH !>( p+vec3(0.0,0.0,0.0) )<! HASH DOMAIN !>;
    vec3 gb = <! HASH !>( p+vec3(1.0,0.0,0.0) )<! HASH DOMAIN !>;
    vec3 gc = <! HASH !>( p+vec3(0.0,1.0,0.0) )<! HASH DOMAIN !>;
    vec3 gd = <! HASH !>( p+vec3(1.0,1.0,0.0) )<! HASH DOMAIN !>;
    vec3 ge = <! HASH !>( p+vec3(0.0,0.0,1.0) )<! HASH DOMAIN !>;
	vec3 gf = <! HASH !>( p+vec3(1.0,0.0,1.0) )<! HASH DOMAIN !>;
    vec3 gg = <! HASH !>( p+vec3(0.0,1.0,1.0) )<! HASH DOMAIN !>;
    vec3 gh = <! HASH !>( p+vec3(1.0,1.0,1.0) )<! HASH DOMAIN !>;

    // projections
    float va = dot( ga, w-vec3(0.0,0.0,0.0) );
    float vb = dot( gb, w-vec3(1.0,0.0,0.0) );
    float vc = dot( gc, w-vec3(0.0,1.0,0.0) );
    float vd = dot( gd, w-vec3(1.0,1.0,0.0) );
    float ve = dot( ge, w-vec3(0.0,0.0,1.0) );
    float vf = dot( gf, w-vec3(1.0,0.0,1.0) );
    float vg = dot( gg, w-vec3(0.0,1.0,1.0) );
    float vh = dot( gh, w-vec3(1.0,1.0,1.0) );

    // interpolations
    return vec4( va + u.x*(vb-va) + u.y*(vc-va) + u.z*(ve-va) + u.x*u.y*(va-vb-vc+vd) + u.y*u.z*(va-vc-ve+vg) + u.z*u.x*(va-vb-ve+vf) + (-va+vb+vc-vd+ve-vf-vg+vh)*u.x*u.y*u.z,    // value
                 ga + u.x*(gb-ga) + u.y*(gc-ga) + u.z*(ge-ga) + u.x*u.y*(ga-gb-gc+gd) + u.y*u.z*(ga-gc-ge+gg) + u.z*u.x*(ga-gb-ge+gf) + (-ga+gb+gc-gd+ge-gf-gg+gh)*u.x*u.y*u.z +   // derivatives
                 du * (vec3(vb,vc,ve) - va + u.yzx*vec3(va-vb-vc+vd,va-vc-ve+vg,va-vb-ve+vf) + u.zxy*vec3(va-vb-ve+vf,va-vb-vc+vd,va-vc-ve+vg) + u.yzx*u.zxy*(-va+vb+vc-vd+ve-vf-vg+vh) ));
}
    `;

    this.hash = `
        vec3 NodeGradient3D_hash_${this.token}(in vec3 p)
        {
            float time = 0.0;

            p = vec3( dot(p,vec3(127.1, 311.7, 74.7)),
                    dot(p,vec3(269.5, 183.3, 246.1)),
                    dot(p,vec3(113.5, 271.9, 124.6)));

            p = fract(sin(p)*43758.5453123)*2. - 1.;

            float th = time * 2.;
            vec2 a = sin(vec2(1.5707963, 0) + th);

            mat2  m = mat2(a, -a.y, a.x); //in general use 3d rotation
            p.xy = m * p.xy;//rotate gradient vector
            //p.yz = m * p.yz;//rotate gradient vector
            //p.zx = m * p.zx;//rotate gradient vector
            return p;
        }
    `;

    // --- Terminals

    this.hashTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "hash" ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "noise", function( options ) {
        let noiseVar = options.getVar( this, "", "vec4" );
        if ( !noiseVar.exists || options.override )
            options.code += "  " + noiseVar.code + ` = NodeGradient3D_noised_${this.token}( pos );\n`;

        let floatVar = options.getVar( this, "float", "float" );
        if ( !floatVar.exists || options.override )
            options.code += "  " + floatVar.code + " = " + noiseVar.name + ".x;\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + floatVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return floatVar.name;
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "normal", function( options ) {
        let noiseVar = options.getVar( this, "", "vec4" );
        if ( !noiseVar.exists )
            options.code += "  " + noiseVar.code + ` = NodeGradient3D_noised_${this.token}( pos );\n`;

        let normalVar = options.getVar( this, "normal", "vec3" );
        if ( !normalVar.exists )
            options.code += "  " + normalVar.code + " = " + noiseVar.name + ".yzw;\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code;

            let floatVar = options.getVar( this, "float", "float" );
            if ( !floatVar.exists || options.override )
                prevCode += "  " + floatVar.code + " = " + noiseVar.name + ".x;\n";

                prevCode += "  material.color = clamp( pow( vec3(" + floatVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return normalVar.name;
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "function", function( options ) {

        if ( !this.rt && options.generatePreview ) {
            let prevCode = options.globalCode + options.code + `  material.color = clamp( pow( vec3( NodeGradient3D_noised_${this.token}(pos).x ), vec3( 0.4545 ) ), 0.0, 1.0 );\n}`;
            options.generatePreview( this, prevCode );
        }
        return `NodeGradient3D_noised_${this.token}`;
    }.bind( this ) ) );
};

VG.Nodes.NodeGradient3D.prototype=VG.Nodes.Node();

VG.Nodes.NodeGradient3D.prototype.getGlobalCode=function( data )
{
    let global = this.global;

    let scale = this.container.getParamValue( "scaleGlobal" ).toFixed(2) + " * " + this.container.getParam( "scale" ).toString();
    global = global.replace( /<! SCALE VALUE !>/g, scale );

    if ( !this.hashTerminal.isConnected() ) {
        global = global.replace( /<! HASH !>/g, `NodeGradient3D_hash_${this.token}` );
        global = global.replace( /<! HASH DOMAIN !>/g, "" );
        global = this.hash + global;
    } else {
        let funcName = this.hashTerminal.first().onCall( {} );
        global = global.replace( /<! HASH !>/g, funcName );
        global = global.replace( /<! HASH DOMAIN !>/g, ".xyz" );
    }

    return global;
};

VG.Nodes.NodeGradient3D.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Gradient 3D Noise" );

    group.addParam( VG.Nodes.ParamSlider( data, "scaleGlobal", "Scale", 1, 0.001, 100.00, 0.5, 3, 3 ) );
    group.addParam( VG.Nodes.ParamVector3( data, "scale", "Scale", 1.00, 1.00, 1.00, 0.001, 50.00 ) );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Noise.Gradient Noise", "NodeGradient3D" );

// ----------------------------------------------------------------- VG.Nodes.NodeVoronoi3D --- Noise.NodeVoronoi3D

VG.Nodes.NodeVoronoi3D=function()
{
    if ( !(this instanceof VG.Nodes.NodeVoronoi3D ) ) return new VG.Nodes.NodeVoronoi3D();

    this.name="Voronoi Noise";
    this.className="NodeVoronoi3D";
    this.modifiesGlobals=true;
	this.description = `<html><p>Voronoi 3D noise. <a href=\"https://www.shadertoy.com/view/ldl3Dl">Based on a noise</a> by <a href=\"https://www.shadertoy.com/user/iq\">Inigo Quilez</a>. Released under the MIT license.</p>
        <p>"noise1" returns the closest distance to a cell, "noise2" the second closest and id the id of the cell. You can optionally supply an alternative hash function as input.</p> </html>
 `;

    VG.Nodes.Node.call( this );

    this.global=`
        // returns closest, second closest, and cell id
        vec4 NodeVoronoi3D_${this.token}( in vec3 x )
        {
            x *= <! SCALE VALUE !>;

            vec3 p = floor( x );
            vec3 f = fract( x );

            float id = 0.0;
            vec2 res = vec2( 100.0 );
            for( int k=-1; k<=1; k++ )
            for( int j=-1; j<=1; j++ )
            for( int i=-1; i<=1; i++ )
            {
                vec3 b = vec3( float(i), float(j), float(k) );
                vec3 r = vec3( b ) - f + <! HASH !>( p + b )<! HASH DOMAIN !>;
                float d = dot( r, r );

                if( d < res.x )
                {
                    id = dot( p+b, vec3(1.0,57.0,113.0 ) );
                    res = vec2( d, res.x );
                }
                else if( d < res.y )
                {
                    res.y = d;
                }
            }

            return vec4( sqrt( res ), abs(id), 0 );
        }
    `;

    this.hash = `
        vec3 NodeVoronoi3D_hash_${this.token}(in vec3 x)
        {
            x = vec3( dot(x,vec3(127.1,311.7, 74.7)),
                    dot(x,vec3(269.5,183.3,246.1)),
                    dot(x,vec3(113.5,271.9,124.6)));

            return fract(sin(x)*43758.5453123);
        }
    `;

    // --- Terminals

    this.hashTerminal=this.addInput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "hash" ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "noise 1", function( options ) {
        let noiseVar = options.getVar( this, "", "vec4" );
        if ( !noiseVar.exists || options.override )
            options.code += "  " + noiseVar.code + ` = NodeVoronoi3D_${this.token}( pos );\n`;

        let floatVar = options.getVar( this, "float1", "float" );
        if ( !floatVar.exists || options.override )
            options.code += "  " + floatVar.code + " = " + noiseVar.name + ".x;\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + floatVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return floatVar.name;
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "noise 2", function( options ) {
        let noiseVar = options.getVar( this, "", "vec4" );
        if ( !noiseVar.exists || options.override )
            options.code += "  " + noiseVar.code + ` = NodeVoronoi3D_${this.token}( pos );\n`;

        let floatVar = options.getVar( this, "float2", "float" );
        if ( !floatVar.exists || options.override )
            options.code += "  " + floatVar.code + " = " + noiseVar.name + ".y;\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + floatVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return floatVar.name;
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "id", function( options ) {
        let noiseVar = options.getVar( this, "", "vec4" );
        if ( !noiseVar.exists || options.override )
            options.code += "  " + noiseVar.code + ` = NodeVoronoi3D_${this.token}( pos );\n`;

        let floatVar = options.getVar( this, "float2", "float" );
        if ( !floatVar.exists || options.override )
            options.code += "  " + floatVar.code + " = " + noiseVar.name + ".z;\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + floatVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return floatVar.name;
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "function", function( options ) {

        if ( !this.rt && options.generatePreview ) {
            let prevCode = options.globalCode + options.code + `  material.color = clamp( pow( vec3( NodeVoronoi3D_${this.token}(pos).x ), vec3( 0.4545 ) ), 0.0, 1.0 );\n}`;
            options.generatePreview( this, prevCode );
        }
        return `NodeVoronoi3D_${this.token}`;
    }.bind( this ) ) );
};

VG.Nodes.NodeVoronoi3D.prototype=VG.Nodes.Node();

VG.Nodes.NodeVoronoi3D.prototype.getGlobalCode=function( data )
{
    let global = this.global;

    let scale = this.container.getParamValue( "scaleGlobal" ).toFixed(2) + " * " + this.container.getParam( "scale" ).toString();
    global = global.replace( /<! SCALE VALUE !>/g, scale );

    if ( !this.hashTerminal.isConnected() ) {
        global = global.replace( /<! HASH !>/g, `NodeVoronoi3D_hash_${this.token}` );
        global = global.replace( /<! HASH DOMAIN !>/g, "" );
        global = this.hash + global;
    } else {
        let funcName = this.hashTerminal.first().onCall( {} );
        global = global.replace( /<! HASH !>/g, funcName );
        global = global.replace( /<! HASH DOMAIN !>/g, ".xyz" );
    }

    // console.log( global );

    return global;
};

VG.Nodes.NodeVoronoi3D.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Gradient 3D Noise" );

    group.addParam( VG.Nodes.ParamSlider( data, "scaleGlobal", "Scale", 1, 0.001, 100.00, 0.5, 3, 3 ) );
    group.addParam( VG.Nodes.ParamVector3( data, "scale", "Scale", 1.00, 1.00, 1.00, 0.001, 50.00 ) );

    // group=this.container.addGroupByName( "about", "About" );

    // group.addParam( VG.Nodes.ParamVector3( data, "scale", "Scale", 1.00, 1.00, 1.00, 0.001, 50.00 ) );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Noise.Voronoi Noise", "NodeVoronoi3D" );

// ----------------------------------------------------------------- VG.Nodes.NodeTurbulence --- Operator.NodeTurbulence

VG.Nodes.NodeTurbulence=function()
{
    if ( !(this instanceof VG.Nodes.NodeTurbulence ) ) return new VG.Nodes.NodeTurbulence();

    this.name="Turbulence";
    this.className="NodeTurbulence";
    this.modifiesGlobals=true;
	this.description = `<html><p>Turbulence or FBM.</p>
        <p>Requires a noise function as input. The "normal" output will only be valid when the input noise has a "normal" output terminal.</p></html>
     `;

    VG.Nodes.Node.call( this );

    this.global=`
/*
        vec4 NodeTurbulence(in vec3 p)
        {
            // Three control factors. Lacunarity and gain are set to common defaults.
            const int layers = 5; //Noise layers. Also called octaves.
            const float lacunarity = 2.; // Frequency change factor. Controls the gaps.
            const float gain = .5; // Amplitue change factor. Controls granularity.

            float res = 0.; // Final result.
            float amp = 1.; // Initial amplitude.
            float tot = 0.; // Total amplitude. Used to normalize the final value.

            // Adding the layers of noise with varying frequencies and amplitudes.
            for(int i=0; i<layers; i++){

                res += <! NOISE FUNC !>(p).x*amp;  // Add noise layers at various amplitudes.
                p *= lacunarity; // Change the layer frequency.
                tot += amp; // Add the amplitude.
                amp *= gain; // Change the amplitude.

            }

            return vec4( res/tot ); // Normalize and return. Range [0, 1]
        }
*/

        vec4 NodeTurbulence_${this.token}(in vec3 p)
        {
            const float scale  = <! SCALE VALUE !>;

            float a = 0.0;
            float b = 0.5;
            float f = 1.0;
            vec3  d = vec3(0.0);
            for( int i=0; i<8; i++ )
            {
                vec4 n = <! NOISE FUNC !>(f*p*scale);
                a += b*n.x;           // accumulate values
                d += b*n.yzw*f*scale; // accumulate derivatives
                b *= 0.5;             // amplitude decrease
                f *= 1.8;             // frequency increase
            }

            return vec4( a, d );
        }
    `;

    // --- Terminals

    let noiseTerminal=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "noise" );
    this.noiseTerminal = noiseTerminal;
    this.addInput( noiseTerminal );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "turbulence", function( options ) {

        if ( noiseTerminal.isConnected() ) {

            let funcName = noiseTerminal.first().onCall( options );

            let noiseVar = options.getVar( this, "", "vec4" );
            if ( !noiseVar.exists || options.override )
                options.code += "  " + noiseVar.code + ` = NodeTurbulence_${this.token}( pos );\n`;

            let floatVar = options.getVar( this, "float", "float" );
            if ( !floatVar.exists || options.override )
                options.code += "  " + floatVar.code + " = " + noiseVar.name + ".x;\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + `  material.color = clamp( pow( vec3( NodeTurbulence_${this.token}(pos).x ), vec3( 0.4545 ) ), 0.0, 1.0 );\n}`;
                options.generatePreview( this, prevCode );
            }

            return floatVar.name;
        } else return "0.0";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "normal", function( options ) {

        if ( noiseTerminal.isConnected() ) {

            let funcName = noiseTerminal.first().onCall( options );

            let noiseVar = options.getVar( this, "", "vec4" );
            if ( !noiseVar.exists || options.override )
                options.code += "  " + noiseVar.code + ` = NodeTurbulence_${this.token}( pos );\n`;

            let normalVar = options.getVar( this, "normal", "vec3" );
            if ( !normalVar.exists || options.override )
                options.code += "  " + normalVar.code + " = " + noiseVar.name + ".yzw;\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + `  material.color = clamp( pow( vec3( NodeTurbulence_${this.token}(pos).x ), vec3( 0.4545 ) ), 0.0, 1.0 );\n}`;
                options.generatePreview( this, prevCode );
            }

            return normalVar.name;
        } else return "vec3(0)";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector4, "t + n", function( options ) {

        if ( noiseTerminal.isConnected() ) {

            let funcName = noiseTerminal.first().onCall( options );

            let noiseVar = options.getVar( this, "", "vec4" );
            if ( !noiseVar.exists || options.override )
                options.code += "  " + noiseVar.code + ` = NodeTurbulence_${this.token}( pos );\n`;

            let tnVar = options.getVar( this, "t_n", "vec4" );
            if ( !tnVar.exists || options.override )
                options.code += "  " + tnVar.code + " = " + noiseVar.name + ";\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + `  material.color = clamp( pow( vec3( NodeTurbulence_${this.token}(pos).x ), vec3( 0.4545 ) ), 0.0, 1.0 );\n}`;
                options.generatePreview( this, prevCode );
            }

            return tnVar.name;
        } else return "vec4(0)";

    }.bind( this ) ) );

/*
    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "function", function( options ) {
        return `NodeTurbulence_${this.token}`;
    }.bind( this ) ) );
*/
};

VG.Nodes.NodeTurbulence.prototype=VG.Nodes.Node();

VG.Nodes.NodeTurbulence.prototype.getGlobalCode=function( data )
{
    let funcName = "vec3";
    if ( this.noiseTerminal.isConnected() ) {
        funcName = this.noiseTerminal.first().onCall( {} );
    } else return "";

    let global = this.global;
    global = global.replace( /<! NOISE FUNC !>/g, funcName );

    let scaleGlobal = this.container.getParamValue( "scaleGlobal" );
    global = global.replace( /<! SCALE VALUE !>/g, scaleGlobal.toFixed( 2 ) );

    return global;
};

VG.Nodes.NodeTurbulence.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );

    let group=this.container.addGroupByName( "basics", "Turbulence" );

    group.addParam( VG.Nodes.ParamSlider( data, "scaleGlobal", "Scale", 1, 0.001, 100.00, 0.5, 3, 3 ) );

/*
    var group=this.container.addGroupByName( "basics", "Simplex3D - Basics" );

    group.addParam( VG.Nodes.ParamList( data, "output", "Output", 1, ["RGB", "Grayscale"] ) );

    group.addParam( VG.Nodes.ParamSlider( data, "amplitude", "Amplitude", 1, -50, 50, 0.5, 3 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "offset", "Offset", 0.5, -50, 50, 0.5, 3 ) );

    group=this.container.addGroupByName( "scale", "Scale" );
    group.addParam( VG.Nodes.ParamSlider( data, "scaleGlobal", "Scale", 1, 0.001, 50.00, 0.5, 3 ) );
    group.addParam( VG.Nodes.ParamVector3( data, "scale", "Scale", 10.00, 10.00, 10.00, 0.001, 50.00 ) );

    group=this.container.addGroupByName( "fractal", "Fractal" );
    group.addParam( VG.Nodes.ParamBoolean( data, "fractal", "Enable", false ) );
    group.addParam( VG.Nodes.ParamSlider( data, "octaves", "Octaves", 3.0, 1.00, 15.00, 0.5, 3 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "increment", "Increment", 0.5, 0.01, 2.00, 0.1, 3 ) );
    group.addParam( VG.Nodes.ParamSlider( data, "lacunarity", "Lacunarity", 2.0, 0.01, 5.00, 0.5, 3 ) );
*/

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Noise.Turbulence", "NodeTurbulence" );

// ----------------------------------------------------------------- VG.Nodes.NodeHash1 --- Hash.NodeHash1

VG.Nodes.NodeHash1=function()
{
    if ( !(this instanceof VG.Nodes.NodeHash1 ) ) return new VG.Nodes.NodeHash1();

    this.name="Hash 1 - Simple";
    this.className="NodeHash1";

    VG.Nodes.Node.call( this );

    this.global=`
        vec4 NodeHash1( vec3 p )
        {
            p = vec3( dot(p,vec3(127.1,311.7, 74.7)),
                    dot(p,vec3(269.5,183.3,246.1)),
                    dot(p,vec3(113.5,271.9,124.6)));

            return vec4( -1.0 + 2.0*fract(sin(p)*43758.5453123), 0 );
        }
    `;

    // --- Terminals

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "function", function( options ) {

        if ( !this.rt && options.generatePreview ) {
            let prevCode = options.globalCode + options.code + `  material.color = clamp( pow( NodeHash1( pos ).xyz, vec3( 0.4545 ) ), 0.0, 1.0 );\n}`;
            options.generatePreview( this, prevCode );
        }
        return "NodeHash1";
    }.bind( this ) ) );
};

VG.Nodes.NodeHash1.prototype=VG.Nodes.Node();

VG.Nodes.NodeHash1.prototype.getGlobalCode=function( data )
{
    let global = this.global;
    return global;
};

VG.Nodes.NodeHash1.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Hash 1" );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Noise.Hash 1 Simple", "NodeHash1" );

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// ----------------------------------------------------------------- VG.Nodes.NodeArithmeticMix

VG.Nodes.NodeMixColor=function()
{
    if ( !(this instanceof VG.Nodes.NodeMixColor ) ) return new VG.Nodes.NodeMixColor();

    this.name="Mix - Color";
    this.className="NodeMixColor";

    VG.Nodes.Node.call( this );

    // --- Terminals

    var mixTerminal=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "mix" );
    this.addInput( mixTerminal );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "color", function( options ) {

        if ( mixTerminal.isConnected() )
        {
            let col1=this.container.getParam( "color1" );
            let col2=this.container.getParam( "color2" );

            let varName = mixTerminal.first().onCall( options );

            let colVar = options.getVar( this, "color", "vec3" );
            if ( !colVar.exists || options.override )
                options.code += "  " + colVar.code + " = mix( " + col1.toString() + ".xyz, " + col2.toString() + ".xyz, " + varName + " );\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + colVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
                options.generatePreview( this, prevCode );
            }

            return colVar.name;
        } else return "vec3 (0)";

    }.bind( this ) ) );
};

VG.Nodes.NodeMixColor.prototype=VG.Nodes.Node();

VG.Nodes.NodeMixColor.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Mix - Color" );

    group.addParam( VG.Nodes.ParamColor( data, "color1", "Color #1", VG.Core.Color( "#000000" ) ) );
    group.addParam( VG.Nodes.ParamColor( data, "color2", "Color #2", VG.Core.Color( "#ffffff" ) ) );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Operator.Mix - Color", "NodeMixColor" );

// ----------------------------------------------------------------- VG.Nodes.NodeNoiseNormalBreaker

VG.Nodes.NodeNoiseNormalBreaker=function()
{
    if ( !(this instanceof VG.Nodes.NodeNoiseNormalBreaker ) ) return new VG.Nodes.NodeNoiseNormalBreaker();

    this.name="Noise - Normal Breaker";
    this.className="NodeNoiseNormalBreaker";
    this.noPreview=true;

    VG.Nodes.Node.call( this );

    // --- Terminals

    let terminal=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector4, "vec4" );
    this.addInput( terminal );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "float", function( options ) {

        if ( terminal.isConnected() )
        {
            let varName = terminal.first().onCall( options );

            let ntVar = options.getVar( this, "float", "float" );
            if ( !ntVar.exists || options.override )
                options.code += "  " + ntVar.code + " = " + varName + ".x;\n";

            return ntVar.name;
        } else return "0.0";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "vec3", function( options ) {

        if ( terminal.isConnected() )
        {
            let varName = terminal.first().onCall( options );

            let ntVar = options.getVar( this, "vec3", "vec3" );
            if ( !ntVar.exists || options.override )
                options.code += "  " + ntVar.code + " = " + varName + ".yzw;\n";

            return ntVar.name;
        } else return "vec3(0)";

    }.bind( this ) ) );
};

VG.Nodes.NodeNoiseNormalBreaker.prototype=VG.Nodes.Node();

VG.Nodes.NodeNoiseNormalBreaker.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Noise / Normal Breaker" );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Breaker.Noise - Normal Breaker", "NodeNoiseNormalBreaker" );

// ----------------------------------------------------------------- VG.Nodes.NodePosition

VG.Nodes.NodePosition=function()
{
    if ( !(this instanceof VG.Nodes.NodePosition ) ) return new VG.Nodes.NodePosition();

    this.name="Position";
    this.className="NodePosition";

    VG.Nodes.Node.call( this );

    let self = this;
    function doPreview( options ) {
        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( vec3( pos.yxz ), 0.0, 1.0 );\n}";
            options.generatePreview( self, prevCode );
        }
    }

    // --- Terminals

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "x", function( options ) {

        doPreview( options );
        return "pos.x";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "y", function( options ) {

        doPreview( options );
        return "pos.y";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "z", function( options ) {

        doPreview( options );
        return "pos.z";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector2, "vec2", function( options ) {

        doPreview( options );
        return "(pos.xy)";

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "vec3", function( options ) {

        doPreview( options );
        return "(pos)";

    }.bind( this ) ) );
};

VG.Nodes.NodePosition.prototype=VG.Nodes.Node();

VG.Nodes.NodePosition.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Generator.Position", "NodePosition" );

// ----------------------------------------------------------------- VG.Nodes.NodeOpSingleInputAtom

VG.Nodes.NodeOpSingleInputAtom=function()
{
    if ( !(this instanceof VG.Nodes.NodeOpSingleInputAtom ) ) return new VG.Nodes.NodeOpSingleInputAtom();

    VG.Nodes.Node.call( this );

    // --- Terminals

    let input=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Universal, "A" );
    this.addInput( input );

    let self = this;
    function getInput( options, outType )
    {
        let out = "";

        if ( input.isConnected() ) {
            let varName = input.first().onCall( options );
            let inType = input.getValueType().count;

            out += self.preOp( inType, outType );

            if ( outType === 1 ) {
                if ( inType === 1 ) out += varName;
                else out += varName + ".x";
            } else if ( outType === 2 ) {
                if ( inType === 1 ) out += "vec2( " + varName + " )";
                else if ( inType === 2 ) out += varName;
                else out += varName + ".xy";
            } else if ( outType === 3 ) {
                if ( inType === 1 ) out += "vec3( " + varName + " )";
                else if ( inType === 2 ) out += "vec3( " + varName + ", 0 )";
                else if ( inType === 3 ) out += varName;
                if ( inType === 4 ) out += varName + ".xyz";
            } else if ( outType === 4 ) {
                if ( inType === 1 ) out += "vec4( " + varName + " )";
                else if ( inType === 2 ) out += "vec4( " + varName + ", 0, 0 )";
                else if ( inType === 3 ) out += "vec4( " + varName + ", 0 )";
                if ( inType === 4 ) out += varName;
            }

            out += self.postOp( inType, outType );
            return out;
        }

        return out;
    }

    function doPreview( varName, options ) {
        if ( !self.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + varName + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( self, prevCode );
        }
    }

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "float", function( options ) {
        if ( input.isConnected() ) {
            let varNames = getInput( options, 1 );

            let addVar = options.getVar( this, "float", "float" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + varNames + ";\n";

            doPreview( addVar.name, options );
            return addVar.name;
        } else return "0.0";
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector2, "vec2", function( options ) {
        if ( input.isConnected() ) {
            let varNames = getInput( options, 2 );

            let addVar = options.getVar( this, "vec2", "vec2" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + varNames + ";\n";

            doPreview( addVar.name, options );
            return addVar.name;
        } else return "vec2(0)";
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "vec3", function( options ) {
        if ( input.isConnected() ) {
            let varNames = getInput( options, 3 );

            let addVar = options.getVar( this, "vec3", "vec3" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + varNames + ";\n";

            doPreview( addVar.name, options );
            return addVar.name;
        } else return "vec3(0)";
    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector4, "vec4", function( options ) {
        if ( input.isConnected() ) {
            let varNames = getInput( options, 4 );

            let addVar = options.getVar( this, "vec4", "vec4" );
            if ( !addVar.exists || options.override )
                options.code += "  " + addVar.code + " = " + varNames + ";\n";

            doPreview( addVar.name, options );
            return addVar.name;
        } else return "vec4(0)";
    }.bind( this ) ) );
};

VG.Nodes.NodeOpSingleInputAtom.prototype=VG.Nodes.Node();

// ----------------------------------------------------------------- VG.Nodes.NodeSin

VG.Nodes.NodeSin = class extends VG.Nodes.NodeOpSingleInputAtom
{
    constructor() {
        super();
        this.name = "Sin";
        this.className = "NodeSin";
    }

    preOp() {
        let abs = this.container.getParamValue( "abs" );
        let out = "";

        if ( abs ) out+= "abs(";
        out += "sin(";

        return out;
    }

    postOp() {
        let abs = this.container.getParamValue( "abs" );
        let out = "";

        out += ")";
        if ( abs ) out+= ")";

        return out;
    }

    createProperties( data ) {
        this.container=VG.Nodes.ParamContainer( this );
        var group=this.container.addGroupByName( "basics", "Sin" );

        group.addParam( VG.Nodes.ParamBoolean( data, "abs", "Abs", false ) );

        this.createDefaultProperties( data );
    }
};

VG.Nodes.availableNodes.set( "Operator.Sin", "NodeSin" );

// ----------------------------------------------------------------- VG.Nodes.NodeOneMins

VG.Nodes.NodeOneMinus = class extends VG.Nodes.NodeOpSingleInputAtom
{
    constructor() {
        super();
        this.name = "OneMinus";
        this.className = "NodeOneMinus";
    }

    preOp() {
        let out = "";
        out += "1.0 - ";
        return out;
    }

    postOp() {
        return "";
    }

    createProperties( data ) {
        this.container = VG.Nodes.ParamContainer( this );
        this.createDefaultProperties( data );
    }
};

VG.Nodes.availableNodes.set( "Operator.One Minus", "NodeOneMinus" );

// ----------------------------------------------------------------- VG.Nodes.NodeScale

VG.Nodes.NodeScale = class extends VG.Nodes.NodeOpSingleInputAtom
{
    constructor() {
        super();
        this.name = "Scale";
        this.className = "NodeScale";
    }

    preOp() {
        let out = "";
        out += `${this.container.getParam( "scale" ).toString()} * `;
        return out;
    }

    postOp() {
        return "";
    }

    createProperties( data ) {
        this.container = VG.Nodes.ParamContainer( this );
        let group=this.container.addGroupByName( "basics", "Scale" );
        group.addParam( VG.Nodes.ParamSlider( data, "scale", "Scale", 1.0, 0, 10, 0.01, 3 ) );
        this.createDefaultProperties( data );
    }
};

VG.Nodes.availableNodes.set( "Operator.Scale", "NodeScale" );

// ----------------------------------------------------------------- VG.Nodes.NodeClamp

VG.Nodes.NodeClamp = class extends VG.Nodes.NodeOpSingleInputAtom
{
    constructor() {
        super();
        this.name = "Clamp";
        this.className = "NodeClamp";
    }

    preOp() {
        let out = "clamp( ";
        return out;
    }

    postOp() {
        return `, ${this.container.getParam( "lower" ).toString()}, ${this.container.getParam( "upper" ).toString()} )`;
    }

    createProperties( data ) {
        this.container = VG.Nodes.ParamContainer( this );
        let group=this.container.addGroupByName( "basics", "Clamp" );

        group.addParam( VG.Nodes.ParamSlider( data, "lower", "Lower Border", 0.0, 0, 1, 0.01, 3 ) );
        group.addParam( VG.Nodes.ParamSlider( data, "upper", "Upper Border", 1.0, 0, 1, 0.01, 3 ) );

        this.createDefaultProperties( data );
    }
};

VG.Nodes.availableNodes.set( "Operator.Clamp", "NodeClamp" );

// ----------------------------------------------------------------- VG.Nodes.NodeOneMins

VG.Nodes.NodeOneMinus = class extends VG.Nodes.NodeOpSingleInputAtom
{
    constructor() {
        super();
        this.name = "OneMinus";
        this.className = "NodeOneMinus";
    }

    preOp() {
        let out = "";
        out += "1.0 - ";
        return out;
    }

    postOp() {
        return "";
    }

    createProperties( data ) {
        this.container = VG.Nodes.ParamContainer( this );
        this.createDefaultProperties( data );
    }
};

VG.Nodes.availableNodes.set( "Operator.One Minus", "NodeOneMinus" );

// ----------------------------------------------------------------- VG.Nodes.NodeArithmeticMix

VG.Nodes.NodeArithmetics=function()
{
    if ( !(this instanceof VG.Nodes.NodeArithmetics ) ) return new VG.Nodes.NodeArithmetics();

    this.name="Arithmetics";
    this.className="NodeArithmetics";

    VG.Nodes.Node.call( this );

    // --- Terminals

    let input1=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Universal, "A" );
    let input2=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Universal, "B" );
    let input3=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Universal, "C" );
    this.addInput( input1 );
    this.addInput( input2 );
    this.addInput( input3 );

    let inputs = [input1, input2, input3];
    let modeArray = ["+", "-", "*", "/"];

    this.modeList = ["Addition", "Subtraction", "Multiplication", "Division"];

    function collectInputs( modeText, options, outType )
    {
        let out = "";

        for ( let i = 0; i < 3; ++i ) {
            let input = inputs[i];

            if ( input.isConnected() ) {
                let varName = input.first().onCall( options );
                if ( out !== "" ) out += modeText;

                let inType = input.getValueType().count;

                if ( outType === 1 ) {
                    if ( inType === 1 ) out += varName;
                    else out += varName + ".x";
                } else if ( outType === 2 ) {
                    if ( inType === 1 ) out += "vec2( " + varName + " )";
                    else if ( inType === 2 ) out += varName;
                    else out += varName + ".xy";
                } else if ( outType === 3 ) {
                    if ( inType === 1 ) out += "vec3( " + varName + " )";
                    else if ( inType === 2 ) out += "vec3( " + varName + ", 0 )";
                    else if ( inType === 3 ) out += varName;
                    if ( inType === 4 ) out += varName + ".xyz";
                } else if ( outType === 4 ) {
                    if ( inType === 1 ) out += "vec4( " + varName + " )";
                    else if ( inType === 2 ) out += "vec4( " + varName + ", 0, 0 )";
                    else if ( inType === 3 ) out += "vec4( " + varName + ", 0 )";
                    if ( inType === 4 ) out += varName;
                }
            }
        }

        if ( out === "" ) {
            if ( outType === 1 ) out = "0.0";
            else if ( outType === 2 ) out = "vec2(0)";
            else if ( outType === 3 ) out = "vec3(0)";
            else if ( outType === 4 ) out = "vec4(0)";
        }

        return out;
    }

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "float", function( options ) {

        let mode=this.container.getParamValue( "mode" ); this.customTitle = this.modeList[mode];
        let modeText = modeArray[mode];

        let value1=this.container.getParamValue( "value1" );
        let value2=this.container.getParamValue( "value2" );

        let varNames = collectInputs( modeText, options, 1 );

        let addVar = options.getVar( this, "float", "float" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + varNames + ";\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + addVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return addVar.name;

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector2, "vec2", function( options ) {

        let mode=this.container.getParamValue( "mode" ); this.customTitle = this.modeList[mode];
        let modeText = modeArray[mode];

        let value1=this.container.getParamValue( "value1" );
        let value2=this.container.getParamValue( "value2" );

        let varNames = collectInputs( modeText, options, 2 );

        let addVar = options.getVar( this, "vec2", "vec2" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + varNames + ";\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + addVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return addVar.name;

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "vec3", function( options ) {

        let mode=this.container.getParamValue( "mode" ); this.customTitle = this.modeList[mode];
        let modeText = modeArray[mode];

        let value1=this.container.getParamValue( "value1" );
        let value2=this.container.getParamValue( "value2" );

        let varNames = collectInputs( modeText, options, 3 );

        let addVar = options.getVar( this, "vec3", "vec3" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + varNames + ";\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + addVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return addVar.name;

    }.bind( this ) ) );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector4, "vec4", function( options ) {

        let mode=this.container.getParamValue( "mode" ); this.customTitle = this.modeList[mode];
        let modeText = modeArray[mode];

        let value1=this.container.getParamValue( "value1" );
        let value2=this.container.getParamValue( "value2" );

        let varNames = collectInputs( modeText, options, 4 );

        let addVar = options.getVar( this, "vec4", "vec4" );
        if ( !addVar.exists || options.override )
            options.code += "  " + addVar.code + " = " + varNames + ";\n";

        if ( !this.rt ) {
            let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + addVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
            options.generatePreview( this, prevCode );
        }

        return addVar.name;

    }.bind( this ) ) );
};

VG.Nodes.NodeArithmetics.prototype=VG.Nodes.Node();

VG.Nodes.NodeArithmetics.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    let group=this.container.addGroupByName( "basics", "Arithmetics" );

    group.addParam( VG.Nodes.ParamList( data, "mode", "Mode", 0, this.modeList ) );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Operator.Arithmetics", "NodeArithmetics" );

// ----------------------------------------------------------------- VG.Nodes.NodeLuma

VG.Nodes.NodeLuma=function()
{
    if ( !(this instanceof VG.Nodes.NodeLuma ) ) return new VG.Nodes.NodeLuma();

    this.name="Luma";
    this.className="NodeLuma";

    VG.Nodes.Node.call( this );

    // --- Terminals

    var colorTerminal=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector4, "color" );
    this.addInput( colorTerminal );

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Float, "luma", function( options ) {

        var mode=this.container.getParamValue( "mode" );

        var rc1VarName=options.allocVec4Var();

        if ( colorTerminal.isConnected() )
        {
            colorTerminal.first().onCall( options );
            options.code += "  " + rc1VarName + " = valVec4;\n";
        } else options.code += "  " + rc1VarName + " = vec4( 0, 0, 0, 1 );\n";

        if ( mode === 0 )
        {
            options.code+="  valFloat = " + rc1VarName + ".x * 0.2126 + " + rc1VarName + ".y * 0.7152 + " + rc1VarName + ".z * 0.0722;\n";
        } else
        if ( mode === 1 )
        {
            options.code+="  valFloat = " + rc1VarName + ".x * 0.299 + " + rc1VarName + ".y * 0.587 + " + rc1VarName + ".z * 0.114;\n";
        } else
        if ( mode === 2 )
        {
            options.code+="  valFloat = 0.0;\n";
        }

        options.freeVec4Var( rc1VarName );

    }.bind( this ) ) );

};

VG.Nodes.NodeLuma.prototype=VG.Nodes.Node();

VG.Nodes.NodeLuma.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Luma - Basics" );

    group.addParam( VG.Nodes.ParamList( data, "mode", "Mode", 0, ["Rec. 709", "Rec. 601"] ) );
/*
    group.addParam( VG.Nodes.ParamSlider( data, "weight", "Weight", 0.5, 0, 1, 0.01, 3 ) );

    var group=this.container.addGroupByName( "default", "Defaults" );

    group.addParam( VG.Nodes.ParamVector4( data, "value1", "Value 1", 0.00, 0.00, 0.00, 1, -1000000, 1000000 ) );
    group.addParam( VG.Nodes.ParamVector4( data, "value2", "Value 2", 0.00, 0.00, 0.00, 1, -1000000, 1000000 ) );
*/
};

// ---

// VG.Nodes.availableNodes.set( "Operators.Luma", "NodeLuma" );

/*
 * (C) Copyright 2014-2017 Markus Moenig <markusm@visualgraphics.tv>.
 *
 * This file is part of Visual Graphics.
 *
 * Visual Graphics is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Visual Graphics is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with Visual Graphics.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// ----------------------------------------------------------------- VG.Nodes.NodeArithmeticMix

VG.Nodes.NodeWoodGen=function()
{
    if ( !(this instanceof VG.Nodes.NodeWoodGen ) ) return new VG.Nodes.NodeWoodGen();

    this.name="Wood";
    this.className="NodeWoodGen";

    this.global = `
    float NodeWoodGen_repramp(float x) {
	    return pow(sin(x)*0.5+0.5, 8.0) + cos(x)*0.7 + 0.7;
    }
`;

    VG.Nodes.Node.call( this );

    // --- Terminals

    var noiseTerminal=VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Function, "noise" );
    this.addInput( noiseTerminal );

    let self = this;
    function getAxis() {
        let axisParam = self.container.getParam( "axis" );
        return axisParam.list[ axisParam.data.axis ].toLowerCase();
    }

    this.addOutput( VG.Nodes.Terminal( VG.Nodes.Terminal.Type.Vector3, "color", function( options ) {

        if ( noiseTerminal.isConnected() )
        {
            let col1 = this.container.getParam( "color1" );
            let col2 = this.container.getParam( "color2" );

            let ringsVar = options.getVar( this, "rings", "float" );

            let funcName = noiseTerminal.first().onCall( {} );

            // float rings = repramp(length(pos.xz + vec2(NoiseGen(pos*vec3(8.0, 1.5, 8.0)), NoiseGen(-pos*vec3(8.0, 1.5, 8.0)+4.5678))*0.05)*64.0) / 1.8;

            options.code += `  ${ringsVar.code} = NodeWoodGen_repramp(length(pos.${getAxis()} + vec2(${funcName}(pos*vec3(8.0, 1.5, 8.0)).x, ${funcName}(-pos*vec3(8.0, 1.5, 8.0)+4.5678).x)*0.05)*64.0) / 1.8;` + "\n";
            options.code += `  ${ringsVar.name} -= ${funcName}(pos * 1.0).x*0.75;` + "\n";

            let texColorVar = options.getVar( this, "texColor", "vec3" );
            options.code += `  ${texColorVar.code} = mix( ${col1.toString()}.xyz, ${col2.toString()}.xyz, ${ringsVar.name} );` + "\n";
            options.code += `  ${texColorVar.name} = max( vec3( 0.0 ), ${texColorVar.name} );` + "\n";

            let roughVar = options.getVar( this, "rough", "float" );

            options.code += `  ${roughVar.code} = ${funcName}(pos*64.0*vec3(1.0, 0.2, 1.0)).x*0.1+0.9;` + "\n";
            options.code += `  ${texColorVar.name} *= ${roughVar.name};` + "\n";
            options.code += `  ${texColorVar.name} = clamp( ${texColorVar.name}, 0., 1.);` + "\n";

            if ( !this.rt ) {
                let prevCode = options.globalCode + options.code + "  material.color = clamp( pow( vec3(" + texColorVar.name + "), vec3( 0.4545 ) ), 0.0, 1.0 );\n}";
                options.generatePreview( this, prevCode );
            }

            return texColorVar.name;
        } else return "vec3(0)";

    }.bind( this ) ) );
};

VG.Nodes.NodeWoodGen.prototype=VG.Nodes.Node();

VG.Nodes.NodeWoodGen.prototype.getGlobalCode=function( data )
{
    return this.global;
};

VG.Nodes.NodeWoodGen.prototype.createProperties=function( data )
{
    this.container=VG.Nodes.ParamContainer( this );
    var group=this.container.addGroupByName( "basics", "Mix - Color" );

    group.addParam( VG.Nodes.ParamColor( data, "color1", "Color #1", VG.Core.Color( "#492e12" ) ) );
    group.addParam( VG.Nodes.ParamColor( data, "color2", "Color #2", VG.Core.Color( "#664a21" ) ) );

    group.addParam( VG.Nodes.ParamList( data, "axis", "Pattern Axis", 0, ["XY", "XZ", "YZ"] ) );

    this.createDefaultProperties( data );
};

VG.Nodes.availableNodes.set( "Generator.Wood", "NodeWoodGen" );

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

 /** Material interface, derived classes must create a shader and
  *  optionally override the bind method
  *  @constructor */

VG.Render.Material = function()
{
    /** The shader object
     *  @member {VG.Shader} */
    this.shader = null;
};

/** Checks if the material has a valid shader, otherwise returns false
 *  @return {Bool} */

VG.Render.Material.prototype.isValid = function()
{
    return (this.shader);
};

/** Binds the shader, override for more complex binding */

VG.Render.Material.prototype.bind = function()
{
    if (this.shader) this.shader.bind();
};

/** Deleted the material */

VG.Render.Material.prototype.dispose = function()
{
	if (this.shader)
	{
		this.shader.dispose();
		this.shader = null;
	}
};

/** Sets a model-view matrix from a float array, the matrial(i.e. shader) must be binded before.
 *  @param {array} value - A float array (2x2, 3x3 or 4x4) : column major
 *  @param {bool} [false] transpose - If true transposes the matrix
 */

VG.Render.Material.prototype.setModelViewMatrix = function(matrix, transpose)
{
	if (this.shader)
		// the uniform {string} may be different according to material implementation.
		this.shader.setMatrix("mvM", matrix, transpose);
};

/** Sets a projection matrix from a float array, the matrial(i.e. shader) must be binded before.
 *  @param {array} value - A float array (2x2, 3x3 or 4x4) : column major
 *  @param {bool} [false] transpose - If true transposes the matrix
 */

VG.Render.Material.prototype.setProjectionMatrix = function(matrix, transpose)
{
	if (this.shader)
		// the uniform {string} may be different according to material implementation.
		this.shader.setMatrix("projM", matrix, transpose);
};

/** Queries the attribute location/index
 *  @param {string} name - The attribute name as set in the source
 *  @returns {number}
 */

VG.Render.Material.prototype.getAttrib = function(name)
{
	var attrib = -1;
	if (this.shader)
		attrib = this.shader.getAttrib(name);
	return attrib;
};

/** Applies sub material.
 *  @param {int} subIndex - The sub material(index) for facet
 */

VG.Render.Material.prototype.applySubMaterial = function(subIndex)
{
};

/** Applies global lights.
 *  @param {Array[VG.Render.Light]} lights
 */

VG.Render.Material.prototype.applyLights = function(lights)
{
};

/** Barebone material, mostly used as fail-over
 * @augments VG.Render.Material
 * @constructor */

VG.Render.SimpleMaterial = function()
{
    VG.Render.Material.call(this);

    var vSrc = [
        '#version 100',
        'attribute vec4 position;',
        'attribute vec3 normal;',
        'attribute vec2 uv;',

        'uniform mat4 mvM;',
        'uniform mat4 projM;',

        'varying vec3 vN;',

        'void main() {',
        '   vN = (mvM * vec4(normal, 0.0)).xyz;',
        '   vec4 pos = mvM * position;',
        '   gl_Position = projM * pos;',
        '}',
    ].join("\n");

    var fSrc = [
        '#version 100',
        'precision mediump float;',

        'varying vec3 vN;',

        'void main() {',
        '   vec3 L = normalize(vec3(-0.5, 0.5, 0.5));',
        '   vec3 N = normalize(vN);',

        '   vec3 color = vec3(0.2, 0.2, 0.3) + vec3(0.5, 0.5, 1.0) * clamp(dot(L, N), 0.0, 1.0);',

        '   gl_FragColor = vec4(color, 1.0);',
        '}'
    ].join("\n");

    this.shader = new VG.Shader(vSrc, fSrc);
    this.shader.depthTest = true;
    this.shader.depthWrite = true;

    this.shader.create();
};

VG.Render.SimpleMaterial.prototype = Object.create(VG.Render.Material.prototype);

/**
 * Material that conforms to mtl file format
 * Opt format:
 * 		command options
 * 		.... (one or more)
 * 	example:
 *	 var reflectMtl = new VG.Render.MtlMaterial({
 *		Ka: [1, 1, 0],
 *		Kd: [1, 1, 0],
 *		Ks: [1, 1, 1],
 *		Ns: 100,
 *		refl: {
 *			cube_top: {filename: 'cube/cube_nx.png'},
 *			cube_bottom: {filename: 'cube/cube_px.png'},
 *			cube_front: {filename: 'cube/cube_py.png'},
 *			cube_back: {filename: 'cube/cube_ny.png'},
 *   	    cube_left: {filename: 'cube/cube_nz.png'},
 *	        cube_right: {filename: 'cube/cube_pz.png'}
 *       },
 *	   illum: 3
 *	});
 * @constructor
 * @augments VG.Render.Material
 */

VG.Render.MtlMaterial = function(opt){
	VG.Render.Material.call(this);
	this.opt = opt;
	this.className = "MtlMaterial";
	this.needsUpdate = true; // force compilation upon first bind
	this.textureNeedsUpdate = true;
};
VG.Render.MtlMaterial.prototype = Object.create(VG.Render.Material.prototype);

/**
 * @param {Dictionary} images Map from filename to VG.Core.Image()
 */

VG.Render.MtlMaterial.prototype.createTexture = function(images) {
	var that = this;
	if(this.retryTimer && this.retryTimer>0){
		this.retryTimer -= 1;
		return;
	}
	this.retryTimer = 10;
	if(!images) {
		images = {};
		VG.context.imagePool.images.forEach(function(o){
			if ( o.isValid() ) images[o.name] = o;
		});
	}
	this.textureNeedsUpdate = false;
	if (!VG.Render.MtlMaterial.notFoundImage) {
		var image = VG.Core.Image(2, 2);
		image.name = 'notFoundImage';
		image.setPixel(0, 0, 1, 1, 1, 1);
		image.setPixel(1, 1, 1, 1, 1, 0.5);
		image.setPixel(0, 1, 0, 0, 0, 0.5);
		image.setPixel(1, 0, 0, 0, 0, 0);
		VG.Render.MtlMaterial.notFoundImage = image;
	}
	['map_Ka', 'map_Kd', 'map_Ks', 'map_Ns', 'map_d',
		'decal', 'disp', 'bump'].forEach(function (o) {
			if(that.opt[o]) {
				var image = images[that.opt[o].filename];
				if(image) {
					that.opt[o].texture = new VG.Texture([
						image
					], false);
					that.opt[o].texture.flipY = false;
					that.opt[o].texture.create();
				} else {
					that.textureNeedsUpdate = true;
				}
			}
		});
	if(this.opt.refl){
		var fail = false;
		var sides = ['cube_top', 'cube_bottom', 'cube_front', 'cube_back', 'cube_left', 'cube_right'].map(function(o){
			if(that.opt.refl[o]){
				var image = images[that.opt.refl[o].filename];
				if (image) {
					return image;
				} else {
					fail = true;
				}
			}
		});
		if(fail){
			this.textureNeedsUpdate = true;
		} else {
			this.opt.refl.texture = new VG.Texture(sides, true);
			this.opt.refl.texture.flipY = false;
			this.opt.refl.texture.create();
		}
	}
};

/**
 * Since the mesh loaded from obj can contains children and grandchildren.
 * We need to create texture for each.
 * This static method will walk on the mesh tree to create texture for each material
 * with the corresponding images.
 */

VG.Render.MtlMaterial.recursiveCreateTexture = function(mesh, images)
{
	if(mesh.material && mesh.material.createTexture){
		mesh.material.createTexture(images);
	}
	for(var i = 0; i < mesh.children.length; i++){
		VG.Render.MtlMaterial.recursiveCreateTexture(mesh.children[i], images);
	}
};

	/**
	 * Compile this material shader with provided lights configuration.
	 * The compilation will depends on the feature used on the lights.
	 * If it use spot, point, directional or only ambient light,
	 * then only that part compiled in the shader.
	 * This will prevent bloated shader source.
	 * The specific value of each element, e.q. position does not determine
	 * the compilation, but the existence of that value will determine the result shader.
	 * User could change the value of light.position or this.opt.Kd without the need
	 * for recompilation.
	 * Recompilation needed if use change the tipe of light or the number of light.
	 * For example: adding position to light will change from global ambient
	 * to directional light.
	 *
	 * @param {Array} lights
	 *  each light is of format:
	 *      {
     *          color: {
     *              ambient: VG.Core.Color(),
     *              diffuse: VG.Core.Color(),
     *              specular: VG.Core.Color()
     *          },
     *          position: VG.Math.Vector4(), // set w = 0 for directional light
     *          // for directional light, specify the direction of light
     *          attenuation: {
     *              constant: 1.5,
     *              linear: 0.5,
     *              quadratic: 0.2
     *          },
     *          spot: {
     *              cos_of_cutoff: 0.5, // cosine of cutoff angle
     *              exponent: 2.0,
     *              direction: VG.Math.Vector3()
     *          },
     *          strength: 1.0 // used by embree only
     *      }
	 *      spot light require: spot
	 *      point light require: position (w!=0) and attenuation
	 *      directional light require: color, position (w==0)
	 *      ambient require: color.ambient
	 */

	/**
	 * reference: http://paulbourke.net/dataformats/mtl/
	 * Term	Definition
	 *
	 * Fr	Fresnel reflectance
	 * Ft	Fresnel transmittance
	 * Ia	ambient light
	 * I	light intensity
	 * Ir	intensity from reflected direction
	 * 		(reflection map and/or ray tracing)
	 * It	intensity from transmitted direction
	 * Ka	ambient reflectance
	 * Kd	diffuse reflectance
	 * Ks	specular reflectance
	 * Tf	transmission filter
	 *
	 * Vector	Definition
	 *
	 * H	unit vector bisector between L and V
	 * L	unit light vector
	 * N	unit surface normal
	 * V	unit view vector
	 */

VG.Render.MtlMaterial.prototype.compile = function(lights)
{
	this.flag = {
		use: {}
	}; // reset flag
	var flag = this.flag;
	var use = this.flag.use;
	var opt = this.opt;

	// choose the right illumination here if needed
	flag.illum = opt.illum;
	if (flag.illum === undefined) {
		if (opt.Ks) {
			flag.illum = 2;
		} else if(opt.Kd) {
			flag.illum = 1;
		} else {
			flag.illum = 0;
		}
	}
	var illum = flag.illum;
	// set flags
	if (illum === 0) {
		use.Kd = true;
	} else if (illum <= 9) {
		use.Ka = true;
		use.Kd = true;
		use.normal = true;
		use.pos = true;
		if (illum >= 2) {
			use.Ks = true;
			use.Ns = true;

			use.reflect = illum >= 3;
			use.raytrace = illum >= 3 && illum <= 7;
			use.dissolve = illum == 4 || illum == 6 || illum == 7 || illum == 9;
			use.Fr = illum == 5 || illum == 7;
			use.refract = illum == 6 || illum == 7;
			use.reflect = use.reflect && !!opt.refl;
			use.dissolve = use.dissolve && !!opt.d;
			use.refract = use.refract && use.dissolve && !!opt.refl && !!opt.Ni;
		}
	} else if (flag.illum === 10) {
		// shadow
	}
	// check if texture coord needed
	if ((use.Kd && opt.map_Kd) || (use.Ks && (opt.map_Ks || opt.map_Ns)) || (use.Ka && opt.map_Ka)) {
		use.texCoord = true;
		use.texture = true;
	}
	if (use.reflect || use.refract) {
		use.texture = true;
	}
	function If(flag, text) {
		if (flag) return text;
		return "";
	}
	var v = [
		'#version 100',
		'attribute vec4 position;',
		'attribute vec3 normal;',
		If(use.texCoord, 'attribute vec2 texCoord;'),
		'uniform mat4 mvM;',
		'uniform mat4 projM;',
		If(use.reflect, 'uniform mat4 u_view;\nvarying mat3 v_view;'),
		If(use.normal, 'varying vec3 v_normal;'),
		If(use.pos, 'varying vec3 v_pos;'),
		If(use.texCoord, 'varying vec2 v_texCoord;'),
		'void main(){',
		If(use.normal, 'v_normal = (mvM * vec4(normal, 0.0)).xyz;'),
		'vec4 pos = mvM * position;',
		If(use.pos, 'v_pos = pos.xyz/pos.w;'),
		If(use.texCoord, 'v_texCoord = texCoord;'),
		If(use.reflect, 'v_view = mat3(u_view);'),
		'gl_Position = projM * pos;',
		'}'
	].join('\n');

	var f = [
		'#version 100',
		'precision highp float;',
		// starts uniform
		If(use.Ka, 'uniform vec3 Ka;' + If(opt.map_Ka, 'uniform sampler2D map_Ka;')),
		If(use.Kd, 'uniform vec3 Kd;' + If(opt.map_Kd, 'uniform sampler2D map_Kd;')),
		If(use.Ks, 'uniform vec3 Ks;' + If(opt.map_Ks, 'uniform sampler2D map_Ks;')),
		If(use.Ns, 'uniform float Ns;' + If(opt.map_Ns, 'uniform sampler2D map_Ns;')),
		If(use.reflect || use.refract, 'uniform samplerCube map_env;\nvarying mat3 v_view;'),
		If(use.refract, 'uniform float Tf;\n uniform float Ni;'),
		If(use.dissolve, 'uniform float dissolve;'),
		(function(){
			var light, name, out = '';
			for(var i in lights){
				light = lights[i];
				name = "L"+i;
				out += If(use.Ka, 'uniform vec3 '+name+'_col_a;\n');
				if (light.position && (use.Ks || use.Kd)) {
					out += If(use.Kd, 'uniform vec3 ' + name + '_col_d;\n');
					out += If(use.Ks, 'uniform vec3 ' + name + '_col_s;\n');
					out += 'uniform vec4 '+name+'_pos;\n';
					use.att = light.position && light.position.w !== 0;
					if(use.att) {
						out += 'uniform float ' + name + '_att_c;\n';
						out += 'uniform float ' + name + '_att_l;\n';
						out += 'uniform float ' + name + '_att_q;\n';
						if (light.spot) {
							out += 'uniform float ' + name + '_spot_cos;\n';
							out += 'uniform float ' + name + '_spot_exp;\n';
							out += 'uniform float ' + name + '_spot_dir;\n';
						}
					}
				}
			}
			return out;
		})(),
		// starts varying
		If(use.texCoord, 'varying vec2 v_texCoord;'),
		If(use.normal, 'varying vec3 v_normal;'),
		If(use.pos, 'varying vec3 v_pos;'),
		If(use.Fr, [
			'vec3 Fr(float hv, vec3 ks){',
			'return mix(ks, vec3(1.0), pow(1.0-max(0.0, hv), 5.0));',
			'}\n'
		].join('\n')),
		// here starts main
		'void main(){',
		If(use.Ka, 'vec3 KA = Ka' + If(opt.map_Ka, '*texture2D(map_Ka, v_texCoord).rgb') + ';'),
		If(use.Kd, 'vec3 KD = Kd' + If(opt.map_Kd, '*texture2D(map_Kd, v_texCoord).rgb') + ';'),
		If(flag.illum !== 0,[
			// material color + map join
			If(use.Ks, 'vec3 KS = Ks' + If(opt.map_Ks, '*texture2D(map_Ks, v_texCoord).rgb') + ';'),
			If(use.Ns, 'float NS = Ns' + If(opt.map_Ns, '*texture2D(map_Ns, v_texCoord).r') + ';'),
			// variables declarations
			If(use.Ka, 'vec3 ambient = vec3(0.0);'),
			If(use.Kd, 'vec3 diffuse = vec3(0.0);'),
			If(use.Ks, 'vec3 specular = vec3(0.0);'),
			'vec3 color = vec3(0.0);',
			'vec3 all = vec3(0.0);',
			'vec3 refl = vec3(0.0);',
			'vec3 pos_to_light = vec3(0.0);',
			'float dst = 0.0;',
			'float att = 0.0;',
			If(use.normal, 'vec3 normal = normalize(v_normal);'),
			If(use.pos, 'vec3 pos_to_eye = normalize(vec3(0.0)-v_pos);'),
		].join('\n')),
		(function(){
			var light, name, out = '';
			if (flag.illum === 0) {
				return 'gl_FragColor.rgb = KD;';
			}
			// KaIa
			// + Kd { SUM j=1..ls, (N*Lj)Ij }
			// + Ks ({ SUM j=1..ls, ((H*Hj)^Ns)Ij } + Ir)
			for(var i in lights) {
				light = lights[i];
				name = "L" + i;
				use.att = light.position && light.position.w !== 0;
				if (use.att) {
					out += [
						"dst = distance(" + name + "_pos.xyz,v_pos);",
						"att = " + name + "_att_c + " + name + "_att_l * dst + " + name + "_att_q * dst * dst;",
						'att = 1.0/att;\n'
					].join('\n');
					if (light.spot) {
						out += [
							"cos_theta_spot = dot(v_pos - " + name + "_pos, " + name + "_spot_dir);",
							"if (cos_theta_spot>" + name + "_spot_cos) {",
							"att *= pow(cos_theta_spot, " + name + "_spot_exp);",
							'} else {',
							'att = 0.0;',
							'}\n'
						].join('\n');
					}
				}
				out += If(use.Ka, 'ambient += '+name+'_col_a' +If(use.att, ' * att') +';\n');

				if (use.Kd) {
					if (light.position) {
						if (light.position.w === 0) {
							out += 'pos_to_light = ' + name + '_pos.xyz;\n';
						} else {
							out += 'pos_to_light = normalize(' + name + '_pos.xyz - v_pos);\n';
						}
						out += 'diffuse += (' + name + '_col_d * max(0.0, dot(pos_to_light, normal)))' +
							If(use.att, ' * att') + ';\n';
						if (use.Ks) {
							out += 'refl = reflect(vec3(0.0) - pos_to_light, normal);\n';
							out += 'if(dot(pos_to_light, pos_to_eye) > 0.0){\n';
							out += 'specular += (' + name + '_col_s * pow(max(0.0, dot(pos_to_eye, refl)), NS))';
							if (use.Fr) {
								out += '*Fr(dot(normalize(pos_to_eye + pos_to_light), pos_to_eye), KS)';
							} else {
								out += '*KS';
							}
							out += If(use.att, '*att') + ';\n';
							out += '}\n';
						}
					}
				}
			}
			var arr = [], text;
			if(use.Ka){ arr.push('ambient * KA');}
			if(use.Kd){ arr.push('diffuse * KD');}
			if(use.Ks){ arr.push('specular');}
			if(use.reflect){
				text = 'KS';
				if (use.Fr) { text = 'Fr(dot(normal, pos_to_eye), KS)';}
				arr.push(text +  '* textureCube(map_env, v_view * reflect(pos_to_eye, normal)).rgb');
			}
			if(use.refract){
				out += [
					'float sinA = sqrt(1.0-dot(pos_to_eye,normal));',
					'float sinB = 1.0/Ni * sinA;',
					'float cosB = sqrt(1.0-sinB*sinB);',
					'vec3 T = normalize(cross(cross(pos_to_eye, normal), normal));',
					'vec3 ray = normalize(cosB * normal + sinB * T);\n'
				].join('\n');
				text = '';
				if (use.Fr) { text = 'Fr(dot(normal, pos_to_eye), 1.0-KS) * ';}
				arr.push(text + 'Tf * textureCube(map_env, v_view * ray).rgb * (1.0 - KS)');
			}
			if (arr.length > 0) {
				out += 'color = ' + arr.join('+') + ';\n';
			}
			out +='gl_FragColor.rgb = color;\n';
			if (use.dissolve) {
				out += 'gl_FragColor.a = dissolve;';
			}
			return out;
		})(),
		'}\n'
	].join('\n');
	//VG.log(flag.illum);
	//VG.log(v);
	//VG.log(f);
	//console.log(use);
	this.shader = new VG.Shader(v, f);
	this.shader.depthTest = true;
	this.shader.depthWrite = true;
	this.shader.create();
	if (use.dissolve) {
		this.shader.blendType = VG.Shader.Blend.Alpha;
	}
	this.needsUpdate = false;
};

/**
 * Bind this material shader.
 * It will bind necessary material value, texture, reflection map and light value.
 * It will recompile shader if this.needsUpdate is set.
 * Call this before drawing mesh that assume this material.
 *
 * @param {VG.Render.Context} context
 */

VG.Render.MtlMaterial.prototype.bind = function(context)
{
	var use, shader, slot = 0, opt = this.opt,
		lights = context.lights, camera = context.camera;
	if (this.needsUpdate) {
		this.needsUpdate = false;
		this.compile(lights);
	}
	use = this.flag.use;
	if (use.texture && this.textureNeedsUpdate) {
		this.createTexture();
	}
	shader = this.shader;
	shader.bind();
	if(use.Ka && opt.Ka){ shader.setFloat('Ka', opt.Ka);}
	if(use.Kd && opt.Kd){ shader.setFloat('Kd', opt.Kd);}
	if(use.Ks && opt.Ks){ shader.setFloat('Ks', opt.Ks);}
	if(use.Ns && opt.Ns){ shader.setFloat('Ns', opt.Ns);}
	if(use.refract){ shader.setFloat('Tf', 1.0-opt.d); }
	if(use.Ka && opt.map_Ka && opt.map_Ka.texture) { shader.setTexture('map_Ka', opt.map_Ka.texture, slot); slot ++;}
	if(use.Kd && opt.map_Kd && opt.map_Kd.texture) { shader.setTexture('map_Kd', opt.map_Kd.texture, slot); slot ++;}
	if(use.Ks && opt.map_Ks && opt.map_Ks.texture) { shader.setTexture('map_Ks', opt.map_Ks.texture, slot); slot ++;}
	if(use.Ns && opt.map_Ns && opt.map_Ns.texture) { shader.setTexture('map_Ns', opt.map_Ns.texture, slot); slot ++;}
	if(use.d && opt.map_d && opt.map_d.texture) { shader.setTexture('map_d', opt.map_d.texture, slot); slot ++;}
	if((use.reflect || use.refract) && opt.refl.texture){
		shader.setTexture('map_env', opt.refl.texture, slot); slot ++;
		shader.setMatrix('u_view', context.camera.getTransform().invert().elements);
	}
	if(use.dissolve) {
		shader.setFloat('dissolve', opt.d);
	}
	if(use.refract) {
		shader.setFloat('Tf', 1);
		shader.setFloat('Ni', opt.Ni);
	}
	(function(){
		var light, name, p;
		for(var i in lights){
			light = lights[i];
			name = "L"+i;
			if(use.Ka){shader.setColor3(name+'_col_a', light.color.ambient);}
			if (light.position && (use.Ks || use.Kd)) {
				if(use.Kd){shader.setColor3(name+'_col_d', light.color.diffuse);}
				if(use.Ks){shader.setColor3(name+'_col_s', light.color.specular);}
				use.att = light.position && light.position.w !== 0;
				if(!use.att) {
					p = new VG.Math.Vector3(light.position.x, light.position.y, light.position.z);
					p.normalize();
					shader.setFloat(name + '_pos', [p.x, p.y, p.z, 0.0]);
				} else {
					p = camera.getTransform().invert().multiplyPosition(light.position);
					shader.setFloat(name + "_pos", [p.x, p.y, p.z, p.w]);
					shader.setFloat(name + "_att_c", light.attenuation.constant);
					shader.setFloat(name + "_att_l", light.attenuation.linear);
					shader.setFloat(name + "_att_q", light.attenuation.quadratic);
					if (light.spot) {
						shader.setFloat(name + "_spot_cos", light.spot.cos_of_cutoff);
						shader.setFloat(name + "_spot_exp", light.spot.exponent);
						shader.setFloat(name + "_spot_dir", [light.spot.direction.x, light.spot.direction.y, light.spot.direction.z]);
					}
				}
			}
		}
	})();
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/** Render pipeline
 *  @constructor */

VG.Render.Pipeline = function()
{
    /** Default material
     *  @member {VG.Render.Material} */
    this.defaultMaterial = new VG.Render.SimpleMaterial();
};

/** Draws a mesh with the given context
 *  @param {VG.Render.Context} context - The context
 *  @param {VG.Render.Mesh} mesh - The mesh to render */

VG.Render.Pipeline.prototype.drawMesh = function(context, mesh)
{
    var material = mesh.material || this.defaultMaterial;
    material.bind(context);

	var mvM = new VG.Math.Matrix4(context.camera.getTransform());
	mvM.invert();
	mvM.multiply(mesh.getTransform());
    material.setModelViewMatrix(mvM.elements);
    material.setProjectionMatrix(context.camera.projM.elements);

    VG.Renderer().drawMesh(mesh, -1, material.shader);
};

/**
 * Update the env map for every object in scene that have
 * material MtlMaterial and opt.illum 3, 4, 5, 6, 7.
 */

VG.Render.Pipeline.prototype.updateEnvMapping = function(context, scene)
{
    var renderables = scene.findAllVisible(context, true);
    var faces = ['cube_top', 'cube_bottom', 'cube_front',
        'cube_back', 'cube_left', 'cube_right'];
    var far = 100;
    var up = [
        new VG.Math.Vector3(0, 1, 0),
        new VG.Math.Vector3(0, 1, 0),
        new VG.Math.Vector3(0, 0, 1),
        new VG.Math.Vector3(0, 0, 1),
        new VG.Math.Vector3(0, 1, 0),
        new VG.Math.Vector3(0, 1, 0)
    ];
    var savedCamera = context.camera;
    var camera = new VG.Render.Camera(45, 1, 0.01, 100);
    var dim = 256;
    var clearColor = new VG.Core.Color(1, 0 ,0);
    var mesh, mat, opt, j;

    for(var i = 0; i < renderables.length; i++) {
        mesh = renderables[i];
        mat = mesh.material;
        if ((mat.className === 'MtlMaterial') && (mat.opt.illum >= 3 && mat.opt.illum <= 7)) {
            opt = mat.opt;
            opt.refl = opt.refl || {};
            var isStatic = false;
            for (j = 0; j < faces.length; j++) {
                if (opt.refl[faces[j]] && opt.refl[faces[j]]) {
                    isStatic = true;
                    break;
                }
            }
            if (!isStatic) {// update only for dynamic env map
                opt.targetIllum = opt.illum;
                opt.illum = 2;
                opt.toUpdateEnvMapping = true;
            }
        }
    }
    for(i = 0; i < renderables.length; i++){
        mesh = renderables[i];
        mat = mesh.material;
        opt = mat && mat.opt;
        if(opt && opt.toUpdateEnvMapping){
            opt.toUpdateEnvMapping = undefined;
            camera.position = mesh.position;
            var savedParent = mesh.parent;
            mesh.parent = undefined;
            var center = camera.position;
            var dir = [
                new VG.Math.Vector3(far, 0, 0).add(center),
                new VG.Math.Vector3(-far, 0, 0).add(center),
                new VG.Math.Vector3(0, far, 0).add(center),
                new VG.Math.Vector3(0, -far, 0).add(center),
                new VG.Math.Vector3(0, 0, far).add(center),
                new VG.Math.Vector3(0, 0, -far).add(center)
            ];
            var images = [];
            for(j = 0; j < 6; j++){
                camera.setLookAt(dir[j], up[j]);
                context.camera = camera;
                var buffer = new VG.RenderTarget(dim, dim, false);
                buffer.create();
                buffer.bind();
                buffer.clear(clearColor, true);
                this.drawScene(context, scene, 0);
                //var image = buffer.toImage();
                //var image = VG.Utils.textureToImage(buffer);
                var image = VG.Utils.renderTargetToImage(buffer);
                buffer.unbind();
                images.push(image);
            }
            mesh.parent = savedParent;
            var cubeTexture = new VG.Texture(images, true);
            cubeTexture.flipY = false;
            cubeTexture.create();
            opt.refl.texture = cubeTexture;
            mat.textureNeedsUpdate = false;
            opt.illum = opt.targetIllum;
            mat.needsUpdate = true;
            opt.targetIllum = undefined;
        }
    }
    context.camera = savedCamera;
};

/**
 * Test hit for all visible meshes scene
 * @param context {VG.Render.Context} WebGL context
 * @param {VG.Render.SceneManager} scene - The scene to render
 * @param x {Number} x of test pixel
 * @param y {Number} y of test pixel
 * @return {VG.Render.Mesh} mesh hit at point (x, y) , or null if none hit
 */

VG.Render.Pipeline.prototype.hitTestScene = function(context, scene, x, y)
{
    var renderables = scene.findAllVisible(context, true);
    return this.hitTestMeshes(context, renderables, x, y);
};

/**
 * Test hit among meshes at pixel x, y
 * @param context {VG.Render.Context} WebGL context
 * @param meshes {Array[]} Array of hit-able mesh
 * @param x {Number} x of test pixel
 * @param y {Number} y of test pixel
 * @return {VG.Render.Mesh} mesh hit at point (x, y) , or null if none hit
 */

VG.Render.Pipeline.prototype.hitTestMeshes = function(context, meshes, x, y)
{
    var vSrc = [
        '#version 100',
        'attribute vec4 position;',
        'attribute vec3 normal;',

        'uniform mat4 viewM;',
        'uniform mat4 projM;',
        'uniform mat4 modelM;',

        'void main() {',
        '   mat4 vmM = viewM * modelM;',
        '   vec4 pos = vmM * position;',
        '   gl_Position = projM * pos;',
        '}'
    ].join("\n");

    var fSrc = [
        '#version 100',
        'precision mediump float;',
        'uniform vec3 pickColor;',

        'void main() {',
        '   gl_FragColor = vec4(pickColor, 1.0);',
        '}'
    ].join("\n");

    var width = VG.Renderer().w;
    var height = VG.Renderer().h;
    var origX=x;
    var origY=y;
    x = Math.round( x * width / context.size2D.width );
    y = Math.round( y * height / context.size2D.height );

    if (x < 0 || y < 0 || x >= width || y >= height) {
        return null;
    }

    var clearColor = new VG.Core.Color("#ffffff");

    /**
     * Setup render target.
     * Render target is not anti-aliased, event though the canvas is anti-aliased.
     * This is good, then we can use color as id for each mesh.
     * @type {VG.RenderTarget}
     */
    var buffer = new VG.RenderTarget(width, height, false);
    buffer.create();
    buffer.bind();
    buffer.clear(clearColor, true);

    var shader = new VG.Shader(vSrc, fSrc);
    shader.depthTest = true;
    shader.depthWrite = true;
    shader.create();
    shader.bind();

    shader.setMatrix("viewM", context.camera.getTransform().invert().elements);
    shader.setMatrix("projM", context.camera.projM.elements);
    /**
     * bits used for each color to represent mesh id
     * @type {number}
     */
    var bit = 1;
    while ((meshes.length >= (1 << (bit*3))) && (bit < 8)) {
        bit ++;
    }
    function idToColor(id) {
        /**
         * Convert mesh id to color used to render the mesh
         * @param id {Int} mesh id
         * @return {Array[Float]} color ready to use for shader vec3
         */
        var epsilon = 0.5/256;
        var color = [id % (1<<bit), (id >> bit) % (1<<bit), id >> (2*bit)];
        for(var i = 0; i < color.length; i++) {
            color[i] /= (1<<bit);
            color[i] += epsilon;
        }
        return color;
    }
    function colorToId(color) {
        /**
         * Convert pixel color to mesh id
         * @param color {Array} Array contains [r, g, b]
         * @return {Number} id of the mesh
         */
        for(var i = 0; i < color.length; i++) {
            color[i] >>= (8-bit);
        }
        return (((color[2] << bit) + color[1]) << bit) + color[0];
    }
    for(var i=0; i<meshes.length; i++) {
        shader.setMatrix("modelM", meshes[i].getTransform().elements);
        shader.setFloat('pickColor', idToColor(i));
        VG.Renderer().drawMesh(meshes[i], -1, shader);
        //VG.log(idToColor(i));
    }
    var selectedId = -1;
    // ignore hit test if draw on render target does not complete
    if (buffer.checkStatusComplete()) {

        var dataSize=4;
        var data=new Uint8Array( dataSize );
        buffer.fillPixelBuffer( { x : x, y : y, width : 1, height : 1 }, data );
        selectedId = colorToId([data[0],data[1],data[2]] );

        data=null;

        //var image = VG.Utils.textureToImage(buffer);
        //var cimage = VG.compressImage(image);
        //VG.SaveFileDialog(VG.UI.FileDialog.Image, "image.png", cimage);
    }
    buffer.unbind();
    VG.Renderer().removeResource(buffer);
    if (selectedId >= meshes.length || selectedId < 0) {
        return null;
    }
    return meshes[selectedId];
};

/** Draws an scene manager with the given context
 *  @param {VG.Render.Context} context - The context
 *  @param {VG.Render.SceneManager} scene - The scene to render
 *  @param {Number} delta - The delta time */

VG.Render.Pipeline.prototype.drawScene = function(context, scene, delta)
{
    var renderables = scene.findAllVisible(context, true);
    for (var i = 0; i < renderables.length; i++)
        renderables[i].onDraw(this, context, delta);
};

/** Render context
 *  @constructor */

VG.Render.Context = function()
{
    /** Camera to get view and projection matrices
     *  @member {VG.Render.Camera} */
    this.camera = new VG.Render.Camera();

	/** lights
	* @member {Array[VG.Render.Light]} lights
	*/
	// this.lights = [];
    // this.emissiveObjects = [];

    /** Determines if tracing should be used
     *  @member {Bool}[false] trace */
    this.trace = false;


    /** Trace context, automatically set by the pipeline drawScene
     *  @member {VG.Render.TraceContext}[null] */
    this.traceContext = null;


    /** 2D Dimmensions for post fx / overlay
     *  @member {VG.Core.Size} */
    this.size2D = VG.Core.Size();
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/** Scene Node, for standalone usage or with a scene manager.
 *  When used with a pipeline override onDraw(pipeline, context, delta) to make it renderable
 *  @param {VG.Render.SceneNode} parent - The parent, can be null
 * @constructor */

VG.Render.SceneNode = function(parent)
{
    /** Parent scene node
     *  @member {VG.Render.SceneNode} */
    this.parent = parent;

    /** Local position
     *  @member {VG.Math.Vector3} VG.Render.SceneNode.position */
    this._position = new VG.Math.Vector3(0.0, 0.0, 0.0);

    /** Local rotation
     *  @member {VG.Math.Quat} VG.Render.SceneNode.rotation */
    this._rotation = new VG.Math.Quat();

    /** Local scale
     *  @member {VG.Math.Vector3} VG.Render.SceneNode.scale */
    this._scale = new VG.Math.Vector3(1.0, 1.0, 1.0);

    /** Local Bounds
     *  @member {VG.Math.Aabb} */
    this.bounds = new VG.Math.Aabb();


    /** By the default bounds update / transforms are disable
     *  @member {Bool} */
    this.hasBounds = false;


    /** Children scene nodes
     *  @member {Array} */
    this.children = [];


    //private cache
    this.__cacheM1 = new VG.Math.Matrix4();
    this.__cacheM2 = new VG.Math.Matrix4();

    this.__cacheQ1 = new VG.Math.Quat();

    this.__cacheAabb = new VG.Math.Aabb();
};

Object.defineProperty(VG.Render.SceneNode.prototype, "position",
{
    get: function()
    {
        return this._position;
    },
    set: function(v)
    {
        this._position.copy(v);
    }
});

Object.defineProperty(VG.Render.SceneNode.prototype, "scale",
{
    get: function()
    {
        return this._scale;
    },
    set: function(v)
    {
        this._scale.copy(v);
    }
});

Object.defineProperty(VG.Render.SceneNode.prototype, "parent",
{
    get: function()
    {
        return this._parent;
    },
    set: function(p)
    {
        if (this._parent == p) return;

        if (p)
        {
            p.children.push(this);
        }

        if (this._parent)
        {
            for (var i = 0; i < this._parent.children.length; i++)
            {
                if (this._parent.children[i] == this)
                {
                    this._parent.children.splice(i, 1);
                    break;
                }
            }
        }

        this._parent = p;
    }
});

Object.defineProperty(VG.Render.SceneNode.prototype, "rotation",
{
    get: function()
    {
        return this._rotation;
    },
    set: function(q)
    {
        this._rotation.copy(q);
    }
});

/** Resets position, scale and rotation to identity */

VG.Render.SceneNode.prototype.resetLocalTransform = function()
{
    this.position.set(0, 0, 0);
    this.scale.set(1, 1, 1);
    this.rotation.setIdentity();
};

/** Returns world-space bounds
 *  @return {VG.Math.Aabb} */

VG.Render.SceneNode.prototype.getBounds = function()
{
    var aabb = this.__cacheAabb;

    if (this.hasBounds)
    {
        aabb.copy(this.bounds);
        aabb.transform(this.getTransform());
    }

    return aabb;
};

/** Returns the world transform of this node
 *  @return {VG.Math.Matrix4} */

VG.Render.SceneNode.prototype.getTransform = function()
{
    var m = this.__cacheM1;

    m.setIdentity();
    m.setQuatRotation(this._rotation);
    m.scale(this._scale.x, this._scale.y, this._scale.z);
    m.translate(this._position.x, this._position.y, this._position.z);

    if (this.parent)
    {
        var t = this.__cacheM2;

        t.set(this.parent.getTransform());

        t.mul(m);

        return t;
    }

    return m;
};

/** Utility wrapper to set the rotation from Euler angles in degrees
 *  @param {Number} yaw - Angle in degrees
 *  @param {Number} pitch - Angle in degrees
 *  @param {Number} roll - Angle in degrees */

VG.Render.SceneNode.prototype.setRotation = function(yaw, pitch, roll)
{
    this._rotation.setEuler(VG.Math.rad(yaw), VG.Math.rad(pitch), VG.Math.rad(roll));
};

/** Increments the rotation
 *  @param {Number} yaw - Delta angle in degrees
 *  @param {Number} pitch - Delta angle in degrees
 *  @param {Number} roll - Delta angle in degrees */

VG.Render.SceneNode.prototype.incRotation = function(yaw, pitch, roll)
{
    var q = this.__cacheQ1;

    q.setEuler(VG.Math.rad(yaw), VG.Math.rad(pitch), VG.Math.rad(roll));

    this._rotation.mulInv(q);
    //this._rotation.normalize();
};







/** Manages scene nodes with culling and ordering techniques,
 *  this class extends the SceneNode class, therefore same parent/child
 *  works with this
 * @constructor
 * @augments VG.Render.SceneNode
 */

VG.Render.SceneManager = function()
{
	VG.Render.SceneNode.call(this);
};

VG.Render.SceneManager.prototype = Object.create(VG.Render.SceneNode.prototype);

/** Finds all nodes that are visible by the given context
 *  @param {VG.Render.Context} context - The render context
 *  @param {BOol} onlyDrawable - If true only consideres nodes with onDraw callback defined */

VG.Render.SceneManager.prototype.findAllVisible = function(context, onlyDrawable)
{
    var visible = [];

    var CullChildren = function(node)
    {
		for (var i = 0; i < node.children.length; i++)
        {
            var child = node.children[i];

            CullChildren(child);

            if (onlyDrawable && !child.onDraw) continue;

            //TODO test bounds against a frustum
            visible.push(child);
        }
    };

    CullChildren(this);

    return visible;
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/** Camera as an scene node
 * @constructor
 * @param {Number}[60] fov - The field of view
 * @param {Number}[1] aspect - Aspect ratio
 * @param {Number}[0.1] nearZ - Near plane
 * @param {Number}[100] farZ - Far plane
 * @augments VG.Render.SceneNode
 */

VG.Render.Camera = function(fov, aspect, nearZ, farZ)
{
    VG.Render.SceneNode.call(this);
	this.setProjection(fov, aspect, nearZ, farZ);
};

VG.Render.Camera.prototype = Object.create(VG.Render.SceneNode.prototype);

/** Sets camera parameters.
 *  @param {Number}[60] fov - The field of view
 *  @param {Number}[1] aspect - Aspect ratio
 *  @param {Number}[0.1] nearZ - Near plane
 *  @param {Number}[100] farZ - Far plane
 */

VG.Render.Camera.prototype.setProjection = function(fov, aspect, nearZ, farZ)
{
    if (fov === undefined) fov = 60.0;
    if (aspect === undefined) aspect = 1.0;
    if (nearZ === undefined) nearZ = 0.1;
    if (farZ === undefined) farZ = 1000.0;

    /** Field of view angle, default 60 degrees
     *  @member {Number} */
    this.fov = fov;

    /** The near clipping plane
     *  @member {Number} */
    this.nearZ = nearZ;

   /** The far clipping plane
     *  @member {Number} */
    this.farZ = farZ;

   /** Aspect ratio, usually w / h, default 1.0
    *  @member {Number} */
    this.aspect = aspect;


    /** Projection matrix
     *  @member {VG.Math.Matrix4()} */
    this.projM = new VG.Math.Matrix4();

    /** If not null/undefined, then will use lookAt with `this.center` as center */
    this.center = null;
    this.eye = null;
    this.up = new VG.Math.Vector3(0, 1.0, 0);
    this.lockUp = false;

    this.updateProjection();
};

/**
 * Set bounding box
 * @param {VG.Math.Vector3} min - minimum of all coordinates
 * @param {VG.Math.Vector3} max - maximum of all coordinates
 */
VG.Render.Camera.prototype.setBoundingBox = function (min, max) {
    let center = new VG.Math.Vector3().copy(min).add(max).mul(0.5);
    let span = new VG.Math.Vector3().copy(max).sub(min);
    this.center = center;
    let factor = Math.tan(this.fov * Math.PI/180/2)*2;
    let w = span.x/factor;
    let h = span.y/factor;
    let dst = Math.max(w, h * this.aspect);

    // console.log(w, h * this.aspect, dst, factor, span.x);
    let eye = new VG.Math.Vector3().copy(this.eye).sub(center);
    eye.normalize();
    eye.mul(dst).add(center);
    this.eye = eye;
    // this.useBoundingBox = true;
    // this.boundingBox = {
    //     min: min,
    //     max: max,
    //     corners: []
    // };
    // for(let i = 0; i < 2; i ++){
    //     for(let j = 0; j < 2; j++){
    //         for(let k = 0; k < 2; k++){
    //             let c = new VG.Math.Vector3(
    //                 i === 0 ? this.boundingBox.min.x : this.boundingBox.max.x,
    //                 j === 0 ? this.boundingBox.min.y : this.boundingBox.max.y,
    //                 k === 0 ? this.boundingBox.min.z : this.boundingBox.max.z
    //             );
    //             this.boundingBox.corners.push(c);
    //         }
    //     }
    // }
    // this.center =
};

/** Updates the projection matrix, must be called if any member changes */

VG.Render.Camera.prototype.updateProjection = function()
{
    this.projM.setPerspective(this.fov, this.aspect, this.nearZ, this.farZ);
};

/**
 * Activate lookAt and set lookAt parameter.
 * Will deactivate lookAt if center set to null/undefined.
 * @param {VG.Math.Vector3} center - center of view
 * @param {VG.Math.Vector3} up - up of camera, use y-axis if up is null
 * @param {VG.Math.Vector3} eye - eye location, use _position if eye is null
 * @param {Boolean} lockUp - if true, then up direction is locked.
 */

VG.Render.Camera.prototype.setLookAt = function (center, up, eye, lockUp)
{
    if(!center){
        this.center = null;
    } else {
        this.center = center.clone();
        this.up = up ? up.clone() : new VG.Math.Vector3(0, 1, 0);
        this.up.normalize();
        this.eye = eye ? eye.clone() : this.position.clone();
        this.lockUp = lockUp;
    }
};

/**
 * Will choose whether to use SceneNode transform or lookAt transform
 * @return this camera transform.
 */

VG.Render.Camera.prototype.getTransform = function ()
{
    let transform;
    if (this.center) {
        transform = this.getTransformLookAt();
    } else {
        transform = VG.Render.SceneNode.prototype.getTransform.call(this);
    }

    if(this.useBoundingBox){
        let min = {x:1e32, y:1e32};
        let max = {x:-1e32, y:-1e32};
        let center = {x:0, y:0};
        for(let c0 of this.boundingBox.corners){
            let c = transform.multiplyPosition(c0);
            min.x = Math.min(c.x, min.x);
            min.y = Math.min(c.y, min.y);
            max.x = Math.max(c.x, max.x);
            max.y = Math.max(c.y, max.y);
            center.x += c.x;
            center.y += c.y;
        }
        let delta = Math.max(max.x-min.x, max.y-min.y);
        center.x /= this.boundingBox.corners.length;
        center.y /= this.boundingBox.corners.length;
        let out = new VG.Math.Matrix4().setTranslate(-center.x, -center.y, 0);
        out.concat(new VG.Math.Matrix4().setScale(2.0/delta,2.0/delta, 1.0));
        return out.concat(transform);
    } else {
        return transform;
    }
};

/**
 * Returns the world transform of this node
 * @return {VG.Math.Matrix4}
 */

VG.Render.Camera.prototype.getTransformLookAt = function ()
{
    var m = this.__cacheM1;

    function makeLookAt(eye, center, up) {
        /**
         * A new look at matrix
         */
        var z = eye.clone();
        z.sub(center).normalize();
        var x = up.cross(z);
        var y = z.cross(x);
        m.elements[0] = x.x;
        m.elements[1] = x.y;
        m.elements[2] = x.z;
        m.elements[3] = 0;
        m.elements[4] = y.x;
        m.elements[5] = y.y;
        m.elements[6] = y.z;
        m.elements[7] = 0;
        m.elements[8] = z.x;
        m.elements[9] = z.y;
        m.elements[10] = z.z;
        m.elements[11] = 0;
        m.elements[12] = eye.x;
        m.elements[13] = eye.y;
        m.elements[14] = eye.z;
        m.elements[15] = 1;

        return m;
    }

    m = makeLookAt(this.eye, this.center, this.up);

    if (this.parent) {
        var t = this.__cacheM2;
        t.set(this.parent.getTransform());
        t.mul(m);
        return t;
    }
    return m;
};

/**
 * Rotate a vector p, around a vector v originating from o amount of alpha
 * @param {VG.Math.Vector3} p - point to rotate
 * @param {VG.Math.Vector3} o - center of rotation
 * @param {VG.Math.Vector3} v - vector to rotate around
 * @param {Number} alpha - angle to rotate (in radian)
 * @return {VG.Math.Vector3} - the rotated point
 */

VG.Render.Camera.prototype.rotateToAPoint = function(p, o, v, alpha)
{
    var c = Math.cos(alpha);
    var s = Math.sin(alpha);
    var C = 1-c;
    var m = new VG.Math.Matrix4();

    m.elements[0] = v.x* v.x*C + c;
    m.elements[1] = v.y* v.x*C + v.z*s;
    m.elements[2] = v.z* v.x*C - v.y*s;
    m.elements[3] = 0;

    m.elements[4] = v.x* v.y*C - v.z*s;
    m.elements[5] = v.y* v.y*C + c;
    m.elements[6] = v.z* v.y*C + v.x*s;
    m.elements[7] = 0;

    m.elements[8] = v.x* v.z*C + v.y*s;
    m.elements[9] = v.y* v.z*C - v.x*s;
    m.elements[10] = v.z* v.z*C + c;
    m.elements[11] = 0;

    m.elements[12] = 0;
    m.elements[13] = 0;
    m.elements[14] = 0;
    m.elements[15] = 1;

    var P = p.clone();
    P.sub(o);
    var out = o.clone();
    out.add(m.multiplyVector3(P));
    return out;
};

/**
 * Calculate dir{x:VG.Math.Vector3, y:VG.Math.Vector3}
 * @return dir{x:VG.Math.Vector3, y:VG.Math.Vector3}
 * @private
 */

VG.Render.Camera.prototype.calculateDirXY = function()
{
    var dir = {};
    var c_eye = this.center.clone();
    c_eye.sub(this.eye);
    dir.x = this.up.clone();
    dir.y = this.up.cross(c_eye);
    dir.y.normalize();
    return dir;
};

/**
 * Rotate as responds to mouse fractional change dx and dy
 * @param {Number} dx - mouse dx / width
 * @param {Number} dy - mouse dy / height
 */

VG.Render.Camera.prototype.rotate = function(dx, dy)
{
    var dir = this.calculateDirXY();
    var c_up = this.center.clone();
    c_up.add(this.up);
    this.eye = this.rotateToAPoint(this.eye, this.center, dir.x, -dx * Math.PI);
    this.eye = this.rotateToAPoint(this.eye, this.center, dir.y, dy * Math.PI);
    if (!this.lockUp) {
        this.up = this.rotateToAPoint(c_up, this.center, dir.y, dy * Math.PI);
        this.up.sub(this.center);
        this.up.normalize();
    }
};

/**
 * Zoom
 * @param {Number} dx - mouse dx / width
 * @param {Number} dy - mouse dy / height
 */

VG.Render.Camera.prototype.zoom = function(dx, dy)
{
    this.eye.sub(this.center);
    this.eye.mul(dy + 1);
    this.eye.add(this.center);
};

/**
 * Pan
 * @param {Number} dx - mouse dx / width
 * @param {Number} dy - mouse dy / height
 */

VG.Render.Camera.prototype.pan = function(dx, dy)
{
    var dir = this.calculateDirXY();
    var e = this.eye.clone();
    e.sub(this.center);
    var t = Math.tan(this.fov/2 * Math.PI/180);
    var len = 2 * e.length() * t;
    var pc = this.center.clone();
    dir.y.mul(dx * len * this.aspect);
    dir.x.mul(dy * len);
    this.center.add(dir.y);
    this.center.add(dir.x);
    this.eye.add(dir.y);
    this.eye.add(dir.x);
};








/** Orbit camera
 *  @constructor */

VG.Render.OrbitCamera = function()
{

    VG.Render.SceneNode.call(this);


    /** The camera, if the camera will be re-parented, if null the opposite
     *  @member {VG.Render.Camera} VG.Render.OrbitCamera.camera */
    this._camera = null;


    this.boom = new VG.Render.SceneNode();
    this.boom.parent = this;

    this.attachPoint = new VG.Render.SceneNode();
    this.attachPoint.parent = this.boom;

    //rotation targets
    this._qYawT = new VG.Math.Quat();
    this._qPitchT = new VG.Math.Quat();

    /** Smooth enabled, affets zooming and rotating
     *  @member {Bool} */
    this.smooth = true;

    /** Rotation stiffness
     *  @member {Number} */
    this.stiffness = 4.0;

    /** Smooth zoom stiffness
     *  @member {Number} */
    this.smoothZoomStiffness = 0.7;

    /** Zoom limits as an object { min, max }
     *  @member {Object} */
    this.zoomLimit = { min: 1.0, max: 20.0 };

    this._zoomTarget = 0.0;

    /** The zoom against the focus point 0.0 to 1.0
     *  @member {Number} */
    this.zoom = 0.5;

    this.applyHardZoom();
};

VG.Render.OrbitCamera.prototype = Object.create(VG.Render.SceneNode.prototype);

Object.defineProperty(VG.Render.OrbitCamera.prototype, "camera",
{
    get: function()
    {
        return this._camera;
    },
    set: function(camera)
    {
        if (camera)
        {
            camera.resetLocalTransform();
            camera.parent = this.attachPoint;
        }

        this._camera = camera;
    }
});

Object.defineProperty(VG.Render.OrbitCamera.prototype, "zoom",
{
    get: function()
    {
        if (!this.attachPoint) return 0.0;

        return ((this.attachPoint.position.z - this.zoomLimit.min) / (this.zoomLimit.max - this.zoomLimit.min));
    },
    set: function(v)
    {
        v = VG.Math.clamp(v, 0.0, 1.0);

        this._zoomTarget = ((v * (this.zoomLimit.max - this.zoomLimit.min)) + this.zoomLimit.min);

        if (!this.smooth)
        {
            this.attachPoint.position.z = this._zoomTarget;
        }
    }
});

/** Increments the zoom
 * @param {Number} d - The delta zoom value */

VG.Render.OrbitCamera.prototype.incZoom = function(d)
{
    this.zoom = this.zoom + d;
};

/** If smooth zoom is enabled this will overwrite the smoothing and set it right away */

VG.Render.OrbitCamera.prototype.applyHardZoom = function()
{
    this.attachPoint.position.z = this._zoomTarget;
};

/** Tick function, must be called every render frame */

VG.Render.OrbitCamera.prototype.tick = function(delta)
{
    if (this.smooth)
    {
        this.attachPoint.position.z = VG.Math.lerp(this.attachPoint.position.z, this._zoomTarget, this.smoothZoomStiffness * delta);

        this.rotation.slerp(this._qYawT, this.stiffness * delta);
        this.boom.rotation.slerp(this._qPitchT, this.stiffness * delta);
    }
};

/**
 * Rotates the orbit against the x and y axis relative to the focus point (this node position)
 * @param {number} dX - The delta x / yaw in degrees
 * @param {number} dY - The delta y / pitch in degrees
 */

VG.Render.OrbitCamera.prototype.incRotation = function(dX, dY)
{
    var qYaw = this.smooth ? this._qYawT : this.rotation;
    var qPitch = this.smooth ? this._qPitchT : this.boom.rotation;

    var q = this.__cacheQ1;
    q.setEuler(VG.Math.rad(dX), 0, 0);
    qYaw.mulInv(q);


    q.setEuler(0.0, VG.Math.rad(dY), 0);
    qPitch.mulInv(q);
};

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/** Triangle-based mesh for realtime rendering
 * @constructor
 * @param {VG.SceneNode} parent - The parent, can be null
 * @augments VG.Render.SceneNode
 * @example
 * To create mesh with texture coordinates use:
 *
 * this.vertexCount = triCount * 3;
 * var layout =[
 *   { name: "position", offset: 0, stride: 4 },
 *   { name: "normal", offset: 4, stride: 4 }
 * ];
 *
 * if (usingTextureCoordinates) {
 *   layout.push({name: 'texCoord', offset: 8, stride: 2});
 * }
 *
 * this.addVertexBuffer(VG.Type.Float, layout);
 * this.layout = this.generateStaticLayout();
 *
 * ...
 *
 * var face = [
 *   {position: ..., normal: ..., texCoord: ...},
 *   {position: ..., normal: ..., texCoord: ...},
 *   {position: ..., normal: ..., texCoord: ...}
 * ];
 *
 * this.setTriangle(index, face);
 */

VG.Render.Mesh = function(parent)
{
    VG.Render.SceneNode.call(this, parent);

    /** Identifies this node is mesh node in native.
     * @param {bool}
     */
    this.identifyMeshSceneNode = true;

    /** Array of element definitions as { facet, offset, size } referencing the index buffer (if indexed) or the vertex buffer
     *  if empty then the mesh should be considered invalid.
     *  @member {Object} */
    this.elements = [];

    /** The material
     *  @member {Material} */
	this.material = null;

    /** The vertex count
     *  @member {Number} */
    this.vertexCount = -1;

    /** Internal vertex buffers with an attribute definition array that goes as:
     *  {
     *      layout: [ { name, offset, stride }, ... ],
     *      vb: VG.GPUBuffer
     *  }
     *  @member {Object} */
    this.vBuffers = [];

    /**
     * Index buffer, will be initialized by init()
     * @type {VG.GPUBuffer}
     */
    this.iBuffer = null;
	this.layout = null;
    this.hasBounds = true;

    this.__cacheV3 = new VG.Math.Vector3();

};

VG.Render.Mesh.prototype = Object.create(VG.Render.SceneNode.prototype);

/**
 * Clone this mesh, while not duplicating vBuffer
 * @return cloned object
 */

VG.Render.Mesh.prototype.clone = function(){
    var mesh = new VG.Render.Mesh();
    mesh = Object.assign(mesh, this);
    mesh._parent = undefined;
    mesh._position = new VG.Math.Vector3();
    mesh._position.copy(this._position);
    mesh._scale = new VG.Math.Vector3();
    mesh._scale.copy(this._scale);
    mesh._rotation = new VG.Math.Quat();
    mesh._rotation.copy(this._rotation);
    mesh.__cacheV3 = new VG.Math.Vector3();
    mesh.__cacheM1 = new VG.Math.Matrix4();
    mesh.__cacheM2 = new VG.Math.Matrix4();
    mesh.__cacheQ1 = new VG.Math.Quat();
    mesh.__cacheAabb = new VG.Math.Aabb();
    mesh.children = [];
    this.children.forEach(function(c){
        var c1 = c.clone();
        c1._parent = mesh;
        mesh.children.push(c1);
    });
    return mesh;
};

/** True if the mesh is properly initialized
 *  @returns {Bool}
 */

VG.Render.Mesh.prototype.isValid = function()
{
	return this.vertexCount != -1 && this.vBuffers.length !== 0;
};

VG.Render.Mesh.prototype.load = function(jsobj)
{
    /** Initializes and loads the mesh from an object according to this specification:
     *  //TODO
     *  */
};

/**
 * Extract triangles from buffer.
 * For now, supporting only non-indexed buffer.
 * Implementation rely on assumptions that it's webgl buffer
 * Not support index buffer yet.
 * Assumption they are to be drawn with GL_TRIANGLES
 * @param {Object{vb:{GPUBuffer}, stride:{Number}, layout: []}}
 * @return {attribute1: [], ...} example: {position: [1, 2, 3, ...], normal: [1, ...]}
 */

VG.Render.Mesh.prototype.extractTrisFromBuffer = function(buffer)
{
    var gl = VG.WebGL.gl;
    var vb = buffer.vb;
    var db = vb.getDataBuffer();
    if (vb.target === gl.ARRAY_BUFFER) {
        console.log(db.data.length);
        var vertexCount = db.data.length/buffer.stride;
        var out = {};
        for(var name in this.layout){
            if (!this.layout.hasOwnProperty(name)) {
                continue;
            }
            out[name] = new Array(vertexCount);
            var iLayout = this.layout[name][1];
            var attr = buffer.layout[iLayout];
            var iAttr = 0;
			var iBuffer = 0;
            for(var i = 0; i < vertexCount; i++) {
                iBuffer = i*buffer.stride + attr.offset;
                iAttr = i*attr.stride;
                for(var j = 0; j < attr.stride; j++) {
                    out[name][iAttr+j] = db.data[iBuffer+j];
                }
            }
        }
        return out;
    }
};

/**
 * load from faces with form: {v: [], vt: [], vn: [], f: [[{v: , vn:, vt: } ... ] ... ]}
 * the result will be non-indexed triangle mesh
 * @param faces Dictionary {v: [], vt: [], vn: [], f: []}
 * @param {Float} scale - scale the loaded object, default to 1
 * @return {{x:{min: int, max: int}, y:{min: int, max: int}, z:{min: int, max: int}}} Bounding box of object.
 * @private
 */

VG.Render.Mesh.prototype._trianglesFromIndexedFaces = function(faces, scale)
{
    // not using index buffer
    var i;
    scale = scale === undefined ? 1.0 : scale;

    if(faces.f.length === 0){
        return;
    }
    var box = {
        x: {min: Number.MAX_VALUE, max: -Number.MAX_VALUE},
        y: {min: Number.MAX_VALUE, max: -Number.MAX_VALUE},
        z: {min: Number.MAX_VALUE, max: -Number.MAX_VALUE}
    };
    for(i = 0; i < faces.v.length; i++) {
        var v = faces.v[i];
        box.x.min = Math.min(box.x.min, v.x * scale);
        box.x.max = Math.max(box.x.max, v.x * scale);
        box.y.min = Math.min(box.y.min, v.y * scale);
        box.y.max = Math.max(box.y.max, v.y * scale);
        box.z.min = Math.min(box.z.min, v.z * scale);
        box.z.max = Math.max(box.z.max, v.z * scale);
    }

    var triCount = faces.f.reduce(function(accum, face) {
        return accum + face.length - 2;
    }, 0);

    var use = {
        vt: faces.vt.length > 0
    };
	// create geometry
	this.vertexCount = triCount * 3;
    var layout =[
            { name: "position", offset: 0, stride: 4 },
            { name: "normal", offset: 4, stride: 4 }
    ];
    if (use.vt) {
        layout.push({name: 'texCoord', offset: 8, stride: 2});
    }
	this.addVertexBuffer(VG.Type.Float, layout);
	this.layout = this.generateStaticLayout();


    function texCoordOf(indices) {
        var v = faces.vt[indices.vt-1];
        return [v.u, v.v];
    }
    function positionOf(indices) {
        var v = faces.v[indices.v-1];
        return [v.x * scale, v.y * scale, v.z * scale, v.w === undefined ? 1.0 : parseFloat(v.w)];
    }
    function positionToVector3(indices) {
        var v = faces.v[indices.v-1];
        return new VG.Math.Vector3(v.x, v.y, v.z);
    }
    function normalOf(indices) {
        var v = faces.vn[indices.vn-1];
        return [parseFloat(v.x), parseFloat(v.y), parseFloat(v.z)];
    }
    function makeTri(a, b, c) {
        /**
         * make triangle from point a, b, c
         * @type {{position: *, normal: *}[]}
         */
        var tri = [ // simple (fan) triangulation
            {position: positionOf(a)},
            {position: positionOf(b)},
            {position: positionOf(c)}
        ];
        if (a.vn !== undefined && b.vn !== undefined && c.vn !== undefined) {
            tri[0].normal = normalOf(a);
            tri[1].normal = normalOf(b);
            tri[2].normal = normalOf(c);
        } else {
            // n = normalize((b-a).cross(c-a))
            var A = positionToVector3(a);
            var B = positionToVector3(b);
            var C = positionToVector3(c);
            var n = new VG.Math.Vector3();
            n.computeNormal(A, B, C);
            n.normalize();
            n = [n.x, n.y, n.z];
            tri[0].normal = n;
            tri[1].normal = n;
            tri[2].normal = n;
        }
        if (use.vt) {
            tri[0].texCoord = texCoordOf(a);
            tri[1].texCoord = texCoordOf(b);
            tri[2].texCoord = texCoordOf(c);
        }
        return tri;
    }
    var index = 0;
    for (i = 0; i < faces.f.length; i ++) {
        var face = faces.f[i];
        for(var j = 0; j < face.length-2; j++) {
            this.setTriangle(index, makeTri(face[0], face[j+1], face[j+2]));
            index += 1;
        }
    }
    this.update();
    return box;
};

/** Returns wether this mesh indexed or not, if false then this.iBuffer should be null */

VG.Render.Mesh.prototype.isIndexed = function()
{
    return this.iBuffer ? true : false;
};

/** Returns the index count. */

VG.Render.Mesh.prototype.getIndexCount = function()
{
	return this.iBuffer.getDataBuffer().getSize();
};

/** Checks if ther are sub-facets. */

VG.Render.Mesh.prototype.hasSubFacets = function()
{
	return this.elements.length > 0;
};

/** Disposes all the buffers and set this mesh as invalid, safe to call if invalid,
 *  also safe to re-initialize */

VG.Render.Mesh.prototype.dispose = function()
{
    if (this.isValid())
	{
		for (var i = 0; i < this.vBuffers.length; i++)
        {
            this.vBuffers[i].vb_db=null;
			this.vBuffers[i].vb.dispose();
        }
	}

	if (this.isIndexed())
	{
		this.iBuffer.dispose();
		this.iBuffer = null;
	}

    this.vertexCount = -1;

	this.vBuffers = [];
    this.elements = [];
};

/** Updates all buffers, for more efficient cherry-pick update, access this.iBuffer and this.vBuffers directly
 *  this also updates the scene node bounds */

VG.Render.Mesh.prototype.update = function()
{
    if (this.isIndexed())
		this.iBuffer.update();

    var i;
    for (i = 0; i < this.vBuffers.length; i++)
    {
        this.vBuffers[i].vb.update();
    }

    this.bounds.setEmpty();

    var v3 = this.__cacheV3;

    for (i = 0; i < this.vertexCount; i++)
    {
        var v = this.getVertex(i);

        //if it has no positions then there's nothing to do here
        if (!v.position) break;

        v3.set(v.position[0], v.position[1], v.position[2]);
        this.bounds.expand(v3);
    }
};

/** Returns attribute definition that holds the specified attribute as [bufferIndex, layoutIndex]
 *  @return {Object} */

VG.Render.Mesh.prototype.getAttrDef = function(name)
{
    for (var i = 0; i < this.vBuffers.length; i++)
    {
        var layout = this.vBuffers[i].layout;

        for (var j = 0; j < layout.length; j++)
        {
            if (layout[j].name == name)
            {
                return [i, j];
            }
        }
    }

    return false;
};

/** Adds a vertex buffer with the defined attribute layout.
 *  @param {VG.Type} type - The array element type, offset and stride should be pass as element count not bytes.
 *  @param {Array} vertexLayout - The vertex layout as an array of { name, offset, stride } not in bytes.
 *  @param {Boolean} generateLayout - creates static layout to use for reading/writing reference
 */

VG.Render.Mesh.prototype.addVertexBuffer = function(type, vertexLayout, generateLayout)
{
    var vBuffer = { vb: null, layout: vertexLayout, stride: 0 };

    for (var i = 0; i < vBuffer.layout.length; i++)
    {
        if (this.getAttrDef(vBuffer.layout[i].name) !== false)
            throw "Attribute already defined in another buffer";
        vBuffer.stride += vBuffer.layout[i].stride;
    }

    vBuffer.vb = new VG.GPUBuffer(type, vBuffer.stride * this.vertexCount, false);
    vBuffer.vb_db = vBuffer.vb.getDataBuffer();
    vBuffer.vb.create();

    this.vBuffers.push(vBuffer);

	if (generateLayout)
		this.layout = this.generateStaticLayout();
};

/** Creates a static layout to use for reading/writing reference */

VG.Render.Mesh.prototype.generateStaticLayout = function()
{
    var layout = {};

    for (var i = 0; i < this.vBuffers.length; i++)
    {
        var vL = this.vBuffers[i].layout;

        for (var j = 0; j < vL.length; j++)
        {
            layout[vL[j].name] = [i, j];
        }
    }

    return layout;
};

/** Sets a single vertex atrribute, see setVertex and setTriangle for a higher level interface
 *  @param {Array} index - An array of two indices (see/use getAtrrDef) [ bufferIndex, layoutIndex ]
 *  @param {Number} vertexIndex - The vertex index
 *  @param {Array} values - An array of values equal to the attribute stride */

VG.Render.Mesh.prototype.set = function(index, vertexIndex, values)
{
    var b = this.vBuffers[index[0]];
    var attr = b.layout[index[1]];
    //var db=b.vb.getDataBuffer();
    for (var i = 0; i < attr.stride; i++)
    {
        var value = i < values.length ? value = values[i] : 0;

        //b.vb.setBuffer((vertexIndex * b.stride + attr.offset) + i, value);
        b.vb_db.set((vertexIndex * b.stride + attr.offset) + i, value);
    }
};

/** Sets a single vertex, see "set" for a lower level interface
 *  @param {Number} vertexIndex - The vertex index
 *  @param {Object} vertex - An object with attr-values pair, ie: { position: [x, y, z, 1.0] } */

VG.Render.Mesh.prototype.setVertex = function(vertexIndex, vertex)
{
    for (var attr in vertex)
    {
        var attrIndex = this.layout[attr];

        if (!attrIndex) throw "Attribute " + attr + " is not defined in the layout";

        this.set(attrIndex, vertexIndex, vertex[attr]);
    }
};

/** Sets a triangle, same as setVertex but this take an array of 3 objects
 *  @param {Number} triangleIndex - The triangle index
 *  @param {Array} vertexArray - See setVertex for more details */

VG.Render.Mesh.prototype.setTriangle = function(triangleIndex, vertexArray)
{
    for (var i = 0; i < 3; i++)
    {
        this.setVertex((triangleIndex * 3) + i, vertexArray[i]);
    }
};

/** Sets an array of triangles
 *  @param {Array} array - The array of triangles */

VG.Render.Mesh.prototype.setTriangleArray = function(array)
{
    for (var attrName in array)
    {
        var index = this.layout[attrName];
        if (index === undefined)
			continue;

        var b = this.vBuffers[index[0]];
        var attr = b.layout[index[1]];
        var v = array[attrName];
		var nvertex = v.length / attr.stride;

        //var db=b.vb.getDataBuffer();

        for (var vertexIndex = 0; vertexIndex < nvertex; vertexIndex++)
        {
            for (var i = 0; i < attr.stride; i++)
            {
                //b.vb.setBuffer((vertexIndex * b.stride + attr.offset) + i, v[(vertexIndex * attr.stride) + i]);
                b.vb_db.set((vertexIndex * b.stride + attr.offset) + i, v[(vertexIndex * attr.stride) + i]);
            }
        }
    }
};

/** Gets a single vertex atrribute, see getVertex and getTriangle for a higher level interface
 *  @param {Array} index - An array of two indices (see/use getAtrrDef) [ bufferIndex, layoutIndex ]
 *  @param {Number} vertexIndex - The vertex index
 *  @return {Array} */

VG.Render.Mesh.prototype.get = function(index, vertexIndex)
{
    var b = this.vBuffers[index[0]];
    var attr = b.layout[index[1]];

    var values = [];
    //var db=b.vb.getDataBuffer();

    for (var i = 0; i < attr.stride; i++)
    {
        //values[i] = b.vb.getBuffer((vertexIndex * b.stride + attr.offset) + i);
        values[i] = b.vb_db.get((vertexIndex * b.stride + attr.offset) + i);
    }

    return values;
};

/** Gets a single vertex, see "get" for a lower level interface
 *  @param {Number} vertexIndex - The vertex index
 *  @return {Object} */

VG.Render.Mesh.prototype.getVertex = function(vertexIndex)
{
    var vertex = {};

    for (var attr in this.layout)
    {
        var attrIndex = this.layout[attr];

        vertex[attr] = this.get(attrIndex, vertexIndex);
    }

    return vertex;
};

/** Applies a Matrix4 transform to position and normals (if defined) */

VG.Render.Mesh.prototype.applyTransform = function(m)
{

    for (var i = 0; i < this.vertexCount; i++)
    {
        var v = this.getVertex(i);

        if (v.position) m.transformVectorArray(v.position);
        if (v.normal) m.transformVectorArray(v.normal, true);

        this.setVertex(i, v);
    }
};

/** draw mesh
 * @param {VG.Render.Pipeline} pipeline - rendering pipeline
 * @param {VG.Render.Context} context - rendering context
 * @param {Number} delta - rendering timestamp (seconds)
 */

VG.Render.Mesh.prototype.onDraw = function(pipeline, context, delta)
{
    if (!this.isValid())
		return;

    var material = this.material || pipeline.defaultMaterial;
    material.bind(context);

	var viewM = context.camera.getTransform().invert();
	var mvM = new VG.Math.Matrix4(viewM);
	mvM.multiply(this.getTransform());
    material.setModelViewMatrix(mvM.elements);
    material.setProjectionMatrix(context.camera.projM.elements);

	var vb; // for native call
    for (var i = 0; i < this.vBuffers.length; i++)
    {
        vb = this.vBuffers[i].vb;
        var layout = this.vBuffers[i].layout;

        var tStride = vb.getStride();
        var vStride = tStride * this.vBuffers[i].stride;

        vb.bind();

        for (var j = 0; j < layout.length; j++)
        {
            var vL = layout[j];
            var index = material.getAttrib(vL.name);
            if (index < 0) {
                continue;
            }
            vb.vertexAttrib(index, vL.stride, false, vStride, tStride * vL.offset);
        }
    }

	material.applyLights( context.lights, viewM, context.emissiveObjects );

	if (this.isIndexed())
	{
        this.iBuffer.bind();
		if (this.hasSubFacets())
		{
			for (var ifacet = 0; ifacet < this.elements.length; ifacet++)
			{
				var facet = this.elements[ifacet];
				material.applySubMaterial(ifacet); // applies sub material
				vb.drawBuffer(VG.Renderer.Primitive.Triangles, facet.offset, facet.size, true, this.iBuffer.elemType);
			}
		}
		else
		{
			material.applySubMaterial(-1); // applies default material
			vb.drawBuffer(VG.Renderer.Primitive.Triangles, 0, this.getIndexCount(), true, this.iBuffer.elemType);
		}
	}
	else
	{
		//material.applySubMaterial(-1); // applies default material
        if ( material.applyData ) material.applyData();
		vb.drawBuffer(VG.Renderer.Primitive.Triangles, 0, this.vertexCount);
	}
};

/** Makes a primitive box
 *  @param {Number} width - The width
 *  @param {Number} height - The height
 *  @param {Number} depth - The depth
 *  @returns {VG.Render.Mesh} */

VG.Render.Mesh.makeBox = function(width, height, depth)
{

    var mesh = new VG.Render.BoxMesh();
	mesh.setGeometry(width, height, depth);
    mesh.update();

    return mesh;
};

/** Makes a primitive box
 *  @param {Number} width - The width
 *  @param {Number} height - The height
 *  @param {Number} depth - The depth
 *  @returns {VG.Render.Mesh} */

VG.Render.Mesh.makeBoxIndexed = function(width, height, depth)
{
   var mesh = new VG.Render.Mesh();
    mesh.vertexCount = 8;
    mesh.addVertexBuffer(VG.Type.Float,
        [
            { name: "position", offset: 0, stride: 4 }
        ]
    );
    mesh.layout = mesh.generateStaticLayout();
    mesh.setTriangleArray({
        position:[
            -1, -1, -1, 1,
            1, -1, -1, 1,
            1, 1, -1, 1,
            -1, 1, -1, 1,
            -1, -1, 1, 1,
            1, -1, 1, 1,
            1, 1, 1, 1,
            -1, 1, 1, 1,
        ]
    });
    mesh.iBuffer = new VG.GPUBuffer(VG.Type.Uint16, 3*6*2, false, true);
    mesh.iBuffer.create();
    var db = mesh.iBuffer.getDataBuffer();
    var ixs =
        [
            0, 2, 1,
            0, 3, 2,
            4, 5, 6,
            4, 6, 7,
            0, 1, 5,
            0, 5, 4,
            1, 2, 6,
            1, 6, 5,
            2, 3, 7,
            2, 7, 6,
            3, 0, 4,
            3, 4, 7
        ];
    for(var i in ixs) {
        db.set(i, ixs[i]);
    }
    var t = new VG.Math.Matrix4();
    t.setScale(width / 2, height / 2, depth / 2);
    mesh.applyTransform(t);
    mesh.update();

    return mesh;
};

/** Makes a sphere
 *  @param {Number} radius - The radius
 *  @param {Number} segments - The segment count, the higher the smoothier
 *  @returns {VG.Render.Mesh} */

VG.Render.Mesh.makeSphere = function(radius, segments)
{
    var mesh = new VG.Render.SphereMesh( undefined, segments );
    mesh.update();

    return mesh;
};

/** Constructs a sphere
 * @constructor
 * @param {VG.SceneNode} parent - The parent, can be null
 * @param {Number} segments - The segment count, the higher the smoother
 * @augments VG.Render.Mesh
 * @returns {VG.Render.Mesh} */

VG.Render.SphereMesh = function(parent, segments)
{

    VG.Render.Mesh.call(this, parent);

    if ( !segments ) segments=5;

    var mesh = { v: [], vn: [], f: [], vt: [] };

    var step=1/segments*2;

    var radius=1;
    var pt=Math.atan2( -radius, 0 );

    var offset=0, vertexOut=1;
    while ( offset < Math.PI )
    {
        var sx=radius * Math.cos( pt + offset );
        var sy=radius * Math.sin( pt + offset );

        var nextOffset=offset+step;
        if ( nextOffset > Math.PI ) nextOffset=Math.PI;

        var nsx=radius * Math.cos( pt + nextOffset );
        var nsy=radius * Math.sin( pt + nextOffset );

        var caOffset=0; var caStep=1/segments*2;
        while ( caOffset < 2*Math.PI )
        {
            var cos=Math.cos( caOffset );
            var sin=Math.sin( caOffset );
            var ncos=Math.cos( caOffset + caStep );
            var nsin=Math.sin( caOffset + caStep );

            var x=sx * cos;
            var y=sx * sin;

            var lx=sx * ncos;
            var ly=sx * nsin;

            var nx=nsx * cos;
            var ny=nsx * sin;

            var lnx=nsx * ncos;
            var lny=nsx * nsin;

            mesh.v.push( { x: lx, y: sy, z: ly, w: 1.0 } );
            mesh.v.push( { x: x, y: sy, z: y, w: 1.0 } );
            mesh.v.push( { x: nx, y: nsy, z: ny, w: 1.0 } );
            mesh.v.push( { x: lnx, y: nsy, z: lny, w: 1.0 } );

            var poly = [];
            poly.push( { v : vertexOut }, { v : vertexOut+1 }, { v : vertexOut+2 }, { v : vertexOut+3 } );
            mesh.f.push( poly );
            vertexOut+=4;

            caOffset+=caStep;
        }

        offset+=step;
    }

    this._trianglesFromIndexedFaces( mesh, 1.0 );
};

VG.Render.SphereMesh.prototype = Object.create(VG.Render.Mesh.prototype);

/** Sets the radius for the sphere
 *  @param {Number} radius - The radius
 */

VG.Render.SphereMesh.prototype.setRadius = function(radius)
{
    // scale box
    var t = new VG.Math.Matrix4();
    t.setScale(radius, radius, radius);
    this.applyTransform(t);

    this.radius=radius;
};

/** Triangle-based box mesh
 * @constructor
 * @augments VG.Render.Mesh
 * @param {VG.SceneNode} parent - The parent, can be null */

VG.Render.BoxMesh = function(parent)
{
	VG.Render.Mesh.call(this, parent);

	// constants for 6 facets index
	var v = 0;
	this.Left = v++;
	this.Right = v++;
	this.Bottom = v++;
	this.Top = v++;
	this.Back = v++;
	this.Front = v++;

	// create geometry
	this.vertexCount = 36; // 6(facet) * 2(face-triangle) * 3(vertex) = 36 vertex
	this.addVertexBuffer(VG.Type.Float,
		[
			{ name: "position", offset: 0, stride: 4 },
			{ name: "normal", offset: 4, stride: 4 }
		]
	);
	this.layout = this.generateStaticLayout();
};

VG.Render.BoxMesh.prototype = Object.create(VG.Render.Mesh.prototype);

/** Makes a primitive box (position, normal for every vertex)
 *  @param {Number} width - The width
 *  @param {Number} height - The height
 *  @param {Number} depth - The depth
 */

VG.Render.BoxMesh.prototype.setGeometry = function(width, height, depth)
{
    this.setTriangleArray(
        {
            position:
            [
				// left
                -1, +1, +1, 1.0, -1, +1, -1, 1.0, -1, -1, -1, 1.0,
                -1, +1, +1, 1.0, -1, -1, -1, 1.0, -1, -1, +1, 1.0,
				// right
                +1, +1, -1, 1.0, +1, +1, +1, 1.0, +1, -1, +1, 1.0,
                +1, +1, -1, 1.0, +1, -1, +1, 1.0, +1, -1, -1, 1.0,
				// bottom
                -1, -1, -1, 1.0, +1, -1, -1, 1.0, +1, -1, +1, 1.0,
                -1, -1, -1, 1.0, +1, -1, +1, 1.0, -1, -1, +1, 1.0,
				// top
                -1, +1, +1, 1.0, +1, +1, +1, 1.0, +1, +1, -1, 1.0,
                -1, +1, +1, 1.0, +1, +1, -1, 1.0, -1, +1, -1, 1.0,
				// back
                -1, +1, -1, 1.0, +1, +1, -1, 1.0, +1, -1, -1, 1.0,
                -1, +1, -1, 1.0, +1, -1, -1, 1.0, -1, -1, -1, 1.0,
				// front
                +1, +1, +1, 1.0, -1, +1, +1, 1.0, -1, -1, +1, 1.0,
                +1, +1, +1, 1.0, -1, -1, +1, 1.0, +1, -1, +1, 1.0
            ],
            normal:
            [
				// left
                -1,  0,  0, 0,  -1,  0,  0, 0,  -1,  0,  0, 0,  -1,  0,  0, 0,  -1,  0,  0, 0,  -1,  0,  0, 0,
				// right
                +1,  0,  0, 0,  +1,  0,  0, 0,  +1,  0,  0, 0,  +1,  0,  0, 0,  +1,  0,  0, 0,  +1,  0,  0, 0,
				// bottom
                 0, -1,  0, 0,   0, -1,  0, 0,   0, -1,  0, 0,   0, -1,  0, 0,   0, -1,  0, 0,   0, -1,  0, 0,
				// top
                 0, +1,  0, 0,   0, +1,  0, 0,   0, +1,  0, 0,   0, +1,  0, 0,   0, +1,  0, 0,   0, +1,  0, 0,
				// back
                 0,  0, -1, 0,   0,  0, -1, 0,   0,  0, -1, 0,   0,  0, -1, 0,   0,  0, -1, 0,   0,  0, -1, 0,
				// front
                 0,  0, +1, 0,   0,  0, +1, 0,   0,  0, +1, 0,   0,  0, +1, 0,   0,  0, +1, 0,   0,  0, +1, 0
            ]
        }
    );

	// scale box
    var t = new VG.Math.Matrix4();
    t.setScale(width / 2, height / 2, depth / 2);
    this.applyTransform(t);
};
/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

/**
 * Contains importer functions for various file formats.
 * @namespace
 */

VG.Import = {};

    /**
     * Parse Wavefront .obj according to:
     *      http://en.wikipedia.org/wiki/Wavefront_.obj_file
     *      http://www.martinreddy.net/gfx/3d/OBJ.spec
     *      http://www.fileformat.info/format/wavefrontobj/egff.htm
     * @example
     * About .obj file:
     *      Vertex data:
     *          v,
     *          vt,
     *          vn,
     *          vp [ignored]
     *      Free-form curve/surface attributes:
     *          deg, bmat, step, cstyle [ignored]
     *      Elements:
     *          p, [ignored]
     *          l, [ignored]
     *          f, polygon includes: tri, quads, 5+ sides poly
     *          curv [ignored]
     *          curv2 [ignored]
     *          surf [ignored]
     *      Free-form curve/surface body elements:
     *          parm, trim, hole, scrv, sp, end [ignored]
     *      Connectivity between free-form surface:
     *          con [ignored]
     *      Grouping:
     *          g (group) support single level group
     *          s [ignored]
     *          mg -> merging, require adjacency detection, expensive conputation [ignored]
     *          o -> optional, not processed by wavefront, specify object name.
     *
     *      Display/render attributes:
     *          mtllib,
     *          usemtl
     *          bevel, c_interp, d_interp, lod, [ignored]
     *          shadow_obj, trace_obj, ctech, stech [ignored]
     *
     * This return a single parent mesh, with possible child meshes.
     * The structure of output mesh:
     *      root-mesh
     *          per-material-mesh
     *          ....
     *          group-mesh
     *              per-material-mesh
     *              ....
     *          group-mesh
     *          ....
     * @param text input .obj file as string
     * @param auxFiles
     * @returns {VG.Render.Mesh} root mesh
     */

VG.Import.loadObj = function(text, auxFiles, scale) {
    if (!text) {
        VG.log("Input not valid .obj file contents.");
        return;
    }
    var rootMesh = new VG.Render.Mesh();
    var activeGroup = rootMesh;
    var activeMesh = rootMesh;
    var mesh = {v:[], vt:[], vn:[], f:[]};
    var lines = text.split("\n").map(function(o){
        return o.trim();
    }).filter(function(o){
        return o !== '' && o[0] !== '#'; // remove empty line & comment
    });
    var materials = {};
    var activeMaterial;
    for (var i = 0; i < lines.length; i++) {
        // remove endline comment
        var comment = lines[i].indexOf('#');
        if (comment != -1) {
            lines[i] = lines[i].substring(0, comment).trim();
        }
        var parts = lines[i].trim().split(" ").filter(function (o) {
            return o.trim() !== ''; // collapse multi-spaces
        });
        var command = parts[0];

        if (command === 'v') {
            /**
             * List of geometric vertices, with (x,y,z[,w]) coordinates, w is optional and defaults to 1.0.
             * v 0.123 0.234 0.345 1.0
             */
            if (parts.length < 4) {
                throw "invalid vertex position.";
            } else if (parts.length === 4) {
                mesh.v.push({x: parts[1], y: parts[2], z: parts[3], w: '1.0'});
            } else {
                mesh.v.push({x: parts[1], y: parts[2], z: parts[3], w: parts[4]});
            }
        } else if (command === 'vt') {
            /**
             * List of texture coordinates, in (u, v [,w]) coordinates, these will vary between 0 and 1, w is optional and defaults to 0.
             * vt 0.500 1 0
             */
            if (parts.length < 3) {
                throw "invalid vertex uv.";
            } else if (parts.length === 3) {
                mesh.vt.push({u: parts[1], v: parts[2], w: '0'});
            } else {
                mesh.vt.push({u: parts[1], v: parts[2], w: parts[3]});
            }
        } else if (command === 'vn') {
            /**
             * # List of vertex normals in (x,y,z) form; normals might not be unit vectors.
             * vn 0.707 0.000 0.707
             */
            if (parts.length < 4) {
                throw "invalid vertex normal.";
            } else {
                mesh.vn.push({x: parts[1], y: parts[2], z: parts[3]});
            }
        } else if (command === 'vp') {
            // ignore
        } else if (command === 'f') {
            /**
             * # Polygonal face element in form:
             * f v1/vt1/vn1 v2/vt2/vn2 v3/vt3/vn3 ....
             * f 1 2 3
             * f 3/1 4/2 5/3
             * f 6/4/1 3/5/3 7/6/5
             */
            var poly = [];
            for (var j = 1; j <parts.length; j++ ) {
                var attrs = parts[j].split('/');
                var v = {};
                v.v = attrs[0];
                if (attrs.length > 1 && attrs[1].length>0) {
                    v.vt = attrs[1];
                }
                if (attrs.length > 2 && attrs[2].length>0) {
                    v.vn = attrs[2];
                }
                poly.push(v);
            }
            if (poly.length < 3) {
                throw "expected face to have 3 or more vertices, got " + poly.length;
            }
            mesh.f.push(poly);
        } else if (command === 'mtllib') {
            if(auxFiles !== undefined) {
                parts.slice(1).forEach(function (o) {
                    var mtrls = VG.Import.loadMtl(auxFiles[parts[1]]);
                    if(mtrls) {
                        for (var name in mtrls) {
                            // first come that's served. the latter one will be ignored.
                            if (!materials[name]) {
                                materials[name] = mtrls[name];
                            }
                        }
                    }
                });
            }
        } else if (command === 'usemtl') {
            activeMaterial = materials[parts[1]];
            // done with current mesh
            activeMesh._trianglesFromIndexedFaces(mesh, scale);
            mesh.f = [];
            //create new
            activeMesh = new VG.Render.Mesh();
            activeMesh.material = activeMaterial; // if activeMaterial is null, then let it null
            activeMesh.parent = activeGroup;
        } else if (command === 'g'){
            // we are done with the previous group
            activeMesh._trianglesFromIndexedFaces(mesh, scale);
            mesh.f = [];
            activeGroup = new VG.Render.Mesh();
            parts.shift();
            activeGroup.groupName = parts.join(' ');
            activeGroup.parent = rootMesh;
            activeMesh = activeGroup;
            activeMesh.material = activeMaterial;
        } else if (command === 'o') {
            activeMesh.name = parts[1];
        }
    }
    activeMesh._trianglesFromIndexedFaces(mesh, scale);
    return rootMesh;
};

    /**
     * Parse MTL according to:
     * http://paulbourke.net/dataformats/mtl/
     *
     * @example
     * supports:
     *  -. material name statemenet
     *      newmtl
     *  -. material color & illumination
     *      Ka r g b
     *      Kd
     *      Ks
     *      Tf
     *      d (dissolve)
     *          d factor
     *          d -halo factor [NOT supported]
     *      illum
     *      Ns
     *      sharpness
     *      Ni
     *  -. texture map
     *      map_Ka [-blendu, -blenv, -cc, -clamp, -o, -s, -t, -mm, -texres]
     *      map_Kd
     *      map_Ks
     *      map_Ns
     *      map_d
     *      disp
     *      decal
     *      bump
     *  -. reflection map
     *      refl
     */

VG.Import.loadMtl = function(text)
{
    if(text === undefined){
        return;
    }
    var parseTextureArgs = function (parts, index, map) {
        var onOff = ['-blendu', '-blendv', '-cc', '-clamp'];
        var uvw = ['-o', '-s', '-t'];
        if (onOff.indexOf(parts[index]) !== -1) {
            if(parts[index+1] === 'on') {
                map[parts[index]] = true;
            } else {
                map[parts[index]] = false;
            }
            return index + 2;
        } else if (uvw.indexOf(parts[index]) !== -1){
            map[parts[index]] = [
                parseFloat(parts[index+1]),
                parseFloat(parts[index+2]),
                parseFloat(parts[index+3])
            ];
            return index + 4;
        } else if (parts[index] === '-mm') {
            map[parts[index]] = [
                parseFloat(parts[index+1]),
                parseFloat(parts[index+2])
            ];
            return index + 3;
        } else if (parts[index] === '-texres') {
            map[parts[index]] = parseFloat(parts[index+1]);
            return index + 2;
        } else {
            // unknown command
            return parts.length;
        }
    };
    var lines = text.split("\n").map(function(o){
        return o.trim();
    }).filter(function(o){
        return o !== '' && o[0] !== '#'; // remove empty line & comment
    });
    var colors = ['Ka', 'Kd', 'Ks', 'Tf'];
    var floats = ['Ns', 'sharpness', 'Ni', 'd'];
    var textures = ['map_Ka', 'map_Kd', 'map_Ks', 'map_Ns', 'map_d',
        'disp', 'decal', 'bump'];
    var materials = {};
    var index;
    var material;
    for (var i = 0; i < lines.length; i++) {
        var parts = lines[i].trim().split(" ").filter(function (o) {
            return o.trim() !== ''; // collapse multi-spaces
        });
        var command = parts[0];
        if (command === 'newmtl'){
            material = {
                name: parts[1]
            };
            materials[material.name] = material;
        } else if (colors.indexOf(command) !== -1){
            if (parts.length < 2) {
                throw 'expected parts.length >= 2';
            }
            var r = parseFloat(parts[1]);
            var g = parts.length > 2 ? parseFloat(parts[2]) : r;
            var b = parts.length > 3 ? parseFloat(parts[3]) : g;
            material[command] = [r, g, b];
        } else if (floats.indexOf(command) !== -1) {
            if (parts.length < 2){
                throw 'expected parts.length == 2';
            }
            material[command] = parseFloat(parts[1]);
        } else if (command === 'illum' ){
            if (parts.length < 2){
                throw 'expected parts.length == 2';
            }
            material[command] = parseInt(parts[1]);
        } else if (command === 'd') {
            // todo not supported yet
        } else if(textures.indexOf(command) !== -1) {
            material[command] = {
                filename: parts[parts.length -1]
            };
            index = parseTextureArgs(parts, 1, material[command]);
            while(index < parts.length - 1){
                index = parseTextureArgs(parts, index, material[command]);
            }
        } else if (command === 'refl') {
            material[command] = material[command] || {};
            var tipe = parts[2];
            // refl[tipe] = {filename: ...}
            material[command][tipe] = {
                filename: parts[parts.length -1]
            };
            index = parseTextureArgs(parts, 3, material[command][tipe]);
            while(index < parts.length - 1){
                index = parseTextureArgs(parts, index, material[command][tipe]);
            }
        }
    }
    for(var name in materials){
        materials[name] = new VG.Render.MtlMaterial(materials[name]);
    }
    return materials;
};


/*
 * Copyright (c) 2014-2017 Markus Moenig <markusm@visualgraphics.tv> and Contributors
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// Web specific Implementations

VG.handleImageDropEvent_Dialog=function( event )
{
    event.stopPropagation();
    event.preventDefault();

    var files = event.dataTransfer.files;
    var file = files[0];
    var fileType;

    var match=false;

    if ( VG.fileDialog.fileType === VG.UI.FileDialog.Image )
    {
        if ( file.type.match( /image.*/ ) )
            match=true;
    } else
    if ( VG.fileDialog.fileType === VG.UI.FileDialog.Text ) {
        //if ( file.type.match( /text.*/ ) || file.type.match( /javascript.*/ ) )
            match=true;
    }
    else
    if ( VG.fileDialog.fileType === VG.UI.FileDialog.Project ) {
            match=true;
    }
    else
    if ( VG.fileDialog.fileType === VG.UI.FileDialog.Binary ) {
        match=true;
    }

    if ( match )
    {
        var reader=new FileReader();

        reader.onload = function( e )
        {
            VG.fileDialog.fileSelected( file.name, reader.result );
        };

        if ( VG.fileDialog.fileType === VG.UI.FileDialog.Image || VG.fileDialog.fileType === VG.UI.FileDialog.Binary )
            reader.readAsDataURL( file );
        else reader.readAsText( file );
    }
};

VG.handleDragOver_Dialog=function( event )
{
    event.stopPropagation();
    event.preventDefault();
    event.dataTransfer.dropEffect='copy';
};

VG.OpenFileDialog=function( fileType, callback )
{
    if ( !(this instanceof VG.OpenFileDialog) ) return new VG.OpenFileDialog( fileType, callback );

    VG.UI.Dialog.call( this, "File Dialog" );

    VG.fileDialog=this;
    VG.handleImageDropEvent=VG.handleImageDropEvent_Dialog;
    VG.handleDragOver=VG.handleDragOver_Dialog;

    this.fileType=fileType;
    this.callback=callback;

    var layout=VG.UI.Layout();

    var dropAreaName;

    if ( this.fileType === VG.UI.FileDialog.Image )
        dropAreaName="\n\n\nDrop Image Here\n\n\n";
    else
    if ( this.fileType === VG.UI.FileDialog.Text )
        dropAreaName="\n\n\nDrop Text File Here\n\n\n";
    else
    if ( this.fileType === VG.UI.FileDialog.Project )
        dropAreaName="\n\n\nDrop Project Here\n\n\n";
    else
    if ( this.fileType === VG.UI.FileDialog.Binary )
        dropAreaName="\n\n\nDrop File Here\n\n\n";

    this.dropLabel=VG.UI.Label( dropAreaName );
    this.dropLabel.frameType=VG.UI.Frame.Type.Box;

    this.dropLabel.minimumSize.set( 320, 200 );
    layout.addChild( this.dropLabel );

    if ( this.fileType === VG.UI.FileDialog.Image )
    {
        this.image=VG.UI.Image();

        this.image.horizontalExpanding=false;
        this.image.verticalExpanding=false;
        //this.image.frameType=VG.UI.Frame.Type.Box;

        this.image.minimumSize.set( 200, 200 );
        this.image.maximumSize.set( 200, 200 );

        layout.addChild( this.image );
    } else
    {
        this.textEdit=VG.UI.TextEdit( "" );

        this.textEdit.horizontalExpanding=false;
        this.textEdit.verticalExpanding=false;

        this.textEdit.minimumSize.set( 200, 200 );
        this.textEdit.maximumSize.set( 200, 200 );

        layout.addChild( this.textEdit );
    }

    // ---

    VG.dropZone.addEventListener('dragover', VG.handleDragOver, false);
    VG.dropZone.addEventListener('drop', VG.handleImageDropEvent, false);

    VG.dropZone.width=320;
    VG.dropZone.height=200;

    this.layout=layout;
    this.addButton( "Close", function() { VG.dropZone.style.display="none"; this.close( this ); }.bind( this ) );
    this.addButton( "Accept", function() {

        VG.dropZone.style.display="none";

        if ( this.fileType === VG.UI.FileDialog.Image ) {
            if ( this.callback && this.image.image )
                this.callback( this.image.image.name, this.image.image );
        } else {
            if ( this.callback && this.fileContent )
                this.callback( this.fileName, this.fileContent );
        }
        this.close( this );
    }.bind( this ) );

    this.makeVisible=true;

    VG.context.workspace.showWindow( this );
};

VG.OpenFileDialog.prototype=VG.UI.Dialog();

VG.OpenFileDialog.prototype.paintWidget=function( canvas )
{
    if ( !this.visible ) return;

    VG.UI.Dialog.prototype.paintWidget.call( this, canvas );

    VG.dropZone.style.left=String( this.dropLabel.rect.x ) + "px";
    VG.dropZone.style.top=String( this.dropLabel.rect.y ) + "px";
    if ( this.makeVisible ) {
        VG.dropZone.style.display="inline";
        this.makeVisible=false;
    }
};

VG.OpenFileDialog.prototype.fileSelected=function( name, data )
{
    if ( this.fileType === VG.UI.FileDialog.Image )
    {
        VG.fileDialog.image.image.name=name;
        VG.decompressImageData( data, VG.fileDialog.image.image );
    } else
    if ( this.fileType === VG.UI.FileDialog.Binary )
    {
        var Base={};
        Base64.byteToCharMap_ = null;
        Base64.charToByteMap_ = null;
        Base64.byteToCharMapWebSafe_ = null;
        Base64.charToByteMapWebSafe_ = null;
        Base64.ENCODED_VALS_BASE =
            'ABCDEFGHIJKLMNOPQRSTUVWXYZ' +
            'abcdefghijklmnopqrstuvwxyz' +
            '0123456789';

        Base64.ENCODED_VALS = Base64.ENCODED_VALS_BASE + '+/=';
        Base64.ENCODED_VALS_WEBSAFE = Base64.ENCODED_VALS_BASE + '-_.';

        Base64.encodeByteArray = function(input, opt_webSafe) {
            Base64.init_();

            var byteToCharMap = opt_webSafe ?
                                  Base64.byteToCharMapWebSafe_ :
                                  Base64.byteToCharMap_;

            var output = [];

            for (var i = 0; i < input.length; i += 3)
            {
                var byte1 = input[i];
                var haveByte2 = i + 1 < input.length;
                var byte2 = haveByte2 ? input[i + 1] : 0;
                var haveByte3 = i + 2 < input.length;
                var byte3 = haveByte3 ? input[i + 2] : 0;

                var outByte1 = byte1 >> 2;
                var outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);
                var outByte3 = ((byte2 & 0x0F) << 2) | (byte3 >> 6);
                var outByte4 = byte3 & 0x3F;

                if (!haveByte3) {
                    outByte4 = 64;

                    if (!haveByte2) {
                        outByte3 = 64;
                    }
                }

                output.push(byteToCharMap[outByte1],
                    byteToCharMap[outByte2],
                    byteToCharMap[outByte3],
                    byteToCharMap[outByte4]);
            }

            return output.join('');
        };

        Base64.init_ = function() {
            if (!Base64.byteToCharMap_) {
                Base64.byteToCharMap_ = {};
                Base64.charToByteMap_ = {};
                Base64.byteToCharMapWebSafe_ = {};
                Base64.charToByteMapWebSafe_ = {};

                // We want quick mappings back and forth, so we precompute two maps.
                for (var i = 0; i < Base64.ENCODED_VALS.length; i++) {
                    Base64.byteToCharMap_[i] =
                    Base64.ENCODED_VALS.charAt(i);
                    Base64.charToByteMap_[Base64.byteToCharMap_[i]] = i;
                    Base64.byteToCharMapWebSafe_[i] =
                    Base64.ENCODED_VALS_WEBSAFE.charAt(i);
                    Base64.charToByteMapWebSafe_[
                    Base64.byteToCharMapWebSafe_[i]] = i;
                }
            }
        };

        VG.fileDialog.textEdit.text=data;
        VG.fileDialog.fileContent=Base64.encodeByteArray( data );
        VG.fileDialog.fileName=name;
    } else
    {
        VG.fileDialog.textEdit.text=data;

        VG.fileDialog.fileContent=data;
        VG.fileDialog.fileName=name;
    }
    VG.update();
};

VG.OpenFileDialog.prototype.mouseMove=function( event )
{
    var oldDragOp=this.dragOp;

    VG.UI.Dialog.prototype.mouseMove.call( this, event );

    if ( oldDragOp !== this.dragOp )
        VG.dropZone.style.display="none";
};

VG.OpenFileDialog.prototype.mouseUp=function( event )
{
    var oldDragOp=this.dragOp;

    VG.UI.Dialog.prototype.mouseUp.call( this, event );

    if ( oldDragOp !== this.dragOp )
        this.makeVisible=true;
};

VG.SaveFileDialog=function( fileType, name, data )
{
    var fileDialog=VG.RemoteFileDialog( fileType, function( callbackObject ) {
        var path=callbackObject.filePath;
        if ( path.length > 0 ) {

            if ( !callbackObject.download ) VG.remoteSaveFile( path, data );
            else
            {
                var params = {};
                params.filename = path;
                params.content = data;

                var url="/api/download";

                if ( fileType === VG.UI.FileDialog.Image )
                    url+="?binary=true";

                VG.downloadRequest( url, params, "POST");
            }
            return data;
        }
    }.bind( VG.context ), "Select", "Save", true, name );
    VG.context.workspace.showWindow( fileDialog );
};

